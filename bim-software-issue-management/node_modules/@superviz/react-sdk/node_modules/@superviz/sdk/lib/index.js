var Mo=Object.create;var kt=Object.defineProperty,ko=Object.defineProperties,Fi=Object.getOwnPropertyDescriptor,No=Object.getOwnPropertyDescriptors,Fo=Object.getOwnPropertyNames,de=Object.getOwnPropertySymbols,Do=Object.getPrototypeOf,Be=Object.prototype.hasOwnProperty,Di=Object.prototype.propertyIsEnumerable;var Ni=(p,o,t)=>o in p?kt(p,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):p[o]=t,f=(p,o)=>{for(var t in o||(o={}))Be.call(o,t)&&Ni(p,t,o[t]);if(de)for(var t of de(o))Di.call(o,t)&&Ni(p,t,o[t]);return p},C=(p,o)=>ko(p,No(o));var $e=(p,o)=>{var t={};for(var e in p)Be.call(p,e)&&o.indexOf(e)<0&&(t[e]=p[e]);if(p!=null&&de)for(var e of de(p))o.indexOf(e)<0&&Di.call(p,e)&&(t[e]=p[e]);return t};var Bi=(p,o)=>()=>(p&&(o=p(p=0)),o);var Bo=(p,o)=>()=>(o||p((o={exports:{}}).exports,o),o.exports),$o=(p,o)=>{for(var t in o)kt(p,t,{get:o[t],enumerable:!0})},Go=(p,o,t,e)=>{if(o&&typeof o=="object"||typeof o=="function")for(let i of Fo(o))!Be.call(p,i)&&i!==t&&kt(p,i,{get:()=>o[i],enumerable:!(e=Fi(o,i))||e.enumerable});return p};var zo=(p,o,t)=>(t=p!=null?Mo(Do(p)):{},Go(o||!p||!p.__esModule?kt(t,"default",{value:p,enumerable:!0}):t,p));var P=(p,o,t,e)=>{for(var i=e>1?void 0:e?Fi(o,t):o,s=p.length-1,n;s>=0;s--)(n=p[s])&&(i=(e?n(o,t,i):n(i))||i);return e&&i&&kt(o,t,i),i};var w=(p,o,t)=>new Promise((e,i)=>{var s=a=>{try{r(t.next(a))}catch(c){i(c)}},n=a=>{try{r(t.throw(a))}catch(c){i(c)}},r=a=>a.done?e(a.value):Promise.resolve(a.value).then(s,n);r((t=t.apply(p,o)).next())});var l=Bi(()=>{});var Ui={};$o(Ui,{version:()=>As});var As,Vi=Bi(()=>{l();As="6.0.0-lab.3"});var Ji=Bo((hc,ji)=>{l();ji.exports={remoteConfig:{apiUrl:"https://dev.nodeapi.superviz.com",conferenceLayerUrl:"https://video-frame.superviz.com/lab/index.html"}}});l();l();var Nt=(S=>(S.MEETING_START="meeting.start",S.MEETING_LEAVE="meeting.leave",S.MEETING_PARTICIPANT_AMOUNT_UPDATE="meeting.amount-of-participants-update",S.MEETING_PARTICIPANT_LIST_UPDATE="meeting.participant-list-update",S.MEETING_PARTICIPANT_JOINED="meeting.participant-joined",S.MEETING_PARTICIPANT_LEFT="meeting.participant-left",S.MEETING_JOIN="meeting.join",S.MEETING_PARTICIPANT_PROPERTIES="meeting.participant-properties",S.MEETING_HOST_CHANGE="meeting.host-change",S.MEETING_HOST_AVAILABLE="meeting.host-available",S.MEETING_NO_HOST_AVAILABLE="meeting.no-host-available",S.MEETING_SAME_PARTICIPANT_ERROR="meeting.same-participant-error",S.MEETING_DEVICES_CHANGE="meeting.devices-change",S.MEETING_KICK_PARTICIPANTS="meeting.kick-all-participants",S.MEETING_STATE_UPDATE="meeting.state-update",S.MEETING_CONNECTION_STATUS_CHANGE="meeting.connection-status-change",S.MEETING_WAITING_FOR_HOST="meeting.waiting-for-host",S.MY_PARTICIPANT_UPDATED="my-participant.update",S.MY_PARTICIPANT_LEFT="my-participant.left",S.MY_PARTICIPANT_JOINED="my-participant.joined",S.MEETING_KICK_PARTICIPANT="meeting.kick-participant",S.DESTROY="destroy",S))(Nt||{}),Ft=(a=>(a.FRAME_LOAD="frame.load",a.FRAME_DIMENSIONS_UPDATE="frame.dimensions-update",a.FRAME_PARENT_SIZE_UPDATE="frame.parent-window-size-update",a.FRAME_LOCALE_UPDATE="frame.locales-update",a.FRAME_AVATAR_LIST_UPDATE="frame.avatar-list-update",a.FRAME_COLOR_LIST_UPDATE="frame.color-list-update",a.FRAME_STYLES_UPDATE="frame.styles-update",a.FRAME_CALLBACKS_UPDATE="frame.callbacks-update",a))(Ft||{}),Dt=(a=>(a.TOGGLE_MEETING_CHAT="meeting-controls.toggle-chat",a.TOGGLE_MEETING_SETUP="meeting-controls.toggle-setup",a.TOGGLE_MICROPHONE="meeting-controls.toggle-microphone",a.TOGGLE_CAM="meeting-controls.toggle-cam",a.TOGGLE_SCREENSHARE="meeting-controls.toggle-screenshare",a.TOGGLE_TRANSCRIPT="meeting-controls.toggle-transcript",a.HANG_UP="hang-up",a.CALLBACK_CALLED="callback-called",a))(Dt||{}),F=(v=>(v.REALTIME_PARTICIPANT_LIST_UPDATE="realtime.participant-list-update",v.REALTIME_HOST_CHANGE="realtime.host-change",v.REALTIME_GRID_MODE_CHANGE="realtime.grid-mode-change",v.REALTIME_WAIT_FOR_HOST="realtime.wait-for-host",v.REALTIME_AUTHENTICATION_FAILED="realtime.authentication-failed",v.REALTIME_GO_TO_PARTICIPANT="realtime.go-to-participant",v.REALTIME_GATHER="realtime.gather",v.REALTIME_FOLLOW_PARTICIPANT="realtime.follow-participant",v.REALTIME_LOCAL_FOLLOW_PARTICIPANT="realtime.local-follow-participant",v.REALTIME_SET_AVATAR="realtime.set-avatar",v.REALTIME_DRAWING_CHANGE="realtime.drawing-change",v.REALTIME_TRANSCRIPT_CHANGE="realtime.transcript-change",v.REALTIME_PRIVATE_MODE="realtime.private-mode",v))(F||{});var he=(d=>(d[d.MEETING_FAILED=-1]="MEETING_FAILED",d[d.MEETING_DISCONNECTED=0]="MEETING_DISCONNECTED",d[d.MEETING_INITIALIZING=1]="MEETING_INITIALIZING",d[d.MEETING_READY_TO_JOIN=2]="MEETING_READY_TO_JOIN",d[d.MEETING_CONNECTING=3]="MEETING_CONNECTING",d[d.MEETING_CONNECTED=4]="MEETING_CONNECTED",d[d.MEETING_RECONNECT=5]="MEETING_RECONNECT",d[d.FRAME_INITIALIZING=6]="FRAME_INITIALIZING",d[d.FRAME_INITIALIZED=7]="FRAME_INITIALIZED",d[d.FRAME_UNINITIALIZED=8]="FRAME_UNINITIALIZED",d))(he||{}),me=(r=>(r.JOINED="participant.joined",r.LOCAL_JOINED="participant.local-joined",r.LEFT="participant.left",r.LOCAL_LEFT="participant.local-left",r.LOCAL_UPDATED="participant.updated",r.LIST_UPDATED="participant.list-updated",r.SAME_ACCOUNT_ERROR="participant.same-account-error",r))(me||{}),Bt=(r=>(r[r.NOT_AVAILABLE=0]="NOT_AVAILABLE",r[r.GOOD=1]="GOOD",r[r.BAD=2]="BAD",r[r.POOR=3]="POOR",r[r.DISCONNECTED=4]="DISCONNECTED",r[r.RECONNECTING=5]="RECONNECTING",r[r.LOST_CONNECTION=6]="LOST_CONNECTION",r))(Bt||{}),Ge=(r=>(r.NO_CAM="devices.no-cam",r.NO_DEVICES="devices.no-devices",r.DEVICES_BLOCKED="devices.blocked",r.DEVICES_CAM_BLOCKED="devices.cam-blocked",r.DEVICES_INITIALIZATION_ERROR="devices.inititalization-error",r.DEVICES_UNKNOWN_ERROR="devices.unknown-error",r.DEVICES_ALLOWED="devices.allowed",r))(Ge||{}),ue=(t=>(t.PIN_ACTIVE="pin-mode.active",t.PIN_INACTIVE="pin-mode.inactive",t))(ue||{}),bt=(t=>(t.MOUNT="mount",t.UNMOUNT="unmount",t))(bt||{}),ve=(a=>(a.START_FOLLOWING_PARTICIPANT="who-is-online.start-following-participant",a.STOP_FOLLOWING_PARTICIPANT="who-is-online.stop-following-participant",a.ENTER_PRIVATE_MODE="who-is-online.enter-private-mode",a.LEAVE_PRIVATE_MODE="who-is-online.leave-private-mode",a.GATHER_ALL="who-is-online.gather-all",a.GO_TO_PARTICIPANT="who-is-online.go-to-participant",a.START_FOLLOW_ME="who-is-online.start-follow-me",a.STOP_FOLLOW_ME="who-is-online.stop-follow-me",a))(ve||{});l();var ft=(e=>(e.HOST="host",e.GUEST="guest",e.AUDIENCE="audience",e))(ft||{});l();l();l();l();l();var I=(i,s,n,...r)=>w(void 0,[i,s,n,...r],function*(p,o,t,e={}){let a=yield fetch(p,{method:o,headers:f({"Content-Type":"application/json"},e),body:t?JSON.stringify(t):null});if(!a.ok)throw a;try{return yield a.json()}catch(c){return a.ok}});l();import Ho from"debug";var A=class{constructor(o){this.debug=Ho(o)}log(o,...t){this.debug(o,...t)}};l();l();import Wo from"lodash/throttle";var E=class{constructor(o={}){this.subscribe=o=>{this.callbacks.push(o)};this.unsubscribe=o=>{this.callbacks=this.callbacks.filter(t=>t!==o)};this.publish=(...o)=>{!this.callbacks||this.callbacks.forEach(t=>{this.callListener(t,o).catch(e=>{var i;(i=this.logger)==null||i.log("superviz-sdk:observer-helper:publish:error",`
            Failed to execute callback on publish value.
            Callback: ${t.name}
            Event: ${JSON.stringify(o)}
            Error: ${e}
          `)})})};this.reset=()=>{this.callbacks=[]};this.destroy=()=>{delete this.logger,delete this.callbacks};this.callListener=(o,t)=>new Promise((e,i)=>{try{let s=o(...t);e(s)}catch(s){i(s)}});let{logger:t,throttleTime:e}=o;this.logger=t||new A("@superviz/sdk/observer-helper"),this.throttle=e,this.callbacks=[],this.throttle&&(this.publish=Wo(this.publish,this.throttle))}};var V=class{constructor(){this.observers={};this.subscribe=(o,t)=>{this.logger.log(`subscribed to ${o} event`),this.observers[o]||(this.observers[o]=new E({logger:this.logger})),this.observers[o].subscribe(t)};this.unsubscribe=(o,t)=>{if(this.logger.log(`unsubscribed from ${o} event`),!!this.observers[o]){if(!t){this.observers[o].destroy(),delete this.observers[o];return}this.observers[o].unsubscribe(t)}};this.publish=(o,t)=>{o in this.observers&&this.observers[o].publish(t)}}};l();l();l();import Uo from"lodash";var ze=class{setConfig(o){this.configuration=o}get(o,t){return this.configuration?Uo.get(this.configuration,o,t):t}},y=new ze;var O=class{static createUrl(o,t,e={}){let i=new URL(t,o);return Object.keys(e).forEach(s=>i.searchParams.append(s,e[s])),i.toString()}static validateApiKey(o,t){let e="/user/checkapikey",i=this.createUrl(o,e);return I(i,"POST",{apiKey:t})}static fetchConfig(o,t){let e="/immersive-config",i=this.createUrl(o,e);return I(i,"POST",{apiKey:t})}static fetchLimits(o,t){return w(this,null,function*(){let e="/user/check_limits",i=this.createUrl(o,e);return(yield I(i,"GET","",{apikey:t})).usage})}static fetchWaterMark(o,t){return w(this,null,function*(){let e="/user/watermark",i=this.createUrl(o,e),{message:s}=yield I(i,"POST",{apiKey:t});return s})}static createAnnotations(o,t,e){return w(this,null,function*(){let i="/annotations",s=this.createUrl(o,i);return I(s,"POST",f({},e),{apikey:t})})}static updateComment(o,t,e,i){return w(this,null,function*(){let s=`/comments/${e}`,n=this.createUrl(o,s);return I(n,"PUT",{text:i},{apikey:t})})}static createComment(o,t,e){return w(this,null,function*(){let i="/comments",s=this.createUrl(o,i);return I(s,"POST",f({},e),{apikey:t})})}static fetchAnnotation(o,t,e){return w(this,null,function*(){let i="/annotations",s=this.createUrl(o,i,{roomId:e.roomId,url:e.url});return I(s,"GET",void 0,{apikey:t})})}static resolveAnnotation(o,t,e){return w(this,null,function*(){let i=`/annotations/resolve/${e}`,s=this.createUrl(o,i);return I(s,"POST",{},{apikey:t})})}static deleteComment(o,t,e){return w(this,null,function*(){let i=`/comments/${e}`,s=this.createUrl(o,i);return I(s,"DELETE",{},{apikey:t})})}static deleteAnnotation(o,t,e){return w(this,null,function*(){let i=`/annotations/${e}`,s=this.createUrl(o,i);return I(s,"DELETE",{},{apikey:t})})}static createOrUpdateParticipant(o){return w(this,null,function*(){let t=y.get("apiUrl"),e="/participants",i=this.createUrl(t,e);return I(i,"POST",f({},o),{apikey:y.get("apiKey")})})}static sendActivity(o,t,e,i){return w(this,null,function*(){let s="/activity",n=y.get("apiUrl"),r=y.get("roomId"),a=y.get("apiKey"),c=this.createUrl(n,s);return I(c,"POST",{groupId:t,groupName:e,meetingId:r,product:i,userId:o},{apikey:a})})}static fetchParticipantsByGroup(o){return w(this,null,function*(){let t=`/groups/participants/${o}`,e=y.get("apiUrl"),i=this.createUrl(e,t,{take:1e4});return I(i,"GET",void 0,{apikey:y.get("apiKey")})})}static createMentions(o){return w(this,null,function*(){let t="/mentions",e=y.get("apiUrl"),i=this.createUrl(e,t);return I(i,"POST",o,{apikey:y.get("apiKey")})})}};l();l();l();l();function ge(){return{set value(p){this.instance=p,setTimeout(()=>Object.freeze(this))},get value(){return this.instance}}}l();import{BehaviorSubject as Vo,distinctUntilChanged as jo,shareReplay as Jo}from"rxjs";var He=class{constructor(o,t,e){this.subscriptions=new Map;this.setValue=o=>{this.state=o,this.subject.next(this.state)};this.subscribe=(o,t)=>{let e=this.subject.subscribe(t);this.subscriptions.set(o,e)};this.state=o,this.showLog=!!e,this.subject=t.pipe(jo(),Jo({bufferSize:1,refCount:!0}))}getValue(){return this.state}unsubscribe(o){var t;(t=this.subscriptions.get(o))==null||t.unsubscribe(),this.subscriptions.delete(o)}destroy(){this.subscriptions.forEach(o=>o.unsubscribe()),this.subscriptions.clear()}expose(){let o=this.subscribe.bind(this),t=this.unsubscribe.bind(this),e=this.getValue.bind(this),i=this.setValue.bind(this);return{get value(){return e()},set value(s){i(s)},subscribe:o,unsubscribe:t}}};function R(p,o){let t=new Vo(p);return new He(p,t,o)}var We=ge(),Ue=class{constructor(){this.localParticipant=R(null,!0);this.participants=R(new Map);this.group=R(null);if(We.value)throw new Error("CommentsStore is a singleton. There can only be one instance of it.");We.value=this}destroy(){this.localParticipant.destroy(),We.value=null}},$t=new Ue,Ko=$t.destroy.bind($t),qo=$t.group.expose(),Yo=$t.participants.expose(),Zo=$t.localParticipant.expose();function yt(){return{localParticipant:Zo,participants:Yo,destroy:Ko,group:qo}}l();var Ve=ge(),je=class{constructor(){this.disablePresenceControls=R(!1);this.disableGoToParticipant=R(!1);this.disableFollowParticipant=R(!1);this.disablePrivateMode=R(!1);this.disableGatherAll=R(!1);this.disableFollowMe=R(!1);this.participants=R([]);this.extras=R([]);this.joinedPresence=R(void 0);this.everyoneFollowsMe=R(!1);this.privateMode=R(!1);this.following=R(void 0);if(Ve.value)throw new Error("WhoIsOnlineStore is a singleton. There can only be one instance of it.");Ve.value=this}destroy(){this.disablePresenceControls.destroy(),Ve.value=null}},k=new je,Xo=k.destroy.bind(k),Qo=k.disablePresenceControls.expose(),ts=k.disableGoToParticipant.expose(),es=k.disableFollowParticipant.expose(),is=k.disablePrivateMode.expose(),os=k.disableGatherAll.expose(),ss=k.disableFollowMe.expose(),ns=k.joinedPresence.expose(),rs=k.participants.expose(),as=k.extras.expose(),ls=k.everyoneFollowsMe.expose(),ps=k.privateMode.expose(),cs=k.following.expose();function $i(){return{disablePresenceControls:Qo,disableGoToParticipant:ts,disableFollowParticipant:es,disablePrivateMode:is,disableGatherAll:os,disableFollowMe:ss,participants:rs,extras:as,joinedPresence:ns,everyoneFollowsMe:ls,privateMode:ps,following:cs,destroy:Xo}}var ds={["global-store"]:yt,["who-is-online-store"]:$i};function hs(p,o,t){o.subscribe(this,()=>{t?t(o.value):this[p]=o.value,this.requestUpdate&&this.requestUpdate()}),this.unsubscribeFrom.push(o.unsubscribe)}function Et(p){let o=ds[p](),t=hs.bind(this);return new Proxy(o,{get(i,s){return{subscribe(n){t(s,i[s],n)},subject:i[s],get value(){return this.subject.value},publish(n){this.subject.value=n}}}})}var M=class extends V{constructor(){super(...arguments);this.isAttached=!1;this.unsubscribeFrom=[];this.useStore=Et.bind(this);this.attach=t=>{if(Object.values(t).includes(null)||Object.values(t).includes(void 0)){let r=`${this.name} @ attach - params are required`;throw this.logger.log(r),new Error(r)}let{realtime:e,config:i,eventBus:s,ioc:n}=t;if(!e.isDomainWhitelisted){let r=`Component ${this.name} can't be used because this website's domain is not whitelisted. Please add your domain in https://dashboard.superviz.com/developer`;this.logger.log(r);return}if(y.setConfig(i),this.realtime=e,this.eventBus=s,this.isAttached=!0,this.ioc=n,this.room=n.createRoom(this.name),!this.realtime.isJoinedRoom){this.logger.log(`${this.name} @ attach - not joined yet`),setTimeout(()=>{this.logger.log(`${this.name} @ attach - retrying`),this.attach(t)},1e3);return}this.logger.log(`${this.name} @ attached`),this.start(),this.publish("mount")};this.detach=()=>{if(!this.isAttached){this.logger.log(`${this.name} @ detach - component is not attached`);return}this.logger.log("detached"),this.publish("unmount"),this.destroy(),this.room.disconnect(),this.unsubscribeFrom.forEach(t=>t(this)),Object.values(this.observers).forEach(t=>{t.reset(),t.destroy()}),this.observers=void 0,this.realtime=void 0,this.isAttached=!1}}};l();var Je=(n=>(n.presence3dMatterport="presence",n.presence3dAutodesk="presence",n.presence3dThreejs="presence",n.realtime="presence",n.whoIsOnline="presence",n.formElements="presence",n))(Je||{});l();var Gt=(t=>(t.LEFT="left",t.RIGHT="right",t))(Gt||{}),Ke=(i=>(i.TOP_LEFT="top-left",i.TOP_RIGHT="top-right",i.BOTTOM_LEFT="bottom-left",i.BOTTOM_RIGHT="bottom-right",i))(Ke||{});var zt=class extends M{constructor(t,e){var n,r,a;super();this.sidebarOpen=!1;this.layoutOptions={};this.openThreads=()=>{var t;this.sidebarOpen||((t=this.element)==null||t.setAttribute("open",""),this.sidebarOpen=!0,document.body.dispatchEvent(new CustomEvent("toggle-annotation-sidebar",{detail:{open:this.sidebarOpen},composed:!0,bubbles:!0})))};this.closeThreads=()=>{var t;!this.sidebarOpen||((t=this.element)==null||t.removeAttribute("open"),this.sidebarOpen=!1,document.body.dispatchEvent(new CustomEvent("toggle-annotation-sidebar",{detail:{open:this.sidebarOpen},composed:!0,bubbles:!0})))};this.togglePinActive=()=>{if(this.pinActive){this.disable();return}this.enable()};this.onPinFixed=t=>{this.coordinates=t};this.toggleAnnotationSidebar=()=>{this.element.toggleAttribute("open"),this.sidebarOpen=this.element.hasAttribute("open"),document.body.dispatchEvent(new CustomEvent("prepare-to-create-annotation",{detail:void 0,composed:!0,bubbles:!0})),document.body.dispatchEvent(new CustomEvent("toggle-annotation-sidebar",{detail:{open:this.sidebarOpen},composed:!0,bubbles:!0}))};this.onSelectAnnotation=t=>{this.sidebarOpen||this.toggleAnnotationSidebar()};this.positionFloatingButton=()=>{var a,c;this.button=document.createElement("superviz-comments-button");let t=(a=this.layoutOptions)==null?void 0:a.buttonLocation,e=(c=this.layoutOptions)==null?void 0:c.position;if(!t){document.body.appendChild(this.button),this.button.commentsPosition=e;return}let i="",s=Object.values(Ke),n=!1,r=!s.includes(t.toLocaleLowerCase());if(r){let d=window.document.body.querySelector(`#${t}`);d?(d.appendChild(this.button),i="position: relative"):(n=!0,t="top-left")}if(!r||n){document.body.appendChild(this.button);let[d,u]=t.split("-");i=`${d}: 20px; ${u}: 20px;`}this.button.positionStyles=i,this.button.commentsPosition=e};this.positionComments=()=>{var i;this.element=document.createElement("superviz-comments"),this.element.setAttribute("comments",JSON.stringify([])),this.element.side="left",this.element.offset=this.offset,document.body.appendChild(this.element);let t=(i=this.layoutOptions)==null?void 0:i.position;if(!t)return;let e=t.toUpperCase();!Gt[e]||(this.element.side=Gt[e])};this.createAnnotation=e=>w(this,[e],function*({detail:t}){try{let{text:i,mentions:s}=t,{url:n}=this,r=f({},this.coordinates),a=yield O.createAnnotations(y.get("apiUrl"),y.get("apiKey"),{roomId:y.get("roomId"),position:JSON.stringify(r),url:n,userId:this.localParticipantId}),c=yield this.createComment(a.uuid,i,s);this.addAnnotation(C(f({},a),{comments:[c]})),this.pinAdapter.removeAnnotationPin("temporary-pin"),document.body.dispatchEvent(new CustomEvent("select-annotation",{detail:{uuid:a.uuid,haltGoToPin:!0,newPin:!0},composed:!0,bubbles:!0}))}catch(i){this.logger.log("error when creating annotation",i)}});this.deleteAnnotation=e=>w(this,[e],function*({detail:t}){try{let{uuid:i}=t;yield O.deleteAnnotation(y.get("apiUrl"),y.get("apiKey"),i);let s=this.annotations.filter(n=>n.uuid!==i);this.updateAnnotationList(s),this.pinAdapter.removeAnnotationPin(i),this.element.updateAnnotations(this.annotations)}catch(i){this.logger.log("error when deleting annotation",i)}});this.updateComment=e=>w(this,[e],function*({detail:t}){try{let{uuid:i,text:s,mentions:n}=t,r=yield O.updateComment(y.get("apiUrl"),y.get("apiKey"),i,s);yield O.createMentions({commentsId:r.uuid,participants:n.map(c=>({id:c.userId}))});let a=this.annotations.map(c=>Object.assign({},c,{comments:c.comments.map(d=>d.uuid===i?Object.assign({},d,{text:s,mentions:n}):d)}));this.updateAnnotationList(a)}catch(i){this.logger.log("error when updating comment",i)}});this.resolveAnnotation=e=>w(this,[e],function*({detail:t}){try{let{uuid:i}=t,{resolved:s}=yield O.resolveAnnotation(y.get("apiUrl"),y.get("apiKey"),i),n=this.annotations.map(r=>r.uuid===i?Object.assign({},r,{resolved:s}):r);if(this.updateAnnotationList(n),s){this.pinAdapter.removeAnnotationPin(i);return}this.pinAdapter.updateAnnotations(this.annotations)}catch(i){this.logger.log("error when resolve annotation",i)}});this.deleteComment=e=>w(this,[e],function*({detail:t}){try{let{uuid:i,annotationId:s}=t;if(!i||!s)return;yield O.deleteComment(y.get("apiUrl"),y.get("apiKey"),i);let n=this.annotations.find(a=>a.uuid===s);n.comments=n.comments.filter(a=>a.uuid!==i);let r=this.annotations.map(a=>a.uuid===s?n:a);this.element.updateAnnotations(r),this.updateAnnotationList(r)}catch(i){this.logger.log("error when deleting comment",i)}});this.onAnnotationListUpdate=t=>{let{data:e,clientId:i}=t;this.localParticipantId!==i&&(this.annotations=e,this.element.updateAnnotations(this.annotations),this.pinAdapter.updateAnnotations(this.annotations))};this.name="comments",this.logger=new A("@superviz/sdk/comments-component"),this.annotations=[],this.layoutOptions={buttonLocation:(n=e==null?void 0:e.buttonLocation)!=null?n:"top-left",position:(r=e==null?void 0:e.position)!=null?r:"left"},this.hideDefaultButton=(a=e==null?void 0:e.hideDefaultButton)!=null?a:!1,this.setStyles(e==null?void 0:e.styles),this.offset=e==null?void 0:e.offset,setTimeout(()=>{var c,d;t.setCommentsMetadata((d=(c=this.layoutOptions)==null?void 0:c.position)!=null?d:"left")}),this.pinAdapter=t;let{group:i,localParticipant:s}=this.useStore("global-store");i.subscribe(),s.subscribe(c=>{this.localParticipantId=c.id})}enable(){this.pinAdapter.setActive(!0),this.pinActive=!0,this.publish("pin-mode.active"),document.body.dispatchEvent(new CustomEvent("toggle-pin-active",{detail:{isActive:!0}}))}disable(){this.pinAdapter.setActive(!1),this.pinActive=!1,this.publish("pin-mode.inactive"),document.body.dispatchEvent(new CustomEvent("toggle-pin-active",{detail:{isActive:!1}}))}get url(){let t=new URL(this.clientUrl);return t.search="",t.toString()}start(){this.clientUrl=window.location.href,this.positionComments(),this.hideDefaultButton||this.positionFloatingButton(),this.fetchAnnotations(),this.waterMarkState(),this.participantsList(),this.addListeners(),this.pinAdapter.setPinsVisibility(!0)}destroy(){var t;this.logger.log("comments component @ destroy"),this.destroyListeners(),(t=this.button)==null||t.remove(),this.element.remove(),this.element=void 0,this.pinAdapter.destroy()}addListeners(){var t;(t=this.button)==null||t.addEventListener("toggle",this.togglePinActive),this.element.addEventListener("close-threads",this.closeThreads),document.body.addEventListener("create-annotation",this.createAnnotation),this.element.addEventListener("resolve-annotation",this.resolveAnnotation),this.element.addEventListener("delete-annotation",this.deleteAnnotation),this.element.addEventListener("create-comment",({detail:e})=>{this.createComment(e.uuid,e.text,e.mentions,!0)}),this.element.addEventListener("update-comment",this.updateComment),this.element.addEventListener("delete-comment",this.deleteComment),document.body.addEventListener("select-annotation",this.onSelectAnnotation),this.realtime.commentsObserver.subscribe(this.onAnnotationListUpdate),this.pinAdapter.onPinFixedObserver.subscribe(this.onPinFixed)}destroyListeners(){var t;(t=this.button)==null||t.removeEventListener("toggle",this.togglePinActive),this.element.removeEventListener("close-threads",this.closeThreads),this.element.removeEventListener("resolve-annotation",this.resolveAnnotation),this.element.removeEventListener("create-comment",({detail:e})=>{this.createComment(e.uuid,e.text,e.mentions,!0)}),this.element.removeEventListener("update-comment",this.updateComment),this.element.removeEventListener("delete-comment",this.deleteComment),document.body.removeEventListener("select-annotation",this.onSelectAnnotation),document.body.removeEventListener("create-annotation",this.createAnnotation),this.realtime.commentsObserver.unsubscribe(this.onAnnotationListUpdate),this.pinAdapter.onPinFixedObserver.unsubscribe(this.onPinFixed)}setStyles(t=""){if(!t)return;let e=document.createElement("style");e.textContent=t,e.id="superviz-comments-styles",document.head.appendChild(e)}createComment(n,r){return w(this,arguments,function*(t,e,i=[],s=!1){try{let a=yield O.createComment(y.get("apiUrl"),y.get("apiKey"),{annotationId:t,userId:this.localParticipantId,text:e});return yield O.createMentions({commentsId:a.uuid,participants:i.map(c=>({id:c.userId,readed:0}))}),a.mentions=i,s&&this.addComment(t,a),a}catch(a){this.logger.log("error when creating comment",a)}})}addAnnotation(t){let e=[t,...this.annotations];this.element.updateAnnotations(e),this.pinAdapter.updateAnnotations(e),this.updateAnnotationList(e)}updateAnnotationList(t){this.annotations=t,this.realtime.updateComments(t)}addComment(t,e){let i=this.annotations.find(n=>n.uuid===t);i.comments.push(e);let s=this.annotations.map(n=>n.uuid===t?i:n);this.updateAnnotationList(s),this.element.updateAnnotations(s)}fetchAnnotations(){return w(this,null,function*(){try{let t=yield O.fetchAnnotation(y.get("apiUrl"),y.get("apiKey"),{roomId:y.get("roomId"),url:this.url});this.annotations=t,this.element.updateAnnotations(this.annotations),this.pinAdapter.updateAnnotations(this.annotations)}catch(t){this.logger.log("error when fetching annotations",t)}})}waterMarkState(){return w(this,null,function*(){try{let t=yield O.fetchWaterMark(y.get("apiUrl"),y.get("apiKey"));this.element.waterMarkStatus(t)}catch(t){this.logger.log("error when fetching waterMark",t)}})}participantsList(){return w(this,null,function*(){try{let e=(yield O.fetchParticipantsByGroup(this.group.id)).data;this.pinAdapter.participantsList=e,this.element.participantsList=e}catch(t){this.logger.log("error when fetching participantsList",t)}})}};l();l();var Ht=(t=>(t.ADD="add",t.SHOW="show",t))(Ht||{});var Wt=class{constructor(o,t){this.isPinsVisible=!0;this.selectedPin=null;this.temporaryPinCoordinates=null;this.commentsSide="left";this.setCommentsMetadata=o=>{this.commentsSide=o};this.resetPins=o=>{o&&(o==null?void 0:o.key)!=="Escape"||(this.resetSelectedPin(),this.removeAnnotationPin("temporary-pin"),this.temporaryPinCoordinates=null)};this.animate=()=>{(this.isActive||this.isPinsVisible)&&(this.renderAnnotationsPins(),this.divWrapper=this.renderDivWrapper()),this.temporaryPinCoordinates&&this.renderTemporaryPin(),requestAnimationFrame(this.animate)};this.setMouseDownCoordinates=({x:o,y:t})=>{this.mouseDownCoordinates={x:o,y:t}};this.annotationSelected=({detail:{uuid:o,haltGoToPin:t,newPin:e}})=>{var n,r;if(!o)return;e&&this.pins.get(o).setAttribute("newPin","");let i=JSON.parse((r=(n=this.selectedPin)==null?void 0:n.getAttribute("annotation"))!=null?r:"{}");if(this.resetPins(),(i==null?void 0:i.uuid)===o)return;document.body.dispatchEvent(new CustomEvent("close-temporary-annotation"));let s=this.pins.get(o);!s||(s.setAttribute("active",""),this.selectedPin=s,!t&&this.goToPin(o))};this.onClick=o=>{if(!this.isActive)return;let t=this.canvas.getBoundingClientRect(),{x:e,y:i}=this.mouseDownCoordinates,s=e-t.x,n=i-t.y,r=o.clientX-t.left,a=o.clientY-t.top;if(Math.hypot(r-s,a-n)>10)return;let g=this.canvas.getContext("2d").getTransform().inverse(),v=new DOMPoint(r,a-31).matrixTransform(g);this.onPinFixedObserver.publish({x:v.x,y:v.y,type:"canvas"}),this.resetSelectedPin(),this.temporaryPinCoordinates={x:v.x,y:v.y},this.renderTemporaryPin();let b=document.getElementById("superviz-temporary-pin");this.movedTemporaryPin=!this.movedTemporaryPin,b.setAttribute("movedPosition",String(this.movedTemporaryPin)),!this.selectedPin&&document.body.dispatchEvent(new CustomEvent("unselect-annotation"))};this.onToggleAnnotationSidebar=({detail:o})=>{let{open:t}=o;t||(this.pins.forEach(e=>{e.removeAttribute("active")}),this.pins.has("temporary-pin")&&this.removeAnnotationPin("temporary-pin"))};this.hideTemporaryPin=o=>{var u;let t=o.target,e=t.contains(this.canvas),{x:i,y:s}=o,{left:n,top:r,right:a,bottom:c}=this.canvas.getBoundingClientRect(),d=i>n&&i<a&&s>r&&s<c;this.canvas.contains(t)||((u=this.pins.get("temporary-pin"))==null?void 0:u.contains(t))||e&&d||(this.removeAnnotationPin("temporary-pin"),this.temporaryPinCoordinates=null)};if(this.logger=new A("@superviz/sdk/comments-component/canvas-pin-adapter"),this.canvas=document.getElementById(o),this.isActive=!1,this.pins=new Map,this.goToPinCallback=t==null?void 0:t.onGoToPin,!this.canvas){let e=`Canvas with id ${o} not found`;throw this.logger.log(e),new Error(e)}this.canvasSides=this.canvas.getBoundingClientRect(),document.body.style.position="relative",this.onPinFixedObserver=new E({logger:this.logger}),this.divWrapper=this.renderDivWrapper(),this.annotations=[],this.renderAnnotationsPins(),this.animateFrame=requestAnimationFrame(this.animate),document.body.addEventListener("select-annotation",this.annotationSelected),document.body.addEventListener("keyup",this.resetPins)}destroy(){this.removeListeners(),this.removeAnnotationsPins(),this.pins=new Map,this.divWrapper.remove(),this.onPinFixedObserver.destroy(),this.onPinFixedObserver=null,this.canvas.style.cursor="default",this.annotations=[],cancelAnimationFrame(this.animateFrame),document.body.removeEventListener("select-annotation",this.annotationSelected),document.body.removeEventListener("keyup",this.resetPins)}setPinsVisibility(o){if(this.isPinsVisible=o,this.isPinsVisible){this.renderAnnotationsPins();return}this.removeAnnotationsPins()}setActive(o){if(this.isActive!==o){if(this.isActive=o,this.isActive){this.originalCanvasCursor=this.canvas.style.cursor,this.canvas.style.cursor='url("https://production.cdn.superviz.com/static/pin-html.png") 0 100, pointer',this.addListeners();return}this.resetPins(),this.removeListeners(),this.canvas.style.cursor=this.originalCanvasCursor}}updateAnnotations(o){this.logger.log("updateAnnotations",o),this.annotations=o,!(!this.isActive&&!this.isPinsVisible)&&(this.removeAnnotationsPins(),this.renderAnnotationsPins())}removeAnnotationPin(o){let t=this.pins.get(o);!t||(t.remove(),this.pins.delete(o),o!=="temporary-pin"&&(this.annotations=this.annotations.filter(e=>e.uuid!==o)))}renderTemporaryPin(){let o=document.getElementById("superviz-temporary-pin");o||(o=document.createElement("superviz-comments-annotation-pin"),o.id="superviz-temporary-pin",o.setAttribute("type","add"),o.setAttribute("showInput",""),o.setAttribute("containerSides",JSON.stringify(this.canvasSides)),o.setAttribute("commentsSide",this.commentsSide),o.setAttribute("position",JSON.stringify(this.temporaryPinCoordinates)),o.setAttribute("annotation",JSON.stringify({})),o.setAttribute("participantsList",JSON.stringify(this.participants)),o.setAttributeNode(document.createAttribute("active")),this.divWrapper.appendChild(o));let{x:t,y:e}=this.temporaryPinCoordinates,s=this.canvas.getContext("2d").getTransform(),n=s.e,r=s.f,a=s.a,c=s.d,d=t*a+n,u=e*c+r;o.setAttribute("position",JSON.stringify({x:d,y:u})),this.pins.set("temporary-pin",o)}addListeners(){this.canvas.addEventListener("click",this.onClick),this.canvas.addEventListener("mousedown",this.setMouseDownCoordinates),document.body.addEventListener("toggle-annotation-sidebar",this.onToggleAnnotationSidebar),document.body.addEventListener("click",this.hideTemporaryPin)}removeListeners(){this.canvas.removeEventListener("click",this.onClick),this.canvas.removeEventListener("mousedown",this.setMouseDownCoordinates),document.body.removeEventListener("toggle-annotation-sidebar",this.onToggleAnnotationSidebar),document.body.addEventListener("click",this.hideTemporaryPin)}resetSelectedPin(){!this.selectedPin||(this.selectedPin.removeAttribute("active"),this.selectedPin=null)}renderDivWrapper(){let o=this.canvas.getBoundingClientRect(),t=this.divWrapper;return t||(t=document.createElement("div"),t.id="superviz-canvas-wrapper",["","static"].includes(this.canvas.parentElement.style.position)&&(this.canvas.parentElement.style.position="relative")),t.style.position="absolute",t.style.top=`${this.canvas.offsetTop}px`,t.style.left=`${this.canvas.offsetLeft}px`,t.style.width=`${o.width}px`,t.style.height=`${o.height}px`,t.style.pointerEvents="none",t.style.overflow="hidden",document.getElementById("superviz-canvas-wrapper")||this.canvas.parentElement.appendChild(t),t}renderAnnotationsPins(){if((!this.annotations.length||this.canvas.style.display==="none")&&!this.pins.get("temporary-pin")){this.removeAnnotationsPins();return}this.annotations.forEach(o=>{if(o.resolved)return;let t=JSON.parse(o.position);if((t==null?void 0:t.type)!=="canvas")return;let{x:e,y:i}=t,n=this.canvas.getContext("2d").getTransform(),r=n.e,a=n.f,c=n.a,d=n.d,u=e*c+r,g=i*d+a;if(this.pins.has(o.uuid)){let b=this.pins.get(o.uuid);if(this.divWrapper.clientWidth>u&&this.divWrapper.clientHeight>g){b.setAttribute("style","opacity: 1"),this.pins.get(o.uuid).setAttribute("position",JSON.stringify({x:u,y:g}));return}b.setAttribute("style","opacity: 0");return}let v=document.createElement("superviz-comments-annotation-pin");v.setAttribute("type","show"),v.setAttribute("participantsList",JSON.stringify(this.participants)),v.setAttribute("annotation",JSON.stringify(o)),v.setAttribute("position",JSON.stringify({x:u,y:g})),v.id=o.uuid,this.divWrapper.appendChild(v),this.pins.set(o.uuid,v)})}removeAnnotationsPins(){this.pins.forEach(o=>{o.remove()}),this.pins.clear()}set participantsList(o){this.participants=o}goToPin(o){let t=this.annotations.find(v=>v.uuid===o);if(!t)return;let e=JSON.parse(t.position);if((e==null?void 0:e.type)!=="canvas")return;let i=this.canvas.getBoundingClientRect(),{width:s,height:n}=i,{x:r,y:a}=e,c=s/2,d=n/2,u=c-r,g=d-a;this.goToPinCallback&&this.goToPinCallback({x:u,y:g})}};l();import{isEqual as ms}from"lodash";var Ut=class{constructor(o,t={}){this.isPinsVisible=!0;this.selectedPin=null;this.dataAttribute="data-superviz-id";this.commentsSide="left";this.temporaryPinCoordinates={};this.elementsWithDataId={};this.divWrappers=new Map;this.voidElementsWrappers=new Map;this.VOID_ELEMENTS=["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr","svg","rect","ellipse"];this.animate=()=>{this.voidElementsWrappers&&(this.updatePinsPositions(),this.animateFrame=requestAnimationFrame(this.animate))};this.setCommentsMetadata=o=>{this.commentsSide=o};this.hideTemporaryPin=o=>{var n;let t=o.target,e=this.divWrappers.get(this.temporaryPinCoordinates.elementId);if(!e)return;let i=e.contains(t),s=(n=this.pins.get("temporary-pin"))==null?void 0:n.contains(t);i||s||(this.removeAnnotationPin("temporary-pin"),this.temporaryPinCoordinates={})};this.resetPins=o=>{o&&(o==null?void 0:o.key)!=="Escape"||(this.resetSelectedPin(),this.resetHoveredWrapper(),this.temporaryPinCoordinates.elementId&&(this.removeAnnotationPin("temporary-pin"),this.temporaryPinCoordinates={}))};this.annotationSelected=({detail:{uuid:o,newPin:t}})=>{if(!o)return;t&&this.pins.get(o).setAttribute("newPin","");let e=this.annotations.find(n=>{var r;return n.uuid===((r=this.selectedPin)==null?void 0:r.id)});if(this.resetPins(),(e==null?void 0:e.uuid)===o)return;document.body.dispatchEvent(new CustomEvent("close-temporary-annotation"));let i=this.pins.get(o);if(!i)return;i.setAttribute("active",""),this.selectedPin=i;let s=this.annotations.find(n=>n.uuid===o);this.selectedPin.setAttribute("elementId",JSON.parse(s.position).elementId)};this.onClick=o=>{if(!this.isActive||o.target===this.pins.get("temporary-pin"))return;let t=o.target,e=o.currentTarget;if(t!==e&&this.pins.has(t.id))return;let i=e.getAttribute("data-wrapper-id"),s=e.getBoundingClientRect(),{x:n,y:r}=this.mouseDownCoordinates,a=o.clientX-s.left,c=o.clientY-s.top,d=n-s.x,u=r-s.y;if(Math.hypot(a-d,c-u)>10)return;let{width:v,height:b}=e.getBoundingClientRect(),_=32,L=e.getBoundingClientRect().width/e.offsetWidth||1;a=a*100/v,c=(c-_*L)*100/b,this.onPinFixedObserver.publish({x:a,y:c,type:"html",elementId:i}),this.resetSelectedPin(),this.temporaryPinCoordinates=C(f({},this.temporaryPinCoordinates),{x:a,y:c}),this.renderTemporaryPin(i);let m=this.pins.get("temporary-pin");this.movedTemporaryPin=!this.movedTemporaryPin,m.setAttribute("movedPosition",String(this.movedTemporaryPin)),document.body.dispatchEvent(new CustomEvent("unselect-annotation"))};this.onMouseDown=({x:o,y:t})=>{this.mouseDownCoordinates={x:o,y:t}};this.handleMutationObserverChanges=o=>{o.forEach(t=>{var c;let{target:e,oldValue:i}=t,s=e.getAttribute(this.dataAttribute);if(!s&&!i||s===i)return;let n=this.dataAttributeValueFilters.some(d=>i.match(d));if(!s&&i&&!n){this.removeAnnotationPin("temporary-pin"),this.clearElement(i),((c=this.selectedPin)==null?void 0:c.getAttribute("elementId"))===i&&(document.body.dispatchEvent(new CustomEvent("unselect-annotation")),this.selectedPin=null);return}let a=this.dataAttributeValueFilters.some(d=>s.match(d));(i&&this.elementsWithDataId[i]||a)&&this.clearElement(i),!a&&(this.setElementReadyToPin(e,s),this.renderAnnotationsPins())})};this.onToggleAnnotationSidebar=({detail:o})=>{let{open:t}=o;t||(this.resetSelectedPin(),this.pins.has("temporary-pin")&&(this.removeAnnotationPin("temporary-pin"),this.temporaryPinCoordinates.elementId=void 0))};this.onMouseEnter=o=>{var s;let t=o.target;if(this.hoveredWrapper=t,!((s=t.getAttribute("data-wrapper-type"))==null?void 0:s.includes("ellipse"))){this.hoveredWrapper.style.setProperty("outline","1px solid rgb(var(--sv-primary))");return}let i=t.querySelector("ellipse");i.setAttribute("stroke","rgb(var(--sv-primary))"),i.setAttribute("stroke-width","1")};this.onMouseLeave=o=>{var s;let t=o.target;if(this.hoveredWrapper=t,!((s=t.getAttribute("data-wrapper-type"))==null?void 0:s.includes("ellipse"))){this.hoveredWrapper.style.setProperty("outline","");return}let i=t.querySelector("ellipse");i.removeAttribute("stroke"),i.removeAttribute("stroke-width")};if(this.logger=new A("@superviz/sdk/comments-component/container-pin-adapter"),this.container=document.getElementById(o),!this.container){let s=`Element with id ${o} not found`;throw this.logger.log(s),new Error(s)}if(typeof t!="object")throw new Error("Second argument of the HTMLPin constructor must be an object");let{dataAttributeName:e,dataAttributeValueFilters:i}=t;if(e==="")throw new Error("dataAttributeName must be a non-empty string");if(e===null)throw new Error("dataAttributeName cannot be null");if(e!==void 0&&typeof e!="string")throw new Error("dataAttributeName must be a non-empty string");this.dataAttribute=e||this.dataAttribute,this.dataAttributeValueFilters=i||[],this.isActive=!1,this.prepareElements(),this.mutationObserver=new MutationObserver(this.handleMutationObserverChanges),this.observeContainer(),this.pins=new Map,this.onPinFixedObserver=new E({logger:this.logger}),this.annotations=[],document.body.addEventListener("select-annotation",this.annotationSelected),document.body.addEventListener("keyup",this.resetPins),this.voidElementsWrappers.size&&(this.animateFrame=requestAnimationFrame(this.animate))}destroy(){var o;this.logger.log("Destroying HTML Pin Adapter for Comments"),this.removeListeners(),this.removeObservers(),this.divWrappers.forEach(t=>t.remove()),this.divWrappers.clear(),this.pins.forEach(t=>t.remove()),this.pins.clear(),this.divWrappers=void 0,this.pins=void 0,this.elementsWithDataId=void 0,this.logger=void 0,this.onPinFixedObserver.destroy(),this.onPinFixedObserver=void 0,this.container=void 0,this.voidElementsWrappers.clear(),this.voidElementsWrappers=void 0,this.annotations=[],(o=this.svgWrappers)==null||o.remove(),this.svgWrappers=void 0,document.body.removeEventListener("select-annotation",this.annotationSelected),document.body.removeEventListener("toggle-annotation-sidebar",this.onToggleAnnotationSidebar),cancelAnimationFrame(this.animateFrame)}addElementListeners(o){this.divWrappers.get(o).addEventListener("click",this.onClick,!0),this.divWrappers.get(o).addEventListener("mousedown",this.onMouseDown),this.divWrappers.get(o).addEventListener("mouseenter",this.onMouseEnter),this.divWrappers.get(o).addEventListener("mouseleave",this.onMouseLeave)}removeElementListeners(o){this.divWrappers.get(o).removeEventListener("click",this.onClick,!0),this.divWrappers.get(o).removeEventListener("mousedown",this.onMouseDown),this.divWrappers.get(o).removeEventListener("mouseenter",this.onMouseEnter),this.divWrappers.get(o).removeEventListener("mouseleave",this.onMouseLeave)}set participantsList(o){this.participants=o}removeObservers(){this.mutationObserver.disconnect(),this.mutationObserver=void 0}addListeners(){this.divWrappers.forEach((o,t)=>this.addElementListeners(t)),document.body.addEventListener("toggle-annotation-sidebar",this.onToggleAnnotationSidebar),document.body.addEventListener("click",this.hideTemporaryPin)}removeListeners(){this.divWrappers.forEach((o,t)=>this.removeElementListeners(t)),document.body.removeEventListener("keyup",this.resetPins),document.body.removeEventListener("click",this.hideTemporaryPin)}observeContainer(){this.mutationObserver.observe(this.container,{subtree:!0,attributes:!0,attributeFilter:[this.dataAttribute],attributeOldValue:!0})}prepareElements(){this.container.querySelectorAll(`[${this.dataAttribute}]`).forEach(t=>{let e=t.getAttribute(this.dataAttribute);this.dataAttributeValueFilters.some(s=>e.match(s))||this.setElementReadyToPin(t,e)})}addAllCursors(){this.divWrappers.forEach((o,t)=>{this.addCursor(o,t)})}removeAddCursor(){this.divWrappers.forEach((o,t)=>{let e=o,i=o.getAttribute("data-wrapper-type");if(i){let s=i.split("-")[1];e=this.divWrappers.get(t).querySelector(s)}e.style.setProperty("cursor","default"),e.style.setProperty("pointer-events","none")})}setPinsVisibility(o){this.isPinsVisible=o,this.isPinsVisible&&this.renderAnnotationsPins(),this.removeAnnotationsPins()}removeAnnotationPin(o){let t=this.pins.get(o);!t&&o==="temporary-pin"||(t&&(t.remove(),this.pins.delete(o)),o!=="temporary-pin"&&(this.annotations=this.annotations.filter(e=>e.uuid!==o)))}updateAnnotations(o){this.logger.log("updateAnnotations",o),this.annotations=o,this.isPinsVisible&&(this.removeAnnotationsPins(),this.renderAnnotationsPins())}setActive(o){if(this.isActive!==o){if(this.isActive=o,this.isActive){this.addListeners(),this.addAllCursors(),this.prepareElements();return}this.resetPins(),this.removeListeners(),this.removeAddCursor()}}renderTemporaryPin(o){var s,n;(s=this.temporaryPinCoordinates).elementId||(s.elementId=o);let t=this.pins.get("temporary-pin");if(o&&o!==this.temporaryPinCoordinates.elementId&&(this.pins.get("temporary-pin").remove(),this.pins.delete("temporary-pin"),this.temporaryPinCoordinates.elementId=o,t=null),!t){let r=(n=this.elementsWithDataId[o])==null?void 0:n.getBoundingClientRect();t=document.createElement("superviz-comments-annotation-pin"),t.id="superviz-temporary-pin",t.setAttribute("type","add"),t.setAttribute("showInput",""),t.setAttribute("containerSides",JSON.stringify(r)),t.setAttribute("commentsSide",this.commentsSide),t.setAttribute("position",JSON.stringify(this.temporaryPinCoordinates)),t.setAttribute("annotation",JSON.stringify({})),t.setAttribute("participantsList",JSON.stringify(this.participants)),t.setAttribute("keepPositionRatio",""),t.setAttributeNode(document.createAttribute("active")),this.addTemporaryPinToElement(o,t)}let{x:e,y:i}=this.temporaryPinCoordinates;t.setAttribute("position",JSON.stringify({x:e,y:i})),this.pins.set("temporary-pin",t)}renderAnnotationsPins(){if(!this.annotations.length){this.removeAnnotationsPins();return}this.annotations.forEach(o=>{if(o.resolved)return;let{x:t,y:e,elementId:i,type:s}=JSON.parse(o.position);if(s!=="html"||this.pins.has(o.uuid)||!this.elementsWithDataId[i])return;let r=this.divWrappers.get(i);if(!r)return;let a=this.createPin(o,t,e);r.appendChild(a),this.pins.set(o.uuid,a)})}updatePinsPositions(){this.voidElementsWrappers.forEach((o,t)=>{let e=JSON.stringify(o.getBoundingClientRect()),i=this.elementsWithDataId[t].getBoundingClientRect();this.elementsWithDataId[t].tagName.toLowerCase()==="ellipse"&&(i=this.elementsWithDataId[t].viewportElement.getBoundingClientRect()),!ms(JSON.stringify(i),e)&&(o.style.setProperty("top",`${i.top}px`),o.style.setProperty("left",`${i.left}px`),o.style.setProperty("width",`${i.width}px`),o.style.setProperty("height",`${i.height}px`))})}clearElement(o){if(!this.elementsWithDataId[o])return;let e=this.divWrappers.get(o);if(e){let i=e.children,{length:s}=i;for(let n=0;n<s;++n){let r=i.item(n);this.pins.delete(r.id)}e.remove()}this.voidElementsWrappers.delete(o),this.removeElementListeners(o),this.divWrappers.delete(o),this.elementsWithDataId[o]=void 0,this.voidElementsWrappers.size||(cancelAnimationFrame(this.animateFrame),this.animateFrame=void 0)}resetSelectedPin(){!this.selectedPin||(this.selectedPin.removeAttribute("active"),this.selectedPin=null)}resetHoveredWrapper(){!this.hoveredWrapper||this.onMouseLeave({target:this.hoveredWrapper})}removeAnnotationsPins(){this.pins.forEach(o=>{o.remove()}),this.pins.clear()}setElementReadyToPin(o,t){if(!this.elementsWithDataId[t]){if(this.elementsWithDataId[t]=o,!this.divWrappers.get(t)){let e=this.createWrapper(o,t);this.divWrappers.set(t,e)}!this.isActive||!this.isPinsVisible||(this.addCursor(this.divWrappers.get(t),t),this.addElementListeners(t))}}handleSvgElement(o,t){let e=o.viewportElement;if(e===void 0)return;if(o.tagName.toLowerCase()==="svg"){let m=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");return m.setAttribute("height","100%"),m.setAttribute("width","100%"),m.style.setProperty("overflow","visible"),m.appendChild(t),o.appendChild(m),o.style.setProperty("overflow","visible"),t}let n=o.tagName.toLowerCase(),r=n==="ellipse",a=n==="rect";if(!r&&!a)return;let c=document.createElementNS("http://www.w3.org/2000/svg","svg"),d=document.createElementNS("http://www.w3.org/2000/svg",n),u,g,v,b,_,L;if(a){let m=o;u=m.getAttribute("x"),g=m.getAttribute("y"),v=m.getAttribute("width"),b=m.getAttribute("height"),_=m.getAttribute("rx"),L=m.getAttribute("ry"),d.setAttribute("fill","transparent"),d.setAttribute("stroke","transparent"),d.setAttribute("x","0"),d.setAttribute("y","0"),d.setAttribute("rx",_),d.setAttribute("ry",L)}if(r){let m=o.getAttribute("cx"),$=o.getAttribute("cy");_=o.getAttribute("rx"),L=o.getAttribute("ry"),u=Number(m)-Number(_),g=Number($)-Number(L);let{width:G,height:W}=e.getBoundingClientRect();v=`${G}px`,b=`${W}px`,d.setAttribute("fill","transparent"),d.setAttribute("stroke","transparent"),d.setAttribute("cx",m),d.setAttribute("cy",$),d.setAttribute("rx",_),d.setAttribute("ry",L)}return d.setAttribute("height",b),d.setAttribute("width",v),c.setAttribute("height",b),c.setAttribute("width",v),c.appendChild(d),t.appendChild(c),o.style.setProperty("overflow","visible"),t.setAttribute("data-wrapper-type",`svg-${n}`),t}addTemporaryPinToElement(o,t){if(!this.elementsWithDataId[o])return;let i=this.divWrappers.get(o);!i||i.appendChild(t)}createPin(o,t,e){let i=document.createElement("superviz-comments-annotation-pin");return i.setAttribute("type","show"),i.setAttribute("annotation",JSON.stringify(o)),i.setAttribute("position",JSON.stringify({x:t,y:e})),i.setAttribute("keepPositionRatio",""),i.setAttribute("participantsList",JSON.stringify(this.participants)),i.id=o.uuid,i}addCursor(o,t){let e=o,i=o.getAttribute("data-wrapper-type");if(i){let s=i.split("-")[1];e=this.divWrappers.get(t).querySelector(s)}e.style.setProperty("cursor",'url("https://production.cdn.superviz.com/static/pin-html.png") 0 100, pointer'),e.style.setProperty("pointer-events","auto")}createWrapper(o,t){var a;let e=`superviz-id-${t}`;if(this.divWrappers.get(t))return;let i=o.getBoundingClientRect(),s=document.createElement("div");s.setAttribute("data-wrapper-id",t),s.id=e,s.style.position="absolute",s.style.pointerEvents="none",s.style.transform="translateX(0) translateY(0) scale(1)",s.style.cursor="default",s.style.top="0",s.style.left="0",s.style.width="100%",s.style.height="100%",s.style.pointerEvents="none";let n=window.getComputedStyle(o).getPropertyValue("border-radius");if(s.style.borderRadius=n,!this.VOID_ELEMENTS.includes(this.elementsWithDataId[t].tagName.toLowerCase()))return this.elementsWithDataId[t].appendChild(s),this.setPositionNotStatic(this.elementsWithDataId[t]),s;s=(a=this.handleSvgElement(o,s))!=null?a:s,s.style.position="fixed",s.style.top=`${i.top}px`,s.style.left=`${i.left}px`,s.style.width=`${i.width}px`,s.style.height=`${i.height}px`;let r=this.elementsWithDataId[t].parentElement;return(!r||o.viewportElement)&&(r=document.body),this.setPositionNotStatic(r),r.appendChild(s),this.voidElementsWrappers.set(t,s),this.animateFrame||(this.animateFrame=requestAnimationFrame(this.animate)),s}setPositionNotStatic(o){let{position:t}=window.getComputedStyle(o);t==="static"&&o.style.setProperty("position","relative")}};l();import{isEqual as zi}from"lodash";l();import z from"bowser";var Vt=class{constructor(){this.browser=z.getParser(navigator.userAgent)}get clientStats(){return this.browser.getResult()}get isFirefox(){return this.browser.isBrowser(z.BROWSER_MAP.firefox)}get isSafari(){return this.browser.isBrowser(z.BROWSER_MAP.safari)}get isChrome(){return this.browser.isBrowser(z.BROWSER_MAP.chrome)}get isIE(){return this.browser.isBrowser(z.BROWSER_MAP.ie)}get isEdge(){return this.browser.isBrowser(z.BROWSER_MAP.edge)}get isMobileDevice(){return(this.browser.is(z.PLATFORMS_MAP.mobile)||this.browser.is(z.PLATFORMS_MAP.tablet))&&!navigator.userAgent.match(/iPad/i)}get isTabletDevice(){return this.browser.is(z.PLATFORMS_MAP.tablet)}get isAndroid(){return this.isMobileDevice&&!!navigator.userAgent.match(/Android/i)}get isIpad(){return!!navigator.userAgent.match(/iPad/i)}get isIphone(){return this.isMobileDevice&&!!navigator.userAgent.match(/iPhone/i)}get isAppleMobileDevice(){return this.isIpad||this.isIphone}};l();var be=class{constructor(){this.updateMeetingConnectionStatus=o=>{this.oldConnectionStatus=this.connectionStatus,this.connectionStatus=o,this.connectionStatusObserver.publish(o),this.logger.log("CONNECTION STATUS CHANGE",o)};this.onUpdateBrowserOnlineStatus=o=>{let{type:t}=o;if(t==="online"){this.updateMeetingConnectionStatus(1);return}this.updateMeetingConnectionStatus(4)};this.logger=new A("@superviz/sdk/connection-service"),this.connectionStatus=0,this.connectionStatusObserver=new E({logger:this.logger})}addListeners(){window.addEventListener("online",this.onUpdateBrowserOnlineStatus),window.addEventListener("offline",this.onUpdateBrowserOnlineStatus)}removeListeners(){window.removeEventListener("online",this.onUpdateBrowserOnlineStatus),window.removeEventListener("offline",this.onUpdateBrowserOnlineStatus)}};l();l();var fe=class{build(o,t,e,i={},s={}){let n=document.querySelector(`#${o}`),r=new URL(t);if(this.wrapperId||this.element)throw new Error("Tried to initialize two frames with the same FrameBricklayer instance");this.element=document.createElement("iframe"),Object.entries(i).forEach(([a,c])=>{r.searchParams.set(a,c)}),Object.entries(s).forEach(([a,c])=>{this.element.setAttribute(a,c)}),this.element.src=r.toString(),this.element.id=e,n.appendChild(this.element),this.wrapperId=o}destroy(){if(!this.wrapperId)throw new Error("Tried to destroy a frame before it was initialized");let o=document.querySelector(`#${this.wrapperId}`);!!o&&!!o.querySelector(`#${this.element.id}`)&&o.removeChild(this.element),this.wrapperId=null,this.element=null}};l();var ye=class{constructor(o){this.observers={};this.sourceBlockList=["vue-devtools-proxy","vue-devtools-backend"];this.originBlockList=["https://sketchfab.com"];this.publish=(o,t={})=>{this.logger.log("MessageBridge","Posting message to frame",o,t),this.contentWindow.postMessage({type:o,data:t},this.allowedOrigins)};this.listen=(o,t)=>{this.observers[o]||(this.observers[o]=new E({logger:this.logger})),this.observers[o].subscribe(t)};this.onReceiveMessage=o=>{let{type:t,data:e,source:i}=o.data;if(this.sourceBlockList.includes(i)||this.originBlockList.includes(o.origin))return;let s=!!t,n=!this.domains.length||this.domains.includes(o.origin),r=this.observers.hasOwnProperty(t);if(this.logger.log("MessageBridge",`Message received -
        TYPE: ${o.type}
        ORIGIN: ${o.origin}
        DATA: ${JSON.stringify(o.data)} `),!s||!n||!r){this.logger.log("MessageBridge","Message discarded");return}this.observers[t].publish(e)};let{contentWindow:t,domains:e=[],allowedOrigins:i="*",sourceBlockList:s=[],logger:n}=o;if(this.logger=n,this.domains=e,this.allowedOrigins=i,this.sourceBlockList.push(...s),typeof window=="undefined")throw new Error("MessageBridge: window is undefined");this.contentWindow=t,window.addEventListener("message",this.onReceiveMessage)}destroy(){Object.entries(this.observers).forEach(([o,t])=>{t.reset(),delete this.observers[o]}),window.removeEventListener("message",this.onReceiveMessage),delete this.logger,delete this.allowedOrigins,delete this.contentWindow,delete this.domains,delete this.observers,delete this.sourceBlockList}};l();var jt=(e=>(e.RIGHT="right",e.CENTER="center",e.LEFT="left",e))(jt||{}),Ee=(t=>(t.GRID="grid",t.LIST="list",t))(Ee||{}),we=(i=>(i.RIGHT="right",i.LEFT="left",i.TOP="top",i.BOTTOM="bottom",i))(we||{});var Gi="sv-video-frame",Jt=class{constructor(o){this.logger=new A("@superviz/sdk/video-conference-manager");this.frameStateObserver=new E({logger:this.logger});this.frameSizeObserver=new E({logger:this.logger});this.waitingForHostObserver=new E({logger:this.logger});this.realtimeEventsObserver=new E({logger:this.logger});this.sameAccountErrorObserver=new E({logger:this.logger});this.devicesObserver=new E({logger:this.logger});this.meetingStateObserver=new E({logger:this.logger});this.meetingConnectionObserver=new E({logger:this.logger});this.participantJoinedObserver=new E({logger:this.logger});this.participantLeftObserver=new E({logger:this.logger});this.participantListObserver=new E({logger:this.logger});this.frameState=0;this.layoutModalsAndCamerasConfig=(o,t)=>{let e=o,i=t,s=["left","right","bottom","top"].includes(i),n=["left","right","center"].includes(e);return s||(i="right"),n||(e="right"),this.browserService.isMobileDevice?(i="bottom",{layoutPosition:e,camerasPosition:i}):(e==="left"&&i==="right"&&(e="right"),e==="right"&&i==="left"&&(e="left"),{layoutPosition:e,camerasPosition:i})};this.onFrameLoad=()=>{this.messageBridge=new ye({logger:this.logger,contentWindow:this.bricklayer.element.contentWindow}),this.addMessagesListeners(),this.updateFrameState(2),this.updateFrameLocale(),this.updateMeetingAvatars(),this.onWindowResize(),this.setCustomColors(),this.setCallbacks()};this.setFrameOffset=o=>{let t=o!=null?o:{};["top","bottom","left","right"].forEach(e=>{Object.keys(t).includes(e)||(t[e]=0)}),this.frameOffset=t};this.setCustomColors=()=>{this.customColors&&this.messageBridge.publish("frame.color-list-update",this.customColors),this.styles&&this.messageBridge.publish("frame.styles-update",this.styles)};this.setCallbacks=()=>{if(!this.callbacks)return;let o={onToggleMicrophone:!!this.callbacks.onToggleMicrophone,onToggleCam:!!this.callbacks.onToggleCam,onToggleTranscript:!!this.callbacks.onToggleTranscript,onToggleChat:!!this.callbacks.onToggleChat,onToggleScreenShare:!!this.callbacks.onToggleScreenShare,onClickHangup:!!this.callbacks.onClickHangup,onToggleMeetingSetup:!!this.callbacks.onToggleMeetingSetup};this.messageBridge.listen("callback-called",t=>{var e,i;(i=(e=this.callbacks)[t])==null||i.call(e)}),this.messageBridge.publish("frame.callbacks-update",JSON.stringify(o))};this.setFrameStyle=o=>{let t=document.createElement("style"),{bottom:e,left:i,right:s,top:n}=this.frameOffset;if(t.innerHTML=`
      :root {
        --superviz-offset-top: ${n}px;
        --superviz-offset-right: ${s}px;
        --superviz-offset-left: ${i}px;
        --superviz-offset-bottom: ${e}px;
      }     
    `,document.head.appendChild(t),this.browserService.isMobileDevice){this.bricklayer.element.classList.add("sv-video-frame--bottom");return}this.bricklayer.element.classList.add(`sv-video-frame--${o}`)};this.onFrameDimensionsUpdate=({width:o,height:t})=>{let e=document.getElementById(Gi),{bottom:i,right:s,left:n,top:r}=this.frameOffset,a=this.isWaterMarkEnabled?40:0,c=`${o}px`,d=`${t+a}px`;(o>=window.innerWidth||this.isHorizontalCameraEnabled)&&(c=`calc(100% - ${s}px - ${n}px)`),t>=window.innerHeight&&(d=`calc(100% - ${r}px - ${i}px)`),e.style.width=c,e.style.height=d,this.frameSizeObserver.publish({width:e.offsetWidth,height:e.offsetHeight})};this.onWindowResize=()=>{let{top:o,bottom:t,right:e,left:i}=this.frameOffset,{innerHeight:s,innerWidth:n}=window,r=s-o-t,a=n-e-i;!this.messageBridge||this.messageBridge.publish("frame.parent-window-size-update",{height:r,width:a})};this.updateFrameLocale=()=>{var s,n;if(!this.frameLocale||!((s=this.frameLocale)!=null&&s.language)&&((n=this.frameLocale)==null?void 0:n.locales))return;let{language:o,locales:t}=this.frameLocale,e=t.map(r=>r==null?void 0:r.language),i=["en",...e];if(o&&!i.includes(o))throw new Error("The default language is not available in the language listing.");this.messageBridge.publish("frame.locales-update",this.frameLocale)};this.updateMeetingAvatars=()=>{this.messageBridge.publish("frame.avatar-list-update",this.meetingAvatars)};this.onParticipantJoined=o=>{this.participantJoinedObserver.publish(o)};this.onParticipantLeft=o=>{this.participantLeftObserver.publish(o)};this.onMeetingHostChange=o=>{this.realtimeEventsObserver.publish({event:"realtime.host-change",data:o})};this.onMeetingKickParticipant=o=>{this.realtimeEventsObserver.publish({event:"meeting.kick-participant",data:o})};this.onFollowParticipantDidChange=o=>{this.realtimeEventsObserver.publish({event:"realtime.follow-participant",data:o})};this.onGoToDidChange=o=>{this.realtimeEventsObserver.publish({event:"realtime.go-to-participant",data:o})};this.onGather=()=>{this.realtimeEventsObserver.publish({event:"realtime.gather",data:!0})};this.onGridModeChange=o=>{this.realtimeEventsObserver.publish({event:"realtime.grid-mode-change",data:o})};this.onDrawingChange=o=>{this.realtimeEventsObserver.publish({event:"realtime.drawing-change",data:o})};this.onTranscriptChange=o=>{this.realtimeEventsObserver.publish({event:"realtime.transcript-change",data:o})};this.onSameAccountError=o=>{this.sameAccountErrorObserver.publish(o)};this.onDevicesChange=o=>{this.devicesObserver.publish(o)};this.meetingStateUpdate=o=>{this.meetingStateObserver.publish(o)};this.onConnectionStatusChange=o=>{this.meetingConnectionObserver.publish(o)};this.onWaitingForHostDidChange=o=>{this.waitingForHostObserver.publish(o)};this.onParticipantListUpdate=o=>{this.participantListObserver.publish(o)};var Lt,It,Rt,Mt;let{language:t,canUseCams:e,canUseChat:i,canUseScreenshare:s,canUseDefaultAvatars:n,canUseFollow:r,canUseGoTo:a,canUseGather:c,canShowAudienceList:d,canUseDefaultToolbar:u,canUseTranscription:g,browserService:v,offset:b,locales:_,avatars:L,customColors:m,styles:$,waterMark:G,layoutPosition:W,camerasPosition:ae,skipMeetingSettings:S,devices:N,layoutMode:le,collaborationMode:pe,callbacks:ce}=o;this.browserService=v;let gt=this.layoutModalsAndCamerasConfig(W,ae),U=document.createElement("div");this.frameConfig={apiKey:y.get("apiKey"),apiUrl:y.get("apiUrl"),ablyKey:y.get("ablyKey"),debug:y.get("debug"),roomId:y.get("roomId"),limits:y.get("limits"),collaborationMode:pe,canUseFollow:r,canUseGoTo:a,canUseCams:e,canUseChat:i,canUseGather:c,canUseScreenshare:s,canUseDefaultAvatars:n,canUseTranscription:g,canShowAudienceList:d,camerasPosition:(Lt=gt.camerasPosition)!=null?Lt:"right",canUseDefaultToolbar:u,devices:{audioInput:(It=N==null?void 0:N.audioInput)!=null?It:!0,audioOutput:(Rt=N==null?void 0:N.audioOutput)!=null?Rt:!0,videoInput:(Mt=N==null?void 0:N.videoInput)!=null?Mt:!0},waterMark:G,layoutMode:le,skipMeetingSettings:S,layoutPosition:gt.layoutPosition},this.customColors=m,this.callbacks=ce,this.styles=$,U.classList.add("sv_video_wrapper"),U.id="sv-video-wrapper",document.body.appendChild(U),this.updateFrameState(1),this.bricklayer=new fe,this.bricklayer.build(U.id,y.get("conferenceLayerUrl"),Gi,void 0,{allow:"camera *;microphone *; display-capture *;"}),this.setFrameOffset(b),this.setFrameStyle(gt.camerasPosition),this.bricklayer.element.addEventListener("load",this.onFrameLoad),this.frameLocale={language:t,locales:_},this.meetingAvatars=L,window.addEventListener("resize",this.onWindowResize),window.addEventListener("orientationchange",this.onWindowResize)}get isWaterMarkEnabled(){return this.browserService.isMobileDevice?!1:this.frameConfig.waterMark}get isHorizontalCameraEnabled(){return this.browserService.isMobileDevice?!1:["top","bottom"].includes(this.frameConfig.camerasPosition)}addMessagesListeners(){this.messageBridge.listen("meeting.waiting-for-host",this.onWaitingForHostDidChange),this.messageBridge.listen("meeting.participant-joined",this.onParticipantJoined),this.messageBridge.listen("meeting.participant-list-update",this.onParticipantListUpdate),this.messageBridge.listen("meeting.participant-left",this.onParticipantLeft),this.messageBridge.listen("meeting.host-change",this.onMeetingHostChange),this.messageBridge.listen("meeting.kick-participant",this.onMeetingKickParticipant),this.messageBridge.listen("meeting.same-participant-error",this.onSameAccountError),this.messageBridge.listen("meeting.state-update",this.meetingStateUpdate),this.messageBridge.listen("meeting.connection-status-change",this.onConnectionStatusChange),this.messageBridge.listen("meeting.devices-change",this.onDevicesChange),this.messageBridge.listen("realtime.grid-mode-change",this.onGridModeChange),this.messageBridge.listen("realtime.drawing-change",this.onDrawingChange),this.messageBridge.listen("realtime.transcript-change",this.onTranscriptChange),this.messageBridge.listen("frame.dimensions-update",this.onFrameDimensionsUpdate),this.messageBridge.listen("realtime.follow-participant",this.onFollowParticipantDidChange),this.messageBridge.listen("realtime.go-to-participant",this.onGoToDidChange),this.messageBridge.listen("realtime.gather",this.onGather)}updateFrameState(o){o!==this.frameState&&(this.frameState=o,this.frameStateObserver.publish(this.frameState));let t={[1]:6,[2]:7,[0]:8};this.meetingStateUpdate(t[o])}start(o){this.messageBridge.publish("meeting.start",C(f({},o),{config:this.frameConfig}))}leave(){this.messageBridge.publish("meeting.leave"),this.destroy()}destroy(){var o,t,e,i,s,n,r,a,c,d;(o=this.messageBridge)==null||o.destroy(),(t=this.bricklayer)==null||t.destroy(),(e=this.frameSizeObserver)==null||e.destroy(),(i=this.realtimeEventsObserver)==null||i.destroy(),(s=this.sameAccountErrorObserver)==null||s.destroy(),(n=this.devicesObserver)==null||n.destroy(),(r=this.meetingStateObserver)==null||r.destroy(),(a=this.meetingConnectionObserver)==null||a.destroy(),(c=this.participantJoinedObserver)==null||c.destroy(),(d=this.participantLeftObserver)==null||d.destroy(),this.bricklayer=null,this.frameState=null,window.removeEventListener("resize",this.onWindowResize),window.removeEventListener("orientationchange",this.onWindowResize)}publishMessageToFrame(o,t){!this.messageBridge||this.messageBridge.publish(o,t)}};var vs=1e3*60,Kt=null,qt=class extends M{constructor(t){var s,n;super();this.participantToFrameList=[];this.participantsOnMeeting=[];this.kickParticipantsOnHostLeave=!1;this.startVideo=()=>{var t,e,i,s,n,r,a,c,d,u,g,v,b,_,L,m,$,G,W,ae,S,N,le,pe,ce,gt,U,Lt,It,Rt,Mt,Oi,Li,Ii,Ri,Mi,ki;this.videoConfig={language:(t=this.params)==null?void 0:t.language,canUseTranscription:((e=this.params)==null?void 0:e.transcriptOff)===!1,canShowAudienceList:(s=(i=this.params)==null?void 0:i.showAudienceList)!=null?s:!0,canUseChat:!((n=this.params)!=null&&n.chatOff),canUseCams:!((r=this.params)!=null&&r.camsOff),canUseScreenshare:!((a=this.params)!=null&&a.screenshareOff),canUseDefaultAvatars:!!((c=this.params)!=null&&c.defaultAvatars)&&!((u=(d=this.localParticipant)==null?void 0:d.avatar)!=null&&u.model3DUrl),canUseGather:!!((g=this.params)!=null&&g.enableGather),canUseFollow:!!((v=this.params)!=null&&v.enableFollow),canUseGoTo:!!((b=this.params)!=null&&b.enableGoTo),canUseDefaultToolbar:(L=(_=this.params)==null?void 0:_.defaultToolbar)!=null?L:!0,camerasPosition:($=(m=this.params)==null?void 0:m.collaborationMode)==null?void 0:$.position,devices:(G=this.params)==null?void 0:G.devices,skipMeetingSettings:(W=this.params)==null?void 0:W.skipMeetingSettings,browserService:this.browserService,offset:(ae=this.params)==null?void 0:ae.offset,locales:(N=(S=this.params)==null?void 0:S.locales)!=null?N:[],avatars:(pe=(le=this.params)==null?void 0:le.avatars)!=null?pe:[],customColors:y.get("colors"),waterMark:y.get("waterMark"),styles:(ce=this.params)==null?void 0:ce.styles,collaborationMode:(Lt=(U=(gt=this.params)==null?void 0:gt.collaborationMode)==null?void 0:U.enabled)!=null?Lt:!0,layoutPosition:((Rt=(It=this.params)==null?void 0:It.collaborationMode)==null?void 0:Rt.enabled)===!1?"center":(Li=(Oi=(Mt=this.params)==null?void 0:Mt.collaborationMode)==null?void 0:Oi.modalPosition)!=null?Li:"center",layoutMode:(Mi=(Ri=(Ii=this.params)==null?void 0:Ii.collaborationMode)==null?void 0:Ri.initialView)!=null?Mi:"list",callbacks:(ki=this.params)==null?void 0:ki.callbacks},this.logger.log("video conference @ start video",this.videoConfig),this.videoManager=new Jt(this.videoConfig),this.subscribeToVideoEvents()};this.subscribeToVideoEvents=()=>{this.logger.log("video conference @ subscribe to video events"),this.videoManager.meetingConnectionObserver.subscribe(this.connectionService.updateMeetingConnectionStatus),this.videoManager.participantListObserver.subscribe(this.onParticipantListUpdate),this.videoManager.waitingForHostObserver.subscribe(this.onWaitingForHost),this.videoManager.frameSizeObserver.subscribe(this.onFrameSizeDidChange),this.videoManager.meetingStateObserver.subscribe(this.onMeetingStateChange),this.videoManager.frameStateObserver.subscribe(this.onFrameStateChange),this.videoManager.realtimeEventsObserver.subscribe(this.onRealtimeEventFromFrame),this.videoManager.participantJoinedObserver.subscribe(this.onParticipantJoined),this.videoManager.participantLeftObserver.subscribe(this.onParticipantLeft),this.videoManager.sameAccountErrorObserver.subscribe(this.onSameAccountError),this.videoManager.devicesObserver.subscribe(this.onDevicesChange)};this.unsubscribeFromVideoEvents=()=>{this.logger.log("video conference @ unsubscribe from video events"),this.videoManager.meetingConnectionObserver.unsubscribe(this.connectionService.updateMeetingConnectionStatus),this.videoManager.participantListObserver.unsubscribe(this.onParticipantListUpdate),this.videoManager.waitingForHostObserver.unsubscribe(this.onWaitingForHost),this.videoManager.frameSizeObserver.unsubscribe(this.onFrameSizeDidChange),this.videoManager.meetingStateObserver.unsubscribe(this.onMeetingStateChange),this.videoManager.frameStateObserver.unsubscribe(this.onFrameStateChange),this.videoManager.realtimeEventsObserver.unsubscribe(this.onRealtimeEventFromFrame),this.videoManager.participantJoinedObserver.unsubscribe(this.onParticipantJoined),this.videoManager.participantLeftObserver.unsubscribe(this.onParticipantLeft),this.videoManager.sameAccountErrorObserver.unsubscribe(this.onSameAccountError),this.videoManager.devicesObserver.unsubscribe(this.onDevicesChange)};this.suscribeToRealtimeEvents=()=>{this.logger.log("video conference @ subscribe to realtime events"),this.realtime.kickAllParticipantsObserver.subscribe(this.onKickAllParticipantsDidChange),this.realtime.kickParticipantObserver.subscribe(this.onKickLocalParticipant),this.realtime.participantJoinedObserver.subscribe(this.onParticipantJoinedOnRealtime),this.realtime.participantLeaveObserver.subscribe(this.onParticipantLeftOnRealtime),this.realtime.roomInfoUpdatedObserver.subscribe(this.onRoomInfoUpdated),this.realtime.participantsObserver.subscribe(this.onRealtimeParticipantsDidChange)};this.unsubscribeFromRealtimeEvents=()=>{this.logger.log("video conference @ unsubscribe from realtime events"),this.realtime.kickAllParticipantsObserver.unsubscribe(this.onKickAllParticipantsDidChange),this.realtime.participantJoinedObserver.unsubscribe(this.onParticipantJoinedOnRealtime),this.realtime.participantLeaveObserver.unsubscribe(this.onParticipantLeftOnRealtime),this.realtime.roomInfoUpdatedObserver.unsubscribe(this.onRoomInfoUpdated),this.realtime.participantsObserver.unsubscribe(this.onRealtimeParticipantsDidChange)};this.createParticipantFromAblyPresence=t=>{var e;return{id:t.clientId,color:this.realtime.getSlotColor((e=t.data)==null?void 0:e.slotIndex).color,avatar:t.data.avatar,type:t.data.type,name:t.data.name,isHost:this.realtime.hostClientId===t.clientId}};this.onFrameSizeDidChange=t=>{this.publish("frame.dimensions-update",t)};this.onWaitingForHost=t=>{this.publish("meeting.waiting-for-host",t)};this.onConnectionStatusChange=t=>{this.logger.log("video conference @ on connection status change",t);let e=[2,4,3,6];e.includes(t)&&this.realtime.freezeSync(!0),e.includes(this.connectionService.oldConnectionStatus)&&!e.includes(t)&&this.realtime.freezeSync(!1),this.publish("meeting.connection-status-change",t)};this.onMeetingStateChange=t=>{this.logger.log("video conference @ on meeting state change",t),this.publish("meeting.state-update",t)};this.onSameAccountError=t=>{this.publish("meeting.same-participant-error",t),this.detach()};this.onDevicesChange=t=>{this.publish("meeting.devices-change",t)};this.onFrameStateChange=t=>{this.logger.log("video conference @ on frame state change",t),t===2&&(this.params.userType!=="guest"&&(this.localParticipant=Object.assign(this.localParticipant,{type:this.params.userType}),this.realtime.updateMyProperties(f({},this.localParticipant))),this.videoManager.start({group:this.group,participant:this.localParticipant,roomId:y.get("roomId")}),this.publish("meeting.start"))};this.onRealtimeEventFromFrame=({event:t,data:e})=>{this.logger.log("video conference @ on realtime event from frame",t,e);let i={["realtime.host-change"]:s=>this.realtime.setHost(s),["realtime.gather"]:s=>this.realtime.setGather(s),["realtime.grid-mode-change"]:s=>this.realtime.setGridMode(s),["realtime.drawing-change"]:s=>{this.realtime.setDrawing(s)},["realtime.follow-participant"]:s=>{this.realtime.setFollowParticipant(s)},["meeting.kick-participant"]:s=>{this.realtime.setKickParticipant(s)},["realtime.transcript-change"]:s=>{this.realtime.setTranscript(s)},["realtime.go-to-participant"]:s=>{this.eventBus.publish("realtime.go-to-participant",s)}}[t](e);this.publish(t,e)};this.onParticipantJoined=t=>{var e;if(this.logger.log("video conference @ on participant joined",t),this.localParticipant=t,this.publish("meeting.participant-joined",t),this.publish("my-participant.joined",t),this.kickParticipantsOnHostLeave=!((e=this.params)!=null&&e.allowGuests),this.videoConfig.canUseDefaultAvatars){this.realtime.updateMyProperties({avatar:t.avatar,name:t.name,type:t.type});return}this.realtime.updateMyProperties({name:t.name,type:t.type})};this.onParticipantLeft=t=>{this.logger.log("video conference @ on participant left",this.localParticipant),this.publish("my-participant.left",this.localParticipant),this.detach()};this.onParticipantListUpdate=t=>{this.logger.log("video conference @ on participant list update",t);let e=t.map(i=>{var n;let s=this.realtime.getParticipants[i.id];return{id:i.id,color:(n=i.color)!=null?n:this.realtime.getSlotColor(s.data.slotIndex).color,avatar:i.avatar,name:i.name,type:i.type,isHost:i.isHost}});zi(this.participantsOnMeeting,e)||(this.publish("meeting.participant-list-update",e),this.participantsOnMeeting.length!==e.length&&this.publish("meeting.amount-of-participants-update",e.length),this.participantsOnMeeting=e)};this.onKickAllParticipantsDidChange=t=>{this.logger.log("video conference @ on kick all participants did change",t),this.publish("meeting.kick-all-participants",t),this.detach()};this.onKickLocalParticipant=()=>{this.logger.log("video conference @ on kick local participant"),this.publish("meeting.kick-participant",this.localParticipant),this.detach()};this.onRoomInfoUpdated=t=>{this.logger.log("video conference @ on room info updated",t);let{isGridModeEnable:e,followParticipantId:i,gather:s,drawing:n,transcript:r,hostClientId:a}=t;this.videoManager.publishMessageToFrame("realtime.host-change",a),this.onHostParticipantDidChange(a),this.videoManager.publishMessageToFrame("realtime.grid-mode-change",e),this.videoManager.publishMessageToFrame("realtime.drawing-change",n),this.videoManager.publishMessageToFrame("realtime.follow-participant",i),this.videoManager.publishMessageToFrame("realtime.transcript-change",r),this.realtime.hostClientId===this.localParticipant.id&&s&&this.realtime.setGather(!1)};this.onRealtimeParticipantsDidChange=t=>{this.logger.log("video conference @ on participants did change",t);let e=Object.values(t).map(i=>({timestamp:i.timestamp,connectionId:i.connectionId,participantId:i.clientId,color:this.realtime.getSlotColor(i.data.slotIndex).name,name:i.data.name,isHost:this.realtime.hostClientId===i.clientId,avatar:i.data.avatar,type:i.data.type}));zi(this.participantToFrameList,e)||this.videoManager.publishMessageToFrame("realtime.participant-list-update",e),this.participantToFrameList=e,this.validateIfInTheRoomHasHost(t)};this.onHostParticipantDidChange=t=>{this.logger.log("video conference @ on host participant did change",t),this.videoManager.publishMessageToFrame("realtime.host-change",t);let e=this.participantsOnMeeting.find(i=>i.id===t);this.publish("meeting.host-change",e)};this.onHostAvailabilityChange=t=>{if(this.logger.log("launcher service @ onHostAvailabilityChange"),t){this.publish("meeting.host-available");return}this.publish("meeting.no-host-available")};this.onParticipantJoinedOnRealtime=t=>{this.logger.log("video conference @ on participant joined on realtime",t),this.publish("meeting.participant-joined",this.createParticipantFromAblyPresence(t))};this.onParticipantLeftOnRealtime=t=>{this.logger.log("video conference @ on participant left on realtime",t),this.publish("meeting.participant-left",this.createParticipantFromAblyPresence(t))};this.validateIfInTheRoomHasHost=t=>{let e=Object.values(t).filter(n=>n.data.type==="host"),i=e.some(n=>n.clientId===this.realtime.hostClientId);if(!e.length&&this.kickParticipantsOnHostLeave&&this.localParticipant.type!=="host"&&!Kt&&(this.logger.log("video conference @ validate if in the room has host - init kick all participants timeout"),Kt=setTimeout(()=>{this.logger.log("video conference @ validate if in the room has host - kick all participants"),this.onKickLocalParticipant()},vs)),e.length&&Kt&&(this.logger.log("video conference @ validade if in the room has host - clear kick all participants timeout"),clearTimeout(Kt),Kt=null),this.onHostAvailabilityChange(!!e.length),!e.length||i)return;let s=e.reduce((n,r)=>(this.logger.log("video conference @ validade if in the room has host - reducing participants",{previus:n,current:r}),!n||r.clientId===this.realtime.hostClientId||r.timestamp>n.timestamp?r:n),null);s.clientId===this.realtime.hostClientId||s.clientId!==this.localParticipant.id||(this.logger.log("video conference @ validade if in the room has host - set host",s),this.realtime.setHost(s.clientId))};this.params=C(f({},t),{userType:(n=(s=t==null?void 0:t.participantType)!=null?s:t==null?void 0:t.userType)!=null?n:"guest"}),this.name="videoConference";let{localParticipant:e,group:i}=this.useStore("global-store");e.subscribe(),i.subscribe(),this.logger=new A(`@superviz/sdk/${"videoConference"}`),this.browserService=new Vt,this.connectionService=new be,this.connectionService.addListeners(),this.connectionService.connectionStatusObserver.subscribe(this.onConnectionStatusChange)}toggleMeetingSetup(){return this.videoManager.publishMessageToFrame("meeting-controls.toggle-setup")}toggleMicrophone(){return this.videoManager.publishMessageToFrame("meeting-controls.toggle-microphone")}toggleCam(){this.videoManager.publishMessageToFrame("meeting-controls.toggle-cam")}toggleScreenShare(){return this.videoManager.publishMessageToFrame("meeting-controls.toggle-screenshare")}toggleChat(){return this.videoManager.publishMessageToFrame("meeting-controls.toggle-chat")}toggleTranscript(){return this.videoManager.publishMessageToFrame("meeting-controls.toggle-transcript")}hangUp(){this.videoManager.publishMessageToFrame("hang-up")}start(){this.logger.log("video conference @ start"),this.suscribeToRealtimeEvents(),this.startVideo()}destroy(){this.logger.log("video conference @ destroy");let{data:t}=this.realtime.participant,e=t.activeComponents.filter(i=>i!=="videoConference");this.realtime.updateMyProperties({activeComponents:e,type:"guest"}),this.kickParticipantsOnHostLeave=!1,this.publish("destroy"),this.unsubscribeFromRealtimeEvents(),this.unsubscribeFromVideoEvents(),this.videoManager.leave(),this.connectionService.removeListeners()}};l();l();import*as j from"@superviz/socket-client";import{throttle as gs}from"lodash";var Pe=class extends M{constructor(t,e){var s;super();this.transformation={translate:{x:0,y:0},scale:1};this.subscribeToRealtimeEvents=()=>{this.logger.log("presence-mouse component @ subscribe to realtime events"),this.room.presence.on(j.PresenceEvents.JOINED_ROOM,this.onPresenceJoinedRoom),this.room.presence.on(j.PresenceEvents.LEAVE,this.onPresenceLeftRoom),this.room.presence.on(j.PresenceEvents.UPDATE,this.onPresenceUpdate)};this.unsubscribeFromRealtimeEvents=()=>{this.logger.log("presence-mouse component @ unsubscribe from realtime events"),this.room.presence.off(j.PresenceEvents.JOINED_ROOM),this.room.presence.off(j.PresenceEvents.LEAVE),this.room.presence.off(j.PresenceEvents.UPDATE)};this.setParticipantPrivate=t=>{this.isPrivate=t,this.room.presence.update({visible:!t})};this.onPresenceJoinedRoom=t=>{t.id===this.localParticipant.id&&this.room.presence.update(this.localParticipant)};this.onPresenceLeftRoom=t=>{this.removePresenceMouseParticipant(t.id)};this.onPresenceUpdate=t=>{if(this.following&&this.presences.get(this.following)&&this.goToMouse(this.following),t.id===this.localParticipant.id)return;let e=t.data;if(this.following&&e.id!==this.following&&this.presences.has(e.id)){this.removePresenceMouseParticipant(e.id);return}this.presences.set(e.id,e)};this.animate=()=>{this.renderDivWrapper(),this.updateParticipantsMouses(),requestAnimationFrame(this.animate)};this.goToMouse=t=>{let e=this.presences.get(t);if(!e)return;let i=this.canvas.getBoundingClientRect(),{width:s,height:n}=i,{x:r,y:a}=e,c=s/2,d=n/2,u=c-r,g=d-a;this.goToMouseCallback&&this.goToMouseCallback({x:u,y:g})};this.onMyParticipantMouseMove=gs(t=>{let e=this.canvas.getContext("2d"),i=this.canvas.getBoundingClientRect(),s=t.x-i.left,n=t.y-i.top,a=(e==null?void 0:e.getTransform()).inverse(),c=new DOMPoint(s,n).matrixTransform(a),d={x:(c.x-this.transformation.translate.x)/this.transformation.scale,y:(c.y-this.transformation.translate.y)/this.transformation.scale};this.room.presence.update(C(f(f({},this.localParticipant),d),{visible:!this.isPrivate}))},30);this.onMyParticipantMouseOut=t=>{let{x:e,y:i,width:s,height:n}=this.canvas.getBoundingClientRect();t.x>0&&t.y>0&&t.x<e+s&&t.y<i+n||this.room.presence.update({visible:!1})};this.updateParticipantsMouses=()=>{this.presences.forEach(t=>{if(!(t!=null&&t.visible)||this.following&&this.following!==t.id){this.removePresenceMouseParticipant(t.id);return}this.renderPresenceMouses(t)})};this.renderPresenceMouses=t=>{let i=document.getElementById(`mouse-${t.id}`);i||(i=this.createMouseElement(t));let s=document.getElementById(`mouse-${t.id}`),n=document.getElementById(`mouse-${t.id}`);if(!s||!n)return;let r=s.getElementsByClassName("mouse-user-name")[0],a=n.getElementsByClassName("pointer-mouse")[0];a&&(a.style.backgroundImage=`url(https://production.cdn.superviz.com/static/pointers-v2/${t.slot.index}.svg)`),r&&(r.style.color=t.slot.textColor,r.style.backgroundColor=t.slot.color,r.innerHTML=t.name);let{x:c,y:d}=t,u=this.canvas.getContext("2d"),g=u==null?void 0:u.getTransform(),v=g==null?void 0:g.e,b=g==null?void 0:g.f,_=this.transformation.translate.x+(c+v)*this.transformation.scale,L=this.transformation.translate.y+(d+b)*this.transformation.scale,m=this.divWrapper.clientWidth>_&&this.divWrapper.clientHeight>L&&t.visible;i.style.opacity=m?"1":"0",i.style.left=`${_}px`,i.style.top=`${L}px`};this.followMouse=t=>{this.following=t,this.goToMouse(t)};if(this.name="presence",this.logger=new A(`@superviz/sdk/${"presence"}`),this.canvas=document.getElementById(t),this.presences=new Map,!this.canvas){let n=`Canvas with id ${t} not found`;throw this.logger.log(n),new Error(n)}this.divWrapper=this.renderDivWrapper(),this.animateFrame=requestAnimationFrame(this.animate),this.goToMouseCallback=(s=e==null?void 0:e.callbacks)==null?void 0:s.onGoToPresence;let{localParticipant:i}=this.useStore("global-store");i.subscribe()}start(){this.logger.log("presence-mouse component @ start"),this.canvas.addEventListener("mousemove",this.onMyParticipantMouseMove),this.canvas.addEventListener("mouseout",this.onMyParticipantMouseOut),this.eventBus.subscribe("realtime.go-to-participant",this.goToMouse),this.eventBus.subscribe("realtime.local-follow-participant",this.followMouse),this.eventBus.subscribe("realtime.private-mode",this.setParticipantPrivate),this.subscribeToRealtimeEvents()}destroy(){this.logger.log("presence-mouse component @ destroy"),this.eventBus.unsubscribe("realtime.go-to-participant",this.goToMouse),this.eventBus.unsubscribe("realtime.local-follow-participant",this.followMouse),this.eventBus.unsubscribe("realtime.private-mode",this.setParticipantPrivate),this.unsubscribeFromRealtimeEvents(),cancelAnimationFrame(this.animateFrame),this.canvas.removeEventListener("mousemove",this.onMyParticipantMouseMove),this.canvas.removeEventListener("mouseout",this.onMyParticipantMouseOut),this.divWrapper.remove()}renderDivWrapper(){let t=this.canvas.getBoundingClientRect(),e=document.getElementById("superviz-presence-mouse-wrapper");return e||(e=document.createElement("div"),e.id="superviz-presence-mouse-wrapper",this.canvas.parentElement.style.position="relative",this.canvas.parentElement.appendChild(e)),e.style.position="fixed",e.style.top=`${t.top}px`,e.style.left=`${t.left}px`,e.style.width=`${t.width}px`,e.style.height=`${t.height}px`,e.style.pointerEvents="none",e.style.overflow="hidden",e.style.zIndex="2",e}removePresenceMouseParticipant(t){let e=document.getElementById(`mouse-${t}`);e&&(e.remove(),this.presences.delete(t))}createMouseElement(t){let e=document.createElement("div");e.setAttribute("id",`mouse-${t.id}`),e.setAttribute("class","mouse-follower");let i=document.createElement("div");i.setAttribute("class","pointer-mouse");let s=document.createElement("div");return s.setAttribute("class","mouse-user-name"),s.innerHTML=t.name,e.appendChild(i),e.appendChild(s),e.style.left="0px",e.style.top="0px",this.divWrapper.appendChild(e),e}transform(t){this.transformation=t}};l();import*as J from"@superviz/socket-client";import{isEqual as bs}from"lodash";import{fromEvent as fs,throttleTime as ys}from"rxjs";l();var Te=(b=>(b.AREA="area",b.BASE="base",b.BR="br",b.COL="col",b.EMBED="embed",b.HR="hr",b.IMG="img",b.INPUT="input",b.LINK="link",b.META="meta",b.PARAM="param",b.SOURCE="source",b.TRACK="track",b.WBR="wbr",b))(Te||{}),Ae=(e=>(e.RECT="rect",e.ELLIPSE="ellipse",e.SVG="svg",e))(Ae||{});var Ce=class extends M{constructor(t,e){var s;super();this.presences=new Map;this.mouses=new Map;this.transformation={translate:{x:0,y:0},scale:1};this.onMyParticipantMouseMove=t=>{if(this.isPrivate)return;let e=t.currentTarget,{left:i,top:s}=e.getBoundingClientRect(),n=(t.x-i-this.transformation.translate.x)/this.transformation.scale,r=(t.y-s-this.transformation.translate.y)/this.transformation.scale;this.room.presence.update(C(f({},this.localParticipant),{x:n,y:r,visible:!0}))};this.onMyParticipantMouseLeave=t=>{let{left:e,top:i,right:s,bottom:n}=this.container.getBoundingClientRect(),r=t.x>e&&t.y>i&&t.x<s&&t.y<n,a=t.x>0&&t.y>0&&t.x<window.innerWidth&&t.y<window.innerHeight;r&&a||this.room.presence.update({visible:!1})};this.goToMouse=t=>{let e=this.mouses.get(t);if(!!e){if(this.goToPresenceCallback){let i=this.mouses.get(t),s=Number(i.style.left.replace("px","")),n=Number(i.style.top.replace("px",""));this.goToPresenceCallback({x:s,y:n});return}e.scrollIntoView({block:"center",inline:"center",behavior:"smooth"})}};this.followMouse=t=>{this.userBeingFollowedId=t,this.goToMouse(t)};this.setParticipantPrivate=t=>{this.isPrivate=t,this.room.presence.update({visible:!t})};this.onPresenceJoinedRoom=t=>{t.id===this.localParticipant.id&&this.room.presence.update(this.localParticipant)};this.onPresenceLeftRoom=t=>{this.removePresenceMouseParticipant(t.id)};this.onPresenceUpdate=t=>{if(t.id===this.localParticipant.id)return;let e=t.data;if(this.userBeingFollowedId&&e.id!==this.userBeingFollowedId&&this.presences.has(e.id)){this.removePresenceMouseParticipant(e.id);return}this.presences.set(e.id,e),this.animate(),this.updateParticipantsMouses()};this.animate=()=>{Te[this.containerTagname]&&this.updateVoidElementWrapper(),Ae[this.containerTagname]&&this.updateSVGElementWrapper(),this.animationFrame=requestAnimationFrame(this.animate)};this.updateParticipantsMouses=t=>{if(this.presences.forEach(i=>{if(i.id!==this.localParticipant.id){if(!(i!=null&&i.visible)){this.removePresenceMouseParticipant(i.id);return}this.renderPresenceMouses(i)}}),t)return;this.presences.has(this.userBeingFollowedId)&&this.goToMouse(this.userBeingFollowedId)};this.renderPresenceMouses=t=>{if(t.id===this.localParticipant.id)return;let e=document.getElementById(`mouse-${t.id}`);if(e||(e=this.createMouseElement(t)),!e)return;let i=e.getElementsByClassName("mouse-user-name")[0],s=e.getElementsByClassName("pointer-mouse")[0];s&&(s.style.backgroundImage=`url(https://production.cdn.superviz.com/static/pointers-v2/${t.slot.index}.svg)`),i&&(i.style.color=t.slot.textColor,i.style.backgroundColor=t.slot.color,i.innerHTML=t.name);let{x:n,y:r}=t,{translate:{x:a,y:c},scale:d}=this.transformation;e.style.left=`${a+n*d}px`,e.style.top=`${c+r*d}px`};this.renderVoidElementWrapper=()=>{let t=document.createElement("div"),e=this.container,{width:i,height:s,left:n,top:r}=this.container.getBoundingClientRect(),a=e.offsetLeft-n,c=e.offsetTop-r;t.style.position="absolute",t.style.width=`${i}px`,t.style.height=`${s}px`,t.style.top=`${r}px`,t.style.left=`${n}px`,t.style.overflow="visible",t.style.pointerEvents="none",this.container.parentElement.appendChild(t),this.wrapper=t};this.renderSVGElementWrapper=()=>{let t=this.containerTagname.toLowerCase();if(t==="svg"){this.createSVGWrapper();return}if(t==="rect"){this.createRectWrapper();return}t==="ellipse"&&this.createEllipseWrapper()};if(this.container=document.getElementById(t),this.logger=new A(`@superviz/sdk/${"presence"}`),!this.container){let n=`Element with id ${t} not found`;throw this.logger.log(n),new Error(n)}this.name="presence";let{localParticipant:i}=this.useStore("global-store");i.subscribe(),this.containerTagname=this.container.tagName.toUpperCase(),this.goToPresenceCallback=(s=e==null?void 0:e.callbacks)==null?void 0:s.onGoToPresence}start(){this.logger.log("presence-mouse component @ start"),this.renderWrapper(),this.addListeners(),this.subscribeToRealtimeEvents(),this.eventBus.subscribe("realtime.private-mode",this.setParticipantPrivate),this.animationFrame=requestAnimationFrame(this.animate),this.eventBus.subscribe("realtime.go-to-participant",this.goToMouse),this.eventBus.subscribe("realtime.local-follow-participant",this.followMouse)}destroy(){cancelAnimationFrame(this.animationFrame),this.logger.log("presence-mouse component @ destroy"),this.removeListeners(),this.wrapper.remove(),this.presences.clear(),this.presences=void 0,this.container=void 0,this.wrapper=void 0,this.unsubscribeFromRealtimeEvents(),this.eventBus.unsubscribe("realtime.private-mode",this.setParticipantPrivate),this.eventBus.unsubscribe("realtime.go-to-participant",this.goToMouse),this.eventBus.unsubscribe("realtime.local-follow-participant",this.followMouse),this.logger=void 0}subscribeToRealtimeEvents(){this.logger.log("presence-mouse component @ subscribe to realtime events"),this.room.presence.on(J.PresenceEvents.JOINED_ROOM,this.onPresenceJoinedRoom),this.room.presence.on(J.PresenceEvents.LEAVE,this.onPresenceLeftRoom),this.room.presence.on(J.PresenceEvents.UPDATE,this.onPresenceUpdate)}unsubscribeFromRealtimeEvents(){this.logger.log("presence-mouse component @ unsubscribe from realtime events"),this.room.presence.off(J.PresenceEvents.JOINED_ROOM),this.room.presence.off(J.PresenceEvents.LEAVE),this.room.presence.off(J.PresenceEvents.UPDATE)}addListeners(){this.pointerMoveObserver=fs(this.container,"pointermove").pipe(ys(30)).subscribe(this.onMyParticipantMouseMove),this.container.addEventListener("pointerleave",this.onMyParticipantMouseLeave)}removeListeners(){var t;(t=this.pointerMoveObserver)==null||t.unsubscribe(),this.container.removeEventListener("pointerleave",this.onMyParticipantMouseLeave)}setPositionNotStatic(){let{position:t}=window.getComputedStyle(this.container);t==="static"&&this.container.style.setProperty("position","relative")}createMouseElement(t){if(!this.wrapper)return;let e=document.createElement("div");e.setAttribute("id",`mouse-${t.id}`),e.setAttribute("class","mouse-follower");let i=document.createElement("div");i.setAttribute("class","pointer-mouse");let s=document.createElement("div");return s.setAttribute("class","mouse-user-name"),s.innerHTML=t.name,e.appendChild(i),e.appendChild(s),e.style.left="0px",e.style.top="0px",this.wrapper.appendChild(e),this.mouses.set(t.id,e),e}updateSVGPosition(){let t=this.container.parentElement.getBoundingClientRect(),e=this.container.getBoundingClientRect(),i=e.left-t.left,s=e.top-t.top,{width:n,height:r}=this.container.getBoundingClientRect();this.wrapper.style.setProperty("width",`${n}px`),this.wrapper.style.setProperty("height",`${r}px`),this.wrapper.style.setProperty("top",`${s}px`),this.wrapper.style.setProperty("left",`${i}px`)}createSVGWrapper(){let t=document.createElement("div"),e=this.container.parentElement.getBoundingClientRect(),i=this.container.getBoundingClientRect(),s=i.left-e.left,n=i.top-e.top,{width:r,height:a}=this.container.getBoundingClientRect();t.style.position="fixed",t.style.width=`${r}px`,t.style.height=`${a}px`,t.style.top=`${n}px`,t.style.left=`${s}px`,t.style.overflow="visible",t.style.pointerEvents="none",t.id="superviz-svg-wrapper",this.container.parentElement.appendChild(t),this.wrapper=t}createRectWrapper(){let t=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=document.createElementNS("http://www.w3.org/2000/svg","rect"),i=document.createElement("div"),s=this.container.getAttribute("width"),n=this.container.getAttribute("height"),r=this.container.getAttribute("rx"),a=this.container.getAttribute("ry");e.setAttribute("fill","transparent"),e.setAttribute("stroke","transparent"),e.setAttribute("x","0"),e.setAttribute("y","0"),e.setAttribute("rx",r),e.setAttribute("ry",a),e.setAttribute("height",n),e.setAttribute("width",s),t.setAttribute("height",n),t.setAttribute("width",s),t.appendChild(e),i.appendChild(t);let c=this.container.getBoundingClientRect();i.style.position="fixed",i.style.top=`${c.top}px`,i.style.left=`${c.left}px`,i.style.width=`${c.width}px`,i.style.height=`${c.height}px`,i.style.overflow="visible",i.style.pointerEvents="none",i.id="superviz-rect-wrapper";let d=this.container.viewportElement;for(;d.viewportElement;)d=d.viewportElement;d.parentElement.appendChild(i),this.wrapper=i}createEllipseWrapper(){let t=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=document.createElementNS("http://www.w3.org/2000/svg","ellipse"),i=document.createElement("div"),s=this.container.getAttribute("cx"),n=this.container.getAttribute("cy"),r=this.container.getAttribute("rx"),a=this.container.getAttribute("ry"),c=Number(s)-Number(r),d=Number(n)-Number(a),u=String(2*Number(s)),g=String(2*Number(n));e.setAttribute("fill","transparent"),e.setAttribute("stroke","transparent"),e.setAttribute("x","0"),e.setAttribute("y","0"),e.setAttribute("rx",r),e.setAttribute("ry",a),e.setAttribute("cx",`${Number(s)-c}`),e.setAttribute("cy",`${Number(n)-d}`),e.setAttribute("height",g),e.setAttribute("width",u),t.setAttribute("height",g),t.setAttribute("width",u),t.appendChild(e),i.appendChild(t);let v=this.container.getBoundingClientRect();i.style.position="fixed",i.style.top=`${v.top}px`,i.style.left=`${v.left}px`,i.style.width=`${v.width}px`,i.style.height=`${v.height}px`,i.style.overflow="visible",i.style.pointerEvents="none",i.id="superviz-ellipse-wrapper";let b=this.container.viewportElement;for(;b.viewportElement;)b=b.viewportElement;b.parentElement.appendChild(i),this.wrapper=i}transform(t){this.transformation=t,this.updateParticipantsMouses(!0)}updateVoidElementWrapper(){let t=this.container.getBoundingClientRect(),e=this.wrapper.getBoundingClientRect(),i=this.container;if(bs(t,e))return;let s=i.offsetLeft,n=i.offsetTop;this.wrapper.style.setProperty("width",`${t.width}px`),this.wrapper.style.setProperty("height",`${t.height}px`),this.wrapper.style.setProperty("top",`${n}px`),this.wrapper.style.setProperty("left",`${s}px`),this.wrapper.id="superviz-void-wrapper"}updateSVGElementWrapper(){let{left:t,top:e,width:i,height:s}=this.container.getBoundingClientRect(),{left:n,top:r,width:a,height:c}=this.wrapper.getBoundingClientRect();if(!(t===n&&e===r&&i===a&&s===c)){if(this.containerTagname.toLowerCase()==="svg"){this.updateSVGPosition();return}this.wrapper.style.setProperty("width",`${i}px`),this.wrapper.style.setProperty("height",`${s}px`),this.wrapper.style.setProperty("top",`${e}px`),this.wrapper.style.setProperty("left",`${t}px`)}}renderWrapper(){if(!this.wrapper){if(Te[this.containerTagname]){this.renderVoidElementWrapper();return}if(Ae[this.containerTagname]){this.renderSVGElementWrapper();return}this.renderElementWrapper()}}removePresenceMouseParticipant(t){let e=document.getElementById(`mouse-${t}`);e&&(e.remove(),this.presences.delete(t),this.mouses.delete(t))}renderElementWrapper(){let t=document.createElement("div");t.style.position="absolute",t.style.width="100%",t.style.height="100%",t.style.top="0",t.style.left="0",t.style.overflow="visible",t.style.pointerEvents="none",this.setPositionNotStatic(),this.container.appendChild(t),this.wrapper=t}};var Yt=class{constructor(o,t){let e=document.getElementById(o);if(!e)throw new Error(`[Superviz] Container with id ${o} not found`);return e.tagName.toLowerCase()==="canvas"?new Pe(o,t):new Ce(o,t)}transform(o){}};l();import*as Hi from"@superviz/socket-client";import Es from"lodash/throttle";l();var xe=(t=>(t.STARTED="STARTED",t.STOPPED="STOPPED",t))(xe||{}),_e=(o=>(o.REALTIME_STATE_CHANGED="realtime-component.state-changed",o))(_e||{});var Zt=class extends M{constructor(){super();this.callbacksToSubscribeWhenJoined=[];this.state="STOPPED";this.publish=Es((t,e)=>{if(Object.values(bt).includes(t)){this.publishEventToClient(t,e);return}if(this.state!=="STARTED"){let i=`Realtime component is not started yet. You can't publish event ${t} before start`;this.logger.log(i);return}this.room.emit("message",{name:t,payload:e})},30);this.subscribe=(t,e)=>{if(this.state!=="STARTED"){this.callbacksToSubscribeWhenJoined.push({event:t,callback:e});return}this.observers[t]||(this.observers[t]=new E),this.observers[t].subscribe(e)};this.unsubscribe=(t,e)=>{!this.observers[t]||this.observers[t].unsubscribe(e)};this.fetchHistory=t=>w(this,null,function*(){if(this.state!=="STARTED"){let i="Realtime component is not started yet. You can't retrieve history before start";return this.logger.log(i),null}return yield new Promise((i,s)=>{let n=r=>{var c;(c=r.events)!=null&&c.length||i(null);let a=r.events.reduce((d,u)=>(d[u.data.name]||(d[u.data.name]=[]),d[u.data.name].push({data:u.data.payload,name:u.data.name,participantId:u.presence.id,timestamp:u.timestamp}),d),{});t&&!a[t]&&s(new Error(`Event ${t} not found in the history`)),t&&i(a[t]),i(a)};this.room.history(n)})});this.publishEventToClient=(t,e)=>{this.logger.log("pubsub service @ publishEventToClient",{event:t,data:e}),this.observers[t]&&this.observers[t].publish(e)};this.name="realtime",this.logger=new A("@superviz/sdk/realtime-component");let{localParticipant:t}=this.useStore("global-store");t.subscribe()}destroy(){this.logger.log("destroyed"),this.changeState("STOPPED"),this.room.disconnect()}start(){this.logger.log("started"),this.subscribeToRealtimeEvents()}changeState(t){this.logger.log("realtime component @ changeState - state changed",t),this.state=t,this.publishEventToClient("realtime-component.state-changed",this.state)}subscribeToRealtimeEvents(){this.room.presence.on(Hi.PresenceEvents.JOINED_ROOM,t=>{t.id===this.localParticipant.id&&(this.changeState("STARTED"),this.callbacksToSubscribeWhenJoined.forEach(({event:e,callback:i})=>{this.subscribe(e,i)}),this.logger.log("joined room"),this.changeState("STARTED"))}),this.room.on("message",t=>{this.logger.log("message received",t),this.publishEventToClient(t.data.name,{data:t.data.payload,participantId:t.presence.id,name:t.data.name,timestamp:t.timestamp})})}};l();import{PresenceEvents as Ps}from"@superviz/socket-client";l();var qe=(i=>(i.TOP_LEFT="top-left",i.TOP_RIGHT="top-right",i.BOTTOM_LEFT="bottom-left",i.BOTTOM_RIGHT="bottom-right",i))(qe||{});var Xt=class extends M{constructor(t){var d;super();this.onParticipantListUpdate=t=>{let i=this.filterParticipants(Object.values(t)).map(n=>this.getParticipant(n)),s=this.setParticipants(i);this.setExtras(s)};this.goToMousePointer=({detail:{id:t}})=>{t!==this.localParticipantId&&(this.eventBus.publish("realtime.go-to-participant",t),this.publish("who-is-online.go-to-participant",t))};this.followMousePointer=({detail:t})=>{this.eventBus.publish("realtime.local-follow-participant",t.id),this.following&&this.publish("who-is-online.start-following-participant",this.following),this.following||this.publish("who-is-online.stop-following-participant"),t.source==="extras"&&this.highlightParticipantBeingFollowed(),this.updateParticipantsControls(t.id)};this.setPrivate=({detail:{isPrivate:t,id:e}})=>{let{privateMode:i}=this.useStore("who-is-online-store");i.publish(t),this.eventBus.publish("realtime.private-mode",t),this.realtime.setPrivateWIOParticipant(e,t),t&&this.publish("who-is-online.enter-private-mode"),t||this.publish("who-is-online.leave-private-mode")};this.setFollow=t=>{var s;if(t.clientId===this.localParticipantId)return;let e=(s=t.data)!=null&&s.id?t.data:void 0,{following:i}=this.useStore("who-is-online-store");i.publish(e),this.followMousePointer({detail:{id:e==null?void 0:e.id}})};this.follow=({detail:t})=>{let{everyoneFollowsMe:e}=this.useStore("who-is-online-store");e.publish(!!(t!=null&&t.id)),this.realtime.setFollowWIOParticipant(f({},t)),this.following&&this.publish("who-is-online.start-follow-me",this.following),this.following||this.publish("who-is-online.stop-follow-me"),this.updateParticipantsControls(t==null?void 0:t.id)};this.stopFollowing=(t,e)=>{var s;if(t.clientId!==((s=this.following)==null?void 0:s.id))return;let{following:i}=this.useStore("who-is-online-store");i.publish(void 0),this.eventBus.publish("realtime.local-follow-participant",void 0),!e&&this.publish("who-is-online.stop-following-participant")};this.gather=t=>{this.realtime.setGatherWIOParticipant(f({},t.detail)),this.publish("who-is-online.gather-all",t.detail.id)};this.setParticipants=t=>{let{participants:e}=this.useStore("who-is-online-store"),i=t.findIndex(({id:r})=>r===this.localParticipantId),s=t.splice(i,1),n=t.splice(0,3);return e.publish([...s,...n]),t};this.setExtras=t=>{let{extras:e}=this.useStore("who-is-online-store");e.publish(t)};this.name="whoIsOnline",this.logger=new A("@superviz/sdk/who-is-online-component");let{disablePresenceControls:e,disableGoToParticipant:i,disableFollowParticipant:s,disablePrivateMode:n,disableGatherAll:r,disableFollowMe:a,following:c}=this.useStore("who-is-online-store");if(c.subscribe(),typeof t!="object"){this.position=t!=null?t:"top-right";return}typeof t=="object"&&(this.position=(d=t.position)!=null?d:"top-right",this.setStyles(t.styles),e.publish(t.disablePresenceControls),i.publish(t.disableGoToParticipant),s.publish(t.disableFollowParticipant),n.publish(t.disablePrivateMode),r.publish(t.disableGatherAll),a.publish(t.disableFollowMe))}start(){let{localParticipant:t}=this.useStore("global-store");t.subscribe(e=>{this.localParticipantId=e.id}),this.subscribeToRealtimeEvents(),this.positionWhoIsOnline(),this.addListeners(),this.realtime.enterWIOChannel(t.value)}destroy(){this.unsubscribeToRealtimeEvents(),this.realtime.leaveWIOChannel(),this.removeListeners(),this.element.remove(),this.element=null}addListeners(){this.element.addEventListener("realtime.local-follow-participant",this.followMousePointer),this.element.addEventListener("realtime.go-to-participant",this.goToMousePointer),this.element.addEventListener("realtime.private-mode",this.setPrivate),this.element.addEventListener("realtime.follow-participant",this.follow),this.element.addEventListener("realtime.gather",this.gather)}removeListeners(){this.element.removeEventListener("realtime.local-follow-participant",this.followMousePointer),this.element.removeEventListener("realtime.go-to-participant",this.goToMousePointer),this.element.removeEventListener("realtime.private-mode",this.setPrivate),this.element.removeEventListener("realtime.follow-participant",this.follow),this.element.removeEventListener("realtime.gather",this.gather),this.room.presence.off(Ps.UPDATE)}subscribeToRealtimeEvents(){this.realtime.participantsObserver.subscribe(this.onParticipantListUpdate),this.realtime.participantLeaveObserver.subscribe(this.stopFollowing),this.realtime.privateModeWIOObserver.subscribe(this.onParticipantListUpdate),this.realtime.followWIOObserver.subscribe(this.setFollow),this.realtime.gatherWIOObserver.subscribe(this.goToMousePointer)}unsubscribeToRealtimeEvents(){this.realtime.participantsObserver.unsubscribe(this.onParticipantListUpdate),this.realtime.participantLeaveObserver.unsubscribe(this.stopFollowing),this.realtime.privateModeWIOObserver.unsubscribe(this.onParticipantListUpdate),this.realtime.followWIOObserver.unsubscribe(this.setFollow),this.realtime.gatherWIOObserver.unsubscribe(this.goToMousePointer)}setStyles(t=""){if(!t)return;let e=document.createElement("style");e.textContent=t,e.id="superviz-who-is-online-styles",document.head.appendChild(e)}positionWhoIsOnline(){if(this.element=document.createElement("superviz-who-is-online"),Object.values(qe).includes(this.position.toLowerCase())){document.body.appendChild(this.element);let[i,s]=this.position.split("-");this.element.position=`${i}: 20px; ${s}: 40px;`;return}let e=document.getElementById(this.position);if(!e){this.element.position="top: 20px; right: 40px;",document.body.appendChild(this.element);return}e.appendChild(this.element),this.element.position="position: relative;"}filterParticipants(t){return t.filter(({data:{activeComponents:e,id:i,isPrivate:s}})=>{if(s&&this.localParticipantId!==i)return this.stopFollowing(i,!0),!1;let n=i===this.localParticipantId;if(n){let r=e==null?void 0:e.some(c=>c.includes("presence")),{joinedPresence:a}=this.useStore("who-is-online-store");a.publish(r)}return(e==null?void 0:e.includes("whoIsOnline"))||n})}getParticipant(t){var _;let{avatar:e,activeComponents:i,participantId:s,name:n}=t.data,r=t.clientId===this.localParticipantId,{slotIndex:a}=t.data,{color:c}=this.realtime.getSlotColor(a),d=this.shouldDisableDropdown({activeComponents:i,participantId:s}),u=!d,g=this.getTooltipData({isLocalParticipant:r,name:n,presenceEnabled:u}),v=this.getAvatar({avatar:e,color:c,name:n,slotIndex:a}),b=(_=this.getControls({participantId:s,presenceEnabled:u}))!=null?_:[];return{id:s,name:n,avatar:v,disableDropdown:d,tooltip:g,controls:b,activeComponents:i,isLocalParticipant:r}}shouldDisableDropdown({activeComponents:t,participantId:e}){let{joinedPresence:{value:i},disablePresenceControls:{value:s},disableFollowMe:{value:n},disableFollowParticipant:{value:r},disableGoToParticipant:{value:a},disableGatherAll:{value:c},disablePrivateMode:{value:d}}=this.useStore("who-is-online-store");return i===!1||s===!0||e===this.localParticipantId&&n&&d&&c||e!==this.localParticipantId&&r&&a?!0:!(t!=null&&t.some(u=>u.toLowerCase().includes("presence")))}getTooltipData({isLocalParticipant:t,name:e,presenceEnabled:i}){let s={name:e};return t&&(s.name+=" (You)"),i&&!t&&(s.info="Click to follow"),s}getAvatar({avatar:t,color:e,name:i,slotIndex:s}){var a,c;let n=t==null?void 0:t.imageUrl,r=(c=(a=i==null?void 0:i.at(0))==null?void 0:a.toUpperCase())!=null?c:"A";return{imageUrl:n,firstLetter:r,color:e,slotIndex:s}}getControls({participantId:t,presenceEnabled:e}){let{disablePresenceControls:i}=this.useStore("who-is-online-store");if(!(i.value||!e))return t===this.localParticipantId?this.getLocalParticipantControls():this.getOtherParticipantsControls(t)}getOtherParticipantsControls(t){var r;let{disableGoToParticipant:e,disableFollowParticipant:i,following:s}=this.useStore("who-is-online-store"),n=[];if(e.value||n.push({label:"go to",icon:"place"}),!i.value){let a=((r=s.value)==null?void 0:r.id)===t,c=a?"unfollow":"follow",d=a?"send-off":"send";n.push({label:c,icon:d})}return n}getLocalParticipantControls(){let{disableFollowMe:{value:t},disableGatherAll:{value:e},disablePrivateMode:{value:i},everyoneFollowsMe:{value:s},privateMode:{value:n}}=this.useStore("who-is-online-store"),r=[];if(e||r.push({label:"gather all",icon:"gather"}),!t){let a=s?"send-off":"send",c=s?"stop followers":"everyone follows me";r.push({label:c,icon:a})}if(!i){let a=n?"eye_inative":"eye",c=n?"leave private mode":"private mode";r.push({label:c,icon:a})}return r}updateParticipantsControls(t){let{participants:e}=this.useStore("who-is-online-store");e.publish(e.value.map(i=>{var c;if(t&&i.id!==t)return i;let{id:s}=i,r=!this.shouldDisableDropdown({activeComponents:i.activeComponents,participantId:s}),a=(c=this.getControls({participantId:s,presenceEnabled:r}))!=null?c:[];return C(f({},i),{controls:a})}))}highlightParticipantBeingFollowed(){let{extras:t,participants:e,following:{value:i}}=this.useStore("who-is-online-store"),s=e.value[0],n=t.value.findIndex(c=>c.id===i.id),r=t.value.splice(n,1)[0];e.value.unshift(s),e.value[1]=r;let a=e.value.pop();t.value.push(a),t.publish(t.value),e.publish(e.value)}};l();l();var Qt=class extends M{constructor(t={}){super();this.fields={};this.fieldsOriginalOutline={};this.focusList={};this.enabledOutlineFields={};this.enabledRealtimeSyncFields={};this.flags={};this.allowedTagNames=["input","textarea"];this.allowedInputTypes=["text","email","date","color","datetime-local","month","number","password","range","search","tel","time","url","week","checkbox","radio"];this.throwError={onInvalidFieldsProp:t=>{throw new Error(`"Fields" property must be either a string or an array of strings. Received type: ${t}`)},onFieldNotFound:t=>{throw new Error(`You must pass the id of an existing element. Element with id ${t} not found`)},onInvalidTagName:t=>{throw new Error(`You can't register an element with tag ${t}. Only the tags "${this.allowedTagNames.join(", ")}" are allowed`)},onInvalidInputType:t=>{throw new Error(`You can't register an input element of type ${t}. Only the types "${this.allowedInputTypes.join(", ")}" are allowed`)},onDeregisterInvalidField:t=>{throw new Error(`You can't deregister field of id ${t}. No field was registered with id ${t} `)}};this.sync=t=>{var r;let e=this.fields[t],i=this.hasCheckedProperty(e),n={value:i?e.checked:e.value,color:this.localParticipant.slot.color,fieldId:t,showOutline:this.canUpdateColor(t),syncContent:this.canSyncContent(t),attribute:i?"checked":"value"};(r=this.room)==null||r.emit("field.input"+t,n)};this.handleInput=t=>{var n,r;let e=t.target;(n=this.room)==null||n.emit("field.keyboard-interaction"+e.id,{fieldId:e.id,color:this.localParticipant.slot.color});let i=this.canSyncContent(e.id);if(!i)return;let s={value:e.value,color:this.localParticipant.slot.color,fieldId:e.id,showOutline:this.canUpdateColor(e.id),syncContent:i,attribute:"value"};(r=this.room)==null||r.emit("field.input"+e.id,s)};this.handleChange=t=>{var n;let e=t.target;if(!this.canSyncContent(e.id))return;let s={fieldId:e.id,value:e.checked,color:this.localParticipant.slot.color,showOutline:this.canUpdateColor(e.id),syncContent:this.canSyncContent(e.id),attribute:"checked"};(n=this.room)==null||n.emit("field.input"+e.id,s)};this.handleFocus=t=>{var s;let e=t.target,i={color:this.localParticipant.slot.color,fieldId:e.id};(s=this.room)==null||s.emit("field.focus"+e.id,i)};this.handleBlur=t=>{var s;let e=t.target,i={fieldId:e.id};(s=this.room)==null||s.emit("field.blur"+e.id,i)};this.removeFieldColor=({presence:t,data:{fieldId:e}})=>{var i,s;((i=this.focusList[e])==null?void 0:i.id)!==t.id||!this.fields[e]||(this.fields[e].style.outline=(s=this.fieldsOriginalOutline[e])!=null?s:"",delete this.fieldsOriginalOutline[e],delete this.focusList[e])};this.updateFieldColor=({presence:t,data:{color:e,fieldId:i},timestamp:s})=>{var b;let n=(b=this.focusList[i])!=null?b:{},r=!n.id,a=t.id===this.localParticipant.id;if(r&&a){this.focusList[i]={id:t.id,color:e,firstInteraction:s,lastInteraction:s};return}if(n.id===t.id){this.focusList[i].lastInteraction=s;return}let d=s-n.lastInteraction>=3e3,u=s-n.firstInteraction>=1e4;if(!(d||u||r))return;this.focusList[i]={id:t.id,color:e,firstInteraction:s,lastInteraction:s};let v=a?this.fieldsOriginalOutline[i]:`1px solid ${e}`;this.fields[i].style.outline=v};this.updateFieldContent=u=>{var g=u,{presence:t,data:{value:e,fieldId:i,color:s,showOutline:n,syncContent:r,attribute:a},timestamp:c}=g,d=$e(g,["presence","data","timestamp"]);t.id!==this.localParticipant.id&&(this.publish(`${"field.input"}-${i}`,{value:e,fieldId:i,attribute:a,userId:t.id,userName:t.name,timestamp:c}),r&&this.canSyncContent(i)&&(this.fields[i][a]=e),n&&this.canUpdateColor(i)&&this.updateFieldColor(f({presence:t,data:{color:s,fieldId:i},timestamp:c},d)))};this.publishTypedEvent=({presence:t,data:{fieldId:e,color:i}})=>{t.id!==this.localParticipant.id&&this.publish(`${"field.keyboard-interaction"}-${e}`,{fieldId:e,userId:t.id,userName:t.name,color:i})};this.name="formElements",this.logger=new A("@superviz/sdk/presence-input-component");let s=t,{fields:e}=s,i=$e(s,["fields"]);if(this.flags=i!=null?i:{},typeof e=="string"){this.validateField(e),this.fields[e]=null;return}if(Array.isArray(e)){e.forEach(n=>{this.validateField(n),this.fields[n]=null});return}e!==void 0&&this.throwError.onInvalidFieldsProp(typeof e)}enableOutline(t){let e=this.fields[t];!e||(this.enabledOutlineFields[t]=!0,this.fieldsOriginalOutline[t]=e.style.outline,e.addEventListener("focus",this.handleFocus),e.addEventListener("blur",this.handleBlur),this.room.on("field.focus"+t,this.updateFieldColor),this.room.on("field.blur"+t,this.removeFieldColor))}disableOutline(t){var i,s;let e=this.fields[t];!e||(this.enabledOutlineFields[t]=!1,e.style.outline=(i=this.fieldsOriginalOutline[t])!=null?i:"",e.removeEventListener("focus",this.handleFocus),e.removeEventListener("blur",this.handleBlur),this.room.off("field.focus"+t,this.updateFieldColor),this.room.off("field.blur"+t,this.removeFieldColor),(s=this.room)==null||s.emit("field.blur"+t,{fieldId:t}))}enableRealtimeSync(t){this.enabledRealtimeSyncFields[t]=!0}disableRealtimeSync(t){this.enabledRealtimeSyncFields[t]=!1}registerField(t){this.validateField(t);let e=document.getElementById(t);this.fields[t]=e,this.addListenersToField(e),this.addRealtimeListenersToField(t),this.fieldsOriginalOutline[t]=e.style.outline}deregisterField(t){var e;this.fields[t]||this.throwError.onDeregisterInvalidField(t),this.removeListenersFromField(this.fields[t]),this.removeRealtimeListenersFromField(t),this.fields[t].style.outline=this.fieldsOriginalOutline[t],this.fields[t]=void 0,delete this.enabledOutlineFields[t],delete this.enabledRealtimeSyncFields[t],delete this.fieldsOriginalOutline[t],delete this.focusList[t],(e=this.room)==null||e.emit("field.blur"+t,{fieldId:t})}start(){let{localParticipant:t}=this.useStore("global-store");t.subscribe(),Object.entries(this.fields).forEach(([e])=>{this.registerField(e)})}destroy(){this.restoreOutlines(),this.deregisterAllFields(),this.fieldsOriginalOutline=void 0,this.focusList=void 0}addListenersToField(t){let{type:e}=t;this.hasCheckedProperty(t)?t.addEventListener("change",this.handleChange):t.addEventListener("input",this.handleInput),!this.flags.disableOutline&&(t.addEventListener("focus",this.handleFocus),t.addEventListener("blur",this.handleBlur))}addRealtimeListenersToField(t){!this.room||(this.room.on("field.input"+t,this.updateFieldContent),this.room.on("field.keyboard-interaction"+t,this.publishTypedEvent),!this.flags.disableOutline&&(this.room.on("field.focus"+t,this.updateFieldColor),this.room.on("field.blur"+t,this.removeFieldColor)))}removeListenersFromField(t){this.hasCheckedProperty(t)?t.removeEventListener("change",this.handleChange):t.removeEventListener("input",this.handleInput),!this.flags.disableOutline&&(t.removeEventListener("focus",this.handleFocus),t.removeEventListener("blur",this.handleBlur))}removeRealtimeListenersFromField(t){!this.room||(this.room.off("field.input"+t,this.updateFieldContent),this.room.off("field.keyboard-interaction"+t,this.publishTypedEvent),!this.flags.disableOutline&&(this.room.off("field.focus"+t,this.updateFieldColor),this.room.off("field.blur"+t,this.removeFieldColor)))}deregisterAllFields(){Object.keys(this.fields).forEach(t=>{this.deregisterField(t)}),this.fields=void 0}validateField(t){this.validateFieldId(t);let e=document.getElementById(t);this.validateFieldTagName(e),this.validateFieldType(e)}validateFieldTagName(t){let e=t.tagName.toLowerCase();this.allowedTagNames.includes(e)||(this.logger.log("invalid element tagname"),this.throwError.onInvalidTagName(e))}validateFieldType(t){if(t.tagName.toLowerCase()!=="input")return;let e=t.getAttribute("type"),i=this.allowedInputTypes.includes(e);e&&!i&&(this.logger.log("invalid input type"),this.throwError.onInvalidInputType(e))}validateFieldId(t){document.getElementById(t)||this.throwError.onFieldNotFound(t)}restoreOutlines(){Object.entries(this.fields).forEach(([t])=>{this.fields[t].style.outline=this.fieldsOriginalOutline[t]})}hasCheckedProperty(t){let e=t.tagName.toLowerCase(),i=t.getAttribute("type");return e==="input"&&(i==="radio"||i==="checkbox")}canUpdateColor(t){return!this.flags.disableOutline&&this.enabledOutlineFields[t]!==!1||this.enabledOutlineFields[t]}canSyncContent(t){return!this.flags.disableRealtimeSync&&this.enabledRealtimeSyncFields[t]!==!1||this.enabledRealtimeSyncFields[t]}};l();import{debug as eo}from"debug";l();var Ye=(m=>(m.svPrimary="sv-primary",m.svPrimary900="sv-primary-900",m.svPrimary200="sv-primary-200",m.svSecondary="sv-secondary",m.svGray="sv-gray",m.svSuccess="sv-success",m.svDanger="sv-danger",m.svBlack="sv-black",m.svWhite="sv-white",m.svGray100="sv-gray-100",m.svGray200="sv-gray-200",m.svGray300="sv-gray-300",m.svGray400="sv-gray-400",m.svGray500="sv-gray-500",m.svGray600="sv-gray-600",m.svGray700="sv-gray-700",m.svGray800="sv-gray-800",m))(Ye||{});l();l();function Ts(p,o){return w(this,null,function*(){try{return(yield O.validateApiKey(p,o))===!0}catch(t){if(t.status===404)return!1;throw new Error("Unable to validate API key")}})}var Wi=Ts;l();var Pt=class{static getRemoteConfig(){return w(this,arguments,function*(o="prod"){let{version:t}=yield Promise.resolve().then(()=>(Vi(),Ui));if(o==="local"){let{remoteConfig:s}=yield Promise.resolve().then(()=>zo(Ji()));return s}let e={version:t,environment:o},i=this.createUrl(e);return I(i,"GET",null)})}static createUrl({version:o,environment:t}){return`${this.REMOTE_CONFIG_BASE_URL}/${o}?env=${t}`}};Pt.REMOTE_CONFIG_BASE_URL="https://remote-config.superviz.com/sdk";l();import*as K from"@superviz/socket-client";import{isEqual as Qi}from"lodash";l();var te=class{constructor(){this.observers=new Map;this.subscribe=(o,t)=>{this.logger.log("event bus service @ subscribe",{event:o,callback:t}),this.observers.has(o)||this.observers.set(o,new E),this.observers.get(o).subscribe(t)};this.unsubscribe=(o,t)=>{this.logger.log("event bus service @ unsubscribe",{event:o,callback:t}),this.observers.has(o)&&(this.observers.get(o).reset(),this.observers.delete(o))};this.publish=(o,t)=>{this.logger.log("event bus service @ publish",{event:o,data:t}),this.observers.has(o)&&this.observers.get(o).publish(t)};this.destroy=()=>{this.logger.log("event bus service @ destroy"),this.observers.forEach(o=>{o.reset(),o.destroy()}),this.observers.clear()};this.logger=new A("@superviz/sdk/event-bus"),this.logger.log("event bus created")}};l();import*as Ki from"@superviz/socket-client";import{Subject as xs}from"rxjs";var Se=class{constructor(o){this.stateSubject=new xs;this.client=new Ki.Realtime(y.get("apiKey"),y.get("environment"),{id:o.id,name:o.name}),this.subscribeToDefaultEvents()}destroy(){this.client.destroy(),this.client.connection.off()}onStateChange(o){this.stateSubject.subscribe(o)}subscribeToDefaultEvents(){this.client.connection.on(o=>{this.state=o,this.stateSubject.next(o)})}createRoom(o){let t=y.get("roomId");return this.client.connect(`${t}:${o}`)}};l();var ee=class{static checkComponentLimit(o){var i,s;let t=(i=Je[o])!=null?i:o,e=y.get("limits");return(s=e==null?void 0:e[t])!=null?s:!1}};l();l();import qi from"ably";import Yi from"lodash/throttle";l();var Tt=(m=>(m[m.turquoise=0]="turquoise",m[m.orange=1]="orange",m[m.blue=2]="blue",m[m.pink=3]="pink",m[m.purple=4]="purple",m[m.green=5]="green",m[m.red=6]="red",m[m.bluedark=7]="bluedark",m[m.pinklight=8]="pinklight",m[m.purplelight=9]="purplelight",m[m.greenlight=10]="greenlight",m[m.orangelight=11]="orangelight",m[m.bluelight=12]="bluelight",m[m.redlight=13]="redlight",m[m.brown=14]="brown",m[m.yellow=15]="yellow",m[m.gray=16]="gray",m))(Tt||{}),At=[1,3,4,6,7,14,16],ie=(p=>(p[p["#31E0B0"]=0]="#31E0B0",p[p["#FF5E10"]=1]="#FF5E10",p[p["#00ABF7"]=2]="#00ABF7",p[p["#FF00BB"]=3]="#FF00BB",p[p["#9C29FF"]=4]="#9C29FF",p[p["#6FDD00"]=5]="#6FDD00",p[p["#E30000"]=6]="#E30000",p[p["#304AFF"]=7]="#304AFF",p[p["#FF89C4"]=8]="#FF89C4",p[p["#D597FF"]=9]="#D597FF",p[p["#C6EC5C"]=10]="#C6EC5C",p[p["#FFA115"]=11]="#FFA115",p[p["#75DEFE"]=12]="#75DEFE",p[p["#FAA291"]=13]="#FAA291",p[p["#BB813F"]=14]="#BB813F",p[p["#FFEF33"]=15]="#FFEF33",p[p["#878291"]=16]="#878291",p))(ie||{});l();var Ze=(a=>(a[a.DISCONNECTED=0]="DISCONNECTED",a[a.INITIALIZING=1]="INITIALIZING",a[a.READY_TO_JOIN=2]="READY_TO_JOIN",a[a.CONNECTING=3]="CONNECTING",a[a.CONNECTED=4]="CONNECTED",a[a.JOINED=5]="JOINED",a[a.FAILED=-1]="FAILED",a[a.RETRYING=-2]="RETRYING",a))(Ze||{});l();var Oe=class{constructor(){this.participantObservers=[],this.participants3DObservers=[],this.logger=new A("@superviz/sdk/realtime-service"),this.participantsObserver=new E({logger:this.logger}),this.participantJoinedObserver=new E({logger:this.logger}),this.participantLeaveObserver=new E({logger:this.logger}),this.reconnectObserver=new E({logger:this.logger}),this.sameAccountObserver=new E({logger:this.logger}),this.roomInfoUpdatedObserver=new E({logger:this.logger}),this.roomListUpdatedObserver=new E({logger:this.logger}),this.realtimeStateObserver=new E({logger:this.logger}),this.kickAllParticipantsObserver=new E({logger:this.logger}),this.kickParticipantObserver=new E({logger:this.logger}),this.authenticationObserver=new E({logger:this.logger}),this.commentsObserver=new E({logger:this.logger}),this.presenceMouseObserver=new E({logger:this.logger}),this.privateModeWIOObserver=new E({logger:this.logger}),this.followWIOObserver=new E({logger:this.logger}),this.gatherWIOObserver=new E({logger:this.logger}),this.presence3dObserver=new E({logger:this.logger}),this.presence3dLeaveObserver=new E({logger:this.logger}),this.presence3dJoinedObserver=new E({logger:this.logger})}subscribeToParticipantUpdate(o,t){this.participantObservers[o]||(this.participantObservers[o]=new E({logger:this.logger})),this.participantObservers[o].subscribe(t)}unsubscribeFromParticipantUpdate(o,t){this.participantObservers[o]&&this.participantObservers[o].unsubscribe(t)}subscribeToParticipant3DUpdate(o,t){this.participants3DObservers[o]||(this.participants3DObservers[o]=new E({logger:this.logger})),this.participants3DObservers[o].subscribe(t)}unsubscribeFromParticipant3DUpdate(o,t){this.participants3DObservers[o]&&this.participants3DObservers[o].unsubscribe(t)}getSlotColor(o){let t=o!=null?o:16;return{color:ie[t],name:Tt[t]}}};var Zi=6e4,_s=1e3,Ct=class extends Oe{constructor(t,e){super();this.participants={};this.participantsOn3d={};this.hostParticipantId=null;this.myParticipant=null;this.commentsChannel=null;this.supervizChannel=null;this.clientSyncChannel=null;this.broadcastChannel=null;this.presenceWIOChannel=null;this.presence3DChannel=null;this.isReconnecting=!1;this.isJoinedRoom=!1;this.isJoinedPresence3D=!1;this.currentReconnectAttempt=0;this.localRoomProperties=null;this.enableSync=!0;this.isSyncFrozen=!1;this.left=!1;this.domainWhitelisted=!0;this.state=0;this.setHost=t=>{this.updateRoomProperties({hostClientId:t})};this.setKickParticipant=t=>{if(!t)return;let e=this.participants[t];this.updateRoomProperties({kickParticipant:e})};this.freezeSync=t=>{var e,i;if(this.isSyncFrozen=t,t){this.supervizChannel.detach(),this.clientSyncChannel.detach(),(e=this.broadcastChannel)==null||e.detach(),this.supervizChannel.unsubscribe(),this.clientSyncChannel.unsubscribe(),(i=this.broadcastChannel)==null||i.unsubscribe();return}this.join()};this.setParticipantData=t=>{this.myParticipant.data=Object.assign({},this.myParticipant.data,t),this.updateMyProperties(this.myParticipant.data),this.updatePresence3D(this.myParticipant.data)};this.updateLocalRoomState=t=>w(this,null,function*(){this.localRoomProperties=Object.assign({},this.localRoomProperties,t),this.roomInfoUpdatedObserver.publish(this.localRoomProperties),this.updateParticipants(),t.kickParticipant&&t.kickParticipant.clientId===this.myParticipant.clientId&&(this.updateRoomProperties({kickParticipant:null}),this.kickParticipantObserver.publish(this.myParticipant.clientId))});this.updateMyProperties=(t={})=>{let e=t;this.isMessageTooBig(e)||this.left||!this.enableSync||this.isSyncFrozen||(e.avatar===void 0&&delete e.avatar,this.myParticipant.data=f(f({},this.myParticipant.data),e),this.isJoinedRoom&&(this.supervizChannel.presence.update(this.myParticipant.data),this.logger.log("REALTIME","updating my properties",this.myParticipant.data)))};this.updateRoomProperties=t=>{if(this.isMessageTooBig(t)||this.isSyncFrozen||this.left)return;let e=f(f({},this.localRoomProperties),t);this.supervizChannel.publish("update",e)};this.updateParticipants=()=>{let t={};this.supervizChannel.presence.get((e,i)=>{i.forEach(s=>{t[s.clientId]=f({},s)}),this.participants=t,this.participantsObserver.publish(this.participants)})};this.initializeRoomProperties=()=>{let t={isGridModeEnable:!1,hostClientId:null,followParticipantId:null,gather:!1,drawing:null,transcript:"transcript.stop",kickParticipant:null};this.updateParticipants(),this.updateRoomProperties(t)};this.onParticipantJoin=t=>{this.updateParticipants(),this.participantJoinedObserver.publish(t),this.updateMyProperties()};this.syncBroadcast=Yi(()=>{let t=btoa(this.ablyKey),e=`https://rest.ably.io/channels/${this.roomId.toLowerCase()}/presence`;fetch(e,{headers:{Authorization:`Basic ${t}`}}).then(i=>i.json()).then(i=>{this.broadcastChannel.publish("update",i)})},1e3);this.isMessageTooBig=(t,e=Zi)=>{let i=JSON.stringify(t);return new TextEncoder().encode(i).length>e?(this.logger.log("Message too long, the message limit size is 60kb."),!0):!1};this.onCommentsChannelUpdate=t=>{this.logger.log("REALTIME","Comments channel update",t),this.commentsObserver.publish(t)};this.updateComments=t=>{this.commentsChannel.publish("update",t)};this.enterWIOChannel=t=>{this.presenceWIOChannel||(this.presenceWIOChannel=this.client.channels.get(`${this.roomId.toLowerCase()}-wio`)),this.presenceWIOChannel.attach(),this.presenceWIOChannel.subscribe("private",this.onSetPrivate),this.presenceWIOChannel.subscribe("follow",this.onSetFollow),this.presenceWIOChannel.subscribe("gather",this.onSetGather)};this.leaveWIOChannel=()=>{!this.presenceWIOChannel||(this.presenceWIOChannel.unsubscribe(),this.presenceWIOChannel.detach(),this.presenceWIOChannel=null)};this.onSetPrivate=({data:{id:t,isPrivate:e}})=>{this.participants[t].data.isPrivate=e,this.privateModeWIOObserver.publish(this.participants)};this.onSetFollow=t=>{this.followWIOObserver.publish(t)};this.onSetGather=({data:t})=>{this.gatherWIOObserver.publish({detail:{id:t.id}})};this.setPrivateWIOParticipant=(t,e)=>{this.presenceWIOChannel.publish("private",{id:t,isPrivate:e})};this.setFollowWIOParticipant=t=>{this.presenceWIOChannel.publish("follow",f({},t))};this.setGatherWIOParticipant=t=>{this.presenceWIOChannel.publish("gather",f({},t))};this.leavePresence3DChannel=()=>{!this.presence3DChannel||(this.presence3DChannel.presence.leave(),this.presence3DChannel=null)};this.updatePresence3D=Yi(t=>{var i,s,n;if(!t||!t.id)return;let e=Object.assign({},(s=(i=this.participantsOn3d[t.id])==null?void 0:i.data)!=null?s:{},t);this.participantsOn3d[t.id]=C(f({},this.participants[e.id]),{data:f(f({},e),(n=this.participants[e.id])==null?void 0:n.data)}),this.presence3DChannel&&this.presence3DChannel.presence.update(e)},_s);this.onPresence3DChannelEnter=t=>{var i;t.clientId===this.myParticipant.clientId&&(this.isJoinedPresence3D=!0);let e=this.getParticipantSlot(t.clientId);this.presence3dJoinedObserver.publish(C(f({},t),{data:C(f(f({},t.data),(i=this.participants[t.clientId])==null?void 0:i.data),{slotIndex:e,color:this.getSlotColor(e).color})}))};this.onPresence3DChannelLeave=t=>{delete this.participantsOn3d[t.clientId],this.presence3dLeaveObserver.publish(t)};this.publish3DUpdate=t=>{var s;let e=this.getParticipantSlot(t.clientId),i=C(f({},t),{data:C(f(f({},t.data),(s=this.participants[t.clientId])==null?void 0:s.data),{slotIndex:e,color:this.getSlotColor(e).color})});this.participantsOn3d[t.clientId]=i,this.participants3DObservers[t.clientId]&&this.participants3DObservers[t.clientId].publish(i),this.presence3dObserver.publish(this.participantsOn3d)};this.ablyKey=e,this.apiUrl=t,this.onAblyPresenceEnter=this.onAblyPresenceEnter.bind(this),this.onAblyPresenceUpdate=this.onAblyPresenceUpdate.bind(this),this.onAblyPresenceLeave=this.onAblyPresenceLeave.bind(this),this.onAblyRoomUpdate=this.onAblyRoomUpdate.bind(this),this.onAblyChannelStateChange=this.onAblyChannelStateChange.bind(this),this.onAblyConnectionStateChange=this.onAblyConnectionStateChange.bind(this),this.onReceiveBroadcastSync=this.onReceiveBroadcastSync.bind(this),this.getParticipantSlot=this.getParticipantSlot.bind(this),this.auth=this.auth.bind(this)}get roomProperties(){return this.localRoomProperties}get hostClientId(){var t;return(t=this.roomProperties)==null?void 0:t.hostClientId}get isLocalParticipantHost(){return this.hostClientId===this.localParticipantId}get isDomainWhitelisted(){return this.domainWhitelisted}get getParticipants(){return this.participants}get participant(){return this.myParticipant}get localParticipantId(){var t,e;return(e=(t=this.myParticipant.data)==null?void 0:t.participantId)!=null?e:null}get isBroadcast(){return Object.values(this.participants).some(t=>t.data.type==="audience")}start({participant:t,roomId:e,apiKey:i}){this.myParticipant={data:C(f({},t),{participantId:t.id}),timestamp:null,action:null,clientId:t.id,connectionId:null,encoding:null,id:null,extras:null},this.enableSync=t.type!=="audience",this.roomId=`superviz:${e.toLowerCase()}-${i}`,this.apiKey=i,this.client||this.buildClient()}auth(t,e){if(!this.domainWhitelisted)return;let i=new qi.Rest({key:this.ablyKey}),{origin:s}=window.location;i.auth.requestToken(t,{authUrl:`${this.apiUrl}/realtime/auth`,key:this.ablyKey,authParams:{domain:s,apiKey:this.apiKey}},(n,r)=>{var a;n&&this.authenticationObserver.publish("realtime.authentication-failed"),(a=n==null?void 0:n.message)!=null&&a.includes("this domain don't have permission")&&(this.domainWhitelisted=!1),e(n,r)})}join(t){let e=t?Object.assign({},t,{participantId:t.id}):this.myParticipant.data;this.logger.log("REALTIME",`Entering room. Room ID: ${this.roomId}`),this.updateMyProperties(e),this.clientSyncChannel=this.client.channels.get(`${this.roomId}:client-sync`),this.broadcastChannel=this.client.channels.get(`${this.roomId}:broadcast`),this.enableSync||this.broadcastChannel.subscribe("update",this.onReceiveBroadcastSync),this.supervizChannel=this.client.channels.get(this.roomId),this.supervizChannel.on(this.onAblyChannelStateChange),this.supervizChannel.subscribe("update",this.onAblyRoomUpdate),this.commentsChannel=this.client.channels.get(`${this.roomId}:comments`),this.commentsChannel.subscribe("update",this.onCommentsChannelUpdate),this.supervizChannel.presence.subscribe("enter",this.onAblyPresenceEnter),this.enableSync&&this.supervizChannel.presence.subscribe("update",this.onAblyPresenceUpdate),this.supervizChannel.presence.subscribe("leave",this.onAblyPresenceLeave),this.supervizChannel.presence.enter(this.myParticipant.data)}leave(){this.logger.log("REALTIME","Disconnecting from ably servers"),this.supervizChannel.presence.leave(),this.client.close(),this.isJoinedRoom=!1,this.isReconnecting=!1,this.roomId=null,this.participants={},this.hostParticipantId=null,this.myParticipant=null,this.supervizChannel=null,this.clientSyncChannel=null,this.client=null,this.left=!0}setGridMode(t){let e=this.localRoomProperties;this.updateRoomProperties(Object.assign({},e,{isGridModeEnable:t}))}setDrawing(t){let e=this.localRoomProperties;this.updateRoomProperties(Object.assign({},e,{drawing:t}))}setTranscript(t){let e=this.localRoomProperties;this.updateRoomProperties(Object.assign({},e,{transcript:t}))}setFollowParticipant(t){this.updateRoomProperties({followParticipantId:t})}setGather(t){this.updateRoomProperties({gather:t})}getParticipantSlot(t){var e,i;if(t){let s=t.toString();if(this.participants&&this.participants[s])return(i=(e=this.participants[t])==null?void 0:e.data)==null?void 0:i.slotIndex}return 16}onAblyPresenceEnter(t){if(t.clientId===this.myParticipant.data.participantId&&this.isJoinedRoom){this.sameAccountObserver.publish(!0);return}t.clientId===this.myParticipant.data.participantId?this.onJoinRoom(t):this.onParticipantJoin(t)}onAblyPresenceUpdate(t){if(!this.isJoinedRoom)return;let{clientId:e}=t,i=Object.assign({},t,{participantId:t.clientId});this.publishParticipantUpdate(i),this.participants&&this.participants[e]&&this.hostParticipantId===this.localParticipantId&&this.isBroadcast&&this.syncBroadcast()}onAblyPresenceLeave(t){this.onParticipantLeave(t)}onReceiveBroadcastSync(t){t.data.forEach(i=>{var n;let s=i.clientId;this.participants[s]=i,(n=i.data)!=null&&n.isAudience||(this.participants[s].data=JSON.parse(this.participants[s].data),this.publishParticipantUpdate(this.participants[s]))})}onAblyRoomUpdate(t){this.logger.log("REALTIME","Room update received",t.data),this.updateLocalRoomState(t.data)}buildClient(){this.client&&this.throw("Tried to call buildClient@Ably is already initialized");let t={key:this.ablyKey,disconnectedRetryTimeout:5e3,suspendedRetryTimeout:5e3,clientId:this.myParticipant.data.participantId,authCallback:this.auth};this.client=new qi.Realtime(t),this.client.connection.on(this.onAblyConnectionStateChange)}publishParticipantUpdate(t){this.participants[t.clientId]=t,this.participantsObserver.publish(this.participants),this.participantObservers[t.clientId]&&this.participantObservers[t.clientId].publish(t)}forceReconnect(){if(this.logger.log("REALTIME",`RECONNECT: Starting force realtime reconnect | Current attempt: ${this.currentReconnectAttempt}`),this.roomId||this.throw("Tried to reconnect without roomId set"),this.state===2){this.logger.log("REALTIME","Rejoining room since client already connected to ably servers."),this.join();return}this.logger.log("REALTIME","RECONNECT: Restarting ably server since participant lost connection."),this.buildClient(),this.updateMyProperties(this.myParticipant.data)}throw(t){throw this.logger.log(t),new Error(t)}publishStateUpdate(t){this.state!==t&&(this.state=t,this.logger.log("REALTIME",`Realtime state did change. New state: ${Ze[this.state]}`),this.realtimeStateObserver.publish(this.state))}fetchRoomProperties(){return w(this,null,function*(){let t=yield new Promise((e,i)=>{this.supervizChannel.history((s,n)=>{s&&i(s);let r=n.items[0];e(r||null)})});return(t==null?void 0:t.timestamp)<Date.now()-1e3*60*60?null:(t==null?void 0:t.data)||null})}onStateChange(){var d,u,g;let t=(d=this.supervizChannelState)==null?void 0:d.current,e=(u=this.connectionState)==null?void 0:u.current,i=e==="connected",s=["initialized","connecting"].includes(e),n=["closed","closing"].includes(e)||["detaching","detached"].includes(t),r={[0]:n,[1]:s,[2]:!t&&i,[3]:t==="attaching",[4]:t==="attached"&&i,[-1]:t==="failed"||e==="failed",[-2]:e==="suspended"||t==="suspended"},a=Object.entries(r).find(([v,b])=>b&&v)[0],c=Number(a);if(!!this.domainWhitelisted){if(c===2&&(this.currentReconnectAttempt=0),i&&this.isReconnecting&&this.onJoinRoom(this.participant),(c===-2||c===-1)&&this.forceReconnect(),(g=this.connectionState)!=null&&g.retryIn){this.currentReconnectAttempt++,this.isReconnecting=!0,this.publishStateUpdate(-2),this.reconnectObserver.publish(this.currentReconnectAttempt);return}this.publishStateUpdate(c)}}onAblyConnectionStateChange(t){this.connectionState=t,this.onStateChange()}onAblyChannelStateChange(t){this.supervizChannelState=t,this.onStateChange()}onJoinRoom(t){return w(this,null,function*(){this.isJoinedRoom=!0,this.localRoomProperties=yield this.fetchRoomProperties(),this.updateParticipants(),this.myParticipant=t,this.localRoomProperties?(this.updateParticipants(),this.localRoomProperties=yield this.fetchRoomProperties(),this.updateLocalRoomState(this.localRoomProperties)):this.initializeRoomProperties(),this.isReconnecting=!1,this.publishStateUpdate(4),this.participantJoinedObserver.publish(t),this.logger.log("REALTIME","Joined realtime room")})}onParticipantLeave(t){if(this.state===2)return;t.data.participantId===this.localRoomProperties.followParticipantId&&this.setFollowParticipant(),this.participantLeaveObserver.publish(t),this.updateParticipants()}spliceArrayBySize(t,e=Zi){let i=a=>{let c=JSON.stringify(a);return new TextEncoder().encode(c).length},s=0,n=[],r=[];for(let a=0;a<t.length;a++){let c=i(t[a]);s+c<=e?(r.push(t[a]),s+=c):(n.push(r),r=[t[a]],s=c)}return r.length>0&&n.push(r),{data:n[0],lengthToBeSplitted:n[0].length}}enterPresence3DChannel(t){if(!this.isJoinedRoom){this.logger.log("REALTIME","Cannot enter presence 3D channel because the participant is not in the room"),setTimeout(()=>{this.enterPresence3DChannel(t)},1e3);return}this.presence3DChannel||(this.presence3DChannel=this.client.channels.get(`${this.roomId.toLowerCase()}-presence-3d`),this.presence3DChannel.attach(),this.presence3DChannel.presence.subscribe("enter",this.onPresence3DChannelEnter),this.presence3DChannel.presence.subscribe("leave",this.onPresence3DChannelLeave),this.presence3DChannel.presence.subscribe("update",this.publish3DUpdate)),this.presence3DChannel.presence.enter(t)}};l();l();import*as Xi from"@superviz/socket-client";var Le=class{constructor(o,t){this.onPresenceUpdate=o=>w(this,null,function*(){var e,i,s,n;if(!o.data.slot||!((e=this.participant)!=null&&e.slot))return;if(o.id===this.participant.id){this.participant=o.data,this.slotIndex=o.data.slot.index;return}let t=o.data.slot.timestamp<((s=(i=this.participant)==null?void 0:i.slot)==null?void 0:s.timestamp);if(((n=o.data.slot)==null?void 0:n.index)===this.slotIndex&&t){let r=yield this.assignSlot();this.room.presence.update({slot:r})}});this.room=o,this.participant=t,this.room.presence.on(Xi.PresenceEvents.UPDATE,this.onPresenceUpdate)}assignSlot(){return w(this,null,function*(){try{let o=Math.floor(Math.random()*16);if(yield new Promise((i,s)=>{this.room.presence.get(n=>{if((!n||!n.length)&&i(!1),n.length>=16){s(new Error("[SuperViz] - No more slots available"));return}n.forEach(r=>{var a,c;r.id!==this.participant.id&&((c=(a=r.data)==null?void 0:a.slot)==null?void 0:c.index)===o&&i(!0)}),i(!1)})}))return yield this.assignSlot();let e={index:o,color:ie[o],textColor:At.includes(o)?"#fff":"#000",colorName:Tt[o],timestamp:Date.now()};return this.slotIndex=o,this.participant=C(f({},this.participant),{slot:e}),e}catch(o){return null}})}};l();var Xe=class extends V{constructor({participant:t,group:e}){super();this.isDestroyed=!1;this.activeComponents=[];this.componentsToAttachAfterJoin=[];this.activeComponentsInstances=[];this.eventBus=new te;this.addComponent=t=>{if(!!this.canAddComponent(t)){if(!this.realtime.isJoinedRoom){this.logger.log("launcher service @ addComponent - not joined yet"),this.componentsToAttachAfterJoin.push(t);return}t.attach({ioc:this.ioc,realtime:this.realtime,config:y.configuration,eventBus:this.eventBus,useStore:Et}),this.activeComponents.push(t.name),this.activeComponentsInstances.push(t),this.realtime.updateMyProperties({activeComponents:this.activeComponents}),O.sendActivity(this.participant.value.id,this.group.value.id,this.group.value.name,t.name)}};this.attachComponentsAfterJoin=()=>{this.logger.log("launcher service @ attachComponentsAfterJoin"),this.componentsToAttachAfterJoin.forEach(t=>{this.logger.log("launcher service @ attachComponentsAfterJoin - attaching component",t.name),this.addComponent(t)}),this.componentsToAttachAfterJoin=[]};this.removeComponent=t=>{if(!this.activeComponents.includes(t.name)){let e=`Component ${t.name} is not initialized yet.`;this.logger.log(e);return}t.detach(),this.activeComponentsInstances=this.activeComponentsInstances.filter(e=>e.name!==t.name),this.activeComponents.splice(this.activeComponents.indexOf(t.name),1),this.realtime.updateMyProperties({activeComponents:this.activeComponents})};this.destroy=()=>{this.logger.log("launcher service @ destroy"),this.activeComponentsInstances.forEach(t=>{this.logger.log("launcher service @ destroy - removing component",t.name),this.removeComponent(t)}),this.activeComponents=[],this.activeComponentsInstances=[],this.participant=void 0,yt().destroy(),this.eventBus.destroy(),this.eventBus=void 0,this.LauncherRealtimeRoom.presence.off(K.PresenceEvents.JOINED_ROOM),this.LauncherRealtimeRoom.presence.off(K.PresenceEvents.LEAVE),this.LauncherRealtimeRoom.presence.off(K.PresenceEvents.UPDATE),this.ioc.destroy(),this.realtime.authenticationObserver.unsubscribe(this.onAuthentication),this.realtime.sameAccountObserver.unsubscribe(this.onSameAccount),this.realtime.participantJoinedObserver.unsubscribe(this.onParticipantJoined),this.realtime.participantsObserver.unsubscribe(this.onParticipantListUpdate),this.realtime.leave(),this.realtime=void 0,this.isDestroyed=!0,window.SUPERVIZ=void 0};this.canAddComponent=t=>{let e=ee.checkComponentLimit(t.name),i=this.activeComponents.includes(t.name),s=[{isValid:!this.isDestroyed,message:"Component can not be added because the superviz room is destroyed. Initialize a new room to add and use components."},{isValid:!i,message:`Component ${t.name} is already active. Please remove it first`},{isValid:e,message:`You reached the limit usage of ${t.name}`}];for(let n=0;n<s.length;n++){let{isValid:r,message:a}=s[n];if(!r)return this.logger.log(a),!1}return!0};this.startAbly=()=>{this.logger.log("launcher service @ startAbly"),this.realtime.start({participant:this.participant.value,apiKey:y.get("apiKey"),roomId:y.get("roomId")}),this.realtime.join(),this.subscribeToAblyEvents()};this.subscribeToAblyEvents=()=>{this.realtime.authenticationObserver.subscribe(this.onAuthentication),this.realtime.sameAccountObserver.subscribe(this.onSameAccount),this.realtime.participantJoinedObserver.subscribe(this.onParticipantJoined),this.realtime.participantsObserver.subscribe(this.onParticipantListUpdate)};this.onAuthentication=t=>{t==="realtime.authentication-failed"&&this.destroy()};this.onParticipantListUpdate=t=>{this.logger.log("launcher service @ onParticipantListUpdate",t);let i=Object.values(t).map(s=>{var n,r,a,c,d,u;return{id:s.data.id,name:(n=s.data)==null?void 0:n.name,type:(r=s.data)==null?void 0:r.type,avatar:(a=s.data)==null?void 0:a.avatar,avatarConfig:(c=s.data)==null?void 0:c.avatarConfig,isHost:this.realtime.hostClientId===s.clientId,color:this.realtime.getSlotColor((d=s.data)==null?void 0:d.slotIndex).color,activeComponents:(u=s.data)==null?void 0:u.activeComponents}}).find(s=>{var n;return(s==null?void 0:s.id)===((n=this.participant.value)==null?void 0:n.id)});i&&!Qi(this.participant.value,i)&&(this.LauncherRealtimeRoom.presence.update(i),this.activeComponentsInstances=this.activeComponentsInstances.filter(s=>i.activeComponents?this.activeComponents.includes(s.name):!0))};this.onParticipantJoined=t=>{t.clientId===this.participant.value.id&&(this.logger.log("launcher service @ onParticipantJoined - local participant joined"),this.attachComponentsAfterJoin())};this.onSameAccount=()=>{this.publish("participant.same-account-error"),this.destroy()};this.startIOC=()=>{this.logger.log("launcher service @ startIOC"),this.LauncherRealtimeRoom.presence.get(t=>{t.forEach(e=>{this.participants.value.set(e.id,e.data)})}),this.LauncherRealtimeRoom.presence.on(K.PresenceEvents.JOINED_ROOM,this.onParticipantJoinedIOC),this.LauncherRealtimeRoom.presence.on(K.PresenceEvents.LEAVE,this.onParticipantLeaveIOC),this.LauncherRealtimeRoom.presence.on(K.PresenceEvents.UPDATE,this.onParticipantUpdatedIOC)};this.onParticipantJoinedIOC=t=>w(this,null,function*(){if(t.id!==this.participant.value.id)return;let i=yield new Le(this.LauncherRealtimeRoom,this.participant.value).assignSlot();this.participant.value=C(f({},this.participant.value),{slot:i}),this.LauncherRealtimeRoom.presence.update(this.participant.value),this.logger.log("launcher service @ onParticipantJoined - local participant joined"),this.publish("participant.local-joined",this.participant.value),this.publish("participant.joined",this.participant.value)});this.onParticipantLeaveIOC=t=>{this.participants.value.delete(t.id),t.id===this.participant.value.id&&(this.logger.log("launcher service @ onParticipantLeave - local participant left"),this.publish("participant.local-left",t.data)),this.logger.log("launcher service @ onParticipantLeave - participant left",t.data),this.publish("participant.left",t.data)};this.onParticipantUpdatedIOC=t=>{var i,s,n,r;t.id===this.participant.value.id&&!Qi(this.participant.value,t.data)&&(this.participant.value=t.data,this.publish("participant.updated",t.data),this.logger.log("Publishing ParticipantEvent.UPDATED",t.data),((s=(i=t.data)==null?void 0:i.slot)==null?void 0:s.index)!==void 0&&((r=(n=t.data)==null?void 0:n.slot)==null?void 0:r.index)!==this.realtime.participant.data.slotIndex&&this.realtime.updateMyProperties({slotIndex:t.data.slot.index})),this.participants.value.has(t.id)||this.publish("participant.joined",t.data),this.participants.value.set(t.id,t.data);let e=Array.from(this.participants.value.values());this.logger.log("Publishing ParticipantEvent.LIST_UPDATED",this.participants.value),this.publish("participant.list-updated",e)};let{localParticipant:i,participants:s,group:n}=yt();this.participant=i,this.participants=s,this.group=n,this.participant.value=C(f({},t),{type:"guest"}),this.group.value=e,this.logger=new A("@superviz/sdk/launcher"),this.realtime=new Ct(y.get("apiUrl"),y.get("ablyKey")),this.ioc=new Se(this.participant.value),this.LauncherRealtimeRoom=this.ioc.createRoom("launcher"),this.eventBus=new te,this.logger.log("launcher created"),this.startAbly(),this.startIOC()}},to=p=>{if(window.SUPERVIZ)return{destroy:window.SUPERVIZ.destroy,subscribe:window.SUPERVIZ.subscribe,unsubscribe:window.SUPERVIZ.unsubscribe,addComponent:window.SUPERVIZ.addComponent,removeComponent:window.SUPERVIZ.removeComponent};let o=new Xe(p);return window.SUPERVIZ=o,{destroy:o.destroy,subscribe:o.subscribe,unsubscribe:o.unsubscribe,addComponent:o.addComponent,removeComponent:o.removeComponent}};var Ss=({group:p,participant:o,roomId:t,customColors:e})=>{if(e&&Os(e),!p||!p.name||!p.id)throw new Error("Group fields is required");if(!o||!o.id||!o.name)throw new Error("Participant name and id is required");if(!t)throw new Error("Room id is required")},Os=p=>{Object.entries(p).forEach(([o,t])=>{if(!Object.values(Ye).includes(o))throw new Error(`Color ${o} is not a valid color variable name. Please check the documentation for more information.`);if(!/^(\d{1,3}\s){2}\d{1,3}$/.test(t))throw new Error(`Color ${o} is not a valid color variable value. Please check the documentation for more information.`)})},Ls=p=>{!p||Object.entries(p).forEach(([o,t])=>{let e=t.replace(/\s/g,", ");document.documentElement.style.setProperty(`--${o}`,e)})},Is=(p,o)=>w(void 0,null,function*(){var v,b;if(!(p&&p.trim()))throw new Error("API key is required");if(!o)throw new Error("Options is required");Ss(o),o.debug?eo.enable("*"):eo.disable();let{apiUrl:e,conferenceLayerUrl:i}=yield Pt.getRemoteConfig(o.environment);if(!(yield Wi(e,p)))throw new Error("Failed to validate API key");let[n,r,a]=yield Promise.all([O.fetchConfig(e,p),O.fetchLimits(e,p),O.fetchWaterMark(e,p)]).catch(()=>{throw new Error("Failed to load configuration from server")});if(!n||!n.ablyKey)throw new Error("Failed to load configuration from server");let{ablyKey:c}=n,{participant:d,roomId:u,customColors:g}=o;return y.setConfig({apiUrl:e,ablyKey:c,apiKey:p,conferenceLayerUrl:i,environment:(v=o.environment)!=null?v:"prod",roomId:u,debug:o.debug,limits:r,waterMark:a,colors:o.customColors}),Ls(o.customColors),O.createOrUpdateParticipant({name:d.name,participantId:d.id,avatar:(b=d.avatar)==null?void 0:b.imageUrl}),to(o)}),Qe=Is;l();l();import{LitElement as Rs,css as Ms,html as ks}from"lit";import{customElement as Ns}from"lit/decorators.js";var q=class extends Rs{render(){return ks` <div>Hello from SuperViz, ${this.name}</div> `}};q.properties={name:{type:String}},q.styles=Ms`
    div {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: black;
      color: white;
    }
  `,q=P([Ns("superviz-hello-world")],q);l();import{LitElement as Gs,css as zs,html as Hs}from"lit";import{customElement as Ws}from"lit/decorators.js";l();l();l();import{css as Fs}from"lit";var ti=Fs`
  * {
    --sv-primary: 98, 16, 204;
    --sv-primary-900: 56, 7, 136;
    --sv-primary-200: 193, 161, 234;
    --sv-secondary: 193, 251, 223;
    --sv-gray: 126, 122, 136;
    --sv-success: 12, 185, 71;
    --sv-danger: 229, 65, 30;
    --sv-black: 19, 18, 21;
    --sv-white: 255, 255, 255;
    --sv-gray-100: 250, 250, 252;
    --sv-gray-200: 233, 229, 239;
    --sv-gray-300: 201, 196, 209;
    --sv-gray-400: 174, 169, 184;
    --sv-gray-500: 126, 122, 136;
    --sv-gray-600: 87, 83, 95;
    --sv-gray-700: 57, 54, 62;
    --sv-gray-800: 38, 36, 42;
  }

  .sv-gray-200 {
    color: rgb(var(--sv-gray-200));
  }

  .sv-gray-400 {
    color: rgb(var(--sv-gray-400));
  }

  .sv-gray-500 {
    color: rgb(var(--sv-gray-500));
  }

  .sv-gray-600 {
    color: rgb(var(--sv-gray-600));
  }

  .sv-gray-700 {
    color: rgb(var(--sv-gray-700));
  }
`;l();import{css as Ds}from"lit";var ei=Ds`
  .text {
    font-family: Roboto;
    font-size: 12px;
    font-style: normal;
    font-weight: 400;
    line-height: 20px;
  }

  .text-bold {
    font-weight: 700;
  }

  .text-big {
    font-size: 14px;
  }

  .text-small {
    font-size: 10px;
  }
`;l();import{css as Bs}from"lit";var ii=Bs`
  .sv-hr {
    width: 100%;
    height: 1px;
    background: rgb(var(--sv-gray-200));
    padding: 0px;
    margin: 0px;
    position: relative;
  }
`;l();import{css as $s}from"lit";var oi=$s`
  .icon-button {
    display: flex;
    justify-content: center;
    align-items: center;
    background: rgba(0, 0, 0, 0);
    border: 0px;
    width: 32px;
    height: 32px;
  }

  .icon-button > superviz-icon {
    display: flex !important;
  }

  .icon-button--xsmall {
    width: 18px;
    height: 18px;
  }

  .icon-button--small {
    width: 24px;
    height: 24px;
  }

  .icon-button--medium {
    width: 32px;
    height: 32px;
  }

  .icon-button--large {
    width: 40px;
    height: 40px;
  }

  .icon-button--clickable {
    cursor: pointer;
    border-radius: 100%;
  }

  .icon-button--clickable:hover:not(.icon-button--no-hover) {
    background: rgb(var(--sv-gray-300));
    transition: 0.25s background-color ease-in;
  }
  
  .icon-button--clickable:focus:not(.icon-button--no-hover) {
    transition: 0.25s background-color ease-in;
    background: rgb(var(--sv-gray-300));
  }
`;var T=p=>{var t;class o extends p{constructor(){super(...arguments);this.unsubscribeFrom=[];this.useStore=Et.bind(this)}connectedCallback(){setTimeout(()=>{var a,c;let s=document.getElementById("superviz-style"),n=this.createCustomColors(),r=document.createElement("style");r.innerHTML=(s==null?void 0:s.innerHTML)||"",(a=this.shadowRoot)==null||a.appendChild(r),n&&((c=this.shadowRoot)==null||c.appendChild(n))}),super.connectedCallback()}disconnectedCallback(){super.disconnectedCallback(),this.unsubscribeFrom.forEach(s=>s(this))}createCustomColors(){if(!y.get("colors"))return;let s=document.createElement("style"),n=Object.entries(y.get("colors")).map(([r,a])=>`--${r}: ${a} !important;`).join(" ");return s.innerHTML=`
      * {
        ${n}
      }
    `,s}emitEvent(s,n,r={composed:!0,bubbles:!0}){let a=new CustomEvent(s,f({detail:n},r));this.dispatchEvent(a)}}return o.styles=[ti,ei,ii,oi,(t=p.styles)!=null?t:[]],o};l();var si=(s=>(s[s.xs=14]="xs",s[s.sm=18]="sm",s[s.md=24]="md",s[s.lg=36]="lg",s[s.xl=44]="xl",s))(si||{});var io=T(Gs),Us=[io.styles],Y=class extends io{constructor(){super();this.name="",this.size="md"}get iconSize(){return si[this.size]}render(){var t;return this.color||(this.color="black"),Hs`
      <i
        class="sv-icon sv-icon-${this.name}_${(t=this.suffix)!=null?t:this.size} ${this.color}"
        style="font-size: ${this.iconSize}px"
      ></i>
    `}};Y.properties={name:{type:String},size:{type:String},color:{type:String},suffix:{type:String}},Y.styles=[Us,zs`
      div {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: black;
        color: white;
      }

      i,
      i.black {
        color: rgba(var(--sv-gray-600));
      }

      i.white {
        color: white;
      }
    `],Y=P([Ws("superviz-icon")],Y);l();import{LitElement as js,html as Z}from"lit";import{customElement as Js}from"lit/decorators.js";import{classMap as so}from"lit/directives/class-map.js";l();function x(p){let o=document.getElementById(`superviz-${p}-styles`);if(!o)return;let t=new CSSStyleSheet;t.replaceSync(o.textContent),this.shadowRoot.adoptedStyleSheets=[...this.shadowRoot.adoptedStyleSheets,t]}l();import{css as Vs}from"lit";var oo=Vs`
  .dropdown {
    position: relative;
    z-index: 100;
  }

  .dropdown-content {
    display: flex;
  }

  .select-clicked {
    border: 2px #26489a solid;
  }

  .dropdown-list {
    position: relative;
    z-index: 101;
  }

  .header {
    display: grid;
    grid-template-rows: 1fr 1px;
    align-items: center;
    padding: 0 10px;
    min-height: 42px;
    font-size: 16px;
    color: rgb(var(--sv-gray-600));
  }

  .menu {
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
    opacity: 0;
    display: none;
    background: #fff;
    padding: 0;
    z-index: 1;
    transition: 0.2s;
    border-radius: 3px;
  }

  .items {
    list-style: none;
    padding: 0;
    color: #9fa5b5;
    margin: 0;
  }

  .text.username {
    font-size: 14px;
    text-align: left;

    display: inline-block;
    vertical-align: middle;
    line-height: normal;
    padding: 8px 0;
  }

  .items li {
    color: rgb(var(--sv-gray-600));
    text-transform: uppercase;
    padding: 0 10px;
    cursor: pointer;
    min-width: 103px;
    min-height: 32px;
    display: flex;
    align-items: center;
    justify-content: flex-start;
    gap: 5px;
    height: 42px;
  }

  .sv-icon {
    width: 40px;
    height: 40px;
    background-color: red;
  }

  .active {
    background: rgb(var(--sv-gray-200));
  }

  .items li:hover {
    background: rgb(var(--sv-gray-200));
  }

  .menu-open {
    display: block;
    opacity: 1;
    position: fixed;
  }

  .sv-hr {
    width: 100%;
    height: 1px;
    background: rgb(var(--sv-gray-300));
    padding: 0px;
    margin: 0px;
    justify-self: flex-end;
  }

  .option-label {
    white-space: nowrap;
    line-height: 1;
  }

  .who-is-online__controls__item__icon {
    line-height: 1;
  }

  .who-is-online__controls__item {
    align-items: center;
  }

  @media (max-width: 780px) {
    .menu--top-left,
    .menu--top-center,
    .menu--top-right {
      bottom: 36px;
    }
  }
`;var no=T(js),Ks=[no.styles,oo],X=class extends no{constructor(){super();this.menu=void 0;this.onClickOutDropdown=t=>{if(t.stopPropagation(),!this.open)return;let e=t.composedPath(),i=this.shadowRoot.querySelector(".dropdown-content"),s=this.shadowRoot.querySelector(".dropdown-list"),r=this.shadowRoot.querySelector('slot[name="dropdown"]').assignedElements()[0],a=e.includes(i),c=e.includes(s),d=e.includes(r);a||c||d||this.close()};this.close=()=>{this.open=!1,this.emitEvent("close",{bubbles:!1,composed:!1})};this.callbackSelected=({label:t})=>{this.open=!1,this.emitEvent("selected",C(f({},this.returnData),{label:t}),{bubbles:!1,composed:!0})};this.adjustPosition=()=>{if(!this.open){cancelAnimationFrame(this.animationFrame);return}this.setHorizontalPosition(),this.setPositionVertical(),this.animationFrame=requestAnimationFrame(this.adjustPosition)};this.tooltip=()=>{if(!this.canShowTooltip)return"";let t=this.lastParticipant?"tooltip-top":"tooltip-bottom";return Z` <superviz-tooltip
      tooltipData=${JSON.stringify(this.tooltipData)}
      ?shiftTooltipLeft=${this.shiftTooltipLeft}
      tooltipVerticalPosition=${t}
      classesPrefix="${this.tooltipPrefix}__tooltip"
      parentComponent=${this.parentComponent}
    ></superviz-tooltip>`};this.showTooltip=!1,this.returnData={}}firstUpdated(t){super.firstUpdated(t),this.updateComplete.then(()=>{this.menu=this.shadowRoot.querySelector(".menu"),x.call(this,[this.parentComponent])})}disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener("click",this.onClickOutDropdown);let t=this.shadowRoot.querySelector(".dropdown");t==null||t.removeEventListener("mouseenter",()=>{this.showTooltip=!0}),t==null||t.removeEventListener("mouseleave",()=>{this.showTooltip=!1})}updated(t){if(!!t.has("open")){if(this.emitEvent("toggle-dropdown-state",{open:this.open,font:this.name},{bubbles:!1,composed:!1}),this.open){document.addEventListener("click",this.onClickOutDropdown),this.animationFrame=requestAnimationFrame(this.adjustPosition);return}document.removeEventListener("click",this.onClickOutDropdown)}}setHorizontalPosition(){let t=this.shadowRoot.querySelector('slot[name="dropdown"]'),{left:e,right:i,width:s}=t.parentElement.getBoundingClientRect(),{width:n}=this.menu.getBoundingClientRect(),r=e-(n-s)/2<0,a=i+(n-s)/2>window.innerWidth;if(this.shiftTooltipLeft){this.menu.style.left=`${e+8}px`,this.menu.style.right="",this.menu.style.transform="translate(0, 0)";return}if(!r&&!a){this.menu.style.left=`${e}px`,this.menu.style.right="",this.menu.style.transform=`translate(calc(-50% + ${s/2}px), 0)`;return}if(!r){this.menu.style.left="",this.menu.style.right=`${window.innerWidth-i}px`,this.menu.style.transform="translate(0, 0)";return}a||(this.menu.style.right="",this.menu.style.left=`${i-s}px`,this.menu.style.transform="translate(0, 0)")}setPositionVertical(){let t=this.shadowRoot.querySelector('slot[name="dropdown"]'),{top:e,bottom:i}=t.parentElement.getBoundingClientRect(),{height:s}=this.menu.getBoundingClientRect(),n=this.shiftTooltipLeft?-2:8;if(!(i+s+n>window.innerHeight)){this.menu.style.bottom="",this.menu.style.top=`${i+n}px`;return}this.menu.style.top="auto",this.menu.style.bottom=`${window.innerHeight-e+n}px`}get renderHeader(){return this.name?Z` <div class="header ${this.getClass("header")}">
      <span class="text username ${this.getClass("title")}">${this.name}</span>
      <span class="sv-hr ${this.getClass("divisor")}"></span>
    </div>`:Z``}toggle(){this.disabled||(this.open=!this.open,this.emitEvent("open",{open:this.open}))}getIcon(t){if(!!t)return Z`
      <span class=${this.getClass("item__icon")}>
        <superviz-icon name="${t}" size="sm"></superviz-icon>
      </span>
    `}getLabel(t){return Z`<span class="option-label ${this.getClass("item__label")}">${t}</span>`}get listOptions(){return this.options.map(({label:t,icon:e,active:i})=>{let s={text:!0,[this.getClass("item")]:!0,"text-bold":!0,active:i};return Z`<li @click=${()=>this.callbackSelected({label:t})} class=${so(s)}>
        ${this.getIcon(e)} ${this.getLabel(t)}
      </li>`})}getClass(t){return`${this.classesPrefix}__${t}`}render(){let t={menu:!0,"menu-open":this.open,"menu-left":this.align==="left","menu-right":this.align==="right","who-is-online-dropdown":this.name};return Z`
      <div class="dropdown">
        <div class="dropdown-content" @click=${this.toggle}>
          <slot name="dropdown"></slot>
        </div>
        ${this.tooltip()}
      </div>
      <div class="dropdown-list">
        <div class=${so(t)}>
          ${this.renderHeader}
          <ul class="${this.getClass("items")} items">
            ${this.listOptions}
          </ul>
        </div>
      </div>
    `}};X.styles=Ks,X.properties={open:{type:Boolean},disabled:{type:Boolean},align:{type:String},options:{type:Array},icons:{type:Array},name:{type:String},tooltipData:{type:Object},showTooltip:{type:Boolean},dropdown:{type:Object},canShowTooltip:{type:Boolean},drodpdownSizes:{type:Object},shiftTooltipLeft:{type:Boolean},lastParticipant:{type:Boolean},classesPrefix:{type:String},parentComponent:{type:String},tooltipPrefix:{type:String},returnData:{type:Object}},X=P([Js("superviz-dropdown")],X);l();import{LitElement as Ys,html as ni}from"lit";import{customElement as Zs}from"lit/decorators.js";import{classMap as Xs}from"lit/directives/class-map.js";l();import{css as qs}from"lit";var ro=qs`
  .superviz-who-is-online__tooltip {
    --host-height: 0px;
    --host-width: 0px;
    --vertical-offset: 12px;

    background-color: rgb(var(--sv-gray-600));
    padding: 10px;
    display: flex;
    flex-direction: column;
    gap: 8px;
    align-items: center;
    position: fixed;
    opacity: 0;
    border-radius: 2px;
    cursor: default;
    visibility: hidden;
    transition: opacity 0.2s ease-in-out display 0s;
    z-index: 100;
    overflow-x: clip;
  }

  .superviz-who-is-online__tooltip-arrow {
    width: 13px;
    height: 13px;
    position: absolute;
    background-color: rgb(var(--sv-gray-600));
    transform: rotate(45deg);
    border-top-left-radius: 1px;
    border-bottom-right-radius: 1px;
  }

  .show-tooltip {
    opacity: 1;
    visibility: visible;
  }

  .tooltip-name,
  .tooltip-action {
    margin: 0;
    font-family: roboto;
    white-space: nowrap;
    text-align: center;
    line-height: 1.2;
  }

  .tooltip-name {
    color: white;
    font-size: 14px;
  }

  .tooltip-action {
    color: rgb(var(--sv-gray-400));
    font-size: 12px;
  }

  .tooltip-top {
    bottom: calc(var(--host-height) + var(--vertical-offset));
  }

  .tooltip-bottom {
    bottom: auto;
  }

  .tooltip-center {
    right: auto;
  }

  .tooltip-bottom .superviz-who-is-online__tooltip-arrow {
    top: -6.5px;
  }

  .tooltip-top .superviz-who-is-online__tooltip-arrow {
    bottom: -6.5px;
  }

  .tooltip-center .superviz-who-is-online__tooltip-arrow {
    left: 0;
    margin-left: 50%;
    translate: -50% 0;
  }

  .tooltip-left .superviz-who-is-online__tooltip-arrow {
    translate: 50% 0;
    border-radius: 0;
    right: 0;
  }

  .tooltip-right .superviz-who-is-online__tooltip-arrow {
    translate: -50% 0;
    border-radius: 0;
    left: 0;
  }

  .shift-left {
    --vertical-offset: 2px;
  }
`;l();var ao=T(Ys),Qs=[ao.styles,ro],Q=class extends ao{constructor(){super();this.positionFixedTooltip=()=>{var _,L,m,$,G;if(!this.canAnimate||!this.parentElement){this.hide();return}this.adjustTooltipPosition();let{bottom:t,left:e,width:i,right:s,top:n}=this.parentElement.getBoundingClientRect(),{width:r}=this.tooltip.getBoundingClientRect(),a="auto",c="auto",d="auto",u="auto",g="",v=window.innerWidth>780,b=v?14:12;this.tooltipHorizontalPosition.includes("right")&&(d=`${e+i/2}px`),this.tooltipHorizontalPosition.includes("left")&&(u=`${window.innerWidth-(s-i/2)}px`),this.tooltipHorizontalPosition.includes("center")&&(d=`${e}px`,g=`translateX(-${(r-i)/2}px)`),this.tooltipVerticalPosition.includes("bottom")&&(a=`${t+b}px`,b=-10),this.tooltipVerticalPosition.includes("top")&&(c=`${window.innerHeight-(n-b)}px`,b=10),this.shiftTooltipLeft&&(g=`translate(-${(r-(v?18:10)-42)/2}px, ${b}px)`),(_=this.tooltip)==null||_.style.setProperty("top",a),(L=this.tooltip)==null||L.style.setProperty("left",d),(m=this.tooltip)==null||m.style.setProperty("right",u),($=this.tooltip)==null||$.style.setProperty("bottom",c),(G=this.tooltip)==null||G.style.setProperty("transform",g),this.animationFrame=window.requestAnimationFrame(this.positionFixedTooltip)};this.hide=()=>{this.canAnimate=!1,this.showTooltip=!1,window.cancelAnimationFrame(this.animationFrame)};this.show=()=>{this.canAnimate=!0,this.showTooltip=!0,this.positionFixedTooltip()};this.adjustTooltipVerticalPosition=()=>{let{bottom:t,top:e,width:i}=this.tooltip.getBoundingClientRect(),s=window.innerHeight;if(this.tooltipVerticalPosition.includes("top")&&e<0){this.tooltipVerticalPosition=this.tooltipVerticalPosition.replace("top","bottom");return}this.tooltipVerticalPosition.includes("bottom")&&t>s&&(this.tooltipVerticalPosition=this.tooltipVerticalPosition.replace("bottom","top"))};this.adjustTooltipHorizontalPosition=()=>{let{left:t,right:e,width:i}=this.tooltip.getBoundingClientRect(),s=window.innerWidth,{left:n,width:r,right:a}=this.parentElement.getBoundingClientRect(),c=n+r/2-i/2>0,d=i/2+a-r/2<s;if(c&&d){this.tooltipHorizontalPosition=this.tooltipHorizontalPosition.replace(/left|right/,"center");return}if(t<0){this.tooltipHorizontalPosition=this.tooltipHorizontalPosition.replace("center","right");return}e>s&&(this.tooltipHorizontalPosition=this.tooltipHorizontalPosition.replace("center","left"))};this.adjustTooltipPosition=()=>{if(!this.parentElement){this.hide();return}this.tooltip||(this.tooltip=this.shadowRoot.querySelector(".superviz-who-is-online__tooltip")),this.adjustTooltipVerticalPosition(),this.adjustTooltipHorizontalPosition()};this.tooltipVerticalPosition="tooltip-bottom",this.tooltipHorizontalPosition="tooltip-center",this.showTooltip=!1,this.parentSizes={height:0,width:0}}firstUpdated(t){let{parentElement:e}=this;e==null||e.addEventListener("mouseenter",this.show),e==null||e.addEventListener("mouseleave",this.hide),this.adjustTooltipPosition(),x.call(this,this.parentComponent)}disconnectedCallback(){super.disconnectedCallback();let{parentElement:t}=this;t==null||t.removeEventListener("mouseenter",this.show),t==null||t.removeEventListener("mouseleave",this.hide)}updated(t){if(t.has("showTooltip")&&this.showTooltip){let{parentElement:e}=this;if(!e)return;let{height:i,width:s}=e.getBoundingClientRect();(this.parentSizes.height!==i||this.parentSizes.width!==s)&&(this.parentSizes={height:i,width:s})}}getClass(t){return t?`${this.classesPrefix}__${t}`:this.classesPrefix}renderTooltip(){var s,n,r,a,c;let t=this.tooltipVerticalPosition,e=this.tooltipHorizontalPosition,i={"superviz-who-is-online__tooltip":!0,[this.getClass("")]:!0,[t]:!0,[e]:!0,"tooltip-extras":this.tooltipOnLeft,"show-tooltip":this.showTooltip,"shift-left":this.shiftTooltipLeft};return ni`<div
      class=${Xs(i)}
      style="--host-height: ${(s=this.parentSizes)==null?void 0:s.height}px; --host-width: ${(n=this.parentSizes)==null?void 0:n.width}px;"
    >
      <p class="tooltip-name ${this.getClass("title")}">${(r=this.tooltipData)==null?void 0:r.name}</p>
      ${(a=this.tooltipData)!=null&&a.info?ni`<p class="tooltip-action ${this.getClass("action")}">${(c=this.tooltipData)==null?void 0:c.info}</p>`:""}
      <div class="superviz-who-is-online__tooltip-arrow ${this.getClass("")}"></div>
    </div>`}render(){return ni`${this.renderTooltip()}`}};Q.styles=Qs,Q.properties={tooltipData:{type:Object},tooltipOnLeft:{type:Boolean},showTooltip:{type:Boolean},tooltip:{type:Object},tooltipVerticalPosition:{type:String},tooltipHorizontalPosition:{type:String},parentSizes:{type:Object},shiftTooltipLeft:{type:Boolean},classesPrefix:{type:String},parentComponent:{type:String}},Q=P([Zs("superviz-tooltip")],Q);l();l();import{LitElement as en}from"lit";import{customElement as on}from"lit/decorators.js";l();import{css as tn}from"lit";var Ie=tn`
  .modal--overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(var(--sv-gray-400), 0.8);

    z-index: 999;
  }

  .modal--container {
    display: flex;
    align-items: center;
    justify-content: center;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: transparent;

    z-index: 1000;
  }

  .modal--container > .modal {
    background: #fff;
    min-width: 370px;
    min-height: 150px;
    border-radius: 6px;
  }

  .modal--container > .modal > .modal--header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 16px;
    background: rgb(var(--sv-gray-200));
    border-radius: 6px 6px 0 0;
  }

  .modal--container > .modal > .modal--header > .text {
    display: flex;
    align-items: center;
  }

  .modal--container > .modal > .modal--header > .close {
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    color: rgb(var(--sv-gray-600));
    cursor: pointer;
  }

  .modal--container > .modal > .modal--body {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 24px 24px 0 24px;
  }

  .modal--container > .modal > .modal--body > .modal--body-content {
    padding: 8px 0;
    text-align: center;
  }

  .modal--container > .modal > .modal--footer {
    padding: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 24px;
    padding: 24px;
  }

  .btn {
    width: 150px;
    height: 40px;
    text-transform: uppercase;
  }

  .btn--confirm {
    background: rgb(var(--sv-primary));
    border-radius: 4px;
    border: 1px solid rgb(var(--sv-primary));
    color: #fff;
    cursor: pointer;
  }

  .btn--cancel {
    background: transparent;
    border-radius: 4px;
    border: 1px solid rgb(var(--sv-gray-400));
    color: rgb(var(--sv-gray-400));
    cursor: pointer;
  }
`;var lo=T(en),sn=[lo.styles,Ie],xt=class extends lo{constructor(){super(...arguments);this.getContainer=()=>window.document.querySelector("superviz-modal-container");this.createContainer=t=>{this.modal=document.createElement("superviz-modal-container"),this.modal.setOptions(t)};this.createModal=({detail:t})=>{this.createContainer(t),window.document.body.appendChild(this.modal)};this.destroyModal=()=>{var t;this.modal=void 0,(t=this.getContainer())==null||t.remove()}}firstUpdated(){window.document.body.addEventListener("superviz-modal--open",this.createModal),window.document.body.addEventListener("superviz-modal--close",this.destroyModal)}disconnectedCallback(){this.destroyModal(),window.document.body.removeEventListener("superviz-modal--open",this.createModal),window.document.body.removeEventListener("superviz-modal--close",this.destroyModal)}};xt.styles=sn,xt=P([on("superviz-modal")],xt);l();import{LitElement as nn,html as _t}from"lit";import{customElement as rn}from"lit/decorators.js";var po=T(nn),an=[po.styles,Ie],St=class extends po{constructor(){super(...arguments);this.closeModal=()=>{window.document.body.dispatchEvent(new CustomEvent("superviz-modal--close",{bubbles:!0,composed:!0}))};this.confirmModal=()=>{window.document.body.dispatchEvent(new CustomEvent("superviz-modal--confirm",{bubbles:!0,composed:!0}))}}setOptions(t){this.options=t}render(){let t=()=>_t`
        <div class="modal--header">
          <span class="text text-bold sv-gray-600">${this.options.title}</span>
          <div class="close" @click=${this.closeModal}>
            <superviz-icon name="close" size="md"></superviz-icon>
          </div>
        </div>
      `,e=()=>_t`
        <div class="modal--body">
          <div class="modal--body-content">${this.options.body}</div>
        </div>
      `,i=()=>{if(this.options.footer)return _t` <div class="modal--footer">${this.options.footer}</div> `;let s=this.options.confirmLabel||"OK",n=this.options.cancelLabel||"Cancel";return this.options.confirm&&this.options.cancel?_t`
          <div class="modal--footer">
            <button class="text text-bold btn btn--cancel" @click=${this.closeModal}>
              ${n}
            </button>
            <button class="text text-bold btn btn--confirm" @click=${this.confirmModal}>
              ${s}
            </button>
          </div>
        `:_t`
        <div class="modal--footer">
          <button class="text text-bold btn btn--confirm" @click=${this.confirmModal}>
            ${s}
          </button>
        </div>
      `};return _t`
      <div class="modal--overlay"></div>
      <div class="modal--container">
        <div class="modal">${t()} ${e()} ${i()}</div>
      </div>
    `}};St.styles=an,St=P([rn("superviz-modal-container")],St);l();l();import{LitElement as wn,html as Ei}from"lit";import{customElement as Pn}from"lit/decorators.js";import{classMap as Tn}from"lit/directives/class-map.js";l();l();import{css as ln}from"lit";var ri=ln`
  .superviz-comments {
    --offset-left: 10px;
    --offset-right: 10px;
    --offset-top: 10px;
    --offset-bottom: 10px;

    display: flex;
    flex-direction: column;
    width: 320px;
    position: fixed;
    color: rgb(var(--sv-gray-700));
    background: rgb(var(--sv-white));
    top: 0px;
    bottom: 0;
    box-shadow: -2px 0 4px 0 rgba(0, 0, 0, 0.1);
    z-index: 100;
    overflow: hidden;
    transition: right 0.3s ease-out;
  }

  .header {
    width: 100%;
  }

  .content {
    flex: 1;
    overflow-y: auto;
    overflow-x: hidden;
  }

  .toggle {
    display: flex;
    position: fixed;
    width: 100px;
    color: rgb(var(--sv-gray-700));
    background: rgb(var(--sv-white));
    top: 0;
    right: 0;
    bottom: 0;
  }

  .threads-on-left-side {
    left: var(--offset-left);
    top: var(--offset-top);
    bottom: var(--offset-bottom);
    border-radius: 8px;
  }

  .threads-on-right-side {
    right: var(--offset-right);
    top: var(--offset-top);
    bottom: var(--offset-bottom);
    border-radius: 8px;
  }

  #superviz-comments.threads-on-right-side.hide-at-right {
    right: -330px;
  }

  #superviz-comments.threads-on-left-side.hide-at-left {
    left: -330px;
  }

  .hide-at-right,
  .hide-at-left {
    animation: keep-opacity 0.3s ease-out;
    opacity: 0;
    visibility: hidden;
  }

  @keyframes keep-opacity {
    0%,
    99% {
      visibility: visible;
      opacity: 1;
    }

    100% {
      visibility: hidden;
      opacity: 0;
    }
  }
`;l();import{css as pn}from"lit";var ai=pn`
  .comments__topbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: rgb(var(--sv-gray-200));
    height: 50px;
  }

  .comments__topbar__title {
    margin: 0 16px;
    color: rgb(var(--sv-gray-600));
  }

  .comments__topbar__close-threads {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    transition: 0.15s;
    border-radius: 50%;
    width: 32px;
    height: 32px;
    box-sizing: border-box;
    margin-right: 8px;
    padding-right: 2px;
  }

  .comments__topbar__close-threads:hover {
    background: rgb(var(--sv-gray-300));
  }
`;l();import{css as cn}from"lit";var li=cn`
  .reply {
    padding-left: 24px !important;
  }

  .comments__comment-item {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    justify-content: center;
    padding: 8px;
    gap: 4px;
  }

  .comments__comment-item__header {
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    width: 100%;
    align-items: center;
    color: rgb(var(--sv-gray-500));
  }

  .comments__comment-item__actions {
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .comments__comment-item__actions superviz-dropdown,
  .comments__comment-item__icons {
    width: 25px;
    height: 25px;
    border-radius: 50%;
  }

  .comments__comment-item__metadata {
    display: flex;
    width: 100%;
    gap: 8px;
    align-items: center;
  }

  .comments__comment-item__avatar-container {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    overflow: hidden;
    background-color: rgb(var(--sv-gray-300));
    border: 1px solid rgb(var(--sv-gray-500));
    color: #fff;

    display: flex;
    align-items: center;
    justify-content: center;
  }

  .comments__comment-item__avatar-image {
    width: 100%;
    height: 100%;
    object-fit: contain;
    border-radius: 50%;
  }

  .comments__comment-item__content {
    width: 100%;
    word-wrap: break-word;
  }

  .line-clamp {
    display: -webkit-box;
    -webkit-line-clamp: 4;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .comments__comment-item__content__body {
    color: rgb(var(--sv-gray-700));
    position: relative;
    display: grid;
    grid-template-rows: 0px auto;
  }

  .comments__comment-item__content__body.editing-annotation {
    grid-template-rows: auto 0px;
  }

  .hidden {
    display: none;
  }

  .mentioned {
    display: inline-block;
  }

  .annotation-content {
    transition: opacity 0ms;
    opacity: 1;
    overflow: hidden;
  }

  .editing {
    transition: opacity 400ms;
    overflow: hidden;
    opacity: 0;
    pointer-events: none;
  }

  .comments__input--editable {
    transform: translateY(0);
    opacity: 1;
    overflow: hidden;
  }

  .hide-edit-input {
    transition: opacity 500ms, transform 0 linear 300ms;
    opacity: 0;
    pointer-events: none;
    width: 100%;
  }
`;l();import{css as dn}from"lit";var pi=dn`
  .comments {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 288px;
  }

  .hidden {
    display: none;
  }
`;l();import{css as hn}from"lit";var ci=hn`
  .comments__input {
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    background: rgb(var(--sv-white));
    border-radius: 4px;
    border: 1px solid rgb(var(--sv-gray-300));
    position: relative;
    min-height: 40px;
    box-sizing: border-box;
  }

  .comments__input:focus-within {
    border: 1px solid rgb(var(--sv-gray-500));
  }

  .comments__input__textarea {
    border: 0px;
    text-align: left;
    border-radius: 4px;
    outline: none;
    font-size: 14px;
    color: rgb(var(--sv-gray-700));
    font-family: Roboto;
    white-space: pre-wrap;
    word-wrap: break-word;
    resize: none;
    line-height: 1.15rem;
    max-height: 5rem;
    appearance: none;
    height: 40px;
    width: 100%;
    box-sizing: border-box;

    padding-top: 7px;
    border-top: 8px solid transparent;
    border-bottom: 8px solid transparent;
    border-right: 11px solid transparent;
    border-left: 11px solid transparent;
  }

  .fixed-width {
    width: 288px;
  }

  .comments__input__textarea:invalid {
    border-top: 15px solid transparent;
  }

  .comments__input__textarea::placeholder {
    color: rgb(var(--sv-gray-400));
    font-size: 14px;
    line-height: 14px;
  }

  .comments__input__options {
    display: flex;
    justify-content: space-between;
    box-sizing: border-box;
    overflow: hidden;
    height: 0;
    transition: 0.25s;
    border-radius: 0 0 4px 4px;
  }

  .active-textarea {
    height: 40px;
    padding: 4px 8px;
  }

  .sv-hr {
    border: none;
    width: 100%;
    opacity: 0;
    transition: 0.25s opacity linear, 0.25s visibility;
    visibility: hidden;
    height: 0;
    position: absolute;
  }

  .comments__input__divisor {
    border-top: 1px solid rgb(var(--sv-gray-300));
    opacity: 1;
    position: relative;
    visibility: visible;
  }

  .comment-actions {
    position: absolute;
    left: 8px;
    bottom: 3px;
    opacity: 0;
    transition: 0.25s opacity linear, 0.25s visibility;
    visibility: hidden;
  }

  .active-textarea > .comment-actions {
    opacity: 1;
    visibility: visible;
  }

  .mention:hover {
    background-color: rgb(var(--sv-gray-200));
  }

  .comments__input__button {
    display: flex;
    justify-content: center;
    align-items: center;
    border-radius: 100%;
    width: 32px;
    height: 32px;
    border: 0px;
  }

  .comments__input__send-button {
    background: rgb(var(--sv-primary));
    color: rgba(var(--sv-white), 1);
  }

  .align-send-btn > superviz-icon {
    cursor: pointer;
  }

  .comments__input__button:disabled {
    background: rgb(var(--sv-gray-200));
    color: rgb(var(--sv-gray-600));
  }

  .comment-input-options {
    display: flex;
    gap: 4px;
    position: absolute;
    right: 8px;
    bottom: 4px;
  }

  .comments__input__textarea:focus,
  .comments__input__textarea.active-textarea {
    border-radius: 4px 4px 0 0;
  }

  .comments__input__textarea:focus::placeholder {
    color: transparent;
  }
`;l();import{css as mn}from"lit";var di=mn`
  .comments__thread:hover:not(.comments__thread--selected) {
    background-color: rgba(var(--sv-gray-200), 0.3);
  }

  .avatars-comments {
    display: flex;
    position: absolute;
    bottom: 8px;
    padding: 0 8px;
    opacity: 1;
    transition: opacity 0.3s linear;
  }

  .avatars-comments.invisible {
    opacity: 0;
  }

  .avatar-container {
    position: relative;
    display: flex;
    align-items: center;
    width: 100%;
  }

  .avatar {
    width: 18px;
    height: 18px;
    border-radius: 50%;
    overflow: hidden;
    background-color: rgb(var(--sv-gray-300));
    border: 1px solid rgb(var(--sv-gray-500));
    color: #fff;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .avatar img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    border-radius: 50%;
  }

  .avatar:not(:first-child) {
    margin-left: -6px;
  }

  .comments__thread--selected div:last-child {
    margin-inline: 8px;
  }

  .comments-container {
    display: flex;
    overflow: hidden;
    flex-direction: column;
  }

  .comments-container-wrapper {
    display: grid;
    grid-template-rows: 0fr;
    opacity: 0;
    overflow: hidden;
    transition: grid-template-rows 0.3s linear, opacity 0.3s linear;
  }

  .comments-container-wrapper.show {
    grid-template-rows: 1fr;
    opacity: 1;
  }

  .comments--expand {
    display: flex;
  }

  .comment-avatar--expand {
    display: block;
  }

  .hidden {
    overflow: hidden;
    opacity: 0;
  }

  .comments__thread {
    grid-row: 1 / span 2;
    padding: 8px;
    position: relative;
    cursor: pointer;
    transition: padding-bottom 0.3s linear, opacity 0.3s linear;
  }

  .extra-space-bottom {
    padding-bottom: 35px;
  }

  .comments__thread--selected {
    background-color: rgba(var(--sv-gray-200), 0.5);
    padding-bottom: 16px;
  }

  .hide-input {
    display: none;
  }

  .wrapper {
    margin-inline: 0;
    display: grid;
    grid-template-rows: 0fr;
    opacity: 0;
    width: 100%;
    transition: grid-template-rows 0.3s linear, opacity 0.3s linear;
  }

  .show-wrapper {
    grid-template-rows: 1fr;
    opacity: 1;
  }

  .comments__complete-annotation {
    position: relative;
    width: 100%;
  }

  .comments__hide-complete-annotation {
    min-height: 0;
    opacity: 0;
    animation: hide-annotation 10s linear;
  }

  @keyframes hide-annotation {
    0%,
    95% {
      min-height: 43px;
      opacity: 1;
    }

    100% {
      opacity: 0;
      min-height: 0;
    }
  }

  .comments__resolved-annotation-message {
    position: absolute;
    width: 100%;
    top: 0;
  }
`;l();import{css as un}from"lit";var hi=un`
  .comments__annotation-resolved {
    background: rgba(var(--sv-gray-200), 0.5);
    height: 26px;
    padding: 8px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    border-bottom: 1px solid rgb(var(--sv-gray-200));
  }
`;l();import{css as vn}from"lit";var mi=vn`
  .preload {
    animation-duration: 0s !important;
  }

  .comments__annotation-pin,
  .comments__annotation-pin__avatar {
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    pointer-events: auto;
    z-index: 10;
    transform-origin: bottom left;
  }

  .comments__annotation-pin:hover {
    transform: scale(1.2);
    animation: growing-spring 0.3s linear;
  }

  .comments__annotation-pin:not(:hover) {
    animation: shrinking-spring 0.3s linear;
  }

  .comments__annotation-pin--add {
    transform: scale(1) !important;
    animation: none !important;
  }

  .comments__annotation-pin {
    position: absolute;

    width: 32px;
    height: 32px;

    background-color: rgb(var(--sv-white));
    border-radius: 50%;
    border-bottom-left-radius: 2px;

    border: 2px solid rgb(var(--sv-white));
    box-shadow: 0px 2px 6px 0px rgba(0, 0, 0, 0.35);
    transition: border-color 0.2s ease-in-out opacity 0.2s ease-in-out;
    padding: 2px;
    box-sizing: border-box;
    cursor: pointer;
  }

  .comments__annotation-pin:hover,
  .comments__annotation-pin:focus,
  .comments__annotation-pin--active {
    border-color: rgb(var(--sv-primary));
  }

  .comments__cursor-pointer,
  .comments__cursor-pointer .comments__annotation-pin__avatar {
    pointer-events: none;
  }

  .comments__annotation-pin__avatar {
    width: 100%;
    height: 100%;

    background-color: rgb(var(--sv-gray-400));
    border-radius: 50%;

    color: rgb(var(--sv-white));
  }

  .comments__annotation-pin__avatar img {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    object-fit: contain;
  }

  .comments__annotation-pin__avatar--add {
    color: rgb(var(--sv-gray-700));
    background-color: rgb(var(--sv-white));
  }

  .floating-input {
    position: absolute;
    top: -2px;
    opacity: 0;
  }

  .left .floating-input {
    right: auto;
    left: 0;
    transform: translateX(calc(-100% - 7px));
    opacity: 1;
  }

  .right .floating-input {
    left: auto;
    right: 0;
    transform: translateX(calc(100% + 7px));
    opacity: 1;
  }

  .comments__annotation-pin-wrapper {
    transform-origin: center;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    position: absolute;
  }

  .comments__annotation-pin-wrapper--new {
    animation: bounce 0.5s linear !important;
  }

  .comments__annotation-pin-wrapper--new .comments__annotation-pin__avatar {
    transform-origin: center;
    animation: avatar-bounce 0.5s linear !important;
  }

  @keyframes avatar-bounce {
    0%,
    40% {
      transform: scale(1);
    }

    48% {
      transform: scale(0.8);
    }

    55%,
    92% {
      transform: scale(1);
    }

    96% {
      transform: scale(0.9);
    }

    100% {
      transform: scale(1);
    }
  }
  @keyframes bounce {
    0% {
      transform: scale(1);
    }

    20% {
      transform: scale(1.3);
    }

    40%,
    55% {
      transform: scale(1);
    }

    75% {
      transform: scale(1.15);
    }

    92%,
    100% {
      transform: scale(1);
    }
  }

  @keyframes growing-spring {
    0% {
      transform: scale(1);
    }

    25% {
      transform: scale(1.3);
    }

    50% {
      transform: scale(1.2);
    }

    75% {
      transform: scale(1.25);
    }

    100% {
      transform: scale(1.2);
    }
  }

  @keyframes shrinking-spring {
    0% {
      transform: scale(1.2);
    }

    33% {
      transform: scale(1);
    }

    66% {
      transform: scale(1.1);
    }

    100% {
      transform: scale(1);
    }
  }
`;l();import{css as gn}from"lit";var ui=gn`
  .comments__filter-container {
    display: flex;
    width: 100%;
    justify-content: flex-start;
    align-items: center;
  }

  .comments__filter {
    white-space: nowrap;
    padding: 12px;
    cursor: pointer;
    color: rgb(var(--sv-gray-500));
  }

  .content {
    display: flex;
    justify-content: space-between;
    flex-direction: row;
    align-items: center;
    gap: 6px;
  }

  .comments__filter__toggle-button {
    display: flex;
    flex-direction: row;
    gap: 4px;
  }

  .comments__filter__icon {
    margin-top: -2px;
  }
`;l();import{css as bn}from"lit";var vi=bn`
  .comments__floating-button {
    position: fixed;
    border-radius: 50%;
    width: 38px;
    height: 38px;
    display: flex;
    align-items: center;
    gap: 4px;
    border: none;
    background-color: rgba(var(--sv-white));
    box-shadow: 2px 2px 15px 0px rgba(0, 0, 0, 0.2);
    color: rgb(var(--sv-gray-600));
    cursor: pointer;
    overflow: hidden;
    padding-left: 10px;
    z-index: 99;
    transition: width 300ms linear, border-radius 300ms linear;
  }

  .comments__floating-button:hover,
  .comments__floating-button.is-active {
    background-color: rgb(var(--sv-gray-400));
    color: rgba(var(--sv-white));
  }

  .comments-floating-button-hovered {
    transition: width 300ms linear 300ms, border-radius 300ms linear 300ms;
  }

  .comments__floating-button__text {
    text-align: left;
    overflow: hidden;
    position: relative;
    margin: 0;
    line-height: 1;
    right: 0px;
  }

  .not-hovered {
    animation-duration: 0s !important;
    transition-duration: 0s !important;
  }

  .hide-button {
    display: none !important;
  }

  .is-inactive:hover {
    width: 110px;
    border-radius: 30px;
  }

  .is-active:hover {
    width: 92px;
    border-radius: 30px;
    animation: decrease-width 600ms linear;
  }

  .textInactive.cancel {
    position: absolute;
    bottom: -30px;
    animation: drop-cancel-text 600ms linear;
    right: auto;
  }

  .textInactive.comment {
    position: absolute;
    top: 0;
    animation: drop-comment-text 600ms linear;
  }

  .textActive.comment {
    position: absolute;
    top: -30px;
    animation: rise-comment-text 600ms linear;
    right: auto;
  }

  .textActive.cancel {
    position: absolute;
    bottom: 0;
    animation: rise-cancel-text 600ms linear;
  }

  .comments__floating-button .comments__floating-button-text-box {
    width: 0;
  }

  .comments__floating-button.is-inactive:hover .comments__floating-button-text-box {
    width: 61.45px;
  }

  .comments__floating-button.is-active:hover .comments__floating-button-text-box {
    width: 43.0833px;
  }

  .comments__floating-button-text-box {
    position: relative;
    height: 14px;
    overflow-x: clip;
    transition: width 300ms linear;
  }

  .comments__floating-button__icon {
    position: relative;
  }

  .cross {
    position: absolute;
    top: 9px;
    left: 5.3px;
    transform: translateY(-50%);
    transform-origin: center;
    transition: transform 300ms linear 300ms;
  }

  rect {
    fill: rgba(var(--sv-gray-600));
  }

  .comments__floating-button:hover rect,
  .is-active rect {
    fill: rgba(var(--sv-white));
  }

  .cross-bar-1 {
    transform-origin: center;
    transform: rotate(0deg);
  }

  .cross-bar-2 {
    transform-origin: center;
    transform: rotate(90deg);
  }

  .is-active .cross {
    transform: translateY(-50%) rotate(45deg);
  }

  @keyframes rise-cancel-text {
    0%,
    50% {
      opacity: 0;
      bottom: -35px;
    }

    75% {
      opacity: 0;
    }

    100% {
      opacity: 1;
      bottom: 0px;
    }
  }

  @keyframes rise-comment-text {
    0% {
      opacity: 1;
      top: 0px;
    }

    35% {
      opacity: 0;
    }

    50%,
    100% {
      opacity: 0;
      top: -35px;
    }
  }

  @keyframes drop-cancel-text {
    0% {
      opacity: 1;
      bottom: 0px;
    }

    35% {
      opacity: 0;
    }

    50%,
    100% {
      opacity: 0;
      bottom: -30px;
    }
  }

  @keyframes drop-comment-text {
    0%,
    50% {
      opacity: 0;
      top: -30px;
    }

    75% {
      opacity: 0;
    }

    100% {
      opacity: 1;
      top: 0px;
    }
  }
`;l();import{css as fn}from"lit";var gi=fn`
.footer {
  bottom: 5px;
  position: absolute;
  right: 5px;
  font-family: Roboto,sans-serif;
  font-size: 10px;
  line-height: 15px;
  letter-spacing: normal;
}

.link {
  text-decoration: none;
  color: rgb(var(--sv-gray-500));
}

.powered-by {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  width: 140px;
  &--vertical {
    justify-content: flex-end;
  }
  &--horizontal {
    justify-content: center;
  }
}
`;l();import{css as yn}from"lit";var bi=yn`
  #mention-list {
    position: absolute;
    z-index: 1;
    max-height: 200px;
    overflow-y: auto;
    overflow-x: hidden;
    background-color: white;
    display: none;
    width: 216px;
    text-align: -webkit-center;
    border-radius: 2px;
    box-shadow: 2px 2px 8px 0px rgba(0, 0, 0, 0.30);
    padding-top: 4px;
    padding-bottom: 4px;
    /* Stiling scroll WebKit (Firefox) */
    scrollbar-width: 6px; /* Firefox */
    scrollbar-color: #888; /* Firefox */
    /* Style scroll WebKit (Chrome, Safari, Edge) */
    &::-webkit-scrollbar {
      width: 6px;
    }
    &::-webkit-scrollbar-thumb {
      background-color: #888;
    }
  }

  .mention-item {
    cursor: pointer;
    align-items: center;
    display: flex;
    height: 48px;
    width: 208px;
    margin-left: 4px;
    margin-right: 4px;
  }

  .mention-item:hover {
    background: rgb(var(--sv-gray-200));
  }

  .avatar {
    width: 32px;
    height: 32px;
    object-fit: contain;
    border-radius: 32%;
    margin-right: 14px;
    margin-left: 12px;
  }

  .default-avatar {
    width: 32px;
    height: 32px;
    margin-right: 14px;
    margin-left: 12px;
    border-radius: 50%;
    overflow: hidden;
    background-color: rgb(var(--sv-gray-300));
    border: 1px solid rgb(var(--sv-gray-500));
    color: #fff;

    display: flex;
    align-items: center;
    justify-content: center;
  }

  .avatar-type {
    font-family: Roboto;
    font-size: 14px;
    font-style: normal;
    font-weight: 400;
    line-height: 20px;
    color: rgb(var(--sv-gray-600));
  }
`;l();var fi;function yi(p){let o=p.querySelector("#superviz-comments");if(o&&!fi){let t={childList:!0,attributes:!0,characterData:!0,subtree:!0};fi=new MutationObserver(e=>{e.forEach(i=>{!i.removedNodes.length||i.removedNodes.forEach(s=>{s.id==="poweredby-footer"&&En(p)})})}),fi.observe(o,t)}}function En(p){let o=document.createElement("div");o.id="poweredby-footer",o.className="footer";let t=document.createElement("div");t.className="powered-by powered-by--horizontal";let e=document.createElement("a");e.href="https://superviz.com/",e.target="_blank",e.className="link";let i=document.createElement("div");i.textContent="Powered by";let s=document.createElement("img");s.width=48,s.height=8.86,s.src="https://production.cdn.superviz.com/static/superviz-gray-logo.svg",t.appendChild(e),e.appendChild(i),i.appendChild(s),o.appendChild(t);let n=p.getElementById("superviz-comments");n&&n.appendChild(o),yi(p)}var co=T(wn),An=[co.styles,ri,gi],tt=class extends co{constructor(){super();this.annotations=[],this.annotationFilter="All comments",this.waterMarkState=!1,this.participantsList=[],this.side="left"}firstUpdated(t){super.firstUpdated(t),this.updateComplete.then(()=>{x.call(this,["comments"])})}updated(t){super.updated(t),this.updateComplete.then(()=>{this.waterMarkState&&yi(this.shadowRoot),t.has("offset")&&this.applyOffset()})}participantsListed(t){this.participantsList=t}updateAnnotations(t){this.annotations=t}close(){this.emitEvent("close-threads",{})}waterMarkStatus(t){this.waterMarkState=t}setFilter({detail:t}){let{filter:{label:e}}=t;this.annotationFilter=e}getOffset(t){return t==null||t<0?"10px":`${t}px`}applyOffset(){let t=this.shadowRoot.querySelector(".superviz-comments");if(!t)return;let{left:e,right:i,top:s,bottom:n}=this.offset;t.style.setProperty("--offset-top",this.getOffset(s)),t.style.setProperty("--offset-bottom",this.getOffset(n)),t.style.setProperty("--offset-right",this.getOffset(i)),t.style.setProperty("--offset-left",this.getOffset(e))}get poweredBy(){return this.waterMarkState?Ei` <div id="poweredby-footer" class="footer">
      <div class="powered-by powered-by--horizontal">
        <a href="https://superviz.com/" target="_blank" class="link">
          <div class="">
            Powered by
            <img
              width="48px"
              height="8.86px"
              src="https://production.cdn.superviz.com/static/superviz-gray-logo.svg"
            />
          </div>
        </a>
      </div>
    </div>`:Ei``}render(){let t={"superviz-comments":!0,"threads-on-left-side":this.side==="left","threads-on-right-side":this.side==="right","hide-at-right":this.side==="right"&&!this.open,"hide-at-left":this.side==="left"&&!this.open};return Ei`
      <div id="superviz-comments" class=${Tn(t)}>
        <div class="header">
          <superviz-comments-topbar
            @close-threads=${this.close}
            side=${this.side.split(":")[0]}
          ></superviz-comments-topbar>
        </div>
        <superviz-comments-annotation-filter
          filter=${this.annotationFilter}
          @select=${this.setFilter}
        >
        </superviz-comments-annotation-filter>
        <superviz-comments-content
          annotations=${JSON.stringify(this.annotations)}
          annotationFilter=${this.annotationFilter}
          participantsList=${JSON.stringify(this.participantsList)}
          class="content"
        ></superviz-comments-content>
        ${this.poweredBy}
      </div>
    `}};tt.styles=An,tt.properties={open:{type:Boolean},annotations:{type:Object},annotationFilter:{type:String},waterMarkState:{type:Boolean},side:{type:String},participantsList:{type:Object},offset:{type:Object}},tt=P([Pn("superviz-comments")],tt);l();l();import{LitElement as ho,html as Cn}from"lit";import{customElement as xn}from"lit/decorators.js";var _n=T(ho),Sn=[_n.styles,ai],et=class extends T(ho){firstUpdated(t){super.firstUpdated(t),this.updateComplete.then(()=>{x.call(this,["comments"])})}close(){this.dispatchEvent(new CustomEvent("close-threads"))}render(){return Cn`
      <div class="comments__topbar">
        <span class="text text-bold comments__topbar__title">COMMENTS</span>
        <span @click=${this.close} class="comments__topbar__close-threads">
          <superviz-icon name=${this.side}></superviz-icon>
        </span>
      </div>
    `}};et.styles=Sn,et.properties={side:{type:String}},et=P([xn("superviz-comments-topbar")],et);l();import{LitElement as On,html as mo}from"lit";import{customElement as Ln}from"lit/decorators.js";import{repeat as In}from"lit/directives/repeat.js";var uo=T(On),Rn=[uo.styles,pi],it=class extends uo{constructor(){super();this.unselectAnnotation=()=>{this.selectedAnnotation=null};this.unselectAnnotationEsc=t=>{t&&(t==null?void 0:t.key)!=="Escape"||(this.selectedAnnotation=null)};this.selectAnnotation=({detail:t})=>{let{uuid:e}=t;if(this.selectedAnnotation===e){this.selectedAnnotation=null;return}this.selectedAnnotation=e};this.checkLastAnnotation=t=>{var s,n;let e=this.annotations.filter(r=>r.resolved),i=this.annotations.filter(r=>!r.resolved);return this.annotationFilter==="All comments"?t===((s=e[e.length-1])==null?void 0:s.uuid):t===((n=i[i.length-1])==null?void 0:n.uuid)};this.annotations=[],this.participantsList=[]}updated(t){super.updated(t),this.updateComplete.then(()=>{let e=this.shadowRoot.querySelector(`[uuid='${this.selectedAnnotation}']`);if(!e)return;let i=this.lastCommentId===this.selectedAnnotation,s=i?0:-150,n=e.getClientRects()[0];!n||(this.scrollBy(0,n.y+s),i&&setTimeout(()=>{this.scrollBy(0,n.y+s)},200))})}connectedCallback(){super.connectedCallback(),window.document.body.addEventListener("select-annotation",this.selectAnnotation),window.document.body.addEventListener("keyup",this.unselectAnnotationEsc),window.document.body.addEventListener("unselect-annotation",this.unselectAnnotation)}disconnectedCallback(){super.disconnectedCallback(),window.document.body.removeEventListener("select-annotation",this.selectAnnotation),window.document.body.removeEventListener("keyup",this.unselectAnnotationEsc),window.document.body.removeEventListener("unselect-annotation",this.unselectAnnotation)}render(){return mo` ${In(this.annotations.filter(t=>{var e;return(e=t.comments)==null?void 0:e.length}),t=>t.uuid,t=>mo`
        <superviz-comments-annotation-item
          annotation=${JSON.stringify(t)}
          selected="${this.selectedAnnotation}"
          annotationFilter=${this.annotationFilter}
          uuid=${t.uuid}
          isLastComment=${this.checkLastAnnotation(t.uuid)}
          participantsList=${JSON.stringify(this.participantsList)}
        >
        </superviz-comments-annotation-item>
      `)}`}};it.styles=Rn,it.properties={annotations:{type:Object},selectedAnnotation:{type:String},annotationFilter:{type:String},participantsList:{type:Object}},it=P([Ln("superviz-comments-content")],it);l();import{LitElement as kn,html as oe}from"lit";import{customElement as Nn}from"lit/decorators.js";import{classMap as Me}from"lit/directives/class-map.js";import{DateTime as Fn}from"luxon";var vo=T(kn),Dn=[vo.styles,li],ot=class extends vo{constructor(){super();this.unselectAnnotationEsc=t=>{t.key==="Escape"&&(this.isSelected=!1)};this.unselectAnnotation=()=>{this.isSelected=!1};this.selectAnnotation=({detail:t})=>{let{uuid:e}=t;if(this.isSelected){this.isSelected=!1;return}this.isSelected=e===this.annotationId};this.updateComment=({detail:t})=>{let{text:e,mentions:i}=t;this.text=e,this.closeEditMode(),this.emitEvent("update-comment",{uuid:this.uuid,mentions:i,text:e})};this.resolveAnnotation=t=>{t.stopPropagation(),this.emitEvent("resolve-annotation",{type:"resolve-annotation",resolved:!this.resolved},{composed:!1,bubbles:!1})};this.confirmDelete=()=>{if(this.deleteCommentModalOpen=!1,this.primaryComment)return this.emitEvent("delete-annotation",{uuid:this.annotationId});this.emitEvent("delete-comment",{annotationId:this.annotationId,uuid:this.uuid})};this.closeEditMode=()=>{this.mode="readonly",this.emitEvent("edit-comment",{editing:!1})};this.resolved=!1}firstUpdated(t){super.firstUpdated(t),this.updateComplete.then(()=>{x.call(this,["comments"])}),document.body.addEventListener("select-annotation",this.selectAnnotation)}connectedCallback(){super.connectedCallback(),window.document.body.addEventListener("select-annotation",this.selectAnnotation),window.document.body.addEventListener("keyup",this.unselectAnnotationEsc),window.document.body.addEventListener("unselect-annotation",this.unselectAnnotation)}disconnectedCallback(){super.disconnectedCallback(),window.document.body.removeEventListener("select-annotation",this.selectAnnotation),window.document.body.removeEventListener("keyup",this.unselectAnnotationEsc),window.document.body.removeEventListener("unselect-annotation",this.unselectAnnotation)}getAvatar(){var t;return this.avatar?oe` <div class=${this.getClasses("avatar-container")}>
        <img src=${this.avatar} class=${this.getClasses("avatar-image")} />
      </div>`:oe`<div class=${this.getClasses("avatar-container")}>
      <p class="text text-bold ${this.getClasses("avatar-letter")}">
        ${((t=this.username[0])==null?void 0:t.toUpperCase())||"A"}
      </p>
    </div>`}getClasses(t){return`comments__comment-item__${t} ${this.class}__${t}`}render(){let t=this.annotationFilter==="All comments"?"resolve":"undo",e=g=>Fn.fromISO(g).toFormat("yyyy-dd-MM"),i=this.resolvable?"comments__comment-item__resolve":"hidden",s=[{label:"EDIT"},{label:"DELETE"}],n=({detail:{label:g}})=>{g==="EDIT"&&(this.mode="editable",this.emitEvent("edit-comment",{editing:!0})),g==="DELETE"&&(this.deleteCommentModalOpen=!0)},r=()=>{let g={"comments__comment-item--editable":!0,"hide-edit-input":this.mode!=="editable"};return oe`
        <superviz-comments-comment-input
          class="${Me(g)}"
          editable
          mode=${this.mode}
          @click=${v=>v.stopPropagation()}
          text=${this.text}
          eventType="update-comment"
          participantsList=${JSON.stringify(this.participantsList)}
          mentions=${JSON.stringify(this.mentions)}
          @update-comment=${this.updateComment}
          @close-edit-mode=${this.closeEditMode}
        ></superviz-comments-comment-input>
      `},a=()=>{let g={text:!0,"text-big":!0,"sv-gray-700":!0,"annotation-content":!0,[this.getClasses("content")]:!0,editing:this.mode==="editable","line-clamp":!this.isSelected&&this.text.length>120};return oe` <p id="comment-text" class="${Me(g)}">${this.text}</p> `},c=()=>{this.deleteCommentModalOpen=!1},d={[this.class]:!0,"comments__comment-item":!0,reply:!this.primaryComment},u={"comments__comment-item__content__body":!0,"editing-annotation":this.mode==="editable"};return oe`
      <div class=${Me(d)}>
        <div class=${this.getClasses("header")}>
          <div class=${this.getClasses("metadata")}>
            ${this.getAvatar()}
            <span class="text text-big text-bold sv-gray-700 ${this.getClasses("username")}">
              ${this.username}
            </span>
            <span class="text text-small sv-gray-500 ${this.getClasses("date")}">
              ${e(this.createdAt)}
            </span>
          </div>
          <div class=${this.getClasses("actions")}>
            <button
              @click=${this.resolveAnnotation}
              class="${this.getClasses("icons")} ${this.getClasses("resolve-icon")} icon-button icon-button--clickable icon-button--xsmall ${i}"
            >
              <!-- TODO: Add undo icon in sm format -->
              <superviz-icon name=${t} size="sm"></superviz-icon>
            </button>
            <superviz-dropdown
              options=${JSON.stringify(s)}
              position="bottom-left"
              @selected=${n}
              @click=${g=>{g.stopPropagation()}}
              classesPrefix="comments__dropdown"
              parentComponent="comments"
            >
              <button
                slot="dropdown"
                class="${this.getClasses("icons")} ${this.getClasses("options-icon")} icon-button icon-button--clickable icon-button--small"
              >
                <superviz-icon name="more" size="sm"></superviz-icon>
              </button>
            </superviz-dropdown>
          </div>
        </div>

        <div class="comments__comment-item__content">
          <div class="${Me(u)}">${r()} ${a()}</div>
        </div>
      </div>
      <superviz-comments-delete-comments-modal
        ?open=${this.deleteCommentModalOpen}
        @close=${c}
        @confirm=${this.confirmDelete}
      >
      </superviz-comments-delete-comments-modal>
    `}};ot.styles=Dn,ot.properties={uuid:{type:String},annotationId:{type:String},avatar:{type:String},username:{type:String},text:{type:String},resolved:{type:Boolean},resolvable:{type:Boolean},createdAt:{type:String},mode:{type:String},deleteCommentModalOpen:{type:Boolean},primaryComment:{type:Boolean},isSelected:{type:Boolean},annotationFilter:{type:String},participantsList:{type:Object},mentions:{type:Array},class:{type:String}},ot=P([Nn("superviz-comments-comment-item")],ot);l();import{LitElement as Gn,html as Pi}from"lit";import{customElement as zn}from"lit/decorators.js";import{classMap as fo}from"lit/directives/class-map.js";l();var ke=class{constructor(){this.keys=["@"];this.input=null,this.mentions=[]}setInput(o){this.event=o,this.input=o.target,this.key=o.data}getMentions(o,t=[]){return t.length>0&&(this.mentions=t),this.mentions.filter(e=>((s,n)=>n.includes(s.name))(e,o))}setMentions(o){this.mentions=o}addMention(o){this.mentions.some(e=>e.userId===o.userId)||this.mentions.push(o)}clearMentions(){this.mentions=[]}getSelectionPosition(){var i;let o=this.getSelectionStart(),t=this.getLastKeyBeforeCaret(o);return{start:((i=t==null?void 0:t.keyIndex)!=null?i:-1)+1,end:o}}getSelectionStart(){var o;return(o=this.input)==null?void 0:o.selectionStart}setCaretPosition(o){this.input.selectionEnd=o}getValue(){var o;return(o=this.input)==null?void 0:o.value}setValue(o){this.input.value=o}getLastKeyBeforeCaret(o){let[t]=this.keys.map(e=>({key:e,keyIndex:this.getValue().lastIndexOf(e,o-1)})).sort((e,i)=>i.keyIndex-e.keyIndex);return t}searchMention(o,t){return t!==-1?this.getValue().substring(t+1,o):null}isDeletion(){return this.event.inputType==="deleteContentBackward"||this.event.inputType==="deleteContentForward"||this.event.inputType==="deleteWordBackward"}insertMention(o,t,e){if(this.isDeletion())return;let{id:i,name:s}=e,n=`${this.getValue().slice(0,o)+s} ${this.getValue().slice(t,this.getValue().length)}`;this.setValue(n),this.input.focus(),this.addMention({userId:i,name:s}),this.setCaretPosition(o+s.length+1)}};l();var wi={SHOW:"show",HIDE:"hide"},Bn={action:wi.HIDE,mentions:[],findDigitParticipant:!1},$n=(p,o,t)=>{var s,n;let e=[];if(e=t==null?void 0:t.filter(r=>r==null?void 0:r.email),p.length>0&&(e=e.filter(r=>(r==null?void 0:r.name.toLowerCase().search(p.toLowerCase()))!==-1),p===((n=(s=e[0])==null?void 0:s.name)==null?void 0:n.toLowerCase()))){let r=go(e,o);return{action:wi.HIDE,mentions:r,findDigitParticipant:!0}}if(!((e==null?void 0:e.length)>0))return Bn;let i=go(e,o);return{action:wi.SHOW,mentions:i,findDigitParticipant:!1}},go=(p,o)=>p.map(t=>({id:t.id,name:t.name,avatar:t.avatar,email:t.email,position:o})),bo={matchParticipant:(p,o,t)=>$n(p,o,t)};var yo=T(Gn),Hn=[yo.styles,ci],st=class extends yo{constructor(){super();this.pinCoordinates=null;this.autoCompleteHandler=new ke;this.addAtSymbolInCaretPosition=()=>{let t=this.shadowRoot.querySelector(".comments__input__textarea"),e=new InputEvent("input",{bubbles:!0,cancelable:!0});Object.defineProperty(e,"data",{value:"@",writable:!0}),t.dispatchEvent(e)};this.getCommentInput=()=>this.shadowRoot.querySelector(".comments__input__textarea");this.userMentionedByTextInput=t=>{this.mentionList=[];let e={detail:f({},t[0])};this.insertMention(e)};this.buttonAtSymbol=()=>{var a;let t=this.autoCompleteHandler.getSelectionStart(),e=this.autoCompleteHandler.getValue();this.autoCompleteHandler.setValue(`${e.slice(0,t)}@${e.slice(t,e.length)}`),t+=1;let i=this.autoCompleteHandler.getLastKeyBeforeCaret(t),s=(a=i==null?void 0:i.keyIndex)!=null?a:-1,n=this.autoCompleteHandler.searchMention(t,s),r={start:s+1,end:t};return{searchText:n,position:r}};this.focusInput=()=>{this.getCommentInput().focus()};this.handleInput=t=>{var v,b;if(((v=this.commentInput)==null?void 0:v.value.length)===0?this.btnActive=!1:this.btnActive=!0,t.data===null)return;this.autoCompleteHandler.setInput(t);let e=this.autoCompleteHandler.getSelectionStart(),i=this.autoCompleteHandler.getLastKeyBeforeCaret(e),s=(b=i==null?void 0:i.keyIndex)!=null?b:-1,n=this.autoCompleteHandler.searchMention(e,s),r=this.autoCompleteHandler.getSelectionPosition(),a=t.data==="@"&&s===-1,c=t.data==="@"&&e-1!==s;if(a||c){let _=this.buttonAtSymbol();n=_.searchText,r=_.position}if(n===null){this.mentionList=[];return}let{action:d,mentions:u,findDigitParticipant:g}=bo.matchParticipant(n,r,this.participantsList);if(g){this.userMentionedByTextInput(u);return}d==="show"&&(this.mentionList=u),d==="hide"&&(this.mentionList=[])};this.insertMention=t=>{let{id:e,name:i,avatar:s,email:n,position:r}=t.detail;this.autoCompleteHandler.insertMention(r.start,r.end,{id:e,name:i,avatar:s,email:n}),this.mentionList=[],this.updateHeight()};this.sendEnter=t=>{var n;if(t.key!=="Escape"&&t.stopImmediatePropagation(),t.key==="Enter"&&!t.shiftKey&&t.preventDefault(),t.key!=="Enter"||t.shiftKey||((n=this.mentionList)==null?void 0:n.length)>0)return;let e=this.commentInput,i=e.value.trim();if(!i)return;let s=this.autoCompleteHandler.getMentions(i);this.emitEvent(this.eventType,{text:i,mentions:s,position:this.pinCoordinates},{composed:!1,bubbles:!1}),e.value="",this.sendBtn.disabled=!0,this.updateHeight()};this.closeEditMode=()=>{this.emitEvent("close-edit-mode",{},{composed:!1,bubbles:!1}),this.hideInput=!0};this.onTextareaFocus=()=>{let t=this.optionsContainer,e=this.horizontalRule,i=this.commentInput;t.classList.add("active-textarea"),e.classList.add("comments__input__divisor"),i.classList.add("active-textarea")};this.onTextareaLoseFocus=t=>{var r,a;let e=(a=(r=t.explicitOriginalTarget)==null?void 0:r.parentNode)==null?void 0:a.host;if(this.closeButton.contains(e)||this.closeButton.contains(t.explicitOriginalTarget)||this.closeButton.contains(t.relatedTarget)){this.cancelComment();return}if(!this.shadowRoot.contains(t.target))return;let i=this.optionsContainer,s=this.horizontalRule,n=this.commentInput;n.value.length||(i.classList.remove("active-textarea"),s.classList.remove("comments__input__divisor"),n.classList.remove("active-textarea"))};this.cancelComment=()=>{document.body.dispatchEvent(new KeyboardEvent("keyup",{key:"Escape"}))};this.commentInputEditableOptions=()=>{var t;if(!!this.editable)return Pi`
      <button
        id="close"
        @click=${this.closeEditMode}
        class="icon-button icon-button--medium icon-button--clickable comments__input__button comments__input__close-button"
      >
        <superviz-icon name="close" size="sm"></superviz-icon>
      </button>
      <button
        id="confirm"
        class="icon-button icon-button--medium icon-button--clickable icon-button--no-hover comments__input__button comments__input__send-button"
        disabled
        @click=${this.send}
      >
        <superviz-icon
          color=${((t=this.sendBtn)==null?void 0:t.disabled)||!this.sendBtn?"black":"white"}
          name="check"
          size="sm"
        ></superviz-icon>
      </button>
    `};this.commentInputOptions=()=>{var t;if(!this.editable)return Pi`
      <button
        class="icon-button icon-button--medium icon-button--clickable comments__input__button comments__input__close-button align-send-btn"
        @click=${this.cancelComment}
      >
        <superviz-icon name="close" size="sm"></superviz-icon>
      </button>
      <button
        class="comments__input__button comments__input__send-button align-send-btn"
        disabled
        @click=${this.send}
      >
        <superviz-icon
          color=${((t=this.sendBtn)==null?void 0:t.disabled)||!this.sendBtn?"black":"white"}
          name="line-arrow-right"
          size="sm"
        ></superviz-icon>
      </button>
    `};this.btnActive=!1,this.text="",this.mentionList=[],this.mentions=[],this.mode="readonly"}get commentInput(){return this.shadowRoot.querySelector(".comments__input__textarea")}get sendBtn(){return this.shadowRoot.querySelector(".comments__input__send-button")}get optionsContainer(){return this.shadowRoot.querySelector(".comments__input__options")}get horizontalRule(){return this.shadowRoot.querySelector(".sv-hr")}get closeButton(){return this.shadowRoot.querySelector(".comments__input__close-button")}connectedCallback(){super.connectedCallback(),["create-annotation","create-comment"].includes(this.eventType)&&this.addEventListener("keyup",this.sendEnter)}disconnectedCallback(){if(super.disconnectedCallback(),!["create-annotation","create-comment"].includes(this.eventType))return;let t=this.getCommentInput();this.removeEventListener("keyup",this.sendEnter),t.removeEventListener("keydown",this.sendEnter),t.removeEventListener("click",this.focusInput),t.addEventListener("input",this.handleInput)}firstUpdated(t){this.updateComplete.then(()=>{this.emitEvent("comment-input-ready",{},{composed:!1,bubbles:!1});let e=this.getCommentInput();if(e&&(e.addEventListener("input",this.handleInput),e.addEventListener("click",this.focusInput),e.addEventListener("keydown",this.sendEnter)),this.text.length>0){let i=this.participantsList.map(({id:s,name:n})=>({userId:s,name:n}));this.mentions=this.autoCompleteHandler.getMentions(this.text,i),this.autoCompleteHandler.setMentions(this.mentions)}this.editable&&this.focusInput(),x.call(this,["comments"])})}updated(t){if(t.has("mode")&&this.mode==="editable"&&(this.focusInput(),this.updateHeight(),this.sendBtn.disabled=!1,this.btnActive=!0),t.has("text")&&this.text.length>0){let e=this.commentInput;e.value=this.text,this.updateHeight()}t.has("btnActive")&&(this.sendBtn.disabled=!this.btnActive)}updateHeight(){let t=this.commentInput;t.style.height="40px";let e=t.scrollHeight+14;e===47&&(e=40),t.style.height=`${e}px`,this.sendBtn.disabled=!(t.value.length>0)}send(t){var n;if(t.preventDefault(),((n=this.mentionList)==null?void 0:n.length)>0)return;let e=this.commentInput,i=e.value,s=this.autoCompleteHandler.getMentions(i);this.emitEvent(this.eventType,{text:i,mentions:s,position:this.pinCoordinates},{composed:!1,bubbles:!1}),e.value="",this.sendBtn.disabled=!0,this.updateHeight()}render(){var i;let t={comments__input__textarea:!0,"fixed-width":this.eventType==="create-annotation"},e={comments__input:!0,"comments__input--editable":this.editable,"hide-input":this.hideInput};return Pi`
      <div class="${fo(e)}">
        <textarea
          id="comments__input__textarea"
          class=${fo(t)}
          placeholder=${(i=this.placeholder)!=null?i:"Add comment..."}
          @input=${this.updateHeight}
          @focus=${this.onTextareaFocus}
          @blur=${this.onTextareaLoseFocus}
          spellcheck="false"
        ></textarea>
        <superviz-comments-mention-list
          .participants=${this.mentionList}
          @participant-selected=${this.insertMention}
        ></superviz-comments-mention-list>
        <div class="sv-hr"></div>
        <div class="comments__input__options">
          <button class="icon-button icon-button--medium icon-button--clickable">
            <superviz-icon
              name="mention"
              @click=${this.addAtSymbolInCaretPosition}
              size="sm"
            ></superviz-icon>
          </button>
          <div class="comment-input-options">
            ${this.commentInputOptions()} ${this.commentInputEditableOptions()}
          </div>
        </div>
      </div>
    `}};st.styles=Hn,st.properties={eventType:{type:String},text:{type:String},btnActive:{type:Boolean},editable:{type:Boolean},placeholder:{type:String},mentions:{type:Array},mentionList:{type:Object},participantsList:{type:Object},hideInput:{type:Boolean},mode:{type:String}},st=P([zn("superviz-comments-comment-input")],st);l();import{LitElement as Wn,html as Ot}from"lit";import{customElement as Un}from"lit/decorators.js";import{classMap as Ti}from"lit/directives/class-map.js";var Eo=T(Wn),Vn=[Eo.styles,mi],nt=class extends Eo{constructor(){super();this.focusInput=()=>{var t,e;this.inputElement||(this.inputElement=(e=(t=this.shadowRoot)==null?void 0:t.querySelector("superviz-comments-comment-input"))==null?void 0:e.shadowRoot.querySelector("textarea")),this.inputElement.focus()};this.setInputSide=()=>{let s=this.commentsSide==="right"?320:0,n=this.annotationSides.right+293,r=this.containerSides.right-s;if(n<r){this.horizontalSide="right";return}s=this.commentsSide==="left"?320:0;let a=this.annotationSides.left-293,c=this.containerSides.left+s;if(a>c){this.horizontalSide="left";return}this.horizontalSide=c-a>n-r?"right":"left"};this.createComment=({detail:t})=>{this.annotationSent=!0,document.body.dispatchEvent(new CustomEvent("create-annotation",{detail:C(f({},t),{position:C(f({},this.originalPosition),{type:"canvas"})})})),this.annotation=null};this.cancelTemporaryAnnotation=()=>{this.annotation=null};this.cancelTemporaryAnnotationEsc=t=>{this.annotation=null};this.avatar=()=>{if(this.type==="add"&&!this.showInput)return Ot`<div
        class="comments__annotation-pin__avatar comments__annotation-pin__avatar--add"
      >
        <superviz-icon name="add"></superviz-icon>
      </div>`;let t=this.userAvatar;return t?Ot`<div class="comments__annotation-pin__avatar">
        <img src=${t} />
      </div>`:Ot`<div class="comments__annotation-pin__avatar">
      <p class="text text-bold text-big">${this.userInitial}</p>
    </div>`};this.input=()=>{if(!(!this.showInput||this.annotationSent))return Ot`<div class="floating-input">
      <superviz-comments-comment-input
        @create-annotation=${this.createComment}
        eventType="create-annotation"
        @comment-input-ready=${this.focusInput}
        participantsList=${JSON.stringify(this.participantsList)}
      >
      </superviz-comments-comment-input>
    </div>`};this.position={x:0,y:0},setTimeout(()=>{this.firstLoad=!1},800)}updated(t){super.updated(t),!(!t.has("movedPosition")||!this.annotationSides)&&(this.annotationSides=this.pinAnnotation.getBoundingClientRect(),this.setInputSide(),this.inputElement&&this.focusInput())}firstUpdated(t){var e;super.firstUpdated(t),x.call(this,["comments"]),this.showInput&&(this.originalPosition=f({},this.position),this.pinAnnotation=(e=this.shadowRoot)==null?void 0:e.querySelector(".comments__annotation-pin"),this.annotationSides=this.pinAnnotation.getBoundingClientRect(),this.setInputSide())}connectedCallback(){if(super.connectedCallback(),this.type!=="add")return;let{localParticipant:t}=this.useStore("global-store");t.subscribe(e=>{var i;this.localAvatar=(i=e==null?void 0:e.avatar)==null?void 0:i.imageUrl,this.localName=e==null?void 0:e.name}),window.document.body.addEventListener("close-temporary-annotation",this.cancelTemporaryAnnotation),window.document.body.addEventListener("keyup",e=>{e.key==="Escape"&&this.cancelTemporaryAnnotationEsc(e)})}disconnectedCallback(){super.disconnectedCallback(),this.type==="add"&&(window.document.body.removeEventListener("close-temporary-annotation",this.cancelTemporaryAnnotation),window.document.body.removeEventListener("keyup",t=>{t.key==="Escape"&&this.cancelTemporaryAnnotationEsc(t)}))}get userAvatar(){var t,e,i,s;return((s=(i=(e=(t=this.annotation)==null?void 0:t.comments)==null?void 0:e.at(0))==null?void 0:i.participant)==null?void 0:s.avatar)||this.localAvatar}get userInitial(){var e,i,s,n,r;return(((r=(n=(s=(i=(e=this.annotation)==null?void 0:e.comments)==null?void 0:i.at(0))==null?void 0:s.participant)==null?void 0:n.name)!=null?r:this.localName)||"Anonymous")[0].toUpperCase()}emitClick(){var t;document.body.dispatchEvent(new CustomEvent("select-annotation",{detail:{uuid:(t=this.annotation)==null?void 0:t.uuid}}))}render(){let t={"comments__annotation-pin":!0,preload:this.firstLoad===void 0,"comments__annotation-pin--active":this.active,"comments__cursor-pointer":this.type==="add"&&!this.showInput,"comments__annotation-pin--add":this.type==="add"&&this.showInput,[this.horizontalSide]:!0},e={"comments__annotation-pin-wrapper":!0,"comments__annotation-pin-wrapper--new":this.newPin},i=this.keepPositionRatio?"%":"px",s=`top: ${this.position.y}${i}; left: ${this.position.x}${i};`;return this.type==="add"?Ot`
        <div class=${Ti(t)} style=${s}>${this.avatar()} ${this.input()}</div>
      `:Ot`<div class=${Ti(e)} style=${s}>
      <div @click=${this.emitClick} class=${Ti(t)}>${this.avatar()}</div>
    </div> `}};nt.styles=Vn,nt.properties={type:{type:String},annotation:{type:Object},position:{type:Object},active:{type:Boolean},showInput:{type:Boolean},containerSides:{type:Object},horizontalSide:{type:String},commentsSide:{type:String},movedPosition:{type:String},pinAnnotation:{type:Object},localAvatar:{type:String},annotationSent:{type:Boolean},localName:{type:String},keepPositionRatio:{type:Boolean},participantsList:{type:Object},firstLoad:{type:Boolean},newPin:{type:Boolean}},nt=P([Un("superviz-comments-annotation-pin")],nt);l();import{LitElement as jn,html as H}from"lit";import{customElement as Jn}from"lit/decorators.js";import{classMap as B}from"lit/directives/class-map.js";var wo=T(jn),Kn=[wo.styles,di],rt=class extends wo{constructor(){super(...arguments);this.selectAnnotation=t=>{let{uuid:e}=this.annotation;document.body.dispatchEvent(new CustomEvent("select-annotation",{detail:{uuid:e}}))};this.resolveAnnotation=({detail:t})=>{let{uuid:e}=this.annotation,{resolved:i,type:s}=t,n=s==="resolve-annotation"&&this.annotationFilter==="All comments";this.resolved=i,this.emitEvent("resolve-annotation",{uuid:e,resolved:i}),n&&(this.shouldShowUndoResolved=!0)};this.hideUndoResolved=()=>{this.shouldShowUndoResolved=!1};this.generateExpandedCommentsTemplate=(t,e)=>{var i,s,n,r;return e===0?H``:H`
      <superviz-comments-comment-item
        uuid=${t.uuid}
        avatar=${(r=(n=(s=(i=this.annotation)==null?void 0:i.comments)==null?void 0:s.at(e))==null?void 0:n.participant)==null?void 0:r.avatar}
        username=${t.participant.name||"Anonymous"}
        text=${t.text}
        createdAt=${t.createdAt}
        annotationId=${this.annotation.uuid}
        participantsList=${JSON.stringify(this.participantsList)}
        mentions=${JSON.stringify(t.mentions)}
        class="comments__replies"
      ></superviz-comments-comment-item>
    `};this.updateEditMode=({detail:{editing:t}})=>{this.hideInput=t}}firstUpdated(t){super.firstUpdated(t),this.updateComplete.then(()=>{this.resolved=this.annotation.resolved,x.call(this,["comments"])})}get filterIsAll(){return this.annotationFilter==="All comments"}get filterIsResolved(){return this.annotationFilter==="Resolved comments"}get shouldHideAnnotation(){return{hidden:this.resolved&&this.filterIsAll||!this.resolved&&this.filterIsResolved}}get replies(){return[...this.annotation.comments].splice(1).length}get repliesSize(){return this.replies>=5?5:this.replies}get replyText(){return this.replies!==1?"replies":"reply"}get isSelected(){return this.selected===this.annotation.uuid}get annotationClasses(){return{comments__thread:!0,"comments__thread--selected":this.isSelected,"extra-space-bottom":this.replies}}get mainAnnotationClasses(){return{"comments__main-annotation":!0,"comments__main-annotation--selected":this.isSelected}}get hrClasses(){return{"sv-hr":!0,hidden:this.isLastAnnotation}}get avatarCommentsClasses(){return{"avatars-comments":!0,"comment-avatar--expand":!this.expandComments&&this.replies>1,invisible:!(!this.expandComments&&this.replies>=1)}}get containerWrapperClasses(){return{"comments-container-wrapper":!0,show:this.isSelected&&this.expandComments}}get commentsClasses(){return{"comments-container":!0,"comment-item--expand":this.isSelected&&this.expandComments,show:this.isSelected&&this.expandComments}}updated(t){if(t.has("selected")){let e=this.selected===this.annotation.uuid;this.expandComments=e}}createComment({detail:t}){let{text:e,mentions:i}=t;this.emitEvent("create-comment",{uuid:this.annotation.uuid,mentions:i,text:e})}generateAvatarCommentsTemplate(){var e,i,s,n,r,a;let t=[];for(let c=1;c<=this.repliesSize;c++)(i=(e=this.annotation.comments[c])==null?void 0:e.participant)!=null&&i.avatar?t.push(H`
          <div class="avatar">
            <img src=${(n=(s=this.annotation.comments[c])==null?void 0:s.participant)==null?void 0:n.avatar} />
          </div>
        `):t.push(H`
          <div class="avatar">
            <p class="text text-bold">
              ${((a=(r=this.annotation.comments[c])==null?void 0:r.participant.name[0])==null?void 0:a.toUpperCase())||"A"}
            </p>
          </div>
        `);return H`
      ${t}
      <div class="text text-big sv-gray-500">${this.replies} ${this.replyText}</div>
    `}annotationResolvedTemplate(){return this.shouldShowUndoResolved?H`
      <superviz-comments-annotation-resolved
        @undo-resolve=${this.resolveAnnotation}
        @hide=${this.hideUndoResolved}
        class=${B({hidden:this.filterIsResolved,"comments__resolved-annotation-message":!0})}
      >
      </superviz-comments-annotation-resolved>
    `:H``}get inputClasses(){return{"hide-input":this.hideInput}}get wrapperClasses(){return{wrapper:!0,"show-wrapper":!this.resolved&&this.filterIsAll||this.resolved&&this.filterIsResolved}}render(){var e,i,s,n,r,a,c,d,u,g,v;let t={"comments__complete-annotation":!0,"comments__hide-complete-annotation":this.shouldShowUndoResolved};return H`
      <div class="${B(t)}">
        ${this.annotationResolvedTemplate()}

        <div class=${B(this.wrapperClasses)}>
          <div class=${B(this.shouldHideAnnotation)}>
            <div class=${B(this.annotationClasses)} @click=${this.selectAnnotation}>
              <div class=${B(this.mainAnnotationClasses)}>
                <superviz-comments-comment-item
                  uuid=${(e=this.annotation.comments)==null?void 0:e[0].uuid}
                  annotationId=${this.annotation.uuid}
                  username=${((s=(i=this.annotation.comments)==null?void 0:i[0].participant)==null?void 0:s.name)||"Anonymous"}
                  text=${(n=this.annotation.comments)==null?void 0:n[0].text}
                  createdAt=${(r=this.annotation.comments)==null?void 0:r[0].createdAt}
                  participantsList=${JSON.stringify(this.participantsList)}
                  primaryComment
                  avatar=${(u=(d=(c=(a=this.annotation)==null?void 0:a.comments)==null?void 0:c.at(0))==null?void 0:d.participant)==null?void 0:u.avatar}
                  resolvable
                  ?resolved=${this.resolved}
                  annotationFilter=${this.annotationFilter}
                  @resolve-annotation=${this.resolveAnnotation}
                  mentions=${JSON.stringify((g=this.annotation.comments)==null?void 0:g[0].mentions)}
                  class="comments__annotation"
                  @edit-comment=${this.updateEditMode}
                ></superviz-comments-comment-item>
              </div>

              <div class=${B(this.containerWrapperClasses)}>
                <div class=${B(this.commentsClasses)}>
                  ${(v=this.annotation.comments)==null?void 0:v.map(this.generateExpandedCommentsTemplate)}
                  <span class=${B(this.inputClasses)}>
                    <superviz-comments-comment-input
                      @create-comment=${this.createComment}
                      eventType="create-comment"
                      @click=${b=>b.stopPropagation()}
                      placeholder="Reply"
                      participantsList=${JSON.stringify(this.participantsList)}
                    ></superviz-comments-comment-input>
                  </span>
                </div>
              </div>
              <div class=${B(this.avatarCommentsClasses)}>
                <div class="avatar-container">${this.generateAvatarCommentsTemplate()}</div>
              </div>
            </div>
            <div class=${B(this.hrClasses)}></div>
          </div>
        </div>
      </div>
    `}};rt.styles=Kn,rt.properties={annotation:{type:Object},expandComments:{type:Boolean},selected:{type:String,reflect:!0},resolved:{type:Boolean},shouldShowUndoResolved:{type:Boolean},isLastAnnotation:{type:Boolean},annotationFilter:{type:String},participantsList:{type:Object},hideInput:{type:Boolean}},rt=P([Jn("superviz-comments-annotation-item")],rt);l();import{LitElement as qn,html as Ne}from"lit";import{customElement as Yn}from"lit/decorators.js";var Po=T(qn),Zn=[Po.styles],at=class extends Po{constructor(){super(...arguments);this.emitEventOpenModal=()=>{window.document.body.dispatchEvent(new CustomEvent("superviz-modal--open",{detail:{title:"DELETE COMMENT",body:Ne`<span class="text text-big sv-gray-600"
            >Are you sure you want to delete this comment? <br />
            This action cannot be undone</span
          >`,confirmLabel:"DELETE",confirm:!0,cancel:!0},bubbles:!0,composed:!0}))};this.toggle=()=>{this.open=!this.open}}firstUpdated(){window.document.body.addEventListener("superviz-modal--close",()=>{!this.open||this.emitEvent("close",{},{bubbles:!1,composed:!1})}),window.document.body.addEventListener("superviz-modal--confirm",()=>{!this.open||(this.emitEvent("confirm",{},{bubbles:!1,composed:!1}),this.emitEventCloseModal())})}updated(t){t.has("open")&&(this.open&&setTimeout(()=>this.emitEventOpenModal()),this.open||setTimeout(()=>this.emitEventCloseModal()))}emitEventCloseModal(){!this.open||(window.document.body.dispatchEvent(new CustomEvent("superviz-modal--close",{detail:{open:!0},bubbles:!0,composed:!0})),this.emitEvent("close",{},{bubbles:!1,composed:!1}))}render(){let t=()=>{if(!!this.useSlot)return Ne`<slot name="modal-handler" @click=${this.toggle}></slot>`},e=()=>{if(!!this.open)return Ne` <superviz-modal></superviz-modal> `};return Ne` ${t()} ${e()} `}};at.styles=Zn,at.properties={open:{type:Boolean},useSlot:{type:Boolean}},at=P([Yn("superviz-comments-delete-comments-modal")],at);l();import{LitElement as Xn,html as Ai}from"lit";import{customElement as Qn}from"lit/decorators.js";var To=T(Xn),tr=[To.styles,hi],er=10*1e3,lt=class extends To{constructor(){super();this.setTimer=()=>{clearTimeout(this.timeout),this.isCanceled=!1,this.timeout=setTimeout(()=>{this.isCanceled||(this.timeToHide=0,this.isCanceled=!1,this.hide())},this.timeToHide)};this.timeToHide=er,this.isCanceled=!1}firstUpdated(t){super.firstUpdated(t),this.updateComplete.then(()=>{x.call(this,["comments"]),this.setTimer()})}hide(){this.emitEvent("hide",{},{bubbles:!1,composed:!1})}undone(){this.isCanceled=!0,this.hide(),this.emitEvent("undo-resolve",{type:"undo-resolve",resolved:!1},{bubbles:!1,composed:!1}),clearTimeout(this.timeout)}render(){return this.timeToHide===0?Ai``:this.isCanceled?Ai``:Ai`
      <div class="comments__annotation-resolved">
        <span class="text text-big sv-gray-700 comments__annotation-resolved__text"
          >You resolved this comment</span
        >
        <button
          id="undone"
          @click=${this.undone}
          class="icon-button icon-button--clickable icon-button--medium comments__annotation-resolved__unresolve_button"
        >
          <superviz-icon name="undo" size="md"></superviz-icon>
        </button>
      </div>
    `}};lt.styles=tr,lt.properties={timeToHide:{type:Number},isCanceled:{type:Boolean}},lt=P([Qn("superviz-comments-annotation-resolved")],lt);l();import{LitElement as ir,html as or}from"lit";import{customElement as sr}from"lit/decorators.js";import{classMap as nr}from"lit/directives/class-map.js";var Ao=T(ir),rr=[Ao.styles,ui],se=[{label:"All comments"},{label:"Resolved comments"}],pt=class extends Ao{constructor(){super();this.selectClick=()=>{this.caret=this.caret==="down"?"up":"down"};this.dropdownOptionsHandler=({detail:t})=>{this.emitEvent("select",{filter:t}),this.selectClick()};this.caret="down"}firstUpdated(t){super.firstUpdated(t),this.updateComplete.then(()=>{x.call(this,["comments"])})}render(){let t=this.filter==="All comments"?se[0].label:se[1].label;se[0].active=this.filter==="All comments",se[1].active=this.filter==="Resolved comments";let e={text:!0,"text-bold":!0,"select-content":!0,"comments__filter__selected-label":!0,"sv-gray-500":this.caret==="down","sv-gray-700":this.caret==="up"};return or`
      <div class="comments__filter-container">
        <div class="comments__filter">
          <superviz-dropdown
            options=${JSON.stringify(se)}
            position="bottom-left"
            right-offset="100px"
            @click=${this.selectClick}
            @selected=${this.dropdownOptionsHandler}
            @close=${this.selectClick}
            classesPrefix="comments__dropdown"
            parentComponent="comments"
          >
            <div class="comments__filter__toggle-button" slot="dropdown">
              <span class=${nr(e)}>${t}</span>
              <div class="comments__filter__icon">
                <superviz-icon name=${this.caret} size="xs"></superviz-icon>
              </div>
            </div>
          </superviz-dropdown>
        </div>
      </div>
    `}};pt.styles=rr,pt.properties={filter:{type:String},caret:{type:String}},pt=P([sr("superviz-comments-annotation-filter")],pt);l();import{LitElement as ar,html as lr}from"lit";import{customElement as pr}from"lit/decorators.js";import{classMap as Fe}from"lit/directives/class-map.js";var Co=T(ar),cr=[Co.styles,vi],ct=class extends Co{constructor(){super();this.onTogglePinActive=({detail:{isActive:t}})=>{this.isActive=t};this.isHidden=!0,this.positionStyles="top: 20px; left: 20px;",this.shouldHide=!1,this.commentsPosition="left"}firstUpdated(t){super.firstUpdated(t),this.updateComplete.then(()=>{x.call(this,["comments"])}),this.mouseHovering=!1;let e=this.shadowRoot.querySelector(".comments__floating-button");e.addEventListener("mouseenter",()=>{setTimeout(()=>e.classList.add("comments-floating-button-hovered"),300),this.mouseHovering=!0}),e.addEventListener("mouseleave",()=>{e.classList.remove("comments-floating-button-hovered"),this.mouseHovering=!1})}toggle(){this.emitEvent("toggle",{})}connectedCallback(){super.connectedCallback(),window.document.body.addEventListener("toggle-annotation-sidebar",()=>{this.isHidden=!this.isHidden}),window.document.body.addEventListener("toggle-pin-active",this.onTogglePinActive)}disconnectedCallback(){super.disconnectedCallback(),window.document.body.removeEventListener("toggle-annotation-sidebar",()=>{this.isHidden=!this.isHidden}),window.document.body.removeEventListener("toggle-pin-active",this.onTogglePinActive)}updated(t){super.updated(t),this.updateComplete.then(()=>{let e=this.shadowRoot.querySelector(".comments__floating-button");!e||e.setAttribute("style",this.positionStyles)})}calculateIfShouldHide(){var L;let t=(L=document.getElementsByTagName("superviz-comments")[0])==null?void 0:L.shadowRoot.querySelector(".superviz-comments"),e=this.shadowRoot.querySelector(".comments__floating-button");if(!t||!e)return;let{left:i,right:s,top:n,bottom:r}=t.getBoundingClientRect(),{left:a,right:c,top:d,bottom:u}=e.getBoundingClientRect(),g=r>d&&u>n,v=n<u&&d<r,b=s>a&&c>i,_=i<c&&a<s;this.shouldHide=(v||g)&&(b||_)}render(){this.calculateIfShouldHide();let t={"comments__floating-button":!0,"hide-button":!this.isHidden&&this.shouldHide,"is-active":this.isActive,"is-inactive":!this.isActive},e={"comments__floating-button-text-box":!0,"comments__floating-button-text-box--hovered":this.mouseHovering},i={text:!0,"text-big":!0,"text-bold":!0,"not-hovered":!this.mouseHovering,"comments__floating-button__text":!0,textActive:this.isActive,textInactive:!this.isActive};return lr` <button @click=${this.toggle} class="${Fe(t)}">
      <div class="comments__floating-button__icon">
        <superviz-icon
          size="sm"
          name="comment"
          color=${this.mouseHovering||this.isActive?"white":"black"}
        ></superviz-icon>
        <svg class="cross" width="8px" height="8px" viewBox="0 0 8 8">
          <rect class="cross-bar-1" x="0" y="3" width="8px" height="2px" />
          <rect class="cross-bar-2" x="0" y="3" width="8px" height="2px" />
        </svg>
      </div>
      <div class=${Fe(e)}>
        <p class="${Fe(i)} comment">Comment</p>
        <p class="${Fe(i)} cancel">Cancel</p>
      </div>
    </button>`}};ct.styles=cr,ct.properties={positionStyles:{type:String},isHidden:{type:Boolean},commentsPosition:{type:String},isActive:{type:Boolean},mouseHovering:{type:Boolean}},ct=P([pr("superviz-comments-button")],ct);l();import{LitElement as dr,html as ne}from"lit";import{customElement as hr}from"lit/decorators.js";import{repeat as mr}from"lit/directives/repeat.js";var xo=T(dr),ur=[xo.styles,bi],dt=class extends xo{constructor(){super();this.showMentionList=()=>{var e;let t=(e=this.shadowRoot)==null?void 0:e.getElementById("mention-list");t==null||t.style.setProperty("display","block"),t==null||t.style.setProperty("margin-top","1px"),t.addEventListener("wheel",this.stopHandleZoom)};this.hideMentionList=()=>{var e;let t=(e=this.shadowRoot)==null?void 0:e.getElementById("mention-list");t.removeEventListener("wheel",this.stopHandleZoom),t==null||t.style.setProperty("display","none")};this.selectParticipant=t=>{this.emitEvent("participant-selected",t,{bubbles:!1,composed:!1}),this.hideMentionList()};this.stopHandleZoom=t=>{var i;let e=(i=this.shadowRoot)==null?void 0:i.getElementById("mention-list");e.scrollTop+=t.deltaY,t.preventDefault()};this.participants=[]}updated(t){if(t.has("participants")&&this.participants.length>0){this.showMentionList();return}this.hideMentionList()}getAvatar(t){var e;return t.avatar?ne`<img class="avatar" src=${t.avatar} />`:ne`<div class="default-avatar">
      <p class="text text-bold">${((e=t.name[0])==null?void 0:e.toUpperCase())||"A"}</p>
    </div>`}render(){let t=e=>ne`
      <div class="mention-item" @click=${()=>this.selectParticipant(e)}>
          ${this.getAvatar(e)}
        <div class="avatar-type">${e.name}</div>
      </div>
    `;return ne`
      <div id="mention-list">
        ${mr(this.participants,e=>e.id,e=>ne`
          ${t(e)}
        `)}
      </div>
    `}};dt.styles=ur,dt.properties={participants:{type:Object}},dt=P([hr("superviz-comments-mention-list")],dt);l();l();import{LitElement as fr,html as ht}from"lit";import{customElement as yr}from"lit/decorators.js";import{classMap as _o}from"lit/directives/class-map.js";import{repeat as Er}from"lit/directives/repeat.js";l();l();import{css as vr}from"lit";var Ci=vr`
  .who-is-online__participant-list {
    display: flex;
    align-items: center;
    gap: 4px;
    position: relative;
  }

  .who-is-online {
    display: flex;
    flex-direction: column;
    position: fixed;
    z-index: 99;
  }

  .who-is-online__presence-control-message__text {
    margin: 0;
  }

  .who-is-online__participant {
    border-radius: 50%;
    box-sizing: border-box;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    user-select: none;
    cursor: pointer;
    transition: opacity 0.3s ease-in-out;
    border: 2px solid #878291;
    border-radius: 50%;
    max-width: 40px;
    flex: 1 0 40px;
  }

  .followed {
    border-style: dashed !important;
    animation: rotate 15s linear infinite;
  }

  .followed .who-is-online__participant__avatar {
    animation: nullifyRotate 15s linear infinite;
  }

  .private {
    opacity: 0.3;
  }

  @keyframes rotate {
    100% {
      transform: rotate(1turn);
    }
  }

  @keyframes nullifyRotate {
    100% {
      transform: rotate(-1turn);
    }
  }

  .who-is-online__participant.disable-dropdown {
    cursor: default;
  }

  .who-is-online__participant__avatar {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Open Sans';
    font-size: 14px;
    line-height: 14px;
    line-height: 14px;
    font-weight: bold;
    color: #26242a;
    object-fit: contain;
  }

  .superviz-who-is-online__excess {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: Roboto;
    font-size: 14px;
    line-height: 16px;
    text-align: center;
    font-weight: bold;
    cursor: pointer;
    color: #aea9b8;
  }

  .excess_participants:hover,
  .excess_participants--open {
    background-color: #aea9b8 !important;
  }

  .excess_participants:hover > div,
  .excess_participants--open > div {
    color: #fff !important;
  }

  @media (max-width: 780px) {
    .who-is-online__participant {
      width: 32px;
      height: 32px;
    }

    .who-is-online__participant {
      flex: 1 0 32px;
      max-width: 32px;
    }

    .who-is-online__participant__avatar {
      width: 24px;
      height: 24px;
    }

    .who-is-online__participant-list {
      gap: 8px;
    }

    .superviz-who-is-online__excess {
      width: 24px;
      height: 24px;
      font-size: 12px;
      line-height: 12px;
    }
  }
`;l();import{css as gr}from"lit";var xi=gr`
  .dropdown {
    position: relative;
  }

  .who-is-online__extra-participant {
    display: flex;
    user-select: none;
    align-items: center;
    justify-items: start;
    gap: 4px;
    width: 100%;
    padding: 10px;
    border-radius: 2px;
    position: relative;
    cursor: pointer;
  }

  .who-is-online__extra-participant.disable-dropdown {
    cursor: default;
  }

  .who-is-online__extra-participant:hover,
  .who-is-online__extra-participant--selected {
    background-color: rgb(var(--sv-gray-200));
  }

  .who-is-online__participant {
    border-radius: 50%;
    box-sizing: border-box;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    border: 2px solid #878291;
    border-radius: 50%;
    max-width: 40px;
    flex: 1 0 40px;
  }

  .who-is-online__participant__avatar {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Open Sans';
    font-size: 14px;
    line-height: 14px;
    font-weight: bold;
    color: #26242a;
    object-fit: contain;
  }

  .dropdown-list {
    position: relative;
    display: flex;
    flex-direction: column;
    z-index: 100;
  }

  .dropdown-list > div {
    padding: 4px;
    width: 216px;
    box-sizing: border-box;
  }

  .who-is-online__extras-dropdown {
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
    opacity: 0;
    display: none;
    background: #fff;
    padding: 0;
    z-index: 1;
    transition: 0.2s;
    border-radius: 3px;
    max-height: 240px;
    overflow: auto;
  }

  .who-is-online__extras-dropdown superviz-dropdown:hover {
    z-index: 999;
    position: relative;
  }

  .who-is-online__extras__arrow-icon {
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .menu--bottom {
    top: 4px;
    min-width: 103px;
    position: absolute;
    right: 0;
  }

  .menu--top {
    bottom: 44px;
    min-width: 103px;
    position: absolute;
    right: 0px;
  }

  .menu-open {
    display: block;
    opacity: 1;
  }

  .superviz-who-is-online-dropdown__tooltip {
    background-color: rgb(var(--sv-gray-600));
    padding: 8px;
    display: flex;
    flex-direction: column;
    gap: 8px;
    align-items: center;
    position: absolute;
    top: 52px;
    left: 50%;
    transform: translateX(-50%);
    border-radius: 2px;
    opacity: 0;
    cursor: default;
    display: none;
    transition: opacity 0.2s ease-in-out display 0s;
  }

  .superviz-who-is-online-dropdown__tooltip-arrow {
    width: 13px;
    height: 13px;
    position: absolute;
    top: 0px;
    left: 50%;
    transform: rotate(45deg) translateX(-50%);
    background-color: rgb(var(--sv-gray-600));
    border-top-left-radius: 3px;
  }

  .dropdown-content:hover + .superviz-who-is-online-dropdown__tooltip {
    opacity: 1;
    display: block;
  }

  .tooltip-content {
    margin: 0;
    font-family: roboto;
    white-space: nowrap;
    text-align: center;
    color: white;
    font-size: 14px;
  }

  .who-is-online__extras__username {
    font-size: 14px;
    line-height: 20px;
    font-family: 'Open sans';
    color: rgb(var(--sv-gray-600));
  }

  .icon {
    flex: 1;
    justify-content: flex-end;
    display: flex;
  }

  .hide-icon {
    display: none;
  }

  @media (max-width: 780px) {
    .sv-icon,
    .who-is-online__participant {
      width: 32px;
      height: 32px;
    }

    .who-is-online__participant {
      flex: 1 0 32px;
      max-width: 32px;
    }

    .who-is-online__participant__avatar {
      width: 24px;
      height: 24px;
    }

    .dropdown-list > div {
      width: 192px;
    }

    .menu--top {
      bottom: 36px;
    }

    .superviz-who-is-online-dropdown__tooltip {
      top: 44px;
    }
  }
`;l();import{css as br}from"lit";var _i=br`
  .who-is-online__controls-messages {
    position: absolute;
    right: 0;
    display: flex;
    flex-direction: column;
    gap: 5px;
    margin-top: 4px;
  }

  .who-is-online__presence-control-message {
    box-sizing: border-box;
    font-size: 12px;
    padding: 8px 10px;
    font-family: 'Roboto';
    border-radius: 6px;
    background-color: #fff;
    color: rgb(var(--sv-gray-700));
    border: 2px solid #e0e0e0;
    white-space: nowrap;
  }

  .who-is-online__pcm__text {
    margin: 0;
  }

  .who-is-online__presence-control-message span {
    margin-left: 3px;
    text-decoration: underline;
    cursor: pointer;
  }

  .left-side {
    left: 0;
  }

  .right-side {
    right: 0;
  }

  .left-side .who-is-online__presence-control-message {
    align-self: flex-start;
  }

  .right-side .who-is-online__presence-control-message {
    align-self: flex-end;
  }

  .bottom-side {
    bottom: auto;
    top: calc(100% + 5px);
  }

  .top-side {
    top: auto;
    bottom: calc(100% + 5px);
  }
`;var So=T(fr),wr=[So.styles,Ci],mt=class extends So{constructor(){super();this.onClickOutDropdown=({detail:t})=>{this.open=t.open};this.toggleShowTooltip=()=>{this.showTooltip=!this.showTooltip};this.dropdownOptionsHandler=({detail:{label:t,participantId:e,source:i}})=>{switch(t){case"go to":this.handleGoTo(e);break;case"follow":this.handleLocalFollow(e,i);break;case"unfollow":this.handleLocalUnfollow();break;case"private mode":this.handlePrivate(e);break;case"leave private mode":this.handleCancelPrivate(e);break;case"everyone follows me":this.handleFollow(e,i);break;case"stop followers":this.handleStopFollow();break;case"gather all":this.handleGatherAll(e);break;default:break}};this.position="top: 20px; right: 40px;",this.showTooltip=!0,this.open=!1;let{localParticipant:t}=this.useStore("global-store"),{participants:e,following:i,extras:s}=this.useStore("who-is-online-store");e.subscribe(),i.subscribe(),s.subscribe(r=>{this.amountOfExtras=r.length}),t.subscribe(r=>{var c,d;let a=(c=r.activeComponents)==null?void 0:c.some(u=>u.toLowerCase().includes("presence"));this.localParticipantData={id:r.id,joinedPresence:(d=r.activeComponents)==null?void 0:d.some(u=>u.toLowerCase().includes("presence"))},this.disableDropdown=!a});let{disablePresenceControls:n}=this.useStore("who-is-online-store");n.subscribe()}firstUpdated(t){super.firstUpdated(t),x.call(this,"who-is-online")}toggleOpen(){this.open=!this.open}dropdownPosition(t){if(this.participants.length===1)return"bottom-center";if(t===0)return"bottom-right";let e=this.participants.length>4,i=t+1===this.participants.length;return e||!i?"bottom-center":"bottom-left"}renderExtras(){var e;if(!this.amountOfExtras)return;let t={"who-is-online__participant":!0,excess_participants:!0,"excess_participants--open":this.open};return ht`
      <superviz-who-is-online-dropdown
        @selected=${this.dropdownOptionsHandler}
        @clickout=${this.onClickOutDropdown}
        ?disableDropdown=${this.disableDropdown}
        ?showSeeMoreTooltip=${this.showTooltip}
        @toggle=${this.toggleOpen}
        @toggle-dropdown-state=${this.toggleShowTooltip}
        ?localParticipantJoinedPresence=${(e=this.localParticipantData)==null?void 0:e.joinedPresence}
        classesPrefix="who-is-online__controls"
        parentComponent="who-is-online"
        tooltipPrefix="who-is-online"
      >
        <div class=${_o(t)} slot="dropdown">
          <div class="superviz-who-is-online__excess who-is-online__extras">
            +${this.amountOfExtras}
          </div>
        </div>
      </superviz-who-is-online-dropdown>
    `}getAvatar({color:t,imageUrl:e,firstLetter:i,slotIndex:s}){if(e)return ht` <img
        class="who-is-online__participant__avatar"
        style="background-color: ${t}"
        src=${e}
      />`;let n=At.includes(s)?"#FFFFFF":"#26242A";return ht`<div
      class="who-is-online__participant__avatar"
      style="background-color: ${t}; color: ${n}"
    >
      ${i}
    </div>`}cancelPrivate(){this.isPrivate=void 0,this.emitEvent("realtime.private-mode",{id:this.localParticipantData.id})}renderParticipants(){return this.participants.length?ht`
      ${Er(this.participants,t=>t.id,(t,e)=>{var b;let{avatar:i,id:s,name:n,tooltip:r,controls:a,disableDropdown:c,isLocalParticipant:d}=t,u=this.dropdownPosition(e),g=((b=this.following)==null?void 0:b.id)===s,v={"who-is-online__participant":!0,"disable-dropdown":c,followed:g||this.everyoneFollowsMe&&d,private:d&&this.isPrivate};return ht`
            <superviz-dropdown
              options=${JSON.stringify(a)}
              returnData=${JSON.stringify({participantId:s,source:"participants"})}
              position=${u}
              name=${n}
              tooltipData=${JSON.stringify(r)}
              classesPrefix="who-is-online__controls"
              parentComponent="who-is-online"
              tooltipPrefix="who-is-online"
              ?disabled=${c}
              ?canShowTooltip=${this.showTooltip}
              @selected=${this.dropdownOptionsHandler}
              @toggle-dropdown-state=${this.toggleShowTooltip}
            >
              <div
                slot="dropdown"
                class=${_o(v)}
                style="border-color: ${i.color}"
              >
                ${this.getAvatar(i)}
              </div>
            </superviz-dropdown>
          `})}
    `:ht``}handleGoTo(t){this.emitEvent("realtime.go-to-participant",{id:t})}handleLocalFollow(t,e){let{following:i}=this.useStore("who-is-online-store"),s=this.useStore("who-is-online-store")[e].value,{id:n,name:r,avatar:{color:a}}=s.find(({id:c})=>c===t);this.everyoneFollowsMe&&this.handleStopFollow(),i.publish({name:r,id:n,color:a}),this.emitEvent("realtime.local-follow-participant",{id:n,source:e})}handleLocalUnfollow(){let{following:t}=this.useStore("who-is-online-store");t.publish(void 0),this.emitEvent("realtime.local-follow-participant",{id:void 0})}handlePrivate(t){this.everyoneFollowsMe&&this.handleStopFollow(),this.emitEvent("realtime.private-mode",{id:t,isPrivate:!0}),this.isPrivate=!0}handleCancelPrivate(t){this.emitEvent("realtime.private-mode",{id:t,isPrivate:!1}),this.isPrivate=!1}handleFollow(t,e){this.isPrivate&&this.cancelPrivate();let i=this.useStore("who-is-online-store")[e].value,{id:s,name:n,avatar:{color:r,slotIndex:a}}=i.find(({id:d})=>d===t);this.everyoneFollowsMe=!0;let{following:c}=this.useStore("who-is-online-store");c.publish(void 0),this.emitEvent("realtime.follow-participant",{id:s,name:n,color:r,slotIndex:a})}handleStopFollow(){this.everyoneFollowsMe=!1,this.emitEvent("realtime.follow-participant",void 0)}handleGatherAll(t){this.isPrivate&&this.cancelPrivate(),this.emitEvent("realtime.gather",{id:t})}updated(t){super.updated(t),this.updateComplete.then(()=>{let e=this.shadowRoot.querySelector(".who-is-online");if(!e)return;let i=this.position.includes("left")?"flex-start":"flex-end",s=`${this.position} align-items: ${i};`;e.setAttribute("style",s)})}render(){return ht`<div class="who-is-online who-is-online">
      <div class="who-is-online__participant-list">
        ${this.renderParticipants()} ${this.renderExtras()}
      </div>
      <superviz-who-is-online-messages
        ?everyoneFollowsMe=${this.everyoneFollowsMe}
        ?isPrivate=${this.isPrivate}
        @stop-following=${this.handleLocalUnfollow}
        @cancel-private=${this.cancelPrivate}
        @stop-everyone-follows-me=${this.handleStopFollow}
      ></superviz-who-is-online-messages>
    </div> `}};mt.styles=wr,mt.properties={position:{type:String},open:{type:Boolean},localParticipantColor:{type:String},isPrivate:{type:Boolean},everyoneFollowsMe:{type:Boolean},showTooltip:{type:Boolean}},mt=P([yr("superviz-who-is-online")],mt);l();l();import{LitElement as Tr,html as De}from"lit";import{customElement as Ar}from"lit/decorators.js";import{classMap as Cr}from"lit/directives/class-map.js";l();var Oo=T(Tr),xr=[Oo.styles,_i],ut=class extends Oo{constructor(){super();this.repositionMessages=()=>{let{following:t,everyoneFollowsMe:e,isPrivate:i}=this;if(t||e||i){this.repositionInVerticalDirection(),this.repositionInHorizontalDirection(),this.animationFrame=window.requestAnimationFrame(this.repositionMessages);return}window.cancelAnimationFrame(this.animationFrame)};let{localParticipant:t}=this.useStore("global-store");t.subscribe(i=>{this.participantColor=i.color});let{following:e}=this.useStore("who-is-online-store");e.subscribe()}firstUpdated(t){super.firstUpdated(t),x.call(this,"who-is-online")}updated(t){super.updated(t),["following","everyoneFollowsMe","isPrivate"].some(i=>t.has(i))&&this.repositionMessages()}repositionInVerticalDirection(){let t=window.innerHeight/2,{top:e}=this.parentElement.getBoundingClientRect();if(e<t){this.verticalSide="bottom-side";return}this.verticalSide="top-side"}repositionInHorizontalDirection(){let t=window.innerWidth/2,{left:e}=this.parentElement.getBoundingClientRect();if(e<t){this.horizontalSide="left-side";return}this.horizontalSide="right-side"}stopFollowing(){this.emitEvent("stop-following",{})}cancelPrivate(){this.emitEvent("cancel-private",{})}stopEveryoneFollowsMe(){this.emitEvent("stop-everyone-follows-me",{})}followingMessage(){if(!this.following)return"";let{name:t,color:e}=this.following;return De`<div
      class="who-is-online__following-message who-is-online__presence-control-message who-is-online__pcm"
      style="border-color: ${e}"
    >
      <p class="who-is-online__presence-control-message__text who-is-online__pcm__text">
        Following: ${t}
        <span
          class="who-is-online__presence-control-message__cancel-action-button who-is-online__pcm__cancel-action-button"
          @click=${this.stopFollowing}
          >Stop</span
        >
      </p>
    </div>`}everyoneFollowsMeMessage(){return this.everyoneFollowsMe?De`<div
      class="who-is-online__follow-me-message who-is-online__presence-control-message who-is-online__pcm"
      style="border-color: ${this.participantColor}"
    >
      <p class="who-is-online__presence-control-message__text who-is-online__pcm__text">
        Everyone is following you
        <span
          class="who-is-online__presence-control-message__cancel-action-button who-is-online__pcm__cancel-action-button"
          @click=${this.stopEveryoneFollowsMe}
          >Stop</span
        >
      </p>
    </div>`:""}privateMessage(){return this.isPrivate?De`<div
      class="who-is-online__private-mode-message who-is-online__presence-control-message who-is-online__pcm"
      style="border-color: ${this.participantColor}"
    >
      <p class="who-is-online__presence-control-message__text who-is-online__pcm__text">
        You are in Private Mode
        <span
          class="who-is-online__presence-control-message__cancel-action-button who-is-online__pcm__cancel-action-button"
          @click=${this.cancelPrivate}
          >Cancel</span
        >
      </p>
    </div>`:""}render(){let t={"who-is-online__controls-messages":!0,[this.verticalSide]:!0,[this.horizontalSide]:!0};return De` <div class=${Cr(t)}>
      ${this.followingMessage()} ${this.everyoneFollowsMeMessage()} ${this.privateMessage()}
    </div>`}};ut.styles=xr,ut.properties={everyoneFollowsMe:{type:Boolean},isPrivate:{type:Boolean},verticalSide:{type:String},horizontalSide:{type:String}},ut=P([Ar("superviz-who-is-online-messages")],ut);l();import{LitElement as _r,html as re}from"lit";import{customElement as Sr}from"lit/decorators.js";import{classMap as Si}from"lit/directives/class-map.js";import{repeat as Or}from"lit/directives/repeat.js";var Lo=T(_r),Lr=[Lo.styles,xi],vt=class extends Lo{constructor(){super();this.onClickOutDropdown=t=>{if(t.stopPropagation(),!this.open)return;let e=t.composedPath(),i=this.shadowRoot.querySelector(".dropdown-content"),s=this.shadowRoot.querySelector(".dropdown-list"),r=this.shadowRoot.querySelector('slot[name="dropdown"]').assignedElements()[0],a=e.includes(i),c=e.includes(s),d=e.includes(r);a||c||d||this.close()};this.close=()=>{this.open=!1,this.selected="",this.emitEvent("clickout",{bubbles:!1,composed:!1})};this.selectParticipant=(t,e)=>()=>{e||(this.selected=t)};this.toggleShowTooltip=({detail:{open:t}})=>{this.showParticipantTooltip=!this.showParticipantTooltip,t||(this.selected="")};this.tooltip=()=>this.showSeeMoreTooltip?re`<superviz-tooltip
      tooltipData=${JSON.stringify({name:"See more"})}
      classesPrefix="who-is-online__tooltip"
      parentComponent="who-is-online"
    ></superviz-tooltip>`:"";this.repositionDropdown=()=>{if(!this.open){window.cancelAnimationFrame(this.animationFrame);return}this.repositionInVerticalDirection(),this.repositionInHorizontalDirection(),this.animationFrame=window.requestAnimationFrame(this.repositionDropdown)};this.repositionInVerticalDirection=()=>{let{bottom:t,top:e,height:i}=this.parentElement.getBoundingClientRect(),s=window.innerHeight/2;if(e+i/2>s){this.dropdownList.style.setProperty("bottom",`${window.innerHeight-e+8}px`),this.dropdownList.style.setProperty("top","");return}this.dropdownList.style.setProperty("top",`${t+8}px`),this.dropdownList.style.setProperty("bottom","")};this.repositionInHorizontalDirection=()=>{let{right:t,left:e}=this.parentElement.getBoundingClientRect();this.dropdownList.style.setProperty("right",`${window.innerWidth-t}px`),this.dropdownList.style.setProperty("left",`${e}px`)};this.selected="",this.showParticipantTooltip=!0;let{extras:t}=this.useStore("who-is-online-store");t.subscribe(e=>{this.participants=e})}firstUpdated(t){this.shadowRoot.querySelector(".who-is-online__extras-dropdown").scrollTop=0,x.call(this,"who-is-online"),this.dropdownList=this.shadowRoot.querySelector(".dropdown-list"),this.dropdownList.style.position="fixed"}updated(t){if(!!t.has("open")){if(this.emitEvent("toggle-dropdown-state",{open:this.open,font:"toggle"}),this.open){document.addEventListener("click",this.onClickOutDropdown);return}document.removeEventListener("click",this.onClickOutDropdown)}}getAvatar({color:t,imageUrl:e,firstLetter:i,slotIndex:s}){if(e)return re` <img
        class="who-is-online__participant__avatar"
        style="background-color: ${t}"
        src=${e}
      />`;let n=At.includes(s)?"#FFFFFF":"#26242A";return re`<div
      class="who-is-online__participant__avatar"
      style="background-color: ${t}; color: ${n}"
    >
      ${i}
    </div>`}renderParticipants(){if(!this.participants)return;let t=this.participants.length-1;return Or(this.participants,e=>e.id,(e,i)=>{let{disableDropdown:s,id:n,avatar:r,controls:a,tooltip:c,name:d}=e,u={"who-is-online__extra-participant":!0,"who-is-online__extra-participant--selected":this.selected===n,"disable-dropdown":s},g={"who-is-online__extras__arrow-icon":!0,"hide-icon":s},v=i===t;return re`
        <superviz-dropdown
          options=${JSON.stringify(a)}
          returnData=${JSON.stringify({participantId:n,source:"extras"})}
          tooltipData=${JSON.stringify(c)}
          position="bottom-right"
          classesPrefix="who-is-online__controls"
          parentComponent="who-is-online"
          tooltipPrefix="who-is-online"
          ?disabled=${s}
          ?canShowTooltip=${this.showParticipantTooltip}
          ?shiftTooltipLeft=${!0}
          ?lastParticipant=${v}
          @toggle-dropdown-state=${this.toggleShowTooltip}
          @selected=${this.close}
        >
        <div 
          class=${Si(u)} 
          @click=${this.selectParticipant(n,s)} slot="dropdown">
            <div class="who-is-online__participant" style="border-color: 
            ${r.color}">
              ${this.getAvatar(r)}
            </div>
            <span class="who-is-online__extras__username">${d}</span>
            <superviz-icon 
              class=${Si(g)} 
              name="right" 
              color="var(--sv-gray-600)"
              size="sm"
            >
          </superviz-icon>
          </div>
        </div>
      </superviz-dropdown>
      `})}toggle(){this.open=!this.open,this.open&&(this.selected="",this.repositionDropdown())}get menuClasses(){return{"who-is-online__extras-dropdown":!0,"menu--bottom":this.position==="bottom-side","menu--top":this.position==="top-side","menu-open":this.open}}render(){return re`
      <div class="dropdown">
        <div class="dropdown-content" @click=${this.toggle}>
          <slot name="dropdown"></slot>
        </div>
        ${this.tooltip()}
      </div>
      <div class="dropdown-list">
        <div class=${Si(this.menuClasses)}>${this.renderParticipants()}</div>
      </div>
    `}};vt.styles=Lr,vt.properties={open:{type:Boolean},align:{type:String},position:{type:String},selected:{type:String},disableDropdown:{type:Boolean},showSeeMoreTooltip:{type:Boolean},showParticipantTooltip:{type:Boolean},localParticipantJoinedPresence:{type:Boolean},dropdownList:{type:Object}},vt=P([Sr("superviz-who-is-online-dropdown")],vt);l();l();function Io(p){if(typeof document!="undefined"){let o=document.createElement("style");o.id="superviz-style";let t=document.createTextNode(p);o.appendChild(t),document.head.appendChild(o)}}var Ro=`@import"https://unpkg.com/@superviz/sv-icons@0.8.13/css/style.css";@import"https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;500;700&family=Roboto:wght@400;500;700&display=swap";:root{--sv-primary: 98, 16, 204}html,body{width:100%;height:100%;overflow:hidden}#sv-video-wrapper iframe{position:fixed;border:none;margin:0;padding:0;overflow:hidden;z-index:1000}#sv-video-wrapper iframe.sv-video-frame--right{top:var(--superviz-offset-top);right:var(--superviz-offset-right)}#sv-video-wrapper iframe.sv-video-frame--left{top:var(--superviz-offset-top);left:var(--superviz-offset-left)}#sv-video-wrapper iframe.sv-video-frame--bottom{bottom:var(--superviz-offset-bottom);right:var(--superviz-offset-right);width:100%}#sv-video-wrapper iframe.sv-video-frame--top{top:var(--superviz-offset-top);right:var(--superviz-offset-right);width:100%}#sv-video-wrapper iframe.sv-video-frame--no-overlay{display:none}.pointer-mouse{display:flex;height:17px;width:17px;background-image:url(https://production.cdn.superviz.com/static/pointers/0.svg)}.mouse-user-name{display:block;position:absolute;border-radius:30px;padding:2px 8px;font-weight:700;font-size:14px;font-family:Roboto,sans-serif;line-height:22px;margin-left:10px;margin-top:-6px;background:yellow;white-space:nowrap}.mouse-follower{position:absolute;display:block;z-index:2;transition:all .15s linear,opacity 100s ease-in}
`;Io(Ro);l();l();window&&(window.SuperVizRoom={init:Qe,CommentEvent:ue,MeetingEvent:Nt,DeviceEvent:Ge,RealtimeEvent:F,MeetingState:he,MeetingConnectionStatus:Bt,MeetingControlsEvent:Dt,ParticipantEvent:me,FrameEvent:Ft,LayoutMode:Ee,VideoConference:qt,MousePointers:Yt,Realtime:Zt,Comments:zt,CanvasPin:Wt,HTMLPin:Ut,WhoIsOnline:Xt,FormElements:Qt,ParticipantType:ft,LayoutPosition:jt,CamerasPosition:we,RealtimeComponentState:xe,RealtimeComponentEvent:_e,ComponentLifeCycleEvent:bt,WhoIsOnlineEvent:ve});var Sb=Qe;export{Vt as BrowserService,we as CamerasPosition,Wt as CanvasPin,ue as CommentEvent,zt as Comments,bt as ComponentLifeCycleEvent,Ge as DeviceEvent,Qt as FormElements,Ft as FrameEvent,Ut as HTMLPin,Ee as LayoutMode,jt as LayoutPosition,Bt as MeetingConnectionStatus,Dt as MeetingControlsEvent,Nt as MeetingEvent,he as MeetingState,Yt as MousePointers,E as Observer,me as ParticipantEvent,ft as ParticipantType,Ht as PinMode,Zt as Realtime,_e as RealtimeComponentEvent,xe as RealtimeComponentState,F as RealtimeEvent,qt as VideoConference,Xt as WhoIsOnline,ve as WhoIsOnlineEvent,Sb as default};
