(function(g,r){typeof exports=="object"&&typeof module<"u"?r(exports,require("react"),require("@superviz/autodesk-viewer-plugin"),require("@superviz/sdk"),require("lodash"),require("@superviz/matterport-plugin"),require("@superviz/threejs-plugin")):typeof define=="function"&&define.amd?define(["exports","react","@superviz/autodesk-viewer-plugin","@superviz/sdk","lodash","@superviz/matterport-plugin","@superviz/threejs-plugin"],r):(g=typeof globalThis<"u"?globalThis:g||self,r(g["superviz-sdk-react"]={},g.require$$0,g.autodeskViewerPlugin,g.SupervizRoom,g.lodash,g.matterportPlugin,g.threejsPlugin))})(this,function(g,r,Ce,v,_e,Re,we){"use strict";var me={exports:{}},ae={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ae;function Ze(){return Ae||(Ae=1,process.env.NODE_ENV!=="production"&&function(){var t=r,a=Symbol.for("react.element"),o=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),u=Symbol.for("react.strict_mode"),p=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),d=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),h=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),w=Symbol.for("react.offscreen"),_=Symbol.iterator,I="@@iterator";function G(e){if(e===null||typeof e!="object")return null;var n=_&&e[_]||e[I];return typeof n=="function"?n:null}var b=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function S(e){{for(var n=arguments.length,s=new Array(n>1?n-1:0),m=1;m<n;m++)s[m-1]=arguments[m];Q("error",e,s)}}function Q(e,n,s){{var m=b.ReactDebugCurrentFrame,R=m.getStackAddendum();R!==""&&(n+="%s",s=s.concat([R]));var A=s.map(function(P){return String(P)});A.unshift("Warning: "+n),Function.prototype.apply.call(console[e],console,A)}}var q=!1,x=!1,k=!1,W=!1,Z=!1,L;L=Symbol.for("react.module.reference");function U(e){return!!(typeof e=="string"||typeof e=="function"||e===i||e===p||Z||e===u||e===f||e===E||W||e===w||q||x||k||typeof e=="object"&&e!==null&&(e.$$typeof===C||e.$$typeof===h||e.$$typeof===l||e.$$typeof===d||e.$$typeof===c||e.$$typeof===L||e.getModuleId!==void 0))}function Y(e,n,s){var m=e.displayName;if(m)return m;var R=n.displayName||n.name||"";return R!==""?s+"("+R+")":s}function B(e){return e.displayName||"Context"}function N(e){if(e==null)return null;if(typeof e.tag=="number"&&S("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case i:return"Fragment";case o:return"Portal";case p:return"Profiler";case u:return"StrictMode";case f:return"Suspense";case E:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case d:var n=e;return B(n)+".Consumer";case l:var s=e;return B(s._context)+".Provider";case c:return Y(e,e.render,"ForwardRef");case h:var m=e.displayName||null;return m!==null?m:N(e.type)||"Memo";case C:{var R=e,A=R._payload,P=R._init;try{return N(P(A))}catch{return null}}}return null}var F=Object.assign,z=0,y,J,K,$,ee,se,Le;function Ne(){}Ne.__reactDisabledLog=!0;function Pt(){{if(z===0){y=console.log,J=console.info,K=console.warn,$=console.error,ee=console.group,se=console.groupCollapsed,Le=console.groupEnd;var e={configurable:!0,enumerable:!0,value:Ne,writable:!0};Object.defineProperties(console,{info:e,log:e,warn:e,error:e,group:e,groupCollapsed:e,groupEnd:e})}z++}}function yt(){{if(z--,z===0){var e={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:F({},e,{value:y}),info:F({},e,{value:J}),warn:F({},e,{value:K}),error:F({},e,{value:$}),group:F({},e,{value:ee}),groupCollapsed:F({},e,{value:se}),groupEnd:F({},e,{value:Le})})}z<0&&S("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var Ee=b.ReactCurrentDispatcher,ve;function ce(e,n,s){{if(ve===void 0)try{throw Error()}catch(R){var m=R.stack.trim().match(/\n( *(at )?)/);ve=m&&m[1]||""}return`
`+ve+e}}var ge=!1,fe;{var Ct=typeof WeakMap=="function"?WeakMap:Map;fe=new Ct}function ke(e,n){if(!e||ge)return"";{var s=fe.get(e);if(s!==void 0)return s}var m;ge=!0;var R=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var A;A=Ee.current,Ee.current=null,Pt();try{if(n){var P=function(){throw Error()};if(Object.defineProperty(P.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(P,[])}catch(X){m=X}Reflect.construct(e,[],P)}else{try{P.call()}catch(X){m=X}e.call(P.prototype)}}else{try{throw Error()}catch(X){m=X}e()}}catch(X){if(X&&m&&typeof X.stack=="string"){for(var T=X.stack.split(`
`),V=m.stack.split(`
`),D=T.length-1,j=V.length-1;D>=1&&j>=0&&T[D]!==V[j];)j--;for(;D>=1&&j>=0;D--,j--)if(T[D]!==V[j]){if(D!==1||j!==1)do if(D--,j--,j<0||T[D]!==V[j]){var H=`
`+T[D].replace(" at new "," at ");return e.displayName&&H.includes("<anonymous>")&&(H=H.replace("<anonymous>",e.displayName)),typeof e=="function"&&fe.set(e,H),H}while(D>=1&&j>=0);break}}}finally{ge=!1,Ee.current=A,yt(),Error.prepareStackTrace=R}var oe=e?e.displayName||e.name:"",Xe=oe?ce(oe):"";return typeof e=="function"&&fe.set(e,Xe),Xe}function _t(e,n,s){return ke(e,!1)}function Rt(e){var n=e.prototype;return!!(n&&n.isReactComponent)}function le(e,n,s){if(e==null)return"";if(typeof e=="function")return ke(e,Rt(e));if(typeof e=="string")return ce(e);switch(e){case f:return ce("Suspense");case E:return ce("SuspenseList")}if(typeof e=="object")switch(e.$$typeof){case c:return _t(e.render);case h:return le(e.type,n,s);case C:{var m=e,R=m._payload,A=m._init;try{return le(A(R),n,s)}catch{}}}return""}var de=Object.prototype.hasOwnProperty,Fe={},xe=b.ReactDebugCurrentFrame;function pe(e){if(e){var n=e._owner,s=le(e.type,e._source,n?n.type:null);xe.setExtraStackFrame(s)}else xe.setExtraStackFrame(null)}function wt(e,n,s,m,R){{var A=Function.call.bind(de);for(var P in e)if(A(e,P)){var T=void 0;try{if(typeof e[P]!="function"){var V=Error((m||"React class")+": "+s+" type `"+P+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof e[P]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw V.name="Invariant Violation",V}T=e[P](n,P,m,s,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(D){T=D}T&&!(T instanceof Error)&&(pe(R),S("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",m||"React class",s,P,typeof T),pe(null)),T instanceof Error&&!(T.message in Fe)&&(Fe[T.message]=!0,pe(R),S("Failed %s type: %s",s,T.message),pe(null))}}}var At=Array.isArray;function he(e){return At(e)}function Ot(e){{var n=typeof Symbol=="function"&&Symbol.toStringTag,s=n&&e[Symbol.toStringTag]||e.constructor.name||"Object";return s}}function It(e){try{return Ve(e),!1}catch{return!0}}function Ve(e){return""+e}function Ue(e){if(It(e))return S("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",Ot(e)),Ve(e)}var ue=b.ReactCurrentOwner,St={key:!0,ref:!0,__self:!0,__source:!0},Ge,We,Te;Te={};function Mt(e){if(de.call(e,"ref")){var n=Object.getOwnPropertyDescriptor(e,"ref").get;if(n&&n.isReactWarning)return!1}return e.ref!==void 0}function Dt(e){if(de.call(e,"key")){var n=Object.getOwnPropertyDescriptor(e,"key").get;if(n&&n.isReactWarning)return!1}return e.key!==void 0}function jt(e,n){if(typeof e.ref=="string"&&ue.current&&n&&ue.current.stateNode!==n){var s=N(ue.current.type);Te[s]||(S('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',N(ue.current.type),e.ref),Te[s]=!0)}}function Lt(e,n){{var s=function(){Ge||(Ge=!0,S("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",n))};s.isReactWarning=!0,Object.defineProperty(e,"key",{get:s,configurable:!0})}}function Nt(e,n){{var s=function(){We||(We=!0,S("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",n))};s.isReactWarning=!0,Object.defineProperty(e,"ref",{get:s,configurable:!0})}}var kt=function(e,n,s,m,R,A,P){var T={$$typeof:a,type:e,key:n,ref:s,props:P,_owner:A};return T._store={},Object.defineProperty(T._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(T,"_self",{configurable:!1,enumerable:!1,writable:!1,value:m}),Object.defineProperty(T,"_source",{configurable:!1,enumerable:!1,writable:!1,value:R}),Object.freeze&&(Object.freeze(T.props),Object.freeze(T)),T};function Ft(e,n,s,m,R){{var A,P={},T=null,V=null;s!==void 0&&(Ue(s),T=""+s),Dt(n)&&(Ue(n.key),T=""+n.key),Mt(n)&&(V=n.ref,jt(n,R));for(A in n)de.call(n,A)&&!St.hasOwnProperty(A)&&(P[A]=n[A]);if(e&&e.defaultProps){var D=e.defaultProps;for(A in D)P[A]===void 0&&(P[A]=D[A])}if(T||V){var j=typeof e=="function"?e.displayName||e.name||"Unknown":e;T&&Lt(P,j),V&&Nt(P,j)}return kt(e,T,V,R,m,ue.current,P)}}var be=b.ReactCurrentOwner,Ye=b.ReactDebugCurrentFrame;function re(e){if(e){var n=e._owner,s=le(e.type,e._source,n?n.type:null);Ye.setExtraStackFrame(s)}else Ye.setExtraStackFrame(null)}var Pe;Pe=!1;function ye(e){return typeof e=="object"&&e!==null&&e.$$typeof===a}function Je(){{if(be.current){var e=N(be.current.type);if(e)return`

Check the render method of \``+e+"`."}return""}}function xt(e){{if(e!==void 0){var n=e.fileName.replace(/^.*[\\\/]/,""),s=e.lineNumber;return`

Check your code at `+n+":"+s+"."}return""}}var He={};function Vt(e){{var n=Je();if(!n){var s=typeof e=="string"?e:e.displayName||e.name;s&&(n=`

Check the top-level render call using <`+s+">.")}return n}}function Be(e,n){{if(!e._store||e._store.validated||e.key!=null)return;e._store.validated=!0;var s=Vt(n);if(He[s])return;He[s]=!0;var m="";e&&e._owner&&e._owner!==be.current&&(m=" It was passed a child from "+N(e._owner.type)+"."),re(e),S('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',s,m),re(null)}}function Ke(e,n){{if(typeof e!="object")return;if(he(e))for(var s=0;s<e.length;s++){var m=e[s];ye(m)&&Be(m,n)}else if(ye(e))e._store&&(e._store.validated=!0);else if(e){var R=G(e);if(typeof R=="function"&&R!==e.entries)for(var A=R.call(e),P;!(P=A.next()).done;)ye(P.value)&&Be(P.value,n)}}}function Ut(e){{var n=e.type;if(n==null||typeof n=="string")return;var s;if(typeof n=="function")s=n.propTypes;else if(typeof n=="object"&&(n.$$typeof===c||n.$$typeof===h))s=n.propTypes;else return;if(s){var m=N(n);wt(s,e.props,"prop",m,e)}else if(n.PropTypes!==void 0&&!Pe){Pe=!0;var R=N(n);S("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",R||"Unknown")}typeof n.getDefaultProps=="function"&&!n.getDefaultProps.isReactClassApproved&&S("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function Gt(e){{for(var n=Object.keys(e.props),s=0;s<n.length;s++){var m=n[s];if(m!=="children"&&m!=="key"){re(e),S("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",m),re(null);break}}e.ref!==null&&(re(e),S("Invalid attribute `ref` supplied to `React.Fragment`."),re(null))}}function ze(e,n,s,m,R,A){{var P=U(e);if(!P){var T="";(e===void 0||typeof e=="object"&&e!==null&&Object.keys(e).length===0)&&(T+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var V=xt(R);V?T+=V:T+=Je();var D;e===null?D="null":he(e)?D="array":e!==void 0&&e.$$typeof===a?(D="<"+(N(e.type)||"Unknown")+" />",T=" Did you accidentally export a JSX literal instead of a component?"):D=typeof e,S("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",D,T)}var j=Ft(e,n,s,R,A);if(j==null)return j;if(P){var H=n.children;if(H!==void 0)if(m)if(he(H)){for(var oe=0;oe<H.length;oe++)Ke(H[oe],e);Object.freeze&&Object.freeze(H)}else S("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else Ke(H,e)}return e===i?Gt(j):Ut(j),j}}function Wt(e,n,s){return ze(e,n,s,!0)}function Yt(e,n,s){return ze(e,n,s,!1)}var Jt=Yt,Ht=Wt;ae.Fragment=i,ae.jsx=Jt,ae.jsxs=Ht}()),ae}var ie={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Oe;function Qe(){if(Oe)return ie;Oe=1;var t=r,a=Symbol.for("react.element"),o=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,u=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};function l(d,c,f){var E,h={},C=null,w=null;f!==void 0&&(C=""+f),c.key!==void 0&&(C=""+c.key),c.ref!==void 0&&(w=c.ref);for(E in c)i.call(c,E)&&!p.hasOwnProperty(E)&&(h[E]=c[E]);if(d&&d.defaultProps)for(E in c=d.defaultProps,c)h[E]===void 0&&(h[E]=c[E]);return{$$typeof:a,type:d,key:C,ref:w,props:h,_owner:u.current}}return ie.Fragment=o,ie.jsx=l,ie.jsxs=l,ie}process.env.NODE_ENV==="production"?me.exports=Qe():me.exports=Ze();var O=me.exports;const Ie=t=>({[v.ParticipantEvent.JOINED]:t.onParticipantJoined,[v.ParticipantEvent.LEFT]:t.onParticipantLeft,[v.ParticipantEvent.LIST_UPDATED]:t.onParticipantListUpdated,[v.ParticipantEvent.LOCAL_JOINED]:t.onParticipantLocalJoined,[v.ParticipantEvent.LOCAL_LEFT]:t.onParticipantLocalLeft,[v.ParticipantEvent.LOCAL_UPDATED]:t.onParticipantLocalUpdated}),Se=r.createContext({hasProvider:!1,room:null});function M(t){const{hasProvider:a,...o}=r.useContext(Se);return r.useEffect(()=>{a||console.error("[SuperViz] You need to wrap your component with SuperVizRoomProvider")},[a]),t?{...o,component:o.activeComponents[t]}:o}function qe(t){const{roomId:a,group:o,debug:i,children:u,environment:p,participant:l,developerKey:d,customColors:c,onParticipantJoined:f,onParticipantLeft:E,onParticipantListUpdated:h,onParticipantLocalJoined:C,onParticipantLocalLeft:w,onParticipantLocalUpdated:_}=t,[I,G]=r.useState(!1),[b,S]=r.useState(null),[Q,q]=r.useState(null),x=r.useRef({}),k=r.useRef(!1);r.useEffect(()=>{if(!(!Z||I))return k.current||Z(),()=>{!L||!I||L()}},[]),r.useEffect(()=>{const y=Ie(t);!b||_e.isEqual(Q,y)||W(b,t)},[f,E,h,C,w,_,b]),r.useEffect(()=>{I&&(b==null||b.unsubscribe(v.ParticipantEvent.LOCAL_UPDATED),b==null||b.subscribe(v.ParticipantEvent.LOCAL_UPDATED,B))},[b,x]);function W(y,J){const K=Ie(J);Object.entries(K).forEach(([$,ee])=>{const se=J[$];(!ee&&se||ee!==se)&&y.unsubscribe($),ee&&y.subscribe($,ee)}),q(K)}async function Z(){if(I||b){console.log("[SuperViz] Room already started");return}try{k.current=!0;const y=await v(d,{participant:l,roomId:a,group:o,environment:p,debug:i,customColors:c});W(y,t),S(y),y.subscribe(v.ParticipantEvent.LOCAL_UPDATED,B),y.subscribe(v.ParticipantEvent.LOCAL_JOINED,N),y.subscribe(v.ParticipantEvent.LOCAL_LEFT,F)}catch(y){k.current=!1,console.error("[SuperViz] Error starting room",y)}k.current=!1}function L(){if(!b){console.error("[SuperViz] Room not started yet, you need to start the room before stopping it");return}b.destroy(),x.current={},S(null),G(!1)}function U(y){b&&(x.current[y.name]||b==null||b.addComponent(y),x.current[y.name]=y)}function Y(y){b&&(x.current[y.name]&&(b==null||b.removeComponent(y)),delete x.current[y.name])}function B(y){_&&_(y),y!=null&&y.activeComponents&&Object.keys(x).forEach(J=>{var K;(K=y.activeComponents)!=null&&K.includes(J)||delete x.current[J]})}function N(){G(!0)}function F(){G(!1)}const z=r.useMemo(()=>({hasProvider:!0,hasJoinedRoom:I,room:b,addComponent:U,removeComponent:Y,activeComponents:x.current}),[b,d,l,a,o,x,I]);return O.jsx(Se.Provider,{value:z,children:u})}function Me({viewer:t,children:a,...o}){const{room:i,component:u,addComponent:p}=M("presence3dAutodesk"),[l,d]=r.useState(null);return r.useEffect(()=>{if(!i||l||!t)return;const c=new Ce.Presence3D(t,o);p(c),d(Date.now())},[i,t]),r.useEffect(()=>{!u&&l&&d(null)},[u]),a??O.jsx(O.Fragment,{})}function $e({modelUrn:t,clientId:a,clientSecret:o,authUrl:i,initializeOptions:u,data:p,onDocumentLoadError:l,onDocumentLoadSuccess:d,onViewerInitialized:c,isAvatarsEnabled:f,isLaserEnabled:E,isNameEnabled:h,isMouseEnabled:C,avatarConfig:w,..._}){const[I,G]=r.useState(null),{hasJoinedRoom:b}=M("presence3dAutodesk"),S=i||"https://developer.api.autodesk.com/authentication/v2/token",Q=btoa(`${a}:${o}`),q={grant_type:"client_credentials",scope:"data:read bucket:read",...p};r.useEffect(()=>{b&&x()},[b]);async function x(){let k=null;if(!window.Autodesk){console.error("[Superviz] Autodesk not found");return}await fetch(S,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:`Basic ${Q}`},body:new URLSearchParams(q).toString()}).then(L=>L.json()).then(L=>{const Y=`urn:${btoa(t)}`,B={env:"AutodeskProduction2",api:"streamingV2",accessToken:L.access_token,...u};window.Autodesk.Viewing.Initializer(B,async()=>{const N=document.getElementById("autodesk-content");if(!N){console.error("[Superviz] Autodesk container not found");return}k=new window.Autodesk.Viewing.GuiViewer3D(N),await k.start(),c&&c({viewer:k,container:N}),window.Autodesk.Viewing.Document.load(Y,W,Z)})});function W(L){d&&d(L);const U=L.getRoot().getDefaultGeometry();if(!U||!k)return;const Y={applyScaling:"meters"};k.loadDocumentNode(L,U,Y).then(()=>{k&&G(k)}).catch(B=>{console.error("[SuperViz] Failed to load document node",B)})}function Z(L,U,Y){l&&l(L,U,Y),console.error("[SuperViz] Failed to load document",L,U,Y)}}return O.jsx(Me,{viewer:I,isAvatarsEnabled:f,isLaserEnabled:E,isNameEnabled:h,isMouseEnabled:C,avatarConfig:w,children:O.jsx("div",{id:"autodesk-content",..._})})}function et({pin:t,children:a,onPinActive:o,onPinInactive:i,onMount:u,onUnmount:p,...l}){const{room:d,component:c,addComponent:f}=M("comments"),[E,h]=r.useState(null),C={"pin-mode.active":o,"pin-mode.inactive":i,mount:u,unmount:p};return r.useEffect(()=>{c&&Object.entries(C).forEach(([w,_])=>{c.unsubscribe(w,_),_&&c.subscribe(w,_)})},[c,d,o,i,u,p]),r.useEffect(()=>{if(!d||E||!t)return;const w=new v.Comments(t,{...l});f(w),h(Date.now())},[d,t]),r.useEffect(()=>{!c&&E&&h(null)},[c]),a??O.jsx(O.Fragment,{})}var te=(t=>(t.INPUT="field.input",t.BLUR="field.blur",t.FOCUS="field.focus",t.CHANGE="field.change",t.KEYBOARD_INTERACTION="field.keyboard-interaction",t))(te||{});function tt({onMount:t,onUnmount:a,disableOutline:o,disableRealtimeSync:i,fields:u,children:p,onContentChange:l,onContentSync:d}){const{room:c,component:f,addComponent:E}=M("formElements"),[h,C]=r.useState(null),w={mount:t,unmount:a};return r.useEffect(()=>{f&&Object.entries(w).forEach(([_,I])=>{f.unsubscribe(_,I),I&&f.subscribe(_,I)})},[f,c,t,a,l,d]),r.useEffect(()=>{f&&(Object.keys(f.fields).forEach(_=>{f.unsubscribe(`${te.KEYBOARD_INTERACTION}-${_}`),f.unsubscribe(`${te.INPUT}-${_}`),l&&f.subscribe(`${te.KEYBOARD_INTERACTION}-${_}`,l),d&&f.subscribe(`${te.INPUT}-${_}`,d)}),Object.entries(w).forEach(([_,I])=>{f.unsubscribe(_,I),I&&f.subscribe(_,I)}))},[f,c,l,d]),r.useEffect(()=>{if(!c||h)return;const _=new v.FormElements({fields:u,disableOutline:o,disableRealtimeSync:i});E(_),C(Date.now())},[c]),r.useEffect(()=>{!f&&h&&C(null)},[f]),p??O.jsx(O.Fragment,{})}function De({matterportSdkInstance:t,children:a,...o}){const{room:i,component:u,addComponent:p}=M("presence3dMatterport"),[l,d]=r.useState(null);return r.useEffect(()=>{if(!i||l||!t)return;const c=new Re.Presence3D(t,o);p(c),d(Date.now())},[i,t]),r.useEffect(()=>{!u&&l&&d(null)},[u]),a??O.jsx(O.Fragment,{})}function nt({isAvatarsEnabled:t,isLaserEnabled:a,isNameEnabled:o,avatarConfig:i,bundleUrl:u,matterportKey:p,onMpSdkLoaded:l,...d}){const c=r.useRef(null),[f,E]=r.useState(null);r.useEffect(()=>{c.current&&h()},[u,c.current]);async function h(){if(f)return;const C=document.getElementById("showcase"),w=C.contentWindow;if(C.setAttribute("src",u),!w){console.error("[SuperViz] Matterport Showcase iframe not found");return}await new Promise(_=>{const I=async()=>{const G=await w.MP_SDK.connect(w,p);E(G),l&&l({matterportSdkInstance:G,showcaseWindow:c.current}),_(!0),C.removeEventListener("load",I)};C.addEventListener("load",I)})}return O.jsx(De,{matterportSdkInstance:f,isAvatarsEnabled:t,isLaserEnabled:a,isNameEnabled:o,avatarConfig:i,children:O.jsx("iframe",{ref:c,id:"showcase",...d})})}function rt({children:t,elementId:a,onMount:o,onUnmount:i,transform:u,...p}){const[l,d]=r.useState(null),{room:c,component:f,addComponent:E}=M("presence"),h={mount:o,unmount:i};return r.useEffect(()=>{f&&Object.entries(h).forEach(([C,w])=>{f.unsubscribe(C,w),w&&f.subscribe(C,w)})},[f,c,o,i]),r.useEffect(()=>{u&&(f==null||f.transform(u))},[u]),r.useEffect(()=>{var _;if(!c||l||!document.getElementById(a))return;const C=(_=p.callbacks)==null?void 0:_.onGoToPresence,w=new v.MousePointers(a,{callbacks:{onGoToPresence:C}});E(w),d(Date.now())},[c,a]),r.useEffect(()=>{!f&&l&&d(null)},[f]),t??O.jsx(O.Fragment,{})}function ot({onStateChange:t,onMount:a,onUnmount:o}){const{room:i,component:u,addComponent:p}=M("realtime"),[l,d]=r.useState(null);return r.useEffect(()=>{if(!i||l)return;const c=new v.Realtime;p(c),d(Date.now()),t&&c.subscribe(v.RealtimeComponentEvent.REALTIME_STATE_CHANGED,t),a&&a()},[i]),r.useEffect(()=>{!u&&l&&(d(null),o&&o())},[u]),O.jsx(O.Fragment,{})}function at({scene:t,camera:a,player:o,children:i,...u}){const{room:p,component:l,addComponent:d}=M("presence3dThreejs"),[c,f]=r.useState(null);return r.useEffect(()=>{if(!p||c||!t||!a||!o)return;const E=new we.Presence3D(t,a,o,{...u});d(E),f(Date.now())},[p,t]),r.useEffect(()=>{!l&&c&&f(null)},[l]),i??O.jsx(O.Fragment,{})}const je=t=>({[v.MeetingEvent.DESTROY]:t.onDestroy,[v.FrameEvent.FRAME_DIMENSIONS_UPDATE]:t.onFrameDimensionsChange,[v.MeetingEvent.MEETING_WAITING_FOR_HOST]:t.onWaitingForHostChange,[v.MeetingEvent.MEETING_CONNECTION_STATUS_CHANGE]:t.onConnectionStatusChange,[v.MeetingEvent.MEETING_STATE_UPDATE]:t.onMeetingStateChange,[v.MeetingEvent.MEETING_SAME_PARTICIPANT_ERROR]:t.onSameAccountError,[v.MeetingEvent.MEETING_DEVICES_CHANGE]:t.onDevicesStateChange,[v.MeetingEvent.MEETING_HOST_CHANGE]:t.onHostChange,[v.MeetingEvent.MEETING_HOST_AVAILABLE]:t.onHostAvailable,[v.MeetingEvent.MEETING_NO_HOST_AVAILABLE]:t.onNoHostAvailable,[v.MeetingEvent.MEETING_START]:t.onMeetingStart,[v.MeetingEvent.MEETING_PARTICIPANT_JOINED]:t.onParticipantJoin,[v.MeetingEvent.MY_PARTICIPANT_JOINED]:t.onLocalParticipantJoin,[v.MeetingEvent.MEETING_PARTICIPANT_LEFT]:t.onParticipantLeave,[v.MeetingEvent.MY_PARTICIPANT_LEFT]:t.onLocalParticipantLeave,[v.MeetingEvent.MEETING_PARTICIPANT_LIST_UPDATE]:t.onParticipantListChange,[v.MeetingEvent.MEETING_PARTICIPANT_AMOUNT_UPDATE]:t.onParticipantAmountChange,[v.MeetingEvent.MEETING_KICK_PARTICIPANTS]:t.onKickAllParticipants,[v.MeetingEvent.MEETING_KICK_PARTICIPANT]:t.onKickLocalParticipant,mount:t.onMount,unmount:t.onUnmount});function it(t){const{onMeetingStart:a,onDestroy:o,onFrameDimensionsChange:i,onWaitingForHostChange:u,onConnectionStatusChange:p,onMeetingStateChange:l,onSameAccountError:d,onDevicesStateChange:c,onHostChange:f,onHostAvailable:E,onNoHostAvailable:h,onParticipantJoin:C,onLocalParticipantJoin:w,onParticipantLeave:_,onLocalParticipantLeave:I,onParticipantListChange:G,onParticipantAmountChange:b,onKickAllParticipants:S,onKickLocalParticipant:Q,onMount:q,onUnmount:x}=t,{room:k,component:W,addComponent:Z}=M("videoConference"),[L,U]=r.useState(null),[Y,B]=r.useState(null);r.useEffect(()=>{if(!k||L)return;const F=new v.VideoConference(t);N(F,t),Z(F),U(Date.now())},[k]),r.useEffect(()=>{const F=je(t);!W||_e.isEqual(Y,F)||N(W,t)},[W,a,o,i,u,p,l,d,c,f,E,h,C,w,_,I,G,b,S,Q,q,x]),r.useEffect(()=>{!W&&L&&U(null)},[W]);function N(F,z){const y=je(z);Object.entries(y).forEach(([J,K])=>{z[J]||F.unsubscribe(J),K&&F.subscribe(J,K)}),B(y)}return O.jsx(O.Fragment,{})}function st({position:t,styles:a,onMount:o,onUnmount:i,...u}){const{room:p,component:l,addComponent:d}=M("whoIsOnline"),[c,f]=r.useState(null),E={mount:o,unmount:i};return r.useEffect(()=>{l&&Object.entries(E).forEach(([h,C])=>{l.unsubscribe(h,C),C&&l.subscribe(h,C)})},[l,p,o,i]),r.useEffect(()=>{if(!p||c)return;const h=new v.WhoIsOnline({position:t,styles:a,...u});d(h),f(Date.now())},[p]),r.useEffect(()=>{!l&&c&&f(null)},[l]),O.jsx(O.Fragment,{})}function ut(){const{component:t,...a}=M("presence3dAutodesk");return r.useMemo(()=>t?{isReady:!0,follow:o=>{t.follow(o)},goTo:o=>{t.goTo(o)}}:{isReady:!1,follow:()=>{},goTo:()=>{}},[a.room,a.activeComponents,t])}function ct({autodeskInstance:t}){const{room:a}=M(),o=r.useRef(!1),i=r.useRef(null);return r.useEffect(()=>{var u;!a&&o.current&&(o.current=!1,(u=i.current)==null||u.destroy(),i.current=null)},[a]),r.useMemo(()=>{if(!t)return{pin:null,destroy:()=>{}};if(!o.current){o.current=!0;const u=new Ce.AutodeskPin(t);i.current=u}return{pin:i==null?void 0:i.current,destroy:()=>{var u;(u=i==null?void 0:i.current)==null||u.destroy(),i.current=null}}},[t,a,i.current])}function ft({canvasId:t,onGoToPin:a}){const{room:o}=M(),i=r.useRef(!1),u=r.useRef(null);function p(l){a&&a(l)}if(r.useEffect(()=>{var l;!o&&i.current&&(i.current=!1,(l=u.current)==null||l.destroy(),u.current=null)},[o]),!t||!document.getElementById(t))return{pin:null,destroy:()=>{}};if(!i.current){i.current=!0;const l=new v.CanvasPin(t,{onGoToPin:p});u.current=l}return{pin:u.current,destroy:()=>{var l;(l=u.current)==null||l.destroy(),u.current=null}}}function lt(){const{component:t,...a}=M("comments");return r.useMemo(()=>t?{isReady:!0,openThreads:()=>{t.openThreads()},closeThreads:()=>{t.closeThreads()},enable:()=>{t.enable()},disable:()=>{t.disable()}}:{isReady:!1,openThreads:()=>{},closeThreads:()=>{},enable:()=>{},disable:()=>{}},[t,a.room,a.activeComponents])}let ne=null;function dt({containerId:t,...a}){const{room:o}=M(),[i,u]=r.useState(!1);return r.useEffect(()=>{!o&&i&&u(!1)},[o]),r.useMemo(()=>!t||!document.getElementById(t)?{pin:null,destroy:()=>{}}:(ne||(ne=new v.HTMLPin(t,a),u(!0)),{pin:ne,destroy:()=>{ne==null||ne.destroy(),u(!1)}}),[t,o,i])}function pt(){const{component:t,...a}=M("presence3dMatterport");return r.useMemo(()=>t?{isReady:!0,follow:o=>{t.follow(o)},goTo:o=>{t.goTo(o)}}:{isReady:!1,follow:()=>{},goTo:()=>{}},[a.room,a.activeComponents,t])}function mt({matterportInstance:t,showcaseWindow:a}){const{room:o}=M(),i=r.useRef(!1),u=r.useRef(null);return r.useEffect(()=>{var p;!o&&i.current&&(i.current=!1,(p=u.current)==null||p.destroy(),u.current=null)},[o]),r.useMemo(()=>{if(!a||!t)return{pin:null,destroy:()=>{}};if(!i.current){i.current=!0;const p=new Re.MatterportPin(t,a);u.current=p}return{pin:u.current,destroy:()=>{var p;(p=u.current)==null||p.destroy(),u.current=null}}},[a,t])}function Et(){const[t,a]=r.useState(!1),{component:o,...i}=M("realtime"),u=r.useRef({});r.useEffect(()=>{o&&(o.subscribe("realtime-component.state-changed",f=>{a(f===v.RealtimeComponentState.STARTED)}),Object.keys(u.current).length&&(Object.entries(u.current).forEach(([f,E])=>{E.forEach(h=>{o.subscribe(f,h)})}),u.current={}))},[o,u.current]);const p=r.useCallback((f,E)=>{if(!o){const h=u.current[f]||[];u.current[f]=h.includes(E)?h:[...h,E];return}o.subscribe(f,E)},[o,i,u.current]),l=r.useCallback((f,E)=>{t&&o.publish(f,E)},[o,i,t]),d=r.useCallback((f,E)=>{t&&o.unsubscribe(f,E)},[o,i,t]),c=r.useCallback(async f=>t?await o.fetchHistory(f):(console.warn("[SuperViz] Realtime component is not ready - try again later"),Promise.resolve(null)),[o,i,t]);return r.useMemo(()=>({isReady:t,publish:l,subscribe:p,unsubscribe:d,fetchHistory:c}),[o,i,t])}function vt(){const{component:t,...a}=M("presence3dThreejs");return r.useMemo(()=>t?{isReady:!0,follow:o=>{t.follow(o)},goTo:o=>{t.goTo(o)}}:{isReady:!1,follow:()=>{},goTo:()=>{}},[a.room,a.activeComponents,t])}function gt({scene:t,renderer:a,camera:o,player:i,controls:u}){const{room:p}=M(),l=r.useRef(!1),d=r.useRef(null);return r.useEffect(()=>{var c;!p&&l.current&&(l.current=!1,(c=d.current)==null||c.destroy(),d.current=null)},[p]),r.useMemo(()=>{if(!t||!a||!o)return{pin:null,destroy:()=>{}};if(!l.current){l.current=!0;const c=new we.ThreeJsPin(t,a,o,i,u);d.current=c}return{pin:d.current,destroy:()=>{var c;(c=d.current)==null||c.destroy(),d.current=null}}},[t,a,o,i,u])}function ht(){const{component:t,...a}=M("videoConference");return r.useMemo(()=>t?{isReady:!0,toggleMeetingSetup:()=>{t.toggleMeetingSetup()},toggleMicrophone:()=>{t.toggleMicrophone()},toggleCam:()=>{t.toggleCam()},toggleScreenShare:()=>{t.toggleScreenShare()},toggleChat:()=>{t.toggleChat()},toggleTranscript:()=>{t.toggleTranscript()},hangUp:()=>{t.hangUp()}}:{isReady:!1,toggleMeetingSetup:()=>{},toggleMicrophone:()=>{},toggleCam:()=>{},toggleScreenShare:()=>{},toggleChat:()=>{},toggleTranscript:()=>{},hangUp:()=>{}},[a.room,a.activeComponents,t])}function Tt(t){if(t=t.replace("#",""),t.length===6){const a=parseInt(t.substring(0,2),16),o=parseInt(t.substring(2,4),16),i=parseInt(t.substring(4,6),16);return`${a} ${o} ${i}`}else if(t.startsWith("rgb(")&&t.endsWith(")")){const a=t.substring(4,t.length-1).split(",");return`${a[0].trim()} ${a[1].trim()} ${a[2].trim()}`}else return t}function bt(t){const a={};for(const[o,i]of Object.entries(t))a[o]=Tt(i);return a}g.AutodeskPresence=Me,g.AutodeskViewer=$e,g.Comments=et,g.FieldEvents=te,g.FormElements=tt,g.MatterportIframe=nt,g.MatterportPresence=De,g.MousePointers=rt,g.Realtime=ot,g.SuperVizRoomProvider=qe,g.ThreeJsPresence=at,g.VideoConference=it,g.WhoIsOnline=st,g.createTheme=bt,g.useAutodesk=ut,g.useAutodeskPin=ct,g.useCanvasPin=ft,g.useComments=lt,g.useHTMLPin=dt,g.useMatterport=pt,g.useMatterportPin=mt,g.useRealtime=Et,g.useThree=vt,g.useThreeJsPin=gt,g.useVideo=ht,Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})});
