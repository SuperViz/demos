function OK(i,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const n in r)if(n!=="default"&&!(n in i)){const l=Object.getOwnPropertyDescriptor(r,n);l&&Object.defineProperty(i,n,l.get?l:{enumerable:!0,get:()=>r[n]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function t(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(n){if(n.ep)return;n.ep=!0;const l=t(n);fetch(n.href,l)}})();var lu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qd(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var fG={exports:{}},wI={},pG={exports:{}},Cr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dC=Symbol.for("react.element"),NK=Symbol.for("react.portal"),DK=Symbol.for("react.fragment"),kK=Symbol.for("react.strict_mode"),FK=Symbol.for("react.profiler"),zK=Symbol.for("react.provider"),BK=Symbol.for("react.context"),UK=Symbol.for("react.forward_ref"),HK=Symbol.for("react.suspense"),$K=Symbol.for("react.memo"),VK=Symbol.for("react.lazy"),FU=Symbol.iterator;function WK(i){return i===null||typeof i!="object"?null:(i=FU&&i[FU]||i["@@iterator"],typeof i=="function"?i:null)}var mG={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},gG=Object.assign,vG={};function iE(i,e,t){this.props=i,this.context=e,this.refs=vG,this.updater=t||mG}iE.prototype.isReactComponent={};iE.prototype.setState=function(i,e){if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,i,e,"setState")};iE.prototype.forceUpdate=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function yG(){}yG.prototype=iE.prototype;function k4(i,e,t){this.props=i,this.context=e,this.refs=vG,this.updater=t||mG}var F4=k4.prototype=new yG;F4.constructor=k4;gG(F4,iE.prototype);F4.isPureReactComponent=!0;var zU=Array.isArray,_G=Object.prototype.hasOwnProperty,z4={current:null},xG={key:!0,ref:!0,__self:!0,__source:!0};function bG(i,e,t){var r,n={},l=null,c=null;if(e!=null)for(r in e.ref!==void 0&&(c=e.ref),e.key!==void 0&&(l=""+e.key),e)_G.call(e,r)&&!xG.hasOwnProperty(r)&&(n[r]=e[r]);var h=arguments.length-2;if(h===1)n.children=t;else if(1<h){for(var d=Array(h),f=0;f<h;f++)d[f]=arguments[f+2];n.children=d}if(i&&i.defaultProps)for(r in h=i.defaultProps,h)n[r]===void 0&&(n[r]=h[r]);return{$$typeof:dC,type:i,key:l,ref:c,props:n,_owner:z4.current}}function jK(i,e){return{$$typeof:dC,type:i.type,key:e,ref:i.ref,props:i.props,_owner:i._owner}}function B4(i){return typeof i=="object"&&i!==null&&i.$$typeof===dC}function GK(i){var e={"=":"=0",":":"=2"};return"$"+i.replace(/[=:]/g,function(t){return e[t]})}var BU=/\/+/g;function IL(i,e){return typeof i=="object"&&i!==null&&i.key!=null?GK(""+i.key):e.toString(36)}function IP(i,e,t,r,n){var l=typeof i;(l==="undefined"||l==="boolean")&&(i=null);var c=!1;if(i===null)c=!0;else switch(l){case"string":case"number":c=!0;break;case"object":switch(i.$$typeof){case dC:case NK:c=!0}}if(c)return c=i,n=n(c),i=r===""?"."+IL(c,0):r,zU(n)?(t="",i!=null&&(t=i.replace(BU,"$&/")+"/"),IP(n,e,t,"",function(f){return f})):n!=null&&(B4(n)&&(n=jK(n,t+(!n.key||c&&c.key===n.key?"":(""+n.key).replace(BU,"$&/")+"/")+i)),e.push(n)),1;if(c=0,r=r===""?".":r+":",zU(i))for(var h=0;h<i.length;h++){l=i[h];var d=r+IL(l,h);c+=IP(l,e,t,d,n)}else if(d=WK(i),typeof d=="function")for(i=d.call(i),h=0;!(l=i.next()).done;)l=l.value,d=r+IL(l,h++),c+=IP(l,e,t,d,n);else if(l==="object")throw e=String(i),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return c}function HC(i,e,t){if(i==null)return i;var r=[],n=0;return IP(i,r,"","",function(l){return e.call(t,l,n++)}),r}function qK(i){if(i._status===-1){var e=i._result;e=e(),e.then(function(t){(i._status===0||i._status===-1)&&(i._status=1,i._result=t)},function(t){(i._status===0||i._status===-1)&&(i._status=2,i._result=t)}),i._status===-1&&(i._status=0,i._result=e)}if(i._status===1)return i._result.default;throw i._result}var Kl={current:null},LP={transition:null},XK={ReactCurrentDispatcher:Kl,ReactCurrentBatchConfig:LP,ReactCurrentOwner:z4};Cr.Children={map:HC,forEach:function(i,e,t){HC(i,function(){e.apply(this,arguments)},t)},count:function(i){var e=0;return HC(i,function(){e++}),e},toArray:function(i){return HC(i,function(e){return e})||[]},only:function(i){if(!B4(i))throw Error("React.Children.only expected to receive a single React element child.");return i}};Cr.Component=iE;Cr.Fragment=DK;Cr.Profiler=FK;Cr.PureComponent=k4;Cr.StrictMode=kK;Cr.Suspense=HK;Cr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=XK;Cr.cloneElement=function(i,e,t){if(i==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+i+".");var r=gG({},i.props),n=i.key,l=i.ref,c=i._owner;if(e!=null){if(e.ref!==void 0&&(l=e.ref,c=z4.current),e.key!==void 0&&(n=""+e.key),i.type&&i.type.defaultProps)var h=i.type.defaultProps;for(d in e)_G.call(e,d)&&!xG.hasOwnProperty(d)&&(r[d]=e[d]===void 0&&h!==void 0?h[d]:e[d])}var d=arguments.length-2;if(d===1)r.children=t;else if(1<d){h=Array(d);for(var f=0;f<d;f++)h[f]=arguments[f+2];r.children=h}return{$$typeof:dC,type:i.type,key:n,ref:l,props:r,_owner:c}};Cr.createContext=function(i){return i={$$typeof:BK,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},i.Provider={$$typeof:zK,_context:i},i.Consumer=i};Cr.createElement=bG;Cr.createFactory=function(i){var e=bG.bind(null,i);return e.type=i,e};Cr.createRef=function(){return{current:null}};Cr.forwardRef=function(i){return{$$typeof:UK,render:i}};Cr.isValidElement=B4;Cr.lazy=function(i){return{$$typeof:VK,_payload:{_status:-1,_result:i},_init:qK}};Cr.memo=function(i,e){return{$$typeof:$K,type:i,compare:e===void 0?null:e}};Cr.startTransition=function(i){var e=LP.transition;LP.transition={};try{i()}finally{LP.transition=e}};Cr.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Cr.useCallback=function(i,e){return Kl.current.useCallback(i,e)};Cr.useContext=function(i){return Kl.current.useContext(i)};Cr.useDebugValue=function(){};Cr.useDeferredValue=function(i){return Kl.current.useDeferredValue(i)};Cr.useEffect=function(i,e){return Kl.current.useEffect(i,e)};Cr.useId=function(){return Kl.current.useId()};Cr.useImperativeHandle=function(i,e,t){return Kl.current.useImperativeHandle(i,e,t)};Cr.useInsertionEffect=function(i,e){return Kl.current.useInsertionEffect(i,e)};Cr.useLayoutEffect=function(i,e){return Kl.current.useLayoutEffect(i,e)};Cr.useMemo=function(i,e){return Kl.current.useMemo(i,e)};Cr.useReducer=function(i,e,t){return Kl.current.useReducer(i,e,t)};Cr.useRef=function(i){return Kl.current.useRef(i)};Cr.useState=function(i){return Kl.current.useState(i)};Cr.useSyncExternalStore=function(i,e,t){return Kl.current.useSyncExternalStore(i,e,t)};Cr.useTransition=function(){return Kl.current.useTransition()};Cr.version="18.2.0";pG.exports=Cr;var Ze=pG.exports;const vi=Qd(Ze),ZK=OK({__proto__:null,default:vi},[Ze]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JK=Ze,YK=Symbol.for("react.element"),KK=Symbol.for("react.fragment"),QK=Object.prototype.hasOwnProperty,eQ=JK.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,tQ={key:!0,ref:!0,__self:!0,__source:!0};function wG(i,e,t){var r,n={},l=null,c=null;t!==void 0&&(l=""+t),e.key!==void 0&&(l=""+e.key),e.ref!==void 0&&(c=e.ref);for(r in e)QK.call(e,r)&&!tQ.hasOwnProperty(r)&&(n[r]=e[r]);if(i&&i.defaultProps)for(r in e=i.defaultProps,e)n[r]===void 0&&(n[r]=e[r]);return{$$typeof:YK,type:i,key:l,ref:c,props:n,_owner:eQ.current}}wI.Fragment=KK;wI.jsx=wG;wI.jsxs=wG;fG.exports=wI;var $t=fG.exports,tk={},SG={exports:{}},Uu={},MG={exports:{}},EG={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(i){function e(X,re){var ae=X.length;X.push(re);e:for(;0<ae;){var he=ae-1>>>1,pe=X[he];if(0<n(pe,re))X[he]=re,X[ae]=pe,ae=he;else break e}}function t(X){return X.length===0?null:X[0]}function r(X){if(X.length===0)return null;var re=X[0],ae=X.pop();if(ae!==re){X[0]=ae;e:for(var he=0,pe=X.length,de=pe>>>1;he<de;){var ee=2*(he+1)-1,se=X[ee],Y=ee+1,fe=X[Y];if(0>n(se,ae))Y<pe&&0>n(fe,se)?(X[he]=fe,X[Y]=ae,he=Y):(X[he]=se,X[ee]=ae,he=ee);else if(Y<pe&&0>n(fe,ae))X[he]=fe,X[Y]=ae,he=Y;else break e}}return re}function n(X,re){var ae=X.sortIndex-re.sortIndex;return ae!==0?ae:X.id-re.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;i.unstable_now=function(){return l.now()}}else{var c=Date,h=c.now();i.unstable_now=function(){return c.now()-h}}var d=[],f=[],m=1,g=null,y=3,_=!1,b=!1,S=!1,E=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function P(X){for(var re=t(f);re!==null;){if(re.callback===null)r(f);else if(re.startTime<=X)r(f),re.sortIndex=re.expirationTime,e(d,re);else break;re=t(f)}}function O(X){if(S=!1,P(X),!b)if(t(d)!==null)b=!0,$(R);else{var re=t(f);re!==null&&H(O,re.startTime-X)}}function R(X,re){b=!1,S&&(S=!1,T(N),N=-1),_=!0;var ae=y;try{for(P(re),g=t(d);g!==null&&(!(g.expirationTime>re)||X&&!z());){var he=g.callback;if(typeof he=="function"){g.callback=null,y=g.priorityLevel;var pe=he(g.expirationTime<=re);re=i.unstable_now(),typeof pe=="function"?g.callback=pe:g===t(d)&&r(d),P(re)}else r(d);g=t(d)}if(g!==null)var de=!0;else{var ee=t(f);ee!==null&&H(O,ee.startTime-re),de=!1}return de}finally{g=null,y=ae,_=!1}}var D=!1,L=null,N=-1,U=5,F=-1;function z(){return!(i.unstable_now()-F<U)}function G(){if(L!==null){var X=i.unstable_now();F=X;var re=!0;try{re=L(!0,X)}finally{re?J():(D=!1,L=null)}}else D=!1}var J;if(typeof A=="function")J=function(){A(G)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,q=Z.port2;Z.port1.onmessage=G,J=function(){q.postMessage(null)}}else J=function(){E(G,0)};function $(X){L=X,D||(D=!0,J())}function H(X,re){N=E(function(){X(i.unstable_now())},re)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(X){X.callback=null},i.unstable_continueExecution=function(){b||_||(b=!0,$(R))},i.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<X?Math.floor(1e3/X):5},i.unstable_getCurrentPriorityLevel=function(){return y},i.unstable_getFirstCallbackNode=function(){return t(d)},i.unstable_next=function(X){switch(y){case 1:case 2:case 3:var re=3;break;default:re=y}var ae=y;y=re;try{return X()}finally{y=ae}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(X,re){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var ae=y;y=X;try{return re()}finally{y=ae}},i.unstable_scheduleCallback=function(X,re,ae){var he=i.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?he+ae:he):ae=he,X){case 1:var pe=-1;break;case 2:pe=250;break;case 5:pe=1073741823;break;case 4:pe=1e4;break;default:pe=5e3}return pe=ae+pe,X={id:m++,callback:re,priorityLevel:X,startTime:ae,expirationTime:pe,sortIndex:-1},ae>he?(X.sortIndex=ae,e(f,X),t(d)===null&&X===t(f)&&(S?(T(N),N=-1):S=!0,H(O,ae-he))):(X.sortIndex=pe,e(d,X),b||_||(b=!0,$(R))),X},i.unstable_shouldYield=z,i.unstable_wrapCallback=function(X){var re=y;return function(){var ae=y;y=re;try{return X.apply(this,arguments)}finally{y=ae}}}})(EG);MG.exports=EG;var iQ=MG.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TG=Ze,Bu=iQ;function Et(i){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+i,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+i+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var AG=new Set,oA={};function gw(i,e){AM(i,e),AM(i+"Capture",e)}function AM(i,e){for(oA[i]=e,i=0;i<e.length;i++)AG.add(e[i])}var wp=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ik=Object.prototype.hasOwnProperty,rQ=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,UU={},HU={};function nQ(i){return ik.call(HU,i)?!0:ik.call(UU,i)?!1:rQ.test(i)?HU[i]=!0:(UU[i]=!0,!1)}function sQ(i,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function aQ(i,e,t,r){if(e===null||typeof e>"u"||sQ(i,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ql(i,e,t,r,n,l,c){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=n,this.mustUseProperty=t,this.propertyName=i,this.type=e,this.sanitizeURL=l,this.removeEmptyString=c}var no={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){no[i]=new Ql(i,0,!1,i,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var e=i[0];no[e]=new Ql(e,1,!1,i[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(i){no[i]=new Ql(i,2,!1,i.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){no[i]=new Ql(i,2,!1,i,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){no[i]=new Ql(i,3,!1,i.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(i){no[i]=new Ql(i,3,!0,i,null,!1,!1)});["capture","download"].forEach(function(i){no[i]=new Ql(i,4,!1,i,null,!1,!1)});["cols","rows","size","span"].forEach(function(i){no[i]=new Ql(i,6,!1,i,null,!1,!1)});["rowSpan","start"].forEach(function(i){no[i]=new Ql(i,5,!1,i.toLowerCase(),null,!1,!1)});var U4=/[\-:]([a-z])/g;function H4(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var e=i.replace(U4,H4);no[e]=new Ql(e,1,!1,i,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var e=i.replace(U4,H4);no[e]=new Ql(e,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(i){var e=i.replace(U4,H4);no[e]=new Ql(e,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(i){no[i]=new Ql(i,1,!1,i.toLowerCase(),null,!1,!1)});no.xlinkHref=new Ql("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(i){no[i]=new Ql(i,1,!1,i.toLowerCase(),null,!0,!0)});function $4(i,e,t,r){var n=no.hasOwnProperty(e)?no[e]:null;(n!==null?n.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(aQ(e,t,n,r)&&(t=null),r||n===null?nQ(e)&&(t===null?i.removeAttribute(e):i.setAttribute(e,""+t)):n.mustUseProperty?i[n.propertyName]=t===null?n.type===3?!1:"":t:(e=n.attributeName,r=n.attributeNamespace,t===null?i.removeAttribute(e):(n=n.type,t=n===3||n===4&&t===!0?"":""+t,r?i.setAttributeNS(r,e,t):i.setAttribute(e,t))))}var Fp=TG.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,$C=Symbol.for("react.element"),zS=Symbol.for("react.portal"),BS=Symbol.for("react.fragment"),V4=Symbol.for("react.strict_mode"),rk=Symbol.for("react.profiler"),CG=Symbol.for("react.provider"),PG=Symbol.for("react.context"),W4=Symbol.for("react.forward_ref"),nk=Symbol.for("react.suspense"),sk=Symbol.for("react.suspense_list"),j4=Symbol.for("react.memo"),vm=Symbol.for("react.lazy"),RG=Symbol.for("react.offscreen"),$U=Symbol.iterator;function LE(i){return i===null||typeof i!="object"?null:(i=$U&&i[$U]||i["@@iterator"],typeof i=="function"?i:null)}var gs=Object.assign,LL;function CT(i){if(LL===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);LL=e&&e[1]||""}return`
`+LL+i}var OL=!1;function NL(i,e){if(!i||OL)return"";OL=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(f){var r=f}Reflect.construct(i,[],e)}else{try{e.call()}catch(f){r=f}i.call(e.prototype)}else{try{throw Error()}catch(f){r=f}i()}}catch(f){if(f&&r&&typeof f.stack=="string"){for(var n=f.stack.split(`
`),l=r.stack.split(`
`),c=n.length-1,h=l.length-1;1<=c&&0<=h&&n[c]!==l[h];)h--;for(;1<=c&&0<=h;c--,h--)if(n[c]!==l[h]){if(c!==1||h!==1)do if(c--,h--,0>h||n[c]!==l[h]){var d=`
`+n[c].replace(" at new "," at ");return i.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",i.displayName)),d}while(1<=c&&0<=h);break}}}finally{OL=!1,Error.prepareStackTrace=t}return(i=i?i.displayName||i.name:"")?CT(i):""}function oQ(i){switch(i.tag){case 5:return CT(i.type);case 16:return CT("Lazy");case 13:return CT("Suspense");case 19:return CT("SuspenseList");case 0:case 2:case 15:return i=NL(i.type,!1),i;case 11:return i=NL(i.type.render,!1),i;case 1:return i=NL(i.type,!0),i;default:return""}}function ak(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case BS:return"Fragment";case zS:return"Portal";case rk:return"Profiler";case V4:return"StrictMode";case nk:return"Suspense";case sk:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case PG:return(i.displayName||"Context")+".Consumer";case CG:return(i._context.displayName||"Context")+".Provider";case W4:var e=i.render;return i=i.displayName,i||(i=e.displayName||e.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case j4:return e=i.displayName||null,e!==null?e:ak(i.type)||"Memo";case vm:e=i._payload,i=i._init;try{return ak(i(e))}catch{}}return null}function lQ(i){var e=i.type;switch(i.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=e.render,i=i.displayName||i.name||"",e.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ak(e);case 8:return e===V4?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Xm(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function IG(i){var e=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function uQ(i){var e=IG(i)?"checked":"value",t=Object.getOwnPropertyDescriptor(i.constructor.prototype,e),r=""+i[e];if(!i.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var n=t.get,l=t.set;return Object.defineProperty(i,e,{configurable:!0,get:function(){return n.call(this)},set:function(c){r=""+c,l.call(this,c)}}),Object.defineProperty(i,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(c){r=""+c},stopTracking:function(){i._valueTracker=null,delete i[e]}}}}function VC(i){i._valueTracker||(i._valueTracker=uQ(i))}function LG(i){if(!i)return!1;var e=i._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return i&&(r=IG(i)?i.checked?"true":"false":i.value),i=r,i!==t?(e.setValue(i),!0):!1}function lR(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function ok(i,e){var t=e.checked;return gs({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??i._wrapperState.initialChecked})}function VU(i,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=Xm(e.value!=null?e.value:t),i._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function OG(i,e){e=e.checked,e!=null&&$4(i,"checked",e,!1)}function lk(i,e){OG(i,e);var t=Xm(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&i.value===""||i.value!=t)&&(i.value=""+t):i.value!==""+t&&(i.value=""+t);else if(r==="submit"||r==="reset"){i.removeAttribute("value");return}e.hasOwnProperty("value")?uk(i,e.type,t):e.hasOwnProperty("defaultValue")&&uk(i,e.type,Xm(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(i.defaultChecked=!!e.defaultChecked)}function WU(i,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+i._wrapperState.initialValue,t||e===i.value||(i.value=e),i.defaultValue=e}t=i.name,t!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,t!==""&&(i.name=t)}function uk(i,e,t){(e!=="number"||lR(i.ownerDocument)!==i)&&(t==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+t&&(i.defaultValue=""+t))}var PT=Array.isArray;function oM(i,e,t,r){if(i=i.options,e){e={};for(var n=0;n<t.length;n++)e["$"+t[n]]=!0;for(t=0;t<i.length;t++)n=e.hasOwnProperty("$"+i[t].value),i[t].selected!==n&&(i[t].selected=n),n&&r&&(i[t].defaultSelected=!0)}else{for(t=""+Xm(t),e=null,n=0;n<i.length;n++){if(i[n].value===t){i[n].selected=!0,r&&(i[n].defaultSelected=!0);return}e!==null||i[n].disabled||(e=i[n])}e!==null&&(e.selected=!0)}}function ck(i,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Et(91));return gs({},e,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function jU(i,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(Et(92));if(PT(t)){if(1<t.length)throw Error(Et(93));t=t[0]}e=t}e==null&&(e=""),t=e}i._wrapperState={initialValue:Xm(t)}}function NG(i,e){var t=Xm(e.value),r=Xm(e.defaultValue);t!=null&&(t=""+t,t!==i.value&&(i.value=t),e.defaultValue==null&&i.defaultValue!==t&&(i.defaultValue=t)),r!=null&&(i.defaultValue=""+r)}function GU(i){var e=i.textContent;e===i._wrapperState.initialValue&&e!==""&&e!==null&&(i.value=e)}function DG(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function hk(i,e){return i==null||i==="http://www.w3.org/1999/xhtml"?DG(e):i==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var WC,kG=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,n){MSApp.execUnsafeLocalFunction(function(){return i(e,t,r,n)})}:i}(function(i,e){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=e;else{for(WC=WC||document.createElement("div"),WC.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=WC.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;e.firstChild;)i.appendChild(e.firstChild)}});function lA(i,e){if(e){var t=i.firstChild;if(t&&t===i.lastChild&&t.nodeType===3){t.nodeValue=e;return}}i.textContent=e}var BT={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},cQ=["Webkit","ms","Moz","O"];Object.keys(BT).forEach(function(i){cQ.forEach(function(e){e=e+i.charAt(0).toUpperCase()+i.substring(1),BT[e]=BT[i]})});function FG(i,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||BT.hasOwnProperty(i)&&BT[i]?(""+e).trim():e+"px"}function zG(i,e){i=i.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,n=FG(t,e[t],r);t==="float"&&(t="cssFloat"),r?i.setProperty(t,n):i[t]=n}}var hQ=gs({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function dk(i,e){if(e){if(hQ[i]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Et(137,i));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Et(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Et(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Et(62))}}function fk(i,e){if(i.indexOf("-")===-1)return typeof e.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var pk=null;function G4(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var mk=null,lM=null,uM=null;function qU(i){if(i=mC(i)){if(typeof mk!="function")throw Error(Et(280));var e=i.stateNode;e&&(e=AI(e),mk(i.stateNode,i.type,e))}}function BG(i){lM?uM?uM.push(i):uM=[i]:lM=i}function UG(){if(lM){var i=lM,e=uM;if(uM=lM=null,qU(i),e)for(i=0;i<e.length;i++)qU(e[i])}}function HG(i,e){return i(e)}function $G(){}var DL=!1;function VG(i,e,t){if(DL)return i(e,t);DL=!0;try{return HG(i,e,t)}finally{DL=!1,(lM!==null||uM!==null)&&($G(),UG())}}function uA(i,e){var t=i.stateNode;if(t===null)return null;var r=AI(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(i=i.type,r=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!r;break e;default:i=!1}if(i)return null;if(t&&typeof t!="function")throw Error(Et(231,e,typeof t));return t}var gk=!1;if(wp)try{var OE={};Object.defineProperty(OE,"passive",{get:function(){gk=!0}}),window.addEventListener("test",OE,OE),window.removeEventListener("test",OE,OE)}catch{gk=!1}function dQ(i,e,t,r,n,l,c,h,d){var f=Array.prototype.slice.call(arguments,3);try{e.apply(t,f)}catch(m){this.onError(m)}}var UT=!1,uR=null,cR=!1,vk=null,fQ={onError:function(i){UT=!0,uR=i}};function pQ(i,e,t,r,n,l,c,h,d){UT=!1,uR=null,dQ.apply(fQ,arguments)}function mQ(i,e,t,r,n,l,c,h,d){if(pQ.apply(this,arguments),UT){if(UT){var f=uR;UT=!1,uR=null}else throw Error(Et(198));cR||(cR=!0,vk=f)}}function vw(i){var e=i,t=i;if(i.alternate)for(;e.return;)e=e.return;else{i=e;do e=i,e.flags&4098&&(t=e.return),i=e.return;while(i)}return e.tag===3?t:null}function WG(i){if(i.tag===13){var e=i.memoizedState;if(e===null&&(i=i.alternate,i!==null&&(e=i.memoizedState)),e!==null)return e.dehydrated}return null}function XU(i){if(vw(i)!==i)throw Error(Et(188))}function gQ(i){var e=i.alternate;if(!e){if(e=vw(i),e===null)throw Error(Et(188));return e!==i?null:i}for(var t=i,r=e;;){var n=t.return;if(n===null)break;var l=n.alternate;if(l===null){if(r=n.return,r!==null){t=r;continue}break}if(n.child===l.child){for(l=n.child;l;){if(l===t)return XU(n),i;if(l===r)return XU(n),e;l=l.sibling}throw Error(Et(188))}if(t.return!==r.return)t=n,r=l;else{for(var c=!1,h=n.child;h;){if(h===t){c=!0,t=n,r=l;break}if(h===r){c=!0,r=n,t=l;break}h=h.sibling}if(!c){for(h=l.child;h;){if(h===t){c=!0,t=l,r=n;break}if(h===r){c=!0,r=l,t=n;break}h=h.sibling}if(!c)throw Error(Et(189))}}if(t.alternate!==r)throw Error(Et(190))}if(t.tag!==3)throw Error(Et(188));return t.stateNode.current===t?i:e}function jG(i){return i=gQ(i),i!==null?GG(i):null}function GG(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var e=GG(i);if(e!==null)return e;i=i.sibling}return null}var qG=Bu.unstable_scheduleCallback,ZU=Bu.unstable_cancelCallback,vQ=Bu.unstable_shouldYield,yQ=Bu.unstable_requestPaint,As=Bu.unstable_now,_Q=Bu.unstable_getCurrentPriorityLevel,q4=Bu.unstable_ImmediatePriority,XG=Bu.unstable_UserBlockingPriority,hR=Bu.unstable_NormalPriority,xQ=Bu.unstable_LowPriority,ZG=Bu.unstable_IdlePriority,SI=null,yf=null;function bQ(i){if(yf&&typeof yf.onCommitFiberRoot=="function")try{yf.onCommitFiberRoot(SI,i,void 0,(i.current.flags&128)===128)}catch{}}var Hd=Math.clz32?Math.clz32:MQ,wQ=Math.log,SQ=Math.LN2;function MQ(i){return i>>>=0,i===0?32:31-(wQ(i)/SQ|0)|0}var jC=64,GC=4194304;function RT(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function dR(i,e){var t=i.pendingLanes;if(t===0)return 0;var r=0,n=i.suspendedLanes,l=i.pingedLanes,c=t&268435455;if(c!==0){var h=c&~n;h!==0?r=RT(h):(l&=c,l!==0&&(r=RT(l)))}else c=t&~n,c!==0?r=RT(c):l!==0&&(r=RT(l));if(r===0)return 0;if(e!==0&&e!==r&&!(e&n)&&(n=r&-r,l=e&-e,n>=l||n===16&&(l&4194240)!==0))return e;if(r&4&&(r|=t&16),e=i.entangledLanes,e!==0)for(i=i.entanglements,e&=r;0<e;)t=31-Hd(e),n=1<<t,r|=i[t],e&=~n;return r}function EQ(i,e){switch(i){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function TQ(i,e){for(var t=i.suspendedLanes,r=i.pingedLanes,n=i.expirationTimes,l=i.pendingLanes;0<l;){var c=31-Hd(l),h=1<<c,d=n[c];d===-1?(!(h&t)||h&r)&&(n[c]=EQ(h,e)):d<=e&&(i.expiredLanes|=h),l&=~h}}function yk(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function JG(){var i=jC;return jC<<=1,!(jC&4194240)&&(jC=64),i}function kL(i){for(var e=[],t=0;31>t;t++)e.push(i);return e}function fC(i,e,t){i.pendingLanes|=e,e!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,e=31-Hd(e),i[e]=t}function AQ(i,e){var t=i.pendingLanes&~e;i.pendingLanes=e,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=e,i.mutableReadLanes&=e,i.entangledLanes&=e,e=i.entanglements;var r=i.eventTimes;for(i=i.expirationTimes;0<t;){var n=31-Hd(t),l=1<<n;e[n]=0,r[n]=-1,i[n]=-1,t&=~l}}function X4(i,e){var t=i.entangledLanes|=e;for(i=i.entanglements;t;){var r=31-Hd(t),n=1<<r;n&e|i[r]&e&&(i[r]|=e),t&=~n}}var gn=0;function YG(i){return i&=-i,1<i?4<i?i&268435455?16:536870912:4:1}var KG,Z4,QG,e9,t9,_k=!1,qC=[],Lm=null,Om=null,Nm=null,cA=new Map,hA=new Map,Sm=[],CQ="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function JU(i,e){switch(i){case"focusin":case"focusout":Lm=null;break;case"dragenter":case"dragleave":Om=null;break;case"mouseover":case"mouseout":Nm=null;break;case"pointerover":case"pointerout":cA.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":hA.delete(e.pointerId)}}function NE(i,e,t,r,n,l){return i===null||i.nativeEvent!==l?(i={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:l,targetContainers:[n]},e!==null&&(e=mC(e),e!==null&&Z4(e)),i):(i.eventSystemFlags|=r,e=i.targetContainers,n!==null&&e.indexOf(n)===-1&&e.push(n),i)}function PQ(i,e,t,r,n){switch(e){case"focusin":return Lm=NE(Lm,i,e,t,r,n),!0;case"dragenter":return Om=NE(Om,i,e,t,r,n),!0;case"mouseover":return Nm=NE(Nm,i,e,t,r,n),!0;case"pointerover":var l=n.pointerId;return cA.set(l,NE(cA.get(l)||null,i,e,t,r,n)),!0;case"gotpointercapture":return l=n.pointerId,hA.set(l,NE(hA.get(l)||null,i,e,t,r,n)),!0}return!1}function i9(i){var e=C1(i.target);if(e!==null){var t=vw(e);if(t!==null){if(e=t.tag,e===13){if(e=WG(t),e!==null){i.blockedOn=e,t9(i.priority,function(){QG(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){i.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}i.blockedOn=null}function OP(i){if(i.blockedOn!==null)return!1;for(var e=i.targetContainers;0<e.length;){var t=xk(i.domEventName,i.eventSystemFlags,e[0],i.nativeEvent);if(t===null){t=i.nativeEvent;var r=new t.constructor(t.type,t);pk=r,t.target.dispatchEvent(r),pk=null}else return e=mC(t),e!==null&&Z4(e),i.blockedOn=t,!1;e.shift()}return!0}function YU(i,e,t){OP(i)&&t.delete(e)}function RQ(){_k=!1,Lm!==null&&OP(Lm)&&(Lm=null),Om!==null&&OP(Om)&&(Om=null),Nm!==null&&OP(Nm)&&(Nm=null),cA.forEach(YU),hA.forEach(YU)}function DE(i,e){i.blockedOn===e&&(i.blockedOn=null,_k||(_k=!0,Bu.unstable_scheduleCallback(Bu.unstable_NormalPriority,RQ)))}function dA(i){function e(n){return DE(n,i)}if(0<qC.length){DE(qC[0],i);for(var t=1;t<qC.length;t++){var r=qC[t];r.blockedOn===i&&(r.blockedOn=null)}}for(Lm!==null&&DE(Lm,i),Om!==null&&DE(Om,i),Nm!==null&&DE(Nm,i),cA.forEach(e),hA.forEach(e),t=0;t<Sm.length;t++)r=Sm[t],r.blockedOn===i&&(r.blockedOn=null);for(;0<Sm.length&&(t=Sm[0],t.blockedOn===null);)i9(t),t.blockedOn===null&&Sm.shift()}var cM=Fp.ReactCurrentBatchConfig,fR=!0;function IQ(i,e,t,r){var n=gn,l=cM.transition;cM.transition=null;try{gn=1,J4(i,e,t,r)}finally{gn=n,cM.transition=l}}function LQ(i,e,t,r){var n=gn,l=cM.transition;cM.transition=null;try{gn=4,J4(i,e,t,r)}finally{gn=n,cM.transition=l}}function J4(i,e,t,r){if(fR){var n=xk(i,e,t,r);if(n===null)GL(i,e,r,pR,t),JU(i,r);else if(PQ(n,i,e,t,r))r.stopPropagation();else if(JU(i,r),e&4&&-1<CQ.indexOf(i)){for(;n!==null;){var l=mC(n);if(l!==null&&KG(l),l=xk(i,e,t,r),l===null&&GL(i,e,r,pR,t),l===n)break;n=l}n!==null&&r.stopPropagation()}else GL(i,e,r,null,t)}}var pR=null;function xk(i,e,t,r){if(pR=null,i=G4(r),i=C1(i),i!==null)if(e=vw(i),e===null)i=null;else if(t=e.tag,t===13){if(i=WG(e),i!==null)return i;i=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;i=null}else e!==i&&(i=null);return pR=i,null}function r9(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(_Q()){case q4:return 1;case XG:return 4;case hR:case xQ:return 16;case ZG:return 536870912;default:return 16}default:return 16}}var Pm=null,Y4=null,NP=null;function n9(){if(NP)return NP;var i,e=Y4,t=e.length,r,n="value"in Pm?Pm.value:Pm.textContent,l=n.length;for(i=0;i<t&&e[i]===n[i];i++);var c=t-i;for(r=1;r<=c&&e[t-r]===n[l-r];r++);return NP=n.slice(i,1<r?1-r:void 0)}function DP(i){var e=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&e===13&&(i=13)):i=e,i===10&&(i=13),32<=i||i===13?i:0}function XC(){return!0}function KU(){return!1}function Hu(i){function e(t,r,n,l,c){this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=l,this.target=c,this.currentTarget=null;for(var h in i)i.hasOwnProperty(h)&&(t=i[h],this[h]=t?t(l):l[h]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?XC:KU,this.isPropagationStopped=KU,this}return gs(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=XC)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=XC)},persist:function(){},isPersistent:XC}),e}var rE={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},K4=Hu(rE),pC=gs({},rE,{view:0,detail:0}),OQ=Hu(pC),FL,zL,kE,MI=gs({},pC,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Q4,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==kE&&(kE&&i.type==="mousemove"?(FL=i.screenX-kE.screenX,zL=i.screenY-kE.screenY):zL=FL=0,kE=i),FL)},movementY:function(i){return"movementY"in i?i.movementY:zL}}),QU=Hu(MI),NQ=gs({},MI,{dataTransfer:0}),DQ=Hu(NQ),kQ=gs({},pC,{relatedTarget:0}),BL=Hu(kQ),FQ=gs({},rE,{animationName:0,elapsedTime:0,pseudoElement:0}),zQ=Hu(FQ),BQ=gs({},rE,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),UQ=Hu(BQ),HQ=gs({},rE,{data:0}),e5=Hu(HQ),$Q={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},VQ={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},WQ={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jQ(i){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(i):(i=WQ[i])?!!e[i]:!1}function Q4(){return jQ}var GQ=gs({},pC,{key:function(i){if(i.key){var e=$Q[i.key]||i.key;if(e!=="Unidentified")return e}return i.type==="keypress"?(i=DP(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?VQ[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Q4,charCode:function(i){return i.type==="keypress"?DP(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?DP(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),qQ=Hu(GQ),XQ=gs({},MI,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),t5=Hu(XQ),ZQ=gs({},pC,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Q4}),JQ=Hu(ZQ),YQ=gs({},rE,{propertyName:0,elapsedTime:0,pseudoElement:0}),KQ=Hu(YQ),QQ=gs({},MI,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),eee=Hu(QQ),tee=[9,13,27,32],ez=wp&&"CompositionEvent"in window,HT=null;wp&&"documentMode"in document&&(HT=document.documentMode);var iee=wp&&"TextEvent"in window&&!HT,s9=wp&&(!ez||HT&&8<HT&&11>=HT),i5=" ",r5=!1;function a9(i,e){switch(i){case"keyup":return tee.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function o9(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var US=!1;function ree(i,e){switch(i){case"compositionend":return o9(e);case"keypress":return e.which!==32?null:(r5=!0,i5);case"textInput":return i=e.data,i===i5&&r5?null:i;default:return null}}function nee(i,e){if(US)return i==="compositionend"||!ez&&a9(i,e)?(i=n9(),NP=Y4=Pm=null,US=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return s9&&e.locale!=="ko"?null:e.data;default:return null}}var see={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function n5(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e==="input"?!!see[i.type]:e==="textarea"}function l9(i,e,t,r){BG(r),e=mR(e,"onChange"),0<e.length&&(t=new K4("onChange","change",null,t,r),i.push({event:t,listeners:e}))}var $T=null,fA=null;function aee(i){_9(i,0)}function EI(i){var e=VS(i);if(LG(e))return i}function oee(i,e){if(i==="change")return e}var u9=!1;if(wp){var UL;if(wp){var HL="oninput"in document;if(!HL){var s5=document.createElement("div");s5.setAttribute("oninput","return;"),HL=typeof s5.oninput=="function"}UL=HL}else UL=!1;u9=UL&&(!document.documentMode||9<document.documentMode)}function a5(){$T&&($T.detachEvent("onpropertychange",c9),fA=$T=null)}function c9(i){if(i.propertyName==="value"&&EI(fA)){var e=[];l9(e,fA,i,G4(i)),VG(aee,e)}}function lee(i,e,t){i==="focusin"?(a5(),$T=e,fA=t,$T.attachEvent("onpropertychange",c9)):i==="focusout"&&a5()}function uee(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return EI(fA)}function cee(i,e){if(i==="click")return EI(e)}function hee(i,e){if(i==="input"||i==="change")return EI(e)}function dee(i,e){return i===e&&(i!==0||1/i===1/e)||i!==i&&e!==e}var qd=typeof Object.is=="function"?Object.is:dee;function pA(i,e){if(qd(i,e))return!0;if(typeof i!="object"||i===null||typeof e!="object"||e===null)return!1;var t=Object.keys(i),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var n=t[r];if(!ik.call(e,n)||!qd(i[n],e[n]))return!1}return!0}function o5(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function l5(i,e){var t=o5(i);i=0;for(var r;t;){if(t.nodeType===3){if(r=i+t.textContent.length,i<=e&&r>=e)return{node:t,offset:e-i};i=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=o5(t)}}function h9(i,e){return i&&e?i===e?!0:i&&i.nodeType===3?!1:e&&e.nodeType===3?h9(i,e.parentNode):"contains"in i?i.contains(e):i.compareDocumentPosition?!!(i.compareDocumentPosition(e)&16):!1:!1}function d9(){for(var i=window,e=lR();e instanceof i.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)i=e.contentWindow;else break;e=lR(i.document)}return e}function tz(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e&&(e==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||e==="textarea"||i.contentEditable==="true")}function fee(i){var e=d9(),t=i.focusedElem,r=i.selectionRange;if(e!==t&&t&&t.ownerDocument&&h9(t.ownerDocument.documentElement,t)){if(r!==null&&tz(t)){if(e=r.start,i=r.end,i===void 0&&(i=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(i,t.value.length);else if(i=(e=t.ownerDocument||document)&&e.defaultView||window,i.getSelection){i=i.getSelection();var n=t.textContent.length,l=Math.min(r.start,n);r=r.end===void 0?l:Math.min(r.end,n),!i.extend&&l>r&&(n=r,r=l,l=n),n=l5(t,l);var c=l5(t,r);n&&c&&(i.rangeCount!==1||i.anchorNode!==n.node||i.anchorOffset!==n.offset||i.focusNode!==c.node||i.focusOffset!==c.offset)&&(e=e.createRange(),e.setStart(n.node,n.offset),i.removeAllRanges(),l>r?(i.addRange(e),i.extend(c.node,c.offset)):(e.setEnd(c.node,c.offset),i.addRange(e)))}}for(e=[],i=t;i=i.parentNode;)i.nodeType===1&&e.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)i=e[t],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var pee=wp&&"documentMode"in document&&11>=document.documentMode,HS=null,bk=null,VT=null,wk=!1;function u5(i,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;wk||HS==null||HS!==lR(r)||(r=HS,"selectionStart"in r&&tz(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),VT&&pA(VT,r)||(VT=r,r=mR(bk,"onSelect"),0<r.length&&(e=new K4("onSelect","select",null,e,t),i.push({event:e,listeners:r}),e.target=HS)))}function ZC(i,e){var t={};return t[i.toLowerCase()]=e.toLowerCase(),t["Webkit"+i]="webkit"+e,t["Moz"+i]="moz"+e,t}var $S={animationend:ZC("Animation","AnimationEnd"),animationiteration:ZC("Animation","AnimationIteration"),animationstart:ZC("Animation","AnimationStart"),transitionend:ZC("Transition","TransitionEnd")},$L={},f9={};wp&&(f9=document.createElement("div").style,"AnimationEvent"in window||(delete $S.animationend.animation,delete $S.animationiteration.animation,delete $S.animationstart.animation),"TransitionEvent"in window||delete $S.transitionend.transition);function TI(i){if($L[i])return $L[i];if(!$S[i])return i;var e=$S[i],t;for(t in e)if(e.hasOwnProperty(t)&&t in f9)return $L[i]=e[t];return i}var p9=TI("animationend"),m9=TI("animationiteration"),g9=TI("animationstart"),v9=TI("transitionend"),y9=new Map,c5="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ig(i,e){y9.set(i,e),gw(e,[i])}for(var VL=0;VL<c5.length;VL++){var WL=c5[VL],mee=WL.toLowerCase(),gee=WL[0].toUpperCase()+WL.slice(1);ig(mee,"on"+gee)}ig(p9,"onAnimationEnd");ig(m9,"onAnimationIteration");ig(g9,"onAnimationStart");ig("dblclick","onDoubleClick");ig("focusin","onFocus");ig("focusout","onBlur");ig(v9,"onTransitionEnd");AM("onMouseEnter",["mouseout","mouseover"]);AM("onMouseLeave",["mouseout","mouseover"]);AM("onPointerEnter",["pointerout","pointerover"]);AM("onPointerLeave",["pointerout","pointerover"]);gw("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));gw("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));gw("onBeforeInput",["compositionend","keypress","textInput","paste"]);gw("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));gw("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));gw("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var IT="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),vee=new Set("cancel close invalid load scroll toggle".split(" ").concat(IT));function h5(i,e,t){var r=i.type||"unknown-event";i.currentTarget=t,mQ(r,e,void 0,i),i.currentTarget=null}function _9(i,e){e=(e&4)!==0;for(var t=0;t<i.length;t++){var r=i[t],n=r.event;r=r.listeners;e:{var l=void 0;if(e)for(var c=r.length-1;0<=c;c--){var h=r[c],d=h.instance,f=h.currentTarget;if(h=h.listener,d!==l&&n.isPropagationStopped())break e;h5(n,h,f),l=d}else for(c=0;c<r.length;c++){if(h=r[c],d=h.instance,f=h.currentTarget,h=h.listener,d!==l&&n.isPropagationStopped())break e;h5(n,h,f),l=d}}}if(cR)throw i=vk,cR=!1,vk=null,i}function Un(i,e){var t=e[Ak];t===void 0&&(t=e[Ak]=new Set);var r=i+"__bubble";t.has(r)||(x9(e,i,2,!1),t.add(r))}function jL(i,e,t){var r=0;e&&(r|=4),x9(t,i,r,e)}var JC="_reactListening"+Math.random().toString(36).slice(2);function mA(i){if(!i[JC]){i[JC]=!0,AG.forEach(function(t){t!=="selectionchange"&&(vee.has(t)||jL(t,!1,i),jL(t,!0,i))});var e=i.nodeType===9?i:i.ownerDocument;e===null||e[JC]||(e[JC]=!0,jL("selectionchange",!1,e))}}function x9(i,e,t,r){switch(r9(e)){case 1:var n=IQ;break;case 4:n=LQ;break;default:n=J4}t=n.bind(null,e,t,i),n=void 0,!gk||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(n=!0),r?n!==void 0?i.addEventListener(e,t,{capture:!0,passive:n}):i.addEventListener(e,t,!0):n!==void 0?i.addEventListener(e,t,{passive:n}):i.addEventListener(e,t,!1)}function GL(i,e,t,r,n){var l=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var c=r.tag;if(c===3||c===4){var h=r.stateNode.containerInfo;if(h===n||h.nodeType===8&&h.parentNode===n)break;if(c===4)for(c=r.return;c!==null;){var d=c.tag;if((d===3||d===4)&&(d=c.stateNode.containerInfo,d===n||d.nodeType===8&&d.parentNode===n))return;c=c.return}for(;h!==null;){if(c=C1(h),c===null)return;if(d=c.tag,d===5||d===6){r=l=c;continue e}h=h.parentNode}}r=r.return}VG(function(){var f=l,m=G4(t),g=[];e:{var y=y9.get(i);if(y!==void 0){var _=K4,b=i;switch(i){case"keypress":if(DP(t)===0)break e;case"keydown":case"keyup":_=qQ;break;case"focusin":b="focus",_=BL;break;case"focusout":b="blur",_=BL;break;case"beforeblur":case"afterblur":_=BL;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=QU;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=DQ;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=JQ;break;case p9:case m9:case g9:_=zQ;break;case v9:_=KQ;break;case"scroll":_=OQ;break;case"wheel":_=eee;break;case"copy":case"cut":case"paste":_=UQ;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=t5}var S=(e&4)!==0,E=!S&&i==="scroll",T=S?y!==null?y+"Capture":null:y;S=[];for(var A=f,P;A!==null;){P=A;var O=P.stateNode;if(P.tag===5&&O!==null&&(P=O,T!==null&&(O=uA(A,T),O!=null&&S.push(gA(A,O,P)))),E)break;A=A.return}0<S.length&&(y=new _(y,b,null,t,m),g.push({event:y,listeners:S}))}}if(!(e&7)){e:{if(y=i==="mouseover"||i==="pointerover",_=i==="mouseout"||i==="pointerout",y&&t!==pk&&(b=t.relatedTarget||t.fromElement)&&(C1(b)||b[Sp]))break e;if((_||y)&&(y=m.window===m?m:(y=m.ownerDocument)?y.defaultView||y.parentWindow:window,_?(b=t.relatedTarget||t.toElement,_=f,b=b?C1(b):null,b!==null&&(E=vw(b),b!==E||b.tag!==5&&b.tag!==6)&&(b=null)):(_=null,b=f),_!==b)){if(S=QU,O="onMouseLeave",T="onMouseEnter",A="mouse",(i==="pointerout"||i==="pointerover")&&(S=t5,O="onPointerLeave",T="onPointerEnter",A="pointer"),E=_==null?y:VS(_),P=b==null?y:VS(b),y=new S(O,A+"leave",_,t,m),y.target=E,y.relatedTarget=P,O=null,C1(m)===f&&(S=new S(T,A+"enter",b,t,m),S.target=P,S.relatedTarget=E,O=S),E=O,_&&b)t:{for(S=_,T=b,A=0,P=S;P;P=Ew(P))A++;for(P=0,O=T;O;O=Ew(O))P++;for(;0<A-P;)S=Ew(S),A--;for(;0<P-A;)T=Ew(T),P--;for(;A--;){if(S===T||T!==null&&S===T.alternate)break t;S=Ew(S),T=Ew(T)}S=null}else S=null;_!==null&&d5(g,y,_,S,!1),b!==null&&E!==null&&d5(g,E,b,S,!0)}}e:{if(y=f?VS(f):window,_=y.nodeName&&y.nodeName.toLowerCase(),_==="select"||_==="input"&&y.type==="file")var R=oee;else if(n5(y))if(u9)R=hee;else{R=uee;var D=lee}else(_=y.nodeName)&&_.toLowerCase()==="input"&&(y.type==="checkbox"||y.type==="radio")&&(R=cee);if(R&&(R=R(i,f))){l9(g,R,t,m);break e}D&&D(i,y,f),i==="focusout"&&(D=y._wrapperState)&&D.controlled&&y.type==="number"&&uk(y,"number",y.value)}switch(D=f?VS(f):window,i){case"focusin":(n5(D)||D.contentEditable==="true")&&(HS=D,bk=f,VT=null);break;case"focusout":VT=bk=HS=null;break;case"mousedown":wk=!0;break;case"contextmenu":case"mouseup":case"dragend":wk=!1,u5(g,t,m);break;case"selectionchange":if(pee)break;case"keydown":case"keyup":u5(g,t,m)}var L;if(ez)e:{switch(i){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else US?a9(i,t)&&(N="onCompositionEnd"):i==="keydown"&&t.keyCode===229&&(N="onCompositionStart");N&&(s9&&t.locale!=="ko"&&(US||N!=="onCompositionStart"?N==="onCompositionEnd"&&US&&(L=n9()):(Pm=m,Y4="value"in Pm?Pm.value:Pm.textContent,US=!0)),D=mR(f,N),0<D.length&&(N=new e5(N,i,null,t,m),g.push({event:N,listeners:D}),L?N.data=L:(L=o9(t),L!==null&&(N.data=L)))),(L=iee?ree(i,t):nee(i,t))&&(f=mR(f,"onBeforeInput"),0<f.length&&(m=new e5("onBeforeInput","beforeinput",null,t,m),g.push({event:m,listeners:f}),m.data=L))}_9(g,e)})}function gA(i,e,t){return{instance:i,listener:e,currentTarget:t}}function mR(i,e){for(var t=e+"Capture",r=[];i!==null;){var n=i,l=n.stateNode;n.tag===5&&l!==null&&(n=l,l=uA(i,t),l!=null&&r.unshift(gA(i,l,n)),l=uA(i,e),l!=null&&r.push(gA(i,l,n))),i=i.return}return r}function Ew(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function d5(i,e,t,r,n){for(var l=e._reactName,c=[];t!==null&&t!==r;){var h=t,d=h.alternate,f=h.stateNode;if(d!==null&&d===r)break;h.tag===5&&f!==null&&(h=f,n?(d=uA(t,l),d!=null&&c.unshift(gA(t,d,h))):n||(d=uA(t,l),d!=null&&c.push(gA(t,d,h)))),t=t.return}c.length!==0&&i.push({event:e,listeners:c})}var yee=/\r\n?/g,_ee=/\u0000|\uFFFD/g;function f5(i){return(typeof i=="string"?i:""+i).replace(yee,`
`).replace(_ee,"")}function YC(i,e,t){if(e=f5(e),f5(i)!==e&&t)throw Error(Et(425))}function gR(){}var Sk=null,Mk=null;function Ek(i,e){return i==="textarea"||i==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Tk=typeof setTimeout=="function"?setTimeout:void 0,xee=typeof clearTimeout=="function"?clearTimeout:void 0,p5=typeof Promise=="function"?Promise:void 0,bee=typeof queueMicrotask=="function"?queueMicrotask:typeof p5<"u"?function(i){return p5.resolve(null).then(i).catch(wee)}:Tk;function wee(i){setTimeout(function(){throw i})}function qL(i,e){var t=e,r=0;do{var n=t.nextSibling;if(i.removeChild(t),n&&n.nodeType===8)if(t=n.data,t==="/$"){if(r===0){i.removeChild(n),dA(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=n}while(t);dA(e)}function Dm(i){for(;i!=null;i=i.nextSibling){var e=i.nodeType;if(e===1||e===3)break;if(e===8){if(e=i.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return i}function m5(i){i=i.previousSibling;for(var e=0;i;){if(i.nodeType===8){var t=i.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return i;e--}else t==="/$"&&e++}i=i.previousSibling}return null}var nE=Math.random().toString(36).slice(2),ff="__reactFiber$"+nE,vA="__reactProps$"+nE,Sp="__reactContainer$"+nE,Ak="__reactEvents$"+nE,See="__reactListeners$"+nE,Mee="__reactHandles$"+nE;function C1(i){var e=i[ff];if(e)return e;for(var t=i.parentNode;t;){if(e=t[Sp]||t[ff]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(i=m5(i);i!==null;){if(t=i[ff])return t;i=m5(i)}return e}i=t,t=i.parentNode}return null}function mC(i){return i=i[ff]||i[Sp],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function VS(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(Et(33))}function AI(i){return i[vA]||null}var Ck=[],WS=-1;function rg(i){return{current:i}}function Hn(i){0>WS||(i.current=Ck[WS],Ck[WS]=null,WS--)}function zn(i,e){WS++,Ck[WS]=i.current,i.current=e}var Zm={},To=rg(Zm),hu=rg(!1),K1=Zm;function CM(i,e){var t=i.type.contextTypes;if(!t)return Zm;var r=i.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var n={},l;for(l in t)n[l]=e[l];return r&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=e,i.__reactInternalMemoizedMaskedChildContext=n),n}function du(i){return i=i.childContextTypes,i!=null}function vR(){Hn(hu),Hn(To)}function g5(i,e,t){if(To.current!==Zm)throw Error(Et(168));zn(To,e),zn(hu,t)}function b9(i,e,t){var r=i.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var n in r)if(!(n in e))throw Error(Et(108,lQ(i)||"Unknown",n));return gs({},t,r)}function yR(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Zm,K1=To.current,zn(To,i),zn(hu,hu.current),!0}function v5(i,e,t){var r=i.stateNode;if(!r)throw Error(Et(169));t?(i=b9(i,e,K1),r.__reactInternalMemoizedMergedChildContext=i,Hn(hu),Hn(To),zn(To,i)):Hn(hu),zn(hu,t)}var up=null,CI=!1,XL=!1;function w9(i){up===null?up=[i]:up.push(i)}function Eee(i){CI=!0,w9(i)}function ng(){if(!XL&&up!==null){XL=!0;var i=0,e=gn;try{var t=up;for(gn=1;i<t.length;i++){var r=t[i];do r=r(!0);while(r!==null)}up=null,CI=!1}catch(n){throw up!==null&&(up=up.slice(i+1)),qG(q4,ng),n}finally{gn=e,XL=!1}}return null}var jS=[],GS=0,_R=null,xR=0,Yu=[],Ku=0,Q1=null,dp=1,fp="";function x1(i,e){jS[GS++]=xR,jS[GS++]=_R,_R=i,xR=e}function S9(i,e,t){Yu[Ku++]=dp,Yu[Ku++]=fp,Yu[Ku++]=Q1,Q1=i;var r=dp;i=fp;var n=32-Hd(r)-1;r&=~(1<<n),t+=1;var l=32-Hd(e)+n;if(30<l){var c=n-n%5;l=(r&(1<<c)-1).toString(32),r>>=c,n-=c,dp=1<<32-Hd(e)+n|t<<n|r,fp=l+i}else dp=1<<l|t<<n|r,fp=i}function iz(i){i.return!==null&&(x1(i,1),S9(i,1,0))}function rz(i){for(;i===_R;)_R=jS[--GS],jS[GS]=null,xR=jS[--GS],jS[GS]=null;for(;i===Q1;)Q1=Yu[--Ku],Yu[Ku]=null,fp=Yu[--Ku],Yu[Ku]=null,dp=Yu[--Ku],Yu[Ku]=null}var Ou=null,Lu=null,Xn=!1,kd=null;function M9(i,e){var t=tc(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=i,e=i.deletions,e===null?(i.deletions=[t],i.flags|=16):e.push(t)}function y5(i,e){switch(i.tag){case 5:var t=i.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(i.stateNode=e,Ou=i,Lu=Dm(e.firstChild),!0):!1;case 6:return e=i.pendingProps===""||e.nodeType!==3?null:e,e!==null?(i.stateNode=e,Ou=i,Lu=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Q1!==null?{id:dp,overflow:fp}:null,i.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=tc(18,null,null,0),t.stateNode=e,t.return=i,i.child=t,Ou=i,Lu=null,!0):!1;default:return!1}}function Pk(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Rk(i){if(Xn){var e=Lu;if(e){var t=e;if(!y5(i,e)){if(Pk(i))throw Error(Et(418));e=Dm(t.nextSibling);var r=Ou;e&&y5(i,e)?M9(r,t):(i.flags=i.flags&-4097|2,Xn=!1,Ou=i)}}else{if(Pk(i))throw Error(Et(418));i.flags=i.flags&-4097|2,Xn=!1,Ou=i}}}function _5(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;Ou=i}function KC(i){if(i!==Ou)return!1;if(!Xn)return _5(i),Xn=!0,!1;var e;if((e=i.tag!==3)&&!(e=i.tag!==5)&&(e=i.type,e=e!=="head"&&e!=="body"&&!Ek(i.type,i.memoizedProps)),e&&(e=Lu)){if(Pk(i))throw E9(),Error(Et(418));for(;e;)M9(i,e),e=Dm(e.nextSibling)}if(_5(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Et(317));e:{for(i=i.nextSibling,e=0;i;){if(i.nodeType===8){var t=i.data;if(t==="/$"){if(e===0){Lu=Dm(i.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}i=i.nextSibling}Lu=null}}else Lu=Ou?Dm(i.stateNode.nextSibling):null;return!0}function E9(){for(var i=Lu;i;)i=Dm(i.nextSibling)}function PM(){Lu=Ou=null,Xn=!1}function nz(i){kd===null?kd=[i]:kd.push(i)}var Tee=Fp.ReactCurrentBatchConfig;function Od(i,e){if(i&&i.defaultProps){e=gs({},e),i=i.defaultProps;for(var t in i)e[t]===void 0&&(e[t]=i[t]);return e}return e}var bR=rg(null),wR=null,qS=null,sz=null;function az(){sz=qS=wR=null}function oz(i){var e=bR.current;Hn(bR),i._currentValue=e}function Ik(i,e,t){for(;i!==null;){var r=i.alternate;if((i.childLanes&e)!==e?(i.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),i===t)break;i=i.return}}function hM(i,e){wR=i,sz=qS=null,i=i.dependencies,i!==null&&i.firstContext!==null&&(i.lanes&e&&(uu=!0),i.firstContext=null)}function ac(i){var e=i._currentValue;if(sz!==i)if(i={context:i,memoizedValue:e,next:null},qS===null){if(wR===null)throw Error(Et(308));qS=i,wR.dependencies={lanes:0,firstContext:i}}else qS=qS.next=i;return e}var P1=null;function lz(i){P1===null?P1=[i]:P1.push(i)}function T9(i,e,t,r){var n=e.interleaved;return n===null?(t.next=t,lz(e)):(t.next=n.next,n.next=t),e.interleaved=t,Mp(i,r)}function Mp(i,e){i.lanes|=e;var t=i.alternate;for(t!==null&&(t.lanes|=e),t=i,i=i.return;i!==null;)i.childLanes|=e,t=i.alternate,t!==null&&(t.childLanes|=e),t=i,i=i.return;return t.tag===3?t.stateNode:null}var ym=!1;function uz(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function A9(i,e){i=i.updateQueue,e.updateQueue===i&&(e.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function gp(i,e){return{eventTime:i,lane:e,tag:0,payload:null,callback:null,next:null}}function km(i,e,t){var r=i.updateQueue;if(r===null)return null;if(r=r.shared,Jr&2){var n=r.pending;return n===null?e.next=e:(e.next=n.next,n.next=e),r.pending=e,Mp(i,t)}return n=r.interleaved,n===null?(e.next=e,lz(r)):(e.next=n.next,n.next=e),r.interleaved=e,Mp(i,t)}function kP(i,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=i.pendingLanes,t|=r,e.lanes=t,X4(i,t)}}function x5(i,e){var t=i.updateQueue,r=i.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var n=null,l=null;if(t=t.firstBaseUpdate,t!==null){do{var c={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};l===null?n=l=c:l=l.next=c,t=t.next}while(t!==null);l===null?n=l=e:l=l.next=e}else n=l=e;t={baseState:r.baseState,firstBaseUpdate:n,lastBaseUpdate:l,shared:r.shared,effects:r.effects},i.updateQueue=t;return}i=t.lastBaseUpdate,i===null?t.firstBaseUpdate=e:i.next=e,t.lastBaseUpdate=e}function SR(i,e,t,r){var n=i.updateQueue;ym=!1;var l=n.firstBaseUpdate,c=n.lastBaseUpdate,h=n.shared.pending;if(h!==null){n.shared.pending=null;var d=h,f=d.next;d.next=null,c===null?l=f:c.next=f,c=d;var m=i.alternate;m!==null&&(m=m.updateQueue,h=m.lastBaseUpdate,h!==c&&(h===null?m.firstBaseUpdate=f:h.next=f,m.lastBaseUpdate=d))}if(l!==null){var g=n.baseState;c=0,m=f=d=null,h=l;do{var y=h.lane,_=h.eventTime;if((r&y)===y){m!==null&&(m=m.next={eventTime:_,lane:0,tag:h.tag,payload:h.payload,callback:h.callback,next:null});e:{var b=i,S=h;switch(y=e,_=t,S.tag){case 1:if(b=S.payload,typeof b=="function"){g=b.call(_,g,y);break e}g=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=S.payload,y=typeof b=="function"?b.call(_,g,y):b,y==null)break e;g=gs({},g,y);break e;case 2:ym=!0}}h.callback!==null&&h.lane!==0&&(i.flags|=64,y=n.effects,y===null?n.effects=[h]:y.push(h))}else _={eventTime:_,lane:y,tag:h.tag,payload:h.payload,callback:h.callback,next:null},m===null?(f=m=_,d=g):m=m.next=_,c|=y;if(h=h.next,h===null){if(h=n.shared.pending,h===null)break;y=h,h=y.next,y.next=null,n.lastBaseUpdate=y,n.shared.pending=null}}while(!0);if(m===null&&(d=g),n.baseState=d,n.firstBaseUpdate=f,n.lastBaseUpdate=m,e=n.shared.interleaved,e!==null){n=e;do c|=n.lane,n=n.next;while(n!==e)}else l===null&&(n.shared.lanes=0);tw|=c,i.lanes=c,i.memoizedState=g}}function b5(i,e,t){if(i=e.effects,e.effects=null,i!==null)for(e=0;e<i.length;e++){var r=i[e],n=r.callback;if(n!==null){if(r.callback=null,r=t,typeof n!="function")throw Error(Et(191,n));n.call(r)}}}var C9=new TG.Component().refs;function Lk(i,e,t,r){e=i.memoizedState,t=t(r,e),t=t==null?e:gs({},e,t),i.memoizedState=t,i.lanes===0&&(i.updateQueue.baseState=t)}var PI={isMounted:function(i){return(i=i._reactInternals)?vw(i)===i:!1},enqueueSetState:function(i,e,t){i=i._reactInternals;var r=ql(),n=zm(i),l=gp(r,n);l.payload=e,t!=null&&(l.callback=t),e=km(i,l,n),e!==null&&($d(e,i,n,r),kP(e,i,n))},enqueueReplaceState:function(i,e,t){i=i._reactInternals;var r=ql(),n=zm(i),l=gp(r,n);l.tag=1,l.payload=e,t!=null&&(l.callback=t),e=km(i,l,n),e!==null&&($d(e,i,n,r),kP(e,i,n))},enqueueForceUpdate:function(i,e){i=i._reactInternals;var t=ql(),r=zm(i),n=gp(t,r);n.tag=2,e!=null&&(n.callback=e),e=km(i,n,r),e!==null&&($d(e,i,r,t),kP(e,i,r))}};function w5(i,e,t,r,n,l,c){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(r,l,c):e.prototype&&e.prototype.isPureReactComponent?!pA(t,r)||!pA(n,l):!0}function P9(i,e,t){var r=!1,n=Zm,l=e.contextType;return typeof l=="object"&&l!==null?l=ac(l):(n=du(e)?K1:To.current,r=e.contextTypes,l=(r=r!=null)?CM(i,n):Zm),e=new e(t,l),i.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=PI,i.stateNode=e,e._reactInternals=i,r&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=n,i.__reactInternalMemoizedMaskedChildContext=l),e}function S5(i,e,t,r){i=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==i&&PI.enqueueReplaceState(e,e.state,null)}function Ok(i,e,t,r){var n=i.stateNode;n.props=t,n.state=i.memoizedState,n.refs=C9,uz(i);var l=e.contextType;typeof l=="object"&&l!==null?n.context=ac(l):(l=du(e)?K1:To.current,n.context=CM(i,l)),n.state=i.memoizedState,l=e.getDerivedStateFromProps,typeof l=="function"&&(Lk(i,e,l,t),n.state=i.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(e=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),e!==n.state&&PI.enqueueReplaceState(n,n.state,null),SR(i,t,n,r),n.state=i.memoizedState),typeof n.componentDidMount=="function"&&(i.flags|=4194308)}function FE(i,e,t){if(i=t.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(Et(309));var r=t.stateNode}if(!r)throw Error(Et(147,i));var n=r,l=""+i;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===l?e.ref:(e=function(c){var h=n.refs;h===C9&&(h=n.refs={}),c===null?delete h[l]:h[l]=c},e._stringRef=l,e)}if(typeof i!="string")throw Error(Et(284));if(!t._owner)throw Error(Et(290,i))}return i}function QC(i,e){throw i=Object.prototype.toString.call(e),Error(Et(31,i==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":i))}function M5(i){var e=i._init;return e(i._payload)}function R9(i){function e(T,A){if(i){var P=T.deletions;P===null?(T.deletions=[A],T.flags|=16):P.push(A)}}function t(T,A){if(!i)return null;for(;A!==null;)e(T,A),A=A.sibling;return null}function r(T,A){for(T=new Map;A!==null;)A.key!==null?T.set(A.key,A):T.set(A.index,A),A=A.sibling;return T}function n(T,A){return T=Bm(T,A),T.index=0,T.sibling=null,T}function l(T,A,P){return T.index=P,i?(P=T.alternate,P!==null?(P=P.index,P<A?(T.flags|=2,A):P):(T.flags|=2,A)):(T.flags|=1048576,A)}function c(T){return i&&T.alternate===null&&(T.flags|=2),T}function h(T,A,P,O){return A===null||A.tag!==6?(A=tO(P,T.mode,O),A.return=T,A):(A=n(A,P),A.return=T,A)}function d(T,A,P,O){var R=P.type;return R===BS?m(T,A,P.props.children,O,P.key):A!==null&&(A.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===vm&&M5(R)===A.type)?(O=n(A,P.props),O.ref=FE(T,A,P),O.return=T,O):(O=$P(P.type,P.key,P.props,null,T.mode,O),O.ref=FE(T,A,P),O.return=T,O)}function f(T,A,P,O){return A===null||A.tag!==4||A.stateNode.containerInfo!==P.containerInfo||A.stateNode.implementation!==P.implementation?(A=iO(P,T.mode,O),A.return=T,A):(A=n(A,P.children||[]),A.return=T,A)}function m(T,A,P,O,R){return A===null||A.tag!==7?(A=$1(P,T.mode,O,R),A.return=T,A):(A=n(A,P),A.return=T,A)}function g(T,A,P){if(typeof A=="string"&&A!==""||typeof A=="number")return A=tO(""+A,T.mode,P),A.return=T,A;if(typeof A=="object"&&A!==null){switch(A.$$typeof){case $C:return P=$P(A.type,A.key,A.props,null,T.mode,P),P.ref=FE(T,null,A),P.return=T,P;case zS:return A=iO(A,T.mode,P),A.return=T,A;case vm:var O=A._init;return g(T,O(A._payload),P)}if(PT(A)||LE(A))return A=$1(A,T.mode,P,null),A.return=T,A;QC(T,A)}return null}function y(T,A,P,O){var R=A!==null?A.key:null;if(typeof P=="string"&&P!==""||typeof P=="number")return R!==null?null:h(T,A,""+P,O);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case $C:return P.key===R?d(T,A,P,O):null;case zS:return P.key===R?f(T,A,P,O):null;case vm:return R=P._init,y(T,A,R(P._payload),O)}if(PT(P)||LE(P))return R!==null?null:m(T,A,P,O,null);QC(T,P)}return null}function _(T,A,P,O,R){if(typeof O=="string"&&O!==""||typeof O=="number")return T=T.get(P)||null,h(A,T,""+O,R);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case $C:return T=T.get(O.key===null?P:O.key)||null,d(A,T,O,R);case zS:return T=T.get(O.key===null?P:O.key)||null,f(A,T,O,R);case vm:var D=O._init;return _(T,A,P,D(O._payload),R)}if(PT(O)||LE(O))return T=T.get(P)||null,m(A,T,O,R,null);QC(A,O)}return null}function b(T,A,P,O){for(var R=null,D=null,L=A,N=A=0,U=null;L!==null&&N<P.length;N++){L.index>N?(U=L,L=null):U=L.sibling;var F=y(T,L,P[N],O);if(F===null){L===null&&(L=U);break}i&&L&&F.alternate===null&&e(T,L),A=l(F,A,N),D===null?R=F:D.sibling=F,D=F,L=U}if(N===P.length)return t(T,L),Xn&&x1(T,N),R;if(L===null){for(;N<P.length;N++)L=g(T,P[N],O),L!==null&&(A=l(L,A,N),D===null?R=L:D.sibling=L,D=L);return Xn&&x1(T,N),R}for(L=r(T,L);N<P.length;N++)U=_(L,T,N,P[N],O),U!==null&&(i&&U.alternate!==null&&L.delete(U.key===null?N:U.key),A=l(U,A,N),D===null?R=U:D.sibling=U,D=U);return i&&L.forEach(function(z){return e(T,z)}),Xn&&x1(T,N),R}function S(T,A,P,O){var R=LE(P);if(typeof R!="function")throw Error(Et(150));if(P=R.call(P),P==null)throw Error(Et(151));for(var D=R=null,L=A,N=A=0,U=null,F=P.next();L!==null&&!F.done;N++,F=P.next()){L.index>N?(U=L,L=null):U=L.sibling;var z=y(T,L,F.value,O);if(z===null){L===null&&(L=U);break}i&&L&&z.alternate===null&&e(T,L),A=l(z,A,N),D===null?R=z:D.sibling=z,D=z,L=U}if(F.done)return t(T,L),Xn&&x1(T,N),R;if(L===null){for(;!F.done;N++,F=P.next())F=g(T,F.value,O),F!==null&&(A=l(F,A,N),D===null?R=F:D.sibling=F,D=F);return Xn&&x1(T,N),R}for(L=r(T,L);!F.done;N++,F=P.next())F=_(L,T,N,F.value,O),F!==null&&(i&&F.alternate!==null&&L.delete(F.key===null?N:F.key),A=l(F,A,N),D===null?R=F:D.sibling=F,D=F);return i&&L.forEach(function(G){return e(T,G)}),Xn&&x1(T,N),R}function E(T,A,P,O){if(typeof P=="object"&&P!==null&&P.type===BS&&P.key===null&&(P=P.props.children),typeof P=="object"&&P!==null){switch(P.$$typeof){case $C:e:{for(var R=P.key,D=A;D!==null;){if(D.key===R){if(R=P.type,R===BS){if(D.tag===7){t(T,D.sibling),A=n(D,P.props.children),A.return=T,T=A;break e}}else if(D.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===vm&&M5(R)===D.type){t(T,D.sibling),A=n(D,P.props),A.ref=FE(T,D,P),A.return=T,T=A;break e}t(T,D);break}else e(T,D);D=D.sibling}P.type===BS?(A=$1(P.props.children,T.mode,O,P.key),A.return=T,T=A):(O=$P(P.type,P.key,P.props,null,T.mode,O),O.ref=FE(T,A,P),O.return=T,T=O)}return c(T);case zS:e:{for(D=P.key;A!==null;){if(A.key===D)if(A.tag===4&&A.stateNode.containerInfo===P.containerInfo&&A.stateNode.implementation===P.implementation){t(T,A.sibling),A=n(A,P.children||[]),A.return=T,T=A;break e}else{t(T,A);break}else e(T,A);A=A.sibling}A=iO(P,T.mode,O),A.return=T,T=A}return c(T);case vm:return D=P._init,E(T,A,D(P._payload),O)}if(PT(P))return b(T,A,P,O);if(LE(P))return S(T,A,P,O);QC(T,P)}return typeof P=="string"&&P!==""||typeof P=="number"?(P=""+P,A!==null&&A.tag===6?(t(T,A.sibling),A=n(A,P),A.return=T,T=A):(t(T,A),A=tO(P,T.mode,O),A.return=T,T=A),c(T)):t(T,A)}return E}var RM=R9(!0),I9=R9(!1),gC={},_f=rg(gC),yA=rg(gC),_A=rg(gC);function R1(i){if(i===gC)throw Error(Et(174));return i}function cz(i,e){switch(zn(_A,e),zn(yA,i),zn(_f,gC),i=e.nodeType,i){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:hk(null,"");break;default:i=i===8?e.parentNode:e,e=i.namespaceURI||null,i=i.tagName,e=hk(e,i)}Hn(_f),zn(_f,e)}function IM(){Hn(_f),Hn(yA),Hn(_A)}function L9(i){R1(_A.current);var e=R1(_f.current),t=hk(e,i.type);e!==t&&(zn(yA,i),zn(_f,t))}function hz(i){yA.current===i&&(Hn(_f),Hn(yA))}var fs=rg(0);function MR(i){for(var e=i;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ZL=[];function dz(){for(var i=0;i<ZL.length;i++)ZL[i]._workInProgressVersionPrimary=null;ZL.length=0}var FP=Fp.ReactCurrentDispatcher,JL=Fp.ReactCurrentBatchConfig,ew=0,ms=null,Ra=null,ja=null,ER=!1,WT=!1,xA=0,Aee=0;function fo(){throw Error(Et(321))}function fz(i,e){if(e===null)return!1;for(var t=0;t<e.length&&t<i.length;t++)if(!qd(i[t],e[t]))return!1;return!0}function pz(i,e,t,r,n,l){if(ew=l,ms=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,FP.current=i===null||i.memoizedState===null?Iee:Lee,i=t(r,n),WT){l=0;do{if(WT=!1,xA=0,25<=l)throw Error(Et(301));l+=1,ja=Ra=null,e.updateQueue=null,FP.current=Oee,i=t(r,n)}while(WT)}if(FP.current=TR,e=Ra!==null&&Ra.next!==null,ew=0,ja=Ra=ms=null,ER=!1,e)throw Error(Et(300));return i}function mz(){var i=xA!==0;return xA=0,i}function cf(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ja===null?ms.memoizedState=ja=i:ja=ja.next=i,ja}function oc(){if(Ra===null){var i=ms.alternate;i=i!==null?i.memoizedState:null}else i=Ra.next;var e=ja===null?ms.memoizedState:ja.next;if(e!==null)ja=e,Ra=i;else{if(i===null)throw Error(Et(310));Ra=i,i={memoizedState:Ra.memoizedState,baseState:Ra.baseState,baseQueue:Ra.baseQueue,queue:Ra.queue,next:null},ja===null?ms.memoizedState=ja=i:ja=ja.next=i}return ja}function bA(i,e){return typeof e=="function"?e(i):e}function YL(i){var e=oc(),t=e.queue;if(t===null)throw Error(Et(311));t.lastRenderedReducer=i;var r=Ra,n=r.baseQueue,l=t.pending;if(l!==null){if(n!==null){var c=n.next;n.next=l.next,l.next=c}r.baseQueue=n=l,t.pending=null}if(n!==null){l=n.next,r=r.baseState;var h=c=null,d=null,f=l;do{var m=f.lane;if((ew&m)===m)d!==null&&(d=d.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),r=f.hasEagerState?f.eagerState:i(r,f.action);else{var g={lane:m,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};d===null?(h=d=g,c=r):d=d.next=g,ms.lanes|=m,tw|=m}f=f.next}while(f!==null&&f!==l);d===null?c=r:d.next=h,qd(r,e.memoizedState)||(uu=!0),e.memoizedState=r,e.baseState=c,e.baseQueue=d,t.lastRenderedState=r}if(i=t.interleaved,i!==null){n=i;do l=n.lane,ms.lanes|=l,tw|=l,n=n.next;while(n!==i)}else n===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function KL(i){var e=oc(),t=e.queue;if(t===null)throw Error(Et(311));t.lastRenderedReducer=i;var r=t.dispatch,n=t.pending,l=e.memoizedState;if(n!==null){t.pending=null;var c=n=n.next;do l=i(l,c.action),c=c.next;while(c!==n);qd(l,e.memoizedState)||(uu=!0),e.memoizedState=l,e.baseQueue===null&&(e.baseState=l),t.lastRenderedState=l}return[l,r]}function O9(){}function N9(i,e){var t=ms,r=oc(),n=e(),l=!qd(r.memoizedState,n);if(l&&(r.memoizedState=n,uu=!0),r=r.queue,gz(F9.bind(null,t,r,i),[i]),r.getSnapshot!==e||l||ja!==null&&ja.memoizedState.tag&1){if(t.flags|=2048,wA(9,k9.bind(null,t,r,n,e),void 0,null),Za===null)throw Error(Et(349));ew&30||D9(t,e,n)}return n}function D9(i,e,t){i.flags|=16384,i={getSnapshot:e,value:t},e=ms.updateQueue,e===null?(e={lastEffect:null,stores:null},ms.updateQueue=e,e.stores=[i]):(t=e.stores,t===null?e.stores=[i]:t.push(i))}function k9(i,e,t,r){e.value=t,e.getSnapshot=r,z9(e)&&B9(i)}function F9(i,e,t){return t(function(){z9(e)&&B9(i)})}function z9(i){var e=i.getSnapshot;i=i.value;try{var t=e();return!qd(i,t)}catch{return!0}}function B9(i){var e=Mp(i,1);e!==null&&$d(e,i,1,-1)}function E5(i){var e=cf();return typeof i=="function"&&(i=i()),e.memoizedState=e.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bA,lastRenderedState:i},e.queue=i,i=i.dispatch=Ree.bind(null,ms,i),[e.memoizedState,i]}function wA(i,e,t,r){return i={tag:i,create:e,destroy:t,deps:r,next:null},e=ms.updateQueue,e===null?(e={lastEffect:null,stores:null},ms.updateQueue=e,e.lastEffect=i.next=i):(t=e.lastEffect,t===null?e.lastEffect=i.next=i:(r=t.next,t.next=i,i.next=r,e.lastEffect=i)),i}function U9(){return oc().memoizedState}function zP(i,e,t,r){var n=cf();ms.flags|=i,n.memoizedState=wA(1|e,t,void 0,r===void 0?null:r)}function RI(i,e,t,r){var n=oc();r=r===void 0?null:r;var l=void 0;if(Ra!==null){var c=Ra.memoizedState;if(l=c.destroy,r!==null&&fz(r,c.deps)){n.memoizedState=wA(e,t,l,r);return}}ms.flags|=i,n.memoizedState=wA(1|e,t,l,r)}function T5(i,e){return zP(8390656,8,i,e)}function gz(i,e){return RI(2048,8,i,e)}function H9(i,e){return RI(4,2,i,e)}function $9(i,e){return RI(4,4,i,e)}function V9(i,e){if(typeof e=="function")return i=i(),e(i),function(){e(null)};if(e!=null)return i=i(),e.current=i,function(){e.current=null}}function W9(i,e,t){return t=t!=null?t.concat([i]):null,RI(4,4,V9.bind(null,e,i),t)}function vz(){}function j9(i,e){var t=oc();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&fz(e,r[1])?r[0]:(t.memoizedState=[i,e],i)}function G9(i,e){var t=oc();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&fz(e,r[1])?r[0]:(i=i(),t.memoizedState=[i,e],i)}function q9(i,e,t){return ew&21?(qd(t,e)||(t=JG(),ms.lanes|=t,tw|=t,i.baseState=!0),e):(i.baseState&&(i.baseState=!1,uu=!0),i.memoizedState=t)}function Cee(i,e){var t=gn;gn=t!==0&&4>t?t:4,i(!0);var r=JL.transition;JL.transition={};try{i(!1),e()}finally{gn=t,JL.transition=r}}function X9(){return oc().memoizedState}function Pee(i,e,t){var r=zm(i);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},Z9(i))J9(e,t);else if(t=T9(i,e,t,r),t!==null){var n=ql();$d(t,i,r,n),Y9(t,e,r)}}function Ree(i,e,t){var r=zm(i),n={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(Z9(i))J9(e,n);else{var l=i.alternate;if(i.lanes===0&&(l===null||l.lanes===0)&&(l=e.lastRenderedReducer,l!==null))try{var c=e.lastRenderedState,h=l(c,t);if(n.hasEagerState=!0,n.eagerState=h,qd(h,c)){var d=e.interleaved;d===null?(n.next=n,lz(e)):(n.next=d.next,d.next=n),e.interleaved=n;return}}catch{}finally{}t=T9(i,e,n,r),t!==null&&(n=ql(),$d(t,i,r,n),Y9(t,e,r))}}function Z9(i){var e=i.alternate;return i===ms||e!==null&&e===ms}function J9(i,e){WT=ER=!0;var t=i.pending;t===null?e.next=e:(e.next=t.next,t.next=e),i.pending=e}function Y9(i,e,t){if(t&4194240){var r=e.lanes;r&=i.pendingLanes,t|=r,e.lanes=t,X4(i,t)}}var TR={readContext:ac,useCallback:fo,useContext:fo,useEffect:fo,useImperativeHandle:fo,useInsertionEffect:fo,useLayoutEffect:fo,useMemo:fo,useReducer:fo,useRef:fo,useState:fo,useDebugValue:fo,useDeferredValue:fo,useTransition:fo,useMutableSource:fo,useSyncExternalStore:fo,useId:fo,unstable_isNewReconciler:!1},Iee={readContext:ac,useCallback:function(i,e){return cf().memoizedState=[i,e===void 0?null:e],i},useContext:ac,useEffect:T5,useImperativeHandle:function(i,e,t){return t=t!=null?t.concat([i]):null,zP(4194308,4,V9.bind(null,e,i),t)},useLayoutEffect:function(i,e){return zP(4194308,4,i,e)},useInsertionEffect:function(i,e){return zP(4,2,i,e)},useMemo:function(i,e){var t=cf();return e=e===void 0?null:e,i=i(),t.memoizedState=[i,e],i},useReducer:function(i,e,t){var r=cf();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:e},r.queue=i,i=i.dispatch=Pee.bind(null,ms,i),[r.memoizedState,i]},useRef:function(i){var e=cf();return i={current:i},e.memoizedState=i},useState:E5,useDebugValue:vz,useDeferredValue:function(i){return cf().memoizedState=i},useTransition:function(){var i=E5(!1),e=i[0];return i=Cee.bind(null,i[1]),cf().memoizedState=i,[e,i]},useMutableSource:function(){},useSyncExternalStore:function(i,e,t){var r=ms,n=cf();if(Xn){if(t===void 0)throw Error(Et(407));t=t()}else{if(t=e(),Za===null)throw Error(Et(349));ew&30||D9(r,e,t)}n.memoizedState=t;var l={value:t,getSnapshot:e};return n.queue=l,T5(F9.bind(null,r,l,i),[i]),r.flags|=2048,wA(9,k9.bind(null,r,l,t,e),void 0,null),t},useId:function(){var i=cf(),e=Za.identifierPrefix;if(Xn){var t=fp,r=dp;t=(r&~(1<<32-Hd(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=xA++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=Aee++,e=":"+e+"r"+t.toString(32)+":";return i.memoizedState=e},unstable_isNewReconciler:!1},Lee={readContext:ac,useCallback:j9,useContext:ac,useEffect:gz,useImperativeHandle:W9,useInsertionEffect:H9,useLayoutEffect:$9,useMemo:G9,useReducer:YL,useRef:U9,useState:function(){return YL(bA)},useDebugValue:vz,useDeferredValue:function(i){var e=oc();return q9(e,Ra.memoizedState,i)},useTransition:function(){var i=YL(bA)[0],e=oc().memoizedState;return[i,e]},useMutableSource:O9,useSyncExternalStore:N9,useId:X9,unstable_isNewReconciler:!1},Oee={readContext:ac,useCallback:j9,useContext:ac,useEffect:gz,useImperativeHandle:W9,useInsertionEffect:H9,useLayoutEffect:$9,useMemo:G9,useReducer:KL,useRef:U9,useState:function(){return KL(bA)},useDebugValue:vz,useDeferredValue:function(i){var e=oc();return Ra===null?e.memoizedState=i:q9(e,Ra.memoizedState,i)},useTransition:function(){var i=KL(bA)[0],e=oc().memoizedState;return[i,e]},useMutableSource:O9,useSyncExternalStore:N9,useId:X9,unstable_isNewReconciler:!1};function LM(i,e){try{var t="",r=e;do t+=oQ(r),r=r.return;while(r);var n=t}catch(l){n=`
Error generating stack: `+l.message+`
`+l.stack}return{value:i,source:e,stack:n,digest:null}}function QL(i,e,t){return{value:i,source:null,stack:t??null,digest:e??null}}function Nk(i,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var Nee=typeof WeakMap=="function"?WeakMap:Map;function K9(i,e,t){t=gp(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){CR||(CR=!0,Wk=r),Nk(i,e)},t}function Q9(i,e,t){t=gp(-1,t),t.tag=3;var r=i.type.getDerivedStateFromError;if(typeof r=="function"){var n=e.value;t.payload=function(){return r(n)},t.callback=function(){Nk(i,e)}}var l=i.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(t.callback=function(){Nk(i,e),typeof r!="function"&&(Fm===null?Fm=new Set([this]):Fm.add(this));var c=e.stack;this.componentDidCatch(e.value,{componentStack:c!==null?c:""})}),t}function A5(i,e,t){var r=i.pingCache;if(r===null){r=i.pingCache=new Nee;var n=new Set;r.set(e,n)}else n=r.get(e),n===void 0&&(n=new Set,r.set(e,n));n.has(t)||(n.add(t),i=Xee.bind(null,i,e,t),e.then(i,i))}function C5(i){do{var e;if((e=i.tag===13)&&(e=i.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return i;i=i.return}while(i!==null);return null}function P5(i,e,t,r,n){return i.mode&1?(i.flags|=65536,i.lanes=n,i):(i===e?i.flags|=65536:(i.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=gp(-1,1),e.tag=2,km(t,e,1))),t.lanes|=1),i)}var Dee=Fp.ReactCurrentOwner,uu=!1;function Vl(i,e,t,r){e.child=i===null?I9(e,null,t,r):RM(e,i.child,t,r)}function R5(i,e,t,r,n){t=t.render;var l=e.ref;return hM(e,n),r=pz(i,e,t,r,l,n),t=mz(),i!==null&&!uu?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~n,Ep(i,e,n)):(Xn&&t&&iz(e),e.flags|=1,Vl(i,e,r,n),e.child)}function I5(i,e,t,r,n){if(i===null){var l=t.type;return typeof l=="function"&&!Ez(l)&&l.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=l,e8(i,e,l,r,n)):(i=$P(t.type,null,r,e,e.mode,n),i.ref=e.ref,i.return=e,e.child=i)}if(l=i.child,!(i.lanes&n)){var c=l.memoizedProps;if(t=t.compare,t=t!==null?t:pA,t(c,r)&&i.ref===e.ref)return Ep(i,e,n)}return e.flags|=1,i=Bm(l,r),i.ref=e.ref,i.return=e,e.child=i}function e8(i,e,t,r,n){if(i!==null){var l=i.memoizedProps;if(pA(l,r)&&i.ref===e.ref)if(uu=!1,e.pendingProps=r=l,(i.lanes&n)!==0)i.flags&131072&&(uu=!0);else return e.lanes=i.lanes,Ep(i,e,n)}return Dk(i,e,t,r,n)}function t8(i,e,t){var r=e.pendingProps,n=r.children,l=i!==null?i.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},zn(ZS,Pu),Pu|=t;else{if(!(t&1073741824))return i=l!==null?l.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:i,cachePool:null,transitions:null},e.updateQueue=null,zn(ZS,Pu),Pu|=i,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=l!==null?l.baseLanes:t,zn(ZS,Pu),Pu|=r}else l!==null?(r=l.baseLanes|t,e.memoizedState=null):r=t,zn(ZS,Pu),Pu|=r;return Vl(i,e,n,t),e.child}function i8(i,e){var t=e.ref;(i===null&&t!==null||i!==null&&i.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Dk(i,e,t,r,n){var l=du(t)?K1:To.current;return l=CM(e,l),hM(e,n),t=pz(i,e,t,r,l,n),r=mz(),i!==null&&!uu?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~n,Ep(i,e,n)):(Xn&&r&&iz(e),e.flags|=1,Vl(i,e,t,n),e.child)}function L5(i,e,t,r,n){if(du(t)){var l=!0;yR(e)}else l=!1;if(hM(e,n),e.stateNode===null)BP(i,e),P9(e,t,r),Ok(e,t,r,n),r=!0;else if(i===null){var c=e.stateNode,h=e.memoizedProps;c.props=h;var d=c.context,f=t.contextType;typeof f=="object"&&f!==null?f=ac(f):(f=du(t)?K1:To.current,f=CM(e,f));var m=t.getDerivedStateFromProps,g=typeof m=="function"||typeof c.getSnapshotBeforeUpdate=="function";g||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(h!==r||d!==f)&&S5(e,c,r,f),ym=!1;var y=e.memoizedState;c.state=y,SR(e,r,c,n),d=e.memoizedState,h!==r||y!==d||hu.current||ym?(typeof m=="function"&&(Lk(e,t,m,r),d=e.memoizedState),(h=ym||w5(e,t,h,r,y,d,f))?(g||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount()),typeof c.componentDidMount=="function"&&(e.flags|=4194308)):(typeof c.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=d),c.props=r,c.state=d,c.context=f,r=h):(typeof c.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{c=e.stateNode,A9(i,e),h=e.memoizedProps,f=e.type===e.elementType?h:Od(e.type,h),c.props=f,g=e.pendingProps,y=c.context,d=t.contextType,typeof d=="object"&&d!==null?d=ac(d):(d=du(t)?K1:To.current,d=CM(e,d));var _=t.getDerivedStateFromProps;(m=typeof _=="function"||typeof c.getSnapshotBeforeUpdate=="function")||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(h!==g||y!==d)&&S5(e,c,r,d),ym=!1,y=e.memoizedState,c.state=y,SR(e,r,c,n);var b=e.memoizedState;h!==g||y!==b||hu.current||ym?(typeof _=="function"&&(Lk(e,t,_,r),b=e.memoizedState),(f=ym||w5(e,t,f,r,y,b,d)||!1)?(m||typeof c.UNSAFE_componentWillUpdate!="function"&&typeof c.componentWillUpdate!="function"||(typeof c.componentWillUpdate=="function"&&c.componentWillUpdate(r,b,d),typeof c.UNSAFE_componentWillUpdate=="function"&&c.UNSAFE_componentWillUpdate(r,b,d)),typeof c.componentDidUpdate=="function"&&(e.flags|=4),typeof c.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof c.componentDidUpdate!="function"||h===i.memoizedProps&&y===i.memoizedState||(e.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||h===i.memoizedProps&&y===i.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=b),c.props=r,c.state=b,c.context=d,r=f):(typeof c.componentDidUpdate!="function"||h===i.memoizedProps&&y===i.memoizedState||(e.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||h===i.memoizedProps&&y===i.memoizedState||(e.flags|=1024),r=!1)}return kk(i,e,t,r,l,n)}function kk(i,e,t,r,n,l){i8(i,e);var c=(e.flags&128)!==0;if(!r&&!c)return n&&v5(e,t,!1),Ep(i,e,l);r=e.stateNode,Dee.current=e;var h=c&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,i!==null&&c?(e.child=RM(e,i.child,null,l),e.child=RM(e,null,h,l)):Vl(i,e,h,l),e.memoizedState=r.state,n&&v5(e,t,!0),e.child}function r8(i){var e=i.stateNode;e.pendingContext?g5(i,e.pendingContext,e.pendingContext!==e.context):e.context&&g5(i,e.context,!1),cz(i,e.containerInfo)}function O5(i,e,t,r,n){return PM(),nz(n),e.flags|=256,Vl(i,e,t,r),e.child}var Fk={dehydrated:null,treeContext:null,retryLane:0};function zk(i){return{baseLanes:i,cachePool:null,transitions:null}}function n8(i,e,t){var r=e.pendingProps,n=fs.current,l=!1,c=(e.flags&128)!==0,h;if((h=c)||(h=i!==null&&i.memoizedState===null?!1:(n&2)!==0),h?(l=!0,e.flags&=-129):(i===null||i.memoizedState!==null)&&(n|=1),zn(fs,n&1),i===null)return Rk(e),i=e.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?(e.mode&1?i.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(c=r.children,i=r.fallback,l?(r=e.mode,l=e.child,c={mode:"hidden",children:c},!(r&1)&&l!==null?(l.childLanes=0,l.pendingProps=c):l=OI(c,r,0,null),i=$1(i,r,t,null),l.return=e,i.return=e,l.sibling=i,e.child=l,e.child.memoizedState=zk(t),e.memoizedState=Fk,i):yz(e,c));if(n=i.memoizedState,n!==null&&(h=n.dehydrated,h!==null))return kee(i,e,c,r,h,n,t);if(l){l=r.fallback,c=e.mode,n=i.child,h=n.sibling;var d={mode:"hidden",children:r.children};return!(c&1)&&e.child!==n?(r=e.child,r.childLanes=0,r.pendingProps=d,e.deletions=null):(r=Bm(n,d),r.subtreeFlags=n.subtreeFlags&14680064),h!==null?l=Bm(h,l):(l=$1(l,c,t,null),l.flags|=2),l.return=e,r.return=e,r.sibling=l,e.child=r,r=l,l=e.child,c=i.child.memoizedState,c=c===null?zk(t):{baseLanes:c.baseLanes|t,cachePool:null,transitions:c.transitions},l.memoizedState=c,l.childLanes=i.childLanes&~t,e.memoizedState=Fk,r}return l=i.child,i=l.sibling,r=Bm(l,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,i!==null&&(t=e.deletions,t===null?(e.deletions=[i],e.flags|=16):t.push(i)),e.child=r,e.memoizedState=null,r}function yz(i,e){return e=OI({mode:"visible",children:e},i.mode,0,null),e.return=i,i.child=e}function e2(i,e,t,r){return r!==null&&nz(r),RM(e,i.child,null,t),i=yz(e,e.pendingProps.children),i.flags|=2,e.memoizedState=null,i}function kee(i,e,t,r,n,l,c){if(t)return e.flags&256?(e.flags&=-257,r=QL(Error(Et(422))),e2(i,e,c,r)):e.memoizedState!==null?(e.child=i.child,e.flags|=128,null):(l=r.fallback,n=e.mode,r=OI({mode:"visible",children:r.children},n,0,null),l=$1(l,n,c,null),l.flags|=2,r.return=e,l.return=e,r.sibling=l,e.child=r,e.mode&1&&RM(e,i.child,null,c),e.child.memoizedState=zk(c),e.memoizedState=Fk,l);if(!(e.mode&1))return e2(i,e,c,null);if(n.data==="$!"){if(r=n.nextSibling&&n.nextSibling.dataset,r)var h=r.dgst;return r=h,l=Error(Et(419)),r=QL(l,r,void 0),e2(i,e,c,r)}if(h=(c&i.childLanes)!==0,uu||h){if(r=Za,r!==null){switch(c&-c){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(r.suspendedLanes|c)?0:n,n!==0&&n!==l.retryLane&&(l.retryLane=n,Mp(i,n),$d(r,i,n,-1))}return Mz(),r=QL(Error(Et(421))),e2(i,e,c,r)}return n.data==="$?"?(e.flags|=128,e.child=i.child,e=Zee.bind(null,i),n._reactRetry=e,null):(i=l.treeContext,Lu=Dm(n.nextSibling),Ou=e,Xn=!0,kd=null,i!==null&&(Yu[Ku++]=dp,Yu[Ku++]=fp,Yu[Ku++]=Q1,dp=i.id,fp=i.overflow,Q1=e),e=yz(e,r.children),e.flags|=4096,e)}function N5(i,e,t){i.lanes|=e;var r=i.alternate;r!==null&&(r.lanes|=e),Ik(i.return,e,t)}function eO(i,e,t,r,n){var l=i.memoizedState;l===null?i.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:n}:(l.isBackwards=e,l.rendering=null,l.renderingStartTime=0,l.last=r,l.tail=t,l.tailMode=n)}function s8(i,e,t){var r=e.pendingProps,n=r.revealOrder,l=r.tail;if(Vl(i,e,r.children,t),r=fs.current,r&2)r=r&1|2,e.flags|=128;else{if(i!==null&&i.flags&128)e:for(i=e.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&N5(i,t,e);else if(i.tag===19)N5(i,t,e);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break e;for(;i.sibling===null;){if(i.return===null||i.return===e)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}r&=1}if(zn(fs,r),!(e.mode&1))e.memoizedState=null;else switch(n){case"forwards":for(t=e.child,n=null;t!==null;)i=t.alternate,i!==null&&MR(i)===null&&(n=t),t=t.sibling;t=n,t===null?(n=e.child,e.child=null):(n=t.sibling,t.sibling=null),eO(e,!1,n,t,l);break;case"backwards":for(t=null,n=e.child,e.child=null;n!==null;){if(i=n.alternate,i!==null&&MR(i)===null){e.child=n;break}i=n.sibling,n.sibling=t,t=n,n=i}eO(e,!0,t,null,l);break;case"together":eO(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function BP(i,e){!(e.mode&1)&&i!==null&&(i.alternate=null,e.alternate=null,e.flags|=2)}function Ep(i,e,t){if(i!==null&&(e.dependencies=i.dependencies),tw|=e.lanes,!(t&e.childLanes))return null;if(i!==null&&e.child!==i.child)throw Error(Et(153));if(e.child!==null){for(i=e.child,t=Bm(i,i.pendingProps),e.child=t,t.return=e;i.sibling!==null;)i=i.sibling,t=t.sibling=Bm(i,i.pendingProps),t.return=e;t.sibling=null}return e.child}function Fee(i,e,t){switch(e.tag){case 3:r8(e),PM();break;case 5:L9(e);break;case 1:du(e.type)&&yR(e);break;case 4:cz(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,n=e.memoizedProps.value;zn(bR,r._currentValue),r._currentValue=n;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(zn(fs,fs.current&1),e.flags|=128,null):t&e.child.childLanes?n8(i,e,t):(zn(fs,fs.current&1),i=Ep(i,e,t),i!==null?i.sibling:null);zn(fs,fs.current&1);break;case 19:if(r=(t&e.childLanes)!==0,i.flags&128){if(r)return s8(i,e,t);e.flags|=128}if(n=e.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),zn(fs,fs.current),r)break;return null;case 22:case 23:return e.lanes=0,t8(i,e,t)}return Ep(i,e,t)}var a8,Bk,o8,l8;a8=function(i,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)i.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};Bk=function(){};o8=function(i,e,t,r){var n=i.memoizedProps;if(n!==r){i=e.stateNode,R1(_f.current);var l=null;switch(t){case"input":n=ok(i,n),r=ok(i,r),l=[];break;case"select":n=gs({},n,{value:void 0}),r=gs({},r,{value:void 0}),l=[];break;case"textarea":n=ck(i,n),r=ck(i,r),l=[];break;default:typeof n.onClick!="function"&&typeof r.onClick=="function"&&(i.onclick=gR)}dk(t,r);var c;t=null;for(f in n)if(!r.hasOwnProperty(f)&&n.hasOwnProperty(f)&&n[f]!=null)if(f==="style"){var h=n[f];for(c in h)h.hasOwnProperty(c)&&(t||(t={}),t[c]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(oA.hasOwnProperty(f)?l||(l=[]):(l=l||[]).push(f,null));for(f in r){var d=r[f];if(h=n!=null?n[f]:void 0,r.hasOwnProperty(f)&&d!==h&&(d!=null||h!=null))if(f==="style")if(h){for(c in h)!h.hasOwnProperty(c)||d&&d.hasOwnProperty(c)||(t||(t={}),t[c]="");for(c in d)d.hasOwnProperty(c)&&h[c]!==d[c]&&(t||(t={}),t[c]=d[c])}else t||(l||(l=[]),l.push(f,t)),t=d;else f==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,h=h?h.__html:void 0,d!=null&&h!==d&&(l=l||[]).push(f,d)):f==="children"?typeof d!="string"&&typeof d!="number"||(l=l||[]).push(f,""+d):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(oA.hasOwnProperty(f)?(d!=null&&f==="onScroll"&&Un("scroll",i),l||h===d||(l=[])):(l=l||[]).push(f,d))}t&&(l=l||[]).push("style",t);var f=l;(e.updateQueue=f)&&(e.flags|=4)}};l8=function(i,e,t,r){t!==r&&(e.flags|=4)};function zE(i,e){if(!Xn)switch(i.tailMode){case"hidden":e=i.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?i.tail=null:t.sibling=null;break;case"collapsed":t=i.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||i.tail===null?i.tail=null:i.tail.sibling=null:r.sibling=null}}function po(i){var e=i.alternate!==null&&i.alternate.child===i.child,t=0,r=0;if(e)for(var n=i.child;n!==null;)t|=n.lanes|n.childLanes,r|=n.subtreeFlags&14680064,r|=n.flags&14680064,n.return=i,n=n.sibling;else for(n=i.child;n!==null;)t|=n.lanes|n.childLanes,r|=n.subtreeFlags,r|=n.flags,n.return=i,n=n.sibling;return i.subtreeFlags|=r,i.childLanes=t,e}function zee(i,e,t){var r=e.pendingProps;switch(rz(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return po(e),null;case 1:return du(e.type)&&vR(),po(e),null;case 3:return r=e.stateNode,IM(),Hn(hu),Hn(To),dz(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(i===null||i.child===null)&&(KC(e)?e.flags|=4:i===null||i.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,kd!==null&&(qk(kd),kd=null))),Bk(i,e),po(e),null;case 5:hz(e);var n=R1(_A.current);if(t=e.type,i!==null&&e.stateNode!=null)o8(i,e,t,r,n),i.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Et(166));return po(e),null}if(i=R1(_f.current),KC(e)){r=e.stateNode,t=e.type;var l=e.memoizedProps;switch(r[ff]=e,r[vA]=l,i=(e.mode&1)!==0,t){case"dialog":Un("cancel",r),Un("close",r);break;case"iframe":case"object":case"embed":Un("load",r);break;case"video":case"audio":for(n=0;n<IT.length;n++)Un(IT[n],r);break;case"source":Un("error",r);break;case"img":case"image":case"link":Un("error",r),Un("load",r);break;case"details":Un("toggle",r);break;case"input":VU(r,l),Un("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!l.multiple},Un("invalid",r);break;case"textarea":jU(r,l),Un("invalid",r)}dk(t,l),n=null;for(var c in l)if(l.hasOwnProperty(c)){var h=l[c];c==="children"?typeof h=="string"?r.textContent!==h&&(l.suppressHydrationWarning!==!0&&YC(r.textContent,h,i),n=["children",h]):typeof h=="number"&&r.textContent!==""+h&&(l.suppressHydrationWarning!==!0&&YC(r.textContent,h,i),n=["children",""+h]):oA.hasOwnProperty(c)&&h!=null&&c==="onScroll"&&Un("scroll",r)}switch(t){case"input":VC(r),WU(r,l,!0);break;case"textarea":VC(r),GU(r);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(r.onclick=gR)}r=n,e.updateQueue=r,r!==null&&(e.flags|=4)}else{c=n.nodeType===9?n:n.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=DG(t)),i==="http://www.w3.org/1999/xhtml"?t==="script"?(i=c.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof r.is=="string"?i=c.createElement(t,{is:r.is}):(i=c.createElement(t),t==="select"&&(c=i,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):i=c.createElementNS(i,t),i[ff]=e,i[vA]=r,a8(i,e,!1,!1),e.stateNode=i;e:{switch(c=fk(t,r),t){case"dialog":Un("cancel",i),Un("close",i),n=r;break;case"iframe":case"object":case"embed":Un("load",i),n=r;break;case"video":case"audio":for(n=0;n<IT.length;n++)Un(IT[n],i);n=r;break;case"source":Un("error",i),n=r;break;case"img":case"image":case"link":Un("error",i),Un("load",i),n=r;break;case"details":Un("toggle",i),n=r;break;case"input":VU(i,r),n=ok(i,r),Un("invalid",i);break;case"option":n=r;break;case"select":i._wrapperState={wasMultiple:!!r.multiple},n=gs({},r,{value:void 0}),Un("invalid",i);break;case"textarea":jU(i,r),n=ck(i,r),Un("invalid",i);break;default:n=r}dk(t,n),h=n;for(l in h)if(h.hasOwnProperty(l)){var d=h[l];l==="style"?zG(i,d):l==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&kG(i,d)):l==="children"?typeof d=="string"?(t!=="textarea"||d!=="")&&lA(i,d):typeof d=="number"&&lA(i,""+d):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(oA.hasOwnProperty(l)?d!=null&&l==="onScroll"&&Un("scroll",i):d!=null&&$4(i,l,d,c))}switch(t){case"input":VC(i),WU(i,r,!1);break;case"textarea":VC(i),GU(i);break;case"option":r.value!=null&&i.setAttribute("value",""+Xm(r.value));break;case"select":i.multiple=!!r.multiple,l=r.value,l!=null?oM(i,!!r.multiple,l,!1):r.defaultValue!=null&&oM(i,!!r.multiple,r.defaultValue,!0);break;default:typeof n.onClick=="function"&&(i.onclick=gR)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return po(e),null;case 6:if(i&&e.stateNode!=null)l8(i,e,i.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Et(166));if(t=R1(_A.current),R1(_f.current),KC(e)){if(r=e.stateNode,t=e.memoizedProps,r[ff]=e,(l=r.nodeValue!==t)&&(i=Ou,i!==null))switch(i.tag){case 3:YC(r.nodeValue,t,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&YC(r.nodeValue,t,(i.mode&1)!==0)}l&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[ff]=e,e.stateNode=r}return po(e),null;case 13:if(Hn(fs),r=e.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(Xn&&Lu!==null&&e.mode&1&&!(e.flags&128))E9(),PM(),e.flags|=98560,l=!1;else if(l=KC(e),r!==null&&r.dehydrated!==null){if(i===null){if(!l)throw Error(Et(318));if(l=e.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(Et(317));l[ff]=e}else PM(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;po(e),l=!1}else kd!==null&&(qk(kd),kd=null),l=!0;if(!l)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(i!==null&&i.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(i===null||fs.current&1?Oa===0&&(Oa=3):Mz())),e.updateQueue!==null&&(e.flags|=4),po(e),null);case 4:return IM(),Bk(i,e),i===null&&mA(e.stateNode.containerInfo),po(e),null;case 10:return oz(e.type._context),po(e),null;case 17:return du(e.type)&&vR(),po(e),null;case 19:if(Hn(fs),l=e.memoizedState,l===null)return po(e),null;if(r=(e.flags&128)!==0,c=l.rendering,c===null)if(r)zE(l,!1);else{if(Oa!==0||i!==null&&i.flags&128)for(i=e.child;i!==null;){if(c=MR(i),c!==null){for(e.flags|=128,zE(l,!1),r=c.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)l=t,i=r,l.flags&=14680066,c=l.alternate,c===null?(l.childLanes=0,l.lanes=i,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=c.childLanes,l.lanes=c.lanes,l.child=c.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=c.memoizedProps,l.memoizedState=c.memoizedState,l.updateQueue=c.updateQueue,l.type=c.type,i=c.dependencies,l.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),t=t.sibling;return zn(fs,fs.current&1|2),e.child}i=i.sibling}l.tail!==null&&As()>OM&&(e.flags|=128,r=!0,zE(l,!1),e.lanes=4194304)}else{if(!r)if(i=MR(c),i!==null){if(e.flags|=128,r=!0,t=i.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),zE(l,!0),l.tail===null&&l.tailMode==="hidden"&&!c.alternate&&!Xn)return po(e),null}else 2*As()-l.renderingStartTime>OM&&t!==1073741824&&(e.flags|=128,r=!0,zE(l,!1),e.lanes=4194304);l.isBackwards?(c.sibling=e.child,e.child=c):(t=l.last,t!==null?t.sibling=c:e.child=c,l.last=c)}return l.tail!==null?(e=l.tail,l.rendering=e,l.tail=e.sibling,l.renderingStartTime=As(),e.sibling=null,t=fs.current,zn(fs,r?t&1|2:t&1),e):(po(e),null);case 22:case 23:return Sz(),r=e.memoizedState!==null,i!==null&&i.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Pu&1073741824&&(po(e),e.subtreeFlags&6&&(e.flags|=8192)):po(e),null;case 24:return null;case 25:return null}throw Error(Et(156,e.tag))}function Bee(i,e){switch(rz(e),e.tag){case 1:return du(e.type)&&vR(),i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 3:return IM(),Hn(hu),Hn(To),dz(),i=e.flags,i&65536&&!(i&128)?(e.flags=i&-65537|128,e):null;case 5:return hz(e),null;case 13:if(Hn(fs),i=e.memoizedState,i!==null&&i.dehydrated!==null){if(e.alternate===null)throw Error(Et(340));PM()}return i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 19:return Hn(fs),null;case 4:return IM(),null;case 10:return oz(e.type._context),null;case 22:case 23:return Sz(),null;case 24:return null;default:return null}}var t2=!1,wo=!1,Uee=typeof WeakSet=="function"?WeakSet:Set,ni=null;function XS(i,e){var t=i.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){xs(i,e,r)}else t.current=null}function Uk(i,e,t){try{t()}catch(r){xs(i,e,r)}}var D5=!1;function Hee(i,e){if(Sk=fR,i=d9(),tz(i)){if("selectionStart"in i)var t={start:i.selectionStart,end:i.selectionEnd};else e:{t=(t=i.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var n=r.anchorOffset,l=r.focusNode;r=r.focusOffset;try{t.nodeType,l.nodeType}catch{t=null;break e}var c=0,h=-1,d=-1,f=0,m=0,g=i,y=null;t:for(;;){for(var _;g!==t||n!==0&&g.nodeType!==3||(h=c+n),g!==l||r!==0&&g.nodeType!==3||(d=c+r),g.nodeType===3&&(c+=g.nodeValue.length),(_=g.firstChild)!==null;)y=g,g=_;for(;;){if(g===i)break t;if(y===t&&++f===n&&(h=c),y===l&&++m===r&&(d=c),(_=g.nextSibling)!==null)break;g=y,y=g.parentNode}g=_}t=h===-1||d===-1?null:{start:h,end:d}}else t=null}t=t||{start:0,end:0}}else t=null;for(Mk={focusedElem:i,selectionRange:t},fR=!1,ni=e;ni!==null;)if(e=ni,i=e.child,(e.subtreeFlags&1028)!==0&&i!==null)i.return=e,ni=i;else for(;ni!==null;){e=ni;try{var b=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var S=b.memoizedProps,E=b.memoizedState,T=e.stateNode,A=T.getSnapshotBeforeUpdate(e.elementType===e.type?S:Od(e.type,S),E);T.__reactInternalSnapshotBeforeUpdate=A}break;case 3:var P=e.stateNode.containerInfo;P.nodeType===1?P.textContent="":P.nodeType===9&&P.documentElement&&P.removeChild(P.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Et(163))}}catch(O){xs(e,e.return,O)}if(i=e.sibling,i!==null){i.return=e.return,ni=i;break}ni=e.return}return b=D5,D5=!1,b}function jT(i,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var n=r=r.next;do{if((n.tag&i)===i){var l=n.destroy;n.destroy=void 0,l!==void 0&&Uk(e,t,l)}n=n.next}while(n!==r)}}function II(i,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&i)===i){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function Hk(i){var e=i.ref;if(e!==null){var t=i.stateNode;switch(i.tag){case 5:i=t;break;default:i=t}typeof e=="function"?e(i):e.current=i}}function u8(i){var e=i.alternate;e!==null&&(i.alternate=null,u8(e)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(e=i.stateNode,e!==null&&(delete e[ff],delete e[vA],delete e[Ak],delete e[See],delete e[Mee])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function c8(i){return i.tag===5||i.tag===3||i.tag===4}function k5(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||c8(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function $k(i,e,t){var r=i.tag;if(r===5||r===6)i=i.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(i,e):t.insertBefore(i,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(i,t)):(e=t,e.appendChild(i)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=gR));else if(r!==4&&(i=i.child,i!==null))for($k(i,e,t),i=i.sibling;i!==null;)$k(i,e,t),i=i.sibling}function Vk(i,e,t){var r=i.tag;if(r===5||r===6)i=i.stateNode,e?t.insertBefore(i,e):t.appendChild(i);else if(r!==4&&(i=i.child,i!==null))for(Vk(i,e,t),i=i.sibling;i!==null;)Vk(i,e,t),i=i.sibling}var eo=null,Nd=!1;function Up(i,e,t){for(t=t.child;t!==null;)h8(i,e,t),t=t.sibling}function h8(i,e,t){if(yf&&typeof yf.onCommitFiberUnmount=="function")try{yf.onCommitFiberUnmount(SI,t)}catch{}switch(t.tag){case 5:wo||XS(t,e);case 6:var r=eo,n=Nd;eo=null,Up(i,e,t),eo=r,Nd=n,eo!==null&&(Nd?(i=eo,t=t.stateNode,i.nodeType===8?i.parentNode.removeChild(t):i.removeChild(t)):eo.removeChild(t.stateNode));break;case 18:eo!==null&&(Nd?(i=eo,t=t.stateNode,i.nodeType===8?qL(i.parentNode,t):i.nodeType===1&&qL(i,t),dA(i)):qL(eo,t.stateNode));break;case 4:r=eo,n=Nd,eo=t.stateNode.containerInfo,Nd=!0,Up(i,e,t),eo=r,Nd=n;break;case 0:case 11:case 14:case 15:if(!wo&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){n=r=r.next;do{var l=n,c=l.destroy;l=l.tag,c!==void 0&&(l&2||l&4)&&Uk(t,e,c),n=n.next}while(n!==r)}Up(i,e,t);break;case 1:if(!wo&&(XS(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(h){xs(t,e,h)}Up(i,e,t);break;case 21:Up(i,e,t);break;case 22:t.mode&1?(wo=(r=wo)||t.memoizedState!==null,Up(i,e,t),wo=r):Up(i,e,t);break;default:Up(i,e,t)}}function F5(i){var e=i.updateQueue;if(e!==null){i.updateQueue=null;var t=i.stateNode;t===null&&(t=i.stateNode=new Uee),e.forEach(function(r){var n=Jee.bind(null,i,r);t.has(r)||(t.add(r),r.then(n,n))})}}function vd(i,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var n=t[r];try{var l=i,c=e,h=c;e:for(;h!==null;){switch(h.tag){case 5:eo=h.stateNode,Nd=!1;break e;case 3:eo=h.stateNode.containerInfo,Nd=!0;break e;case 4:eo=h.stateNode.containerInfo,Nd=!0;break e}h=h.return}if(eo===null)throw Error(Et(160));h8(l,c,n),eo=null,Nd=!1;var d=n.alternate;d!==null&&(d.return=null),n.return=null}catch(f){xs(n,e,f)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)d8(e,i),e=e.sibling}function d8(i,e){var t=i.alternate,r=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(vd(e,i),nf(i),r&4){try{jT(3,i,i.return),II(3,i)}catch(S){xs(i,i.return,S)}try{jT(5,i,i.return)}catch(S){xs(i,i.return,S)}}break;case 1:vd(e,i),nf(i),r&512&&t!==null&&XS(t,t.return);break;case 5:if(vd(e,i),nf(i),r&512&&t!==null&&XS(t,t.return),i.flags&32){var n=i.stateNode;try{lA(n,"")}catch(S){xs(i,i.return,S)}}if(r&4&&(n=i.stateNode,n!=null)){var l=i.memoizedProps,c=t!==null?t.memoizedProps:l,h=i.type,d=i.updateQueue;if(i.updateQueue=null,d!==null)try{h==="input"&&l.type==="radio"&&l.name!=null&&OG(n,l),fk(h,c);var f=fk(h,l);for(c=0;c<d.length;c+=2){var m=d[c],g=d[c+1];m==="style"?zG(n,g):m==="dangerouslySetInnerHTML"?kG(n,g):m==="children"?lA(n,g):$4(n,m,g,f)}switch(h){case"input":lk(n,l);break;case"textarea":NG(n,l);break;case"select":var y=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!l.multiple;var _=l.value;_!=null?oM(n,!!l.multiple,_,!1):y!==!!l.multiple&&(l.defaultValue!=null?oM(n,!!l.multiple,l.defaultValue,!0):oM(n,!!l.multiple,l.multiple?[]:"",!1))}n[vA]=l}catch(S){xs(i,i.return,S)}}break;case 6:if(vd(e,i),nf(i),r&4){if(i.stateNode===null)throw Error(Et(162));n=i.stateNode,l=i.memoizedProps;try{n.nodeValue=l}catch(S){xs(i,i.return,S)}}break;case 3:if(vd(e,i),nf(i),r&4&&t!==null&&t.memoizedState.isDehydrated)try{dA(e.containerInfo)}catch(S){xs(i,i.return,S)}break;case 4:vd(e,i),nf(i);break;case 13:vd(e,i),nf(i),n=i.child,n.flags&8192&&(l=n.memoizedState!==null,n.stateNode.isHidden=l,!l||n.alternate!==null&&n.alternate.memoizedState!==null||(bz=As())),r&4&&F5(i);break;case 22:if(m=t!==null&&t.memoizedState!==null,i.mode&1?(wo=(f=wo)||m,vd(e,i),wo=f):vd(e,i),nf(i),r&8192){if(f=i.memoizedState!==null,(i.stateNode.isHidden=f)&&!m&&i.mode&1)for(ni=i,m=i.child;m!==null;){for(g=ni=m;ni!==null;){switch(y=ni,_=y.child,y.tag){case 0:case 11:case 14:case 15:jT(4,y,y.return);break;case 1:XS(y,y.return);var b=y.stateNode;if(typeof b.componentWillUnmount=="function"){r=y,t=y.return;try{e=r,b.props=e.memoizedProps,b.state=e.memoizedState,b.componentWillUnmount()}catch(S){xs(r,t,S)}}break;case 5:XS(y,y.return);break;case 22:if(y.memoizedState!==null){B5(g);continue}}_!==null?(_.return=y,ni=_):B5(g)}m=m.sibling}e:for(m=null,g=i;;){if(g.tag===5){if(m===null){m=g;try{n=g.stateNode,f?(l=n.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(h=g.stateNode,d=g.memoizedProps.style,c=d!=null&&d.hasOwnProperty("display")?d.display:null,h.style.display=FG("display",c))}catch(S){xs(i,i.return,S)}}}else if(g.tag===6){if(m===null)try{g.stateNode.nodeValue=f?"":g.memoizedProps}catch(S){xs(i,i.return,S)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===i)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===i)break e;for(;g.sibling===null;){if(g.return===null||g.return===i)break e;m===g&&(m=null),g=g.return}m===g&&(m=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:vd(e,i),nf(i),r&4&&F5(i);break;case 21:break;default:vd(e,i),nf(i)}}function nf(i){var e=i.flags;if(e&2){try{e:{for(var t=i.return;t!==null;){if(c8(t)){var r=t;break e}t=t.return}throw Error(Et(160))}switch(r.tag){case 5:var n=r.stateNode;r.flags&32&&(lA(n,""),r.flags&=-33);var l=k5(i);Vk(i,l,n);break;case 3:case 4:var c=r.stateNode.containerInfo,h=k5(i);$k(i,h,c);break;default:throw Error(Et(161))}}catch(d){xs(i,i.return,d)}i.flags&=-3}e&4096&&(i.flags&=-4097)}function $ee(i,e,t){ni=i,f8(i)}function f8(i,e,t){for(var r=(i.mode&1)!==0;ni!==null;){var n=ni,l=n.child;if(n.tag===22&&r){var c=n.memoizedState!==null||t2;if(!c){var h=n.alternate,d=h!==null&&h.memoizedState!==null||wo;h=t2;var f=wo;if(t2=c,(wo=d)&&!f)for(ni=n;ni!==null;)c=ni,d=c.child,c.tag===22&&c.memoizedState!==null?U5(n):d!==null?(d.return=c,ni=d):U5(n);for(;l!==null;)ni=l,f8(l),l=l.sibling;ni=n,t2=h,wo=f}z5(i)}else n.subtreeFlags&8772&&l!==null?(l.return=n,ni=l):z5(i)}}function z5(i){for(;ni!==null;){var e=ni;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:wo||II(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!wo)if(t===null)r.componentDidMount();else{var n=e.elementType===e.type?t.memoizedProps:Od(e.type,t.memoizedProps);r.componentDidUpdate(n,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var l=e.updateQueue;l!==null&&b5(e,l,r);break;case 3:var c=e.updateQueue;if(c!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}b5(e,c,t)}break;case 5:var h=e.stateNode;if(t===null&&e.flags&4){t=h;var d=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&t.focus();break;case"img":d.src&&(t.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var f=e.alternate;if(f!==null){var m=f.memoizedState;if(m!==null){var g=m.dehydrated;g!==null&&dA(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Et(163))}wo||e.flags&512&&Hk(e)}catch(y){xs(e,e.return,y)}}if(e===i){ni=null;break}if(t=e.sibling,t!==null){t.return=e.return,ni=t;break}ni=e.return}}function B5(i){for(;ni!==null;){var e=ni;if(e===i){ni=null;break}var t=e.sibling;if(t!==null){t.return=e.return,ni=t;break}ni=e.return}}function U5(i){for(;ni!==null;){var e=ni;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{II(4,e)}catch(d){xs(e,t,d)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var n=e.return;try{r.componentDidMount()}catch(d){xs(e,n,d)}}var l=e.return;try{Hk(e)}catch(d){xs(e,l,d)}break;case 5:var c=e.return;try{Hk(e)}catch(d){xs(e,c,d)}}}catch(d){xs(e,e.return,d)}if(e===i){ni=null;break}var h=e.sibling;if(h!==null){h.return=e.return,ni=h;break}ni=e.return}}var Vee=Math.ceil,AR=Fp.ReactCurrentDispatcher,_z=Fp.ReactCurrentOwner,nc=Fp.ReactCurrentBatchConfig,Jr=0,Za=null,zs=null,ro=0,Pu=0,ZS=rg(0),Oa=0,SA=null,tw=0,LI=0,xz=0,GT=null,ru=null,bz=0,OM=1/0,sp=null,CR=!1,Wk=null,Fm=null,i2=!1,Rm=null,PR=0,qT=0,jk=null,UP=-1,HP=0;function ql(){return Jr&6?As():UP!==-1?UP:UP=As()}function zm(i){return i.mode&1?Jr&2&&ro!==0?ro&-ro:Tee.transition!==null?(HP===0&&(HP=JG()),HP):(i=gn,i!==0||(i=window.event,i=i===void 0?16:r9(i.type)),i):1}function $d(i,e,t,r){if(50<qT)throw qT=0,jk=null,Error(Et(185));fC(i,t,r),(!(Jr&2)||i!==Za)&&(i===Za&&(!(Jr&2)&&(LI|=t),Oa===4&&Mm(i,ro)),fu(i,r),t===1&&Jr===0&&!(e.mode&1)&&(OM=As()+500,CI&&ng()))}function fu(i,e){var t=i.callbackNode;TQ(i,e);var r=dR(i,i===Za?ro:0);if(r===0)t!==null&&ZU(t),i.callbackNode=null,i.callbackPriority=0;else if(e=r&-r,i.callbackPriority!==e){if(t!=null&&ZU(t),e===1)i.tag===0?Eee(H5.bind(null,i)):w9(H5.bind(null,i)),bee(function(){!(Jr&6)&&ng()}),t=null;else{switch(YG(r)){case 1:t=q4;break;case 4:t=XG;break;case 16:t=hR;break;case 536870912:t=ZG;break;default:t=hR}t=b8(t,p8.bind(null,i))}i.callbackPriority=e,i.callbackNode=t}}function p8(i,e){if(UP=-1,HP=0,Jr&6)throw Error(Et(327));var t=i.callbackNode;if(dM()&&i.callbackNode!==t)return null;var r=dR(i,i===Za?ro:0);if(r===0)return null;if(r&30||r&i.expiredLanes||e)e=RR(i,r);else{e=r;var n=Jr;Jr|=2;var l=g8();(Za!==i||ro!==e)&&(sp=null,OM=As()+500,H1(i,e));do try{Gee();break}catch(h){m8(i,h)}while(!0);az(),AR.current=l,Jr=n,zs!==null?e=0:(Za=null,ro=0,e=Oa)}if(e!==0){if(e===2&&(n=yk(i),n!==0&&(r=n,e=Gk(i,n))),e===1)throw t=SA,H1(i,0),Mm(i,r),fu(i,As()),t;if(e===6)Mm(i,r);else{if(n=i.current.alternate,!(r&30)&&!Wee(n)&&(e=RR(i,r),e===2&&(l=yk(i),l!==0&&(r=l,e=Gk(i,l))),e===1))throw t=SA,H1(i,0),Mm(i,r),fu(i,As()),t;switch(i.finishedWork=n,i.finishedLanes=r,e){case 0:case 1:throw Error(Et(345));case 2:b1(i,ru,sp);break;case 3:if(Mm(i,r),(r&130023424)===r&&(e=bz+500-As(),10<e)){if(dR(i,0)!==0)break;if(n=i.suspendedLanes,(n&r)!==r){ql(),i.pingedLanes|=i.suspendedLanes&n;break}i.timeoutHandle=Tk(b1.bind(null,i,ru,sp),e);break}b1(i,ru,sp);break;case 4:if(Mm(i,r),(r&4194240)===r)break;for(e=i.eventTimes,n=-1;0<r;){var c=31-Hd(r);l=1<<c,c=e[c],c>n&&(n=c),r&=~l}if(r=n,r=As()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Vee(r/1960))-r,10<r){i.timeoutHandle=Tk(b1.bind(null,i,ru,sp),r);break}b1(i,ru,sp);break;case 5:b1(i,ru,sp);break;default:throw Error(Et(329))}}}return fu(i,As()),i.callbackNode===t?p8.bind(null,i):null}function Gk(i,e){var t=GT;return i.current.memoizedState.isDehydrated&&(H1(i,e).flags|=256),i=RR(i,e),i!==2&&(e=ru,ru=t,e!==null&&qk(e)),i}function qk(i){ru===null?ru=i:ru.push.apply(ru,i)}function Wee(i){for(var e=i;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var n=t[r],l=n.getSnapshot;n=n.value;try{if(!qd(l(),n))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Mm(i,e){for(e&=~xz,e&=~LI,i.suspendedLanes|=e,i.pingedLanes&=~e,i=i.expirationTimes;0<e;){var t=31-Hd(e),r=1<<t;i[t]=-1,e&=~r}}function H5(i){if(Jr&6)throw Error(Et(327));dM();var e=dR(i,0);if(!(e&1))return fu(i,As()),null;var t=RR(i,e);if(i.tag!==0&&t===2){var r=yk(i);r!==0&&(e=r,t=Gk(i,r))}if(t===1)throw t=SA,H1(i,0),Mm(i,e),fu(i,As()),t;if(t===6)throw Error(Et(345));return i.finishedWork=i.current.alternate,i.finishedLanes=e,b1(i,ru,sp),fu(i,As()),null}function wz(i,e){var t=Jr;Jr|=1;try{return i(e)}finally{Jr=t,Jr===0&&(OM=As()+500,CI&&ng())}}function iw(i){Rm!==null&&Rm.tag===0&&!(Jr&6)&&dM();var e=Jr;Jr|=1;var t=nc.transition,r=gn;try{if(nc.transition=null,gn=1,i)return i()}finally{gn=r,nc.transition=t,Jr=e,!(Jr&6)&&ng()}}function Sz(){Pu=ZS.current,Hn(ZS)}function H1(i,e){i.finishedWork=null,i.finishedLanes=0;var t=i.timeoutHandle;if(t!==-1&&(i.timeoutHandle=-1,xee(t)),zs!==null)for(t=zs.return;t!==null;){var r=t;switch(rz(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&vR();break;case 3:IM(),Hn(hu),Hn(To),dz();break;case 5:hz(r);break;case 4:IM();break;case 13:Hn(fs);break;case 19:Hn(fs);break;case 10:oz(r.type._context);break;case 22:case 23:Sz()}t=t.return}if(Za=i,zs=i=Bm(i.current,null),ro=Pu=e,Oa=0,SA=null,xz=LI=tw=0,ru=GT=null,P1!==null){for(e=0;e<P1.length;e++)if(t=P1[e],r=t.interleaved,r!==null){t.interleaved=null;var n=r.next,l=t.pending;if(l!==null){var c=l.next;l.next=n,r.next=c}t.pending=r}P1=null}return i}function m8(i,e){do{var t=zs;try{if(az(),FP.current=TR,ER){for(var r=ms.memoizedState;r!==null;){var n=r.queue;n!==null&&(n.pending=null),r=r.next}ER=!1}if(ew=0,ja=Ra=ms=null,WT=!1,xA=0,_z.current=null,t===null||t.return===null){Oa=1,SA=e,zs=null;break}e:{var l=i,c=t.return,h=t,d=e;if(e=ro,h.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var f=d,m=h,g=m.tag;if(!(m.mode&1)&&(g===0||g===11||g===15)){var y=m.alternate;y?(m.updateQueue=y.updateQueue,m.memoizedState=y.memoizedState,m.lanes=y.lanes):(m.updateQueue=null,m.memoizedState=null)}var _=C5(c);if(_!==null){_.flags&=-257,P5(_,c,h,l,e),_.mode&1&&A5(l,f,e),e=_,d=f;var b=e.updateQueue;if(b===null){var S=new Set;S.add(d),e.updateQueue=S}else b.add(d);break e}else{if(!(e&1)){A5(l,f,e),Mz();break e}d=Error(Et(426))}}else if(Xn&&h.mode&1){var E=C5(c);if(E!==null){!(E.flags&65536)&&(E.flags|=256),P5(E,c,h,l,e),nz(LM(d,h));break e}}l=d=LM(d,h),Oa!==4&&(Oa=2),GT===null?GT=[l]:GT.push(l),l=c;do{switch(l.tag){case 3:l.flags|=65536,e&=-e,l.lanes|=e;var T=K9(l,d,e);x5(l,T);break e;case 1:h=d;var A=l.type,P=l.stateNode;if(!(l.flags&128)&&(typeof A.getDerivedStateFromError=="function"||P!==null&&typeof P.componentDidCatch=="function"&&(Fm===null||!Fm.has(P)))){l.flags|=65536,e&=-e,l.lanes|=e;var O=Q9(l,h,e);x5(l,O);break e}}l=l.return}while(l!==null)}y8(t)}catch(R){e=R,zs===t&&t!==null&&(zs=t=t.return);continue}break}while(!0)}function g8(){var i=AR.current;return AR.current=TR,i===null?TR:i}function Mz(){(Oa===0||Oa===3||Oa===2)&&(Oa=4),Za===null||!(tw&268435455)&&!(LI&268435455)||Mm(Za,ro)}function RR(i,e){var t=Jr;Jr|=2;var r=g8();(Za!==i||ro!==e)&&(sp=null,H1(i,e));do try{jee();break}catch(n){m8(i,n)}while(!0);if(az(),Jr=t,AR.current=r,zs!==null)throw Error(Et(261));return Za=null,ro=0,Oa}function jee(){for(;zs!==null;)v8(zs)}function Gee(){for(;zs!==null&&!vQ();)v8(zs)}function v8(i){var e=x8(i.alternate,i,Pu);i.memoizedProps=i.pendingProps,e===null?y8(i):zs=e,_z.current=null}function y8(i){var e=i;do{var t=e.alternate;if(i=e.return,e.flags&32768){if(t=Bee(t,e),t!==null){t.flags&=32767,zs=t;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Oa=6,zs=null;return}}else if(t=zee(t,e,Pu),t!==null){zs=t;return}if(e=e.sibling,e!==null){zs=e;return}zs=e=i}while(e!==null);Oa===0&&(Oa=5)}function b1(i,e,t){var r=gn,n=nc.transition;try{nc.transition=null,gn=1,qee(i,e,t,r)}finally{nc.transition=n,gn=r}return null}function qee(i,e,t,r){do dM();while(Rm!==null);if(Jr&6)throw Error(Et(327));t=i.finishedWork;var n=i.finishedLanes;if(t===null)return null;if(i.finishedWork=null,i.finishedLanes=0,t===i.current)throw Error(Et(177));i.callbackNode=null,i.callbackPriority=0;var l=t.lanes|t.childLanes;if(AQ(i,l),i===Za&&(zs=Za=null,ro=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||i2||(i2=!0,b8(hR,function(){return dM(),null})),l=(t.flags&15990)!==0,t.subtreeFlags&15990||l){l=nc.transition,nc.transition=null;var c=gn;gn=1;var h=Jr;Jr|=4,_z.current=null,Hee(i,t),d8(t,i),fee(Mk),fR=!!Sk,Mk=Sk=null,i.current=t,$ee(t),yQ(),Jr=h,gn=c,nc.transition=l}else i.current=t;if(i2&&(i2=!1,Rm=i,PR=n),l=i.pendingLanes,l===0&&(Fm=null),bQ(t.stateNode),fu(i,As()),e!==null)for(r=i.onRecoverableError,t=0;t<e.length;t++)n=e[t],r(n.value,{componentStack:n.stack,digest:n.digest});if(CR)throw CR=!1,i=Wk,Wk=null,i;return PR&1&&i.tag!==0&&dM(),l=i.pendingLanes,l&1?i===jk?qT++:(qT=0,jk=i):qT=0,ng(),null}function dM(){if(Rm!==null){var i=YG(PR),e=nc.transition,t=gn;try{if(nc.transition=null,gn=16>i?16:i,Rm===null)var r=!1;else{if(i=Rm,Rm=null,PR=0,Jr&6)throw Error(Et(331));var n=Jr;for(Jr|=4,ni=i.current;ni!==null;){var l=ni,c=l.child;if(ni.flags&16){var h=l.deletions;if(h!==null){for(var d=0;d<h.length;d++){var f=h[d];for(ni=f;ni!==null;){var m=ni;switch(m.tag){case 0:case 11:case 15:jT(8,m,l)}var g=m.child;if(g!==null)g.return=m,ni=g;else for(;ni!==null;){m=ni;var y=m.sibling,_=m.return;if(u8(m),m===f){ni=null;break}if(y!==null){y.return=_,ni=y;break}ni=_}}}var b=l.alternate;if(b!==null){var S=b.child;if(S!==null){b.child=null;do{var E=S.sibling;S.sibling=null,S=E}while(S!==null)}}ni=l}}if(l.subtreeFlags&2064&&c!==null)c.return=l,ni=c;else e:for(;ni!==null;){if(l=ni,l.flags&2048)switch(l.tag){case 0:case 11:case 15:jT(9,l,l.return)}var T=l.sibling;if(T!==null){T.return=l.return,ni=T;break e}ni=l.return}}var A=i.current;for(ni=A;ni!==null;){c=ni;var P=c.child;if(c.subtreeFlags&2064&&P!==null)P.return=c,ni=P;else e:for(c=A;ni!==null;){if(h=ni,h.flags&2048)try{switch(h.tag){case 0:case 11:case 15:II(9,h)}}catch(R){xs(h,h.return,R)}if(h===c){ni=null;break e}var O=h.sibling;if(O!==null){O.return=h.return,ni=O;break e}ni=h.return}}if(Jr=n,ng(),yf&&typeof yf.onPostCommitFiberRoot=="function")try{yf.onPostCommitFiberRoot(SI,i)}catch{}r=!0}return r}finally{gn=t,nc.transition=e}}return!1}function $5(i,e,t){e=LM(t,e),e=K9(i,e,1),i=km(i,e,1),e=ql(),i!==null&&(fC(i,1,e),fu(i,e))}function xs(i,e,t){if(i.tag===3)$5(i,i,t);else for(;e!==null;){if(e.tag===3){$5(e,i,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Fm===null||!Fm.has(r))){i=LM(t,i),i=Q9(e,i,1),e=km(e,i,1),i=ql(),e!==null&&(fC(e,1,i),fu(e,i));break}}e=e.return}}function Xee(i,e,t){var r=i.pingCache;r!==null&&r.delete(e),e=ql(),i.pingedLanes|=i.suspendedLanes&t,Za===i&&(ro&t)===t&&(Oa===4||Oa===3&&(ro&130023424)===ro&&500>As()-bz?H1(i,0):xz|=t),fu(i,e)}function _8(i,e){e===0&&(i.mode&1?(e=GC,GC<<=1,!(GC&130023424)&&(GC=4194304)):e=1);var t=ql();i=Mp(i,e),i!==null&&(fC(i,e,t),fu(i,t))}function Zee(i){var e=i.memoizedState,t=0;e!==null&&(t=e.retryLane),_8(i,t)}function Jee(i,e){var t=0;switch(i.tag){case 13:var r=i.stateNode,n=i.memoizedState;n!==null&&(t=n.retryLane);break;case 19:r=i.stateNode;break;default:throw Error(Et(314))}r!==null&&r.delete(e),_8(i,t)}var x8;x8=function(i,e,t){if(i!==null)if(i.memoizedProps!==e.pendingProps||hu.current)uu=!0;else{if(!(i.lanes&t)&&!(e.flags&128))return uu=!1,Fee(i,e,t);uu=!!(i.flags&131072)}else uu=!1,Xn&&e.flags&1048576&&S9(e,xR,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;BP(i,e),i=e.pendingProps;var n=CM(e,To.current);hM(e,t),n=pz(null,e,r,i,n,t);var l=mz();return e.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,du(r)?(l=!0,yR(e)):l=!1,e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,uz(e),n.updater=PI,e.stateNode=n,n._reactInternals=e,Ok(e,r,i,t),e=kk(null,e,r,!0,l,t)):(e.tag=0,Xn&&l&&iz(e),Vl(null,e,n,t),e=e.child),e;case 16:r=e.elementType;e:{switch(BP(i,e),i=e.pendingProps,n=r._init,r=n(r._payload),e.type=r,n=e.tag=Kee(r),i=Od(r,i),n){case 0:e=Dk(null,e,r,i,t);break e;case 1:e=L5(null,e,r,i,t);break e;case 11:e=R5(null,e,r,i,t);break e;case 14:e=I5(null,e,r,Od(r.type,i),t);break e}throw Error(Et(306,r,""))}return e;case 0:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:Od(r,n),Dk(i,e,r,n,t);case 1:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:Od(r,n),L5(i,e,r,n,t);case 3:e:{if(r8(e),i===null)throw Error(Et(387));r=e.pendingProps,l=e.memoizedState,n=l.element,A9(i,e),SR(e,r,null,t);var c=e.memoizedState;if(r=c.element,l.isDehydrated)if(l={element:r,isDehydrated:!1,cache:c.cache,pendingSuspenseBoundaries:c.pendingSuspenseBoundaries,transitions:c.transitions},e.updateQueue.baseState=l,e.memoizedState=l,e.flags&256){n=LM(Error(Et(423)),e),e=O5(i,e,r,t,n);break e}else if(r!==n){n=LM(Error(Et(424)),e),e=O5(i,e,r,t,n);break e}else for(Lu=Dm(e.stateNode.containerInfo.firstChild),Ou=e,Xn=!0,kd=null,t=I9(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(PM(),r===n){e=Ep(i,e,t);break e}Vl(i,e,r,t)}e=e.child}return e;case 5:return L9(e),i===null&&Rk(e),r=e.type,n=e.pendingProps,l=i!==null?i.memoizedProps:null,c=n.children,Ek(r,n)?c=null:l!==null&&Ek(r,l)&&(e.flags|=32),i8(i,e),Vl(i,e,c,t),e.child;case 6:return i===null&&Rk(e),null;case 13:return n8(i,e,t);case 4:return cz(e,e.stateNode.containerInfo),r=e.pendingProps,i===null?e.child=RM(e,null,r,t):Vl(i,e,r,t),e.child;case 11:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:Od(r,n),R5(i,e,r,n,t);case 7:return Vl(i,e,e.pendingProps,t),e.child;case 8:return Vl(i,e,e.pendingProps.children,t),e.child;case 12:return Vl(i,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,n=e.pendingProps,l=e.memoizedProps,c=n.value,zn(bR,r._currentValue),r._currentValue=c,l!==null)if(qd(l.value,c)){if(l.children===n.children&&!hu.current){e=Ep(i,e,t);break e}}else for(l=e.child,l!==null&&(l.return=e);l!==null;){var h=l.dependencies;if(h!==null){c=l.child;for(var d=h.firstContext;d!==null;){if(d.context===r){if(l.tag===1){d=gp(-1,t&-t),d.tag=2;var f=l.updateQueue;if(f!==null){f=f.shared;var m=f.pending;m===null?d.next=d:(d.next=m.next,m.next=d),f.pending=d}}l.lanes|=t,d=l.alternate,d!==null&&(d.lanes|=t),Ik(l.return,t,e),h.lanes|=t;break}d=d.next}}else if(l.tag===10)c=l.type===e.type?null:l.child;else if(l.tag===18){if(c=l.return,c===null)throw Error(Et(341));c.lanes|=t,h=c.alternate,h!==null&&(h.lanes|=t),Ik(c,t,e),c=l.sibling}else c=l.child;if(c!==null)c.return=l;else for(c=l;c!==null;){if(c===e){c=null;break}if(l=c.sibling,l!==null){l.return=c.return,c=l;break}c=c.return}l=c}Vl(i,e,n.children,t),e=e.child}return e;case 9:return n=e.type,r=e.pendingProps.children,hM(e,t),n=ac(n),r=r(n),e.flags|=1,Vl(i,e,r,t),e.child;case 14:return r=e.type,n=Od(r,e.pendingProps),n=Od(r.type,n),I5(i,e,r,n,t);case 15:return e8(i,e,e.type,e.pendingProps,t);case 17:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:Od(r,n),BP(i,e),e.tag=1,du(r)?(i=!0,yR(e)):i=!1,hM(e,t),P9(e,r,n),Ok(e,r,n,t),kk(null,e,r,!0,i,t);case 19:return s8(i,e,t);case 22:return t8(i,e,t)}throw Error(Et(156,e.tag))};function b8(i,e){return qG(i,e)}function Yee(i,e,t,r){this.tag=i,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function tc(i,e,t,r){return new Yee(i,e,t,r)}function Ez(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Kee(i){if(typeof i=="function")return Ez(i)?1:0;if(i!=null){if(i=i.$$typeof,i===W4)return 11;if(i===j4)return 14}return 2}function Bm(i,e){var t=i.alternate;return t===null?(t=tc(i.tag,e,i.key,i.mode),t.elementType=i.elementType,t.type=i.type,t.stateNode=i.stateNode,t.alternate=i,i.alternate=t):(t.pendingProps=e,t.type=i.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=i.flags&14680064,t.childLanes=i.childLanes,t.lanes=i.lanes,t.child=i.child,t.memoizedProps=i.memoizedProps,t.memoizedState=i.memoizedState,t.updateQueue=i.updateQueue,e=i.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=i.sibling,t.index=i.index,t.ref=i.ref,t}function $P(i,e,t,r,n,l){var c=2;if(r=i,typeof i=="function")Ez(i)&&(c=1);else if(typeof i=="string")c=5;else e:switch(i){case BS:return $1(t.children,n,l,e);case V4:c=8,n|=8;break;case rk:return i=tc(12,t,e,n|2),i.elementType=rk,i.lanes=l,i;case nk:return i=tc(13,t,e,n),i.elementType=nk,i.lanes=l,i;case sk:return i=tc(19,t,e,n),i.elementType=sk,i.lanes=l,i;case RG:return OI(t,n,l,e);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case CG:c=10;break e;case PG:c=9;break e;case W4:c=11;break e;case j4:c=14;break e;case vm:c=16,r=null;break e}throw Error(Et(130,i==null?i:typeof i,""))}return e=tc(c,t,e,n),e.elementType=i,e.type=r,e.lanes=l,e}function $1(i,e,t,r){return i=tc(7,i,r,e),i.lanes=t,i}function OI(i,e,t,r){return i=tc(22,i,r,e),i.elementType=RG,i.lanes=t,i.stateNode={isHidden:!1},i}function tO(i,e,t){return i=tc(6,i,null,e),i.lanes=t,i}function iO(i,e,t){return e=tc(4,i.children!==null?i.children:[],i.key,e),e.lanes=t,e.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},e}function Qee(i,e,t,r,n){this.tag=e,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=kL(0),this.expirationTimes=kL(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=kL(0),this.identifierPrefix=r,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function Tz(i,e,t,r,n,l,c,h,d){return i=new Qee(i,e,t,h,d),e===1?(e=1,l===!0&&(e|=8)):e=0,l=tc(3,null,null,e),i.current=l,l.stateNode=i,l.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},uz(l),i}function ete(i,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:zS,key:r==null?null:""+r,children:i,containerInfo:e,implementation:t}}function w8(i){if(!i)return Zm;i=i._reactInternals;e:{if(vw(i)!==i||i.tag!==1)throw Error(Et(170));var e=i;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(du(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Et(171))}if(i.tag===1){var t=i.type;if(du(t))return b9(i,t,e)}return e}function S8(i,e,t,r,n,l,c,h,d){return i=Tz(t,r,!0,i,n,l,c,h,d),i.context=w8(null),t=i.current,r=ql(),n=zm(t),l=gp(r,n),l.callback=e??null,km(t,l,n),i.current.lanes=n,fC(i,n,r),fu(i,r),i}function NI(i,e,t,r){var n=e.current,l=ql(),c=zm(n);return t=w8(t),e.context===null?e.context=t:e.pendingContext=t,e=gp(l,c),e.payload={element:i},r=r===void 0?null:r,r!==null&&(e.callback=r),i=km(n,e,c),i!==null&&($d(i,n,c,l),kP(i,n,c)),c}function IR(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function V5(i,e){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var t=i.retryLane;i.retryLane=t!==0&&t<e?t:e}}function Az(i,e){V5(i,e),(i=i.alternate)&&V5(i,e)}function tte(){return null}var M8=typeof reportError=="function"?reportError:function(i){console.error(i)};function Cz(i){this._internalRoot=i}DI.prototype.render=Cz.prototype.render=function(i){var e=this._internalRoot;if(e===null)throw Error(Et(409));NI(i,e,null,null)};DI.prototype.unmount=Cz.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var e=i.containerInfo;iw(function(){NI(null,i,null,null)}),e[Sp]=null}};function DI(i){this._internalRoot=i}DI.prototype.unstable_scheduleHydration=function(i){if(i){var e=e9();i={blockedOn:null,target:i,priority:e};for(var t=0;t<Sm.length&&e!==0&&e<Sm[t].priority;t++);Sm.splice(t,0,i),t===0&&i9(i)}};function Pz(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function kI(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function W5(){}function ite(i,e,t,r,n){if(n){if(typeof r=="function"){var l=r;r=function(){var f=IR(c);l.call(f)}}var c=S8(e,r,i,0,null,!1,!1,"",W5);return i._reactRootContainer=c,i[Sp]=c.current,mA(i.nodeType===8?i.parentNode:i),iw(),c}for(;n=i.lastChild;)i.removeChild(n);if(typeof r=="function"){var h=r;r=function(){var f=IR(d);h.call(f)}}var d=Tz(i,0,!1,null,null,!1,!1,"",W5);return i._reactRootContainer=d,i[Sp]=d.current,mA(i.nodeType===8?i.parentNode:i),iw(function(){NI(e,d,t,r)}),d}function FI(i,e,t,r,n){var l=t._reactRootContainer;if(l){var c=l;if(typeof n=="function"){var h=n;n=function(){var d=IR(c);h.call(d)}}NI(e,c,i,n)}else c=ite(t,e,i,n,r);return IR(c)}KG=function(i){switch(i.tag){case 3:var e=i.stateNode;if(e.current.memoizedState.isDehydrated){var t=RT(e.pendingLanes);t!==0&&(X4(e,t|1),fu(e,As()),!(Jr&6)&&(OM=As()+500,ng()))}break;case 13:iw(function(){var r=Mp(i,1);if(r!==null){var n=ql();$d(r,i,1,n)}}),Az(i,1)}};Z4=function(i){if(i.tag===13){var e=Mp(i,134217728);if(e!==null){var t=ql();$d(e,i,134217728,t)}Az(i,134217728)}};QG=function(i){if(i.tag===13){var e=zm(i),t=Mp(i,e);if(t!==null){var r=ql();$d(t,i,e,r)}Az(i,e)}};e9=function(){return gn};t9=function(i,e){var t=gn;try{return gn=i,e()}finally{gn=t}};mk=function(i,e,t){switch(e){case"input":if(lk(i,t),e=t.name,t.type==="radio"&&e!=null){for(t=i;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==i&&r.form===i.form){var n=AI(r);if(!n)throw Error(Et(90));LG(r),lk(r,n)}}}break;case"textarea":NG(i,t);break;case"select":e=t.value,e!=null&&oM(i,!!t.multiple,e,!1)}};HG=wz;$G=iw;var rte={usingClientEntryPoint:!1,Events:[mC,VS,AI,BG,UG,wz]},BE={findFiberByHostInstance:C1,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},nte={bundleType:BE.bundleType,version:BE.version,rendererPackageName:BE.rendererPackageName,rendererConfig:BE.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Fp.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=jG(i),i===null?null:i.stateNode},findFiberByHostInstance:BE.findFiberByHostInstance||tte,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var r2=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!r2.isDisabled&&r2.supportsFiber)try{SI=r2.inject(nte),yf=r2}catch{}}Uu.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rte;Uu.createPortal=function(i,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Pz(e))throw Error(Et(200));return ete(i,e,null,t)};Uu.createRoot=function(i,e){if(!Pz(i))throw Error(Et(299));var t=!1,r="",n=M8;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(n=e.onRecoverableError)),e=Tz(i,1,!1,null,null,t,!1,r,n),i[Sp]=e.current,mA(i.nodeType===8?i.parentNode:i),new Cz(e)};Uu.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var e=i._reactInternals;if(e===void 0)throw typeof i.render=="function"?Error(Et(188)):(i=Object.keys(i).join(","),Error(Et(268,i)));return i=jG(e),i=i===null?null:i.stateNode,i};Uu.flushSync=function(i){return iw(i)};Uu.hydrate=function(i,e,t){if(!kI(e))throw Error(Et(200));return FI(null,i,e,!0,t)};Uu.hydrateRoot=function(i,e,t){if(!Pz(i))throw Error(Et(405));var r=t!=null&&t.hydratedSources||null,n=!1,l="",c=M8;if(t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(l=t.identifierPrefix),t.onRecoverableError!==void 0&&(c=t.onRecoverableError)),e=S8(e,null,i,1,t??null,n,!1,l,c),i[Sp]=e.current,mA(i),r)for(i=0;i<r.length;i++)t=r[i],n=t._getVersion,n=n(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,n]:e.mutableSourceEagerHydrationData.push(t,n);return new DI(e)};Uu.render=function(i,e,t){if(!kI(e))throw Error(Et(200));return FI(null,i,e,!1,t)};Uu.unmountComponentAtNode=function(i){if(!kI(i))throw Error(Et(40));return i._reactRootContainer?(iw(function(){FI(null,null,i,!1,function(){i._reactRootContainer=null,i[Sp]=null})}),!0):!1};Uu.unstable_batchedUpdates=wz;Uu.unstable_renderSubtreeIntoContainer=function(i,e,t,r){if(!kI(t))throw Error(Et(200));if(i==null||i._reactInternals===void 0)throw Error(Et(38));return FI(i,e,t,!1,r)};Uu.version="18.2.0-next-9e3b772b8-20220608";function E8(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(E8)}catch(i){console.error(i)}}E8(),SG.exports=Uu;var T8=SG.exports,j5=T8;tk.createRoot=j5.createRoot,tk.hydrateRoot=j5.hydrateRoot;/**
 * @remix-run/router v1.15.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function MA(){return MA=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},MA.apply(this,arguments)}var Im;(function(i){i.Pop="POP",i.Push="PUSH",i.Replace="REPLACE"})(Im||(Im={}));const G5="popstate";function ste(i){i===void 0&&(i={});function e(r,n){let{pathname:l,search:c,hash:h}=r.location;return Xk("",{pathname:l,search:c,hash:h},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function t(r,n){return typeof n=="string"?n:C8(n)}return ote(e,t,null,i)}function Na(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function A8(i,e){if(!i){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function ate(){return Math.random().toString(36).substr(2,8)}function q5(i,e){return{usr:i.state,key:i.key,idx:e}}function Xk(i,e,t,r){return t===void 0&&(t=null),MA({pathname:typeof i=="string"?i:i.pathname,search:"",hash:""},typeof e=="string"?sE(e):e,{state:t,key:e&&e.key||r||ate()})}function C8(i){let{pathname:e="/",search:t="",hash:r=""}=i;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function sE(i){let e={};if(i){let t=i.indexOf("#");t>=0&&(e.hash=i.substr(t),i=i.substr(0,t));let r=i.indexOf("?");r>=0&&(e.search=i.substr(r),i=i.substr(0,r)),i&&(e.pathname=i)}return e}function ote(i,e,t,r){r===void 0&&(r={});let{window:n=document.defaultView,v5Compat:l=!1}=r,c=n.history,h=Im.Pop,d=null,f=m();f==null&&(f=0,c.replaceState(MA({},c.state,{idx:f}),""));function m(){return(c.state||{idx:null}).idx}function g(){h=Im.Pop;let E=m(),T=E==null?null:E-f;f=E,d&&d({action:h,location:S.location,delta:T})}function y(E,T){h=Im.Push;let A=Xk(S.location,E,T);t&&t(A,E),f=m()+1;let P=q5(A,f),O=S.createHref(A);try{c.pushState(P,"",O)}catch(R){if(R instanceof DOMException&&R.name==="DataCloneError")throw R;n.location.assign(O)}l&&d&&d({action:h,location:S.location,delta:1})}function _(E,T){h=Im.Replace;let A=Xk(S.location,E,T);t&&t(A,E),f=m();let P=q5(A,f),O=S.createHref(A);c.replaceState(P,"",O),l&&d&&d({action:h,location:S.location,delta:0})}function b(E){let T=n.location.origin!=="null"?n.location.origin:n.location.href,A=typeof E=="string"?E:C8(E);return A=A.replace(/ $/,"%20"),Na(T,"No window.location.(origin|href) available to create URL for href: "+A),new URL(A,T)}let S={get action(){return h},get location(){return i(n,c)},listen(E){if(d)throw new Error("A history only accepts one active listener");return n.addEventListener(G5,g),d=E,()=>{n.removeEventListener(G5,g),d=null}},createHref(E){return e(n,E)},createURL:b,encodeLocation(E){let T=b(E);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:y,replace:_,go(E){return c.go(E)}};return S}var X5;(function(i){i.data="data",i.deferred="deferred",i.redirect="redirect",i.error="error"})(X5||(X5={}));function lte(i,e,t){t===void 0&&(t="/");let r=typeof e=="string"?sE(e):e,n=I8(r.pathname||"/",t);if(n==null)return null;let l=P8(i);ute(l);let c=null;for(let h=0;c==null&&h<l.length;++h){let d=bte(n);c=yte(l[h],d)}return c}function P8(i,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let n=(l,c,h)=>{let d={relativePath:h===void 0?l.path||"":h,caseSensitive:l.caseSensitive===!0,childrenIndex:c,route:l};d.relativePath.startsWith("/")&&(Na(d.relativePath.startsWith(r),'Absolute route path "'+d.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),d.relativePath=d.relativePath.slice(r.length));let f=V1([r,d.relativePath]),m=t.concat(d);l.children&&l.children.length>0&&(Na(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+f+'".')),P8(l.children,e,m,f)),!(l.path==null&&!l.index)&&e.push({path:f,score:gte(f,l.index),routesMeta:m})};return i.forEach((l,c)=>{var h;if(l.path===""||!((h=l.path)!=null&&h.includes("?")))n(l,c);else for(let d of R8(l.path))n(l,c,d)}),e}function R8(i){let e=i.split("/");if(e.length===0)return[];let[t,...r]=e,n=t.endsWith("?"),l=t.replace(/\?$/,"");if(r.length===0)return n?[l,""]:[l];let c=R8(r.join("/")),h=[];return h.push(...c.map(d=>d===""?l:[l,d].join("/"))),n&&h.push(...c),h.map(d=>i.startsWith("/")&&d===""?"/":d)}function ute(i){i.sort((e,t)=>e.score!==t.score?t.score-e.score:vte(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const cte=/^:[\w-]+$/,hte=3,dte=2,fte=1,pte=10,mte=-2,Z5=i=>i==="*";function gte(i,e){let t=i.split("/"),r=t.length;return t.some(Z5)&&(r+=mte),e&&(r+=dte),t.filter(n=>!Z5(n)).reduce((n,l)=>n+(cte.test(l)?hte:l===""?fte:pte),r)}function vte(i,e){return i.length===e.length&&i.slice(0,-1).every((r,n)=>r===e[n])?i[i.length-1]-e[e.length-1]:0}function yte(i,e){let{routesMeta:t}=i,r={},n="/",l=[];for(let c=0;c<t.length;++c){let h=t[c],d=c===t.length-1,f=n==="/"?e:e.slice(n.length)||"/",m=_te({path:h.relativePath,caseSensitive:h.caseSensitive,end:d},f);if(!m)return null;Object.assign(r,m.params);let g=h.route;l.push({params:r,pathname:V1([n,m.pathname]),pathnameBase:Ate(V1([n,m.pathnameBase])),route:g}),m.pathnameBase!=="/"&&(n=V1([n,m.pathnameBase]))}return l}function _te(i,e){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[t,r]=xte(i.path,i.caseSensitive,i.end),n=e.match(t);if(!n)return null;let l=n[0],c=l.replace(/(.)\/+$/,"$1"),h=n.slice(1);return{params:r.reduce((f,m,g)=>{let{paramName:y,isOptional:_}=m;if(y==="*"){let S=h[g]||"";c=l.slice(0,l.length-S.length).replace(/(.)\/+$/,"$1")}const b=h[g];return _&&!b?f[y]=void 0:f[y]=(b||"").replace(/%2F/g,"/"),f},{}),pathname:l,pathnameBase:c,pattern:i}}function xte(i,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),A8(i==="*"||!i.endsWith("*")||i.endsWith("/*"),'Route path "'+i+'" will be treated as if it were '+('"'+i.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+i.replace(/\*$/,"/*")+'".'));let r=[],n="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,h,d)=>(r.push({paramName:h,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return i.endsWith("*")?(r.push({paramName:"*"}),n+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?n+="\\/*$":i!==""&&i!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,e?void 0:"i"),r]}function bte(i){try{return i.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return A8(!1,'The URL path "'+i+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),i}}function I8(i,e){if(e==="/")return i;if(!i.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=i.charAt(t);return r&&r!=="/"?null:i.slice(t)||"/"}function wte(i,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:n=""}=typeof i=="string"?sE(i):i;return{pathname:t?t.startsWith("/")?t:Ste(t,e):e,search:Cte(r),hash:Pte(n)}}function Ste(i,e){let t=e.replace(/\/+$/,"").split("/");return i.split("/").forEach(n=>{n===".."?t.length>1&&t.pop():n!=="."&&t.push(n)}),t.length>1?t.join("/"):"/"}function rO(i,e,t,r){return"Cannot include a '"+i+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Mte(i){return i.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Ete(i,e){let t=Mte(i);return e?t.map((r,n)=>n===i.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function Tte(i,e,t,r){r===void 0&&(r=!1);let n;typeof i=="string"?n=sE(i):(n=MA({},i),Na(!n.pathname||!n.pathname.includes("?"),rO("?","pathname","search",n)),Na(!n.pathname||!n.pathname.includes("#"),rO("#","pathname","hash",n)),Na(!n.search||!n.search.includes("#"),rO("#","search","hash",n)));let l=i===""||n.pathname==="",c=l?"/":n.pathname,h;if(c==null)h=t;else{let g=e.length-1;if(!r&&c.startsWith("..")){let y=c.split("/");for(;y[0]==="..";)y.shift(),g-=1;n.pathname=y.join("/")}h=g>=0?e[g]:"/"}let d=wte(n,h),f=c&&c!=="/"&&c.endsWith("/"),m=(l||c===".")&&t.endsWith("/");return!d.pathname.endsWith("/")&&(f||m)&&(d.pathname+="/"),d}const V1=i=>i.join("/").replace(/\/\/+/g,"/"),Ate=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),Cte=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,Pte=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i;function Rte(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}const L8=["post","put","patch","delete"];new Set(L8);const Ite=["get",...L8];new Set(Ite);/**
 * React Router v6.22.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function EA(){return EA=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},EA.apply(this,arguments)}const Rz=Ze.createContext(null),Lte=Ze.createContext(null),zI=Ze.createContext(null),BI=Ze.createContext(null),aE=Ze.createContext({outlet:null,matches:[],isDataRoute:!1}),O8=Ze.createContext(null);function UI(){return Ze.useContext(BI)!=null}function Iz(){return UI()||Na(!1),Ze.useContext(BI).location}function N8(i){Ze.useContext(zI).static||Ze.useLayoutEffect(i)}function Ote(){let{isDataRoute:i}=Ze.useContext(aE);return i?Gte():Nte()}function Nte(){UI()||Na(!1);let i=Ze.useContext(Rz),{basename:e,future:t,navigator:r}=Ze.useContext(zI),{matches:n}=Ze.useContext(aE),{pathname:l}=Iz(),c=JSON.stringify(Ete(n,t.v7_relativeSplatPath)),h=Ze.useRef(!1);return N8(()=>{h.current=!0}),Ze.useCallback(function(f,m){if(m===void 0&&(m={}),!h.current)return;if(typeof f=="number"){r.go(f);return}let g=Tte(f,JSON.parse(c),l,m.relative==="path");i==null&&e!=="/"&&(g.pathname=g.pathname==="/"?e:V1([e,g.pathname])),(m.replace?r.replace:r.push)(g,m.state,m)},[e,r,c,l,i])}function Dte(i,e){return kte(i,e)}function kte(i,e,t,r){UI()||Na(!1);let{navigator:n}=Ze.useContext(zI),{matches:l}=Ze.useContext(aE),c=l[l.length-1],h=c?c.params:{};c&&c.pathname;let d=c?c.pathnameBase:"/";c&&c.route;let f=Iz(),m;if(e){var g;let E=typeof e=="string"?sE(e):e;d==="/"||(g=E.pathname)!=null&&g.startsWith(d)||Na(!1),m=E}else m=f;let y=m.pathname||"/",_=y;if(d!=="/"){let E=d.replace(/^\//,"").split("/");_="/"+y.replace(/^\//,"").split("/").slice(E.length).join("/")}let b=lte(i,{pathname:_}),S=Hte(b&&b.map(E=>Object.assign({},E,{params:Object.assign({},h,E.params),pathname:V1([d,n.encodeLocation?n.encodeLocation(E.pathname).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?d:V1([d,n.encodeLocation?n.encodeLocation(E.pathnameBase).pathname:E.pathnameBase])})),l,t,r);return e&&S?Ze.createElement(BI.Provider,{value:{location:EA({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:Im.Pop}},S):S}function Fte(){let i=jte(),e=Rte(i)?i.status+" "+i.statusText:i instanceof Error?i.message:JSON.stringify(i),t=i instanceof Error?i.stack:null,n={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return Ze.createElement(Ze.Fragment,null,Ze.createElement("h2",null,"Unexpected Application Error!"),Ze.createElement("h3",{style:{fontStyle:"italic"}},e),t?Ze.createElement("pre",{style:n},t):null,null)}const zte=Ze.createElement(Fte,null);class Bte extends Ze.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?Ze.createElement(aE.Provider,{value:this.props.routeContext},Ze.createElement(O8.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Ute(i){let{routeContext:e,match:t,children:r}=i,n=Ze.useContext(Rz);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),Ze.createElement(aE.Provider,{value:e},r)}function Hte(i,e,t,r){var n;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),i==null){var l;if((l=t)!=null&&l.errors)i=t.matches;else return null}let c=i,h=(n=t)==null?void 0:n.errors;if(h!=null){let m=c.findIndex(g=>g.route.id&&(h==null?void 0:h[g.route.id]));m>=0||Na(!1),c=c.slice(0,Math.min(c.length,m+1))}let d=!1,f=-1;if(t&&r&&r.v7_partialHydration)for(let m=0;m<c.length;m++){let g=c[m];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(f=m),g.route.id){let{loaderData:y,errors:_}=t,b=g.route.loader&&y[g.route.id]===void 0&&(!_||_[g.route.id]===void 0);if(g.route.lazy||b){d=!0,f>=0?c=c.slice(0,f+1):c=[c[0]];break}}}return c.reduceRight((m,g,y)=>{let _,b=!1,S=null,E=null;t&&(_=h&&g.route.id?h[g.route.id]:void 0,S=g.route.errorElement||zte,d&&(f<0&&y===0?(qte("route-fallback",!1),b=!0,E=null):f===y&&(b=!0,E=g.route.hydrateFallbackElement||null)));let T=e.concat(c.slice(0,y+1)),A=()=>{let P;return _?P=S:b?P=E:g.route.Component?P=Ze.createElement(g.route.Component,null):g.route.element?P=g.route.element:P=m,Ze.createElement(Ute,{match:g,routeContext:{outlet:m,matches:T,isDataRoute:t!=null},children:P})};return t&&(g.route.ErrorBoundary||g.route.errorElement||y===0)?Ze.createElement(Bte,{location:t.location,revalidation:t.revalidation,component:S,error:_,children:A(),routeContext:{outlet:null,matches:T,isDataRoute:!0}}):A()},null)}var D8=function(i){return i.UseBlocker="useBlocker",i.UseRevalidator="useRevalidator",i.UseNavigateStable="useNavigate",i}(D8||{}),LR=function(i){return i.UseBlocker="useBlocker",i.UseLoaderData="useLoaderData",i.UseActionData="useActionData",i.UseRouteError="useRouteError",i.UseNavigation="useNavigation",i.UseRouteLoaderData="useRouteLoaderData",i.UseMatches="useMatches",i.UseRevalidator="useRevalidator",i.UseNavigateStable="useNavigate",i.UseRouteId="useRouteId",i}(LR||{});function $te(i){let e=Ze.useContext(Rz);return e||Na(!1),e}function Vte(i){let e=Ze.useContext(Lte);return e||Na(!1),e}function Wte(i){let e=Ze.useContext(aE);return e||Na(!1),e}function k8(i){let e=Wte(),t=e.matches[e.matches.length-1];return t.route.id||Na(!1),t.route.id}function jte(){var i;let e=Ze.useContext(O8),t=Vte(LR.UseRouteError),r=k8(LR.UseRouteError);return e!==void 0?e:(i=t.errors)==null?void 0:i[r]}function Gte(){let{router:i}=$te(D8.UseNavigateStable),e=k8(LR.UseNavigateStable),t=Ze.useRef(!1);return N8(()=>{t.current=!0}),Ze.useCallback(function(n,l){l===void 0&&(l={}),t.current&&(typeof n=="number"?i.navigate(n):i.navigate(n,EA({fromRouteId:e},l)))},[i,e])}const J5={};function qte(i,e,t){!e&&!J5[i]&&(J5[i]=!0)}function F8(i){Na(!1)}function Xte(i){let{basename:e="/",children:t=null,location:r,navigationType:n=Im.Pop,navigator:l,static:c=!1,future:h}=i;UI()&&Na(!1);let d=e.replace(/^\/*/,"/"),f=Ze.useMemo(()=>({basename:d,navigator:l,static:c,future:EA({v7_relativeSplatPath:!1},h)}),[d,h,l,c]);typeof r=="string"&&(r=sE(r));let{pathname:m="/",search:g="",hash:y="",state:_=null,key:b="default"}=r,S=Ze.useMemo(()=>{let E=I8(m,d);return E==null?null:{location:{pathname:E,search:g,hash:y,state:_,key:b},navigationType:n}},[d,m,g,y,_,b,n]);return S==null?null:Ze.createElement(zI.Provider,{value:f},Ze.createElement(BI.Provider,{children:t,value:S}))}function Zte(i){let{children:e,location:t}=i;return Dte(Zk(e),t)}new Promise(()=>{});function Zk(i,e){e===void 0&&(e=[]);let t=[];return Ze.Children.forEach(i,(r,n)=>{if(!Ze.isValidElement(r))return;let l=[...e,n];if(r.type===Ze.Fragment){t.push.apply(t,Zk(r.props.children,l));return}r.type!==F8&&Na(!1),!r.props.index||!r.props.children||Na(!1);let c={id:r.props.id||l.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(c.children=Zk(r.props.children,l)),t.push(c)}),t}/**
 * React Router DOM v6.22.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Jk(i){return i===void 0&&(i=""),new URLSearchParams(typeof i=="string"||Array.isArray(i)||i instanceof URLSearchParams?i:Object.keys(i).reduce((e,t)=>{let r=i[t];return e.concat(Array.isArray(r)?r.map(n=>[t,n]):[[t,r]])},[]))}function Jte(i,e){let t=Jk(i);return e&&e.forEach((r,n)=>{t.has(n)||e.getAll(n).forEach(l=>{t.append(n,l)})}),t}const Yte="6";try{window.__reactRouterVersion=Yte}catch{}const Kte="startTransition",Y5=ZK[Kte];function Qte(i){let{basename:e,children:t,future:r,window:n}=i,l=Ze.useRef();l.current==null&&(l.current=ste({window:n,v5Compat:!0}));let c=l.current,[h,d]=Ze.useState({action:c.action,location:c.location}),{v7_startTransition:f}=r||{},m=Ze.useCallback(g=>{f&&Y5?Y5(()=>d(g)):d(g)},[d,f]);return Ze.useLayoutEffect(()=>c.listen(m),[c,m]),Ze.createElement(Xte,{basename:e,children:t,location:h.location,navigationType:h.action,navigator:c,future:r})}var K5;(function(i){i.UseScrollRestoration="useScrollRestoration",i.UseSubmit="useSubmit",i.UseSubmitFetcher="useSubmitFetcher",i.UseFetcher="useFetcher",i.useViewTransitionState="useViewTransitionState"})(K5||(K5={}));var Q5;(function(i){i.UseFetcher="useFetcher",i.UseFetchers="useFetchers",i.UseScrollRestoration="useScrollRestoration"})(Q5||(Q5={}));function eie(i){let e=Ze.useRef(Jk(i)),t=Ze.useRef(!1),r=Iz(),n=Ze.useMemo(()=>Jte(r.search,t.current?null:e.current),[r.search]),l=Ote(),c=Ze.useCallback((h,d)=>{const f=Jk(typeof h=="function"?h(n):h);t.current=!0,l("?"+f,d)},[l,n]);return[n,c]}var tie={},iie=Object.create,HI=Object.defineProperty,rie=Object.getOwnPropertyDescriptor,nie=Object.getOwnPropertyNames,e6=Object.getOwnPropertySymbols,sie=Object.getPrototypeOf,z8=Object.prototype.hasOwnProperty,aie=Object.prototype.propertyIsEnumerable,B8=Math.pow,t6=(i,e,t)=>e in i?HI(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,i6=(i,e)=>{for(var t in e||(e={}))z8.call(e,t)&&t6(i,t,e[t]);if(e6)for(var t of e6(e))aie.call(e,t)&&t6(i,t,e[t]);return i},Fa=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),oie=(i,e)=>{for(var t in e)HI(i,t,{get:e[t],enumerable:!0})},lie=(i,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of nie(e))!z8.call(i,n)&&n!==t&&HI(i,n,{get:()=>e[n],enumerable:!(r=rie(e,n))||r.enumerable});return i},$I=(i,e,t)=>(t=i!=null?iie(sie(i)):{},lie(e||!i||!i.__esModule?HI(t,"default",{value:i,enumerable:!0}):t,i)),Ts=(i,e,t)=>new Promise((r,n)=>{var l=d=>{try{h(t.next(d))}catch(f){n(f)}},c=d=>{try{h(t.throw(d))}catch(f){n(f)}},h=d=>d.done?r(d.value):Promise.resolve(d.value).then(l,c);h((t=t.apply(i,e)).next())}),uie=Fa((i,e)=>{(function(){var t,r="4.17.21",n=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",c="Expected a function",h="Invalid `variable` option passed into `_.template`",d="__lodash_hash_undefined__",f=500,m="__lodash_placeholder__",g=1,y=2,_=4,b=1,S=2,E=1,T=2,A=4,P=8,O=16,R=32,D=64,L=128,N=256,U=512,F=30,z="...",G=800,J=16,Z=1,q=2,$=3,H=1/0,X=9007199254740991,re=17976931348623157e292,ae=NaN,he=4294967295,pe=he-1,de=he>>>1,ee=[["ary",L],["bind",E],["bindKey",T],["curry",P],["curryRight",O],["flip",U],["partial",R],["partialRight",D],["rearg",N]],se="[object Arguments]",Y="[object Array]",fe="[object AsyncFunction]",me="[object Boolean]",De="[object Date]",Le="[object DOMException]",Ce="[object Error]",Ae="[object Function]",Ue="[object GeneratorFunction]",Ne="[object Map]",Ge="[object Number]",Ct="[object Null]",it="[object Object]",bt="[object Promise]",Kt="[object Proxy]",kt="[object RegExp]",Pt="[object Set]",_e="[object String]",ce="[object Symbol]",Fe="[object Undefined]",et="[object WeakMap]",Dt="[object WeakSet]",gt="[object ArrayBuffer]",xe="[object DataView]",we="[object Float32Array]",Ve="[object Float64Array]",ut="[object Int8Array]",lt="[object Int16Array]",Ee="[object Int32Array]",_t="[object Uint8Array]",wt="[object Uint8ClampedArray]",Xt="[object Uint16Array]",Ft="[object Uint32Array]",gi=/\b__p \+= '';/g,Rt=/\b(__p \+=) '' \+/g,ci=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ji=/&(?:amp|lt|gt|quot|#39);/g,Ji=/[&<>"']/g,ws=RegExp(ji.source),Jn=RegExp(Ji.source),ao=/<%-([\s\S]+?)%>/g,oo=/<%([\s\S]+?)%>/g,lo=/<%=([\s\S]+?)%>/g,uo=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,vu=/^\w*$/,yu=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ls=/[\\^$.*+?()[\]{}|]/g,_u=RegExp(Ls.source),ye=/^\s+/,je=/\s/,tt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,qe=/\{\n\/\* \[wrapped with (.+)\] \*/,st=/,? & /,si=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ci=/[()=,{}\[\]\/\s]/,yi=/\\(\\)?/g,Xi=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,xr=/\w*$/,Yi=/^[-+]0x[0-9a-f]+$/i,Ki=/^0b[01]+$/i,tn=/^\[object .+?Constructor\]$/,Us=/^0o[0-7]+$/i,co=/^(?:0|[1-9]\d*)$/,Po=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Q=/($^)/,le=/['\n\r\u2028\u2029\\]/g,oe="\\ud800-\\udfff",ve="\\u0300-\\u036f",ke="\\ufe20-\\ufe2f",Oe="\\u20d0-\\u20ff",Je=ve+ke+Oe,mt="\\u2700-\\u27bf",vt="a-z\\xdf-\\xf6\\xf8-\\xff",ct="\\xac\\xb1\\xd7\\xf7",It="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Ht="\\u2000-\\u206f",qi=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ui="A-Z\\xc0-\\xd6\\xd8-\\xde",Ai="\\ufe0e\\ufe0f",Pr=ct+It+Ht+qi,Rr="['’]",Kr="["+oe+"]",or="["+Pr+"]",ui="["+Je+"]",pn="\\d+",_r="["+mt+"]",br="["+vt+"]",jr="[^"+oe+Pr+pn+mt+vt+Ui+"]",Gr="\\ud83c[\\udffb-\\udfff]",Ss="(?:"+ui+"|"+Gr+")",fn="[^"+oe+"]",Qr="(?:\\ud83c[\\udde6-\\uddff]){2}",Yn="[\\ud800-\\udbff][\\udc00-\\udfff]",Vr="["+Ui+"]",xu="\\u200d",Os="(?:"+br+"|"+jr+")",Lf="(?:"+Vr+"|"+jr+")",Hs="(?:"+Rr+"(?:d|ll|m|re|s|t|ve))?",ho="(?:"+Rr+"(?:D|LL|M|RE|S|T|VE))?",Ro=Ss+"?",Io="["+Ai+"]?",Of="(?:"+xu+"(?:"+[fn,Qr,Yn].join("|")+")"+Io+Ro+")*",Nf="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",og="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",uc=Io+Ro+Of,lg="(?:"+[_r,Qr,Yn].join("|")+")"+uc,ug="(?:"+[fn+ui+"?",ui,Qr,Yn,Kr].join("|")+")",cg=RegExp(Rr,"g"),hg=RegExp(ui,"g"),Lo=RegExp(Gr+"(?="+Gr+")|"+ug+uc,"g"),dg=RegExp([Vr+"?"+br+"+"+Hs+"(?="+[or,Vr,"$"].join("|")+")",Lf+"+"+ho+"(?="+[or,Vr+Os,"$"].join("|")+")",Vr+"?"+Os+"+"+Hs,Vr+"+"+ho,og,Nf,pn,lg].join("|"),"g"),fg=RegExp("["+xu+oe+Je+Ai+"]"),pg=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,mg=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],gg=-1,yt={};yt[we]=yt[Ve]=yt[ut]=yt[lt]=yt[Ee]=yt[_t]=yt[wt]=yt[Xt]=yt[Ft]=!0,yt[se]=yt[Y]=yt[gt]=yt[me]=yt[xe]=yt[De]=yt[Ce]=yt[Ae]=yt[Ne]=yt[Ge]=yt[it]=yt[kt]=yt[Pt]=yt[_e]=yt[et]=!1;var pt={};pt[se]=pt[Y]=pt[gt]=pt[xe]=pt[me]=pt[De]=pt[we]=pt[Ve]=pt[ut]=pt[lt]=pt[Ee]=pt[Ne]=pt[Ge]=pt[it]=pt[kt]=pt[Pt]=pt[_e]=pt[ce]=pt[_t]=pt[wt]=pt[Xt]=pt[Ft]=!0,pt[Ce]=pt[Ae]=pt[et]=!1;var vg={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},yg={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},_g={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},xg={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},bg=parseFloat,wg=parseInt,cc=typeof global=="object"&&global&&global.Object===Object&&global,Sg=typeof self=="object"&&self&&self.Object===Object&&self,Gt=cc||Sg||Function("return this")(),Oo=typeof i=="object"&&i&&!i.nodeType&&i,rn=Oo&&typeof e=="object"&&e&&!e.nodeType&&e,hc=rn&&rn.exports===Oo,No=hc&&cc.process,Pi=function(){try{var V=rn&&rn.require&&rn.require("util").types;return V||No&&No.binding&&No.binding("util")}catch{}}(),dc=Pi&&Pi.isArrayBuffer,fc=Pi&&Pi.isDate,pc=Pi&&Pi.isMap,mc=Pi&&Pi.isRegExp,gc=Pi&&Pi.isSet,vc=Pi&&Pi.isTypedArray;function _i(V,te,K){switch(K.length){case 0:return V.call(te);case 1:return V.call(te,K[0]);case 2:return V.call(te,K[0],K[1]);case 3:return V.call(te,K[0],K[1],K[2])}return V.apply(te,K)}function Mg(V,te,K,be){for(var ze=-1,rt=V==null?0:V.length;++ze<rt;){var Bt=V[ze];te(be,Bt,K(Bt),V)}return be}function Ri(V,te){for(var K=-1,be=V==null?0:V.length;++K<be&&te(V[K],K,V)!==!1;);return V}function Eg(V,te){for(var K=V==null?0:V.length;K--&&te(V[K],K,V)!==!1;);return V}function yc(V,te){for(var K=-1,be=V==null?0:V.length;++K<be;)if(!te(V[K],K,V))return!1;return!0}function Ir(V,te){for(var K=-1,be=V==null?0:V.length,ze=0,rt=[];++K<be;){var Bt=V[K];te(Bt,K,V)&&(rt[ze++]=Bt)}return rt}function $s(V,te){var K=V==null?0:V.length;return!!K&&En(V,te,0)>-1}function Do(V,te,K){for(var be=-1,ze=V==null?0:V.length;++be<ze;)if(K(te,V[be]))return!0;return!1}function xt(V,te){for(var K=-1,be=V==null?0:V.length,ze=Array(be);++K<be;)ze[K]=te(V[K],K,V);return ze}function Lr(V,te){for(var K=-1,be=te.length,ze=V.length;++K<be;)V[ze+K]=te[K];return V}function ko(V,te,K,be){var ze=-1,rt=V==null?0:V.length;for(be&&rt&&(K=V[++ze]);++ze<rt;)K=te(K,V[ze],ze,V);return K}function Tg(V,te,K,be){var ze=V==null?0:V.length;for(be&&ze&&(K=V[--ze]);ze--;)K=te(K,V[ze],ze,V);return K}function Fo(V,te){for(var K=-1,be=V==null?0:V.length;++K<be;)if(te(V[K],K,V))return!0;return!1}var Ag=zo("length");function Cg(V){return V.split("")}function Pg(V){return V.match(si)||[]}function _c(V,te,K){var be;return K(V,function(ze,rt,Bt){if(te(ze,rt,Bt))return be=rt,!1}),be}function Vs(V,te,K,be){for(var ze=V.length,rt=K+(be?1:-1);be?rt--:++rt<ze;)if(te(V[rt],rt,V))return rt;return-1}function En(V,te,K){return te===te?Hg(V,te,K):Vs(V,xc,K)}function Rg(V,te,K,be){for(var ze=K-1,rt=V.length;++ze<rt;)if(be(V[ze],te))return ze;return-1}function xc(V){return V!==V}function bc(V,te){var K=V==null?0:V.length;return K?Uo(V,te)/K:ae}function zo(V){return function(te){return te==null?t:te[V]}}function Bo(V){return function(te){return V==null?t:V[te]}}function wc(V,te,K,be,ze){return ze(V,function(rt,Bt,dt){K=be?(be=!1,rt):te(K,rt,Bt,dt)}),K}function Ig(V,te){var K=V.length;for(V.sort(te);K--;)V[K]=V[K].value;return V}function Uo(V,te){for(var K,be=-1,ze=V.length;++be<ze;){var rt=te(V[be]);rt!==t&&(K=K===t?rt:K+rt)}return K}function Ho(V,te){for(var K=-1,be=Array(V);++K<V;)be[K]=te(K);return be}function Lg(V,te){return xt(te,function(K){return[K,V[K]]})}function Sc(V){return V&&V.slice(0,Ac(V)+1).replace(ye,"")}function xi(V){return function(te){return V(te)}}function $o(V,te){return xt(te,function(K){return V[K]})}function Kn(V,te){return V.has(te)}function Mc(V,te){for(var K=-1,be=V.length;++K<be&&En(te,V[K],0)>-1;);return K}function Ec(V,te){for(var K=V.length;K--&&En(te,V[K],0)>-1;);return K}function Og(V,te){for(var K=V.length,be=0;K--;)V[K]===te&&++be;return be}var Ng=Bo(vg),Dg=Bo(yg);function kg(V){return"\\"+xg[V]}function Fg(V,te){return V==null?t:V[te]}function Tn(V){return fg.test(V)}function zg(V){return pg.test(V)}function Bg(V){for(var te,K=[];!(te=V.next()).done;)K.push(te.value);return K}function Vo(V){var te=-1,K=Array(V.size);return V.forEach(function(be,ze){K[++te]=[ze,be]}),K}function Tc(V,te){return function(K){return V(te(K))}}function Or(V,te){for(var K=-1,be=V.length,ze=0,rt=[];++K<be;){var Bt=V[K];(Bt===te||Bt===m)&&(V[K]=m,rt[ze++]=K)}return rt}function Ws(V){var te=-1,K=Array(V.size);return V.forEach(function(be){K[++te]=be}),K}function Ug(V){var te=-1,K=Array(V.size);return V.forEach(function(be){K[++te]=[be,be]}),K}function Hg(V,te,K){for(var be=K-1,ze=V.length;++be<ze;)if(V[be]===te)return be;return-1}function $g(V,te,K){for(var be=K+1;be--;)if(V[be]===te)return be;return be}function An(V){return Tn(V)?Wg(V):Ag(V)}function Hi(V){return Tn(V)?jg(V):Cg(V)}function Ac(V){for(var te=V.length;te--&&je.test(V.charAt(te)););return te}var Vg=Bo(_g);function Wg(V){for(var te=Lo.lastIndex=0;Lo.test(V);)++te;return te}function jg(V){return V.match(Lo)||[]}function Gg(V){return V.match(dg)||[]}var qg=function V(te){te=te==null?Gt:qr.defaults(Gt.Object(),te,qr.pick(Gt,mg));var K=te.Array,be=te.Date,ze=te.Error,rt=te.Function,Bt=te.Math,dt=te.Object,Wo=te.RegExp,Xg=te.String,Ii=te.TypeError,js=K.prototype,Zg=rt.prototype,Cn=dt.prototype,Gs=te["__core-js_shared__"],qs=Zg.toString,ot=Cn.hasOwnProperty,Jg=0,Cc=function(){var a=/[^.]+$/.exec(Gs&&Gs.keys&&Gs.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}(),Xs=Cn.toString,Yg=qs.call(dt),Kg=Gt._,Qg=Wo("^"+qs.call(ot).replace(Ls,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Zs=hc?te.Buffer:t,Nr=te.Symbol,Js=te.Uint8Array,Pc=Zs?Zs.allocUnsafe:t,Ys=Tc(dt.getPrototypeOf,dt),Rc=dt.create,Ic=Cn.propertyIsEnumerable,Ks=js.splice,Lc=Nr?Nr.isConcatSpreadable:t,Qn=Nr?Nr.iterator:t,nn=Nr?Nr.toStringTag:t,Qs=function(){try{var a=un(dt,"defineProperty");return a({},"",{}),a}catch{}}(),ev=te.clearTimeout!==Gt.clearTimeout&&te.clearTimeout,tv=be&&be.now!==Gt.Date.now&&be.now,iv=te.setTimeout!==Gt.setTimeout&&te.setTimeout,ea=Bt.ceil,ta=Bt.floor,jo=dt.getOwnPropertySymbols,rv=Zs?Zs.isBuffer:t,Oc=te.isFinite,nv=js.join,sv=Tc(dt.keys,dt),Ut=Bt.max,ei=Bt.min,av=be.now,ov=te.parseInt,Nc=Bt.random,lv=js.reverse,Go=un(te,"DataView"),es=un(te,"Map"),qo=un(te,"Promise"),Pn=un(te,"Set"),ts=un(te,"WeakMap"),is=un(dt,"create"),ia=ts&&new ts,Rn={},uv=cn(Go),cv=cn(es),hv=cn(qo),dv=cn(Pn),fv=cn(ts),ra=Nr?Nr.prototype:t,rs=ra?ra.valueOf:t,Dc=ra?ra.toString:t;function C(a){if(Tt(a)&&!Be(a)&&!(a instanceof Ye)){if(a instanceof Li)return a;if(ot.call(a,"__wrapped__"))return kh(a)}return new Li(a)}var In=function(){function a(){}return function(u){if(!St(u))return{};if(Rc)return Rc(u);a.prototype=u;var p=new a;return a.prototype=t,p}}();function na(){}function Li(a,u){this.__wrapped__=a,this.__actions__=[],this.__chain__=!!u,this.__index__=0,this.__values__=t}C.templateSettings={escape:ao,evaluate:oo,interpolate:lo,variable:"",imports:{_:C}},C.prototype=na.prototype,C.prototype.constructor=C,Li.prototype=In(na.prototype),Li.prototype.constructor=Li;function Ye(a){this.__wrapped__=a,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=he,this.__views__=[]}function pv(){var a=new Ye(this.__wrapped__);return a.__actions__=hi(this.__actions__),a.__dir__=this.__dir__,a.__filtered__=this.__filtered__,a.__iteratees__=hi(this.__iteratees__),a.__takeCount__=this.__takeCount__,a.__views__=hi(this.__views__),a}function mv(){if(this.__filtered__){var a=new Ye(this);a.__dir__=-1,a.__filtered__=!0}else a=this.clone(),a.__dir__*=-1;return a}function gv(){var a=this.__wrapped__.value(),u=this.__dir__,p=Be(a),x=u<0,M=p?a.length:0,I=Cy(0,M,this.__views__),k=I.start,B=I.end,W=B-k,ie=x?B:k-1,ne=this.__iteratees__,ue=ne.length,ge=0,Me=ei(W,this.__takeCount__);if(!p||!x&&M==W&&Me==W)return sh(a,this.__actions__);var Re=[];e:for(;W--&&ge<Me;){ie+=u;for(var $e=-1,Ie=a[ie];++$e<ue;){var Xe=ne[$e],Ke=Xe.iteratee,Si=Xe.type,li=Ke(Ie);if(Si==q)Ie=li;else if(!li){if(Si==Z)continue e;break e}}Re[ge++]=Ie}return Re}Ye.prototype=In(na.prototype),Ye.prototype.constructor=Ye;function sn(a){var u=-1,p=a==null?0:a.length;for(this.clear();++u<p;){var x=a[u];this.set(x[0],x[1])}}function vv(){this.__data__=is?is(null):{},this.size=0}function yv(a){var u=this.has(a)&&delete this.__data__[a];return this.size-=u?1:0,u}function _v(a){var u=this.__data__;if(is){var p=u[a];return p===d?t:p}return ot.call(u,a)?u[a]:t}function xv(a){var u=this.__data__;return is?u[a]!==t:ot.call(u,a)}function bv(a,u){var p=this.__data__;return this.size+=this.has(a)?0:1,p[a]=is&&u===t?d:u,this}sn.prototype.clear=vv,sn.prototype.delete=yv,sn.prototype.get=_v,sn.prototype.has=xv,sn.prototype.set=bv;function ur(a){var u=-1,p=a==null?0:a.length;for(this.clear();++u<p;){var x=a[u];this.set(x[0],x[1])}}function wv(){this.__data__=[],this.size=0}function Sv(a){var u=this.__data__,p=sa(u,a);if(p<0)return!1;var x=u.length-1;return p==x?u.pop():Ks.call(u,p,1),--this.size,!0}function Mv(a){var u=this.__data__,p=sa(u,a);return p<0?t:u[p][1]}function Ev(a){return sa(this.__data__,a)>-1}function Tv(a,u){var p=this.__data__,x=sa(p,a);return x<0?(++this.size,p.push([a,u])):p[x][1]=u,this}ur.prototype.clear=wv,ur.prototype.delete=Sv,ur.prototype.get=Mv,ur.prototype.has=Ev,ur.prototype.set=Tv;function cr(a){var u=-1,p=a==null?0:a.length;for(this.clear();++u<p;){var x=a[u];this.set(x[0],x[1])}}function Av(){this.size=0,this.__data__={hash:new sn,map:new(es||ur),string:new sn}}function Cv(a){var u=va(this,a).delete(a);return this.size-=u?1:0,u}function Pv(a){return va(this,a).get(a)}function Rv(a){return va(this,a).has(a)}function Iv(a,u){var p=va(this,a),x=p.size;return p.set(a,u),this.size+=p.size==x?0:1,this}cr.prototype.clear=Av,cr.prototype.delete=Cv,cr.prototype.get=Pv,cr.prototype.has=Rv,cr.prototype.set=Iv;function an(a){var u=-1,p=a==null?0:a.length;for(this.__data__=new cr;++u<p;)this.add(a[u])}function Lv(a){return this.__data__.set(a,d),this}function Ov(a){return this.__data__.has(a)}an.prototype.add=an.prototype.push=Lv,an.prototype.has=Ov;function $i(a){var u=this.__data__=new ur(a);this.size=u.size}function Nv(){this.__data__=new ur,this.size=0}function Dv(a){var u=this.__data__,p=u.delete(a);return this.size=u.size,p}function kv(a){return this.__data__.get(a)}function Fv(a){return this.__data__.has(a)}function zv(a,u){var p=this.__data__;if(p instanceof ur){var x=p.__data__;if(!es||x.length<n-1)return x.push([a,u]),this.size=++p.size,this;p=this.__data__=new cr(x)}return p.set(a,u),this.size=p.size,this}$i.prototype.clear=Nv,$i.prototype.delete=Dv,$i.prototype.get=kv,$i.prototype.has=Fv,$i.prototype.set=zv;function kc(a,u){var p=Be(a),x=!p&&hn(a),M=!p&&!x&&Br(a),I=!p&&!x&&!M&&Dn(a),k=p||x||M||I,B=k?Ho(a.length,Xg):[],W=B.length;for(var ie in a)(u||ot.call(a,ie))&&!(k&&(ie=="length"||M&&(ie=="offset"||ie=="parent")||I&&(ie=="buffer"||ie=="byteLength"||ie=="byteOffset")||pr(ie,W)))&&B.push(ie);return B}function Fc(a){var u=a.length;return u?a[nl(0,u-1)]:t}function Bv(a,u){return ya(hi(a),on(u,0,a.length))}function Uv(a){return ya(hi(a))}function Xo(a,u,p){(p!==t&&!Vi(a[u],p)||p===t&&!(u in a))&&hr(a,u,p)}function ns(a,u,p){var x=a[u];(!(ot.call(a,u)&&Vi(x,p))||p===t&&!(u in a))&&hr(a,u,p)}function sa(a,u){for(var p=a.length;p--;)if(Vi(a[p][0],u))return p;return-1}function Hv(a,u,p,x){return Dr(a,function(M,I,k){u(x,M,p(M),k)}),x}function zc(a,u){return a&&er(u,Wt(u),a)}function $v(a,u){return a&&er(u,fi(u),a)}function hr(a,u,p){u=="__proto__"&&Qs?Qs(a,u,{configurable:!0,enumerable:!0,value:p,writable:!0}):a[u]=p}function Zo(a,u){for(var p=-1,x=u.length,M=K(x),I=a==null;++p<x;)M[p]=I?t:Pl(a,u[p]);return M}function on(a,u,p){return a===a&&(p!==t&&(a=a<=p?a:p),u!==t&&(a=a>=u?a:u)),a}function Oi(a,u,p,x,M,I){var k,B=u&g,W=u&y,ie=u&_;if(p&&(k=M?p(a,x,M,I):p(a)),k!==t)return k;if(!St(a))return a;var ne=Be(a);if(ne){if(k=Ry(a),!B)return hi(a,k)}else{var ue=ti(a),ge=ue==Ae||ue==Ue;if(Br(a))return lh(a,B);if(ue==it||ue==se||ge&&!M){if(k=W||ge?{}:Ah(a),!B)return W?_y(a,$v(k,a)):yy(a,zc(k,a))}else{if(!pt[ue])return M?a:{};k=Iy(a,ue,B)}}I||(I=new $i);var Me=I.get(a);if(Me)return Me;I.set(a,k),id(a)?a.forEach(function(Ie){k.add(Oi(Ie,u,p,Ie,a,I))}):ed(a)&&a.forEach(function(Ie,Xe){k.set(Xe,Oi(Ie,u,p,Xe,a,I))});var Re=ie?W?ml:pl:W?fi:Wt,$e=ne?t:Re(a);return Ri($e||a,function(Ie,Xe){$e&&(Xe=Ie,Ie=a[Xe]),ns(k,Xe,Oi(Ie,u,p,Xe,a,I))}),k}function Vv(a){var u=Wt(a);return function(p){return Bc(p,a,u)}}function Bc(a,u,p){var x=p.length;if(a==null)return!x;for(a=dt(a);x--;){var M=p[x],I=u[M],k=a[M];if(k===t&&!(M in a)||!I(k))return!1}return!0}function Uc(a,u,p){if(typeof a!="function")throw new Ii(c);return hs(function(){a.apply(t,p)},u)}function ss(a,u,p,x){var M=-1,I=$s,k=!0,B=a.length,W=[],ie=u.length;if(!B)return W;p&&(u=xt(u,xi(p))),x?(I=Do,k=!1):u.length>=n&&(I=Kn,k=!1,u=new an(u));e:for(;++M<B;){var ne=a[M],ue=p==null?ne:p(ne);if(ne=x||ne!==0?ne:0,k&&ue===ue){for(var ge=ie;ge--;)if(u[ge]===ue)continue e;W.push(ne)}else I(u,ue,x)||W.push(ne)}return W}var Dr=fh(Qi),Hc=fh(Yo,!0);function Wv(a,u){var p=!0;return Dr(a,function(x,M,I){return p=!!u(x,M,I),p}),p}function aa(a,u,p){for(var x=-1,M=a.length;++x<M;){var I=a[x],k=u(I);if(k!=null&&(B===t?k===k&&!wi(k):p(k,B)))var B=k,W=I}return W}function jv(a,u,p,x){var M=a.length;for(p=He(p),p<0&&(p=-p>M?0:M+p),x=x===t||x>M?M:He(x),x<0&&(x+=M),x=p>x?0:nd(x);p<x;)a[p++]=u;return a}function $c(a,u){var p=[];return Dr(a,function(x,M,I){u(x,M,I)&&p.push(x)}),p}function Zt(a,u,p,x,M){var I=-1,k=a.length;for(p||(p=Oy),M||(M=[]);++I<k;){var B=a[I];u>0&&p(B)?u>1?Zt(B,u-1,p,x,M):Lr(M,B):x||(M[M.length]=B)}return M}var Jo=ph(),Vc=ph(!0);function Qi(a,u){return a&&Jo(a,u,Wt)}function Yo(a,u){return a&&Vc(a,u,Wt)}function oa(a,u){return Ir(u,function(p){return mr(a[p])})}function ln(a,u){u=Fr(u,a);for(var p=0,x=u.length;a!=null&&p<x;)a=a[tr(u[p++])];return p&&p==x?a:t}function Wc(a,u,p){var x=u(a);return Be(a)?x:Lr(x,p(a))}function ai(a){return a==null?a===t?Fe:Ct:nn&&nn in dt(a)?Ay(a):Uy(a)}function Ko(a,u){return a>u}function Gv(a,u){return a!=null&&ot.call(a,u)}function qv(a,u){return a!=null&&u in dt(a)}function Xv(a,u,p){return a>=ei(u,p)&&a<Ut(u,p)}function Qo(a,u,p){for(var x=p?Do:$s,M=a[0].length,I=a.length,k=I,B=K(I),W=1/0,ie=[];k--;){var ne=a[k];k&&u&&(ne=xt(ne,xi(u))),W=ei(ne.length,W),B[k]=!p&&(u||M>=120&&ne.length>=120)?new an(k&&ne):t}ne=a[0];var ue=-1,ge=B[0];e:for(;++ue<M&&ie.length<W;){var Me=ne[ue],Re=u?u(Me):Me;if(Me=p||Me!==0?Me:0,!(ge?Kn(ge,Re):x(ie,Re,p))){for(k=I;--k;){var $e=B[k];if(!($e?Kn($e,Re):x(a[k],Re,p)))continue e}ge&&ge.push(Re),ie.push(Me)}}return ie}function Zv(a,u,p,x){return Qi(a,function(M,I,k){u(x,p(M),I,k)}),x}function as(a,u,p){u=Fr(u,a),a=Ih(a,u);var x=a==null?a:a[tr(Di(u))];return x==null?t:_i(x,a,p)}function jc(a){return Tt(a)&&ai(a)==se}function Jv(a){return Tt(a)&&ai(a)==gt}function Yv(a){return Tt(a)&&ai(a)==De}function os(a,u,p,x,M){return a===u?!0:a==null||u==null||!Tt(a)&&!Tt(u)?a!==a&&u!==u:Kv(a,u,p,x,os,M)}function Kv(a,u,p,x,M,I){var k=Be(a),B=Be(u),W=k?Y:ti(a),ie=B?Y:ti(u);W=W==se?it:W,ie=ie==se?it:ie;var ne=W==it,ue=ie==it,ge=W==ie;if(ge&&Br(a)){if(!Br(u))return!1;k=!0,ne=!1}if(ge&&!ne)return I||(I=new $i),k||Dn(a)?Mh(a,u,p,x,M,I):Ey(a,u,W,p,x,M,I);if(!(p&b)){var Me=ne&&ot.call(a,"__wrapped__"),Re=ue&&ot.call(u,"__wrapped__");if(Me||Re){var $e=Me?a.value():a,Ie=Re?u.value():u;return I||(I=new $i),M($e,Ie,p,x,I)}}return ge?(I||(I=new $i),Ty(a,u,p,x,M,I)):!1}function Qv(a){return Tt(a)&&ti(a)==Ne}function el(a,u,p,x){var M=p.length,I=M,k=!x;if(a==null)return!I;for(a=dt(a);M--;){var B=p[M];if(k&&B[2]?B[1]!==a[B[0]]:!(B[0]in a))return!1}for(;++M<I;){B=p[M];var W=B[0],ie=a[W],ne=B[1];if(k&&B[2]){if(ie===t&&!(W in a))return!1}else{var ue=new $i;if(x)var ge=x(ie,ne,W,a,u,ue);if(!(ge===t?os(ne,ie,b|S,x,ue):ge))return!1}}return!0}function Gc(a){if(!St(a)||Dy(a))return!1;var u=mr(a)?Qg:tn;return u.test(cn(a))}function ey(a){return Tt(a)&&ai(a)==kt}function ty(a){return Tt(a)&&ti(a)==Pt}function iy(a){return Tt(a)&&Ma(a.length)&&!!yt[ai(a)]}function qc(a){return typeof a=="function"?a:a==null?pi:typeof a=="object"?Be(a)?Jc(a[0],a[1]):Zc(a):md(a)}function tl(a){if(!cs(a))return sv(a);var u=[];for(var p in dt(a))ot.call(a,p)&&p!="constructor"&&u.push(p);return u}function ry(a){if(!St(a))return By(a);var u=cs(a),p=[];for(var x in a)x=="constructor"&&(u||!ot.call(a,x))||p.push(x);return p}function il(a,u){return a<u}function Xc(a,u){var p=-1,x=di(a)?K(a.length):[];return Dr(a,function(M,I,k){x[++p]=u(M,I,k)}),x}function Zc(a){var u=vl(a);return u.length==1&&u[0][2]?Ph(u[0][0],u[0][1]):function(p){return p===a||el(p,a,u)}}function Jc(a,u){return _l(a)&&Ch(u)?Ph(tr(a),u):function(p){var x=Pl(p,a);return x===t&&x===u?Rl(p,a):os(u,x,b|S)}}function la(a,u,p,x,M){a!==u&&Jo(u,function(I,k){if(M||(M=new $i),St(I))ny(a,u,k,p,la,x,M);else{var B=x?x(bl(a,k),I,k+"",a,u,M):t;B===t&&(B=I),Xo(a,k,B)}},fi)}function ny(a,u,p,x,M,I,k){var B=bl(a,p),W=bl(u,p),ie=k.get(W);if(ie){Xo(a,p,ie);return}var ne=I?I(B,W,p+"",a,u,k):t,ue=ne===t;if(ue){var ge=Be(W),Me=!ge&&Br(W),Re=!ge&&!Me&&Dn(W);ne=W,ge||Me||Re?Be(B)?ne=B:Lt(B)?ne=hi(B):Me?(ue=!1,ne=lh(W,!0)):Re?(ue=!1,ne=uh(W,!0)):ne=[]:ds(W)||hn(W)?(ne=B,hn(B)?ne=sd(B):(!St(B)||mr(B))&&(ne=Ah(W))):ue=!1}ue&&(k.set(W,ne),M(ne,W,x,I,k),k.delete(W)),Xo(a,p,ne)}function Yc(a,u){var p=a.length;if(p)return u+=u<0?p:0,pr(u,p)?a[u]:t}function Kc(a,u,p){u.length?u=xt(u,function(I){return Be(I)?function(k){return ln(k,I.length===1?I[0]:I)}:I}):u=[pi];var x=-1;u=xt(u,xi(Pe()));var M=Xc(a,function(I,k,B){var W=xt(u,function(ie){return ie(I)});return{criteria:W,index:++x,value:I}});return Ig(M,function(I,k){return vy(I,k,p)})}function sy(a,u){return Qc(a,u,function(p,x){return Rl(a,x)})}function Qc(a,u,p){for(var x=-1,M=u.length,I={};++x<M;){var k=u[x],B=ln(a,k);p(B,k)&&ls(I,Fr(k,a),B)}return I}function ay(a){return function(u){return ln(u,a)}}function rl(a,u,p,x){var M=x?Rg:En,I=-1,k=u.length,B=a;for(a===u&&(u=hi(u)),p&&(B=xt(a,xi(p)));++I<k;)for(var W=0,ie=u[I],ne=p?p(ie):ie;(W=M(B,ne,W,x))>-1;)B!==a&&Ks.call(B,W,1),Ks.call(a,W,1);return a}function eh(a,u){for(var p=a?u.length:0,x=p-1;p--;){var M=u[p];if(p==x||M!==I){var I=M;pr(M)?Ks.call(a,M,1):ol(a,M)}}return a}function nl(a,u){return a+ta(Nc()*(u-a+1))}function oy(a,u,p,x){for(var M=-1,I=Ut(ea((u-a)/(p||1)),0),k=K(I);I--;)k[x?I:++M]=a,a+=p;return k}function sl(a,u){var p="";if(!a||u<1||u>X)return p;do u%2&&(p+=a),u=ta(u/2),u&&(a+=a);while(u);return p}function We(a,u){return wl(Rh(a,u,pi),a+"")}function ly(a){return Fc(kn(a))}function uy(a,u){var p=kn(a);return ya(p,on(u,0,p.length))}function ls(a,u,p,x){if(!St(a))return a;u=Fr(u,a);for(var M=-1,I=u.length,k=I-1,B=a;B!=null&&++M<I;){var W=tr(u[M]),ie=p;if(W==="__proto__"||W==="constructor"||W==="prototype")return a;if(M!=k){var ne=B[W];ie=x?x(ne,W,B):t,ie===t&&(ie=St(ne)?ne:pr(u[M+1])?[]:{})}ns(B,W,ie),B=B[W]}return a}var th=ia?function(a,u){return ia.set(a,u),a}:pi,cy=Qs?function(a,u){return Qs(a,"toString",{configurable:!0,enumerable:!1,value:Ll(u),writable:!0})}:pi;function hy(a){return ya(kn(a))}function Ni(a,u,p){var x=-1,M=a.length;u<0&&(u=-u>M?0:M+u),p=p>M?M:p,p<0&&(p+=M),M=u>p?0:p-u>>>0,u>>>=0;for(var I=K(M);++x<M;)I[x]=a[x+u];return I}function dy(a,u){var p;return Dr(a,function(x,M,I){return p=u(x,M,I),!p}),!!p}function ua(a,u,p){var x=0,M=a==null?x:a.length;if(typeof u=="number"&&u===u&&M<=de){for(;x<M;){var I=x+M>>>1,k=a[I];k!==null&&!wi(k)&&(p?k<=u:k<u)?x=I+1:M=I}return M}return al(a,u,pi,p)}function al(a,u,p,x){var M=0,I=a==null?0:a.length;if(I===0)return 0;u=p(u);for(var k=u!==u,B=u===null,W=wi(u),ie=u===t;M<I;){var ne=ta((M+I)/2),ue=p(a[ne]),ge=ue!==t,Me=ue===null,Re=ue===ue,$e=wi(ue);if(k)var Ie=x||Re;else ie?Ie=Re&&(x||ge):B?Ie=Re&&ge&&(x||!Me):W?Ie=Re&&ge&&!Me&&(x||!$e):Me||$e?Ie=!1:Ie=x?ue<=u:ue<u;Ie?M=ne+1:I=ne}return ei(I,pe)}function ih(a,u){for(var p=-1,x=a.length,M=0,I=[];++p<x;){var k=a[p],B=u?u(k):k;if(!p||!Vi(B,W)){var W=B;I[M++]=k===0?0:k}}return I}function rh(a){return typeof a=="number"?a:wi(a)?ae:+a}function bi(a){if(typeof a=="string")return a;if(Be(a))return xt(a,bi)+"";if(wi(a))return Dc?Dc.call(a):"";var u=a+"";return u=="0"&&1/a==-H?"-0":u}function kr(a,u,p){var x=-1,M=$s,I=a.length,k=!0,B=[],W=B;if(p)k=!1,M=Do;else if(I>=n){var ie=u?null:Sy(a);if(ie)return Ws(ie);k=!1,M=Kn,W=new an}else W=u?[]:B;e:for(;++x<I;){var ne=a[x],ue=u?u(ne):ne;if(ne=p||ne!==0?ne:0,k&&ue===ue){for(var ge=W.length;ge--;)if(W[ge]===ue)continue e;u&&W.push(ue),B.push(ne)}else M(W,ue,p)||(W!==B&&W.push(ue),B.push(ne))}return B}function ol(a,u){return u=Fr(u,a),a=Ih(a,u),a==null||delete a[tr(Di(u))]}function nh(a,u,p,x){return ls(a,u,p(ln(a,u)),x)}function ca(a,u,p,x){for(var M=a.length,I=x?M:-1;(x?I--:++I<M)&&u(a[I],I,a););return p?Ni(a,x?0:I,x?I+1:M):Ni(a,x?I+1:0,x?M:I)}function sh(a,u){var p=a;return p instanceof Ye&&(p=p.value()),ko(u,function(x,M){return M.func.apply(M.thisArg,Lr([x],M.args))},p)}function ll(a,u,p){var x=a.length;if(x<2)return x?kr(a[0]):[];for(var M=-1,I=K(x);++M<x;)for(var k=a[M],B=-1;++B<x;)B!=M&&(I[M]=ss(I[M]||k,a[B],u,p));return kr(Zt(I,1),u,p)}function ah(a,u,p){for(var x=-1,M=a.length,I=u.length,k={};++x<M;){var B=x<I?u[x]:t;p(k,a[x],B)}return k}function ul(a){return Lt(a)?a:[]}function cl(a){return typeof a=="function"?a:pi}function Fr(a,u){return Be(a)?a:_l(a,u)?[a]:Dh(at(a))}var fy=We;function zr(a,u,p){var x=a.length;return p=p===t?x:p,!u&&p>=x?a:Ni(a,u,p)}var oh=ev||function(a){return Gt.clearTimeout(a)};function lh(a,u){if(u)return a.slice();var p=a.length,x=Pc?Pc(p):new a.constructor(p);return a.copy(x),x}function hl(a){var u=new a.constructor(a.byteLength);return new Js(u).set(new Js(a)),u}function py(a,u){var p=u?hl(a.buffer):a.buffer;return new a.constructor(p,a.byteOffset,a.byteLength)}function my(a){var u=new a.constructor(a.source,xr.exec(a));return u.lastIndex=a.lastIndex,u}function gy(a){return rs?dt(rs.call(a)):{}}function uh(a,u){var p=u?hl(a.buffer):a.buffer;return new a.constructor(p,a.byteOffset,a.length)}function ch(a,u){if(a!==u){var p=a!==t,x=a===null,M=a===a,I=wi(a),k=u!==t,B=u===null,W=u===u,ie=wi(u);if(!B&&!ie&&!I&&a>u||I&&k&&W&&!B&&!ie||x&&k&&W||!p&&W||!M)return 1;if(!x&&!I&&!ie&&a<u||ie&&p&&M&&!x&&!I||B&&p&&M||!k&&M||!W)return-1}return 0}function vy(a,u,p){for(var x=-1,M=a.criteria,I=u.criteria,k=M.length,B=p.length;++x<k;){var W=ch(M[x],I[x]);if(W){if(x>=B)return W;var ie=p[x];return W*(ie=="desc"?-1:1)}}return a.index-u.index}function hh(a,u,p,x){for(var M=-1,I=a.length,k=p.length,B=-1,W=u.length,ie=Ut(I-k,0),ne=K(W+ie),ue=!x;++B<W;)ne[B]=u[B];for(;++M<k;)(ue||M<I)&&(ne[p[M]]=a[M]);for(;ie--;)ne[B++]=a[M++];return ne}function dh(a,u,p,x){for(var M=-1,I=a.length,k=-1,B=p.length,W=-1,ie=u.length,ne=Ut(I-B,0),ue=K(ne+ie),ge=!x;++M<ne;)ue[M]=a[M];for(var Me=M;++W<ie;)ue[Me+W]=u[W];for(;++k<B;)(ge||M<I)&&(ue[Me+p[k]]=a[M++]);return ue}function hi(a,u){var p=-1,x=a.length;for(u||(u=K(x));++p<x;)u[p]=a[p];return u}function er(a,u,p,x){var M=!p;p||(p={});for(var I=-1,k=u.length;++I<k;){var B=u[I],W=x?x(p[B],a[B],B,p,a):t;W===t&&(W=a[B]),M?hr(p,B,W):ns(p,B,W)}return p}function yy(a,u){return er(a,yl(a),u)}function _y(a,u){return er(a,Eh(a),u)}function ha(a,u){return function(p,x){var M=Be(p)?Mg:Hv,I=u?u():{};return M(p,a,Pe(x,2),I)}}function Ln(a){return We(function(u,p){var x=-1,M=p.length,I=M>1?p[M-1]:t,k=M>2?p[2]:t;for(I=a.length>3&&typeof I=="function"?(M--,I):t,k&&oi(p[0],p[1],k)&&(I=M<3?t:I,M=1),u=dt(u);++x<M;){var B=p[x];B&&a(u,B,x,I)}return u})}function fh(a,u){return function(p,x){if(p==null)return p;if(!di(p))return a(p,x);for(var M=p.length,I=u?M:-1,k=dt(p);(u?I--:++I<M)&&x(k[I],I,k)!==!1;);return p}}function ph(a){return function(u,p,x){for(var M=-1,I=dt(u),k=x(u),B=k.length;B--;){var W=k[a?B:++M];if(p(I[W],W,I)===!1)break}return u}}function xy(a,u,p){var x=u&E,M=us(a);function I(){var k=this&&this!==Gt&&this instanceof I?M:a;return k.apply(x?p:this,arguments)}return I}function mh(a){return function(u){u=at(u);var p=Tn(u)?Hi(u):t,x=p?p[0]:u.charAt(0),M=p?zr(p,1).join(""):u.slice(1);return x[a]()+M}}function On(a){return function(u){return ko(fd(dd(u).replace(cg,"")),a,"")}}function us(a){return function(){var u=arguments;switch(u.length){case 0:return new a;case 1:return new a(u[0]);case 2:return new a(u[0],u[1]);case 3:return new a(u[0],u[1],u[2]);case 4:return new a(u[0],u[1],u[2],u[3]);case 5:return new a(u[0],u[1],u[2],u[3],u[4]);case 6:return new a(u[0],u[1],u[2],u[3],u[4],u[5]);case 7:return new a(u[0],u[1],u[2],u[3],u[4],u[5],u[6])}var p=In(a.prototype),x=a.apply(p,u);return St(x)?x:p}}function by(a,u,p){var x=us(a);function M(){for(var I=arguments.length,k=K(I),B=I,W=Nn(M);B--;)k[B]=arguments[B];var ie=I<3&&k[0]!==W&&k[I-1]!==W?[]:Or(k,W);if(I-=ie.length,I<p)return xh(a,u,da,M.placeholder,t,k,ie,t,t,p-I);var ne=this&&this!==Gt&&this instanceof M?x:a;return _i(ne,this,k)}return M}function gh(a){return function(u,p,x){var M=dt(u);if(!di(u)){var I=Pe(p,3);u=Wt(u),p=function(B){return I(M[B],B,M)}}var k=a(u,p,x);return k>-1?M[I?u[k]:k]:t}}function vh(a){return fr(function(u){var p=u.length,x=p,M=Li.prototype.thru;for(a&&u.reverse();x--;){var I=u[x];if(typeof I!="function")throw new Ii(c);if(M&&!k&&ga(I)=="wrapper")var k=new Li([],!0)}for(x=k?x:p;++x<p;){I=u[x];var B=ga(I),W=B=="wrapper"?gl(I):t;W&&xl(W[0])&&W[1]==(L|P|R|N)&&!W[4].length&&W[9]==1?k=k[ga(W[0])].apply(k,W[3]):k=I.length==1&&xl(I)?k[B]():k.thru(I)}return function(){var ie=arguments,ne=ie[0];if(k&&ie.length==1&&Be(ne))return k.plant(ne).value();for(var ue=0,ge=p?u[ue].apply(this,ie):ne;++ue<p;)ge=u[ue].call(this,ge);return ge}})}function da(a,u,p,x,M,I,k,B,W,ie){var ne=u&L,ue=u&E,ge=u&T,Me=u&(P|O),Re=u&U,$e=ge?t:us(a);function Ie(){for(var Xe=arguments.length,Ke=K(Xe),Si=Xe;Si--;)Ke[Si]=arguments[Si];if(Me)var li=Nn(Ie),Mi=Og(Ke,li);if(x&&(Ke=hh(Ke,x,M,Me)),I&&(Ke=dh(Ke,I,k,Me)),Xe-=Mi,Me&&Xe<ie){var Ot=Or(Ke,li);return xh(a,u,da,Ie.placeholder,p,Ke,Ot,B,W,ie-Xe)}var Wi=ue?p:this,vr=ge?Wi[a]:a;return Xe=Ke.length,B?Ke=Hy(Ke,B):Re&&Xe>1&&Ke.reverse(),ne&&W<Xe&&(Ke.length=W),this&&this!==Gt&&this instanceof Ie&&(vr=$e||us(vr)),vr.apply(Wi,Ke)}return Ie}function yh(a,u){return function(p,x){return Zv(p,a,u(x),{})}}function fa(a,u){return function(p,x){var M;if(p===t&&x===t)return u;if(p!==t&&(M=p),x!==t){if(M===t)return x;typeof p=="string"||typeof x=="string"?(p=bi(p),x=bi(x)):(p=rh(p),x=rh(x)),M=a(p,x)}return M}}function dl(a){return fr(function(u){return u=xt(u,xi(Pe())),We(function(p){var x=this;return a(u,function(M){return _i(M,x,p)})})})}function pa(a,u){u=u===t?" ":bi(u);var p=u.length;if(p<2)return p?sl(u,a):u;var x=sl(u,ea(a/An(u)));return Tn(u)?zr(Hi(x),0,a).join(""):x.slice(0,a)}function wy(a,u,p,x){var M=u&E,I=us(a);function k(){for(var B=-1,W=arguments.length,ie=-1,ne=x.length,ue=K(ne+W),ge=this&&this!==Gt&&this instanceof k?I:a;++ie<ne;)ue[ie]=x[ie];for(;W--;)ue[ie++]=arguments[++B];return _i(ge,M?p:this,ue)}return k}function _h(a){return function(u,p,x){return x&&typeof x!="number"&&oi(u,p,x)&&(p=x=t),u=gr(u),p===t?(p=u,u=0):p=gr(p),x=x===t?u<p?1:-1:gr(x),oy(u,p,x,a)}}function ma(a){return function(u,p){return typeof u=="string"&&typeof p=="string"||(u=ki(u),p=ki(p)),a(u,p)}}function xh(a,u,p,x,M,I,k,B,W,ie){var ne=u&P,ue=ne?k:t,ge=ne?t:k,Me=ne?I:t,Re=ne?t:I;u|=ne?R:D,u&=~(ne?D:R),u&A||(u&=~(E|T));var $e=[a,u,M,Me,ue,Re,ge,B,W,ie],Ie=p.apply(t,$e);return xl(a)&&Lh(Ie,$e),Ie.placeholder=x,Oh(Ie,a,u)}function fl(a){var u=Bt[a];return function(p,x){if(p=ki(p),x=x==null?0:ei(He(x),292),x&&Oc(p)){var M=(at(p)+"e").split("e"),I=u(M[0]+"e"+(+M[1]+x));return M=(at(I)+"e").split("e"),+(M[0]+"e"+(+M[1]-x))}return u(p)}}var Sy=Pn&&1/Ws(new Pn([,-0]))[1]==H?function(a){return new Pn(a)}:Dl;function bh(a){return function(u){var p=ti(u);return p==Ne?Vo(u):p==Pt?Ug(u):Lg(u,a(u))}}function dr(a,u,p,x,M,I,k,B){var W=u&T;if(!W&&typeof a!="function")throw new Ii(c);var ie=x?x.length:0;if(ie||(u&=~(R|D),x=M=t),k=k===t?k:Ut(He(k),0),B=B===t?B:He(B),ie-=M?M.length:0,u&D){var ne=x,ue=M;x=M=t}var ge=W?t:gl(a),Me=[a,u,p,x,M,ne,ue,I,k,B];if(ge&&zy(Me,ge),a=Me[0],u=Me[1],p=Me[2],x=Me[3],M=Me[4],B=Me[9]=Me[9]===t?W?0:a.length:Ut(Me[9]-ie,0),!B&&u&(P|O)&&(u&=~(P|O)),!u||u==E)var Re=xy(a,u,p);else u==P||u==O?Re=by(a,u,B):(u==R||u==(E|R))&&!M.length?Re=wy(a,u,p,x):Re=da.apply(t,Me);var $e=ge?th:Lh;return Oh($e(Re,Me),a,u)}function wh(a,u,p,x){return a===t||Vi(a,Cn[p])&&!ot.call(x,p)?u:a}function Sh(a,u,p,x,M,I){return St(a)&&St(u)&&(I.set(u,a),la(a,u,t,Sh,I),I.delete(u)),a}function My(a){return ds(a)?t:a}function Mh(a,u,p,x,M,I){var k=p&b,B=a.length,W=u.length;if(B!=W&&!(k&&W>B))return!1;var ie=I.get(a),ne=I.get(u);if(ie&&ne)return ie==u&&ne==a;var ue=-1,ge=!0,Me=p&S?new an:t;for(I.set(a,u),I.set(u,a);++ue<B;){var Re=a[ue],$e=u[ue];if(x)var Ie=k?x($e,Re,ue,u,a,I):x(Re,$e,ue,a,u,I);if(Ie!==t){if(Ie)continue;ge=!1;break}if(Me){if(!Fo(u,function(Xe,Ke){if(!Kn(Me,Ke)&&(Re===Xe||M(Re,Xe,p,x,I)))return Me.push(Ke)})){ge=!1;break}}else if(!(Re===$e||M(Re,$e,p,x,I))){ge=!1;break}}return I.delete(a),I.delete(u),ge}function Ey(a,u,p,x,M,I,k){switch(p){case xe:if(a.byteLength!=u.byteLength||a.byteOffset!=u.byteOffset)return!1;a=a.buffer,u=u.buffer;case gt:return!(a.byteLength!=u.byteLength||!I(new Js(a),new Js(u)));case me:case De:case Ge:return Vi(+a,+u);case Ce:return a.name==u.name&&a.message==u.message;case kt:case _e:return a==u+"";case Ne:var B=Vo;case Pt:var W=x&b;if(B||(B=Ws),a.size!=u.size&&!W)return!1;var ie=k.get(a);if(ie)return ie==u;x|=S,k.set(a,u);var ne=Mh(B(a),B(u),x,M,I,k);return k.delete(a),ne;case ce:if(rs)return rs.call(a)==rs.call(u)}return!1}function Ty(a,u,p,x,M,I){var k=p&b,B=pl(a),W=B.length,ie=pl(u),ne=ie.length;if(W!=ne&&!k)return!1;for(var ue=W;ue--;){var ge=B[ue];if(!(k?ge in u:ot.call(u,ge)))return!1}var Me=I.get(a),Re=I.get(u);if(Me&&Re)return Me==u&&Re==a;var $e=!0;I.set(a,u),I.set(u,a);for(var Ie=k;++ue<W;){ge=B[ue];var Xe=a[ge],Ke=u[ge];if(x)var Si=k?x(Ke,Xe,ge,u,a,I):x(Xe,Ke,ge,a,u,I);if(!(Si===t?Xe===Ke||M(Xe,Ke,p,x,I):Si)){$e=!1;break}Ie||(Ie=ge=="constructor")}if($e&&!Ie){var li=a.constructor,Mi=u.constructor;li!=Mi&&"constructor"in a&&"constructor"in u&&!(typeof li=="function"&&li instanceof li&&typeof Mi=="function"&&Mi instanceof Mi)&&($e=!1)}return I.delete(a),I.delete(u),$e}function fr(a){return wl(Rh(a,t,Bh),a+"")}function pl(a){return Wc(a,Wt,yl)}function ml(a){return Wc(a,fi,Eh)}var gl=ia?function(a){return ia.get(a)}:Dl;function ga(a){for(var u=a.name+"",p=Rn[u],x=ot.call(Rn,u)?p.length:0;x--;){var M=p[x],I=M.func;if(I==null||I==a)return M.name}return u}function Nn(a){var u=ot.call(C,"placeholder")?C:a;return u.placeholder}function Pe(){var a=C.iteratee||Ol;return a=a===Ol?qc:a,arguments.length?a(arguments[0],arguments[1]):a}function va(a,u){var p=a.__data__;return Ny(u)?p[typeof u=="string"?"string":"hash"]:p.map}function vl(a){for(var u=Wt(a),p=u.length;p--;){var x=u[p],M=a[x];u[p]=[x,M,Ch(M)]}return u}function un(a,u){var p=Fg(a,u);return Gc(p)?p:t}function Ay(a){var u=ot.call(a,nn),p=a[nn];try{a[nn]=t;var x=!0}catch{}var M=Xs.call(a);return x&&(u?a[nn]=p:delete a[nn]),M}var yl=jo?function(a){return a==null?[]:(a=dt(a),Ir(jo(a),function(u){return Ic.call(a,u)}))}:kl,Eh=jo?function(a){for(var u=[];a;)Lr(u,yl(a)),a=Ys(a);return u}:kl,ti=ai;(Go&&ti(new Go(new ArrayBuffer(1)))!=xe||es&&ti(new es)!=Ne||qo&&ti(qo.resolve())!=bt||Pn&&ti(new Pn)!=Pt||ts&&ti(new ts)!=et)&&(ti=function(a){var u=ai(a),p=u==it?a.constructor:t,x=p?cn(p):"";if(x)switch(x){case uv:return xe;case cv:return Ne;case hv:return bt;case dv:return Pt;case fv:return et}return u});function Cy(a,u,p){for(var x=-1,M=p.length;++x<M;){var I=p[x],k=I.size;switch(I.type){case"drop":a+=k;break;case"dropRight":u-=k;break;case"take":u=ei(u,a+k);break;case"takeRight":a=Ut(a,u-k);break}}return{start:a,end:u}}function Py(a){var u=a.match(qe);return u?u[1].split(st):[]}function Th(a,u,p){u=Fr(u,a);for(var x=-1,M=u.length,I=!1;++x<M;){var k=tr(u[x]);if(!(I=a!=null&&p(a,k)))break;a=a[k]}return I||++x!=M?I:(M=a==null?0:a.length,!!M&&Ma(M)&&pr(k,M)&&(Be(a)||hn(a)))}function Ry(a){var u=a.length,p=new a.constructor(u);return u&&typeof a[0]=="string"&&ot.call(a,"index")&&(p.index=a.index,p.input=a.input),p}function Ah(a){return typeof a.constructor=="function"&&!cs(a)?In(Ys(a)):{}}function Iy(a,u,p){var x=a.constructor;switch(u){case gt:return hl(a);case me:case De:return new x(+a);case xe:return py(a,p);case we:case Ve:case ut:case lt:case Ee:case _t:case wt:case Xt:case Ft:return uh(a,p);case Ne:return new x;case Ge:case _e:return new x(a);case kt:return my(a);case Pt:return new x;case ce:return gy(a)}}function Ly(a,u){var p=u.length;if(!p)return a;var x=p-1;return u[x]=(p>1?"& ":"")+u[x],u=u.join(p>2?", ":" "),a.replace(tt,`{
/* [wrapped with `+u+`] */
`)}function Oy(a){return Be(a)||hn(a)||!!(Lc&&a&&a[Lc])}function pr(a,u){var p=typeof a;return u=u??X,!!u&&(p=="number"||p!="symbol"&&co.test(a))&&a>-1&&a%1==0&&a<u}function oi(a,u,p){if(!St(p))return!1;var x=typeof u;return(x=="number"?di(p)&&pr(u,p.length):x=="string"&&u in p)?Vi(p[u],a):!1}function _l(a,u){if(Be(a))return!1;var p=typeof a;return p=="number"||p=="symbol"||p=="boolean"||a==null||wi(a)?!0:vu.test(a)||!uo.test(a)||u!=null&&a in dt(u)}function Ny(a){var u=typeof a;return u=="string"||u=="number"||u=="symbol"||u=="boolean"?a!=="__proto__":a===null}function xl(a){var u=ga(a),p=C[u];if(typeof p!="function"||!(u in Ye.prototype))return!1;if(a===p)return!0;var x=gl(p);return!!x&&a===x[0]}function Dy(a){return!!Cc&&Cc in a}var ky=Gs?mr:Fl;function cs(a){var u=a&&a.constructor,p=typeof u=="function"&&u.prototype||Cn;return a===p}function Ch(a){return a===a&&!St(a)}function Ph(a,u){return function(p){return p==null?!1:p[a]===u&&(u!==t||a in dt(p))}}function Fy(a){var u=wa(a,function(x){return p.size===f&&p.clear(),x}),p=u.cache;return u}function zy(a,u){var p=a[1],x=u[1],M=p|x,I=M<(E|T|L),k=x==L&&p==P||x==L&&p==N&&a[7].length<=u[8]||x==(L|N)&&u[7].length<=u[8]&&p==P;if(!(I||k))return a;x&E&&(a[2]=u[2],M|=p&E?0:A);var B=u[3];if(B){var W=a[3];a[3]=W?hh(W,B,u[4]):B,a[4]=W?Or(a[3],m):u[4]}return B=u[5],B&&(W=a[5],a[5]=W?dh(W,B,u[6]):B,a[6]=W?Or(a[5],m):u[6]),B=u[7],B&&(a[7]=B),x&L&&(a[8]=a[8]==null?u[8]:ei(a[8],u[8])),a[9]==null&&(a[9]=u[9]),a[0]=u[0],a[1]=M,a}function By(a){var u=[];if(a!=null)for(var p in dt(a))u.push(p);return u}function Uy(a){return Xs.call(a)}function Rh(a,u,p){return u=Ut(u===t?a.length-1:u,0),function(){for(var x=arguments,M=-1,I=Ut(x.length-u,0),k=K(I);++M<I;)k[M]=x[u+M];M=-1;for(var B=K(u+1);++M<u;)B[M]=x[M];return B[u]=p(k),_i(a,this,B)}}function Ih(a,u){return u.length<2?a:ln(a,Ni(u,0,-1))}function Hy(a,u){for(var p=a.length,x=ei(u.length,p),M=hi(a);x--;){var I=u[x];a[x]=pr(I,p)?M[I]:t}return a}function bl(a,u){if(!(u==="constructor"&&typeof a[u]=="function")&&u!="__proto__")return a[u]}var Lh=Nh(th),hs=iv||function(a,u){return Gt.setTimeout(a,u)},wl=Nh(cy);function Oh(a,u,p){var x=u+"";return wl(a,Ly(x,$y(Py(x),p)))}function Nh(a){var u=0,p=0;return function(){var x=av(),M=J-(x-p);if(p=x,M>0){if(++u>=G)return arguments[0]}else u=0;return a.apply(t,arguments)}}function ya(a,u){var p=-1,x=a.length,M=x-1;for(u=u===t?x:u;++p<u;){var I=nl(p,M),k=a[I];a[I]=a[p],a[p]=k}return a.length=u,a}var Dh=Fy(function(a){var u=[];return a.charCodeAt(0)===46&&u.push(""),a.replace(yu,function(p,x,M,I){u.push(M?I.replace(yi,"$1"):x||p)}),u});function tr(a){if(typeof a=="string"||wi(a))return a;var u=a+"";return u=="0"&&1/a==-H?"-0":u}function cn(a){if(a!=null){try{return qs.call(a)}catch{}try{return a+""}catch{}}return""}function $y(a,u){return Ri(ee,function(p){var x="_."+p[0];u&p[1]&&!$s(a,x)&&a.push(x)}),a.sort()}function kh(a){if(a instanceof Ye)return a.clone();var u=new Li(a.__wrapped__,a.__chain__);return u.__actions__=hi(a.__actions__),u.__index__=a.__index__,u.__values__=a.__values__,u}function Vy(a,u,p){(p?oi(a,u,p):u===t)?u=1:u=Ut(He(u),0);var x=a==null?0:a.length;if(!x||u<1)return[];for(var M=0,I=0,k=K(ea(x/u));M<x;)k[I++]=Ni(a,M,M+=u);return k}function Wy(a){for(var u=-1,p=a==null?0:a.length,x=0,M=[];++u<p;){var I=a[u];I&&(M[x++]=I)}return M}function jy(){var a=arguments.length;if(!a)return[];for(var u=K(a-1),p=arguments[0],x=a;x--;)u[x-1]=arguments[x];return Lr(Be(p)?hi(p):[p],Zt(u,1))}var Gy=We(function(a,u){return Lt(a)?ss(a,Zt(u,1,Lt,!0)):[]}),qy=We(function(a,u){var p=Di(u);return Lt(p)&&(p=t),Lt(a)?ss(a,Zt(u,1,Lt,!0),Pe(p,2)):[]}),Xy=We(function(a,u){var p=Di(u);return Lt(p)&&(p=t),Lt(a)?ss(a,Zt(u,1,Lt,!0),t,p):[]});function Zy(a,u,p){var x=a==null?0:a.length;return x?(u=p||u===t?1:He(u),Ni(a,u<0?0:u,x)):[]}function Jy(a,u,p){var x=a==null?0:a.length;return x?(u=p||u===t?1:He(u),u=x-u,Ni(a,0,u<0?0:u)):[]}function Yy(a,u){return a&&a.length?ca(a,Pe(u,3),!0,!0):[]}function Ky(a,u){return a&&a.length?ca(a,Pe(u,3),!0):[]}function Qy(a,u,p,x){var M=a==null?0:a.length;return M?(p&&typeof p!="number"&&oi(a,u,p)&&(p=0,x=M),jv(a,u,p,x)):[]}function Fh(a,u,p){var x=a==null?0:a.length;if(!x)return-1;var M=p==null?0:He(p);return M<0&&(M=Ut(x+M,0)),Vs(a,Pe(u,3),M)}function zh(a,u,p){var x=a==null?0:a.length;if(!x)return-1;var M=x-1;return p!==t&&(M=He(p),M=p<0?Ut(x+M,0):ei(M,x-1)),Vs(a,Pe(u,3),M,!0)}function Bh(a){var u=a==null?0:a.length;return u?Zt(a,1):[]}function e0(a){var u=a==null?0:a.length;return u?Zt(a,H):[]}function t0(a,u){var p=a==null?0:a.length;return p?(u=u===t?1:He(u),Zt(a,u)):[]}function i0(a){for(var u=-1,p=a==null?0:a.length,x={};++u<p;){var M=a[u];x[M[0]]=M[1]}return x}function Uh(a){return a&&a.length?a[0]:t}function r0(a,u,p){var x=a==null?0:a.length;if(!x)return-1;var M=p==null?0:He(p);return M<0&&(M=Ut(x+M,0)),En(a,u,M)}function n0(a){var u=a==null?0:a.length;return u?Ni(a,0,-1):[]}var s0=We(function(a){var u=xt(a,ul);return u.length&&u[0]===a[0]?Qo(u):[]}),a0=We(function(a){var u=Di(a),p=xt(a,ul);return u===Di(p)?u=t:p.pop(),p.length&&p[0]===a[0]?Qo(p,Pe(u,2)):[]}),o0=We(function(a){var u=Di(a),p=xt(a,ul);return u=typeof u=="function"?u:t,u&&p.pop(),p.length&&p[0]===a[0]?Qo(p,t,u):[]});function l0(a,u){return a==null?"":nv.call(a,u)}function Di(a){var u=a==null?0:a.length;return u?a[u-1]:t}function u0(a,u,p){var x=a==null?0:a.length;if(!x)return-1;var M=x;return p!==t&&(M=He(p),M=M<0?Ut(x+M,0):ei(M,x-1)),u===u?$g(a,u,M):Vs(a,xc,M,!0)}function c0(a,u){return a&&a.length?Yc(a,He(u)):t}var h0=We(Hh);function Hh(a,u){return a&&a.length&&u&&u.length?rl(a,u):a}function d0(a,u,p){return a&&a.length&&u&&u.length?rl(a,u,Pe(p,2)):a}function f0(a,u,p){return a&&a.length&&u&&u.length?rl(a,u,t,p):a}var p0=fr(function(a,u){var p=a==null?0:a.length,x=Zo(a,u);return eh(a,xt(u,function(M){return pr(M,p)?+M:M}).sort(ch)),x});function m0(a,u){var p=[];if(!(a&&a.length))return p;var x=-1,M=[],I=a.length;for(u=Pe(u,3);++x<I;){var k=a[x];u(k,x,a)&&(p.push(k),M.push(x))}return eh(a,M),p}function Sl(a){return a==null?a:lv.call(a)}function g0(a,u,p){var x=a==null?0:a.length;return x?(p&&typeof p!="number"&&oi(a,u,p)?(u=0,p=x):(u=u==null?0:He(u),p=p===t?x:He(p)),Ni(a,u,p)):[]}function v0(a,u){return ua(a,u)}function y0(a,u,p){return al(a,u,Pe(p,2))}function _0(a,u){var p=a==null?0:a.length;if(p){var x=ua(a,u);if(x<p&&Vi(a[x],u))return x}return-1}function x0(a,u){return ua(a,u,!0)}function b0(a,u,p){return al(a,u,Pe(p,2),!0)}function w0(a,u){var p=a==null?0:a.length;if(p){var x=ua(a,u,!0)-1;if(Vi(a[x],u))return x}return-1}function S0(a){return a&&a.length?ih(a):[]}function M0(a,u){return a&&a.length?ih(a,Pe(u,2)):[]}function E0(a){var u=a==null?0:a.length;return u?Ni(a,1,u):[]}function T0(a,u,p){return a&&a.length?(u=p||u===t?1:He(u),Ni(a,0,u<0?0:u)):[]}function A0(a,u,p){var x=a==null?0:a.length;return x?(u=p||u===t?1:He(u),u=x-u,Ni(a,u<0?0:u,x)):[]}function C0(a,u){return a&&a.length?ca(a,Pe(u,3),!1,!0):[]}function P0(a,u){return a&&a.length?ca(a,Pe(u,3)):[]}var R0=We(function(a){return kr(Zt(a,1,Lt,!0))}),I0=We(function(a){var u=Di(a);return Lt(u)&&(u=t),kr(Zt(a,1,Lt,!0),Pe(u,2))}),L0=We(function(a){var u=Di(a);return u=typeof u=="function"?u:t,kr(Zt(a,1,Lt,!0),t,u)});function O0(a){return a&&a.length?kr(a):[]}function N0(a,u){return a&&a.length?kr(a,Pe(u,2)):[]}function D0(a,u){return u=typeof u=="function"?u:t,a&&a.length?kr(a,t,u):[]}function Ml(a){if(!(a&&a.length))return[];var u=0;return a=Ir(a,function(p){if(Lt(p))return u=Ut(p.length,u),!0}),Ho(u,function(p){return xt(a,zo(p))})}function $h(a,u){if(!(a&&a.length))return[];var p=Ml(a);return u==null?p:xt(p,function(x){return _i(u,t,x)})}var k0=We(function(a,u){return Lt(a)?ss(a,u):[]}),F0=We(function(a){return ll(Ir(a,Lt))}),z0=We(function(a){var u=Di(a);return Lt(u)&&(u=t),ll(Ir(a,Lt),Pe(u,2))}),B0=We(function(a){var u=Di(a);return u=typeof u=="function"?u:t,ll(Ir(a,Lt),t,u)}),U0=We(Ml);function H0(a,u){return ah(a||[],u||[],ns)}function $0(a,u){return ah(a||[],u||[],ls)}var V0=We(function(a){var u=a.length,p=u>1?a[u-1]:t;return p=typeof p=="function"?(a.pop(),p):t,$h(a,p)});function Vh(a){var u=C(a);return u.__chain__=!0,u}function W0(a,u){return u(a),a}function _a(a,u){return u(a)}var j0=fr(function(a){var u=a.length,p=u?a[0]:0,x=this.__wrapped__,M=function(I){return Zo(I,a)};return u>1||this.__actions__.length||!(x instanceof Ye)||!pr(p)?this.thru(M):(x=x.slice(p,+p+(u?1:0)),x.__actions__.push({func:_a,args:[M],thisArg:t}),new Li(x,this.__chain__).thru(function(I){return u&&!I.length&&I.push(t),I}))});function G0(){return Vh(this)}function q0(){return new Li(this.value(),this.__chain__)}function X0(){this.__values__===t&&(this.__values__=rd(this.value()));var a=this.__index__>=this.__values__.length,u=a?t:this.__values__[this.__index__++];return{done:a,value:u}}function Z0(){return this}function J0(a){for(var u,p=this;p instanceof na;){var x=kh(p);x.__index__=0,x.__values__=t,u?M.__wrapped__=x:u=x;var M=x;p=p.__wrapped__}return M.__wrapped__=a,u}function Y0(){var a=this.__wrapped__;if(a instanceof Ye){var u=a;return this.__actions__.length&&(u=new Ye(this)),u=u.reverse(),u.__actions__.push({func:_a,args:[Sl],thisArg:t}),new Li(u,this.__chain__)}return this.thru(Sl)}function K0(){return sh(this.__wrapped__,this.__actions__)}var Q0=ha(function(a,u,p){ot.call(a,p)?++a[p]:hr(a,p,1)});function e_(a,u,p){var x=Be(a)?yc:Wv;return p&&oi(a,u,p)&&(u=t),x(a,Pe(u,3))}function t_(a,u){var p=Be(a)?Ir:$c;return p(a,Pe(u,3))}var i_=gh(Fh),r_=gh(zh);function n_(a,u){return Zt(xa(a,u),1)}function s_(a,u){return Zt(xa(a,u),H)}function a_(a,u,p){return p=p===t?1:He(p),Zt(xa(a,u),p)}function Wh(a,u){var p=Be(a)?Ri:Dr;return p(a,Pe(u,3))}function jh(a,u){var p=Be(a)?Eg:Hc;return p(a,Pe(u,3))}var o_=ha(function(a,u,p){ot.call(a,p)?a[p].push(u):hr(a,p,[u])});function l_(a,u,p,x){a=di(a)?a:kn(a),p=p&&!x?He(p):0;var M=a.length;return p<0&&(p=Ut(M+p,0)),Ea(a)?p<=M&&a.indexOf(u,p)>-1:!!M&&En(a,u,p)>-1}var u_=We(function(a,u,p){var x=-1,M=typeof u=="function",I=di(a)?K(a.length):[];return Dr(a,function(k){I[++x]=M?_i(u,k,p):as(k,u,p)}),I}),c_=ha(function(a,u,p){hr(a,p,u)});function xa(a,u){var p=Be(a)?xt:Xc;return p(a,Pe(u,3))}function h_(a,u,p,x){return a==null?[]:(Be(u)||(u=u==null?[]:[u]),p=x?t:p,Be(p)||(p=p==null?[]:[p]),Kc(a,u,p))}var d_=ha(function(a,u,p){a[p?0:1].push(u)},function(){return[[],[]]});function f_(a,u,p){var x=Be(a)?ko:wc,M=arguments.length<3;return x(a,Pe(u,4),p,M,Dr)}function p_(a,u,p){var x=Be(a)?Tg:wc,M=arguments.length<3;return x(a,Pe(u,4),p,M,Hc)}function m_(a,u){var p=Be(a)?Ir:$c;return p(a,Sa(Pe(u,3)))}function g_(a){var u=Be(a)?Fc:ly;return u(a)}function v_(a,u,p){(p?oi(a,u,p):u===t)?u=1:u=He(u);var x=Be(a)?Bv:uy;return x(a,u)}function y_(a){var u=Be(a)?Uv:hy;return u(a)}function __(a){if(a==null)return 0;if(di(a))return Ea(a)?An(a):a.length;var u=ti(a);return u==Ne||u==Pt?a.size:tl(a).length}function x_(a,u,p){var x=Be(a)?Fo:dy;return p&&oi(a,u,p)&&(u=t),x(a,Pe(u,3))}var b_=We(function(a,u){if(a==null)return[];var p=u.length;return p>1&&oi(a,u[0],u[1])?u=[]:p>2&&oi(u[0],u[1],u[2])&&(u=[u[0]]),Kc(a,Zt(u,1),[])}),ba=tv||function(){return Gt.Date.now()};function w_(a,u){if(typeof u!="function")throw new Ii(c);return a=He(a),function(){if(--a<1)return u.apply(this,arguments)}}function Gh(a,u,p){return u=p?t:u,u=a&&u==null?a.length:u,dr(a,L,t,t,t,t,u)}function qh(a,u){var p;if(typeof u!="function")throw new Ii(c);return a=He(a),function(){return--a>0&&(p=u.apply(this,arguments)),a<=1&&(u=t),p}}var El=We(function(a,u,p){var x=E;if(p.length){var M=Or(p,Nn(El));x|=R}return dr(a,x,u,p,M)}),Xh=We(function(a,u,p){var x=E|T;if(p.length){var M=Or(p,Nn(Xh));x|=R}return dr(u,x,a,p,M)});function Zh(a,u,p){u=p?t:u;var x=dr(a,P,t,t,t,t,t,u);return x.placeholder=Zh.placeholder,x}function Jh(a,u,p){u=p?t:u;var x=dr(a,O,t,t,t,t,t,u);return x.placeholder=Jh.placeholder,x}function Yh(a,u,p){var x,M,I,k,B,W,ie=0,ne=!1,ue=!1,ge=!0;if(typeof a!="function")throw new Ii(c);u=ki(u)||0,St(p)&&(ne=!!p.leading,ue="maxWait"in p,I=ue?Ut(ki(p.maxWait)||0,u):I,ge="trailing"in p?!!p.trailing:ge);function Me(Ot){var Wi=x,vr=M;return x=M=t,ie=Ot,k=a.apply(vr,Wi),k}function Re(Ot){return ie=Ot,B=hs(Xe,u),ne?Me(Ot):k}function $e(Ot){var Wi=Ot-W,vr=Ot-ie,gd=u-Wi;return ue?ei(gd,I-vr):gd}function Ie(Ot){var Wi=Ot-W,vr=Ot-ie;return W===t||Wi>=u||Wi<0||ue&&vr>=I}function Xe(){var Ot=ba();if(Ie(Ot))return Ke(Ot);B=hs(Xe,$e(Ot))}function Ke(Ot){return B=t,ge&&x?Me(Ot):(x=M=t,k)}function Si(){B!==t&&oh(B),ie=0,x=W=M=B=t}function li(){return B===t?k:Ke(ba())}function Mi(){var Ot=ba(),Wi=Ie(Ot);if(x=arguments,M=this,W=Ot,Wi){if(B===t)return Re(W);if(ue)return oh(B),B=hs(Xe,u),Me(W)}return B===t&&(B=hs(Xe,u)),k}return Mi.cancel=Si,Mi.flush=li,Mi}var S_=We(function(a,u){return Uc(a,1,u)}),M_=We(function(a,u,p){return Uc(a,ki(u)||0,p)});function E_(a){return dr(a,U)}function wa(a,u){if(typeof a!="function"||u!=null&&typeof u!="function")throw new Ii(c);var p=function(){var x=arguments,M=u?u.apply(this,x):x[0],I=p.cache;if(I.has(M))return I.get(M);var k=a.apply(this,x);return p.cache=I.set(M,k)||I,k};return p.cache=new(wa.Cache||cr),p}wa.Cache=cr;function Sa(a){if(typeof a!="function")throw new Ii(c);return function(){var u=arguments;switch(u.length){case 0:return!a.call(this);case 1:return!a.call(this,u[0]);case 2:return!a.call(this,u[0],u[1]);case 3:return!a.call(this,u[0],u[1],u[2])}return!a.apply(this,u)}}function T_(a){return qh(2,a)}var A_=fy(function(a,u){u=u.length==1&&Be(u[0])?xt(u[0],xi(Pe())):xt(Zt(u,1),xi(Pe()));var p=u.length;return We(function(x){for(var M=-1,I=ei(x.length,p);++M<I;)x[M]=u[M].call(this,x[M]);return _i(a,this,x)})}),Tl=We(function(a,u){var p=Or(u,Nn(Tl));return dr(a,R,t,u,p)}),Kh=We(function(a,u){var p=Or(u,Nn(Kh));return dr(a,D,t,u,p)}),C_=fr(function(a,u){return dr(a,N,t,t,t,u)});function P_(a,u){if(typeof a!="function")throw new Ii(c);return u=u===t?u:He(u),We(a,u)}function R_(a,u){if(typeof a!="function")throw new Ii(c);return u=u==null?0:Ut(He(u),0),We(function(p){var x=p[u],M=zr(p,0,u);return x&&Lr(M,x),_i(a,this,M)})}function I_(a,u,p){var x=!0,M=!0;if(typeof a!="function")throw new Ii(c);return St(p)&&(x="leading"in p?!!p.leading:x,M="trailing"in p?!!p.trailing:M),Yh(a,u,{leading:x,maxWait:u,trailing:M})}function L_(a){return Gh(a,1)}function O_(a,u){return Tl(cl(u),a)}function N_(){if(!arguments.length)return[];var a=arguments[0];return Be(a)?a:[a]}function D_(a){return Oi(a,_)}function k_(a,u){return u=typeof u=="function"?u:t,Oi(a,_,u)}function F_(a){return Oi(a,g|_)}function z_(a,u){return u=typeof u=="function"?u:t,Oi(a,g|_,u)}function B_(a,u){return u==null||Bc(a,u,Wt(u))}function Vi(a,u){return a===u||a!==a&&u!==u}var U_=ma(Ko),H_=ma(function(a,u){return a>=u}),hn=jc(function(){return arguments}())?jc:function(a){return Tt(a)&&ot.call(a,"callee")&&!Ic.call(a,"callee")},Be=K.isArray,$_=dc?xi(dc):Jv;function di(a){return a!=null&&Ma(a.length)&&!mr(a)}function Lt(a){return Tt(a)&&di(a)}function V_(a){return a===!0||a===!1||Tt(a)&&ai(a)==me}var Br=rv||Fl,W_=fc?xi(fc):Yv;function j_(a){return Tt(a)&&a.nodeType===1&&!ds(a)}function G_(a){if(a==null)return!0;if(di(a)&&(Be(a)||typeof a=="string"||typeof a.splice=="function"||Br(a)||Dn(a)||hn(a)))return!a.length;var u=ti(a);if(u==Ne||u==Pt)return!a.size;if(cs(a))return!tl(a).length;for(var p in a)if(ot.call(a,p))return!1;return!0}function q_(a,u){return os(a,u)}function X_(a,u,p){p=typeof p=="function"?p:t;var x=p?p(a,u):t;return x===t?os(a,u,t,p):!!x}function Al(a){if(!Tt(a))return!1;var u=ai(a);return u==Ce||u==Le||typeof a.message=="string"&&typeof a.name=="string"&&!ds(a)}function Z_(a){return typeof a=="number"&&Oc(a)}function mr(a){if(!St(a))return!1;var u=ai(a);return u==Ae||u==Ue||u==fe||u==Kt}function Qh(a){return typeof a=="number"&&a==He(a)}function Ma(a){return typeof a=="number"&&a>-1&&a%1==0&&a<=X}function St(a){var u=typeof a;return a!=null&&(u=="object"||u=="function")}function Tt(a){return a!=null&&typeof a=="object"}var ed=pc?xi(pc):Qv;function J_(a,u){return a===u||el(a,u,vl(u))}function Y_(a,u,p){return p=typeof p=="function"?p:t,el(a,u,vl(u),p)}function K_(a){return td(a)&&a!=+a}function Q_(a){if(ky(a))throw new ze(l);return Gc(a)}function ex(a){return a===null}function tx(a){return a==null}function td(a){return typeof a=="number"||Tt(a)&&ai(a)==Ge}function ds(a){if(!Tt(a)||ai(a)!=it)return!1;var u=Ys(a);if(u===null)return!0;var p=ot.call(u,"constructor")&&u.constructor;return typeof p=="function"&&p instanceof p&&qs.call(p)==Yg}var Cl=mc?xi(mc):ey;function ix(a){return Qh(a)&&a>=-X&&a<=X}var id=gc?xi(gc):ty;function Ea(a){return typeof a=="string"||!Be(a)&&Tt(a)&&ai(a)==_e}function wi(a){return typeof a=="symbol"||Tt(a)&&ai(a)==ce}var Dn=vc?xi(vc):iy;function rx(a){return a===t}function nx(a){return Tt(a)&&ti(a)==et}function sx(a){return Tt(a)&&ai(a)==Dt}var ax=ma(il),ox=ma(function(a,u){return a<=u});function rd(a){if(!a)return[];if(di(a))return Ea(a)?Hi(a):hi(a);if(Qn&&a[Qn])return Bg(a[Qn]());var u=ti(a),p=u==Ne?Vo:u==Pt?Ws:kn;return p(a)}function gr(a){if(!a)return a===0?a:0;if(a=ki(a),a===H||a===-H){var u=a<0?-1:1;return u*re}return a===a?a:0}function He(a){var u=gr(a),p=u%1;return u===u?p?u-p:u:0}function nd(a){return a?on(He(a),0,he):0}function ki(a){if(typeof a=="number")return a;if(wi(a))return ae;if(St(a)){var u=typeof a.valueOf=="function"?a.valueOf():a;a=St(u)?u+"":u}if(typeof a!="string")return a===0?a:+a;a=Sc(a);var p=Ki.test(a);return p||Us.test(a)?wg(a.slice(2),p?2:8):Yi.test(a)?ae:+a}function sd(a){return er(a,fi(a))}function lx(a){return a?on(He(a),-X,X):a===0?a:0}function at(a){return a==null?"":bi(a)}var ux=Ln(function(a,u){if(cs(u)||di(u)){er(u,Wt(u),a);return}for(var p in u)ot.call(u,p)&&ns(a,p,u[p])}),ad=Ln(function(a,u){er(u,fi(u),a)}),Ta=Ln(function(a,u,p,x){er(u,fi(u),a,x)}),cx=Ln(function(a,u,p,x){er(u,Wt(u),a,x)}),hx=fr(Zo);function dx(a,u){var p=In(a);return u==null?p:zc(p,u)}var fx=We(function(a,u){a=dt(a);var p=-1,x=u.length,M=x>2?u[2]:t;for(M&&oi(u[0],u[1],M)&&(x=1);++p<x;)for(var I=u[p],k=fi(I),B=-1,W=k.length;++B<W;){var ie=k[B],ne=a[ie];(ne===t||Vi(ne,Cn[ie])&&!ot.call(a,ie))&&(a[ie]=I[ie])}return a}),px=We(function(a){return a.push(t,Sh),_i(od,t,a)});function mx(a,u){return _c(a,Pe(u,3),Qi)}function gx(a,u){return _c(a,Pe(u,3),Yo)}function vx(a,u){return a==null?a:Jo(a,Pe(u,3),fi)}function yx(a,u){return a==null?a:Vc(a,Pe(u,3),fi)}function _x(a,u){return a&&Qi(a,Pe(u,3))}function xx(a,u){return a&&Yo(a,Pe(u,3))}function bx(a){return a==null?[]:oa(a,Wt(a))}function wx(a){return a==null?[]:oa(a,fi(a))}function Pl(a,u,p){var x=a==null?t:ln(a,u);return x===t?p:x}function Sx(a,u){return a!=null&&Th(a,u,Gv)}function Rl(a,u){return a!=null&&Th(a,u,qv)}var Mx=yh(function(a,u,p){u!=null&&typeof u.toString!="function"&&(u=Xs.call(u)),a[u]=p},Ll(pi)),Ex=yh(function(a,u,p){u!=null&&typeof u.toString!="function"&&(u=Xs.call(u)),ot.call(a,u)?a[u].push(p):a[u]=[p]},Pe),Tx=We(as);function Wt(a){return di(a)?kc(a):tl(a)}function fi(a){return di(a)?kc(a,!0):ry(a)}function Ax(a,u){var p={};return u=Pe(u,3),Qi(a,function(x,M,I){hr(p,u(x,M,I),x)}),p}function Cx(a,u){var p={};return u=Pe(u,3),Qi(a,function(x,M,I){hr(p,M,u(x,M,I))}),p}var Px=Ln(function(a,u,p){la(a,u,p)}),od=Ln(function(a,u,p,x){la(a,u,p,x)}),Rx=fr(function(a,u){var p={};if(a==null)return p;var x=!1;u=xt(u,function(I){return I=Fr(I,a),x||(x=I.length>1),I}),er(a,ml(a),p),x&&(p=Oi(p,g|y|_,My));for(var M=u.length;M--;)ol(p,u[M]);return p});function Ix(a,u){return ld(a,Sa(Pe(u)))}var Lx=fr(function(a,u){return a==null?{}:sy(a,u)});function ld(a,u){if(a==null)return{};var p=xt(ml(a),function(x){return[x]});return u=Pe(u),Qc(a,p,function(x,M){return u(x,M[0])})}function Ox(a,u,p){u=Fr(u,a);var x=-1,M=u.length;for(M||(M=1,a=t);++x<M;){var I=a==null?t:a[tr(u[x])];I===t&&(x=M,I=p),a=mr(I)?I.call(a):I}return a}function Nx(a,u,p){return a==null?a:ls(a,u,p)}function Dx(a,u,p,x){return x=typeof x=="function"?x:t,a==null?a:ls(a,u,p,x)}var ud=bh(Wt),cd=bh(fi);function kx(a,u,p){var x=Be(a),M=x||Br(a)||Dn(a);if(u=Pe(u,4),p==null){var I=a&&a.constructor;M?p=x?new I:[]:St(a)?p=mr(I)?In(Ys(a)):{}:p={}}return(M?Ri:Qi)(a,function(k,B,W){return u(p,k,B,W)}),p}function Fx(a,u){return a==null?!0:ol(a,u)}function zx(a,u,p){return a==null?a:nh(a,u,cl(p))}function Bx(a,u,p,x){return x=typeof x=="function"?x:t,a==null?a:nh(a,u,cl(p),x)}function kn(a){return a==null?[]:$o(a,Wt(a))}function Ux(a){return a==null?[]:$o(a,fi(a))}function Hx(a,u,p){return p===t&&(p=u,u=t),p!==t&&(p=ki(p),p=p===p?p:0),u!==t&&(u=ki(u),u=u===u?u:0),on(ki(a),u,p)}function $x(a,u,p){return u=gr(u),p===t?(p=u,u=0):p=gr(p),a=ki(a),Xv(a,u,p)}function Vx(a,u,p){if(p&&typeof p!="boolean"&&oi(a,u,p)&&(u=p=t),p===t&&(typeof u=="boolean"?(p=u,u=t):typeof a=="boolean"&&(p=a,a=t)),a===t&&u===t?(a=0,u=1):(a=gr(a),u===t?(u=a,a=0):u=gr(u)),a>u){var x=a;a=u,u=x}if(p||a%1||u%1){var M=Nc();return ei(a+M*(u-a+bg("1e-"+((M+"").length-1))),u)}return nl(a,u)}var Wx=On(function(a,u,p){return u=u.toLowerCase(),a+(p?hd(u):u)});function hd(a){return Il(at(a).toLowerCase())}function dd(a){return a=at(a),a&&a.replace(Po,Ng).replace(hg,"")}function jx(a,u,p){a=at(a),u=bi(u);var x=a.length;p=p===t?x:on(He(p),0,x);var M=p;return p-=u.length,p>=0&&a.slice(p,M)==u}function Gx(a){return a=at(a),a&&Jn.test(a)?a.replace(Ji,Dg):a}function qx(a){return a=at(a),a&&_u.test(a)?a.replace(Ls,"\\$&"):a}var Xx=On(function(a,u,p){return a+(p?"-":"")+u.toLowerCase()}),Zx=On(function(a,u,p){return a+(p?" ":"")+u.toLowerCase()}),Jx=mh("toLowerCase");function Yx(a,u,p){a=at(a),u=He(u);var x=u?An(a):0;if(!u||x>=u)return a;var M=(u-x)/2;return pa(ta(M),p)+a+pa(ea(M),p)}function Kx(a,u,p){a=at(a),u=He(u);var x=u?An(a):0;return u&&x<u?a+pa(u-x,p):a}function Qx(a,u,p){a=at(a),u=He(u);var x=u?An(a):0;return u&&x<u?pa(u-x,p)+a:a}function eb(a,u,p){return p||u==null?u=0:u&&(u=+u),ov(at(a).replace(ye,""),u||0)}function tb(a,u,p){return(p?oi(a,u,p):u===t)?u=1:u=He(u),sl(at(a),u)}function ib(){var a=arguments,u=at(a[0]);return a.length<3?u:u.replace(a[1],a[2])}var rb=On(function(a,u,p){return a+(p?"_":"")+u.toLowerCase()});function nb(a,u,p){return p&&typeof p!="number"&&oi(a,u,p)&&(u=p=t),p=p===t?he:p>>>0,p?(a=at(a),a&&(typeof u=="string"||u!=null&&!Cl(u))&&(u=bi(u),!u&&Tn(a))?zr(Hi(a),0,p):a.split(u,p)):[]}var sb=On(function(a,u,p){return a+(p?" ":"")+Il(u)});function ab(a,u,p){return a=at(a),p=p==null?0:on(He(p),0,a.length),u=bi(u),a.slice(p,p+u.length)==u}function ob(a,u,p){var x=C.templateSettings;p&&oi(a,u,p)&&(u=t),a=at(a),u=Ta({},u,x,wh);var M=Ta({},u.imports,x.imports,wh),I=Wt(M),k=$o(M,I),B,W,ie=0,ne=u.interpolate||Q,ue="__p += '",ge=Wo((u.escape||Q).source+"|"+ne.source+"|"+(ne===lo?Xi:Q).source+"|"+(u.evaluate||Q).source+"|$","g"),Me="//# sourceURL="+(ot.call(u,"sourceURL")?(u.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++gg+"]")+`
`;a.replace(ge,function(Ie,Xe,Ke,Si,li,Mi){return Ke||(Ke=Si),ue+=a.slice(ie,Mi).replace(le,kg),Xe&&(B=!0,ue+=`' +
__e(`+Xe+`) +
'`),li&&(W=!0,ue+=`';
`+li+`;
__p += '`),Ke&&(ue+=`' +
((__t = (`+Ke+`)) == null ? '' : __t) +
'`),ie=Mi+Ie.length,Ie}),ue+=`';
`;var Re=ot.call(u,"variable")&&u.variable;if(!Re)ue=`with (obj) {
`+ue+`
}
`;else if(Ci.test(Re))throw new ze(h);ue=(W?ue.replace(gi,""):ue).replace(Rt,"$1").replace(ci,"$1;"),ue="function("+(Re||"obj")+`) {
`+(Re?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(B?", __e = _.escape":"")+(W?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ue+`return __p
}`;var $e=pd(function(){return rt(I,Me+"return "+ue).apply(t,k)});if($e.source=ue,Al($e))throw $e;return $e}function lb(a){return at(a).toLowerCase()}function ub(a){return at(a).toUpperCase()}function cb(a,u,p){if(a=at(a),a&&(p||u===t))return Sc(a);if(!a||!(u=bi(u)))return a;var x=Hi(a),M=Hi(u),I=Mc(x,M),k=Ec(x,M)+1;return zr(x,I,k).join("")}function hb(a,u,p){if(a=at(a),a&&(p||u===t))return a.slice(0,Ac(a)+1);if(!a||!(u=bi(u)))return a;var x=Hi(a),M=Ec(x,Hi(u))+1;return zr(x,0,M).join("")}function db(a,u,p){if(a=at(a),a&&(p||u===t))return a.replace(ye,"");if(!a||!(u=bi(u)))return a;var x=Hi(a),M=Mc(x,Hi(u));return zr(x,M).join("")}function fb(a,u){var p=F,x=z;if(St(u)){var M="separator"in u?u.separator:M;p="length"in u?He(u.length):p,x="omission"in u?bi(u.omission):x}a=at(a);var I=a.length;if(Tn(a)){var k=Hi(a);I=k.length}if(p>=I)return a;var B=p-An(x);if(B<1)return x;var W=k?zr(k,0,B).join(""):a.slice(0,B);if(M===t)return W+x;if(k&&(B+=W.length-B),Cl(M)){if(a.slice(B).search(M)){var ie,ne=W;for(M.global||(M=Wo(M.source,at(xr.exec(M))+"g")),M.lastIndex=0;ie=M.exec(ne);)var ue=ie.index;W=W.slice(0,ue===t?B:ue)}}else if(a.indexOf(bi(M),B)!=B){var ge=W.lastIndexOf(M);ge>-1&&(W=W.slice(0,ge))}return W+x}function pb(a){return a=at(a),a&&ws.test(a)?a.replace(ji,Vg):a}var mb=On(function(a,u,p){return a+(p?" ":"")+u.toUpperCase()}),Il=mh("toUpperCase");function fd(a,u,p){return a=at(a),u=p?t:u,u===t?zg(a)?Gg(a):Pg(a):a.match(u)||[]}var pd=We(function(a,u){try{return _i(a,t,u)}catch(p){return Al(p)?p:new ze(p)}}),gb=fr(function(a,u){return Ri(u,function(p){p=tr(p),hr(a,p,El(a[p],a))}),a});function vb(a){var u=a==null?0:a.length,p=Pe();return a=u?xt(a,function(x){if(typeof x[1]!="function")throw new Ii(c);return[p(x[0]),x[1]]}):[],We(function(x){for(var M=-1;++M<u;){var I=a[M];if(_i(I[0],this,x))return _i(I[1],this,x)}})}function yb(a){return Vv(Oi(a,g))}function Ll(a){return function(){return a}}function _b(a,u){return a==null||a!==a?u:a}var xb=vh(),bb=vh(!0);function pi(a){return a}function Ol(a){return qc(typeof a=="function"?a:Oi(a,g))}function wb(a){return Zc(Oi(a,g))}function Sb(a,u){return Jc(a,Oi(u,g))}var Mb=We(function(a,u){return function(p){return as(p,a,u)}}),Eb=We(function(a,u){return function(p){return as(a,p,u)}});function Nl(a,u,p){var x=Wt(u),M=oa(u,x);p==null&&!(St(u)&&(M.length||!x.length))&&(p=u,u=a,a=this,M=oa(u,Wt(u)));var I=!(St(p)&&"chain"in p)||!!p.chain,k=mr(a);return Ri(M,function(B){var W=u[B];a[B]=W,k&&(a.prototype[B]=function(){var ie=this.__chain__;if(I||ie){var ne=a(this.__wrapped__),ue=ne.__actions__=hi(this.__actions__);return ue.push({func:W,args:arguments,thisArg:a}),ne.__chain__=ie,ne}return W.apply(a,Lr([this.value()],arguments))})}),a}function Tb(){return Gt._===this&&(Gt._=Kg),this}function Dl(){}function Ab(a){return a=He(a),We(function(u){return Yc(u,a)})}var Cb=dl(xt),Pb=dl(yc),Rb=dl(Fo);function md(a){return _l(a)?zo(tr(a)):ay(a)}function Ib(a){return function(u){return a==null?t:ln(a,u)}}var Lb=_h(),Ob=_h(!0);function kl(){return[]}function Fl(){return!1}function Nb(){return{}}function Db(){return""}function kb(){return!0}function Fb(a,u){if(a=He(a),a<1||a>X)return[];var p=he,x=ei(a,he);u=Pe(u),a-=he;for(var M=Ho(x,u);++p<a;)u(p);return M}function zb(a){return Be(a)?xt(a,tr):wi(a)?[a]:hi(Dh(at(a)))}function Bb(a){var u=++Jg;return at(a)+u}var Ub=fa(function(a,u){return a+u},0),Hb=fl("ceil"),$b=fa(function(a,u){return a/u},1),Vb=fl("floor");function Wb(a){return a&&a.length?aa(a,pi,Ko):t}function jb(a,u){return a&&a.length?aa(a,Pe(u,2),Ko):t}function Gb(a){return bc(a,pi)}function qb(a,u){return bc(a,Pe(u,2))}function Xb(a){return a&&a.length?aa(a,pi,il):t}function Zb(a,u){return a&&a.length?aa(a,Pe(u,2),il):t}var Jb=fa(function(a,u){return a*u},1),Yb=fl("round"),Kb=fa(function(a,u){return a-u},0);function Qb(a){return a&&a.length?Uo(a,pi):0}function e1(a,u){return a&&a.length?Uo(a,Pe(u,2)):0}return C.after=w_,C.ary=Gh,C.assign=ux,C.assignIn=ad,C.assignInWith=Ta,C.assignWith=cx,C.at=hx,C.before=qh,C.bind=El,C.bindAll=gb,C.bindKey=Xh,C.castArray=N_,C.chain=Vh,C.chunk=Vy,C.compact=Wy,C.concat=jy,C.cond=vb,C.conforms=yb,C.constant=Ll,C.countBy=Q0,C.create=dx,C.curry=Zh,C.curryRight=Jh,C.debounce=Yh,C.defaults=fx,C.defaultsDeep=px,C.defer=S_,C.delay=M_,C.difference=Gy,C.differenceBy=qy,C.differenceWith=Xy,C.drop=Zy,C.dropRight=Jy,C.dropRightWhile=Yy,C.dropWhile=Ky,C.fill=Qy,C.filter=t_,C.flatMap=n_,C.flatMapDeep=s_,C.flatMapDepth=a_,C.flatten=Bh,C.flattenDeep=e0,C.flattenDepth=t0,C.flip=E_,C.flow=xb,C.flowRight=bb,C.fromPairs=i0,C.functions=bx,C.functionsIn=wx,C.groupBy=o_,C.initial=n0,C.intersection=s0,C.intersectionBy=a0,C.intersectionWith=o0,C.invert=Mx,C.invertBy=Ex,C.invokeMap=u_,C.iteratee=Ol,C.keyBy=c_,C.keys=Wt,C.keysIn=fi,C.map=xa,C.mapKeys=Ax,C.mapValues=Cx,C.matches=wb,C.matchesProperty=Sb,C.memoize=wa,C.merge=Px,C.mergeWith=od,C.method=Mb,C.methodOf=Eb,C.mixin=Nl,C.negate=Sa,C.nthArg=Ab,C.omit=Rx,C.omitBy=Ix,C.once=T_,C.orderBy=h_,C.over=Cb,C.overArgs=A_,C.overEvery=Pb,C.overSome=Rb,C.partial=Tl,C.partialRight=Kh,C.partition=d_,C.pick=Lx,C.pickBy=ld,C.property=md,C.propertyOf=Ib,C.pull=h0,C.pullAll=Hh,C.pullAllBy=d0,C.pullAllWith=f0,C.pullAt=p0,C.range=Lb,C.rangeRight=Ob,C.rearg=C_,C.reject=m_,C.remove=m0,C.rest=P_,C.reverse=Sl,C.sampleSize=v_,C.set=Nx,C.setWith=Dx,C.shuffle=y_,C.slice=g0,C.sortBy=b_,C.sortedUniq=S0,C.sortedUniqBy=M0,C.split=nb,C.spread=R_,C.tail=E0,C.take=T0,C.takeRight=A0,C.takeRightWhile=C0,C.takeWhile=P0,C.tap=W0,C.throttle=I_,C.thru=_a,C.toArray=rd,C.toPairs=ud,C.toPairsIn=cd,C.toPath=zb,C.toPlainObject=sd,C.transform=kx,C.unary=L_,C.union=R0,C.unionBy=I0,C.unionWith=L0,C.uniq=O0,C.uniqBy=N0,C.uniqWith=D0,C.unset=Fx,C.unzip=Ml,C.unzipWith=$h,C.update=zx,C.updateWith=Bx,C.values=kn,C.valuesIn=Ux,C.without=k0,C.words=fd,C.wrap=O_,C.xor=F0,C.xorBy=z0,C.xorWith=B0,C.zip=U0,C.zipObject=H0,C.zipObjectDeep=$0,C.zipWith=V0,C.entries=ud,C.entriesIn=cd,C.extend=ad,C.extendWith=Ta,Nl(C,C),C.add=Ub,C.attempt=pd,C.camelCase=Wx,C.capitalize=hd,C.ceil=Hb,C.clamp=Hx,C.clone=D_,C.cloneDeep=F_,C.cloneDeepWith=z_,C.cloneWith=k_,C.conformsTo=B_,C.deburr=dd,C.defaultTo=_b,C.divide=$b,C.endsWith=jx,C.eq=Vi,C.escape=Gx,C.escapeRegExp=qx,C.every=e_,C.find=i_,C.findIndex=Fh,C.findKey=mx,C.findLast=r_,C.findLastIndex=zh,C.findLastKey=gx,C.floor=Vb,C.forEach=Wh,C.forEachRight=jh,C.forIn=vx,C.forInRight=yx,C.forOwn=_x,C.forOwnRight=xx,C.get=Pl,C.gt=U_,C.gte=H_,C.has=Sx,C.hasIn=Rl,C.head=Uh,C.identity=pi,C.includes=l_,C.indexOf=r0,C.inRange=$x,C.invoke=Tx,C.isArguments=hn,C.isArray=Be,C.isArrayBuffer=$_,C.isArrayLike=di,C.isArrayLikeObject=Lt,C.isBoolean=V_,C.isBuffer=Br,C.isDate=W_,C.isElement=j_,C.isEmpty=G_,C.isEqual=q_,C.isEqualWith=X_,C.isError=Al,C.isFinite=Z_,C.isFunction=mr,C.isInteger=Qh,C.isLength=Ma,C.isMap=ed,C.isMatch=J_,C.isMatchWith=Y_,C.isNaN=K_,C.isNative=Q_,C.isNil=tx,C.isNull=ex,C.isNumber=td,C.isObject=St,C.isObjectLike=Tt,C.isPlainObject=ds,C.isRegExp=Cl,C.isSafeInteger=ix,C.isSet=id,C.isString=Ea,C.isSymbol=wi,C.isTypedArray=Dn,C.isUndefined=rx,C.isWeakMap=nx,C.isWeakSet=sx,C.join=l0,C.kebabCase=Xx,C.last=Di,C.lastIndexOf=u0,C.lowerCase=Zx,C.lowerFirst=Jx,C.lt=ax,C.lte=ox,C.max=Wb,C.maxBy=jb,C.mean=Gb,C.meanBy=qb,C.min=Xb,C.minBy=Zb,C.stubArray=kl,C.stubFalse=Fl,C.stubObject=Nb,C.stubString=Db,C.stubTrue=kb,C.multiply=Jb,C.nth=c0,C.noConflict=Tb,C.noop=Dl,C.now=ba,C.pad=Yx,C.padEnd=Kx,C.padStart=Qx,C.parseInt=eb,C.random=Vx,C.reduce=f_,C.reduceRight=p_,C.repeat=tb,C.replace=ib,C.result=Ox,C.round=Yb,C.runInContext=V,C.sample=g_,C.size=__,C.snakeCase=rb,C.some=x_,C.sortedIndex=v0,C.sortedIndexBy=y0,C.sortedIndexOf=_0,C.sortedLastIndex=x0,C.sortedLastIndexBy=b0,C.sortedLastIndexOf=w0,C.startCase=sb,C.startsWith=ab,C.subtract=Kb,C.sum=Qb,C.sumBy=e1,C.template=ob,C.times=Fb,C.toFinite=gr,C.toInteger=He,C.toLength=nd,C.toLower=lb,C.toNumber=ki,C.toSafeInteger=lx,C.toString=at,C.toUpper=ub,C.trim=cb,C.trimEnd=hb,C.trimStart=db,C.truncate=fb,C.unescape=pb,C.uniqueId=Bb,C.upperCase=mb,C.upperFirst=Il,C.each=Wh,C.eachRight=jh,C.first=Uh,Nl(C,function(){var a={};return Qi(C,function(u,p){ot.call(C.prototype,p)||(a[p]=u)}),a}(),{chain:!1}),C.VERSION=r,Ri(["bind","bindKey","curry","curryRight","partial","partialRight"],function(a){C[a].placeholder=C}),Ri(["drop","take"],function(a,u){Ye.prototype[a]=function(p){p=p===t?1:Ut(He(p),0);var x=this.__filtered__&&!u?new Ye(this):this.clone();return x.__filtered__?x.__takeCount__=ei(p,x.__takeCount__):x.__views__.push({size:ei(p,he),type:a+(x.__dir__<0?"Right":"")}),x},Ye.prototype[a+"Right"]=function(p){return this.reverse()[a](p).reverse()}}),Ri(["filter","map","takeWhile"],function(a,u){var p=u+1,x=p==Z||p==$;Ye.prototype[a]=function(M){var I=this.clone();return I.__iteratees__.push({iteratee:Pe(M,3),type:p}),I.__filtered__=I.__filtered__||x,I}}),Ri(["head","last"],function(a,u){var p="take"+(u?"Right":"");Ye.prototype[a]=function(){return this[p](1).value()[0]}}),Ri(["initial","tail"],function(a,u){var p="drop"+(u?"":"Right");Ye.prototype[a]=function(){return this.__filtered__?new Ye(this):this[p](1)}}),Ye.prototype.compact=function(){return this.filter(pi)},Ye.prototype.find=function(a){return this.filter(a).head()},Ye.prototype.findLast=function(a){return this.reverse().find(a)},Ye.prototype.invokeMap=We(function(a,u){return typeof a=="function"?new Ye(this):this.map(function(p){return as(p,a,u)})}),Ye.prototype.reject=function(a){return this.filter(Sa(Pe(a)))},Ye.prototype.slice=function(a,u){a=He(a);var p=this;return p.__filtered__&&(a>0||u<0)?new Ye(p):(a<0?p=p.takeRight(-a):a&&(p=p.drop(a)),u!==t&&(u=He(u),p=u<0?p.dropRight(-u):p.take(u-a)),p)},Ye.prototype.takeRightWhile=function(a){return this.reverse().takeWhile(a).reverse()},Ye.prototype.toArray=function(){return this.take(he)},Qi(Ye.prototype,function(a,u){var p=/^(?:filter|find|map|reject)|While$/.test(u),x=/^(?:head|last)$/.test(u),M=C[x?"take"+(u=="last"?"Right":""):u],I=x||/^find/.test(u);!M||(C.prototype[u]=function(){var k=this.__wrapped__,B=x?[1]:arguments,W=k instanceof Ye,ie=B[0],ne=W||Be(k),ue=function(Xe){var Ke=M.apply(C,Lr([Xe],B));return x&&ge?Ke[0]:Ke};ne&&p&&typeof ie=="function"&&ie.length!=1&&(W=ne=!1);var ge=this.__chain__,Me=!!this.__actions__.length,Re=I&&!ge,$e=W&&!Me;if(!I&&ne){k=$e?k:new Ye(this);var Ie=a.apply(k,B);return Ie.__actions__.push({func:_a,args:[ue],thisArg:t}),new Li(Ie,ge)}return Re&&$e?a.apply(this,B):(Ie=this.thru(ue),Re?x?Ie.value()[0]:Ie.value():Ie)})}),Ri(["pop","push","shift","sort","splice","unshift"],function(a){var u=js[a],p=/^(?:push|sort|unshift)$/.test(a)?"tap":"thru",x=/^(?:pop|shift)$/.test(a);C.prototype[a]=function(){var M=arguments;if(x&&!this.__chain__){var I=this.value();return u.apply(Be(I)?I:[],M)}return this[p](function(k){return u.apply(Be(k)?k:[],M)})}}),Qi(Ye.prototype,function(a,u){var p=C[u];if(p){var x=p.name+"";ot.call(Rn,x)||(Rn[x]=[]),Rn[x].push({name:u,func:p})}}),Rn[da(t,T).name]=[{name:"wrapper",func:t}],Ye.prototype.clone=pv,Ye.prototype.reverse=mv,Ye.prototype.value=gv,C.prototype.at=j0,C.prototype.chain=G0,C.prototype.commit=q0,C.prototype.next=X0,C.prototype.plant=J0,C.prototype.reverse=Y0,C.prototype.toJSON=C.prototype.valueOf=C.prototype.value=K0,C.prototype.first=C.prototype.head,Qn&&(C.prototype[Qn]=Z0),C},qr=qg();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(Gt._=qr,define(function(){return qr})):rn?((rn.exports=qr)._=qr,Oo._=qr):Gt._=qr}).call(i)}),cie=Fa((i,e)=>{var t=1e3,r=t*60,n=r*60,l=n*24,c=l*7,h=l*365.25;e.exports=function(y,_){_=_||{};var b=typeof y;if(b==="string"&&y.length>0)return d(y);if(b==="number"&&isFinite(y))return _.long?m(y):f(y);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(y))};function d(y){if(y=String(y),!(y.length>100)){var _=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(y);if(_){var b=parseFloat(_[1]),S=(_[2]||"ms").toLowerCase();switch(S){case"years":case"year":case"yrs":case"yr":case"y":return b*h;case"weeks":case"week":case"w":return b*c;case"days":case"day":case"d":return b*l;case"hours":case"hour":case"hrs":case"hr":case"h":return b*n;case"minutes":case"minute":case"mins":case"min":case"m":return b*r;case"seconds":case"second":case"secs":case"sec":case"s":return b*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return b;default:return}}}}function f(y){var _=Math.abs(y);return _>=l?Math.round(y/l)+"d":_>=n?Math.round(y/n)+"h":_>=r?Math.round(y/r)+"m":_>=t?Math.round(y/t)+"s":y+"ms"}function m(y){var _=Math.abs(y);return _>=l?g(y,_,l,"day"):_>=n?g(y,_,n,"hour"):_>=r?g(y,_,r,"minute"):_>=t?g(y,_,t,"second"):y+" ms"}function g(y,_,b,S){var E=_>=b*1.5;return Math.round(y/b)+" "+S+(E?"s":"")}}),hie=Fa((i,e)=>{function t(r){l.debug=l,l.default=l,l.coerce=g,l.disable=d,l.enable=h,l.enabled=f,l.humanize=cie(),l.destroy=y,Object.keys(r).forEach(_=>{l[_]=r[_]}),l.names=[],l.skips=[],l.formatters={};function n(_){let b=0;for(let S=0;S<_.length;S++)b=(b<<5)-b+_.charCodeAt(S),b|=0;return l.colors[Math.abs(b)%l.colors.length]}l.selectColor=n;function l(_){let b,S=null,E,T;function A(...P){if(!A.enabled)return;let O=A,R=Number(new Date),D=R-(b||R);O.diff=D,O.prev=b,O.curr=R,b=R,P[0]=l.coerce(P[0]),typeof P[0]!="string"&&P.unshift("%O");let L=0;P[0]=P[0].replace(/%([a-zA-Z%])/g,(N,U)=>{if(N==="%%")return"%";L++;let F=l.formatters[U];if(typeof F=="function"){let z=P[L];N=F.call(O,z),P.splice(L,1),L--}return N}),l.formatArgs.call(O,P),(O.log||l.log).apply(O,P)}return A.namespace=_,A.useColors=l.useColors(),A.color=l.selectColor(_),A.extend=c,A.destroy=l.destroy,Object.defineProperty(A,"enabled",{enumerable:!0,configurable:!1,get:()=>S!==null?S:(E!==l.namespaces&&(E=l.namespaces,T=l.enabled(_)),T),set:P=>{S=P}}),typeof l.init=="function"&&l.init(A),A}function c(_,b){let S=l(this.namespace+(typeof b>"u"?":":b)+_);return S.log=this.log,S}function h(_){l.save(_),l.namespaces=_,l.names=[],l.skips=[];let b,S=(typeof _=="string"?_:"").split(/[\s,]+/),E=S.length;for(b=0;b<E;b++)!S[b]||(_=S[b].replace(/\*/g,".*?"),_[0]==="-"?l.skips.push(new RegExp("^"+_.slice(1)+"$")):l.names.push(new RegExp("^"+_+"$")))}function d(){let _=[...l.names.map(m),...l.skips.map(m).map(b=>"-"+b)].join(",");return l.enable(""),_}function f(_){if(_[_.length-1]==="*")return!0;let b,S;for(b=0,S=l.skips.length;b<S;b++)if(l.skips[b].test(_))return!1;for(b=0,S=l.names.length;b<S;b++)if(l.names[b].test(_))return!0;return!1}function m(_){return _.toString().substring(2,_.toString().length-2).replace(/\.\*\?$/,"*")}function g(_){return _ instanceof Error?_.stack||_.message:_}function y(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return l.enable(l.load()),l}e.exports=t}),U8=Fa((i,e)=>{i.formatArgs=r,i.save=n,i.load=l,i.useColors=t,i.storage=c(),i.destroy=(()=>{let d=!1;return()=>{d||(d=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),i.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function t(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(d){if(d[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+d[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;let f="color: "+this.color;d.splice(1,0,f,"color: inherit");let m=0,g=0;d[0].replace(/%[a-zA-Z%]/g,y=>{y!=="%%"&&(m++,y==="%c"&&(g=m))}),d.splice(g,0,f)}i.log=console.debug||console.log||(()=>{});function n(d){try{d?i.storage.setItem("debug",d):i.storage.removeItem("debug")}catch{}}function l(){let d;try{d=i.storage.getItem("debug")}catch{}return!d&&typeof process<"u"&&"env"in process&&(d=tie.DEBUG),d}function c(){try{return localStorage}catch{}}e.exports=hie()(i);var{formatters:h}=e.exports;h.j=function(d){try{return JSON.stringify(d)}catch(f){return"[UnexpectedJSONParseError]: "+f.message}}}),Lz=Fa((i,e)=>{function t(r){var n=typeof r;return r!=null&&(n=="object"||n=="function")}e.exports=t}),die=Fa((i,e)=>{var t=typeof global=="object"&&global&&global.Object===Object&&global;e.exports=t}),H8=Fa((i,e)=>{var t=die(),r=typeof self=="object"&&self&&self.Object===Object&&self,n=t||r||Function("return this")();e.exports=n}),fie=Fa((i,e)=>{var t=H8(),r=function(){return t.Date.now()};e.exports=r}),pie=Fa((i,e)=>{var t=/\s/;function r(n){for(var l=n.length;l--&&t.test(n.charAt(l)););return l}e.exports=r}),mie=Fa((i,e)=>{var t=pie(),r=/^\s+/;function n(l){return l&&l.slice(0,t(l)+1).replace(r,"")}e.exports=n}),$8=Fa((i,e)=>{var t=H8(),r=t.Symbol;e.exports=r}),gie=Fa((i,e)=>{var t=$8(),r=Object.prototype,n=r.hasOwnProperty,l=r.toString,c=t?t.toStringTag:void 0;function h(d){var f=n.call(d,c),m=d[c];try{d[c]=void 0;var g=!0}catch{}var y=l.call(d);return g&&(f?d[c]=m:delete d[c]),y}e.exports=h}),vie=Fa((i,e)=>{var t=Object.prototype,r=t.toString;function n(l){return r.call(l)}e.exports=n}),yie=Fa((i,e)=>{var t=$8(),r=gie(),n=vie(),l="[object Null]",c="[object Undefined]",h=t?t.toStringTag:void 0;function d(f){return f==null?f===void 0?c:l:h&&h in Object(f)?r(f):n(f)}e.exports=d}),_ie=Fa((i,e)=>{function t(r){return r!=null&&typeof r=="object"}e.exports=t}),xie=Fa((i,e)=>{var t=yie(),r=_ie(),n="[object Symbol]";function l(c){return typeof c=="symbol"||r(c)&&t(c)==n}e.exports=l}),bie=Fa((i,e)=>{var t=mie(),r=Lz(),n=xie(),l=NaN,c=/^[-+]0x[0-9a-f]+$/i,h=/^0b[01]+$/i,d=/^0o[0-7]+$/i,f=parseInt;function m(g){if(typeof g=="number")return g;if(n(g))return l;if(r(g)){var y=typeof g.valueOf=="function"?g.valueOf():g;g=r(y)?y+"":y}if(typeof g!="string")return g===0?g:+g;g=t(g);var _=h.test(g);return _||d.test(g)?f(g.slice(2),_?2:8):c.test(g)?l:+g}e.exports=m}),wie=Fa((i,e)=>{var t=Lz(),r=fie(),n=bie(),l="Expected a function",c=Math.max,h=Math.min;function d(f,m,g){var y,_,b,S,E,T,A=0,P=!1,O=!1,R=!0;if(typeof f!="function")throw new TypeError(l);m=n(m)||0,t(g)&&(P=!!g.leading,O="maxWait"in g,b=O?c(n(g.maxWait)||0,m):b,R="trailing"in g?!!g.trailing:R);function D(q){var $=y,H=_;return y=_=void 0,A=q,S=f.apply(H,$),S}function L(q){return A=q,E=setTimeout(F,m),P?D(q):S}function N(q){var $=q-T,H=q-A,X=m-$;return O?h(X,b-H):X}function U(q){var $=q-T,H=q-A;return T===void 0||$>=m||$<0||O&&H>=b}function F(){var q=r();if(U(q))return z(q);E=setTimeout(F,N(q))}function z(q){return E=void 0,R&&y?D(q):(y=_=void 0,S)}function G(){E!==void 0&&clearTimeout(E),A=0,y=T=_=E=void 0}function J(){return E===void 0?S:z(r())}function Z(){var q=r(),$=U(q);if(y=arguments,_=this,T=q,$){if(E===void 0)return L(T);if(O)return clearTimeout(E),E=setTimeout(F,m),D(T)}return E===void 0&&(E=setTimeout(F,m)),S}return Z.cancel=G,Z.flush=J,Z}e.exports=d}),Sie=Fa((i,e)=>{var t=wie(),r=Lz(),n="Expected a function";function l(c,h,d){var f=!0,m=!0;if(typeof c!="function")throw new TypeError(n);return r(d)&&(f="leading"in d?!!d.leading:f,m="trailing"in d?!!d.trailing:m),t(c,h,{leading:f,maxWait:h,trailing:m})}e.exports=l}),Mie=$I(uie()),Oz="139",Eie=0,r6=1,Tie=2,V8=1,Aie=2,LT=3,TA=0,Vd=1,NM=2,W8=1,Um=0,fM=1,n6=2,s6=3,a6=4,Cie=5,NS=100,Pie=101,Rie=102,o6=103,l6=104,Iie=200,Lie=201,Oie=202,Nie=203,j8=204,G8=205,Die=206,kie=207,Fie=208,zie=209,Bie=210,Uie=0,Hie=1,$ie=2,Yk=3,Vie=4,Wie=5,jie=6,Gie=7,VI=0,qie=1,Xie=2,vp=0,Zie=1,Jie=2,Yie=3,Kie=4,Qie=5,q8=300,DM=301,kM=302,Kk=303,Qk=304,WI=306,eF=1e3,zd=1001,tF=1002,Ga=1003,u6=1004,c6=1005,nu=1006,ere=1007,jI=1008,rw=1009,tre=1010,ire=1011,AA=1012,rre=1013,VP=1014,I1=1015,pM=1016,nre=1017,sre=1018,mM=1020,are=1021,ore=1022,Bd=1023,lre=1024,ure=1025,W1=1026,FM=1027,cre=1028,hre=1029,dre=1030,fre=1031,pre=1033,nO=33776,sO=33777,aO=33778,oO=33779,h6=35840,d6=35841,f6=35842,p6=35843,mre=36196,m6=37492,g6=37496,v6=37808,y6=37809,_6=37810,x6=37811,b6=37812,w6=37813,S6=37814,M6=37815,E6=37816,T6=37817,A6=37818,C6=37819,P6=37820,R6=37821,I6=36492,gre=2200,vre=2201,yre=2202,OR=2300,NR=2301,lO=2302,JS=2400,YS=2401,DR=2402,Nz=2500,X8=2501,Z8=0,_re=1,L6=2,Tp=3e3,jn=3001,xre=3200,bre=3201,oE=0,wre=1,ap="srgb",L1="srgb-linear",uO=7680,Sre=519,CA=35044,kR=35048,O6="300 es",iF=1035,yw=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;let r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;let r=this._listeners[e];if(r!==void 0){let n=r.indexOf(t);n!==-1&&r.splice(n,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let t=this._listeners[e.type];if(t!==void 0){e.target=this;let r=t.slice(0);for(let n=0,l=r.length;n<l;n++)r[n].call(this,e);e.target=null}}},Ka=[];for(let i=0;i<256;i++)Ka[i]=(i<16?"0":"")+i.toString(16);var cO=Math.PI/180,rF=180/Math.PI;function xf(){let i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(Ka[i&255]+Ka[i>>8&255]+Ka[i>>16&255]+Ka[i>>24&255]+"-"+Ka[e&255]+Ka[e>>8&255]+"-"+Ka[e>>16&15|64]+Ka[e>>24&255]+"-"+Ka[t&63|128]+Ka[t>>8&255]+"-"+Ka[t>>16&255]+Ka[t>>24&255]+Ka[r&255]+Ka[r>>8&255]+Ka[r>>16&255]+Ka[r>>24&255]).toLowerCase()}function So(i,e,t){return Math.max(e,Math.min(t,i))}function Mre(i,e){return(i%e+e)%e}function hO(i,e,t){return(1-t)*i+t*e}function N6(i){return(i&i-1)===0&&i!==0}function nF(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}var At=class{constructor(e=0,t=0){this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,r=this.y,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6],this.y=n[1]*t+n[4]*r+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,r){return r!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let r=Math.cos(t),n=Math.sin(t),l=this.x-e.x,c=this.y-e.y;return this.x=l*r-c*n+e.x,this.y=l*n+c*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}};At.prototype.isVector2=!0;var io=class{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(i,e,t,r,n,l,c,h,d){let f=this.elements;return f[0]=i,f[1]=r,f[2]=c,f[3]=e,f[4]=n,f[5]=h,f[6]=t,f[7]=l,f[8]=d,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(i){let e=this.elements,t=i.elements;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this}extractBasis(i,e,t){return i.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),t.setFromMatrix3Column(this,2),this}setFromMatrix4(i){let e=i.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(i){return this.multiplyMatrices(this,i)}premultiply(i){return this.multiplyMatrices(i,this)}multiplyMatrices(i,e){let t=i.elements,r=e.elements,n=this.elements,l=t[0],c=t[3],h=t[6],d=t[1],f=t[4],m=t[7],g=t[2],y=t[5],_=t[8],b=r[0],S=r[3],E=r[6],T=r[1],A=r[4],P=r[7],O=r[2],R=r[5],D=r[8];return n[0]=l*b+c*T+h*O,n[3]=l*S+c*A+h*R,n[6]=l*E+c*P+h*D,n[1]=d*b+f*T+m*O,n[4]=d*S+f*A+m*R,n[7]=d*E+f*P+m*D,n[2]=g*b+y*T+_*O,n[5]=g*S+y*A+_*R,n[8]=g*E+y*P+_*D,this}multiplyScalar(i){let e=this.elements;return e[0]*=i,e[3]*=i,e[6]*=i,e[1]*=i,e[4]*=i,e[7]*=i,e[2]*=i,e[5]*=i,e[8]*=i,this}determinant(){let i=this.elements,e=i[0],t=i[1],r=i[2],n=i[3],l=i[4],c=i[5],h=i[6],d=i[7],f=i[8];return e*l*f-e*c*d-t*n*f+t*c*h+r*n*d-r*l*h}invert(){let i=this.elements,e=i[0],t=i[1],r=i[2],n=i[3],l=i[4],c=i[5],h=i[6],d=i[7],f=i[8],m=f*l-c*d,g=c*h-f*n,y=d*n-l*h,_=e*m+t*g+r*y;if(_===0)return this.set(0,0,0,0,0,0,0,0,0);let b=1/_;return i[0]=m*b,i[1]=(r*d-f*t)*b,i[2]=(c*t-r*l)*b,i[3]=g*b,i[4]=(f*e-r*h)*b,i[5]=(r*n-c*e)*b,i[6]=y*b,i[7]=(t*h-d*e)*b,i[8]=(l*e-t*n)*b,this}transpose(){let i,e=this.elements;return i=e[1],e[1]=e[3],e[3]=i,i=e[2],e[2]=e[6],e[6]=i,i=e[5],e[5]=e[7],e[7]=i,this}getNormalMatrix(i){return this.setFromMatrix4(i).invert().transpose()}transposeIntoArray(i){let e=this.elements;return i[0]=e[0],i[1]=e[3],i[2]=e[6],i[3]=e[1],i[4]=e[4],i[5]=e[7],i[6]=e[2],i[7]=e[5],i[8]=e[8],this}setUvTransform(i,e,t,r,n,l,c){let h=Math.cos(n),d=Math.sin(n);return this.set(t*h,t*d,-t*(h*l+d*c)+l+i,-r*d,r*h,-r*(-d*l+h*c)+c+e,0,0,1),this}scale(i,e){let t=this.elements;return t[0]*=i,t[3]*=i,t[6]*=i,t[1]*=e,t[4]*=e,t[7]*=e,this}rotate(i){let e=Math.cos(i),t=Math.sin(i),r=this.elements,n=r[0],l=r[3],c=r[6],h=r[1],d=r[4],f=r[7];return r[0]=e*n+t*h,r[3]=e*l+t*d,r[6]=e*c+t*f,r[1]=-t*n+e*h,r[4]=-t*l+e*d,r[7]=-t*c+e*f,this}translate(i,e){let t=this.elements;return t[0]+=i*t[2],t[3]+=i*t[5],t[6]+=i*t[8],t[1]+=e*t[2],t[4]+=e*t[5],t[7]+=e*t[8],this}equals(i){let e=this.elements,t=i.elements;for(let r=0;r<9;r++)if(e[r]!==t[r])return!1;return!0}fromArray(i,e=0){for(let t=0;t<9;t++)this.elements[t]=i[t+e];return this}toArray(i=[],e=0){let t=this.elements;return i[e]=t[0],i[e+1]=t[1],i[e+2]=t[2],i[e+3]=t[3],i[e+4]=t[4],i[e+5]=t[5],i[e+6]=t[6],i[e+7]=t[7],i[e+8]=t[8],i}clone(){return new this.constructor().fromArray(this.elements)}};io.prototype.isMatrix3=!0;function J8(i){for(let e=i.length-1;e>=0;--e)if(i[e]>65535)return!0;return!1}function PA(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function j1(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function WP(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}var dO={[ap]:{[L1]:j1},[L1]:{[ap]:WP}},yd={legacyMode:!0,get workingColorSpace(){return L1},set workingColorSpace(i){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(i,e,t){if(this.legacyMode||e===t||!e||!t)return i;if(dO[e]&&dO[e][t]!==void 0){let r=dO[e][t];return i.r=r(i.r),i.g=r(i.g),i.b=r(i.b),i}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(i,e){return this.convert(i,this.workingColorSpace,e)},toWorkingColorSpace:function(i,e){return this.convert(i,e,this.workingColorSpace)}},Y8={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Aa={r:0,g:0,b:0},_d={h:0,s:0,l:0},n2={h:0,s:0,l:0};function fO(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}function s2(i,e){return e.r=i.r,e.g=i.g,e.b=i.b,e}var Ei=class{constructor(e,t,r){return t===void 0&&r===void 0?this.set(e):this.setRGB(e,t,r)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=ap){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,yd.toWorkingColorSpace(this,t),this}setRGB(e,t,r,n=L1){return this.r=e,this.g=t,this.b=r,yd.toWorkingColorSpace(this,n),this}setHSL(e,t,r,n=L1){if(e=Mre(e,1),t=So(t,0,1),r=So(r,0,1),t===0)this.r=this.g=this.b=r;else{let l=r<=.5?r*(1+t):r+t-r*t,c=2*r-l;this.r=fO(c,l,e+1/3),this.g=fO(c,l,e),this.b=fO(c,l,e-1/3)}return yd.toWorkingColorSpace(this,n),this}setStyle(e,t=ap){function r(l){l!==void 0&&parseFloat(l)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let l,c=n[1],h=n[2];switch(c){case"rgb":case"rgba":if(l=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return this.r=Math.min(255,parseInt(l[1],10))/255,this.g=Math.min(255,parseInt(l[2],10))/255,this.b=Math.min(255,parseInt(l[3],10))/255,yd.toWorkingColorSpace(this,t),r(l[4]),this;if(l=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return this.r=Math.min(100,parseInt(l[1],10))/100,this.g=Math.min(100,parseInt(l[2],10))/100,this.b=Math.min(100,parseInt(l[3],10))/100,yd.toWorkingColorSpace(this,t),r(l[4]),this;break;case"hsl":case"hsla":if(l=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h)){let d=parseFloat(l[1])/360,f=parseInt(l[2],10)/100,m=parseInt(l[3],10)/100;return r(l[4]),this.setHSL(d,f,m,t)}break}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){let l=n[1],c=l.length;if(c===3)return this.r=parseInt(l.charAt(0)+l.charAt(0),16)/255,this.g=parseInt(l.charAt(1)+l.charAt(1),16)/255,this.b=parseInt(l.charAt(2)+l.charAt(2),16)/255,yd.toWorkingColorSpace(this,t),this;if(c===6)return this.r=parseInt(l.charAt(0)+l.charAt(1),16)/255,this.g=parseInt(l.charAt(2)+l.charAt(3),16)/255,this.b=parseInt(l.charAt(4)+l.charAt(5),16)/255,yd.toWorkingColorSpace(this,t),this}return e&&e.length>0?this.setColorName(e,t):this}setColorName(e,t=ap){let r=Y8[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=j1(e.r),this.g=j1(e.g),this.b=j1(e.b),this}copyLinearToSRGB(e){return this.r=WP(e.r),this.g=WP(e.g),this.b=WP(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=ap){return yd.fromWorkingColorSpace(s2(this,Aa),e),So(Aa.r*255,0,255)<<16^So(Aa.g*255,0,255)<<8^So(Aa.b*255,0,255)<<0}getHexString(e=ap){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=L1){yd.fromWorkingColorSpace(s2(this,Aa),t);let r=Aa.r,n=Aa.g,l=Aa.b,c=Math.max(r,n,l),h=Math.min(r,n,l),d,f,m=(h+c)/2;if(h===c)d=0,f=0;else{let g=c-h;switch(f=m<=.5?g/(c+h):g/(2-c-h),c){case r:d=(n-l)/g+(n<l?6:0);break;case n:d=(l-r)/g+2;break;case l:d=(r-n)/g+4;break}d/=6}return e.h=d,e.s=f,e.l=m,e}getRGB(e,t=L1){return yd.fromWorkingColorSpace(s2(this,Aa),t),e.r=Aa.r,e.g=Aa.g,e.b=Aa.b,e}getStyle(e=ap){return yd.fromWorkingColorSpace(s2(this,Aa),e),e!==ap?`color(${e} ${Aa.r} ${Aa.g} ${Aa.b})`:`rgb(${Aa.r*255|0},${Aa.g*255|0},${Aa.b*255|0})`}offsetHSL(e,t,r){return this.getHSL(_d),_d.h+=e,_d.s+=t,_d.l+=r,this.setHSL(_d.h,_d.s,_d.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(_d),e.getHSL(n2);let r=hO(_d.h,n2.h,t),n=hO(_d.s,n2.s,t),l=hO(_d.l,n2.l,t);return this.setHSL(r,n,l),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),e.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}};Ei.NAMES=Y8;Ei.prototype.isColor=!0;Ei.prototype.r=1;Ei.prototype.g=1;Ei.prototype.b=1;var Tw,_w=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Tw===void 0&&(Tw=PA("canvas")),Tw.width=e.width,Tw.height=e.height;let r=Tw.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=Tw}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=PA("canvas");t.width=e.width,t.height=e.height;let r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);let n=r.getImageData(0,0,e.width,e.height),l=n.data;for(let c=0;c<l.length;c++)l[c]=j1(l[c]/255)*255;return r.putImageData(n,0,0),t}else if(e.data){let t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(j1(t[r]/255)*255):t[r]=j1(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},K8=class{constructor(e=null){this.uuid=xf(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let r={uuid:this.uuid,url:""},n=this.data;if(n!==null){let l;if(Array.isArray(n)){l=[];for(let c=0,h=n.length;c<h;c++)n[c].isDataTexture?l.push(pO(n[c].image)):l.push(pO(n[c]))}else l=pO(n);r.url=l}return t||(e.images[this.uuid]=r),r}};function pO(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?_w.getDataURL(i):i.data?{data:Array.prototype.slice.call(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}K8.prototype.isSource=!0;var Ere=0,so=class extends yw{constructor(e=so.DEFAULT_IMAGE,t=so.DEFAULT_MAPPING,r=zd,n=zd,l=nu,c=jI,h=Bd,d=rw,f=1,m=Tp){super(),Object.defineProperty(this,"id",{value:Ere++}),this.uuid=xf(),this.name="",this.source=new K8(e),this.mipmaps=[],this.mapping=t,this.wrapS=r,this.wrapT=n,this.magFilter=l,this.minFilter=c,this.anisotropy=f,this.format=h,this.internalFormat=null,this.type=d,this.offset=new At(0,0),this.repeat=new At(1,1),this.center=new At(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new io,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=m,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];let r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return JSON.stringify(this.userData)!=="{}"&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==q8)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case eF:e.x=e.x-Math.floor(e.x);break;case zd:e.x=e.x<0?0:1;break;case tF:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case eF:e.y=e.y-Math.floor(e.y);break;case zd:e.y=e.y<0?0:1;break;case tF:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}};so.DEFAULT_IMAGE=null;so.DEFAULT_MAPPING=q8;so.prototype.isTexture=!0;var wn=class{constructor(e=0,t=0,r=0,n=1){this.x=e,this.y=t,this.z=r,this.w=n}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,r=this.y,n=this.z,l=this.w,c=e.elements;return this.x=c[0]*t+c[4]*r+c[8]*n+c[12]*l,this.y=c[1]*t+c[5]*r+c[9]*n+c[13]*l,this.z=c[2]*t+c[6]*r+c[10]*n+c[14]*l,this.w=c[3]*t+c[7]*r+c[11]*n+c[15]*l,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,n,l,c=e.elements,h=c[0],d=c[4],f=c[8],m=c[1],g=c[5],y=c[9],_=c[2],b=c[6],S=c[10];if(Math.abs(d-m)<.01&&Math.abs(f-_)<.01&&Math.abs(y-b)<.01){if(Math.abs(d+m)<.1&&Math.abs(f+_)<.1&&Math.abs(y+b)<.1&&Math.abs(h+g+S-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let T=(h+1)/2,A=(g+1)/2,P=(S+1)/2,O=(d+m)/4,R=(f+_)/4,D=(y+b)/4;return T>A&&T>P?T<.01?(r=0,n=.707106781,l=.707106781):(r=Math.sqrt(T),n=O/r,l=R/r):A>P?A<.01?(r=.707106781,n=0,l=.707106781):(n=Math.sqrt(A),r=O/n,l=D/n):P<.01?(r=.707106781,n=.707106781,l=0):(l=Math.sqrt(P),r=R/l,n=D/l),this.set(r,n,l,t),this}let E=Math.sqrt((b-y)*(b-y)+(f-_)*(f-_)+(m-d)*(m-d));return Math.abs(E)<.001&&(E=1),this.x=(b-y)/E,this.y=(f-_)/E,this.z=(m-d)/E,this.w=Math.acos((h+g+S-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,r){return r!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}};wn.prototype.isVector4=!0;var Nu=class extends yw{constructor(e,t,r={}){super(),this.width=e,this.height=t,this.depth=1,this.scissor=new wn(0,0,e,t),this.scissorTest=!1,this.viewport=new wn(0,0,e,t);let n={width:e,height:t,depth:1};this.texture=new so(n,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=r.generateMipmaps!==void 0?r.generateMipmaps:!1,this.texture.internalFormat=r.internalFormat!==void 0?r.internalFormat:null,this.texture.minFilter=r.minFilter!==void 0?r.minFilter:nu,this.depthBuffer=r.depthBuffer!==void 0?r.depthBuffer:!0,this.stencilBuffer=r.stencilBuffer!==void 0?r.stencilBuffer:!1,this.depthTexture=r.depthTexture!==void 0?r.depthTexture:null,this.samples=r.samples!==void 0?r.samples:0}setSize(e,t,r=1){(this.width!==e||this.height!==t||this.depth!==r)&&(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0,this.texture.image=Object.assign({},e.texture.image),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}};Nu.prototype.isWebGLRenderTarget=!0;var GI=class extends so{constructor(e=null,t=1,r=1,n=1){super(null),this.image={data:e,width:t,height:r,depth:n},this.magFilter=Ga,this.minFilter=Ga,this.wrapR=zd,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};GI.prototype.isDataArrayTexture=!0;var Tre=class extends Nu{constructor(i,e,t){super(i,e),this.depth=t,this.texture=new GI(null,i,e,t),this.texture.isRenderTargetTexture=!0}};Tre.prototype.isWebGLArrayRenderTarget=!0;var Dz=class extends so{constructor(i=null,e=1,t=1,r=1){super(null),this.image={data:i,width:e,height:t,depth:r},this.magFilter=Ga,this.minFilter=Ga,this.wrapR=zd,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};Dz.prototype.isData3DTexture=!0;var Are=class extends Nu{constructor(i,e,t){super(i,e),this.depth=t,this.texture=new Dz(null,i,e,t),this.texture.isRenderTargetTexture=!0}};Are.prototype.isWebGL3DRenderTarget=!0;var Cre=class extends Nu{constructor(i,e,t,r={}){super(i,e,r);let n=this.texture;this.texture=[];for(let l=0;l<t;l++)this.texture[l]=n.clone(),this.texture[l].isRenderTargetTexture=!0}setSize(i,e,t=1){if(this.width!==i||this.height!==e||this.depth!==t){this.width=i,this.height=e,this.depth=t;for(let r=0,n=this.texture.length;r<n;r++)this.texture[r].image.width=i,this.texture[r].image.height=e,this.texture[r].image.depth=t;this.dispose()}return this.viewport.set(0,0,i,e),this.scissor.set(0,0,i,e),this}copy(i){this.dispose(),this.width=i.width,this.height=i.height,this.depth=i.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.texture.length=0;for(let e=0,t=i.texture.length;e<t;e++)this.texture[e]=i.texture[e].clone();return this}};Cre.prototype.isWebGLMultipleRenderTargets=!0;var Xl=class{constructor(e=0,t=0,r=0,n=1){this._x=e,this._y=t,this._z=r,this._w=n}static slerp(e,t,r,n){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),r.slerpQuaternions(e,t,n)}static slerpFlat(e,t,r,n,l,c,h){let d=r[n+0],f=r[n+1],m=r[n+2],g=r[n+3],y=l[c+0],_=l[c+1],b=l[c+2],S=l[c+3];if(h===0){e[t+0]=d,e[t+1]=f,e[t+2]=m,e[t+3]=g;return}if(h===1){e[t+0]=y,e[t+1]=_,e[t+2]=b,e[t+3]=S;return}if(g!==S||d!==y||f!==_||m!==b){let E=1-h,T=d*y+f*_+m*b+g*S,A=T>=0?1:-1,P=1-T*T;if(P>Number.EPSILON){let R=Math.sqrt(P),D=Math.atan2(R,T*A);E=Math.sin(E*D)/R,h=Math.sin(h*D)/R}let O=h*A;if(d=d*E+y*O,f=f*E+_*O,m=m*E+b*O,g=g*E+S*O,E===1-h){let R=1/Math.sqrt(d*d+f*f+m*m+g*g);d*=R,f*=R,m*=R,g*=R}}e[t]=d,e[t+1]=f,e[t+2]=m,e[t+3]=g}static multiplyQuaternionsFlat(e,t,r,n,l,c){let h=r[n],d=r[n+1],f=r[n+2],m=r[n+3],g=l[c],y=l[c+1],_=l[c+2],b=l[c+3];return e[t]=h*b+m*g+d*_-f*y,e[t+1]=d*b+m*y+f*g-h*_,e[t+2]=f*b+m*_+h*y-d*g,e[t+3]=m*b-h*g-d*y-f*_,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!(e&&e.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");let r=e._x,n=e._y,l=e._z,c=e._order,h=Math.cos,d=Math.sin,f=h(r/2),m=h(n/2),g=h(l/2),y=d(r/2),_=d(n/2),b=d(l/2);switch(c){case"XYZ":this._x=y*m*g+f*_*b,this._y=f*_*g-y*m*b,this._z=f*m*b+y*_*g,this._w=f*m*g-y*_*b;break;case"YXZ":this._x=y*m*g+f*_*b,this._y=f*_*g-y*m*b,this._z=f*m*b-y*_*g,this._w=f*m*g+y*_*b;break;case"ZXY":this._x=y*m*g-f*_*b,this._y=f*_*g+y*m*b,this._z=f*m*b+y*_*g,this._w=f*m*g-y*_*b;break;case"ZYX":this._x=y*m*g-f*_*b,this._y=f*_*g+y*m*b,this._z=f*m*b-y*_*g,this._w=f*m*g+y*_*b;break;case"YZX":this._x=y*m*g+f*_*b,this._y=f*_*g+y*m*b,this._z=f*m*b-y*_*g,this._w=f*m*g-y*_*b;break;case"XZY":this._x=y*m*g-f*_*b,this._y=f*_*g-y*m*b,this._z=f*m*b+y*_*g,this._w=f*m*g+y*_*b;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+c)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let r=t/2,n=Math.sin(r);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,r=t[0],n=t[4],l=t[8],c=t[1],h=t[5],d=t[9],f=t[2],m=t[6],g=t[10],y=r+h+g;if(y>0){let _=.5/Math.sqrt(y+1);this._w=.25/_,this._x=(m-d)*_,this._y=(l-f)*_,this._z=(c-n)*_}else if(r>h&&r>g){let _=2*Math.sqrt(1+r-h-g);this._w=(m-d)/_,this._x=.25*_,this._y=(n+c)/_,this._z=(l+f)/_}else if(h>g){let _=2*Math.sqrt(1+h-r-g);this._w=(l-f)/_,this._x=(n+c)/_,this._y=.25*_,this._z=(d+m)/_}else{let _=2*Math.sqrt(1+g-r-h);this._w=(c-n)/_,this._x=(l+f)/_,this._y=(d+m)/_,this._z=.25*_}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(So(this.dot(e),-1,1)))}rotateTowards(e,t){let r=this.angleTo(e);if(r===0)return this;let n=Math.min(1,t/r);return this.slerp(e,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return t!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let r=e._x,n=e._y,l=e._z,c=e._w,h=t._x,d=t._y,f=t._z,m=t._w;return this._x=r*m+c*h+n*f-l*d,this._y=n*m+c*d+l*h-r*f,this._z=l*m+c*f+r*d-n*h,this._w=c*m-r*h-n*d-l*f,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let r=this._x,n=this._y,l=this._z,c=this._w,h=c*e._w+r*e._x+n*e._y+l*e._z;if(h<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,h=-h):this.copy(e),h>=1)return this._w=c,this._x=r,this._y=n,this._z=l,this;let d=1-h*h;if(d<=Number.EPSILON){let _=1-t;return this._w=_*c+t*this._w,this._x=_*r+t*this._x,this._y=_*n+t*this._y,this._z=_*l+t*this._z,this.normalize(),this._onChangeCallback(),this}let f=Math.sqrt(d),m=Math.atan2(f,h),g=Math.sin((1-t)*m)/f,y=Math.sin(t*m)/f;return this._w=c*g+this._w*y,this._x=r*g+this._x*y,this._y=n*g+this._y*y,this._z=l*g+this._z*y,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){let e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),n=2*Math.PI*Math.random(),l=2*Math.PI*Math.random();return this.set(t*Math.cos(n),r*Math.sin(l),r*Math.cos(l),t*Math.sin(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}};Xl.prototype.isQuaternion=!0;var Te=class{constructor(e=0,t=0,r=0){this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return t!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(D6.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(D6.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,r=this.y,n=this.z,l=e.elements;return this.x=l[0]*t+l[3]*r+l[6]*n,this.y=l[1]*t+l[4]*r+l[7]*n,this.z=l[2]*t+l[5]*r+l[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,r=this.y,n=this.z,l=e.elements,c=1/(l[3]*t+l[7]*r+l[11]*n+l[15]);return this.x=(l[0]*t+l[4]*r+l[8]*n+l[12])*c,this.y=(l[1]*t+l[5]*r+l[9]*n+l[13])*c,this.z=(l[2]*t+l[6]*r+l[10]*n+l[14])*c,this}applyQuaternion(e){let t=this.x,r=this.y,n=this.z,l=e.x,c=e.y,h=e.z,d=e.w,f=d*t+c*n-h*r,m=d*r+h*t-l*n,g=d*n+l*r-c*t,y=-l*t-c*r-h*n;return this.x=f*d+y*-l+m*-h-g*-c,this.y=m*d+y*-c+g*-l-f*-h,this.z=g*d+y*-h+f*-c-m*-l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,r=this.y,n=this.z,l=e.elements;return this.x=l[0]*t+l[4]*r+l[8]*n,this.y=l[1]*t+l[5]*r+l[9]*n,this.z=l[2]*t+l[6]*r+l[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e,t){return t!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){let r=e.x,n=e.y,l=e.z,c=t.x,h=t.y,d=t.z;return this.x=n*d-l*h,this.y=l*c-r*d,this.z=r*h-n*c,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return mO.copy(this).projectOnVector(e),this.sub(mO)}reflect(e){return this.sub(mO.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let r=this.dot(e)/t;return Math.acos(So(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){let n=Math.sin(t)*e;return this.x=n*Math.sin(r),this.y=Math.cos(t)*e,this.z=n*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=n,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,r){return r!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,r=Math.sqrt(1-B8(e,2));return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}};Te.prototype.isVector3=!0;var mO=new Te,D6=new Xl,ef=class{constructor(e=new Te(1/0,1/0,1/0),t=new Te(-1/0,-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,r=1/0,n=1/0,l=-1/0,c=-1/0,h=-1/0;for(let d=0,f=e.length;d<f;d+=3){let m=e[d],g=e[d+1],y=e[d+2];m<t&&(t=m),g<r&&(r=g),y<n&&(n=y),m>l&&(l=m),g>c&&(c=g),y>h&&(h=y)}return this.min.set(t,r,n),this.max.set(l,c,h),this}setFromBufferAttribute(e){let t=1/0,r=1/0,n=1/0,l=-1/0,c=-1/0,h=-1/0;for(let d=0,f=e.count;d<f;d++){let m=e.getX(d),g=e.getY(d),y=e.getZ(d);m<t&&(t=m),g<r&&(r=g),y<n&&(n=y),m>l&&(l=m),g>c&&(c=g),y>h&&(h=y)}return this.min.set(t,r,n),this.max.set(l,c,h),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=t1.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let r=e.geometry;if(r!==void 0)if(t&&r.attributes!=null&&r.attributes.position!==void 0){let l=r.attributes.position;for(let c=0,h=l.count;c<h;c++)t1.fromBufferAttribute(l,c).applyMatrix4(e.matrixWorld),this.expandByPoint(t1)}else r.boundingBox===null&&r.computeBoundingBox(),gO.copy(r.boundingBox),gO.applyMatrix4(e.matrixWorld),this.union(gO);let n=e.children;for(let l=0,c=n.length;l<c;l++)this.expandByObject(n[l],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,t1),t1.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(UE),a2.subVectors(this.max,UE),Aw.subVectors(e.a,UE),Cw.subVectors(e.b,UE),Pw.subVectors(e.c,UE),Hp.subVectors(Cw,Aw),$p.subVectors(Pw,Cw),i1.subVectors(Aw,Pw);let t=[0,-Hp.z,Hp.y,0,-$p.z,$p.y,0,-i1.z,i1.y,Hp.z,0,-Hp.x,$p.z,0,-$p.x,i1.z,0,-i1.x,-Hp.y,Hp.x,0,-$p.y,$p.x,0,-i1.y,i1.x,0];return!vO(t,Aw,Cw,Pw,a2)||(t=[1,0,0,0,1,0,0,0,1],!vO(t,Aw,Cw,Pw,a2))?!1:(o2.crossVectors(Hp,$p),t=[o2.x,o2.y,o2.z],vO(t,Aw,Cw,Pw,a2))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return t1.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(t1).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Df[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Df[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Df[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Df[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Df[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Df[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Df[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Df[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Df),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}};ef.prototype.isBox3=!0;var Df=[new Te,new Te,new Te,new Te,new Te,new Te,new Te,new Te],t1=new Te,gO=new ef,Aw=new Te,Cw=new Te,Pw=new Te,Hp=new Te,$p=new Te,i1=new Te,UE=new Te,a2=new Te,o2=new Te,r1=new Te;function vO(i,e,t,r,n){for(let l=0,c=i.length-3;l<=c;l+=3){r1.fromArray(i,l);let h=n.x*Math.abs(r1.x)+n.y*Math.abs(r1.y)+n.z*Math.abs(r1.z),d=e.dot(r1),f=t.dot(r1),m=r.dot(r1);if(Math.max(-Math.max(d,f,m),Math.min(d,f,m))>h)return!1}return!0}var Pre=new ef,k6=new Te,l2=new Te,yO=new Te,lE=class{constructor(e=new Te,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let r=this.center;t!==void 0?r.copy(t):Pre.setFromPoints(e).getCenter(r);let n=0;for(let l=0,c=e.length;l<c;l++)n=Math.max(n,r.distanceToSquared(e[l]));return this.radius=Math.sqrt(n),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){yO.subVectors(e,this.center);let t=yO.lengthSq();if(t>this.radius*this.radius){let r=Math.sqrt(t),n=(r-this.radius)*.5;this.center.add(yO.multiplyScalar(n/r)),this.radius+=n}return this}union(e){return this.center.equals(e.center)===!0?l2.set(0,0,1).multiplyScalar(e.radius):l2.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(k6.copy(e.center).add(l2)),this.expandByPoint(k6.copy(e.center).sub(l2)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}},kf=new Te,_O=new Te,u2=new Te,Vp=new Te,xO=new Te,c2=new Te,bO=new Te,uE=class{constructor(e=new Te,t=new Te(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,kf)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(r).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=kf.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(kf.copy(this.direction).multiplyScalar(t).add(this.origin),kf.distanceToSquared(e))}distanceSqToSegment(e,t,r,n){_O.copy(e).add(t).multiplyScalar(.5),u2.copy(t).sub(e).normalize(),Vp.copy(this.origin).sub(_O);let l=e.distanceTo(t)*.5,c=-this.direction.dot(u2),h=Vp.dot(this.direction),d=-Vp.dot(u2),f=Vp.lengthSq(),m=Math.abs(1-c*c),g,y,_,b;if(m>0)if(g=c*d-h,y=c*h-d,b=l*m,g>=0)if(y>=-b)if(y<=b){let S=1/m;g*=S,y*=S,_=g*(g+c*y+2*h)+y*(c*g+y+2*d)+f}else y=l,g=Math.max(0,-(c*y+h)),_=-g*g+y*(y+2*d)+f;else y=-l,g=Math.max(0,-(c*y+h)),_=-g*g+y*(y+2*d)+f;else y<=-b?(g=Math.max(0,-(-c*l+h)),y=g>0?-l:Math.min(Math.max(-l,-d),l),_=-g*g+y*(y+2*d)+f):y<=b?(g=0,y=Math.min(Math.max(-l,-d),l),_=y*(y+2*d)+f):(g=Math.max(0,-(c*l+h)),y=g>0?l:Math.min(Math.max(-l,-d),l),_=-g*g+y*(y+2*d)+f);else y=c>0?-l:l,g=Math.max(0,-(c*y+h)),_=-g*g+y*(y+2*d)+f;return r&&r.copy(this.direction).multiplyScalar(g).add(this.origin),n&&n.copy(u2).multiplyScalar(y).add(_O),_}intersectSphere(e,t){kf.subVectors(e.center,this.origin);let r=kf.dot(this.direction),n=kf.dot(kf)-r*r,l=e.radius*e.radius;if(n>l)return null;let c=Math.sqrt(l-n),h=r-c,d=r+c;return h<0&&d<0?null:h<0?this.at(d,t):this.at(h,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;let r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){let r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,n,l,c,h,d,f=1/this.direction.x,m=1/this.direction.y,g=1/this.direction.z,y=this.origin;return f>=0?(r=(e.min.x-y.x)*f,n=(e.max.x-y.x)*f):(r=(e.max.x-y.x)*f,n=(e.min.x-y.x)*f),m>=0?(l=(e.min.y-y.y)*m,c=(e.max.y-y.y)*m):(l=(e.max.y-y.y)*m,c=(e.min.y-y.y)*m),r>c||l>n||((l>r||r!==r)&&(r=l),(c<n||n!==n)&&(n=c),g>=0?(h=(e.min.z-y.z)*g,d=(e.max.z-y.z)*g):(h=(e.max.z-y.z)*g,d=(e.min.z-y.z)*g),r>d||h>n)||((h>r||r!==r)&&(r=h),(d<n||n!==n)&&(n=d),n<0)?null:this.at(r>=0?r:n,t)}intersectsBox(e){return this.intersectBox(e,kf)!==null}intersectTriangle(e,t,r,n,l){xO.subVectors(t,e),c2.subVectors(r,e),bO.crossVectors(xO,c2);let c=this.direction.dot(bO),h;if(c>0){if(n)return null;h=1}else if(c<0)h=-1,c=-c;else return null;Vp.subVectors(this.origin,e);let d=h*this.direction.dot(c2.crossVectors(Vp,c2));if(d<0)return null;let f=h*this.direction.dot(xO.cross(Vp));if(f<0||d+f>c)return null;let m=-h*Vp.dot(bO);return m<0?null:this.at(m/c,l)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},Bi=class{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,r,n,l,c,h,d,f,m,g,y,_,b,S,E){let T=this.elements;return T[0]=e,T[4]=t,T[8]=r,T[12]=n,T[1]=l,T[5]=c,T[9]=h,T[13]=d,T[2]=f,T[6]=m,T[10]=g,T[14]=y,T[3]=_,T[7]=b,T[11]=S,T[15]=E,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Bi().fromArray(this.elements)}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){let t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,r=e.elements,n=1/Rw.setFromMatrixColumn(e,0).length(),l=1/Rw.setFromMatrixColumn(e,1).length(),c=1/Rw.setFromMatrixColumn(e,2).length();return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=0,t[4]=r[4]*l,t[5]=r[5]*l,t[6]=r[6]*l,t[7]=0,t[8]=r[8]*c,t[9]=r[9]*c,t[10]=r[10]*c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");let t=this.elements,r=e.x,n=e.y,l=e.z,c=Math.cos(r),h=Math.sin(r),d=Math.cos(n),f=Math.sin(n),m=Math.cos(l),g=Math.sin(l);if(e.order==="XYZ"){let y=c*m,_=c*g,b=h*m,S=h*g;t[0]=d*m,t[4]=-d*g,t[8]=f,t[1]=_+b*f,t[5]=y-S*f,t[9]=-h*d,t[2]=S-y*f,t[6]=b+_*f,t[10]=c*d}else if(e.order==="YXZ"){let y=d*m,_=d*g,b=f*m,S=f*g;t[0]=y+S*h,t[4]=b*h-_,t[8]=c*f,t[1]=c*g,t[5]=c*m,t[9]=-h,t[2]=_*h-b,t[6]=S+y*h,t[10]=c*d}else if(e.order==="ZXY"){let y=d*m,_=d*g,b=f*m,S=f*g;t[0]=y-S*h,t[4]=-c*g,t[8]=b+_*h,t[1]=_+b*h,t[5]=c*m,t[9]=S-y*h,t[2]=-c*f,t[6]=h,t[10]=c*d}else if(e.order==="ZYX"){let y=c*m,_=c*g,b=h*m,S=h*g;t[0]=d*m,t[4]=b*f-_,t[8]=y*f+S,t[1]=d*g,t[5]=S*f+y,t[9]=_*f-b,t[2]=-f,t[6]=h*d,t[10]=c*d}else if(e.order==="YZX"){let y=c*d,_=c*f,b=h*d,S=h*f;t[0]=d*m,t[4]=S-y*g,t[8]=b*g+_,t[1]=g,t[5]=c*m,t[9]=-h*m,t[2]=-f*m,t[6]=_*g+b,t[10]=y-S*g}else if(e.order==="XZY"){let y=c*d,_=c*f,b=h*d,S=h*f;t[0]=d*m,t[4]=-g,t[8]=f*m,t[1]=y*g+S,t[5]=c*m,t[9]=_*g-b,t[2]=b*g-_,t[6]=h*m,t[10]=S*g+y}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Rre,e,Ire)}lookAt(e,t,r){let n=this.elements;return bu.subVectors(e,t),bu.lengthSq()===0&&(bu.z=1),bu.normalize(),Wp.crossVectors(r,bu),Wp.lengthSq()===0&&(Math.abs(r.z)===1?bu.x+=1e-4:bu.z+=1e-4,bu.normalize(),Wp.crossVectors(r,bu)),Wp.normalize(),h2.crossVectors(bu,Wp),n[0]=Wp.x,n[4]=h2.x,n[8]=bu.x,n[1]=Wp.y,n[5]=h2.y,n[9]=bu.y,n[2]=Wp.z,n[6]=h2.z,n[10]=bu.z,this}multiply(e,t){return t!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,n=t.elements,l=this.elements,c=r[0],h=r[4],d=r[8],f=r[12],m=r[1],g=r[5],y=r[9],_=r[13],b=r[2],S=r[6],E=r[10],T=r[14],A=r[3],P=r[7],O=r[11],R=r[15],D=n[0],L=n[4],N=n[8],U=n[12],F=n[1],z=n[5],G=n[9],J=n[13],Z=n[2],q=n[6],$=n[10],H=n[14],X=n[3],re=n[7],ae=n[11],he=n[15];return l[0]=c*D+h*F+d*Z+f*X,l[4]=c*L+h*z+d*q+f*re,l[8]=c*N+h*G+d*$+f*ae,l[12]=c*U+h*J+d*H+f*he,l[1]=m*D+g*F+y*Z+_*X,l[5]=m*L+g*z+y*q+_*re,l[9]=m*N+g*G+y*$+_*ae,l[13]=m*U+g*J+y*H+_*he,l[2]=b*D+S*F+E*Z+T*X,l[6]=b*L+S*z+E*q+T*re,l[10]=b*N+S*G+E*$+T*ae,l[14]=b*U+S*J+E*H+T*he,l[3]=A*D+P*F+O*Z+R*X,l[7]=A*L+P*z+O*q+R*re,l[11]=A*N+P*G+O*$+R*ae,l[15]=A*U+P*J+O*H+R*he,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[4],n=e[8],l=e[12],c=e[1],h=e[5],d=e[9],f=e[13],m=e[2],g=e[6],y=e[10],_=e[14],b=e[3],S=e[7],E=e[11],T=e[15];return b*(+l*d*g-n*f*g-l*h*y+r*f*y+n*h*_-r*d*_)+S*(+t*d*_-t*f*y+l*c*y-n*c*_+n*f*m-l*d*m)+E*(+t*f*g-t*h*_-l*c*g+r*c*_+l*h*m-r*f*m)+T*(-n*h*m-t*d*g+t*h*y+n*c*g-r*c*y+r*d*m)}transpose(){let e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){let n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=r),this}invert(){let e=this.elements,t=e[0],r=e[1],n=e[2],l=e[3],c=e[4],h=e[5],d=e[6],f=e[7],m=e[8],g=e[9],y=e[10],_=e[11],b=e[12],S=e[13],E=e[14],T=e[15],A=g*E*f-S*y*f+S*d*_-h*E*_-g*d*T+h*y*T,P=b*y*f-m*E*f-b*d*_+c*E*_+m*d*T-c*y*T,O=m*S*f-b*g*f+b*h*_-c*S*_-m*h*T+c*g*T,R=b*g*d-m*S*d-b*h*y+c*S*y+m*h*E-c*g*E,D=t*A+r*P+n*O+l*R;if(D===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let L=1/D;return e[0]=A*L,e[1]=(S*y*l-g*E*l-S*n*_+r*E*_+g*n*T-r*y*T)*L,e[2]=(h*E*l-S*d*l+S*n*f-r*E*f-h*n*T+r*d*T)*L,e[3]=(g*d*l-h*y*l-g*n*f+r*y*f+h*n*_-r*d*_)*L,e[4]=P*L,e[5]=(m*E*l-b*y*l+b*n*_-t*E*_-m*n*T+t*y*T)*L,e[6]=(b*d*l-c*E*l-b*n*f+t*E*f+c*n*T-t*d*T)*L,e[7]=(c*y*l-m*d*l+m*n*f-t*y*f-c*n*_+t*d*_)*L,e[8]=O*L,e[9]=(b*g*l-m*S*l-b*r*_+t*S*_+m*r*T-t*g*T)*L,e[10]=(c*S*l-b*h*l+b*r*f-t*S*f-c*r*T+t*h*T)*L,e[11]=(m*h*l-c*g*l-m*r*f+t*g*f+c*r*_-t*h*_)*L,e[12]=R*L,e[13]=(m*S*n-b*g*n+b*r*y-t*S*y-m*r*E+t*g*E)*L,e[14]=(b*h*n-c*S*n-b*r*d+t*S*d+c*r*E-t*h*E)*L,e[15]=(c*g*n-m*h*n+m*r*d-t*g*d-c*r*y+t*h*y)*L,this}scale(e){let t=this.elements,r=e.x,n=e.y,l=e.z;return t[0]*=r,t[4]*=n,t[8]*=l,t[1]*=r,t[5]*=n,t[9]*=l,t[2]*=r,t[6]*=n,t[10]*=l,t[3]*=r,t[7]*=n,t[11]*=l,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,n))}makeTranslation(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let r=Math.cos(t),n=Math.sin(t),l=1-r,c=e.x,h=e.y,d=e.z,f=l*c,m=l*h;return this.set(f*c+r,f*h-n*d,f*d+n*h,0,f*h+n*d,m*h+r,m*d-n*c,0,f*d-n*h,m*d+n*c,l*d*d+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,n,l,c){return this.set(1,r,l,0,e,1,c,0,t,n,1,0,0,0,0,1),this}compose(e,t,r){let n=this.elements,l=t._x,c=t._y,h=t._z,d=t._w,f=l+l,m=c+c,g=h+h,y=l*f,_=l*m,b=l*g,S=c*m,E=c*g,T=h*g,A=d*f,P=d*m,O=d*g,R=r.x,D=r.y,L=r.z;return n[0]=(1-(S+T))*R,n[1]=(_+O)*R,n[2]=(b-P)*R,n[3]=0,n[4]=(_-O)*D,n[5]=(1-(y+T))*D,n[6]=(E+A)*D,n[7]=0,n[8]=(b+P)*L,n[9]=(E-A)*L,n[10]=(1-(y+S))*L,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,t,r){let n=this.elements,l=Rw.set(n[0],n[1],n[2]).length(),c=Rw.set(n[4],n[5],n[6]).length(),h=Rw.set(n[8],n[9],n[10]).length();this.determinant()<0&&(l=-l),e.x=n[12],e.y=n[13],e.z=n[14],xd.copy(this);let d=1/l,f=1/c,m=1/h;return xd.elements[0]*=d,xd.elements[1]*=d,xd.elements[2]*=d,xd.elements[4]*=f,xd.elements[5]*=f,xd.elements[6]*=f,xd.elements[8]*=m,xd.elements[9]*=m,xd.elements[10]*=m,t.setFromRotationMatrix(xd),r.x=l,r.y=c,r.z=h,this}makePerspective(e,t,r,n,l,c){c===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");let h=this.elements,d=2*l/(t-e),f=2*l/(r-n),m=(t+e)/(t-e),g=(r+n)/(r-n),y=-(c+l)/(c-l),_=-2*c*l/(c-l);return h[0]=d,h[4]=0,h[8]=m,h[12]=0,h[1]=0,h[5]=f,h[9]=g,h[13]=0,h[2]=0,h[6]=0,h[10]=y,h[14]=_,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this}makeOrthographic(e,t,r,n,l,c){let h=this.elements,d=1/(t-e),f=1/(r-n),m=1/(c-l),g=(t+e)*d,y=(r+n)*f,_=(c+l)*m;return h[0]=2*d,h[4]=0,h[8]=0,h[12]=-g,h[1]=0,h[5]=2*f,h[9]=0,h[13]=-y,h[2]=0,h[6]=0,h[10]=-2*m,h[14]=-_,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this}equals(e){let t=this.elements,r=e.elements;for(let n=0;n<16;n++)if(t[n]!==r[n])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){let r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}};Bi.prototype.isMatrix4=!0;var Rw=new Te,xd=new Bi,Rre=new Te(0,0,0),Ire=new Te(1,1,1),Wp=new Te,h2=new Te,bu=new Te,F6=new Bi,z6=new Xl,cE=class{constructor(e=0,t=0,r=0,n=cE.DefaultOrder){this._x=e,this._y=t,this._z=r,this._order=n}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,n=this._order){return this._x=e,this._y=t,this._z=r,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){let n=e.elements,l=n[0],c=n[4],h=n[8],d=n[1],f=n[5],m=n[9],g=n[2],y=n[6],_=n[10];switch(t){case"XYZ":this._y=Math.asin(So(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-m,_),this._z=Math.atan2(-c,l)):(this._x=Math.atan2(y,f),this._z=0);break;case"YXZ":this._x=Math.asin(-So(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(h,_),this._z=Math.atan2(d,f)):(this._y=Math.atan2(-g,l),this._z=0);break;case"ZXY":this._x=Math.asin(So(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(-g,_),this._z=Math.atan2(-c,f)):(this._y=0,this._z=Math.atan2(d,l));break;case"ZYX":this._y=Math.asin(-So(g,-1,1)),Math.abs(g)<.9999999?(this._x=Math.atan2(y,_),this._z=Math.atan2(d,l)):(this._x=0,this._z=Math.atan2(-c,f));break;case"YZX":this._z=Math.asin(So(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(-m,f),this._y=Math.atan2(-g,l)):(this._x=0,this._y=Math.atan2(h,_));break;case"XZY":this._z=Math.asin(-So(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(y,f),this._y=Math.atan2(h,l)):(this._x=Math.atan2(-m,_),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return F6.makeRotationFromQuaternion(e),this.setFromRotationMatrix(F6,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return z6.setFromEuler(this),this.setFromQuaternion(z6,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}};cE.prototype.isEuler=!0;cE.DefaultOrder="XYZ";cE.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];var Q8=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},Lre=0,B6=new Te,Iw=new Xl,Ff=new Bi,d2=new Te,HE=new Te,Ore=new Te,Nre=new Xl,U6=new Te(1,0,0),H6=new Te(0,1,0),$6=new Te(0,0,1),Dre={type:"added"},V6={type:"removed"},Sn=class extends yw{constructor(){super(),Object.defineProperty(this,"id",{value:Lre++}),this.uuid=xf(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Sn.DefaultUp.clone();let e=new Te,t=new cE,r=new Xl,n=new Te(1,1,1);function l(){r.setFromEuler(t,!1)}function c(){t.setFromQuaternion(r,void 0,!1)}t._onChange(l),r._onChange(c),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new Bi},normalMatrix:{value:new io}}),this.matrix=new Bi,this.matrixWorld=new Bi,this.matrixAutoUpdate=Sn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Q8,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Iw.setFromAxisAngle(e,t),this.quaternion.multiply(Iw),this}rotateOnWorldAxis(e,t){return Iw.setFromAxisAngle(e,t),this.quaternion.premultiply(Iw),this}rotateX(e){return this.rotateOnAxis(U6,e)}rotateY(e){return this.rotateOnAxis(H6,e)}rotateZ(e){return this.rotateOnAxis($6,e)}translateOnAxis(e,t){return B6.copy(e).applyQuaternion(this.quaternion),this.position.add(B6.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(U6,e)}translateY(e){return this.translateOnAxis(H6,e)}translateZ(e){return this.translateOnAxis($6,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(Ff.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?d2.copy(e):d2.set(e,t,r);let n=this.parent;this.updateWorldMatrix(!0,!1),HE.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ff.lookAt(HE,d2,this.up):Ff.lookAt(d2,HE,this.up),this.quaternion.setFromRotationMatrix(Ff),n&&(Ff.extractRotation(n.matrixWorld),Iw.setFromRotationMatrix(Ff),this.quaternion.premultiply(Iw.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Dre)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}let t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(V6)),this}removeFromParent(){let e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){let t=this.children[e];t.parent=null,t.dispatchEvent(V6)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),Ff.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Ff.multiply(e.parent.matrixWorld)),e.applyMatrix4(Ff),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,n=this.children.length;r<n;r++){let l=this.children[r].getObjectByProperty(e,t);if(l!==void 0)return l}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(HE,e,Ore),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(HE,Nre,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);let t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);let t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverseVisible(e)}traverseAncestors(e){let t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);let t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].updateMatrixWorld(e)}updateWorldMatrix(e,t){let r=this.parent;if(e===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){let n=this.children;for(let l=0,c=n.length;l<c;l++)n[l].updateWorldMatrix(!1,!0)}}toJSON(e){let t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});let n={};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.castShadow===!0&&(n.castShadow=!0),this.receiveShadow===!0&&(n.receiveShadow=!0),this.visible===!1&&(n.visible=!1),this.frustumCulled===!1&&(n.frustumCulled=!1),this.renderOrder!==0&&(n.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(n.instanceColor=this.instanceColor.toJSON()));function l(h,d){return h[d.uuid]===void 0&&(h[d.uuid]=d.toJSON(e)),d.uuid}if(this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(n.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=l(e.geometries,this.geometry);let h=this.geometry.parameters;if(h!==void 0&&h.shapes!==void 0){let d=h.shapes;if(Array.isArray(d))for(let f=0,m=d.length;f<m;f++){let g=d[f];l(e.shapes,g)}else l(e.shapes,d)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(l(e.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let h=[];for(let d=0,f=this.material.length;d<f;d++)h.push(l(e.materials,this.material[d]));n.material=h}else n.material=l(e.materials,this.material);if(this.children.length>0){n.children=[];for(let h=0;h<this.children.length;h++)n.children.push(this.children[h].toJSON(e).object)}if(this.animations.length>0){n.animations=[];for(let h=0;h<this.animations.length;h++){let d=this.animations[h];n.animations.push(l(e.animations,d))}}if(t){let h=c(e.geometries),d=c(e.materials),f=c(e.textures),m=c(e.images),g=c(e.shapes),y=c(e.skeletons),_=c(e.animations),b=c(e.nodes);h.length>0&&(r.geometries=h),d.length>0&&(r.materials=d),f.length>0&&(r.textures=f),m.length>0&&(r.images=m),g.length>0&&(r.shapes=g),y.length>0&&(r.skeletons=y),_.length>0&&(r.animations=_),b.length>0&&(r.nodes=b)}return r.object=n,r;function c(h){let d=[];for(let f in h){let m=h[f];delete m.metadata,d.push(m)}return d}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){let n=e.children[r];this.add(n.clone())}return this}};Sn.DefaultUp=new Te(0,1,0);Sn.DefaultMatrixAutoUpdate=!0;Sn.prototype.isObject3D=!0;var bd=new Te,zf=new Te,wO=new Te,Bf=new Te,Lw=new Te,Ow=new Te,W6=new Te,SO=new Te,MO=new Te,EO=new Te,Xa=class{constructor(e=new Te,t=new Te,r=new Te){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,n){n.subVectors(r,t),bd.subVectors(e,t),n.cross(bd);let l=n.lengthSq();return l>0?n.multiplyScalar(1/Math.sqrt(l)):n.set(0,0,0)}static getBarycoord(e,t,r,n,l){bd.subVectors(n,t),zf.subVectors(r,t),wO.subVectors(e,t);let c=bd.dot(bd),h=bd.dot(zf),d=bd.dot(wO),f=zf.dot(zf),m=zf.dot(wO),g=c*f-h*h;if(g===0)return l.set(-2,-1,-1);let y=1/g,_=(f*d-h*m)*y,b=(c*m-h*d)*y;return l.set(1-_-b,b,_)}static containsPoint(e,t,r,n){return this.getBarycoord(e,t,r,n,Bf),Bf.x>=0&&Bf.y>=0&&Bf.x+Bf.y<=1}static getUV(e,t,r,n,l,c,h,d){return this.getBarycoord(e,t,r,n,Bf),d.set(0,0),d.addScaledVector(l,Bf.x),d.addScaledVector(c,Bf.y),d.addScaledVector(h,Bf.z),d}static isFrontFacing(e,t,r,n){return bd.subVectors(r,t),zf.subVectors(e,t),bd.cross(zf).dot(n)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,n){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[n]),this}setFromAttributeAndIndices(e,t,r,n){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return bd.subVectors(this.c,this.b),zf.subVectors(this.a,this.b),bd.cross(zf).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Xa.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Xa.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,r,n,l){return Xa.getUV(e,this.a,this.b,this.c,t,r,n,l)}containsPoint(e){return Xa.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Xa.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let r=this.a,n=this.b,l=this.c,c,h;Lw.subVectors(n,r),Ow.subVectors(l,r),SO.subVectors(e,r);let d=Lw.dot(SO),f=Ow.dot(SO);if(d<=0&&f<=0)return t.copy(r);MO.subVectors(e,n);let m=Lw.dot(MO),g=Ow.dot(MO);if(m>=0&&g<=m)return t.copy(n);let y=d*g-m*f;if(y<=0&&d>=0&&m<=0)return c=d/(d-m),t.copy(r).addScaledVector(Lw,c);EO.subVectors(e,l);let _=Lw.dot(EO),b=Ow.dot(EO);if(b>=0&&_<=b)return t.copy(l);let S=_*f-d*b;if(S<=0&&f>=0&&b<=0)return h=f/(f-b),t.copy(r).addScaledVector(Ow,h);let E=m*b-_*g;if(E<=0&&g-m>=0&&_-b>=0)return W6.subVectors(l,n),h=(g-m)/(g-m+(_-b)),t.copy(n).addScaledVector(W6,h);let T=1/(E+S+y);return c=S*T,h=y*T,t.copy(r).addScaledVector(Lw,c).addScaledVector(Ow,h)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},kre=0,za=class extends yw{constructor(){super(),Object.defineProperty(this,"id",{value:kre++}),this.uuid=xf(),this.name="",this.type="Material",this.fog=!0,this.blending=fM,this.side=TA,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=j8,this.blendDst=G8,this.blendEquation=NS,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Yk,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Sre,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=uO,this.stencilZFail=uO,this.stencilZPass=uO,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let t in e){let r=e[t];if(r===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if(t==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=r===W8;continue}let n=this[t];if(n===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}n&&n.isColor?n.set(r):n&&n.isVector3&&r&&r.isVector3?n.copy(r):this[t]=r}}toJSON(e){let t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});let r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==fM&&(r.blending=this.blending),this.side!==TA&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(r.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=this.flatShading),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(r.userData=this.userData);function n(l){let c=[];for(let h in l){let d=l[h];delete d.metadata,c.push(d)}return c}if(t){let l=n(e.textures),c=n(e.images);l.length>0&&(r.textures=l),c.length>0&&(r.images=c)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,r=null;if(t!==null){let n=t.length;r=new Array(n);for(let l=0;l!==n;++l)r[l]=t[l].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}};za.prototype.isMaterial=!0;za.fromType=function(){return null};var qI=class extends za{constructor(e){super(),this.type="MeshBasicMaterial",this.color=new Ei(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=VI,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}};qI.prototype.isMeshBasicMaterial=!0;var Ns=new Te,f2=new At,Da=class{constructor(e,t,r){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r===!0,this.usage=CA,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let n=0,l=this.itemSize;n<l;n++)this.array[e+n]=t.array[r+n];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){let t=this.array,r=0;for(let n=0,l=e.length;n<l;n++){let c=e[n];c===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),c=new Ei),t[r++]=c.r,t[r++]=c.g,t[r++]=c.b}return this}copyVector2sArray(e){let t=this.array,r=0;for(let n=0,l=e.length;n<l;n++){let c=e[n];c===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),c=new At),t[r++]=c.x,t[r++]=c.y}return this}copyVector3sArray(e){let t=this.array,r=0;for(let n=0,l=e.length;n<l;n++){let c=e[n];c===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),c=new Te),t[r++]=c.x,t[r++]=c.y,t[r++]=c.z}return this}copyVector4sArray(e){let t=this.array,r=0;for(let n=0,l=e.length;n<l;n++){let c=e[n];c===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),c=new wn),t[r++]=c.x,t[r++]=c.y,t[r++]=c.z,t[r++]=c.w}return this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)f2.fromBufferAttribute(this,t),f2.applyMatrix3(e),this.setXY(t,f2.x,f2.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)Ns.fromBufferAttribute(this,t),Ns.applyMatrix3(e),this.setXYZ(t,Ns.x,Ns.y,Ns.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)Ns.fromBufferAttribute(this,t),Ns.applyMatrix4(e),this.setXYZ(t,Ns.x,Ns.y,Ns.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Ns.fromBufferAttribute(this,t),Ns.applyNormalMatrix(e),this.setXYZ(t,Ns.x,Ns.y,Ns.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Ns.fromBufferAttribute(this,t),Ns.transformDirection(e),this.setXYZ(t,Ns.x,Ns.y,Ns.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this}setXYZW(e,t,r,n,l){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this.array[e+3]=l,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==CA&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}};Da.prototype.isBufferAttribute=!0;var e7=class extends Da{constructor(e,t,r){super(new Uint16Array(e),t,r)}},t7=class extends Da{constructor(i,e,t){super(new Uint32Array(i),e,t)}},Fre=class extends Da{constructor(i,e,t){super(new Uint16Array(i),e,t)}};Fre.prototype.isFloat16BufferAttribute=!0;var Ja=class extends Da{constructor(e,t,r){super(new Float32Array(e),t,r)}},zre=0,Vu=new Bi,TO=new Sn,Nw=new Te,wu=new ef,$E=new ef,Ha=new Te,vs=class extends yw{constructor(){super(),Object.defineProperty(this,"id",{value:zre++}),this.uuid=xf(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(J8(e)?t7:e7)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);let r=this.attributes.normal;if(r!==void 0){let l=new io().getNormalMatrix(e);r.applyNormalMatrix(l),r.needsUpdate=!0}let n=this.attributes.tangent;return n!==void 0&&(n.transformDirection(e),n.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Vu.makeRotationFromQuaternion(e),this.applyMatrix4(Vu),this}rotateX(e){return Vu.makeRotationX(e),this.applyMatrix4(Vu),this}rotateY(e){return Vu.makeRotationY(e),this.applyMatrix4(Vu),this}rotateZ(e){return Vu.makeRotationZ(e),this.applyMatrix4(Vu),this}translate(e,t,r){return Vu.makeTranslation(e,t,r),this.applyMatrix4(Vu),this}scale(e,t,r){return Vu.makeScale(e,t,r),this.applyMatrix4(Vu),this}lookAt(e){return TO.lookAt(e),TO.updateMatrix(),this.applyMatrix4(TO.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Nw).negate(),this.translate(Nw.x,Nw.y,Nw.z),this}setFromPoints(e){let t=[];for(let r=0,n=e.length;r<n;r++){let l=e[r];t.push(l.x,l.y,l.z||0)}return this.setAttribute("position",new Ja(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ef);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Te(-1/0,-1/0,-1/0),new Te(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,n=t.length;r<n;r++){let l=t[r];wu.setFromBufferAttribute(l),this.morphTargetsRelative?(Ha.addVectors(this.boundingBox.min,wu.min),this.boundingBox.expandByPoint(Ha),Ha.addVectors(this.boundingBox.max,wu.max),this.boundingBox.expandByPoint(Ha)):(this.boundingBox.expandByPoint(wu.min),this.boundingBox.expandByPoint(wu.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new lE);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Te,1/0);return}if(e){let r=this.boundingSphere.center;if(wu.setFromBufferAttribute(e),t)for(let l=0,c=t.length;l<c;l++){let h=t[l];$E.setFromBufferAttribute(h),this.morphTargetsRelative?(Ha.addVectors(wu.min,$E.min),wu.expandByPoint(Ha),Ha.addVectors(wu.max,$E.max),wu.expandByPoint(Ha)):(wu.expandByPoint($E.min),wu.expandByPoint($E.max))}wu.getCenter(r);let n=0;for(let l=0,c=e.count;l<c;l++)Ha.fromBufferAttribute(e,l),n=Math.max(n,r.distanceToSquared(Ha));if(t)for(let l=0,c=t.length;l<c;l++){let h=t[l],d=this.morphTargetsRelative;for(let f=0,m=h.count;f<m;f++)Ha.fromBufferAttribute(h,f),d&&(Nw.fromBufferAttribute(e,f),Ha.add(Nw)),n=Math.max(n,r.distanceToSquared(Ha))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let r=e.array,n=t.position.array,l=t.normal.array,c=t.uv.array,h=n.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Da(new Float32Array(4*h),4));let d=this.getAttribute("tangent").array,f=[],m=[];for(let F=0;F<h;F++)f[F]=new Te,m[F]=new Te;let g=new Te,y=new Te,_=new Te,b=new At,S=new At,E=new At,T=new Te,A=new Te;function P(F,z,G){g.fromArray(n,F*3),y.fromArray(n,z*3),_.fromArray(n,G*3),b.fromArray(c,F*2),S.fromArray(c,z*2),E.fromArray(c,G*2),y.sub(g),_.sub(g),S.sub(b),E.sub(b);let J=1/(S.x*E.y-E.x*S.y);!isFinite(J)||(T.copy(y).multiplyScalar(E.y).addScaledVector(_,-S.y).multiplyScalar(J),A.copy(_).multiplyScalar(S.x).addScaledVector(y,-E.x).multiplyScalar(J),f[F].add(T),f[z].add(T),f[G].add(T),m[F].add(A),m[z].add(A),m[G].add(A))}let O=this.groups;O.length===0&&(O=[{start:0,count:r.length}]);for(let F=0,z=O.length;F<z;++F){let G=O[F],J=G.start,Z=G.count;for(let q=J,$=J+Z;q<$;q+=3)P(r[q+0],r[q+1],r[q+2])}let R=new Te,D=new Te,L=new Te,N=new Te;function U(F){L.fromArray(l,F*3),N.copy(L);let z=f[F];R.copy(z),R.sub(L.multiplyScalar(L.dot(z))).normalize(),D.crossVectors(N,z);let G=D.dot(m[F])<0?-1:1;d[F*4]=R.x,d[F*4+1]=R.y,d[F*4+2]=R.z,d[F*4+3]=G}for(let F=0,z=O.length;F<z;++F){let G=O[F],J=G.start,Z=G.count;for(let q=J,$=J+Z;q<$;q+=3)U(r[q+0]),U(r[q+1]),U(r[q+2])}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new Da(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let y=0,_=r.count;y<_;y++)r.setXYZ(y,0,0,0);let n=new Te,l=new Te,c=new Te,h=new Te,d=new Te,f=new Te,m=new Te,g=new Te;if(e)for(let y=0,_=e.count;y<_;y+=3){let b=e.getX(y+0),S=e.getX(y+1),E=e.getX(y+2);n.fromBufferAttribute(t,b),l.fromBufferAttribute(t,S),c.fromBufferAttribute(t,E),m.subVectors(c,l),g.subVectors(n,l),m.cross(g),h.fromBufferAttribute(r,b),d.fromBufferAttribute(r,S),f.fromBufferAttribute(r,E),h.add(m),d.add(m),f.add(m),r.setXYZ(b,h.x,h.y,h.z),r.setXYZ(S,d.x,d.y,d.z),r.setXYZ(E,f.x,f.y,f.z)}else for(let y=0,_=t.count;y<_;y+=3)n.fromBufferAttribute(t,y+0),l.fromBufferAttribute(t,y+1),c.fromBufferAttribute(t,y+2),m.subVectors(c,l),g.subVectors(n,l),m.cross(g),r.setXYZ(y+0,m.x,m.y,m.z),r.setXYZ(y+1,m.x,m.y,m.z),r.setXYZ(y+2,m.x,m.y,m.z);this.normalizeNormals(),r.needsUpdate=!0}}merge(e,t){if(!(e&&e.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);return}t===void 0&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));let r=this.attributes;for(let n in r){if(e.attributes[n]===void 0)continue;let l=r[n].array,c=e.attributes[n],h=c.array,d=c.itemSize*t,f=Math.min(h.length,l.length-d);for(let m=0,g=d;m<f;m++,g++)l[g]=h[m]}return this}normalizeNormals(){let e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)Ha.fromBufferAttribute(e,t),Ha.normalize(),e.setXYZ(t,Ha.x,Ha.y,Ha.z)}toNonIndexed(){function e(h,d){let f=h.array,m=h.itemSize,g=h.normalized,y=new f.constructor(d.length*m),_=0,b=0;for(let S=0,E=d.length;S<E;S++){h.isInterleavedBufferAttribute?_=d[S]*h.data.stride+h.offset:_=d[S]*m;for(let T=0;T<m;T++)y[b++]=f[_++]}return new Da(y,m,g)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new vs,r=this.index.array,n=this.attributes;for(let h in n){let d=n[h],f=e(d,r);t.setAttribute(h,f)}let l=this.morphAttributes;for(let h in l){let d=[],f=l[h];for(let m=0,g=f.length;m<g;m++){let y=f[m],_=e(y,r);d.push(_)}t.morphAttributes[h]=d}t.morphTargetsRelative=this.morphTargetsRelative;let c=this.groups;for(let h=0,d=c.length;h<d;h++){let f=c[h];t.addGroup(f.start,f.count,f.materialIndex)}return t}toJSON(){let e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let d=this.parameters;for(let f in d)d[f]!==void 0&&(e[f]=d[f]);return e}e.data={attributes:{}};let t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let r=this.attributes;for(let d in r){let f=r[d];e.data.attributes[d]=f.toJSON(e.data)}let n={},l=!1;for(let d in this.morphAttributes){let f=this.morphAttributes[d],m=[];for(let g=0,y=f.length;g<y;g++){let _=f[g];m.push(_.toJSON(e.data))}m.length>0&&(n[d]=m,l=!0)}l&&(e.data.morphAttributes=n,e.data.morphTargetsRelative=this.morphTargetsRelative);let c=this.groups;c.length>0&&(e.data.groups=JSON.parse(JSON.stringify(c)));let h=this.boundingSphere;return h!==null&&(e.data.boundingSphere={center:h.center.toArray(),radius:h.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let r=e.index;r!==null&&this.setIndex(r.clone(t));let n=e.attributes;for(let f in n){let m=n[f];this.setAttribute(f,m.clone(t))}let l=e.morphAttributes;for(let f in l){let m=[],g=l[f];for(let y=0,_=g.length;y<_;y++)m.push(g[y].clone(t));this.morphAttributes[f]=m}this.morphTargetsRelative=e.morphTargetsRelative;let c=e.groups;for(let f=0,m=c.length;f<m;f++){let g=c[f];this.addGroup(g.start,g.count,g.materialIndex)}let h=e.boundingBox;h!==null&&(this.boundingBox=h.clone());let d=e.boundingSphere;return d!==null&&(this.boundingSphere=d.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}};vs.prototype.isBufferGeometry=!0;var j6=new Bi,Dw=new uE,AO=new lE,jp=new Te,Gp=new Te,qp=new Te,CO=new Te,PO=new Te,RO=new Te,p2=new Te,m2=new Te,g2=new Te,v2=new At,y2=new At,_2=new At,IO=new Te,x2=new Te,cu=class extends Sn{constructor(e=new vs,t=new qI){super(),this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry;if(e.isBufferGeometry){let t=e.morphAttributes,r=Object.keys(t);if(r.length>0){let n=t[r[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,c=n.length;l<c;l++){let h=n[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[h]=l}}}}else{let t=e.morphTargets;t!==void 0&&t.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(e,t){let r=this.geometry,n=this.material,l=this.matrixWorld;if(n===void 0||(r.boundingSphere===null&&r.computeBoundingSphere(),AO.copy(r.boundingSphere),AO.applyMatrix4(l),e.ray.intersectsSphere(AO)===!1)||(j6.copy(l).invert(),Dw.copy(e.ray).applyMatrix4(j6),r.boundingBox!==null&&Dw.intersectsBox(r.boundingBox)===!1))return;let c;if(r.isBufferGeometry){let h=r.index,d=r.attributes.position,f=r.morphAttributes.position,m=r.morphTargetsRelative,g=r.attributes.uv,y=r.attributes.uv2,_=r.groups,b=r.drawRange;if(h!==null)if(Array.isArray(n))for(let S=0,E=_.length;S<E;S++){let T=_[S],A=n[T.materialIndex],P=Math.max(T.start,b.start),O=Math.min(h.count,Math.min(T.start+T.count,b.start+b.count));for(let R=P,D=O;R<D;R+=3){let L=h.getX(R),N=h.getX(R+1),U=h.getX(R+2);c=b2(this,A,e,Dw,d,f,m,g,y,L,N,U),c&&(c.faceIndex=Math.floor(R/3),c.face.materialIndex=T.materialIndex,t.push(c))}}else{let S=Math.max(0,b.start),E=Math.min(h.count,b.start+b.count);for(let T=S,A=E;T<A;T+=3){let P=h.getX(T),O=h.getX(T+1),R=h.getX(T+2);c=b2(this,n,e,Dw,d,f,m,g,y,P,O,R),c&&(c.faceIndex=Math.floor(T/3),t.push(c))}}else if(d!==void 0)if(Array.isArray(n))for(let S=0,E=_.length;S<E;S++){let T=_[S],A=n[T.materialIndex],P=Math.max(T.start,b.start),O=Math.min(d.count,Math.min(T.start+T.count,b.start+b.count));for(let R=P,D=O;R<D;R+=3){let L=R,N=R+1,U=R+2;c=b2(this,A,e,Dw,d,f,m,g,y,L,N,U),c&&(c.faceIndex=Math.floor(R/3),c.face.materialIndex=T.materialIndex,t.push(c))}}else{let S=Math.max(0,b.start),E=Math.min(d.count,b.start+b.count);for(let T=S,A=E;T<A;T+=3){let P=T,O=T+1,R=T+2;c=b2(this,n,e,Dw,d,f,m,g,y,P,O,R),c&&(c.faceIndex=Math.floor(T/3),t.push(c))}}}else r.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}};cu.prototype.isMesh=!0;function Bre(i,e,t,r,n,l,c,h){let d;if(e.side===Vd?d=r.intersectTriangle(c,l,n,!0,h):d=r.intersectTriangle(n,l,c,e.side!==NM,h),d===null)return null;x2.copy(h),x2.applyMatrix4(i.matrixWorld);let f=t.ray.origin.distanceTo(x2);return f<t.near||f>t.far?null:{distance:f,point:x2.clone(),object:i}}function b2(i,e,t,r,n,l,c,h,d,f,m,g){jp.fromBufferAttribute(n,f),Gp.fromBufferAttribute(n,m),qp.fromBufferAttribute(n,g);let y=i.morphTargetInfluences;if(l&&y){p2.set(0,0,0),m2.set(0,0,0),g2.set(0,0,0);for(let b=0,S=l.length;b<S;b++){let E=y[b],T=l[b];E!==0&&(CO.fromBufferAttribute(T,f),PO.fromBufferAttribute(T,m),RO.fromBufferAttribute(T,g),c?(p2.addScaledVector(CO,E),m2.addScaledVector(PO,E),g2.addScaledVector(RO,E)):(p2.addScaledVector(CO.sub(jp),E),m2.addScaledVector(PO.sub(Gp),E),g2.addScaledVector(RO.sub(qp),E)))}jp.add(p2),Gp.add(m2),qp.add(g2)}i.isSkinnedMesh&&(i.boneTransform(f,jp),i.boneTransform(m,Gp),i.boneTransform(g,qp));let _=Bre(i,e,t,r,jp,Gp,qp,IO);if(_){h&&(v2.fromBufferAttribute(h,f),y2.fromBufferAttribute(h,m),_2.fromBufferAttribute(h,g),_.uv=Xa.getUV(IO,jp,Gp,qp,v2,y2,_2,new At)),d&&(v2.fromBufferAttribute(d,f),y2.fromBufferAttribute(d,m),_2.fromBufferAttribute(d,g),_.uv2=Xa.getUV(IO,jp,Gp,qp,v2,y2,_2,new At));let b={a:f,b:m,c:g,normal:new Te,materialIndex:0};Xa.getNormal(jp,Gp,qp,b.normal),_.face=b}return _}var XI=class extends vs{constructor(e=1,t=1,r=1,n=1,l=1,c=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:l,depthSegments:c};let h=this;n=Math.floor(n),l=Math.floor(l),c=Math.floor(c);let d=[],f=[],m=[],g=[],y=0,_=0;b("z","y","x",-1,-1,r,t,e,c,l,0),b("z","y","x",1,-1,r,t,-e,c,l,1),b("x","z","y",1,1,e,r,t,n,c,2),b("x","z","y",1,-1,e,r,-t,n,c,3),b("x","y","z",1,-1,e,t,r,n,l,4),b("x","y","z",-1,-1,e,t,-r,n,l,5),this.setIndex(d),this.setAttribute("position",new Ja(f,3)),this.setAttribute("normal",new Ja(m,3)),this.setAttribute("uv",new Ja(g,2));function b(S,E,T,A,P,O,R,D,L,N,U){let F=O/L,z=R/N,G=O/2,J=R/2,Z=D/2,q=L+1,$=N+1,H=0,X=0,re=new Te;for(let ae=0;ae<$;ae++){let he=ae*z-J;for(let pe=0;pe<q;pe++){let de=pe*F-G;re[S]=de*A,re[E]=he*P,re[T]=Z,f.push(re.x,re.y,re.z),re[S]=0,re[E]=0,re[T]=D>0?1:-1,m.push(re.x,re.y,re.z),g.push(pe/L),g.push(1-ae/N),H+=1}}for(let ae=0;ae<N;ae++)for(let he=0;he<L;he++){let pe=y+he+q*ae,de=y+he+q*(ae+1),ee=y+(he+1)+q*(ae+1),se=y+(he+1)+q*ae;d.push(pe,de,se),d.push(de,ee,se),X+=6}h.addGroup(_,X,U),_+=X,y+=H}}static fromJSON(e){return new XI(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function zM(i){let e={};for(let t in i){e[t]={};for(let r in i[t]){let n=i[t][r];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?e[t][r]=n.clone():Array.isArray(n)?e[t][r]=n.slice():e[t][r]=n}}return e}function _o(i){let e={};for(let t=0;t<i.length;t++){let r=zM(i[t]);for(let n in r)e[n]=r[n]}return e}var Ure={clone:zM,merge:_o},Hre=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,$re=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,Xd=class extends za{constructor(e){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=Hre,this.fragmentShader=$re,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&(e.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=zM(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let n in this.uniforms){let l=this.uniforms[n].value;l&&l.isTexture?t.uniforms[n]={type:"t",value:l.toJSON(e).uuid}:l&&l.isColor?t.uniforms[n]={type:"c",value:l.getHex()}:l&&l.isVector2?t.uniforms[n]={type:"v2",value:l.toArray()}:l&&l.isVector3?t.uniforms[n]={type:"v3",value:l.toArray()}:l&&l.isVector4?t.uniforms[n]={type:"v4",value:l.toArray()}:l&&l.isMatrix3?t.uniforms[n]={type:"m3",value:l.toArray()}:l&&l.isMatrix4?t.uniforms[n]={type:"m4",value:l.toArray()}:t.uniforms[n]={value:l}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;let r={};for(let n in this.extensions)this.extensions[n]===!0&&(r[n]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}};Xd.prototype.isShaderMaterial=!0;var kz=class extends Sn{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new Bi,this.projectionMatrix=new Bi,this.projectionMatrixInverse=new Bi}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}};kz.prototype.isCamera=!0;var su=class extends kz{constructor(e=50,t=1,r=.1,n=2e3){super(),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=n,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=rF*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(cO*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return rF*2*Math.atan(Math.tan(cO*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,n,l,c){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=l,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(cO*.5*this.fov)/this.zoom,r=2*t,n=this.aspect*r,l=-.5*n,c=this.view;if(this.view!==null&&this.view.enabled){let d=c.fullWidth,f=c.fullHeight;l+=c.offsetX*n/d,t-=c.offsetY*r/f,n*=c.width/d,r*=c.height/f}let h=this.filmOffset;h!==0&&(l+=e*h/this.getFilmWidth()),this.projectionMatrix.makePerspective(l,l+n,t,t-r,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}};su.prototype.isPerspectiveCamera=!0;var kw=90,Fw=1,Fz=class extends Sn{constructor(i,e,t){if(super(),this.type="CubeCamera",t.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=t;let r=new su(kw,Fw,i,e);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new Te(1,0,0)),this.add(r);let n=new su(kw,Fw,i,e);n.layers=this.layers,n.up.set(0,-1,0),n.lookAt(new Te(-1,0,0)),this.add(n);let l=new su(kw,Fw,i,e);l.layers=this.layers,l.up.set(0,0,1),l.lookAt(new Te(0,1,0)),this.add(l);let c=new su(kw,Fw,i,e);c.layers=this.layers,c.up.set(0,0,-1),c.lookAt(new Te(0,-1,0)),this.add(c);let h=new su(kw,Fw,i,e);h.layers=this.layers,h.up.set(0,-1,0),h.lookAt(new Te(0,0,1)),this.add(h);let d=new su(kw,Fw,i,e);d.layers=this.layers,d.up.set(0,-1,0),d.lookAt(new Te(0,0,-1)),this.add(d)}update(i,e){this.parent===null&&this.updateMatrixWorld();let t=this.renderTarget,[r,n,l,c,h,d]=this.children,f=i.getRenderTarget(),m=i.outputEncoding,g=i.toneMapping,y=i.xr.enabled;i.outputEncoding=Tp,i.toneMapping=vp,i.xr.enabled=!1;let _=t.texture.generateMipmaps;t.texture.generateMipmaps=!1,i.setRenderTarget(t,0),i.render(e,r),i.setRenderTarget(t,1),i.render(e,n),i.setRenderTarget(t,2),i.render(e,l),i.setRenderTarget(t,3),i.render(e,c),i.setRenderTarget(t,4),i.render(e,h),t.texture.generateMipmaps=_,i.setRenderTarget(t,5),i.render(e,d),i.setRenderTarget(f),i.outputEncoding=m,i.toneMapping=g,i.xr.enabled=y,t.texture.needsPMREMUpdate=!0}},ZI=class extends so{constructor(e,t,r,n,l,c,h,d,f,m){e=e!==void 0?e:[],t=t!==void 0?t:DM,super(e,t,r,n,l,c,h,d,f,m),this.flipY=!1}get images(){return this.image}set images(e){this.image=e}};ZI.prototype.isCubeTexture=!0;var i7=class extends Nu{constructor(e,t={}){super(e,e,t);let r={width:e,height:e,depth:1},n=[r,r,r,r,r,r];this.texture=new ZI(n,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:nu}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},n=new XI(5,5,5),l=new Xd({name:"CubemapFromEquirect",uniforms:zM(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:Vd,blending:Um});l.uniforms.tEquirect.value=t;let c=new cu(n,l),h=t.minFilter;return t.minFilter===jI&&(t.minFilter=nu),new Fz(1,10,this).update(e,c),t.minFilter=h,c.geometry.dispose(),c.material.dispose(),this}clear(e,t,r,n){let l=e.getRenderTarget();for(let c=0;c<6;c++)e.setRenderTarget(this,c),e.clear(t,r,n);e.setRenderTarget(l)}};i7.prototype.isWebGLCubeRenderTarget=!0;var LO=new Te,Vre=new Te,Wre=new io,cp=class{constructor(e=new Te(1,0,0),t=0){this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,n){return this.normal.set(e,t,r),this.constant=n,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){let n=LO.subVectors(r,t).cross(Vre.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){let r=e.delta(LO),n=this.normal.dot(r);if(n===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let l=-(e.start.dot(this.normal)+this.constant)/n;return l<0||l>1?null:t.copy(r).multiplyScalar(l).add(e.start)}intersectsLine(e){let t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let r=t||Wre.getNormalMatrix(e),n=this.coplanarPoint(LO).applyMatrix4(e),l=this.normal.applyMatrix3(r).normalize();return this.constant=-n.dot(l),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}};cp.prototype.isPlane=!0;var zw=new lE,w2=new Te,JI=class{constructor(e=new cp,t=new cp,r=new cp,n=new cp,l=new cp,c=new cp){this.planes=[e,t,r,n,l,c]}set(e,t,r,n,l,c){let h=this.planes;return h[0].copy(e),h[1].copy(t),h[2].copy(r),h[3].copy(n),h[4].copy(l),h[5].copy(c),this}copy(e){let t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e){let t=this.planes,r=e.elements,n=r[0],l=r[1],c=r[2],h=r[3],d=r[4],f=r[5],m=r[6],g=r[7],y=r[8],_=r[9],b=r[10],S=r[11],E=r[12],T=r[13],A=r[14],P=r[15];return t[0].setComponents(h-n,g-d,S-y,P-E).normalize(),t[1].setComponents(h+n,g+d,S+y,P+E).normalize(),t[2].setComponents(h+l,g+f,S+_,P+T).normalize(),t[3].setComponents(h-l,g-f,S-_,P-T).normalize(),t[4].setComponents(h-c,g-m,S-b,P-A).normalize(),t[5].setComponents(h+c,g+m,S+b,P+A).normalize(),this}intersectsObject(e){let t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),zw.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(zw)}intersectsSprite(e){return zw.center.set(0,0,0),zw.radius=.7071067811865476,zw.applyMatrix4(e.matrixWorld),this.intersectsSphere(zw)}intersectsSphere(e){let t=this.planes,r=e.center,n=-e.radius;for(let l=0;l<6;l++)if(t[l].distanceToPoint(r)<n)return!1;return!0}intersectsBox(e){let t=this.planes;for(let r=0;r<6;r++){let n=t[r];if(w2.x=n.normal.x>0?e.max.x:e.min.x,w2.y=n.normal.y>0?e.max.y:e.min.y,w2.z=n.normal.z>0?e.max.z:e.min.z,n.distanceToPoint(w2)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function r7(){let i=null,e=!1,t=null,r=null;function n(l,c){t(l,c),r=i.requestAnimationFrame(n)}return{start:function(){e!==!0&&t!==null&&(r=i.requestAnimationFrame(n),e=!0)},stop:function(){i.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(l){t=l},setContext:function(l){i=l}}}function jre(i,e){let t=e.isWebGL2,r=new WeakMap;function n(f,m){let g=f.array,y=f.usage,_=i.createBuffer();i.bindBuffer(m,_),i.bufferData(m,g,y),f.onUploadCallback();let b;if(g instanceof Float32Array)b=5126;else if(g instanceof Uint16Array)if(f.isFloat16BufferAttribute)if(t)b=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else b=5123;else if(g instanceof Int16Array)b=5122;else if(g instanceof Uint32Array)b=5125;else if(g instanceof Int32Array)b=5124;else if(g instanceof Int8Array)b=5120;else if(g instanceof Uint8Array)b=5121;else if(g instanceof Uint8ClampedArray)b=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+g);return{buffer:_,type:b,bytesPerElement:g.BYTES_PER_ELEMENT,version:f.version}}function l(f,m,g){let y=m.array,_=m.updateRange;i.bindBuffer(g,f),_.count===-1?i.bufferSubData(g,0,y):(t?i.bufferSubData(g,_.offset*y.BYTES_PER_ELEMENT,y,_.offset,_.count):i.bufferSubData(g,_.offset*y.BYTES_PER_ELEMENT,y.subarray(_.offset,_.offset+_.count)),_.count=-1)}function c(f){return f.isInterleavedBufferAttribute&&(f=f.data),r.get(f)}function h(f){f.isInterleavedBufferAttribute&&(f=f.data);let m=r.get(f);m&&(i.deleteBuffer(m.buffer),r.delete(f))}function d(f,m){if(f.isGLBufferAttribute){let y=r.get(f);(!y||y.version<f.version)&&r.set(f,{buffer:f.buffer,type:f.type,bytesPerElement:f.elementSize,version:f.version});return}f.isInterleavedBufferAttribute&&(f=f.data);let g=r.get(f);g===void 0?r.set(f,n(f,m)):g.version<f.version&&(l(g.buffer,f,m),g.version=f.version)}return{get:c,remove:h,update:d}}var n7=class extends vs{constructor(e=1,t=1,r=1,n=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:n};let l=e/2,c=t/2,h=Math.floor(r),d=Math.floor(n),f=h+1,m=d+1,g=e/h,y=t/d,_=[],b=[],S=[],E=[];for(let T=0;T<m;T++){let A=T*y-c;for(let P=0;P<f;P++){let O=P*g-l;b.push(O,-A,0),S.push(0,0,1),E.push(P/h),E.push(1-T/d)}}for(let T=0;T<d;T++)for(let A=0;A<h;A++){let P=A+f*T,O=A+f*(T+1),R=A+1+f*(T+1),D=A+1+f*T;_.push(P,O,D),_.push(O,R,D)}this.setIndex(_),this.setAttribute("position",new Ja(b,3)),this.setAttribute("normal",new Ja(S,3)),this.setAttribute("uv",new Ja(E,2))}static fromJSON(e){return new n7(e.width,e.height,e.widthSegments,e.heightSegments)}},Gre=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,qre=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Xre=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,Zre=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Jre=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,Yre=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Kre="vec3 transformed = vec3( position );",Qre=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,ene=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,tne=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,ine=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,rne=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,nne=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,sne=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,ane=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,one=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,lne=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,une=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,cne=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,hne=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,dne=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,fne=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,pne=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,mne=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,gne=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,vne="gl_FragColor = linearToOutputTexel( gl_FragColor );",yne=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,_ne=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,xne=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,bne=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,wne=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Sne=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Mne=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Ene=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Tne=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Ane=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Cne=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,Pne=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,Rne=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,Ine=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointLightInfo( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotLightInfo( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
		#endif
	}
	#pragma unroll_loop_end
#endif`,Lne=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,One=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,Nne=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Dne=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,kne=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Fne=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,zne=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,Bne=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	vec3 FssEss = specularColor * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Une=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Hne=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,$ne=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,Vne=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Wne=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,jne=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,Gne=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,qne=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,Xne=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Zne=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Jne=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Yne=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Kne=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Qne=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,ese=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,tse=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,ise=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,rse=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,nse=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,sse=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,ase=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,ose=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,lse=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,use=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,cse=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,hse=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,dse=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,fse=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,pse=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,mse=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,gse=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,vse=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,yse=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,_se=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,xse=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,bse=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,wse=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,Sse=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Mse=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Ese=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,Tse=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Ase=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Cse=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Pse=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,Rse=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Ise=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Lse=`#ifdef USE_TRANSMISSION
	float transmissionAlpha = 1.0;
	float transmissionFactor = transmission;
	float thicknessFactor = thickness;
	#ifdef USE_TRANSMISSIONMAP
		transmissionFactor *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		thicknessFactor *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,
		attenuationColor, attenuationDistance );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );
	transmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );
#endif`,Ose=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( attenuationDistance == 0.0 ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,Nse=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,Dse=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,kse=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,Fse=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,zse=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,Bse=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,Use=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,Hse=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,$se=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	gl_FragColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		gl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );
	#endif
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Vse=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Wse=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,jse=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Gse=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,qse=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Xse=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Zse=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Jse=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Yse=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Kse=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Qse=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,eae=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,tae=`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,iae=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,rae=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,nae=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,sae=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,aae=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,oae=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,lae=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,uae=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,cae=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,hae=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,dae=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,fae=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,pae=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,mae=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,gae=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,vae=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,yae=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,wr={alphamap_fragment:Gre,alphamap_pars_fragment:qre,alphatest_fragment:Xre,alphatest_pars_fragment:Zre,aomap_fragment:Jre,aomap_pars_fragment:Yre,begin_vertex:Kre,beginnormal_vertex:Qre,bsdfs:ene,bumpmap_pars_fragment:tne,clipping_planes_fragment:ine,clipping_planes_pars_fragment:rne,clipping_planes_pars_vertex:nne,clipping_planes_vertex:sne,color_fragment:ane,color_pars_fragment:one,color_pars_vertex:lne,color_vertex:une,common:cne,cube_uv_reflection_fragment:hne,defaultnormal_vertex:dne,displacementmap_pars_vertex:fne,displacementmap_vertex:pne,emissivemap_fragment:mne,emissivemap_pars_fragment:gne,encodings_fragment:vne,encodings_pars_fragment:yne,envmap_fragment:_ne,envmap_common_pars_fragment:xne,envmap_pars_fragment:bne,envmap_pars_vertex:wne,envmap_physical_pars_fragment:One,envmap_vertex:Sne,fog_vertex:Mne,fog_pars_vertex:Ene,fog_fragment:Tne,fog_pars_fragment:Ane,gradientmap_pars_fragment:Cne,lightmap_fragment:Pne,lightmap_pars_fragment:Rne,lights_lambert_vertex:Ine,lights_pars_begin:Lne,lights_toon_fragment:Nne,lights_toon_pars_fragment:Dne,lights_phong_fragment:kne,lights_phong_pars_fragment:Fne,lights_physical_fragment:zne,lights_physical_pars_fragment:Bne,lights_fragment_begin:Une,lights_fragment_maps:Hne,lights_fragment_end:$ne,logdepthbuf_fragment:Vne,logdepthbuf_pars_fragment:Wne,logdepthbuf_pars_vertex:jne,logdepthbuf_vertex:Gne,map_fragment:qne,map_pars_fragment:Xne,map_particle_fragment:Zne,map_particle_pars_fragment:Jne,metalnessmap_fragment:Yne,metalnessmap_pars_fragment:Kne,morphcolor_vertex:Qne,morphnormal_vertex:ese,morphtarget_pars_vertex:tse,morphtarget_vertex:ise,normal_fragment_begin:rse,normal_fragment_maps:nse,normal_pars_fragment:sse,normal_pars_vertex:ase,normal_vertex:ose,normalmap_pars_fragment:lse,clearcoat_normal_fragment_begin:use,clearcoat_normal_fragment_maps:cse,clearcoat_pars_fragment:hse,output_fragment:dse,packing:fse,premultiplied_alpha_fragment:pse,project_vertex:mse,dithering_fragment:gse,dithering_pars_fragment:vse,roughnessmap_fragment:yse,roughnessmap_pars_fragment:_se,shadowmap_pars_fragment:xse,shadowmap_pars_vertex:bse,shadowmap_vertex:wse,shadowmask_pars_fragment:Sse,skinbase_vertex:Mse,skinning_pars_vertex:Ese,skinning_vertex:Tse,skinnormal_vertex:Ase,specularmap_fragment:Cse,specularmap_pars_fragment:Pse,tonemapping_fragment:Rse,tonemapping_pars_fragment:Ise,transmission_fragment:Lse,transmission_pars_fragment:Ose,uv_pars_fragment:Nse,uv_pars_vertex:Dse,uv_vertex:kse,uv2_pars_fragment:Fse,uv2_pars_vertex:zse,uv2_vertex:Bse,worldpos_vertex:Use,background_vert:Hse,background_frag:$se,cube_vert:Vse,cube_frag:Wse,depth_vert:jse,depth_frag:Gse,distanceRGBA_vert:qse,distanceRGBA_frag:Xse,equirect_vert:Zse,equirect_frag:Jse,linedashed_vert:Yse,linedashed_frag:Kse,meshbasic_vert:Qse,meshbasic_frag:eae,meshlambert_vert:tae,meshlambert_frag:iae,meshmatcap_vert:rae,meshmatcap_frag:nae,meshnormal_vert:sae,meshnormal_frag:aae,meshphong_vert:oae,meshphong_frag:lae,meshphysical_vert:uae,meshphysical_frag:cae,meshtoon_vert:hae,meshtoon_frag:dae,points_vert:fae,points_frag:pae,shadow_vert:mae,shadow_frag:gae,sprite_vert:vae,sprite_frag:yae},qt={common:{diffuse:{value:new Ei(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new io},uv2Transform:{value:new io},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new At(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ei(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ei(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new io}},sprite:{diffuse:{value:new Ei(16777215)},opacity:{value:1},center:{value:new At(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new io}}},hf={basic:{uniforms:_o([qt.common,qt.specularmap,qt.envmap,qt.aomap,qt.lightmap,qt.fog]),vertexShader:wr.meshbasic_vert,fragmentShader:wr.meshbasic_frag},lambert:{uniforms:_o([qt.common,qt.specularmap,qt.envmap,qt.aomap,qt.lightmap,qt.emissivemap,qt.fog,qt.lights,{emissive:{value:new Ei(0)}}]),vertexShader:wr.meshlambert_vert,fragmentShader:wr.meshlambert_frag},phong:{uniforms:_o([qt.common,qt.specularmap,qt.envmap,qt.aomap,qt.lightmap,qt.emissivemap,qt.bumpmap,qt.normalmap,qt.displacementmap,qt.fog,qt.lights,{emissive:{value:new Ei(0)},specular:{value:new Ei(1118481)},shininess:{value:30}}]),vertexShader:wr.meshphong_vert,fragmentShader:wr.meshphong_frag},standard:{uniforms:_o([qt.common,qt.envmap,qt.aomap,qt.lightmap,qt.emissivemap,qt.bumpmap,qt.normalmap,qt.displacementmap,qt.roughnessmap,qt.metalnessmap,qt.fog,qt.lights,{emissive:{value:new Ei(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:wr.meshphysical_vert,fragmentShader:wr.meshphysical_frag},toon:{uniforms:_o([qt.common,qt.aomap,qt.lightmap,qt.emissivemap,qt.bumpmap,qt.normalmap,qt.displacementmap,qt.gradientmap,qt.fog,qt.lights,{emissive:{value:new Ei(0)}}]),vertexShader:wr.meshtoon_vert,fragmentShader:wr.meshtoon_frag},matcap:{uniforms:_o([qt.common,qt.bumpmap,qt.normalmap,qt.displacementmap,qt.fog,{matcap:{value:null}}]),vertexShader:wr.meshmatcap_vert,fragmentShader:wr.meshmatcap_frag},points:{uniforms:_o([qt.points,qt.fog]),vertexShader:wr.points_vert,fragmentShader:wr.points_frag},dashed:{uniforms:_o([qt.common,qt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:wr.linedashed_vert,fragmentShader:wr.linedashed_frag},depth:{uniforms:_o([qt.common,qt.displacementmap]),vertexShader:wr.depth_vert,fragmentShader:wr.depth_frag},normal:{uniforms:_o([qt.common,qt.bumpmap,qt.normalmap,qt.displacementmap,{opacity:{value:1}}]),vertexShader:wr.meshnormal_vert,fragmentShader:wr.meshnormal_frag},sprite:{uniforms:_o([qt.sprite,qt.fog]),vertexShader:wr.sprite_vert,fragmentShader:wr.sprite_frag},background:{uniforms:{uvTransform:{value:new io},t2D:{value:null}},vertexShader:wr.background_vert,fragmentShader:wr.background_frag},cube:{uniforms:_o([qt.envmap,{opacity:{value:1}}]),vertexShader:wr.cube_vert,fragmentShader:wr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:wr.equirect_vert,fragmentShader:wr.equirect_frag},distanceRGBA:{uniforms:_o([qt.common,qt.displacementmap,{referencePosition:{value:new Te},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:wr.distanceRGBA_vert,fragmentShader:wr.distanceRGBA_frag},shadow:{uniforms:_o([qt.lights,qt.fog,{color:{value:new Ei(0)},opacity:{value:1}}]),vertexShader:wr.shadow_vert,fragmentShader:wr.shadow_frag}};hf.physical={uniforms:_o([hf.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new At(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new Ei(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new At},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Ei(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Ei(1,1,1)},specularColorMap:{value:null}}]),vertexShader:wr.meshphysical_vert,fragmentShader:wr.meshphysical_frag};function _ae(i,e,t,r,n,l){let c=new Ei(0),h=n===!0?0:1,d,f,m=null,g=0,y=null;function _(S,E){let T=!1,A=E.isScene===!0?E.background:null;A&&A.isTexture&&(A=e.get(A));let P=i.xr,O=P.getSession&&P.getSession();O&&O.environmentBlendMode==="additive"&&(A=null),A===null?b(c,h):A&&A.isColor&&(b(A,1),T=!0),(i.autoClear||T)&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),A&&(A.isCubeTexture||A.mapping===WI)?(f===void 0&&(f=new cu(new XI(1,1,1),new Xd({name:"BackgroundCubeMaterial",uniforms:zM(hf.cube.uniforms),vertexShader:hf.cube.vertexShader,fragmentShader:hf.cube.fragmentShader,side:Vd,depthTest:!1,depthWrite:!1,fog:!1})),f.geometry.deleteAttribute("normal"),f.geometry.deleteAttribute("uv"),f.onBeforeRender=function(R,D,L){this.matrixWorld.copyPosition(L.matrixWorld)},Object.defineProperty(f.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(f)),f.material.uniforms.envMap.value=A,f.material.uniforms.flipEnvMap.value=A.isCubeTexture&&A.isRenderTargetTexture===!1?-1:1,(m!==A||g!==A.version||y!==i.toneMapping)&&(f.material.needsUpdate=!0,m=A,g=A.version,y=i.toneMapping),S.unshift(f,f.geometry,f.material,0,0,null)):A&&A.isTexture&&(d===void 0&&(d=new cu(new n7(2,2),new Xd({name:"BackgroundMaterial",uniforms:zM(hf.background.uniforms),vertexShader:hf.background.vertexShader,fragmentShader:hf.background.fragmentShader,side:TA,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),Object.defineProperty(d.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(d)),d.material.uniforms.t2D.value=A,A.matrixAutoUpdate===!0&&A.updateMatrix(),d.material.uniforms.uvTransform.value.copy(A.matrix),(m!==A||g!==A.version||y!==i.toneMapping)&&(d.material.needsUpdate=!0,m=A,g=A.version,y=i.toneMapping),S.unshift(d,d.geometry,d.material,0,0,null))}function b(S,E){t.buffers.color.setClear(S.r,S.g,S.b,E,l)}return{getClearColor:function(){return c},setClearColor:function(S,E=1){c.set(S),h=E,b(c,h)},getClearAlpha:function(){return h},setClearAlpha:function(S){h=S,b(c,h)},render:_}}function xae(i,e,t,r){let n=i.getParameter(34921),l=r.isWebGL2?null:e.get("OES_vertex_array_object"),c=r.isWebGL2||l!==null,h={},d=E(null),f=d,m=!1;function g(Z,q,$,H,X){let re=!1;if(c){let ae=S(H,$,q);f!==ae&&(f=ae,_(f.object)),re=T(H,X),re&&A(H,X)}else{let ae=q.wireframe===!0;(f.geometry!==H.id||f.program!==$.id||f.wireframe!==ae)&&(f.geometry=H.id,f.program=$.id,f.wireframe=ae,re=!0)}Z.isInstancedMesh===!0&&(re=!0),X!==null&&t.update(X,34963),(re||m)&&(m=!1,N(Z,q,$,H),X!==null&&i.bindBuffer(34963,t.get(X).buffer))}function y(){return r.isWebGL2?i.createVertexArray():l.createVertexArrayOES()}function _(Z){return r.isWebGL2?i.bindVertexArray(Z):l.bindVertexArrayOES(Z)}function b(Z){return r.isWebGL2?i.deleteVertexArray(Z):l.deleteVertexArrayOES(Z)}function S(Z,q,$){let H=$.wireframe===!0,X=h[Z.id];X===void 0&&(X={},h[Z.id]=X);let re=X[q.id];re===void 0&&(re={},X[q.id]=re);let ae=re[H];return ae===void 0&&(ae=E(y()),re[H]=ae),ae}function E(Z){let q=[],$=[],H=[];for(let X=0;X<n;X++)q[X]=0,$[X]=0,H[X]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:q,enabledAttributes:$,attributeDivisors:H,object:Z,attributes:{},index:null}}function T(Z,q){let $=f.attributes,H=Z.attributes,X=0;for(let re in H){let ae=$[re],he=H[re];if(ae===void 0||ae.attribute!==he||ae.data!==he.data)return!0;X++}return f.attributesNum!==X||f.index!==q}function A(Z,q){let $={},H=Z.attributes,X=0;for(let re in H){let ae=H[re],he={};he.attribute=ae,ae.data&&(he.data=ae.data),$[re]=he,X++}f.attributes=$,f.attributesNum=X,f.index=q}function P(){let Z=f.newAttributes;for(let q=0,$=Z.length;q<$;q++)Z[q]=0}function O(Z){R(Z,0)}function R(Z,q){let $=f.newAttributes,H=f.enabledAttributes,X=f.attributeDivisors;$[Z]=1,H[Z]===0&&(i.enableVertexAttribArray(Z),H[Z]=1),X[Z]!==q&&((r.isWebGL2?i:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Z,q),X[Z]=q)}function D(){let Z=f.newAttributes,q=f.enabledAttributes;for(let $=0,H=q.length;$<H;$++)q[$]!==Z[$]&&(i.disableVertexAttribArray($),q[$]=0)}function L(Z,q,$,H,X,re){r.isWebGL2===!0&&($===5124||$===5125)?i.vertexAttribIPointer(Z,q,$,X,re):i.vertexAttribPointer(Z,q,$,H,X,re)}function N(Z,q,$,H){if(r.isWebGL2===!1&&(Z.isInstancedMesh||H.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;P();let X=H.attributes,re=$.getAttributes(),ae=q.defaultAttributeValues;for(let he in re){let pe=re[he];if(pe.location>=0){let de=X[he];if(de===void 0&&(he==="instanceMatrix"&&Z.instanceMatrix&&(de=Z.instanceMatrix),he==="instanceColor"&&Z.instanceColor&&(de=Z.instanceColor)),de!==void 0){let ee=de.normalized,se=de.itemSize,Y=t.get(de);if(Y===void 0)continue;let fe=Y.buffer,me=Y.type,De=Y.bytesPerElement;if(de.isInterleavedBufferAttribute){let Le=de.data,Ce=Le.stride,Ae=de.offset;if(Le.isInstancedInterleavedBuffer){for(let Ue=0;Ue<pe.locationSize;Ue++)R(pe.location+Ue,Le.meshPerAttribute);Z.isInstancedMesh!==!0&&H._maxInstanceCount===void 0&&(H._maxInstanceCount=Le.meshPerAttribute*Le.count)}else for(let Ue=0;Ue<pe.locationSize;Ue++)O(pe.location+Ue);i.bindBuffer(34962,fe);for(let Ue=0;Ue<pe.locationSize;Ue++)L(pe.location+Ue,se/pe.locationSize,me,ee,Ce*De,(Ae+se/pe.locationSize*Ue)*De)}else{if(de.isInstancedBufferAttribute){for(let Le=0;Le<pe.locationSize;Le++)R(pe.location+Le,de.meshPerAttribute);Z.isInstancedMesh!==!0&&H._maxInstanceCount===void 0&&(H._maxInstanceCount=de.meshPerAttribute*de.count)}else for(let Le=0;Le<pe.locationSize;Le++)O(pe.location+Le);i.bindBuffer(34962,fe);for(let Le=0;Le<pe.locationSize;Le++)L(pe.location+Le,se/pe.locationSize,me,ee,se*De,se/pe.locationSize*Le*De)}}else if(ae!==void 0){let ee=ae[he];if(ee!==void 0)switch(ee.length){case 2:i.vertexAttrib2fv(pe.location,ee);break;case 3:i.vertexAttrib3fv(pe.location,ee);break;case 4:i.vertexAttrib4fv(pe.location,ee);break;default:i.vertexAttrib1fv(pe.location,ee)}}}}D()}function U(){G();for(let Z in h){let q=h[Z];for(let $ in q){let H=q[$];for(let X in H)b(H[X].object),delete H[X];delete q[$]}delete h[Z]}}function F(Z){if(h[Z.id]===void 0)return;let q=h[Z.id];for(let $ in q){let H=q[$];for(let X in H)b(H[X].object),delete H[X];delete q[$]}delete h[Z.id]}function z(Z){for(let q in h){let $=h[q];if($[Z.id]===void 0)continue;let H=$[Z.id];for(let X in H)b(H[X].object),delete H[X];delete $[Z.id]}}function G(){J(),m=!0,f!==d&&(f=d,_(f.object))}function J(){d.geometry=null,d.program=null,d.wireframe=!1}return{setup:g,reset:G,resetDefaultState:J,dispose:U,releaseStatesOfGeometry:F,releaseStatesOfProgram:z,initAttributes:P,enableAttribute:O,disableUnusedAttributes:D}}function bae(i,e,t,r){let n=r.isWebGL2,l;function c(f){l=f}function h(f,m){i.drawArrays(l,f,m),t.update(m,l,1)}function d(f,m,g){if(g===0)return;let y,_;if(n)y=i,_="drawArraysInstanced";else if(y=e.get("ANGLE_instanced_arrays"),_="drawArraysInstancedANGLE",y===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}y[_](l,f,m,g),t.update(m,l,g)}this.setMode=c,this.render=h,this.renderInstances=d}function wae(i,e,t){let r;function n(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){let L=e.get("EXT_texture_filter_anisotropic");r=i.getParameter(L.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function l(L){if(L==="highp"){if(i.getShaderPrecisionFormat(35633,36338).precision>0&&i.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";L="mediump"}return L==="mediump"&&i.getShaderPrecisionFormat(35633,36337).precision>0&&i.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}let c=typeof WebGL2RenderingContext<"u"&&i instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&i instanceof WebGL2ComputeRenderingContext,h=t.precision!==void 0?t.precision:"highp",d=l(h);d!==h&&(console.warn("THREE.WebGLRenderer:",h,"not supported, using",d,"instead."),h=d);let f=c||e.has("WEBGL_draw_buffers"),m=t.logarithmicDepthBuffer===!0,g=i.getParameter(34930),y=i.getParameter(35660),_=i.getParameter(3379),b=i.getParameter(34076),S=i.getParameter(34921),E=i.getParameter(36347),T=i.getParameter(36348),A=i.getParameter(36349),P=y>0,O=c||e.has("OES_texture_float"),R=P&&O,D=c?i.getParameter(36183):0;return{isWebGL2:c,drawBuffers:f,getMaxAnisotropy:n,getMaxPrecision:l,precision:h,logarithmicDepthBuffer:m,maxTextures:g,maxVertexTextures:y,maxTextureSize:_,maxCubemapSize:b,maxAttributes:S,maxVertexUniforms:E,maxVaryings:T,maxFragmentUniforms:A,vertexTextures:P,floatFragmentTextures:O,floatVertexTextures:R,maxSamples:D}}function Sae(i){let e=this,t=null,r=0,n=!1,l=!1,c=new cp,h=new io,d={value:null,needsUpdate:!1};this.uniform=d,this.numPlanes=0,this.numIntersection=0,this.init=function(g,y,_){let b=g.length!==0||y||r!==0||n;return n=y,t=m(g,_,0),r=g.length,b},this.beginShadows=function(){l=!0,m(null)},this.endShadows=function(){l=!1,f()},this.setState=function(g,y,_){let b=g.clippingPlanes,S=g.clipIntersection,E=g.clipShadows,T=i.get(g);if(!n||b===null||b.length===0||l&&!E)l?m(null):f();else{let A=l?0:r,P=A*4,O=T.clippingState||null;d.value=O,O=m(b,y,P,_);for(let R=0;R!==P;++R)O[R]=t[R];T.clippingState=O,this.numIntersection=S?this.numPlanes:0,this.numPlanes+=A}};function f(){d.value!==t&&(d.value=t,d.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function m(g,y,_,b){let S=g!==null?g.length:0,E=null;if(S!==0){if(E=d.value,b!==!0||E===null){let T=_+S*4,A=y.matrixWorldInverse;h.getNormalMatrix(A),(E===null||E.length<T)&&(E=new Float32Array(T));for(let P=0,O=_;P!==S;++P,O+=4)c.copy(g[P]).applyMatrix4(A,h),c.normal.toArray(E,O),E[O+3]=c.constant}d.value=E,d.needsUpdate=!0}return e.numPlanes=S,e.numIntersection=0,E}}function Mae(i){let e=new WeakMap;function t(c,h){return h===Kk?c.mapping=DM:h===Qk&&(c.mapping=kM),c}function r(c){if(c&&c.isTexture&&c.isRenderTargetTexture===!1){let h=c.mapping;if(h===Kk||h===Qk)if(e.has(c)){let d=e.get(c).texture;return t(d,c.mapping)}else{let d=c.image;if(d&&d.height>0){let f=new i7(d.height/2);return f.fromEquirectangularTexture(i,c),e.set(c,f),c.addEventListener("dispose",n),t(f.texture,c.mapping)}else return null}}return c}function n(c){let h=c.target;h.removeEventListener("dispose",n);let d=e.get(h);d!==void 0&&(e.delete(h),d.dispose())}function l(){e=new WeakMap}return{get:r,dispose:l}}var zz=class extends kz{constructor(i=-1,e=1,t=1,r=-1,n=.1,l=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=i,this.right=e,this.top=t,this.bottom=r,this.near=n,this.far=l,this.updateProjectionMatrix()}copy(i,e){return super.copy(i,e),this.left=i.left,this.right=i.right,this.top=i.top,this.bottom=i.bottom,this.near=i.near,this.far=i.far,this.zoom=i.zoom,this.view=i.view===null?null:Object.assign({},i.view),this}setViewOffset(i,e,t,r,n,l){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=i,this.view.fullHeight=e,this.view.offsetX=t,this.view.offsetY=r,this.view.width=n,this.view.height=l,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let i=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),t=(this.right+this.left)/2,r=(this.top+this.bottom)/2,n=t-i,l=t+i,c=r+e,h=r-e;if(this.view!==null&&this.view.enabled){let d=(this.right-this.left)/this.view.fullWidth/this.zoom,f=(this.top-this.bottom)/this.view.fullHeight/this.zoom;n+=d*this.view.offsetX,l=n+d*this.view.width,c-=f*this.view.offsetY,h=c-f*this.view.height}this.projectionMatrix.makeOrthographic(n,l,c,h,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(i){let e=super.toJSON(i);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,this.view!==null&&(e.object.view=Object.assign({},this.view)),e}};zz.prototype.isOrthographicCamera=!0;var KS=4,G6=[.125,.215,.35,.446,.526,.582],T1=20,OO=new zz,q6=new Ei,NO=null,w1=(1+Math.sqrt(5))/2,Bw=1/w1,X6=[new Te(1,1,1),new Te(-1,1,1),new Te(1,1,-1),new Te(-1,1,-1),new Te(0,w1,Bw),new Te(0,w1,-Bw),new Te(Bw,0,w1),new Te(-Bw,0,w1),new Te(w1,Bw,0),new Te(-w1,Bw,0)],Z6=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,n=100){NO=this._renderer.getRenderTarget(),this._setSize(256);let l=this._allocateTargets();return l.depthBuffer=!0,this._sceneToCubeUV(e,r,n,l),t>0&&this._blur(l,0,0,t),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=K6(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Y6(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(NO),e.scissorTest=!1,S2(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===DM||e.mapping===kM?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),NO=this._renderer.getRenderTarget();let r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize-32,r={magFilter:nu,minFilter:nu,generateMipmaps:!1,type:pM,format:Bd,encoding:Tp,depthBuffer:!1},n=J6(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=J6(e,t,r);let{_lodMax:l}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=Eae(l)),this._blurMaterial=Tae(l,e,t)}return n}_compileMaterial(e){let t=new cu(this._lodPlanes[0],e);this._renderer.compile(t,OO)}_sceneToCubeUV(e,t,r,n){let l=new su(90,1,t,r),c=[1,-1,1,1,1,1],h=[1,1,1,-1,-1,-1],d=this._renderer,f=d.autoClear,m=d.toneMapping;d.getClearColor(q6),d.toneMapping=vp,d.autoClear=!1;let g=new qI({name:"PMREM.Background",side:Vd,depthWrite:!1,depthTest:!1}),y=new cu(new XI,g),_=!1,b=e.background;b?b.isColor&&(g.color.copy(b),e.background=null,_=!0):(g.color.copy(q6),_=!0);for(let S=0;S<6;S++){let E=S%3;E===0?(l.up.set(0,c[S],0),l.lookAt(h[S],0,0)):E===1?(l.up.set(0,0,c[S]),l.lookAt(0,h[S],0)):(l.up.set(0,c[S],0),l.lookAt(0,0,h[S]));let T=this._cubeSize;S2(n,E*T,S>2?T:0,T,T),d.setRenderTarget(n),_&&d.render(y,l),d.render(e,l)}y.geometry.dispose(),y.material.dispose(),d.toneMapping=m,d.autoClear=f,e.background=b}_textureToCubeUV(e,t){let r=this._renderer,n=e.mapping===DM||e.mapping===kM;n?(this._cubemapMaterial===null&&(this._cubemapMaterial=K6()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=Y6());let l=n?this._cubemapMaterial:this._equirectMaterial,c=new cu(this._lodPlanes[0],l),h=l.uniforms;h.envMap.value=e;let d=this._cubeSize;S2(t,0,0,3*d,2*d),r.setRenderTarget(t),r.render(c,OO)}_applyPMREM(e){let t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let n=1;n<this._lodPlanes.length;n++){let l=Math.sqrt(this._sigmas[n]*this._sigmas[n]-this._sigmas[n-1]*this._sigmas[n-1]),c=X6[(n-1)%X6.length];this._blur(e,n-1,n,l,c)}t.autoClear=r}_blur(e,t,r,n,l){let c=this._pingPongRenderTarget;this._halfBlur(e,c,t,r,n,"latitudinal",l),this._halfBlur(c,e,r,r,n,"longitudinal",l)}_halfBlur(e,t,r,n,l,c,h){let d=this._renderer,f=this._blurMaterial;c!=="latitudinal"&&c!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let m=3,g=new cu(this._lodPlanes[n],f),y=f.uniforms,_=this._sizeLods[r]-1,b=isFinite(l)?Math.PI/(2*_):2*Math.PI/(2*T1-1),S=l/b,E=isFinite(l)?1+Math.floor(m*S):T1;E>T1&&console.warn(`sigmaRadians, ${l}, is too large and will clip, as it requested ${E} samples when the maximum is set to ${T1}`);let T=[],A=0;for(let L=0;L<T1;++L){let N=L/S,U=Math.exp(-N*N/2);T.push(U),L===0?A+=U:L<E&&(A+=2*U)}for(let L=0;L<T.length;L++)T[L]=T[L]/A;y.envMap.value=e.texture,y.samples.value=E,y.weights.value=T,y.latitudinal.value=c==="latitudinal",h&&(y.poleAxis.value=h);let{_lodMax:P}=this;y.dTheta.value=b,y.mipInt.value=P-r;let O=this._sizeLods[n],R=3*O*(n>P-KS?n-P+KS:0),D=4*(this._cubeSize-O);S2(t,R,D,3*O,2*O),d.setRenderTarget(t),d.render(g,OO)}};function Eae(i){let e=[],t=[],r=[],n=i,l=i-KS+1+G6.length;for(let c=0;c<l;c++){let h=Math.pow(2,n);t.push(h);let d=1/h;c>i-KS?d=G6[c-i+KS-1]:c===0&&(d=0),r.push(d);let f=1/(h-1),m=-f/2,g=1+f/2,y=[m,m,g,m,g,g,m,m,g,g,m,g],_=6,b=6,S=3,E=2,T=1,A=new Float32Array(S*b*_),P=new Float32Array(E*b*_),O=new Float32Array(T*b*_);for(let D=0;D<_;D++){let L=D%3*2/3-1,N=D>2?0:-1,U=[L,N,0,L+2/3,N,0,L+2/3,N+1,0,L,N,0,L+2/3,N+1,0,L,N+1,0];A.set(U,S*b*D),P.set(y,E*b*D);let F=[D,D,D,D,D,D];O.set(F,T*b*D)}let R=new vs;R.setAttribute("position",new Da(A,S)),R.setAttribute("uv",new Da(P,E)),R.setAttribute("faceIndex",new Da(O,T)),e.push(R),n>KS&&n--}return{lodPlanes:e,sizeLods:t,sigmas:r}}function J6(i,e,t){let r=new Nu(i,e,t);return r.texture.mapping=WI,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function S2(i,e,t,r,n){i.viewport.set(e,t,r,n),i.scissor.set(e,t,r,n)}function Tae(i,e,t){let r=new Float32Array(T1),n=new Te(0,1,0);return new Xd({name:"SphericalGaussianBlur",defines:{n:T1,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n}},vertexShader:Bz(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Um,depthTest:!1,depthWrite:!1})}function Y6(){return new Xd({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Bz(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Um,depthTest:!1,depthWrite:!1})}function K6(){return new Xd({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Bz(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Um,depthTest:!1,depthWrite:!1})}function Bz(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Aae(i){let e=new WeakMap,t=null;function r(h){if(h&&h.isTexture){let d=h.mapping,f=d===Kk||d===Qk,m=d===DM||d===kM;if(f||m)if(h.isRenderTargetTexture&&h.needsPMREMUpdate===!0){h.needsPMREMUpdate=!1;let g=e.get(h);return t===null&&(t=new Z6(i)),g=f?t.fromEquirectangular(h,g):t.fromCubemap(h,g),e.set(h,g),g.texture}else{if(e.has(h))return e.get(h).texture;{let g=h.image;if(f&&g&&g.height>0||m&&g&&n(g)){t===null&&(t=new Z6(i));let y=f?t.fromEquirectangular(h):t.fromCubemap(h);return e.set(h,y),h.addEventListener("dispose",l),y.texture}else return null}}}return h}function n(h){let d=0,f=6;for(let m=0;m<f;m++)h[m]!==void 0&&d++;return d===f}function l(h){let d=h.target;d.removeEventListener("dispose",l);let f=e.get(d);f!==void 0&&(e.delete(d),f.dispose())}function c(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:r,dispose:c}}function Cae(i){let e={};function t(r){if(e[r]!==void 0)return e[r];let n;switch(r){case"WEBGL_depth_texture":n=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=i.getExtension(r)}return e[r]=n,n}return{has:function(r){return t(r)!==null},init:function(r){r.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(r){let n=t(r);return n===null&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),n}}}function Pae(i,e,t,r){let n={},l=new WeakMap;function c(g){let y=g.target;y.index!==null&&e.remove(y.index);for(let b in y.attributes)e.remove(y.attributes[b]);y.removeEventListener("dispose",c),delete n[y.id];let _=l.get(y);_&&(e.remove(_),l.delete(y)),r.releaseStatesOfGeometry(y),y.isInstancedBufferGeometry===!0&&delete y._maxInstanceCount,t.memory.geometries--}function h(g,y){return n[y.id]===!0||(y.addEventListener("dispose",c),n[y.id]=!0,t.memory.geometries++),y}function d(g){let y=g.attributes;for(let b in y)e.update(y[b],34962);let _=g.morphAttributes;for(let b in _){let S=_[b];for(let E=0,T=S.length;E<T;E++)e.update(S[E],34962)}}function f(g){let y=[],_=g.index,b=g.attributes.position,S=0;if(_!==null){let A=_.array;S=_.version;for(let P=0,O=A.length;P<O;P+=3){let R=A[P+0],D=A[P+1],L=A[P+2];y.push(R,D,D,L,L,R)}}else{let A=b.array;S=b.version;for(let P=0,O=A.length/3-1;P<O;P+=3){let R=P+0,D=P+1,L=P+2;y.push(R,D,D,L,L,R)}}let E=new(J8(y)?t7:e7)(y,1);E.version=S;let T=l.get(g);T&&e.remove(T),l.set(g,E)}function m(g){let y=l.get(g);if(y){let _=g.index;_!==null&&y.version<_.version&&f(g)}else f(g);return l.get(g)}return{get:h,update:d,getWireframeAttribute:m}}function Rae(i,e,t,r){let n=r.isWebGL2,l;function c(y){l=y}let h,d;function f(y){h=y.type,d=y.bytesPerElement}function m(y,_){i.drawElements(l,_,h,y*d),t.update(_,l,1)}function g(y,_,b){if(b===0)return;let S,E;if(n)S=i,E="drawElementsInstanced";else if(S=e.get("ANGLE_instanced_arrays"),E="drawElementsInstancedANGLE",S===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}S[E](l,_,h,y*d,b),t.update(_,l,b)}this.setMode=c,this.setIndex=f,this.render=m,this.renderInstances=g}function Iae(i){let e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function r(l,c,h){switch(t.calls++,c){case 4:t.triangles+=h*(l/3);break;case 1:t.lines+=h*(l/2);break;case 3:t.lines+=h*(l-1);break;case 2:t.lines+=h*l;break;case 0:t.points+=h*l;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",c);break}}function n(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:n,update:r}}function Lae(i,e){return i[0]-e[0]}function Oae(i,e){return Math.abs(e[1])-Math.abs(i[1])}function DO(i,e){let t=1,r=e.isInterleavedBufferAttribute?e.data.array:e.array;r instanceof Int8Array?t=127:r instanceof Int16Array?t=32767:r instanceof Int32Array?t=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",r),i.divideScalar(t)}function Nae(i,e,t){let r={},n=new Float32Array(8),l=new WeakMap,c=new wn,h=[];for(let f=0;f<8;f++)h[f]=[f,0];function d(f,m,g,y){let _=f.morphTargetInfluences;if(e.isWebGL2===!0){let b=m.morphAttributes.position||m.morphAttributes.normal||m.morphAttributes.color,S=b!==void 0?b.length:0,E=l.get(m);if(E===void 0||E.count!==S){let P=function(){Z.dispose(),l.delete(m),m.removeEventListener("dispose",P)};E!==void 0&&E.texture.dispose();let O=m.morphAttributes.position!==void 0,R=m.morphAttributes.normal!==void 0,D=m.morphAttributes.color!==void 0,L=m.morphAttributes.position||[],N=m.morphAttributes.normal||[],U=m.morphAttributes.color||[],F=0;O===!0&&(F=1),R===!0&&(F=2),D===!0&&(F=3);let z=m.attributes.position.count*F,G=1;z>e.maxTextureSize&&(G=Math.ceil(z/e.maxTextureSize),z=e.maxTextureSize);let J=new Float32Array(z*G*4*S),Z=new GI(J,z,G,S);Z.type=I1,Z.needsUpdate=!0;let q=F*4;for(let $=0;$<S;$++){let H=L[$],X=N[$],re=U[$],ae=z*G*4*$;for(let he=0;he<H.count;he++){let pe=he*q;O===!0&&(c.fromBufferAttribute(H,he),H.normalized===!0&&DO(c,H),J[ae+pe+0]=c.x,J[ae+pe+1]=c.y,J[ae+pe+2]=c.z,J[ae+pe+3]=0),R===!0&&(c.fromBufferAttribute(X,he),X.normalized===!0&&DO(c,X),J[ae+pe+4]=c.x,J[ae+pe+5]=c.y,J[ae+pe+6]=c.z,J[ae+pe+7]=0),D===!0&&(c.fromBufferAttribute(re,he),re.normalized===!0&&DO(c,re),J[ae+pe+8]=c.x,J[ae+pe+9]=c.y,J[ae+pe+10]=c.z,J[ae+pe+11]=re.itemSize===4?c.w:1)}}E={count:S,texture:Z,size:new At(z,G)},l.set(m,E),m.addEventListener("dispose",P)}let T=0;for(let P=0;P<_.length;P++)T+=_[P];let A=m.morphTargetsRelative?1:1-T;y.getUniforms().setValue(i,"morphTargetBaseInfluence",A),y.getUniforms().setValue(i,"morphTargetInfluences",_),y.getUniforms().setValue(i,"morphTargetsTexture",E.texture,t),y.getUniforms().setValue(i,"morphTargetsTextureSize",E.size)}else{let b=_===void 0?0:_.length,S=r[m.id];if(S===void 0||S.length!==b){S=[];for(let O=0;O<b;O++)S[O]=[O,0];r[m.id]=S}for(let O=0;O<b;O++){let R=S[O];R[0]=O,R[1]=_[O]}S.sort(Oae);for(let O=0;O<8;O++)O<b&&S[O][1]?(h[O][0]=S[O][0],h[O][1]=S[O][1]):(h[O][0]=Number.MAX_SAFE_INTEGER,h[O][1]=0);h.sort(Lae);let E=m.morphAttributes.position,T=m.morphAttributes.normal,A=0;for(let O=0;O<8;O++){let R=h[O],D=R[0],L=R[1];D!==Number.MAX_SAFE_INTEGER&&L?(E&&m.getAttribute("morphTarget"+O)!==E[D]&&m.setAttribute("morphTarget"+O,E[D]),T&&m.getAttribute("morphNormal"+O)!==T[D]&&m.setAttribute("morphNormal"+O,T[D]),n[O]=L,A+=L):(E&&m.hasAttribute("morphTarget"+O)===!0&&m.deleteAttribute("morphTarget"+O),T&&m.hasAttribute("morphNormal"+O)===!0&&m.deleteAttribute("morphNormal"+O),n[O]=0)}let P=m.morphTargetsRelative?1:1-A;y.getUniforms().setValue(i,"morphTargetBaseInfluence",P),y.getUniforms().setValue(i,"morphTargetInfluences",n)}}return{update:d}}function Dae(i,e,t,r){let n=new WeakMap;function l(d){let f=r.render.frame,m=d.geometry,g=e.get(d,m);return n.get(g)!==f&&(e.update(g),n.set(g,f)),d.isInstancedMesh&&(d.hasEventListener("dispose",h)===!1&&d.addEventListener("dispose",h),t.update(d.instanceMatrix,34962),d.instanceColor!==null&&t.update(d.instanceColor,34962)),g}function c(){n=new WeakMap}function h(d){let f=d.target;f.removeEventListener("dispose",h),t.remove(f.instanceMatrix),f.instanceColor!==null&&t.remove(f.instanceColor)}return{update:l,dispose:c}}var s7=new so,a7=new GI,o7=new Dz,l7=new ZI,Q6=[],eH=[],tH=new Float32Array(16),iH=new Float32Array(9),rH=new Float32Array(4);function hE(i,e,t){let r=i[0];if(r<=0||r>0)return i;let n=e*t,l=Q6[n];if(l===void 0&&(l=new Float32Array(n),Q6[n]=l),e!==0){r.toArray(l,0);for(let c=1,h=0;c!==e;++c)h+=t,i[c].toArray(l,h)}return l}function Zl(i,e){if(i.length!==e.length)return!1;for(let t=0,r=i.length;t<r;t++)if(i[t]!==e[t])return!1;return!0}function Ao(i,e){for(let t=0,r=e.length;t<r;t++)i[t]=e[t]}function YI(i,e){let t=eH[e];t===void 0&&(t=new Int32Array(e),eH[e]=t);for(let r=0;r!==e;++r)t[r]=i.allocateTextureUnit();return t}function kae(i,e){let t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function Fae(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Zl(t,e))return;i.uniform2fv(this.addr,e),Ao(t,e)}}function zae(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Zl(t,e))return;i.uniform3fv(this.addr,e),Ao(t,e)}}function Bae(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Zl(t,e))return;i.uniform4fv(this.addr,e),Ao(t,e)}}function Uae(i,e){let t=this.cache,r=e.elements;if(r===void 0){if(Zl(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),Ao(t,e)}else{if(Zl(t,r))return;rH.set(r),i.uniformMatrix2fv(this.addr,!1,rH),Ao(t,r)}}function Hae(i,e){let t=this.cache,r=e.elements;if(r===void 0){if(Zl(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),Ao(t,e)}else{if(Zl(t,r))return;iH.set(r),i.uniformMatrix3fv(this.addr,!1,iH),Ao(t,r)}}function $ae(i,e){let t=this.cache,r=e.elements;if(r===void 0){if(Zl(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),Ao(t,e)}else{if(Zl(t,r))return;tH.set(r),i.uniformMatrix4fv(this.addr,!1,tH),Ao(t,r)}}function Vae(i,e){let t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function Wae(i,e){let t=this.cache;Zl(t,e)||(i.uniform2iv(this.addr,e),Ao(t,e))}function jae(i,e){let t=this.cache;Zl(t,e)||(i.uniform3iv(this.addr,e),Ao(t,e))}function Gae(i,e){let t=this.cache;Zl(t,e)||(i.uniform4iv(this.addr,e),Ao(t,e))}function qae(i,e){let t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function Xae(i,e){let t=this.cache;Zl(t,e)||(i.uniform2uiv(this.addr,e),Ao(t,e))}function Zae(i,e){let t=this.cache;Zl(t,e)||(i.uniform3uiv(this.addr,e),Ao(t,e))}function Jae(i,e){let t=this.cache;Zl(t,e)||(i.uniform4uiv(this.addr,e),Ao(t,e))}function Yae(i,e,t){let r=this.cache,n=t.allocateTextureUnit();r[0]!==n&&(i.uniform1i(this.addr,n),r[0]=n),t.setTexture2D(e||s7,n)}function Kae(i,e,t){let r=this.cache,n=t.allocateTextureUnit();r[0]!==n&&(i.uniform1i(this.addr,n),r[0]=n),t.setTexture3D(e||o7,n)}function Qae(i,e,t){let r=this.cache,n=t.allocateTextureUnit();r[0]!==n&&(i.uniform1i(this.addr,n),r[0]=n),t.setTextureCube(e||l7,n)}function eoe(i,e,t){let r=this.cache,n=t.allocateTextureUnit();r[0]!==n&&(i.uniform1i(this.addr,n),r[0]=n),t.setTexture2DArray(e||a7,n)}function toe(i){switch(i){case 5126:return kae;case 35664:return Fae;case 35665:return zae;case 35666:return Bae;case 35674:return Uae;case 35675:return Hae;case 35676:return $ae;case 5124:case 35670:return Vae;case 35667:case 35671:return Wae;case 35668:case 35672:return jae;case 35669:case 35673:return Gae;case 5125:return qae;case 36294:return Xae;case 36295:return Zae;case 36296:return Jae;case 35678:case 36198:case 36298:case 36306:case 35682:return Yae;case 35679:case 36299:case 36307:return Kae;case 35680:case 36300:case 36308:case 36293:return Qae;case 36289:case 36303:case 36311:case 36292:return eoe}}function ioe(i,e){i.uniform1fv(this.addr,e)}function roe(i,e){let t=hE(e,this.size,2);i.uniform2fv(this.addr,t)}function noe(i,e){let t=hE(e,this.size,3);i.uniform3fv(this.addr,t)}function soe(i,e){let t=hE(e,this.size,4);i.uniform4fv(this.addr,t)}function aoe(i,e){let t=hE(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function ooe(i,e){let t=hE(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function loe(i,e){let t=hE(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function uoe(i,e){i.uniform1iv(this.addr,e)}function coe(i,e){i.uniform2iv(this.addr,e)}function hoe(i,e){i.uniform3iv(this.addr,e)}function doe(i,e){i.uniform4iv(this.addr,e)}function foe(i,e){i.uniform1uiv(this.addr,e)}function poe(i,e){i.uniform2uiv(this.addr,e)}function moe(i,e){i.uniform3uiv(this.addr,e)}function goe(i,e){i.uniform4uiv(this.addr,e)}function voe(i,e,t){let r=e.length,n=YI(t,r);i.uniform1iv(this.addr,n);for(let l=0;l!==r;++l)t.setTexture2D(e[l]||s7,n[l])}function yoe(i,e,t){let r=e.length,n=YI(t,r);i.uniform1iv(this.addr,n);for(let l=0;l!==r;++l)t.setTexture3D(e[l]||o7,n[l])}function _oe(i,e,t){let r=e.length,n=YI(t,r);i.uniform1iv(this.addr,n);for(let l=0;l!==r;++l)t.setTextureCube(e[l]||l7,n[l])}function xoe(i,e,t){let r=e.length,n=YI(t,r);i.uniform1iv(this.addr,n);for(let l=0;l!==r;++l)t.setTexture2DArray(e[l]||a7,n[l])}function boe(i){switch(i){case 5126:return ioe;case 35664:return roe;case 35665:return noe;case 35666:return soe;case 35674:return aoe;case 35675:return ooe;case 35676:return loe;case 5124:case 35670:return uoe;case 35667:case 35671:return coe;case 35668:case 35672:return hoe;case 35669:case 35673:return doe;case 5125:return foe;case 36294:return poe;case 36295:return moe;case 36296:return goe;case 35678:case 36198:case 36298:case 36306:case 35682:return voe;case 35679:case 36299:case 36307:return yoe;case 35680:case 36300:case 36308:case 36293:return _oe;case 36289:case 36303:case 36311:case 36292:return xoe}}function woe(i,e,t){this.id=i,this.addr=t,this.cache=[],this.setValue=toe(e.type)}function u7(i,e,t){this.id=i,this.addr=t,this.cache=[],this.size=e.size,this.setValue=boe(e.type)}u7.prototype.updateCache=function(i){let e=this.cache;i instanceof Float32Array&&e.length!==i.length&&(this.cache=new Float32Array(i.length)),Ao(e,i)};function c7(i){this.id=i,this.seq=[],this.map={}}c7.prototype.setValue=function(i,e,t){let r=this.seq;for(let n=0,l=r.length;n!==l;++n){let c=r[n];c.setValue(i,e[c.id],t)}};var kO=/(\w+)(\])?(\[|\.)?/g;function nH(i,e){i.seq.push(e),i.map[e.id]=e}function Soe(i,e,t){let r=i.name,n=r.length;for(kO.lastIndex=0;;){let l=kO.exec(r),c=kO.lastIndex,h=l[1],d=l[2]==="]",f=l[3];if(d&&(h=h|0),f===void 0||f==="["&&c+2===n){nH(t,f===void 0?new woe(h,i,e):new u7(h,i,e));break}else{let m=t.map[h];m===void 0&&(m=new c7(h),nH(t,m)),t=m}}}function Hm(i,e){this.seq=[],this.map={};let t=i.getProgramParameter(e,35718);for(let r=0;r<t;++r){let n=i.getActiveUniform(e,r),l=i.getUniformLocation(e,n.name);Soe(n,l,this)}}Hm.prototype.setValue=function(i,e,t,r){let n=this.map[e];n!==void 0&&n.setValue(i,t,r)};Hm.prototype.setOptional=function(i,e,t){let r=e[t];r!==void 0&&this.setValue(i,t,r)};Hm.upload=function(i,e,t,r){for(let n=0,l=e.length;n!==l;++n){let c=e[n],h=t[c.id];h.needsUpdate!==!1&&c.setValue(i,h.value,r)}};Hm.seqWithValue=function(i,e){let t=[];for(let r=0,n=i.length;r!==n;++r){let l=i[r];l.id in e&&t.push(l)}return t};function sH(i,e,t){let r=i.createShader(e);return i.shaderSource(r,t),i.compileShader(r),r}var Moe=0;function Eoe(i,e){let t=i.split(`
`),r=[],n=Math.max(e-6,0),l=Math.min(e+6,t.length);for(let c=n;c<l;c++)r.push(c+1+": "+t[c]);return r.join(`
`)}function Toe(i){switch(i){case Tp:return["Linear","( value )"];case jn:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",i),["Linear","( value )"]}}function aH(i,e,t){let r=i.getShaderParameter(e,35713),n=i.getShaderInfoLog(e).trim();if(r&&n==="")return"";let l=parseInt(/ERROR: 0:(\d+)/.exec(n)[1]);return t.toUpperCase()+`

`+n+`

`+Eoe(i.getShaderSource(e),l)}function Aoe(i,e){let t=Toe(e);return"vec4 "+i+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function Coe(i,e){let t;switch(e){case Zie:t="Linear";break;case Jie:t="Reinhard";break;case Yie:t="OptimizedCineon";break;case Kie:t="ACESFilmic";break;case Qie:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Poe(i){return[i.extensionDerivatives||i.envMapCubeUVHeight||i.bumpMap||i.tangentSpaceNormalMap||i.clearcoatNormalMap||i.flatShading||i.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(i.extensionFragDepth||i.logarithmicDepthBuffer)&&i.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",i.extensionDrawBuffers&&i.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(i.extensionShaderTextureLOD||i.envMap||i.transmission)&&i.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(OT).join(`
`)}function Roe(i){let e=[];for(let t in i){let r=i[t];r!==!1&&e.push("#define "+t+" "+r)}return e.join(`
`)}function Ioe(i,e){let t={},r=i.getProgramParameter(e,35721);for(let n=0;n<r;n++){let l=i.getActiveAttrib(e,n),c=l.name,h=1;l.type===35674&&(h=2),l.type===35675&&(h=3),l.type===35676&&(h=4),t[c]={type:l.type,location:i.getAttribLocation(e,c),locationSize:h}}return t}function OT(i){return i!==""}function oH(i,e){return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function lH(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var Loe=/^[ \t]*#include +<([\w\d./]+)>/gm;function sF(i){return i.replace(Loe,Ooe)}function Ooe(i,e){let t=wr[e];if(t===void 0)throw new Error("Can not resolve #include <"+e+">");return sF(t)}var Noe=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Doe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function uH(i){return i.replace(Doe,h7).replace(Noe,koe)}function koe(i,e,t,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),h7(i,e,t,r)}function h7(i,e,t,r){let n="";for(let l=parseInt(e);l<parseInt(t);l++)n+=r.replace(/\[\s*i\s*\]/g,"[ "+l+" ]").replace(/UNROLLED_LOOP_INDEX/g,l);return n}function cH(i){let e="precision "+i.precision+` float;
precision `+i.precision+" int;";return i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Foe(i){let e="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===V8?e="SHADOWMAP_TYPE_PCF":i.shadowMapType===Aie?e="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===LT&&(e="SHADOWMAP_TYPE_VSM"),e}function zoe(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case DM:case kM:e="ENVMAP_TYPE_CUBE";break;case WI:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Boe(i){let e="ENVMAP_MODE_REFLECTION";if(i.envMap)switch(i.envMapMode){case kM:e="ENVMAP_MODE_REFRACTION";break}return e}function Uoe(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case VI:e="ENVMAP_BLENDING_MULTIPLY";break;case qie:e="ENVMAP_BLENDING_MIX";break;case Xie:e="ENVMAP_BLENDING_ADD";break}return e}function Hoe(i){let e=i.envMapCubeUVHeight;if(e===null)return null;let t=Math.log2(e/32+1)+3,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:r,maxMip:t}}function $oe(i,e,t,r){let n=i.getContext(),l=t.defines,c=t.vertexShader,h=t.fragmentShader,d=Foe(t),f=zoe(t),m=Boe(t),g=Uoe(t),y=Hoe(t),_=t.isWebGL2?"":Poe(t),b=Roe(l),S=n.createProgram(),E,T,A=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(E=[b].filter(OT).join(`
`),E.length>0&&(E+=`
`),T=[_,b].filter(OT).join(`
`),T.length>0&&(T+=`
`)):(E=[cH(t),"#define SHADER_NAME "+t.shaderName,b,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define MAX_BONES "+t.maxBones,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+m:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.useVertexTexture?"#define BONE_TEXTURE":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(OT).join(`
`),T=[_,cH(t),"#define SHADER_NAME "+t.shaderName,b,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+f:"",t.envMap?"#define "+m:"",t.envMap?"#define "+g:"",y?"#define CUBEUV_TEXEL_WIDTH "+y.texelWidth:"",y?"#define CUBEUV_TEXEL_HEIGHT "+y.texelHeight:"",y?"#define CUBEUV_MAX_MIP "+y.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==vp?"#define TONE_MAPPING":"",t.toneMapping!==vp?wr.tonemapping_pars_fragment:"",t.toneMapping!==vp?Coe("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",wr.encodings_pars_fragment,Aoe("linearToOutputTexel",t.outputEncoding),t.depthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(OT).join(`
`)),c=sF(c),c=oH(c,t),c=lH(c,t),h=sF(h),h=oH(h,t),h=lH(h,t),c=uH(c),h=uH(h),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(A=`#version 300 es
`,E=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+E,T=["#define varying in",t.glslVersion===O6?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===O6?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+T);let P=A+E+c,O=A+T+h,R=sH(n,35633,P),D=sH(n,35632,O);if(n.attachShader(S,R),n.attachShader(S,D),t.index0AttributeName!==void 0?n.bindAttribLocation(S,0,t.index0AttributeName):t.morphTargets===!0&&n.bindAttribLocation(S,0,"position"),n.linkProgram(S),i.debug.checkShaderErrors){let U=n.getProgramInfoLog(S).trim(),F=n.getShaderInfoLog(R).trim(),z=n.getShaderInfoLog(D).trim(),G=!0,J=!0;if(n.getProgramParameter(S,35714)===!1){G=!1;let Z=aH(n,R,"vertex"),q=aH(n,D,"fragment");console.error("THREE.WebGLProgram: Shader Error "+n.getError()+" - VALIDATE_STATUS "+n.getProgramParameter(S,35715)+`

Program Info Log: `+U+`
`+Z+`
`+q)}else U!==""?console.warn("THREE.WebGLProgram: Program Info Log:",U):(F===""||z==="")&&(J=!1);J&&(this.diagnostics={runnable:G,programLog:U,vertexShader:{log:F,prefix:E},fragmentShader:{log:z,prefix:T}})}n.deleteShader(R),n.deleteShader(D);let L;this.getUniforms=function(){return L===void 0&&(L=new Hm(n,S)),L};let N;return this.getAttributes=function(){return N===void 0&&(N=Ioe(n,S)),N},this.destroy=function(){r.releaseStatesOfProgram(this),n.deleteProgram(S),this.program=void 0},this.name=t.shaderName,this.id=Moe++,this.cacheKey=e,this.usedTimes=1,this.program=S,this.vertexShader=R,this.fragmentShader=D,this}var Voe=0,Woe=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(i){let e=i.vertexShader,t=i.fragmentShader,r=this._getShaderStage(e),n=this._getShaderStage(t),l=this._getShaderCacheForMaterial(i);return l.has(r)===!1&&(l.add(r),r.usedTimes++),l.has(n)===!1&&(l.add(n),n.usedTimes++),this}remove(i){let e=this.materialCache.get(i);for(let t of e)t.usedTimes--,t.usedTimes===0&&this.shaderCache.delete(t.code);return this.materialCache.delete(i),this}getVertexShaderID(i){return this._getShaderStage(i.vertexShader).id}getFragmentShaderID(i){return this._getShaderStage(i.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(i){let e=this.materialCache;return e.has(i)===!1&&e.set(i,new Set),e.get(i)}_getShaderStage(i){let e=this.shaderCache;if(e.has(i)===!1){let t=new joe(i);e.set(i,t)}return e.get(i)}},joe=class{constructor(i){this.id=Voe++,this.code=i,this.usedTimes=0}};function Goe(i,e,t,r,n,l,c){let h=new Q8,d=new Woe,f=[],m=n.isWebGL2,g=n.logarithmicDepthBuffer,y=n.floatVertexTextures,_=n.maxVertexUniforms,b=n.vertexTextures,S=n.precision,E={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function T(z){let G=z.skeleton.bones;if(y)return 1024;{let J=Math.floor((_-20)/4),Z=Math.min(J,G.length);return Z<G.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+G.length+" bones. This GPU supports "+Z+"."),0):Z}}function A(z,G,J,Z,q){let $=Z.fog,H=q.geometry,X=z.isMeshStandardMaterial?Z.environment:null,re=(z.isMeshStandardMaterial?t:e).get(z.envMap||X),ae=re&&re.mapping===WI?re.image.height:null,he=E[z.type],pe=q.isSkinnedMesh?T(q):0;z.precision!==null&&(S=n.getMaxPrecision(z.precision),S!==z.precision&&console.warn("THREE.WebGLProgram.getParameters:",z.precision,"not supported, using",S,"instead."));let de=H.morphAttributes.position||H.morphAttributes.normal||H.morphAttributes.color,ee=de!==void 0?de.length:0,se=0;H.morphAttributes.position!==void 0&&(se=1),H.morphAttributes.normal!==void 0&&(se=2),H.morphAttributes.color!==void 0&&(se=3);let Y,fe,me,De;if(he){let Ue=hf[he];Y=Ue.vertexShader,fe=Ue.fragmentShader}else Y=z.vertexShader,fe=z.fragmentShader,d.update(z),me=d.getVertexShaderID(z),De=d.getFragmentShaderID(z);let Le=i.getRenderTarget(),Ce=z.alphaTest>0,Ae=z.clearcoat>0;return{isWebGL2:m,shaderID:he,shaderName:z.type,vertexShader:Y,fragmentShader:fe,defines:z.defines,customVertexShaderID:me,customFragmentShaderID:De,isRawShaderMaterial:z.isRawShaderMaterial===!0,glslVersion:z.glslVersion,precision:S,instancing:q.isInstancedMesh===!0,instancingColor:q.isInstancedMesh===!0&&q.instanceColor!==null,supportsVertexTextures:b,outputEncoding:Le===null?i.outputEncoding:Le.isXRRenderTarget===!0?Le.texture.encoding:Tp,map:!!z.map,matcap:!!z.matcap,envMap:!!re,envMapMode:re&&re.mapping,envMapCubeUVHeight:ae,lightMap:!!z.lightMap,aoMap:!!z.aoMap,emissiveMap:!!z.emissiveMap,bumpMap:!!z.bumpMap,normalMap:!!z.normalMap,objectSpaceNormalMap:z.normalMapType===wre,tangentSpaceNormalMap:z.normalMapType===oE,decodeVideoTexture:!!z.map&&z.map.isVideoTexture===!0&&z.map.encoding===jn,clearcoat:Ae,clearcoatMap:Ae&&!!z.clearcoatMap,clearcoatRoughnessMap:Ae&&!!z.clearcoatRoughnessMap,clearcoatNormalMap:Ae&&!!z.clearcoatNormalMap,displacementMap:!!z.displacementMap,roughnessMap:!!z.roughnessMap,metalnessMap:!!z.metalnessMap,specularMap:!!z.specularMap,specularIntensityMap:!!z.specularIntensityMap,specularColorMap:!!z.specularColorMap,opaque:z.transparent===!1&&z.blending===fM,alphaMap:!!z.alphaMap,alphaTest:Ce,gradientMap:!!z.gradientMap,sheen:z.sheen>0,sheenColorMap:!!z.sheenColorMap,sheenRoughnessMap:!!z.sheenRoughnessMap,transmission:z.transmission>0,transmissionMap:!!z.transmissionMap,thicknessMap:!!z.thicknessMap,combine:z.combine,vertexTangents:!!z.normalMap&&!!H.attributes.tangent,vertexColors:z.vertexColors,vertexAlphas:z.vertexColors===!0&&!!H.attributes.color&&H.attributes.color.itemSize===4,vertexUvs:!!z.map||!!z.bumpMap||!!z.normalMap||!!z.specularMap||!!z.alphaMap||!!z.emissiveMap||!!z.roughnessMap||!!z.metalnessMap||!!z.clearcoatMap||!!z.clearcoatRoughnessMap||!!z.clearcoatNormalMap||!!z.displacementMap||!!z.transmissionMap||!!z.thicknessMap||!!z.specularIntensityMap||!!z.specularColorMap||!!z.sheenColorMap||!!z.sheenRoughnessMap,uvsVertexOnly:!(z.map||z.bumpMap||z.normalMap||z.specularMap||z.alphaMap||z.emissiveMap||z.roughnessMap||z.metalnessMap||z.clearcoatNormalMap||z.transmission>0||z.transmissionMap||z.thicknessMap||z.specularIntensityMap||z.specularColorMap||z.sheen>0||z.sheenColorMap||z.sheenRoughnessMap)&&!!z.displacementMap,fog:!!$,useFog:z.fog,fogExp2:$&&$.isFogExp2,flatShading:!!z.flatShading,sizeAttenuation:z.sizeAttenuation,logarithmicDepthBuffer:g,skinning:q.isSkinnedMesh===!0&&pe>0,maxBones:pe,useVertexTexture:y,morphTargets:H.morphAttributes.position!==void 0,morphNormals:H.morphAttributes.normal!==void 0,morphColors:H.morphAttributes.color!==void 0,morphTargetsCount:ee,morphTextureStride:se,numDirLights:G.directional.length,numPointLights:G.point.length,numSpotLights:G.spot.length,numRectAreaLights:G.rectArea.length,numHemiLights:G.hemi.length,numDirLightShadows:G.directionalShadowMap.length,numPointLightShadows:G.pointShadowMap.length,numSpotLightShadows:G.spotShadowMap.length,numClippingPlanes:c.numPlanes,numClipIntersection:c.numIntersection,dithering:z.dithering,shadowMapEnabled:i.shadowMap.enabled&&J.length>0,shadowMapType:i.shadowMap.type,toneMapping:z.toneMapped?i.toneMapping:vp,physicallyCorrectLights:i.physicallyCorrectLights,premultipliedAlpha:z.premultipliedAlpha,doubleSided:z.side===NM,flipSided:z.side===Vd,depthPacking:z.depthPacking!==void 0?z.depthPacking:!1,index0AttributeName:z.index0AttributeName,extensionDerivatives:z.extensions&&z.extensions.derivatives,extensionFragDepth:z.extensions&&z.extensions.fragDepth,extensionDrawBuffers:z.extensions&&z.extensions.drawBuffers,extensionShaderTextureLOD:z.extensions&&z.extensions.shaderTextureLOD,rendererExtensionFragDepth:m||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:m||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:m||r.has("EXT_shader_texture_lod"),customProgramCacheKey:z.customProgramCacheKey()}}function P(z){let G=[];if(z.shaderID?G.push(z.shaderID):(G.push(z.customVertexShaderID),G.push(z.customFragmentShaderID)),z.defines!==void 0)for(let J in z.defines)G.push(J),G.push(z.defines[J]);return z.isRawShaderMaterial===!1&&(O(G,z),R(G,z),G.push(i.outputEncoding)),G.push(z.customProgramCacheKey),G.join()}function O(z,G){z.push(G.precision),z.push(G.outputEncoding),z.push(G.envMapMode),z.push(G.envMapCubeUVHeight),z.push(G.combine),z.push(G.vertexUvs),z.push(G.fogExp2),z.push(G.sizeAttenuation),z.push(G.maxBones),z.push(G.morphTargetsCount),z.push(G.morphAttributeCount),z.push(G.numDirLights),z.push(G.numPointLights),z.push(G.numSpotLights),z.push(G.numHemiLights),z.push(G.numRectAreaLights),z.push(G.numDirLightShadows),z.push(G.numPointLightShadows),z.push(G.numSpotLightShadows),z.push(G.shadowMapType),z.push(G.toneMapping),z.push(G.numClippingPlanes),z.push(G.numClipIntersection)}function R(z,G){h.disableAll(),G.isWebGL2&&h.enable(0),G.supportsVertexTextures&&h.enable(1),G.instancing&&h.enable(2),G.instancingColor&&h.enable(3),G.map&&h.enable(4),G.matcap&&h.enable(5),G.envMap&&h.enable(6),G.lightMap&&h.enable(7),G.aoMap&&h.enable(8),G.emissiveMap&&h.enable(9),G.bumpMap&&h.enable(10),G.normalMap&&h.enable(11),G.objectSpaceNormalMap&&h.enable(12),G.tangentSpaceNormalMap&&h.enable(13),G.clearcoat&&h.enable(14),G.clearcoatMap&&h.enable(15),G.clearcoatRoughnessMap&&h.enable(16),G.clearcoatNormalMap&&h.enable(17),G.displacementMap&&h.enable(18),G.specularMap&&h.enable(19),G.roughnessMap&&h.enable(20),G.metalnessMap&&h.enable(21),G.gradientMap&&h.enable(22),G.alphaMap&&h.enable(23),G.alphaTest&&h.enable(24),G.vertexColors&&h.enable(25),G.vertexAlphas&&h.enable(26),G.vertexUvs&&h.enable(27),G.vertexTangents&&h.enable(28),G.uvsVertexOnly&&h.enable(29),G.fog&&h.enable(30),z.push(h.mask),h.disableAll(),G.useFog&&h.enable(0),G.flatShading&&h.enable(1),G.logarithmicDepthBuffer&&h.enable(2),G.skinning&&h.enable(3),G.useVertexTexture&&h.enable(4),G.morphTargets&&h.enable(5),G.morphNormals&&h.enable(6),G.morphColors&&h.enable(7),G.premultipliedAlpha&&h.enable(8),G.shadowMapEnabled&&h.enable(9),G.physicallyCorrectLights&&h.enable(10),G.doubleSided&&h.enable(11),G.flipSided&&h.enable(12),G.depthPacking&&h.enable(13),G.dithering&&h.enable(14),G.specularIntensityMap&&h.enable(15),G.specularColorMap&&h.enable(16),G.transmission&&h.enable(17),G.transmissionMap&&h.enable(18),G.thicknessMap&&h.enable(19),G.sheen&&h.enable(20),G.sheenColorMap&&h.enable(21),G.sheenRoughnessMap&&h.enable(22),G.decodeVideoTexture&&h.enable(23),G.opaque&&h.enable(24),z.push(h.mask)}function D(z){let G=E[z.type],J;if(G){let Z=hf[G];J=Ure.clone(Z.uniforms)}else J=z.uniforms;return J}function L(z,G){let J;for(let Z=0,q=f.length;Z<q;Z++){let $=f[Z];if($.cacheKey===G){J=$,++J.usedTimes;break}}return J===void 0&&(J=new $oe(i,G,z,l),f.push(J)),J}function N(z){if(--z.usedTimes===0){let G=f.indexOf(z);f[G]=f[f.length-1],f.pop(),z.destroy()}}function U(z){d.remove(z)}function F(){d.dispose()}return{getParameters:A,getProgramCacheKey:P,getUniforms:D,acquireProgram:L,releaseProgram:N,releaseShaderCache:U,programs:f,dispose:F}}function qoe(){let i=new WeakMap;function e(l){let c=i.get(l);return c===void 0&&(c={},i.set(l,c)),c}function t(l){i.delete(l)}function r(l,c,h){i.get(l)[c]=h}function n(){i=new WeakMap}return{get:e,remove:t,update:r,dispose:n}}function Xoe(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function hH(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function dH(){let i=[],e=0,t=[],r=[],n=[];function l(){e=0,t.length=0,r.length=0,n.length=0}function c(g,y,_,b,S,E){let T=i[e];return T===void 0?(T={id:g.id,object:g,geometry:y,material:_,groupOrder:b,renderOrder:g.renderOrder,z:S,group:E},i[e]=T):(T.id=g.id,T.object=g,T.geometry=y,T.material=_,T.groupOrder=b,T.renderOrder=g.renderOrder,T.z=S,T.group=E),e++,T}function h(g,y,_,b,S,E){let T=c(g,y,_,b,S,E);_.transmission>0?r.push(T):_.transparent===!0?n.push(T):t.push(T)}function d(g,y,_,b,S,E){let T=c(g,y,_,b,S,E);_.transmission>0?r.unshift(T):_.transparent===!0?n.unshift(T):t.unshift(T)}function f(g,y){t.length>1&&t.sort(g||Xoe),r.length>1&&r.sort(y||hH),n.length>1&&n.sort(y||hH)}function m(){for(let g=e,y=i.length;g<y;g++){let _=i[g];if(_.id===null)break;_.id=null,_.object=null,_.geometry=null,_.material=null,_.group=null}}return{opaque:t,transmissive:r,transparent:n,init:l,push:h,unshift:d,finish:m,sort:f}}function Zoe(){let i=new WeakMap;function e(r,n){let l;return i.has(r)===!1?(l=new dH,i.set(r,[l])):n>=i.get(r).length?(l=new dH,i.get(r).push(l)):l=i.get(r)[n],l}function t(){i=new WeakMap}return{get:e,dispose:t}}function Joe(){let i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Te,color:new Ei};break;case"SpotLight":t={position:new Te,direction:new Te,color:new Ei,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Te,color:new Ei,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Te,skyColor:new Ei,groundColor:new Ei};break;case"RectAreaLight":t={color:new Ei,position:new Te,halfWidth:new Te,halfHeight:new Te};break}return i[e.id]=t,t}}}function Yoe(){let i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new At};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new At};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new At,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=t,t}}}var Koe=0;function Qoe(i,e){return(e.castShadow?1:0)-(i.castShadow?1:0)}function ele(i,e){let t=new Joe,r=Yoe(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let m=0;m<9;m++)n.probe.push(new Te);let l=new Te,c=new Bi,h=new Bi;function d(m,g){let y=0,_=0,b=0;for(let U=0;U<9;U++)n.probe[U].set(0,0,0);let S=0,E=0,T=0,A=0,P=0,O=0,R=0,D=0;m.sort(Qoe);let L=g!==!0?Math.PI:1;for(let U=0,F=m.length;U<F;U++){let z=m[U],G=z.color,J=z.intensity,Z=z.distance,q=z.shadow&&z.shadow.map?z.shadow.map.texture:null;if(z.isAmbientLight)y+=G.r*J*L,_+=G.g*J*L,b+=G.b*J*L;else if(z.isLightProbe)for(let $=0;$<9;$++)n.probe[$].addScaledVector(z.sh.coefficients[$],J);else if(z.isDirectionalLight){let $=t.get(z);if($.color.copy(z.color).multiplyScalar(z.intensity*L),z.castShadow){let H=z.shadow,X=r.get(z);X.shadowBias=H.bias,X.shadowNormalBias=H.normalBias,X.shadowRadius=H.radius,X.shadowMapSize=H.mapSize,n.directionalShadow[S]=X,n.directionalShadowMap[S]=q,n.directionalShadowMatrix[S]=z.shadow.matrix,O++}n.directional[S]=$,S++}else if(z.isSpotLight){let $=t.get(z);if($.position.setFromMatrixPosition(z.matrixWorld),$.color.copy(G).multiplyScalar(J*L),$.distance=Z,$.coneCos=Math.cos(z.angle),$.penumbraCos=Math.cos(z.angle*(1-z.penumbra)),$.decay=z.decay,z.castShadow){let H=z.shadow,X=r.get(z);X.shadowBias=H.bias,X.shadowNormalBias=H.normalBias,X.shadowRadius=H.radius,X.shadowMapSize=H.mapSize,n.spotShadow[T]=X,n.spotShadowMap[T]=q,n.spotShadowMatrix[T]=z.shadow.matrix,D++}n.spot[T]=$,T++}else if(z.isRectAreaLight){let $=t.get(z);$.color.copy(G).multiplyScalar(J),$.halfWidth.set(z.width*.5,0,0),$.halfHeight.set(0,z.height*.5,0),n.rectArea[A]=$,A++}else if(z.isPointLight){let $=t.get(z);if($.color.copy(z.color).multiplyScalar(z.intensity*L),$.distance=z.distance,$.decay=z.decay,z.castShadow){let H=z.shadow,X=r.get(z);X.shadowBias=H.bias,X.shadowNormalBias=H.normalBias,X.shadowRadius=H.radius,X.shadowMapSize=H.mapSize,X.shadowCameraNear=H.camera.near,X.shadowCameraFar=H.camera.far,n.pointShadow[E]=X,n.pointShadowMap[E]=q,n.pointShadowMatrix[E]=z.shadow.matrix,R++}n.point[E]=$,E++}else if(z.isHemisphereLight){let $=t.get(z);$.skyColor.copy(z.color).multiplyScalar(J*L),$.groundColor.copy(z.groundColor).multiplyScalar(J*L),n.hemi[P]=$,P++}}A>0&&(e.isWebGL2||i.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=qt.LTC_FLOAT_1,n.rectAreaLTC2=qt.LTC_FLOAT_2):i.has("OES_texture_half_float_linear")===!0?(n.rectAreaLTC1=qt.LTC_HALF_1,n.rectAreaLTC2=qt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),n.ambient[0]=y,n.ambient[1]=_,n.ambient[2]=b;let N=n.hash;(N.directionalLength!==S||N.pointLength!==E||N.spotLength!==T||N.rectAreaLength!==A||N.hemiLength!==P||N.numDirectionalShadows!==O||N.numPointShadows!==R||N.numSpotShadows!==D)&&(n.directional.length=S,n.spot.length=T,n.rectArea.length=A,n.point.length=E,n.hemi.length=P,n.directionalShadow.length=O,n.directionalShadowMap.length=O,n.pointShadow.length=R,n.pointShadowMap.length=R,n.spotShadow.length=D,n.spotShadowMap.length=D,n.directionalShadowMatrix.length=O,n.pointShadowMatrix.length=R,n.spotShadowMatrix.length=D,N.directionalLength=S,N.pointLength=E,N.spotLength=T,N.rectAreaLength=A,N.hemiLength=P,N.numDirectionalShadows=O,N.numPointShadows=R,N.numSpotShadows=D,n.version=Koe++)}function f(m,g){let y=0,_=0,b=0,S=0,E=0,T=g.matrixWorldInverse;for(let A=0,P=m.length;A<P;A++){let O=m[A];if(O.isDirectionalLight){let R=n.directional[y];R.direction.setFromMatrixPosition(O.matrixWorld),l.setFromMatrixPosition(O.target.matrixWorld),R.direction.sub(l),R.direction.transformDirection(T),y++}else if(O.isSpotLight){let R=n.spot[b];R.position.setFromMatrixPosition(O.matrixWorld),R.position.applyMatrix4(T),R.direction.setFromMatrixPosition(O.matrixWorld),l.setFromMatrixPosition(O.target.matrixWorld),R.direction.sub(l),R.direction.transformDirection(T),b++}else if(O.isRectAreaLight){let R=n.rectArea[S];R.position.setFromMatrixPosition(O.matrixWorld),R.position.applyMatrix4(T),h.identity(),c.copy(O.matrixWorld),c.premultiply(T),h.extractRotation(c),R.halfWidth.set(O.width*.5,0,0),R.halfHeight.set(0,O.height*.5,0),R.halfWidth.applyMatrix4(h),R.halfHeight.applyMatrix4(h),S++}else if(O.isPointLight){let R=n.point[_];R.position.setFromMatrixPosition(O.matrixWorld),R.position.applyMatrix4(T),_++}else if(O.isHemisphereLight){let R=n.hemi[E];R.direction.setFromMatrixPosition(O.matrixWorld),R.direction.transformDirection(T),R.direction.normalize(),E++}}}return{setup:d,setupView:f,state:n}}function fH(i,e){let t=new ele(i,e),r=[],n=[];function l(){r.length=0,n.length=0}function c(m){r.push(m)}function h(m){n.push(m)}function d(m){t.setup(r,m)}function f(m){t.setupView(r,m)}return{init:l,state:{lightsArray:r,shadowsArray:n,lights:t},setupLights:d,setupLightsView:f,pushLight:c,pushShadow:h}}function tle(i,e){let t=new WeakMap;function r(l,c=0){let h;return t.has(l)===!1?(h=new fH(i,e),t.set(l,[h])):c>=t.get(l).length?(h=new fH(i,e),t.get(l).push(h)):h=t.get(l)[c],h}function n(){t=new WeakMap}return{get:r,dispose:n}}var Uz=class extends za{constructor(i){super(),this.type="MeshDepthMaterial",this.depthPacking=xre,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(i)}copy(i){return super.copy(i),this.depthPacking=i.depthPacking,this.map=i.map,this.alphaMap=i.alphaMap,this.displacementMap=i.displacementMap,this.displacementScale=i.displacementScale,this.displacementBias=i.displacementBias,this.wireframe=i.wireframe,this.wireframeLinewidth=i.wireframeLinewidth,this}};Uz.prototype.isMeshDepthMaterial=!0;var Hz=class extends za{constructor(i){super(),this.type="MeshDistanceMaterial",this.referencePosition=new Te,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(i)}copy(i){return super.copy(i),this.referencePosition.copy(i.referencePosition),this.nearDistance=i.nearDistance,this.farDistance=i.farDistance,this.map=i.map,this.alphaMap=i.alphaMap,this.displacementMap=i.displacementMap,this.displacementScale=i.displacementScale,this.displacementBias=i.displacementBias,this}};Hz.prototype.isMeshDistanceMaterial=!0;var ile=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,rle=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function d7(i,e,t){let r=new JI,n=new At,l=new At,c=new wn,h=new Uz({depthPacking:bre}),d=new Hz,f={},m=t.maxTextureSize,g={0:Vd,1:TA,2:NM},y=new Xd({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new At},radius:{value:4}},vertexShader:ile,fragmentShader:rle}),_=y.clone();_.defines.HORIZONTAL_PASS=1;let b=new vs;b.setAttribute("position",new Da(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let S=new cu(b,y),E=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=V8,this.render=function(O,R,D){if(E.enabled===!1||E.autoUpdate===!1&&E.needsUpdate===!1||O.length===0)return;let L=i.getRenderTarget(),N=i.getActiveCubeFace(),U=i.getActiveMipmapLevel(),F=i.state;F.setBlending(Um),F.buffers.color.setClear(1,1,1,1),F.buffers.depth.setTest(!0),F.setScissorTest(!1);for(let z=0,G=O.length;z<G;z++){let J=O[z],Z=J.shadow;if(Z===void 0){console.warn("THREE.WebGLShadowMap:",J,"has no shadow.");continue}if(Z.autoUpdate===!1&&Z.needsUpdate===!1)continue;n.copy(Z.mapSize);let q=Z.getFrameExtents();if(n.multiply(q),l.copy(Z.mapSize),(n.x>m||n.y>m)&&(n.x>m&&(l.x=Math.floor(m/q.x),n.x=l.x*q.x,Z.mapSize.x=l.x),n.y>m&&(l.y=Math.floor(m/q.y),n.y=l.y*q.y,Z.mapSize.y=l.y)),Z.map===null&&!Z.isPointLightShadow&&this.type===LT&&(Z.map=new Nu(n.x,n.y),Z.map.texture.name=J.name+".shadowMap",Z.mapPass=new Nu(n.x,n.y),Z.camera.updateProjectionMatrix()),Z.map===null){let H={minFilter:Ga,magFilter:Ga,format:Bd};Z.map=new Nu(n.x,n.y,H),Z.map.texture.name=J.name+".shadowMap",Z.camera.updateProjectionMatrix()}i.setRenderTarget(Z.map),i.clear();let $=Z.getViewportCount();for(let H=0;H<$;H++){let X=Z.getViewport(H);c.set(l.x*X.x,l.y*X.y,l.x*X.z,l.y*X.w),F.viewport(c),Z.updateMatrices(J,H),r=Z.getFrustum(),P(R,D,Z.camera,J,this.type)}!Z.isPointLightShadow&&this.type===LT&&T(Z,D),Z.needsUpdate=!1}E.needsUpdate=!1,i.setRenderTarget(L,N,U)};function T(O,R){let D=e.update(S);y.defines.VSM_SAMPLES!==O.blurSamples&&(y.defines.VSM_SAMPLES=O.blurSamples,_.defines.VSM_SAMPLES=O.blurSamples,y.needsUpdate=!0,_.needsUpdate=!0),y.uniforms.shadow_pass.value=O.map.texture,y.uniforms.resolution.value=O.mapSize,y.uniforms.radius.value=O.radius,i.setRenderTarget(O.mapPass),i.clear(),i.renderBufferDirect(R,null,D,y,S,null),_.uniforms.shadow_pass.value=O.mapPass.texture,_.uniforms.resolution.value=O.mapSize,_.uniforms.radius.value=O.radius,i.setRenderTarget(O.map),i.clear(),i.renderBufferDirect(R,null,D,_,S,null)}function A(O,R,D,L,N,U){let F=null,z=D.isPointLight===!0?O.customDistanceMaterial:O.customDepthMaterial;if(z!==void 0?F=z:F=D.isPointLight===!0?d:h,i.localClippingEnabled&&R.clipShadows===!0&&R.clippingPlanes.length!==0||R.displacementMap&&R.displacementScale!==0||R.alphaMap&&R.alphaTest>0){let G=F.uuid,J=R.uuid,Z=f[G];Z===void 0&&(Z={},f[G]=Z);let q=Z[J];q===void 0&&(q=F.clone(),Z[J]=q),F=q}return F.visible=R.visible,F.wireframe=R.wireframe,U===LT?F.side=R.shadowSide!==null?R.shadowSide:R.side:F.side=R.shadowSide!==null?R.shadowSide:g[R.side],F.alphaMap=R.alphaMap,F.alphaTest=R.alphaTest,F.clipShadows=R.clipShadows,F.clippingPlanes=R.clippingPlanes,F.clipIntersection=R.clipIntersection,F.displacementMap=R.displacementMap,F.displacementScale=R.displacementScale,F.displacementBias=R.displacementBias,F.wireframeLinewidth=R.wireframeLinewidth,F.linewidth=R.linewidth,D.isPointLight===!0&&F.isMeshDistanceMaterial===!0&&(F.referencePosition.setFromMatrixPosition(D.matrixWorld),F.nearDistance=L,F.farDistance=N),F}function P(O,R,D,L,N){if(O.visible===!1)return;if(O.layers.test(R.layers)&&(O.isMesh||O.isLine||O.isPoints)&&(O.castShadow||O.receiveShadow&&N===LT)&&(!O.frustumCulled||r.intersectsObject(O))){O.modelViewMatrix.multiplyMatrices(D.matrixWorldInverse,O.matrixWorld);let F=e.update(O),z=O.material;if(Array.isArray(z)){let G=F.groups;for(let J=0,Z=G.length;J<Z;J++){let q=G[J],$=z[q.materialIndex];if($&&$.visible){let H=A(O,$,L,D.near,D.far,N);i.renderBufferDirect(D,null,F,H,O,q)}}}else if(z.visible){let G=A(O,z,L,D.near,D.far,N);i.renderBufferDirect(D,null,F,G,O,null)}}let U=O.children;for(let F=0,z=U.length;F<z;F++)P(U[F],R,D,L,N)}}function nle(i,e,t){let r=t.isWebGL2;function n(){let Ee=!1,_t=new wn,wt=null,Xt=new wn(0,0,0,0);return{setMask:function(Ft){wt!==Ft&&!Ee&&(i.colorMask(Ft,Ft,Ft,Ft),wt=Ft)},setLocked:function(Ft){Ee=Ft},setClear:function(Ft,gi,Rt,ci,ji){ji===!0&&(Ft*=ci,gi*=ci,Rt*=ci),_t.set(Ft,gi,Rt,ci),Xt.equals(_t)===!1&&(i.clearColor(Ft,gi,Rt,ci),Xt.copy(_t))},reset:function(){Ee=!1,wt=null,Xt.set(-1,0,0,0)}}}function l(){let Ee=!1,_t=null,wt=null,Xt=null;return{setTest:function(Ft){Ft?se(2929):Y(2929)},setMask:function(Ft){_t!==Ft&&!Ee&&(i.depthMask(Ft),_t=Ft)},setFunc:function(Ft){if(wt!==Ft){if(Ft)switch(Ft){case Uie:i.depthFunc(512);break;case Hie:i.depthFunc(519);break;case $ie:i.depthFunc(513);break;case Yk:i.depthFunc(515);break;case Vie:i.depthFunc(514);break;case Wie:i.depthFunc(518);break;case jie:i.depthFunc(516);break;case Gie:i.depthFunc(517);break;default:i.depthFunc(515)}else i.depthFunc(515);wt=Ft}},setLocked:function(Ft){Ee=Ft},setClear:function(Ft){Xt!==Ft&&(i.clearDepth(Ft),Xt=Ft)},reset:function(){Ee=!1,_t=null,wt=null,Xt=null}}}function c(){let Ee=!1,_t=null,wt=null,Xt=null,Ft=null,gi=null,Rt=null,ci=null,ji=null;return{setTest:function(Ji){Ee||(Ji?se(2960):Y(2960))},setMask:function(Ji){_t!==Ji&&!Ee&&(i.stencilMask(Ji),_t=Ji)},setFunc:function(Ji,ws,Jn){(wt!==Ji||Xt!==ws||Ft!==Jn)&&(i.stencilFunc(Ji,ws,Jn),wt=Ji,Xt=ws,Ft=Jn)},setOp:function(Ji,ws,Jn){(gi!==Ji||Rt!==ws||ci!==Jn)&&(i.stencilOp(Ji,ws,Jn),gi=Ji,Rt=ws,ci=Jn)},setLocked:function(Ji){Ee=Ji},setClear:function(Ji){ji!==Ji&&(i.clearStencil(Ji),ji=Ji)},reset:function(){Ee=!1,_t=null,wt=null,Xt=null,Ft=null,gi=null,Rt=null,ci=null,ji=null}}}let h=new n,d=new l,f=new c,m={},g={},y=new WeakMap,_=[],b=null,S=!1,E=null,T=null,A=null,P=null,O=null,R=null,D=null,L=!1,N=null,U=null,F=null,z=null,G=null,J=i.getParameter(35661),Z=!1,q=0,$=i.getParameter(7938);$.indexOf("WebGL")!==-1?(q=parseFloat(/^WebGL (\d)/.exec($)[1]),Z=q>=1):$.indexOf("OpenGL ES")!==-1&&(q=parseFloat(/^OpenGL ES (\d)/.exec($)[1]),Z=q>=2);let H=null,X={},re=i.getParameter(3088),ae=i.getParameter(2978),he=new wn().fromArray(re),pe=new wn().fromArray(ae);function de(Ee,_t,wt){let Xt=new Uint8Array(4),Ft=i.createTexture();i.bindTexture(Ee,Ft),i.texParameteri(Ee,10241,9728),i.texParameteri(Ee,10240,9728);for(let gi=0;gi<wt;gi++)i.texImage2D(_t+gi,0,6408,1,1,0,6408,5121,Xt);return Ft}let ee={};ee[3553]=de(3553,3553,1),ee[34067]=de(34067,34069,6),h.setClear(0,0,0,1),d.setClear(1),f.setClear(0),se(2929),d.setFunc(Yk),Ne(!1),Ge(r6),se(2884),Ae(Um);function se(Ee){m[Ee]!==!0&&(i.enable(Ee),m[Ee]=!0)}function Y(Ee){m[Ee]!==!1&&(i.disable(Ee),m[Ee]=!1)}function fe(Ee,_t){return g[Ee]!==_t?(i.bindFramebuffer(Ee,_t),g[Ee]=_t,r&&(Ee===36009&&(g[36160]=_t),Ee===36160&&(g[36009]=_t)),!0):!1}function me(Ee,_t){let wt=_,Xt=!1;if(Ee)if(wt=y.get(_t),wt===void 0&&(wt=[],y.set(_t,wt)),Ee.isWebGLMultipleRenderTargets){let Ft=Ee.texture;if(wt.length!==Ft.length||wt[0]!==36064){for(let gi=0,Rt=Ft.length;gi<Rt;gi++)wt[gi]=36064+gi;wt.length=Ft.length,Xt=!0}}else wt[0]!==36064&&(wt[0]=36064,Xt=!0);else wt[0]!==1029&&(wt[0]=1029,Xt=!0);Xt&&(t.isWebGL2?i.drawBuffers(wt):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(wt))}function De(Ee){return b!==Ee?(i.useProgram(Ee),b=Ee,!0):!1}let Le={[NS]:32774,[Pie]:32778,[Rie]:32779};if(r)Le[o6]=32775,Le[l6]=32776;else{let Ee=e.get("EXT_blend_minmax");Ee!==null&&(Le[o6]=Ee.MIN_EXT,Le[l6]=Ee.MAX_EXT)}let Ce={[Iie]:0,[Lie]:1,[Oie]:768,[j8]:770,[Bie]:776,[Fie]:774,[Die]:772,[Nie]:769,[G8]:771,[zie]:775,[kie]:773};function Ae(Ee,_t,wt,Xt,Ft,gi,Rt,ci){if(Ee===Um){S===!0&&(Y(3042),S=!1);return}if(S===!1&&(se(3042),S=!0),Ee!==Cie){if(Ee!==E||ci!==L){if((T!==NS||O!==NS)&&(i.blendEquation(32774),T=NS,O=NS),ci)switch(Ee){case fM:i.blendFuncSeparate(1,771,1,771);break;case n6:i.blendFunc(1,1);break;case s6:i.blendFuncSeparate(0,769,0,1);break;case a6:i.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ee);break}else switch(Ee){case fM:i.blendFuncSeparate(770,771,1,771);break;case n6:i.blendFunc(770,1);break;case s6:i.blendFuncSeparate(0,769,0,1);break;case a6:i.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ee);break}A=null,P=null,R=null,D=null,E=Ee,L=ci}return}Ft=Ft||_t,gi=gi||wt,Rt=Rt||Xt,(_t!==T||Ft!==O)&&(i.blendEquationSeparate(Le[_t],Le[Ft]),T=_t,O=Ft),(wt!==A||Xt!==P||gi!==R||Rt!==D)&&(i.blendFuncSeparate(Ce[wt],Ce[Xt],Ce[gi],Ce[Rt]),A=wt,P=Xt,R=gi,D=Rt),E=Ee,L=null}function Ue(Ee,_t){Ee.side===NM?Y(2884):se(2884);let wt=Ee.side===Vd;_t&&(wt=!wt),Ne(wt),Ee.blending===fM&&Ee.transparent===!1?Ae(Um):Ae(Ee.blending,Ee.blendEquation,Ee.blendSrc,Ee.blendDst,Ee.blendEquationAlpha,Ee.blendSrcAlpha,Ee.blendDstAlpha,Ee.premultipliedAlpha),d.setFunc(Ee.depthFunc),d.setTest(Ee.depthTest),d.setMask(Ee.depthWrite),h.setMask(Ee.colorWrite);let Xt=Ee.stencilWrite;f.setTest(Xt),Xt&&(f.setMask(Ee.stencilWriteMask),f.setFunc(Ee.stencilFunc,Ee.stencilRef,Ee.stencilFuncMask),f.setOp(Ee.stencilFail,Ee.stencilZFail,Ee.stencilZPass)),it(Ee.polygonOffset,Ee.polygonOffsetFactor,Ee.polygonOffsetUnits),Ee.alphaToCoverage===!0?se(32926):Y(32926)}function Ne(Ee){N!==Ee&&(Ee?i.frontFace(2304):i.frontFace(2305),N=Ee)}function Ge(Ee){Ee!==Eie?(se(2884),Ee!==U&&(Ee===r6?i.cullFace(1029):Ee===Tie?i.cullFace(1028):i.cullFace(1032))):Y(2884),U=Ee}function Ct(Ee){Ee!==F&&(Z&&i.lineWidth(Ee),F=Ee)}function it(Ee,_t,wt){Ee?(se(32823),(z!==_t||G!==wt)&&(i.polygonOffset(_t,wt),z=_t,G=wt)):Y(32823)}function bt(Ee){Ee?se(3089):Y(3089)}function Kt(Ee){Ee===void 0&&(Ee=33984+J-1),H!==Ee&&(i.activeTexture(Ee),H=Ee)}function kt(Ee,_t){H===null&&Kt();let wt=X[H];wt===void 0&&(wt={type:void 0,texture:void 0},X[H]=wt),(wt.type!==Ee||wt.texture!==_t)&&(i.bindTexture(Ee,_t||ee[Ee]),wt.type=Ee,wt.texture=_t)}function Pt(){let Ee=X[H];Ee!==void 0&&Ee.type!==void 0&&(i.bindTexture(Ee.type,null),Ee.type=void 0,Ee.texture=void 0)}function _e(){try{i.compressedTexImage2D.apply(i,arguments)}catch(Ee){console.error("THREE.WebGLState:",Ee)}}function ce(){try{i.texSubImage2D.apply(i,arguments)}catch(Ee){console.error("THREE.WebGLState:",Ee)}}function Fe(){try{i.texSubImage3D.apply(i,arguments)}catch(Ee){console.error("THREE.WebGLState:",Ee)}}function et(){try{i.compressedTexSubImage2D.apply(i,arguments)}catch(Ee){console.error("THREE.WebGLState:",Ee)}}function Dt(){try{i.texStorage2D.apply(i,arguments)}catch(Ee){console.error("THREE.WebGLState:",Ee)}}function gt(){try{i.texStorage3D.apply(i,arguments)}catch(Ee){console.error("THREE.WebGLState:",Ee)}}function xe(){try{i.texImage2D.apply(i,arguments)}catch(Ee){console.error("THREE.WebGLState:",Ee)}}function we(){try{i.texImage3D.apply(i,arguments)}catch(Ee){console.error("THREE.WebGLState:",Ee)}}function Ve(Ee){he.equals(Ee)===!1&&(i.scissor(Ee.x,Ee.y,Ee.z,Ee.w),he.copy(Ee))}function ut(Ee){pe.equals(Ee)===!1&&(i.viewport(Ee.x,Ee.y,Ee.z,Ee.w),pe.copy(Ee))}function lt(){i.disable(3042),i.disable(2884),i.disable(2929),i.disable(32823),i.disable(3089),i.disable(2960),i.disable(32926),i.blendEquation(32774),i.blendFunc(1,0),i.blendFuncSeparate(1,0,1,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(513),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(519,0,4294967295),i.stencilOp(7680,7680,7680),i.clearStencil(0),i.cullFace(1029),i.frontFace(2305),i.polygonOffset(0,0),i.activeTexture(33984),i.bindFramebuffer(36160,null),r===!0&&(i.bindFramebuffer(36009,null),i.bindFramebuffer(36008,null)),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),m={},H=null,X={},g={},y=new WeakMap,_=[],b=null,S=!1,E=null,T=null,A=null,P=null,O=null,R=null,D=null,L=!1,N=null,U=null,F=null,z=null,G=null,he.set(0,0,i.canvas.width,i.canvas.height),pe.set(0,0,i.canvas.width,i.canvas.height),h.reset(),d.reset(),f.reset()}return{buffers:{color:h,depth:d,stencil:f},enable:se,disable:Y,bindFramebuffer:fe,drawBuffers:me,useProgram:De,setBlending:Ae,setMaterial:Ue,setFlipSided:Ne,setCullFace:Ge,setLineWidth:Ct,setPolygonOffset:it,setScissorTest:bt,activeTexture:Kt,bindTexture:kt,unbindTexture:Pt,compressedTexImage2D:_e,texImage2D:xe,texImage3D:we,texStorage2D:Dt,texStorage3D:gt,texSubImage2D:ce,texSubImage3D:Fe,compressedTexSubImage2D:et,scissor:Ve,viewport:ut,reset:lt}}function sle(i,e,t,r,n,l,c){let h=n.isWebGL2,d=n.maxTextures,f=n.maxCubemapSize,m=n.maxTextureSize,g=n.maxSamples,y=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,_=/OculusBrowser/g.test(navigator.userAgent),b=new WeakMap,S,E=new WeakMap,T=!1;try{T=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function A(_e,ce){return T?new OffscreenCanvas(_e,ce):PA("canvas")}function P(_e,ce,Fe,et){let Dt=1;if((_e.width>et||_e.height>et)&&(Dt=et/Math.max(_e.width,_e.height)),Dt<1||ce===!0)if(typeof HTMLImageElement<"u"&&_e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&_e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&_e instanceof ImageBitmap){let gt=ce?nF:Math.floor,xe=gt(Dt*_e.width),we=gt(Dt*_e.height);S===void 0&&(S=A(xe,we));let Ve=Fe?A(xe,we):S;return Ve.width=xe,Ve.height=we,Ve.getContext("2d").drawImage(_e,0,0,xe,we),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+_e.width+"x"+_e.height+") to ("+xe+"x"+we+")."),Ve}else return"data"in _e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+_e.width+"x"+_e.height+")."),_e;return _e}function O(_e){return N6(_e.width)&&N6(_e.height)}function R(_e){return h?!1:_e.wrapS!==zd||_e.wrapT!==zd||_e.minFilter!==Ga&&_e.minFilter!==nu}function D(_e,ce){return _e.generateMipmaps&&ce&&_e.minFilter!==Ga&&_e.minFilter!==nu}function L(_e){i.generateMipmap(_e)}function N(_e,ce,Fe,et,Dt=!1){if(h===!1)return ce;if(_e!==null){if(i[_e]!==void 0)return i[_e];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+_e+"'")}let gt=ce;return ce===6403&&(Fe===5126&&(gt=33326),Fe===5131&&(gt=33325),Fe===5121&&(gt=33321)),ce===33319&&(Fe===5126&&(gt=33328),Fe===5131&&(gt=33327),Fe===5121&&(gt=33323)),ce===6408&&(Fe===5126&&(gt=34836),Fe===5131&&(gt=34842),Fe===5121&&(gt=et===jn&&Dt===!1?35907:32856),Fe===32819&&(gt=32854),Fe===32820&&(gt=32855)),(gt===33325||gt===33326||gt===33327||gt===33328||gt===34842||gt===34836)&&e.get("EXT_color_buffer_float"),gt}function U(_e,ce,Fe){return D(_e,Fe)===!0||_e.isFramebufferTexture&&_e.minFilter!==Ga&&_e.minFilter!==nu?Math.log2(Math.max(ce.width,ce.height))+1:_e.mipmaps!==void 0&&_e.mipmaps.length>0?_e.mipmaps.length:_e.isCompressedTexture&&Array.isArray(_e.image)?ce.mipmaps.length:1}function F(_e){return _e===Ga||_e===u6||_e===c6?9728:9729}function z(_e){let ce=_e.target;ce.removeEventListener("dispose",z),J(ce),ce.isVideoTexture&&b.delete(ce)}function G(_e){let ce=_e.target;ce.removeEventListener("dispose",G),q(ce)}function J(_e){let ce=r.get(_e);if(ce.__webglInit===void 0)return;let Fe=_e.source,et=E.get(Fe);if(et){let Dt=et[ce.__cacheKey];Dt.usedTimes--,Dt.usedTimes===0&&Z(_e),Object.keys(et).length===0&&E.delete(Fe)}r.remove(_e)}function Z(_e){let ce=r.get(_e);i.deleteTexture(ce.__webglTexture);let Fe=_e.source,et=E.get(Fe);delete et[ce.__cacheKey],c.memory.textures--}function q(_e){let ce=_e.texture,Fe=r.get(_e),et=r.get(ce);if(et.__webglTexture!==void 0&&(i.deleteTexture(et.__webglTexture),c.memory.textures--),_e.depthTexture&&_e.depthTexture.dispose(),_e.isWebGLCubeRenderTarget)for(let Dt=0;Dt<6;Dt++)i.deleteFramebuffer(Fe.__webglFramebuffer[Dt]),Fe.__webglDepthbuffer&&i.deleteRenderbuffer(Fe.__webglDepthbuffer[Dt]);else i.deleteFramebuffer(Fe.__webglFramebuffer),Fe.__webglDepthbuffer&&i.deleteRenderbuffer(Fe.__webglDepthbuffer),Fe.__webglMultisampledFramebuffer&&i.deleteFramebuffer(Fe.__webglMultisampledFramebuffer),Fe.__webglColorRenderbuffer&&i.deleteRenderbuffer(Fe.__webglColorRenderbuffer),Fe.__webglDepthRenderbuffer&&i.deleteRenderbuffer(Fe.__webglDepthRenderbuffer);if(_e.isWebGLMultipleRenderTargets)for(let Dt=0,gt=ce.length;Dt<gt;Dt++){let xe=r.get(ce[Dt]);xe.__webglTexture&&(i.deleteTexture(xe.__webglTexture),c.memory.textures--),r.remove(ce[Dt])}r.remove(ce),r.remove(_e)}let $=0;function H(){$=0}function X(){let _e=$;return _e>=d&&console.warn("THREE.WebGLTextures: Trying to use "+_e+" texture units while this GPU supports only "+d),$+=1,_e}function re(_e){let ce=[];return ce.push(_e.wrapS),ce.push(_e.wrapT),ce.push(_e.magFilter),ce.push(_e.minFilter),ce.push(_e.anisotropy),ce.push(_e.internalFormat),ce.push(_e.format),ce.push(_e.type),ce.push(_e.generateMipmaps),ce.push(_e.premultiplyAlpha),ce.push(_e.flipY),ce.push(_e.unpackAlignment),ce.push(_e.encoding),ce.join()}function ae(_e,ce){let Fe=r.get(_e);if(_e.isVideoTexture&&kt(_e),_e.isRenderTargetTexture===!1&&_e.version>0&&Fe.__version!==_e.version){let et=_e.image;if(et===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(et.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{me(Fe,_e,ce);return}}t.activeTexture(33984+ce),t.bindTexture(3553,Fe.__webglTexture)}function he(_e,ce){let Fe=r.get(_e);if(_e.version>0&&Fe.__version!==_e.version){me(Fe,_e,ce);return}t.activeTexture(33984+ce),t.bindTexture(35866,Fe.__webglTexture)}function pe(_e,ce){let Fe=r.get(_e);if(_e.version>0&&Fe.__version!==_e.version){me(Fe,_e,ce);return}t.activeTexture(33984+ce),t.bindTexture(32879,Fe.__webglTexture)}function de(_e,ce){let Fe=r.get(_e);if(_e.version>0&&Fe.__version!==_e.version){De(Fe,_e,ce);return}t.activeTexture(33984+ce),t.bindTexture(34067,Fe.__webglTexture)}let ee={[eF]:10497,[zd]:33071,[tF]:33648},se={[Ga]:9728,[u6]:9984,[c6]:9986,[nu]:9729,[ere]:9985,[jI]:9987};function Y(_e,ce,Fe){if(Fe?(i.texParameteri(_e,10242,ee[ce.wrapS]),i.texParameteri(_e,10243,ee[ce.wrapT]),(_e===32879||_e===35866)&&i.texParameteri(_e,32882,ee[ce.wrapR]),i.texParameteri(_e,10240,se[ce.magFilter]),i.texParameteri(_e,10241,se[ce.minFilter])):(i.texParameteri(_e,10242,33071),i.texParameteri(_e,10243,33071),(_e===32879||_e===35866)&&i.texParameteri(_e,32882,33071),(ce.wrapS!==zd||ce.wrapT!==zd)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),i.texParameteri(_e,10240,F(ce.magFilter)),i.texParameteri(_e,10241,F(ce.minFilter)),ce.minFilter!==Ga&&ce.minFilter!==nu&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){let et=e.get("EXT_texture_filter_anisotropic");if(ce.type===I1&&e.has("OES_texture_float_linear")===!1||h===!1&&ce.type===pM&&e.has("OES_texture_half_float_linear")===!1)return;(ce.anisotropy>1||r.get(ce).__currentAnisotropy)&&(i.texParameterf(_e,et.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(ce.anisotropy,n.getMaxAnisotropy())),r.get(ce).__currentAnisotropy=ce.anisotropy)}}function fe(_e,ce){let Fe=!1;_e.__webglInit===void 0&&(_e.__webglInit=!0,ce.addEventListener("dispose",z));let et=ce.source,Dt=E.get(et);Dt===void 0&&(Dt={},E.set(et,Dt));let gt=re(ce);if(gt!==_e.__cacheKey){Dt[gt]===void 0&&(Dt[gt]={texture:i.createTexture(),usedTimes:0},c.memory.textures++,Fe=!0),Dt[gt].usedTimes++;let xe=Dt[_e.__cacheKey];xe!==void 0&&(Dt[_e.__cacheKey].usedTimes--,xe.usedTimes===0&&Z(ce)),_e.__cacheKey=gt,_e.__webglTexture=Dt[gt].texture}return Fe}function me(_e,ce,Fe){let et=3553;ce.isDataArrayTexture&&(et=35866),ce.isData3DTexture&&(et=32879);let Dt=fe(_e,ce),gt=ce.source;if(t.activeTexture(33984+Fe),t.bindTexture(et,_e.__webglTexture),gt.version!==gt.__currentVersion||Dt===!0){i.pixelStorei(37440,ce.flipY),i.pixelStorei(37441,ce.premultiplyAlpha),i.pixelStorei(3317,ce.unpackAlignment),i.pixelStorei(37443,0);let xe=R(ce)&&O(ce.image)===!1,we=P(ce.image,xe,!1,m);we=Pt(ce,we);let Ve=O(we)||h,ut=l.convert(ce.format,ce.encoding),lt=l.convert(ce.type),Ee=N(ce.internalFormat,ut,lt,ce.encoding,ce.isVideoTexture);Y(et,ce,Ve);let _t,wt=ce.mipmaps,Xt=h&&ce.isVideoTexture!==!0,Ft=_e.__version===void 0,gi=U(ce,we,Ve);if(ce.isDepthTexture)Ee=6402,h?ce.type===I1?Ee=36012:ce.type===VP?Ee=33190:ce.type===mM?Ee=35056:Ee=33189:ce.type===I1&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),ce.format===W1&&Ee===6402&&ce.type!==AA&&ce.type!==VP&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),ce.type=AA,lt=l.convert(ce.type)),ce.format===FM&&Ee===6402&&(Ee=34041,ce.type!==mM&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),ce.type=mM,lt=l.convert(ce.type))),Xt&&Ft?t.texStorage2D(3553,1,Ee,we.width,we.height):t.texImage2D(3553,0,Ee,we.width,we.height,0,ut,lt,null);else if(ce.isDataTexture)if(wt.length>0&&Ve){Xt&&Ft&&t.texStorage2D(3553,gi,Ee,wt[0].width,wt[0].height);for(let Rt=0,ci=wt.length;Rt<ci;Rt++)_t=wt[Rt],Xt?t.texSubImage2D(3553,Rt,0,0,_t.width,_t.height,ut,lt,_t.data):t.texImage2D(3553,Rt,Ee,_t.width,_t.height,0,ut,lt,_t.data);ce.generateMipmaps=!1}else Xt?(Ft&&t.texStorage2D(3553,gi,Ee,we.width,we.height),t.texSubImage2D(3553,0,0,0,we.width,we.height,ut,lt,we.data)):t.texImage2D(3553,0,Ee,we.width,we.height,0,ut,lt,we.data);else if(ce.isCompressedTexture){Xt&&Ft&&t.texStorage2D(3553,gi,Ee,wt[0].width,wt[0].height);for(let Rt=0,ci=wt.length;Rt<ci;Rt++)_t=wt[Rt],ce.format!==Bd?ut!==null?Xt?t.compressedTexSubImage2D(3553,Rt,0,0,_t.width,_t.height,ut,_t.data):t.compressedTexImage2D(3553,Rt,Ee,_t.width,_t.height,0,_t.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Xt?t.texSubImage2D(3553,Rt,0,0,_t.width,_t.height,ut,lt,_t.data):t.texImage2D(3553,Rt,Ee,_t.width,_t.height,0,ut,lt,_t.data)}else if(ce.isDataArrayTexture)Xt?(Ft&&t.texStorage3D(35866,gi,Ee,we.width,we.height,we.depth),t.texSubImage3D(35866,0,0,0,0,we.width,we.height,we.depth,ut,lt,we.data)):t.texImage3D(35866,0,Ee,we.width,we.height,we.depth,0,ut,lt,we.data);else if(ce.isData3DTexture)Xt?(Ft&&t.texStorage3D(32879,gi,Ee,we.width,we.height,we.depth),t.texSubImage3D(32879,0,0,0,0,we.width,we.height,we.depth,ut,lt,we.data)):t.texImage3D(32879,0,Ee,we.width,we.height,we.depth,0,ut,lt,we.data);else if(ce.isFramebufferTexture)Xt&&Ft?t.texStorage2D(3553,gi,Ee,we.width,we.height):t.texImage2D(3553,0,Ee,we.width,we.height,0,ut,lt,null);else if(wt.length>0&&Ve){Xt&&Ft&&t.texStorage2D(3553,gi,Ee,wt[0].width,wt[0].height);for(let Rt=0,ci=wt.length;Rt<ci;Rt++)_t=wt[Rt],Xt?t.texSubImage2D(3553,Rt,0,0,ut,lt,_t):t.texImage2D(3553,Rt,Ee,ut,lt,_t);ce.generateMipmaps=!1}else Xt?(Ft&&t.texStorage2D(3553,gi,Ee,we.width,we.height),t.texSubImage2D(3553,0,0,0,ut,lt,we)):t.texImage2D(3553,0,Ee,ut,lt,we);D(ce,Ve)&&L(et),gt.__currentVersion=gt.version,ce.onUpdate&&ce.onUpdate(ce)}_e.__version=ce.version}function De(_e,ce,Fe){if(ce.image.length!==6)return;let et=fe(_e,ce),Dt=ce.source;if(t.activeTexture(33984+Fe),t.bindTexture(34067,_e.__webglTexture),Dt.version!==Dt.__currentVersion||et===!0){i.pixelStorei(37440,ce.flipY),i.pixelStorei(37441,ce.premultiplyAlpha),i.pixelStorei(3317,ce.unpackAlignment),i.pixelStorei(37443,0);let gt=ce.isCompressedTexture||ce.image[0].isCompressedTexture,xe=ce.image[0]&&ce.image[0].isDataTexture,we=[];for(let Rt=0;Rt<6;Rt++)!gt&&!xe?we[Rt]=P(ce.image[Rt],!1,!0,f):we[Rt]=xe?ce.image[Rt].image:ce.image[Rt],we[Rt]=Pt(ce,we[Rt]);let Ve=we[0],ut=O(Ve)||h,lt=l.convert(ce.format,ce.encoding),Ee=l.convert(ce.type),_t=N(ce.internalFormat,lt,Ee,ce.encoding),wt=h&&ce.isVideoTexture!==!0,Xt=_e.__version===void 0,Ft=U(ce,Ve,ut);Y(34067,ce,ut);let gi;if(gt){wt&&Xt&&t.texStorage2D(34067,Ft,_t,Ve.width,Ve.height);for(let Rt=0;Rt<6;Rt++){gi=we[Rt].mipmaps;for(let ci=0;ci<gi.length;ci++){let ji=gi[ci];ce.format!==Bd?lt!==null?wt?t.compressedTexSubImage2D(34069+Rt,ci,0,0,ji.width,ji.height,lt,ji.data):t.compressedTexImage2D(34069+Rt,ci,_t,ji.width,ji.height,0,ji.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):wt?t.texSubImage2D(34069+Rt,ci,0,0,ji.width,ji.height,lt,Ee,ji.data):t.texImage2D(34069+Rt,ci,_t,ji.width,ji.height,0,lt,Ee,ji.data)}}}else{gi=ce.mipmaps,wt&&Xt&&(gi.length>0&&Ft++,t.texStorage2D(34067,Ft,_t,we[0].width,we[0].height));for(let Rt=0;Rt<6;Rt++)if(xe){wt?t.texSubImage2D(34069+Rt,0,0,0,we[Rt].width,we[Rt].height,lt,Ee,we[Rt].data):t.texImage2D(34069+Rt,0,_t,we[Rt].width,we[Rt].height,0,lt,Ee,we[Rt].data);for(let ci=0;ci<gi.length;ci++){let ji=gi[ci].image[Rt].image;wt?t.texSubImage2D(34069+Rt,ci+1,0,0,ji.width,ji.height,lt,Ee,ji.data):t.texImage2D(34069+Rt,ci+1,_t,ji.width,ji.height,0,lt,Ee,ji.data)}}else{wt?t.texSubImage2D(34069+Rt,0,0,0,lt,Ee,we[Rt]):t.texImage2D(34069+Rt,0,_t,lt,Ee,we[Rt]);for(let ci=0;ci<gi.length;ci++){let ji=gi[ci];wt?t.texSubImage2D(34069+Rt,ci+1,0,0,lt,Ee,ji.image[Rt]):t.texImage2D(34069+Rt,ci+1,_t,lt,Ee,ji.image[Rt])}}}D(ce,ut)&&L(34067),Dt.__currentVersion=Dt.version,ce.onUpdate&&ce.onUpdate(ce)}_e.__version=ce.version}function Le(_e,ce,Fe,et,Dt){let gt=l.convert(Fe.format,Fe.encoding),xe=l.convert(Fe.type),we=N(Fe.internalFormat,gt,xe,Fe.encoding);r.get(ce).__hasExternalTextures||(Dt===32879||Dt===35866?t.texImage3D(Dt,0,we,ce.width,ce.height,ce.depth,0,gt,xe,null):t.texImage2D(Dt,0,we,ce.width,ce.height,0,gt,xe,null)),t.bindFramebuffer(36160,_e),Kt(ce)?y.framebufferTexture2DMultisampleEXT(36160,et,Dt,r.get(Fe).__webglTexture,0,bt(ce)):i.framebufferTexture2D(36160,et,Dt,r.get(Fe).__webglTexture,0),t.bindFramebuffer(36160,null)}function Ce(_e,ce,Fe){if(i.bindRenderbuffer(36161,_e),ce.depthBuffer&&!ce.stencilBuffer){let et=33189;if(Fe||Kt(ce)){let Dt=ce.depthTexture;Dt&&Dt.isDepthTexture&&(Dt.type===I1?et=36012:Dt.type===VP&&(et=33190));let gt=bt(ce);Kt(ce)?y.renderbufferStorageMultisampleEXT(36161,gt,et,ce.width,ce.height):i.renderbufferStorageMultisample(36161,gt,et,ce.width,ce.height)}else i.renderbufferStorage(36161,et,ce.width,ce.height);i.framebufferRenderbuffer(36160,36096,36161,_e)}else if(ce.depthBuffer&&ce.stencilBuffer){let et=bt(ce);Fe&&Kt(ce)===!1?i.renderbufferStorageMultisample(36161,et,35056,ce.width,ce.height):Kt(ce)?y.renderbufferStorageMultisampleEXT(36161,et,35056,ce.width,ce.height):i.renderbufferStorage(36161,34041,ce.width,ce.height),i.framebufferRenderbuffer(36160,33306,36161,_e)}else{let et=ce.isWebGLMultipleRenderTargets===!0?ce.texture[0]:ce.texture,Dt=l.convert(et.format,et.encoding),gt=l.convert(et.type),xe=N(et.internalFormat,Dt,gt,et.encoding),we=bt(ce);Fe&&Kt(ce)===!1?i.renderbufferStorageMultisample(36161,we,xe,ce.width,ce.height):Kt(ce)?y.renderbufferStorageMultisampleEXT(36161,we,xe,ce.width,ce.height):i.renderbufferStorage(36161,xe,ce.width,ce.height)}i.bindRenderbuffer(36161,null)}function Ae(_e,ce){if(ce&&ce.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,_e),!(ce.depthTexture&&ce.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(ce.depthTexture).__webglTexture||ce.depthTexture.image.width!==ce.width||ce.depthTexture.image.height!==ce.height)&&(ce.depthTexture.image.width=ce.width,ce.depthTexture.image.height=ce.height,ce.depthTexture.needsUpdate=!0),ae(ce.depthTexture,0);let Fe=r.get(ce.depthTexture).__webglTexture,et=bt(ce);if(ce.depthTexture.format===W1)Kt(ce)?y.framebufferTexture2DMultisampleEXT(36160,36096,3553,Fe,0,et):i.framebufferTexture2D(36160,36096,3553,Fe,0);else if(ce.depthTexture.format===FM)Kt(ce)?y.framebufferTexture2DMultisampleEXT(36160,33306,3553,Fe,0,et):i.framebufferTexture2D(36160,33306,3553,Fe,0);else throw new Error("Unknown depthTexture format")}function Ue(_e){let ce=r.get(_e),Fe=_e.isWebGLCubeRenderTarget===!0;if(_e.depthTexture&&!ce.__autoAllocateDepthBuffer){if(Fe)throw new Error("target.depthTexture not supported in Cube render targets");Ae(ce.__webglFramebuffer,_e)}else if(Fe){ce.__webglDepthbuffer=[];for(let et=0;et<6;et++)t.bindFramebuffer(36160,ce.__webglFramebuffer[et]),ce.__webglDepthbuffer[et]=i.createRenderbuffer(),Ce(ce.__webglDepthbuffer[et],_e,!1)}else t.bindFramebuffer(36160,ce.__webglFramebuffer),ce.__webglDepthbuffer=i.createRenderbuffer(),Ce(ce.__webglDepthbuffer,_e,!1);t.bindFramebuffer(36160,null)}function Ne(_e,ce,Fe){let et=r.get(_e);ce!==void 0&&Le(et.__webglFramebuffer,_e,_e.texture,36064,3553),Fe!==void 0&&Ue(_e)}function Ge(_e){let ce=_e.texture,Fe=r.get(_e),et=r.get(ce);_e.addEventListener("dispose",G),_e.isWebGLMultipleRenderTargets!==!0&&(et.__webglTexture===void 0&&(et.__webglTexture=i.createTexture()),et.__version=ce.version,c.memory.textures++);let Dt=_e.isWebGLCubeRenderTarget===!0,gt=_e.isWebGLMultipleRenderTargets===!0,xe=O(_e)||h;if(Dt){Fe.__webglFramebuffer=[];for(let we=0;we<6;we++)Fe.__webglFramebuffer[we]=i.createFramebuffer()}else if(Fe.__webglFramebuffer=i.createFramebuffer(),gt)if(n.drawBuffers){let we=_e.texture;for(let Ve=0,ut=we.length;Ve<ut;Ve++){let lt=r.get(we[Ve]);lt.__webglTexture===void 0&&(lt.__webglTexture=i.createTexture(),c.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(h&&_e.samples>0&&Kt(_e)===!1){Fe.__webglMultisampledFramebuffer=i.createFramebuffer(),Fe.__webglColorRenderbuffer=i.createRenderbuffer(),i.bindRenderbuffer(36161,Fe.__webglColorRenderbuffer);let we=l.convert(ce.format,ce.encoding),Ve=l.convert(ce.type),ut=N(ce.internalFormat,we,Ve,ce.encoding),lt=bt(_e);i.renderbufferStorageMultisample(36161,lt,ut,_e.width,_e.height),t.bindFramebuffer(36160,Fe.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(36160,36064,36161,Fe.__webglColorRenderbuffer),i.bindRenderbuffer(36161,null),_e.depthBuffer&&(Fe.__webglDepthRenderbuffer=i.createRenderbuffer(),Ce(Fe.__webglDepthRenderbuffer,_e,!0)),t.bindFramebuffer(36160,null)}if(Dt){t.bindTexture(34067,et.__webglTexture),Y(34067,ce,xe);for(let we=0;we<6;we++)Le(Fe.__webglFramebuffer[we],_e,ce,36064,34069+we);D(ce,xe)&&L(34067),t.unbindTexture()}else if(gt){let we=_e.texture;for(let Ve=0,ut=we.length;Ve<ut;Ve++){let lt=we[Ve],Ee=r.get(lt);t.bindTexture(3553,Ee.__webglTexture),Y(3553,lt,xe),Le(Fe.__webglFramebuffer,_e,lt,36064+Ve,3553),D(lt,xe)&&L(3553)}t.unbindTexture()}else{let we=3553;(_e.isWebGL3DRenderTarget||_e.isWebGLArrayRenderTarget)&&(h?we=_e.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(we,et.__webglTexture),Y(we,ce,xe),Le(Fe.__webglFramebuffer,_e,ce,36064,we),D(ce,xe)&&L(we),t.unbindTexture()}_e.depthBuffer&&Ue(_e)}function Ct(_e){let ce=O(_e)||h,Fe=_e.isWebGLMultipleRenderTargets===!0?_e.texture:[_e.texture];for(let et=0,Dt=Fe.length;et<Dt;et++){let gt=Fe[et];if(D(gt,ce)){let xe=_e.isWebGLCubeRenderTarget?34067:3553,we=r.get(gt).__webglTexture;t.bindTexture(xe,we),L(xe),t.unbindTexture()}}}function it(_e){if(h&&_e.samples>0&&Kt(_e)===!1){let ce=_e.width,Fe=_e.height,et=16384,Dt=[36064],gt=_e.stencilBuffer?33306:36096;_e.depthBuffer&&Dt.push(gt);let xe=r.get(_e),we=xe.__ignoreDepthValues!==void 0?xe.__ignoreDepthValues:!1;we===!1&&(_e.depthBuffer&&(et|=256),_e.stencilBuffer&&(et|=1024)),t.bindFramebuffer(36008,xe.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,xe.__webglFramebuffer),we===!0&&(i.invalidateFramebuffer(36008,[gt]),i.invalidateFramebuffer(36009,[gt])),i.blitFramebuffer(0,0,ce,Fe,0,0,ce,Fe,et,9728),_&&i.invalidateFramebuffer(36008,Dt),t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,xe.__webglMultisampledFramebuffer)}}function bt(_e){return Math.min(g,_e.samples)}function Kt(_e){let ce=r.get(_e);return h&&_e.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&ce.__useRenderToTexture!==!1}function kt(_e){let ce=c.render.frame;b.get(_e)!==ce&&(b.set(_e,ce),_e.update())}function Pt(_e,ce){let Fe=_e.encoding,et=_e.format,Dt=_e.type;return _e.isCompressedTexture===!0||_e.isVideoTexture===!0||_e.format===iF||Fe!==Tp&&(Fe===jn?h===!1?e.has("EXT_sRGB")===!0&&et===Bd?(_e.format=iF,_e.minFilter=nu,_e.generateMipmaps=!1):ce=_w.sRGBToLinear(ce):(et!==Bd||Dt!==rw)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",Fe)),ce}this.allocateTextureUnit=X,this.resetTextureUnits=H,this.setTexture2D=ae,this.setTexture2DArray=he,this.setTexture3D=pe,this.setTextureCube=de,this.rebindTextures=Ne,this.setupRenderTarget=Ge,this.updateRenderTargetMipmap=Ct,this.updateMultisampleRenderTarget=it,this.setupDepthRenderbuffer=Ue,this.setupFrameBufferTexture=Le,this.useMultisampledRTT=Kt}function ale(i,e,t){let r=t.isWebGL2;function n(l,c=null){let h;if(l===rw)return 5121;if(l===nre)return 32819;if(l===sre)return 32820;if(l===tre)return 5120;if(l===ire)return 5122;if(l===AA)return 5123;if(l===rre)return 5124;if(l===VP)return 5125;if(l===I1)return 5126;if(l===pM)return r?5131:(h=e.get("OES_texture_half_float"),h!==null?h.HALF_FLOAT_OES:null);if(l===are)return 6406;if(l===Bd)return 6408;if(l===lre)return 6409;if(l===ure)return 6410;if(l===W1)return 6402;if(l===FM)return 34041;if(l===cre)return 6403;if(l===ore)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(l===iF)return h=e.get("EXT_sRGB"),h!==null?h.SRGB_ALPHA_EXT:null;if(l===hre)return 36244;if(l===dre)return 33319;if(l===fre)return 33320;if(l===pre)return 36249;if(l===nO||l===sO||l===aO||l===oO)if(c===jn)if(h=e.get("WEBGL_compressed_texture_s3tc_srgb"),h!==null){if(l===nO)return h.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(l===sO)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(l===aO)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(l===oO)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(h=e.get("WEBGL_compressed_texture_s3tc"),h!==null){if(l===nO)return h.COMPRESSED_RGB_S3TC_DXT1_EXT;if(l===sO)return h.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(l===aO)return h.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(l===oO)return h.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(l===h6||l===d6||l===f6||l===p6)if(h=e.get("WEBGL_compressed_texture_pvrtc"),h!==null){if(l===h6)return h.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(l===d6)return h.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(l===f6)return h.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(l===p6)return h.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(l===mre)return h=e.get("WEBGL_compressed_texture_etc1"),h!==null?h.COMPRESSED_RGB_ETC1_WEBGL:null;if(l===m6||l===g6)if(h=e.get("WEBGL_compressed_texture_etc"),h!==null){if(l===m6)return c===jn?h.COMPRESSED_SRGB8_ETC2:h.COMPRESSED_RGB8_ETC2;if(l===g6)return c===jn?h.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:h.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(l===v6||l===y6||l===_6||l===x6||l===b6||l===w6||l===S6||l===M6||l===E6||l===T6||l===A6||l===C6||l===P6||l===R6)if(h=e.get("WEBGL_compressed_texture_astc"),h!==null){if(l===v6)return c===jn?h.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:h.COMPRESSED_RGBA_ASTC_4x4_KHR;if(l===y6)return c===jn?h.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:h.COMPRESSED_RGBA_ASTC_5x4_KHR;if(l===_6)return c===jn?h.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:h.COMPRESSED_RGBA_ASTC_5x5_KHR;if(l===x6)return c===jn?h.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:h.COMPRESSED_RGBA_ASTC_6x5_KHR;if(l===b6)return c===jn?h.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:h.COMPRESSED_RGBA_ASTC_6x6_KHR;if(l===w6)return c===jn?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:h.COMPRESSED_RGBA_ASTC_8x5_KHR;if(l===S6)return c===jn?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:h.COMPRESSED_RGBA_ASTC_8x6_KHR;if(l===M6)return c===jn?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:h.COMPRESSED_RGBA_ASTC_8x8_KHR;if(l===E6)return c===jn?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:h.COMPRESSED_RGBA_ASTC_10x5_KHR;if(l===T6)return c===jn?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:h.COMPRESSED_RGBA_ASTC_10x6_KHR;if(l===A6)return c===jn?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:h.COMPRESSED_RGBA_ASTC_10x8_KHR;if(l===C6)return c===jn?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:h.COMPRESSED_RGBA_ASTC_10x10_KHR;if(l===P6)return c===jn?h.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:h.COMPRESSED_RGBA_ASTC_12x10_KHR;if(l===R6)return c===jn?h.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:h.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(l===I6)if(h=e.get("EXT_texture_compression_bptc"),h!==null){if(l===I6)return c===jn?h.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:h.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(l===mM)return r?34042:(h=e.get("WEBGL_depth_texture"),h!==null?h.UNSIGNED_INT_24_8_WEBGL:null)}return{convert:n}}var f7=class extends su{constructor(i=[]){super(),this.cameras=i}};f7.prototype.isArrayCamera=!0;var NT=class extends Sn{constructor(){super(),this.type="Group"}};NT.prototype.isGroup=!0;var ole={type:"move"},FO=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new NT,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new NT,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Te,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Te),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new NT,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Te,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Te),this._grip}dispatchEvent(i){return this._targetRay!==null&&this._targetRay.dispatchEvent(i),this._grip!==null&&this._grip.dispatchEvent(i),this._hand!==null&&this._hand.dispatchEvent(i),this}disconnect(i){return this.dispatchEvent({type:"disconnected",data:i}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(i,e,t){let r=null,n=null,l=null,c=this._targetRay,h=this._grip,d=this._hand;if(i&&e.session.visibilityState!=="visible-blurred")if(c!==null&&(r=e.getPose(i.targetRaySpace,t),r!==null&&(c.matrix.fromArray(r.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),r.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(r.linearVelocity)):c.hasLinearVelocity=!1,r.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(r.angularVelocity)):c.hasAngularVelocity=!1,this.dispatchEvent(ole))),d&&i.hand){l=!0;for(let b of i.hand.values()){let S=e.getJointPose(b,t);if(d.joints[b.jointName]===void 0){let T=new NT;T.matrixAutoUpdate=!1,T.visible=!1,d.joints[b.jointName]=T,d.add(T)}let E=d.joints[b.jointName];S!==null&&(E.matrix.fromArray(S.transform.matrix),E.matrix.decompose(E.position,E.rotation,E.scale),E.jointRadius=S.radius),E.visible=S!==null}let f=d.joints["index-finger-tip"],m=d.joints["thumb-tip"],g=f.position.distanceTo(m.position),y=.02,_=.005;d.inputState.pinching&&g>y+_?(d.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:i.handedness,target:this})):!d.inputState.pinching&&g<=y-_&&(d.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:i.handedness,target:this}))}else h!==null&&i.gripSpace&&(n=e.getPose(i.gripSpace,t),n!==null&&(h.matrix.fromArray(n.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),n.linearVelocity?(h.hasLinearVelocity=!0,h.linearVelocity.copy(n.linearVelocity)):h.hasLinearVelocity=!1,n.angularVelocity?(h.hasAngularVelocity=!0,h.angularVelocity.copy(n.angularVelocity)):h.hasAngularVelocity=!1));return c!==null&&(c.visible=r!==null),h!==null&&(h.visible=n!==null),d!==null&&(d.visible=l!==null),this}},p7=class extends so{constructor(i,e,t,r,n,l,c,h,d,f){if(f=f!==void 0?f:W1,f!==W1&&f!==FM)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");t===void 0&&f===W1&&(t=AA),t===void 0&&f===FM&&(t=mM),super(null,r,n,l,c,h,f,t,d),this.image={width:i,height:e},this.magFilter=c!==void 0?c:Ga,this.minFilter=h!==void 0?h:Ga,this.flipY=!1,this.generateMipmaps=!1}};p7.prototype.isDepthTexture=!0;var lle=class extends yw{constructor(i,e){super();let t=this,r=null,n=1,l=null,c="local-floor",h=null,d=null,f=null,m=null,g=null,y=e.getContextAttributes(),_=null,b=null,S=[],E=new Map,T=new su;T.layers.enable(1),T.viewport=new wn;let A=new su;A.layers.enable(2),A.viewport=new wn;let P=[T,A],O=new f7;O.layers.enable(1),O.layers.enable(2);let R=null,D=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(H){let X=S[H];return X===void 0&&(X=new FO,S[H]=X),X.getTargetRaySpace()},this.getControllerGrip=function(H){let X=S[H];return X===void 0&&(X=new FO,S[H]=X),X.getGripSpace()},this.getHand=function(H){let X=S[H];return X===void 0&&(X=new FO,S[H]=X),X.getHandSpace()};function L(H){let X=E.get(H.inputSource);X&&X.dispatchEvent({type:H.type,data:H.inputSource})}function N(){E.forEach(function(H,X){H.disconnect(X)}),E.clear(),R=null,D=null,i.setRenderTarget(_),m=null,f=null,d=null,r=null,b=null,$.stop(),t.isPresenting=!1,t.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(H){n=H,t.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(H){c=H,t.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l},this.getBaseLayer=function(){return f!==null?f:m},this.getBinding=function(){return d},this.getFrame=function(){return g},this.getSession=function(){return r},this.setSession=function(H){return Ts(this,null,function*(){if(r=H,r!==null){if(_=i.getRenderTarget(),r.addEventListener("select",L),r.addEventListener("selectstart",L),r.addEventListener("selectend",L),r.addEventListener("squeeze",L),r.addEventListener("squeezestart",L),r.addEventListener("squeezeend",L),r.addEventListener("end",N),r.addEventListener("inputsourceschange",U),y.xrCompatible!==!0&&(yield e.makeXRCompatible()),r.renderState.layers===void 0||i.capabilities.isWebGL2===!1){let X={antialias:r.renderState.layers===void 0?y.antialias:!0,alpha:y.alpha,depth:y.depth,stencil:y.stencil,framebufferScaleFactor:n};m=new XRWebGLLayer(r,e,X),r.updateRenderState({baseLayer:m}),b=new Nu(m.framebufferWidth,m.framebufferHeight,{format:Bd,type:rw,encoding:i.outputEncoding})}else{let X=null,re=null,ae=null;y.depth&&(ae=y.stencil?35056:33190,X=y.stencil?FM:W1,re=y.stencil?mM:AA);let he={colorFormat:i.outputEncoding===jn?35907:32856,depthFormat:ae,scaleFactor:n};d=new XRWebGLBinding(r,e),f=d.createProjectionLayer(he),r.updateRenderState({layers:[f]}),b=new Nu(f.textureWidth,f.textureHeight,{format:Bd,type:rw,depthTexture:new p7(f.textureWidth,f.textureHeight,re,void 0,void 0,void 0,void 0,void 0,void 0,X),stencilBuffer:y.stencil,encoding:i.outputEncoding,samples:y.antialias?4:0});let pe=i.properties.get(b);pe.__ignoreDepthValues=f.ignoreDepthValues}b.isXRRenderTarget=!0,this.setFoveation(1),l=yield r.requestReferenceSpace(c),$.setContext(r),$.start(),t.isPresenting=!0,t.dispatchEvent({type:"sessionstart"})}})};function U(H){let X=r.inputSources;for(let re=0;re<S.length;re++)E.set(X[re],S[re]);for(let re=0;re<H.removed.length;re++){let ae=H.removed[re],he=E.get(ae);he&&(he.dispatchEvent({type:"disconnected",data:ae}),E.delete(ae))}for(let re=0;re<H.added.length;re++){let ae=H.added[re],he=E.get(ae);he&&he.dispatchEvent({type:"connected",data:ae})}}let F=new Te,z=new Te;function G(H,X,re){F.setFromMatrixPosition(X.matrixWorld),z.setFromMatrixPosition(re.matrixWorld);let ae=F.distanceTo(z),he=X.projectionMatrix.elements,pe=re.projectionMatrix.elements,de=he[14]/(he[10]-1),ee=he[14]/(he[10]+1),se=(he[9]+1)/he[5],Y=(he[9]-1)/he[5],fe=(he[8]-1)/he[0],me=(pe[8]+1)/pe[0],De=de*fe,Le=de*me,Ce=ae/(-fe+me),Ae=Ce*-fe;X.matrixWorld.decompose(H.position,H.quaternion,H.scale),H.translateX(Ae),H.translateZ(Ce),H.matrixWorld.compose(H.position,H.quaternion,H.scale),H.matrixWorldInverse.copy(H.matrixWorld).invert();let Ue=de+Ce,Ne=ee+Ce,Ge=De-Ae,Ct=Le+(ae-Ae),it=se*ee/Ne*Ue,bt=Y*ee/Ne*Ue;H.projectionMatrix.makePerspective(Ge,Ct,it,bt,Ue,Ne)}function J(H,X){X===null?H.matrixWorld.copy(H.matrix):H.matrixWorld.multiplyMatrices(X.matrixWorld,H.matrix),H.matrixWorldInverse.copy(H.matrixWorld).invert()}this.updateCamera=function(H){if(r===null)return;O.near=A.near=T.near=H.near,O.far=A.far=T.far=H.far,(R!==O.near||D!==O.far)&&(r.updateRenderState({depthNear:O.near,depthFar:O.far}),R=O.near,D=O.far);let X=H.parent,re=O.cameras;J(O,X);for(let he=0;he<re.length;he++)J(re[he],X);O.matrixWorld.decompose(O.position,O.quaternion,O.scale),H.position.copy(O.position),H.quaternion.copy(O.quaternion),H.scale.copy(O.scale),H.matrix.copy(O.matrix),H.matrixWorld.copy(O.matrixWorld);let ae=H.children;for(let he=0,pe=ae.length;he<pe;he++)ae[he].updateMatrixWorld(!0);re.length===2?G(O,T,A):O.projectionMatrix.copy(T.projectionMatrix)},this.getCamera=function(){return O},this.getFoveation=function(){if(f!==null)return f.fixedFoveation;if(m!==null)return m.fixedFoveation},this.setFoveation=function(H){f!==null&&(f.fixedFoveation=H),m!==null&&m.fixedFoveation!==void 0&&(m.fixedFoveation=H)};let Z=null;function q(H,X){if(h=X.getViewerPose(l),g=X,h!==null){let ae=h.views;m!==null&&(i.setRenderTargetFramebuffer(b,m.framebuffer),i.setRenderTarget(b));let he=!1;ae.length!==O.cameras.length&&(O.cameras.length=0,he=!0);for(let pe=0;pe<ae.length;pe++){let de=ae[pe],ee=null;if(m!==null)ee=m.getViewport(de);else{let Y=d.getViewSubImage(f,de);ee=Y.viewport,pe===0&&(i.setRenderTargetTextures(b,Y.colorTexture,f.ignoreDepthValues?void 0:Y.depthStencilTexture),i.setRenderTarget(b))}let se=P[pe];se.matrix.fromArray(de.transform.matrix),se.projectionMatrix.fromArray(de.projectionMatrix),se.viewport.set(ee.x,ee.y,ee.width,ee.height),pe===0&&O.matrix.copy(se.matrix),he===!0&&O.cameras.push(se)}}let re=r.inputSources;for(let ae=0;ae<S.length;ae++){let he=S[ae],pe=re[ae];he.update(pe,X,l)}Z&&Z(H,X),g=null}let $=new r7;$.setAnimationLoop(q),this.setAnimationLoop=function(H){Z=H},this.dispose=function(){}}};function ule(i,e){function t(S,E){S.fogColor.value.copy(E.color),E.isFog?(S.fogNear.value=E.near,S.fogFar.value=E.far):E.isFogExp2&&(S.fogDensity.value=E.density)}function r(S,E,T,A,P){E.isMeshBasicMaterial||E.isMeshLambertMaterial?n(S,E):E.isMeshToonMaterial?(n(S,E),m(S,E)):E.isMeshPhongMaterial?(n(S,E),f(S,E)):E.isMeshStandardMaterial?(n(S,E),g(S,E),E.isMeshPhysicalMaterial&&y(S,E,P)):E.isMeshMatcapMaterial?(n(S,E),_(S,E)):E.isMeshDepthMaterial?n(S,E):E.isMeshDistanceMaterial?(n(S,E),b(S,E)):E.isMeshNormalMaterial?n(S,E):E.isLineBasicMaterial?(l(S,E),E.isLineDashedMaterial&&c(S,E)):E.isPointsMaterial?h(S,E,T,A):E.isSpriteMaterial?d(S,E):E.isShadowMaterial?(S.color.value.copy(E.color),S.opacity.value=E.opacity):E.isShaderMaterial&&(E.uniformsNeedUpdate=!1)}function n(S,E){S.opacity.value=E.opacity,E.color&&S.diffuse.value.copy(E.color),E.emissive&&S.emissive.value.copy(E.emissive).multiplyScalar(E.emissiveIntensity),E.map&&(S.map.value=E.map),E.alphaMap&&(S.alphaMap.value=E.alphaMap),E.bumpMap&&(S.bumpMap.value=E.bumpMap,S.bumpScale.value=E.bumpScale,E.side===Vd&&(S.bumpScale.value*=-1)),E.displacementMap&&(S.displacementMap.value=E.displacementMap,S.displacementScale.value=E.displacementScale,S.displacementBias.value=E.displacementBias),E.emissiveMap&&(S.emissiveMap.value=E.emissiveMap),E.normalMap&&(S.normalMap.value=E.normalMap,S.normalScale.value.copy(E.normalScale),E.side===Vd&&S.normalScale.value.negate()),E.specularMap&&(S.specularMap.value=E.specularMap),E.alphaTest>0&&(S.alphaTest.value=E.alphaTest);let T=e.get(E).envMap;if(T&&(S.envMap.value=T,S.flipEnvMap.value=T.isCubeTexture&&T.isRenderTargetTexture===!1?-1:1,S.reflectivity.value=E.reflectivity,S.ior.value=E.ior,S.refractionRatio.value=E.refractionRatio),E.lightMap){S.lightMap.value=E.lightMap;let O=i.physicallyCorrectLights!==!0?Math.PI:1;S.lightMapIntensity.value=E.lightMapIntensity*O}E.aoMap&&(S.aoMap.value=E.aoMap,S.aoMapIntensity.value=E.aoMapIntensity);let A;E.map?A=E.map:E.specularMap?A=E.specularMap:E.displacementMap?A=E.displacementMap:E.normalMap?A=E.normalMap:E.bumpMap?A=E.bumpMap:E.roughnessMap?A=E.roughnessMap:E.metalnessMap?A=E.metalnessMap:E.alphaMap?A=E.alphaMap:E.emissiveMap?A=E.emissiveMap:E.clearcoatMap?A=E.clearcoatMap:E.clearcoatNormalMap?A=E.clearcoatNormalMap:E.clearcoatRoughnessMap?A=E.clearcoatRoughnessMap:E.specularIntensityMap?A=E.specularIntensityMap:E.specularColorMap?A=E.specularColorMap:E.transmissionMap?A=E.transmissionMap:E.thicknessMap?A=E.thicknessMap:E.sheenColorMap?A=E.sheenColorMap:E.sheenRoughnessMap&&(A=E.sheenRoughnessMap),A!==void 0&&(A.isWebGLRenderTarget&&(A=A.texture),A.matrixAutoUpdate===!0&&A.updateMatrix(),S.uvTransform.value.copy(A.matrix));let P;E.aoMap?P=E.aoMap:E.lightMap&&(P=E.lightMap),P!==void 0&&(P.isWebGLRenderTarget&&(P=P.texture),P.matrixAutoUpdate===!0&&P.updateMatrix(),S.uv2Transform.value.copy(P.matrix))}function l(S,E){S.diffuse.value.copy(E.color),S.opacity.value=E.opacity}function c(S,E){S.dashSize.value=E.dashSize,S.totalSize.value=E.dashSize+E.gapSize,S.scale.value=E.scale}function h(S,E,T,A){S.diffuse.value.copy(E.color),S.opacity.value=E.opacity,S.size.value=E.size*T,S.scale.value=A*.5,E.map&&(S.map.value=E.map),E.alphaMap&&(S.alphaMap.value=E.alphaMap),E.alphaTest>0&&(S.alphaTest.value=E.alphaTest);let P;E.map?P=E.map:E.alphaMap&&(P=E.alphaMap),P!==void 0&&(P.matrixAutoUpdate===!0&&P.updateMatrix(),S.uvTransform.value.copy(P.matrix))}function d(S,E){S.diffuse.value.copy(E.color),S.opacity.value=E.opacity,S.rotation.value=E.rotation,E.map&&(S.map.value=E.map),E.alphaMap&&(S.alphaMap.value=E.alphaMap),E.alphaTest>0&&(S.alphaTest.value=E.alphaTest);let T;E.map?T=E.map:E.alphaMap&&(T=E.alphaMap),T!==void 0&&(T.matrixAutoUpdate===!0&&T.updateMatrix(),S.uvTransform.value.copy(T.matrix))}function f(S,E){S.specular.value.copy(E.specular),S.shininess.value=Math.max(E.shininess,1e-4)}function m(S,E){E.gradientMap&&(S.gradientMap.value=E.gradientMap)}function g(S,E){S.roughness.value=E.roughness,S.metalness.value=E.metalness,E.roughnessMap&&(S.roughnessMap.value=E.roughnessMap),E.metalnessMap&&(S.metalnessMap.value=E.metalnessMap),e.get(E).envMap&&(S.envMapIntensity.value=E.envMapIntensity)}function y(S,E,T){S.ior.value=E.ior,E.sheen>0&&(S.sheenColor.value.copy(E.sheenColor).multiplyScalar(E.sheen),S.sheenRoughness.value=E.sheenRoughness,E.sheenColorMap&&(S.sheenColorMap.value=E.sheenColorMap),E.sheenRoughnessMap&&(S.sheenRoughnessMap.value=E.sheenRoughnessMap)),E.clearcoat>0&&(S.clearcoat.value=E.clearcoat,S.clearcoatRoughness.value=E.clearcoatRoughness,E.clearcoatMap&&(S.clearcoatMap.value=E.clearcoatMap),E.clearcoatRoughnessMap&&(S.clearcoatRoughnessMap.value=E.clearcoatRoughnessMap),E.clearcoatNormalMap&&(S.clearcoatNormalScale.value.copy(E.clearcoatNormalScale),S.clearcoatNormalMap.value=E.clearcoatNormalMap,E.side===Vd&&S.clearcoatNormalScale.value.negate())),E.transmission>0&&(S.transmission.value=E.transmission,S.transmissionSamplerMap.value=T.texture,S.transmissionSamplerSize.value.set(T.width,T.height),E.transmissionMap&&(S.transmissionMap.value=E.transmissionMap),S.thickness.value=E.thickness,E.thicknessMap&&(S.thicknessMap.value=E.thicknessMap),S.attenuationDistance.value=E.attenuationDistance,S.attenuationColor.value.copy(E.attenuationColor)),S.specularIntensity.value=E.specularIntensity,S.specularColor.value.copy(E.specularColor),E.specularIntensityMap&&(S.specularIntensityMap.value=E.specularIntensityMap),E.specularColorMap&&(S.specularColorMap.value=E.specularColorMap)}function _(S,E){E.matcap&&(S.matcap.value=E.matcap)}function b(S,E){S.referencePosition.value.copy(E.referencePosition),S.nearDistance.value=E.nearDistance,S.farDistance.value=E.farDistance}return{refreshFogUniforms:t,refreshMaterialUniforms:r}}function cle(){let i=PA("canvas");return i.style.display="block",i}function Mn(i={}){let e=i.canvas!==void 0?i.canvas:cle(),t=i.context!==void 0?i.context:null,r=i.depth!==void 0?i.depth:!0,n=i.stencil!==void 0?i.stencil:!0,l=i.antialias!==void 0?i.antialias:!1,c=i.premultipliedAlpha!==void 0?i.premultipliedAlpha:!0,h=i.preserveDrawingBuffer!==void 0?i.preserveDrawingBuffer:!1,d=i.powerPreference!==void 0?i.powerPreference:"default",f=i.failIfMajorPerformanceCaveat!==void 0?i.failIfMajorPerformanceCaveat:!1,m;i.context!==void 0?m=t.getContextAttributes().alpha:m=i.alpha!==void 0?i.alpha:!1;let g=null,y=null,_=[],b=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Tp,this.physicallyCorrectLights=!1,this.toneMapping=vp,this.toneMappingExposure=1;let S=this,E=!1,T=0,A=0,P=null,O=-1,R=null,D=new wn,L=new wn,N=null,U=e.width,F=e.height,z=1,G=null,J=null,Z=new wn(0,0,U,F),q=new wn(0,0,U,F),$=!1,H=new JI,X=!1,re=!1,ae=null,he=new Bi,pe=new At,de=new Te,ee={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function se(){return P===null?z:1}let Y=t;function fe(ye,je){for(let tt=0;tt<ye.length;tt++){let qe=ye[tt],st=e.getContext(qe,je);if(st!==null)return st}return null}try{let ye={alpha:!0,depth:r,stencil:n,antialias:l,premultipliedAlpha:c,preserveDrawingBuffer:h,powerPreference:d,failIfMajorPerformanceCaveat:f};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${Oz}`),e.addEventListener("webglcontextlost",Ee,!1),e.addEventListener("webglcontextrestored",_t,!1),Y===null){let je=["webgl2","webgl","experimental-webgl"];if(S.isWebGL1Renderer===!0&&je.shift(),Y=fe(je,ye),Y===null)throw fe(je)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}Y.getShaderPrecisionFormat===void 0&&(Y.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(ye){throw console.error("THREE.WebGLRenderer: "+ye.message),ye}let me,De,Le,Ce,Ae,Ue,Ne,Ge,Ct,it,bt,Kt,kt,Pt,_e,ce,Fe,et,Dt,gt,xe,we,Ve;function ut(){me=new Cae(Y),De=new wae(Y,me,i),me.init(De),we=new ale(Y,me,De),Le=new nle(Y,me,De),Ce=new Iae,Ae=new qoe,Ue=new sle(Y,me,Le,Ae,De,we,Ce),Ne=new Mae(S),Ge=new Aae(S),Ct=new jre(Y,De),Ve=new xae(Y,me,Ct,De),it=new Pae(Y,Ct,Ce,Ve),bt=new Dae(Y,it,Ct,Ce),Dt=new Nae(Y,De,Ue),ce=new Sae(Ae),Kt=new Goe(S,Ne,Ge,me,De,Ve,ce),kt=new ule(S,Ae),Pt=new Zoe,_e=new tle(me,De),et=new _ae(S,Ne,Le,bt,m,c),Fe=new d7(S,bt,De),gt=new bae(Y,me,Ce,De),xe=new Rae(Y,me,Ce,De),Ce.programs=Kt.programs,S.capabilities=De,S.extensions=me,S.properties=Ae,S.renderLists=Pt,S.shadowMap=Fe,S.state=Le,S.info=Ce}ut();let lt=new lle(S,Y);this.xr=lt,this.getContext=function(){return Y},this.getContextAttributes=function(){return Y.getContextAttributes()},this.forceContextLoss=function(){let ye=me.get("WEBGL_lose_context");ye&&ye.loseContext()},this.forceContextRestore=function(){let ye=me.get("WEBGL_lose_context");ye&&ye.restoreContext()},this.getPixelRatio=function(){return z},this.setPixelRatio=function(ye){ye!==void 0&&(z=ye,this.setSize(U,F,!1))},this.getSize=function(ye){return ye.set(U,F)},this.setSize=function(ye,je,tt){if(lt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}U=ye,F=je,e.width=Math.floor(ye*z),e.height=Math.floor(je*z),tt!==!1&&(e.style.width=ye+"px",e.style.height=je+"px"),this.setViewport(0,0,ye,je)},this.getDrawingBufferSize=function(ye){return ye.set(U*z,F*z).floor()},this.setDrawingBufferSize=function(ye,je,tt){U=ye,F=je,z=tt,e.width=Math.floor(ye*tt),e.height=Math.floor(je*tt),this.setViewport(0,0,ye,je)},this.getCurrentViewport=function(ye){return ye.copy(D)},this.getViewport=function(ye){return ye.copy(Z)},this.setViewport=function(ye,je,tt,qe){ye.isVector4?Z.set(ye.x,ye.y,ye.z,ye.w):Z.set(ye,je,tt,qe),Le.viewport(D.copy(Z).multiplyScalar(z).floor())},this.getScissor=function(ye){return ye.copy(q)},this.setScissor=function(ye,je,tt,qe){ye.isVector4?q.set(ye.x,ye.y,ye.z,ye.w):q.set(ye,je,tt,qe),Le.scissor(L.copy(q).multiplyScalar(z).floor())},this.getScissorTest=function(){return $},this.setScissorTest=function(ye){Le.setScissorTest($=ye)},this.setOpaqueSort=function(ye){G=ye},this.setTransparentSort=function(ye){J=ye},this.getClearColor=function(ye){return ye.copy(et.getClearColor())},this.setClearColor=function(){et.setClearColor.apply(et,arguments)},this.getClearAlpha=function(){return et.getClearAlpha()},this.setClearAlpha=function(){et.setClearAlpha.apply(et,arguments)},this.clear=function(ye=!0,je=!0,tt=!0){let qe=0;ye&&(qe|=16384),je&&(qe|=256),tt&&(qe|=1024),Y.clear(qe)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",Ee,!1),e.removeEventListener("webglcontextrestored",_t,!1),Pt.dispose(),_e.dispose(),Ae.dispose(),Ne.dispose(),Ge.dispose(),bt.dispose(),Ve.dispose(),Kt.dispose(),lt.dispose(),lt.removeEventListener("sessionstart",ci),lt.removeEventListener("sessionend",ji),ae&&(ae.dispose(),ae=null),Ji.stop()};function Ee(ye){ye.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),E=!0}function _t(){console.log("THREE.WebGLRenderer: Context Restored."),E=!1;let ye=Ce.autoReset,je=Fe.enabled,tt=Fe.autoUpdate,qe=Fe.needsUpdate,st=Fe.type;ut(),Ce.autoReset=ye,Fe.enabled=je,Fe.autoUpdate=tt,Fe.needsUpdate=qe,Fe.type=st}function wt(ye){let je=ye.target;je.removeEventListener("dispose",wt),Xt(je)}function Xt(ye){Ft(ye),Ae.remove(ye)}function Ft(ye){let je=Ae.get(ye).programs;je!==void 0&&(je.forEach(function(tt){Kt.releaseProgram(tt)}),ye.isShaderMaterial&&Kt.releaseShaderCache(ye))}this.renderBufferDirect=function(ye,je,tt,qe,st,si){je===null&&(je=ee);let Ci=st.isMesh&&st.matrixWorld.determinant()<0,yi=yu(ye,je,tt,qe,st);Le.setMaterial(qe,Ci);let Xi=tt.index,xr=tt.attributes.position;if(Xi===null){if(xr===void 0||xr.count===0)return}else if(Xi.count===0)return;let Yi=1;qe.wireframe===!0&&(Xi=it.getWireframeAttribute(tt),Yi=2),Ve.setup(st,qe,yi,tt,Xi);let Ki,tn=gt;Xi!==null&&(Ki=Ct.get(Xi),tn=xe,tn.setIndex(Ki));let Us=Xi!==null?Xi.count:xr.count,co=tt.drawRange.start*Yi,Po=tt.drawRange.count*Yi,Q=si!==null?si.start*Yi:0,le=si!==null?si.count*Yi:1/0,oe=Math.max(co,Q),ve=Math.min(Us,co+Po,Q+le)-1,ke=Math.max(0,ve-oe+1);if(ke!==0){if(st.isMesh)qe.wireframe===!0?(Le.setLineWidth(qe.wireframeLinewidth*se()),tn.setMode(1)):tn.setMode(4);else if(st.isLine){let Oe=qe.linewidth;Oe===void 0&&(Oe=1),Le.setLineWidth(Oe*se()),st.isLineSegments?tn.setMode(1):st.isLineLoop?tn.setMode(2):tn.setMode(3)}else st.isPoints?tn.setMode(0):st.isSprite&&tn.setMode(4);if(st.isInstancedMesh)tn.renderInstances(oe,ke,st.count);else if(tt.isInstancedBufferGeometry){let Oe=Math.min(tt.instanceCount,tt._maxInstanceCount);tn.renderInstances(oe,ke,Oe)}else tn.render(oe,ke)}},this.compile=function(ye,je){y=_e.get(ye),y.init(),b.push(y),ye.traverseVisible(function(tt){tt.isLight&&tt.layers.test(je.layers)&&(y.pushLight(tt),tt.castShadow&&y.pushShadow(tt))}),y.setupLights(S.physicallyCorrectLights),ye.traverse(function(tt){let qe=tt.material;if(qe)if(Array.isArray(qe))for(let st=0;st<qe.length;st++){let si=qe[st];uo(si,ye,tt)}else uo(qe,ye,tt)}),b.pop(),y=null};let gi=null;function Rt(ye){gi&&gi(ye)}function ci(){Ji.stop()}function ji(){Ji.start()}let Ji=new r7;Ji.setAnimationLoop(Rt),typeof self<"u"&&Ji.setContext(self),this.setAnimationLoop=function(ye){gi=ye,lt.setAnimationLoop(ye),ye===null?Ji.stop():Ji.start()},lt.addEventListener("sessionstart",ci),lt.addEventListener("sessionend",ji),this.render=function(ye,je){if(je!==void 0&&je.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(E===!0)return;ye.autoUpdate===!0&&ye.updateMatrixWorld(),je.parent===null&&je.updateMatrixWorld(),lt.enabled===!0&&lt.isPresenting===!0&&(lt.cameraAutoUpdate===!0&&lt.updateCamera(je),je=lt.getCamera()),ye.isScene===!0&&ye.onBeforeRender(S,ye,je,P),y=_e.get(ye,b.length),y.init(),b.push(y),he.multiplyMatrices(je.projectionMatrix,je.matrixWorldInverse),H.setFromProjectionMatrix(he),re=this.localClippingEnabled,X=ce.init(this.clippingPlanes,re,je),g=Pt.get(ye,_.length),g.init(),_.push(g),ws(ye,je,0,S.sortObjects),g.finish(),S.sortObjects===!0&&g.sort(G,J),X===!0&&ce.beginShadows();let tt=y.state.shadowsArray;if(Fe.render(tt,ye,je),X===!0&&ce.endShadows(),this.info.autoReset===!0&&this.info.reset(),et.render(g,ye),y.setupLights(S.physicallyCorrectLights),je.isArrayCamera){let qe=je.cameras;for(let st=0,si=qe.length;st<si;st++){let Ci=qe[st];Jn(g,ye,Ci,Ci.viewport)}}else Jn(g,ye,je);P!==null&&(Ue.updateMultisampleRenderTarget(P),Ue.updateRenderTargetMipmap(P)),ye.isScene===!0&&ye.onAfterRender(S,ye,je),Ve.resetDefaultState(),O=-1,R=null,b.pop(),b.length>0?y=b[b.length-1]:y=null,_.pop(),_.length>0?g=_[_.length-1]:g=null};function ws(ye,je,tt,qe){if(ye.visible===!1)return;if(ye.layers.test(je.layers)){if(ye.isGroup)tt=ye.renderOrder;else if(ye.isLOD)ye.autoUpdate===!0&&ye.update(je);else if(ye.isLight)y.pushLight(ye),ye.castShadow&&y.pushShadow(ye);else if(ye.isSprite){if(!ye.frustumCulled||H.intersectsSprite(ye)){qe&&de.setFromMatrixPosition(ye.matrixWorld).applyMatrix4(he);let si=bt.update(ye),Ci=ye.material;Ci.visible&&g.push(ye,si,Ci,tt,de.z,null)}}else if((ye.isMesh||ye.isLine||ye.isPoints)&&(ye.isSkinnedMesh&&ye.skeleton.frame!==Ce.render.frame&&(ye.skeleton.update(),ye.skeleton.frame=Ce.render.frame),!ye.frustumCulled||H.intersectsObject(ye))){qe&&de.setFromMatrixPosition(ye.matrixWorld).applyMatrix4(he);let si=bt.update(ye),Ci=ye.material;if(Array.isArray(Ci)){let yi=si.groups;for(let Xi=0,xr=yi.length;Xi<xr;Xi++){let Yi=yi[Xi],Ki=Ci[Yi.materialIndex];Ki&&Ki.visible&&g.push(ye,si,Ki,tt,de.z,Yi)}}else Ci.visible&&g.push(ye,si,Ci,tt,de.z,null)}}let st=ye.children;for(let si=0,Ci=st.length;si<Ci;si++)ws(st[si],je,tt,qe)}function Jn(ye,je,tt,qe){let st=ye.opaque,si=ye.transmissive,Ci=ye.transparent;y.setupLightsView(tt),si.length>0&&ao(st,je,tt),qe&&Le.viewport(D.copy(qe)),st.length>0&&oo(st,je,tt),si.length>0&&oo(si,je,tt),Ci.length>0&&oo(Ci,je,tt),Le.buffers.depth.setTest(!0),Le.buffers.depth.setMask(!0),Le.buffers.color.setMask(!0),Le.setPolygonOffset(!1)}function ao(ye,je,tt){let qe=De.isWebGL2;ae===null&&(ae=new Nu(1,1,{generateMipmaps:!0,type:we.convert(pM)!==null?pM:rw,minFilter:jI,samples:qe&&l===!0?4:0})),S.getDrawingBufferSize(pe),qe?ae.setSize(pe.x,pe.y):ae.setSize(nF(pe.x),nF(pe.y));let st=S.getRenderTarget();S.setRenderTarget(ae),S.clear();let si=S.toneMapping;S.toneMapping=vp,oo(ye,je,tt),S.toneMapping=si,Ue.updateMultisampleRenderTarget(ae),Ue.updateRenderTargetMipmap(ae),S.setRenderTarget(st)}function oo(ye,je,tt){let qe=je.isScene===!0?je.overrideMaterial:null;for(let st=0,si=ye.length;st<si;st++){let Ci=ye[st],yi=Ci.object,Xi=Ci.geometry,xr=qe===null?Ci.material:qe,Yi=Ci.group;yi.layers.test(tt.layers)&&lo(yi,je,tt,Xi,xr,Yi)}}function lo(ye,je,tt,qe,st,si){ye.onBeforeRender(S,je,tt,qe,st,si),ye.modelViewMatrix.multiplyMatrices(tt.matrixWorldInverse,ye.matrixWorld),ye.normalMatrix.getNormalMatrix(ye.modelViewMatrix),st.onBeforeRender(S,je,tt,qe,ye,si),st.transparent===!0&&st.side===NM?(st.side=Vd,st.needsUpdate=!0,S.renderBufferDirect(tt,je,qe,st,ye,si),st.side=TA,st.needsUpdate=!0,S.renderBufferDirect(tt,je,qe,st,ye,si),st.side=NM):S.renderBufferDirect(tt,je,qe,st,ye,si),ye.onAfterRender(S,je,tt,qe,st,si)}function uo(ye,je,tt){je.isScene!==!0&&(je=ee);let qe=Ae.get(ye),st=y.state.lights,si=y.state.shadowsArray,Ci=st.state.version,yi=Kt.getParameters(ye,st.state,si,je,tt),Xi=Kt.getProgramCacheKey(yi),xr=qe.programs;qe.environment=ye.isMeshStandardMaterial?je.environment:null,qe.fog=je.fog,qe.envMap=(ye.isMeshStandardMaterial?Ge:Ne).get(ye.envMap||qe.environment),xr===void 0&&(ye.addEventListener("dispose",wt),xr=new Map,qe.programs=xr);let Yi=xr.get(Xi);if(Yi!==void 0){if(qe.currentProgram===Yi&&qe.lightsStateVersion===Ci)return vu(ye,yi),Yi}else yi.uniforms=Kt.getUniforms(ye),ye.onBuild(tt,yi,S),ye.onBeforeCompile(yi,S),Yi=Kt.acquireProgram(yi,Xi),xr.set(Xi,Yi),qe.uniforms=yi.uniforms;let Ki=qe.uniforms;(!ye.isShaderMaterial&&!ye.isRawShaderMaterial||ye.clipping===!0)&&(Ki.clippingPlanes=ce.uniform),vu(ye,yi),qe.needsLights=_u(ye),qe.lightsStateVersion=Ci,qe.needsLights&&(Ki.ambientLightColor.value=st.state.ambient,Ki.lightProbe.value=st.state.probe,Ki.directionalLights.value=st.state.directional,Ki.directionalLightShadows.value=st.state.directionalShadow,Ki.spotLights.value=st.state.spot,Ki.spotLightShadows.value=st.state.spotShadow,Ki.rectAreaLights.value=st.state.rectArea,Ki.ltc_1.value=st.state.rectAreaLTC1,Ki.ltc_2.value=st.state.rectAreaLTC2,Ki.pointLights.value=st.state.point,Ki.pointLightShadows.value=st.state.pointShadow,Ki.hemisphereLights.value=st.state.hemi,Ki.directionalShadowMap.value=st.state.directionalShadowMap,Ki.directionalShadowMatrix.value=st.state.directionalShadowMatrix,Ki.spotShadowMap.value=st.state.spotShadowMap,Ki.spotShadowMatrix.value=st.state.spotShadowMatrix,Ki.pointShadowMap.value=st.state.pointShadowMap,Ki.pointShadowMatrix.value=st.state.pointShadowMatrix);let tn=Yi.getUniforms(),Us=Hm.seqWithValue(tn.seq,Ki);return qe.currentProgram=Yi,qe.uniformsList=Us,Yi}function vu(ye,je){let tt=Ae.get(ye);tt.outputEncoding=je.outputEncoding,tt.instancing=je.instancing,tt.skinning=je.skinning,tt.morphTargets=je.morphTargets,tt.morphNormals=je.morphNormals,tt.morphColors=je.morphColors,tt.morphTargetsCount=je.morphTargetsCount,tt.numClippingPlanes=je.numClippingPlanes,tt.numIntersection=je.numClipIntersection,tt.vertexAlphas=je.vertexAlphas,tt.vertexTangents=je.vertexTangents,tt.toneMapping=je.toneMapping}function yu(ye,je,tt,qe,st){je.isScene!==!0&&(je=ee),Ue.resetTextureUnits();let si=je.fog,Ci=qe.isMeshStandardMaterial?je.environment:null,yi=P===null?S.outputEncoding:P.isXRRenderTarget===!0?P.texture.encoding:Tp,Xi=(qe.isMeshStandardMaterial?Ge:Ne).get(qe.envMap||Ci),xr=qe.vertexColors===!0&&!!tt.attributes.color&&tt.attributes.color.itemSize===4,Yi=!!qe.normalMap&&!!tt.attributes.tangent,Ki=!!tt.morphAttributes.position,tn=!!tt.morphAttributes.normal,Us=!!tt.morphAttributes.color,co=qe.toneMapped?S.toneMapping:vp,Po=tt.morphAttributes.position||tt.morphAttributes.normal||tt.morphAttributes.color,Q=Po!==void 0?Po.length:0,le=Ae.get(qe),oe=y.state.lights;if(X===!0&&(re===!0||ye!==R)){let Ht=ye===R&&qe.id===O;ce.setState(qe,ye,Ht)}let ve=!1;qe.version===le.__version?(le.needsLights&&le.lightsStateVersion!==oe.state.version||le.outputEncoding!==yi||st.isInstancedMesh&&le.instancing===!1||!st.isInstancedMesh&&le.instancing===!0||st.isSkinnedMesh&&le.skinning===!1||!st.isSkinnedMesh&&le.skinning===!0||le.envMap!==Xi||qe.fog&&le.fog!==si||le.numClippingPlanes!==void 0&&(le.numClippingPlanes!==ce.numPlanes||le.numIntersection!==ce.numIntersection)||le.vertexAlphas!==xr||le.vertexTangents!==Yi||le.morphTargets!==Ki||le.morphNormals!==tn||le.morphColors!==Us||le.toneMapping!==co||De.isWebGL2===!0&&le.morphTargetsCount!==Q)&&(ve=!0):(ve=!0,le.__version=qe.version);let ke=le.currentProgram;ve===!0&&(ke=uo(qe,je,st));let Oe=!1,Je=!1,mt=!1,vt=ke.getUniforms(),ct=le.uniforms;if(Le.useProgram(ke.program)&&(Oe=!0,Je=!0,mt=!0),qe.id!==O&&(O=qe.id,Je=!0),Oe||R!==ye){if(vt.setValue(Y,"projectionMatrix",ye.projectionMatrix),De.logarithmicDepthBuffer&&vt.setValue(Y,"logDepthBufFC",2/(Math.log(ye.far+1)/Math.LN2)),R!==ye&&(R=ye,Je=!0,mt=!0),qe.isShaderMaterial||qe.isMeshPhongMaterial||qe.isMeshToonMaterial||qe.isMeshStandardMaterial||qe.envMap){let Ht=vt.map.cameraPosition;Ht!==void 0&&Ht.setValue(Y,de.setFromMatrixPosition(ye.matrixWorld))}(qe.isMeshPhongMaterial||qe.isMeshToonMaterial||qe.isMeshLambertMaterial||qe.isMeshBasicMaterial||qe.isMeshStandardMaterial||qe.isShaderMaterial)&&vt.setValue(Y,"isOrthographic",ye.isOrthographicCamera===!0),(qe.isMeshPhongMaterial||qe.isMeshToonMaterial||qe.isMeshLambertMaterial||qe.isMeshBasicMaterial||qe.isMeshStandardMaterial||qe.isShaderMaterial||qe.isShadowMaterial||st.isSkinnedMesh)&&vt.setValue(Y,"viewMatrix",ye.matrixWorldInverse)}if(st.isSkinnedMesh){vt.setOptional(Y,st,"bindMatrix"),vt.setOptional(Y,st,"bindMatrixInverse");let Ht=st.skeleton;Ht&&(De.floatVertexTextures?(Ht.boneTexture===null&&Ht.computeBoneTexture(),vt.setValue(Y,"boneTexture",Ht.boneTexture,Ue),vt.setValue(Y,"boneTextureSize",Ht.boneTextureSize)):vt.setOptional(Y,Ht,"boneMatrices"))}let It=tt.morphAttributes;return(It.position!==void 0||It.normal!==void 0||It.color!==void 0&&De.isWebGL2===!0)&&Dt.update(st,tt,qe,ke),(Je||le.receiveShadow!==st.receiveShadow)&&(le.receiveShadow=st.receiveShadow,vt.setValue(Y,"receiveShadow",st.receiveShadow)),Je&&(vt.setValue(Y,"toneMappingExposure",S.toneMappingExposure),le.needsLights&&Ls(ct,mt),si&&qe.fog&&kt.refreshFogUniforms(ct,si),kt.refreshMaterialUniforms(ct,qe,z,F,ae),Hm.upload(Y,le.uniformsList,ct,Ue)),qe.isShaderMaterial&&qe.uniformsNeedUpdate===!0&&(Hm.upload(Y,le.uniformsList,ct,Ue),qe.uniformsNeedUpdate=!1),qe.isSpriteMaterial&&vt.setValue(Y,"center",st.center),vt.setValue(Y,"modelViewMatrix",st.modelViewMatrix),vt.setValue(Y,"normalMatrix",st.normalMatrix),vt.setValue(Y,"modelMatrix",st.matrixWorld),ke}function Ls(ye,je){ye.ambientLightColor.needsUpdate=je,ye.lightProbe.needsUpdate=je,ye.directionalLights.needsUpdate=je,ye.directionalLightShadows.needsUpdate=je,ye.pointLights.needsUpdate=je,ye.pointLightShadows.needsUpdate=je,ye.spotLights.needsUpdate=je,ye.spotLightShadows.needsUpdate=je,ye.rectAreaLights.needsUpdate=je,ye.hemisphereLights.needsUpdate=je}function _u(ye){return ye.isMeshLambertMaterial||ye.isMeshToonMaterial||ye.isMeshPhongMaterial||ye.isMeshStandardMaterial||ye.isShadowMaterial||ye.isShaderMaterial&&ye.lights===!0}this.getActiveCubeFace=function(){return T},this.getActiveMipmapLevel=function(){return A},this.getRenderTarget=function(){return P},this.setRenderTargetTextures=function(ye,je,tt){Ae.get(ye.texture).__webglTexture=je,Ae.get(ye.depthTexture).__webglTexture=tt;let qe=Ae.get(ye);qe.__hasExternalTextures=!0,qe.__hasExternalTextures&&(qe.__autoAllocateDepthBuffer=tt===void 0,qe.__autoAllocateDepthBuffer||me.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),qe.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(ye,je){let tt=Ae.get(ye);tt.__webglFramebuffer=je,tt.__useDefaultFramebuffer=je===void 0},this.setRenderTarget=function(ye,je=0,tt=0){P=ye,T=je,A=tt;let qe=!0;if(ye){let yi=Ae.get(ye);yi.__useDefaultFramebuffer!==void 0?(Le.bindFramebuffer(36160,null),qe=!1):yi.__webglFramebuffer===void 0?Ue.setupRenderTarget(ye):yi.__hasExternalTextures&&Ue.rebindTextures(ye,Ae.get(ye.texture).__webglTexture,Ae.get(ye.depthTexture).__webglTexture)}let st=null,si=!1,Ci=!1;if(ye){let yi=ye.texture;(yi.isData3DTexture||yi.isDataArrayTexture)&&(Ci=!0);let Xi=Ae.get(ye).__webglFramebuffer;ye.isWebGLCubeRenderTarget?(st=Xi[je],si=!0):De.isWebGL2&&ye.samples>0&&Ue.useMultisampledRTT(ye)===!1?st=Ae.get(ye).__webglMultisampledFramebuffer:st=Xi,D.copy(ye.viewport),L.copy(ye.scissor),N=ye.scissorTest}else D.copy(Z).multiplyScalar(z).floor(),L.copy(q).multiplyScalar(z).floor(),N=$;if(Le.bindFramebuffer(36160,st)&&De.drawBuffers&&qe&&Le.drawBuffers(ye,st),Le.viewport(D),Le.scissor(L),Le.setScissorTest(N),si){let yi=Ae.get(ye.texture);Y.framebufferTexture2D(36160,36064,34069+je,yi.__webglTexture,tt)}else if(Ci){let yi=Ae.get(ye.texture),Xi=je||0;Y.framebufferTextureLayer(36160,36064,yi.__webglTexture,tt||0,Xi)}O=-1},this.readRenderTargetPixels=function(ye,je,tt,qe,st,si,Ci){if(!(ye&&ye.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let yi=Ae.get(ye).__webglFramebuffer;if(ye.isWebGLCubeRenderTarget&&Ci!==void 0&&(yi=yi[Ci]),yi){Le.bindFramebuffer(36160,yi);try{let Xi=ye.texture,xr=Xi.format,Yi=Xi.type;if(xr!==Bd&&we.convert(xr)!==Y.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let Ki=Yi===pM&&(me.has("EXT_color_buffer_half_float")||De.isWebGL2&&me.has("EXT_color_buffer_float"));if(Yi!==rw&&we.convert(Yi)!==Y.getParameter(35738)&&!(Yi===I1&&(De.isWebGL2||me.has("OES_texture_float")||me.has("WEBGL_color_buffer_float")))&&!Ki){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}je>=0&&je<=ye.width-qe&&tt>=0&&tt<=ye.height-st&&Y.readPixels(je,tt,qe,st,we.convert(xr),we.convert(Yi),si)}finally{let Xi=P!==null?Ae.get(P).__webglFramebuffer:null;Le.bindFramebuffer(36160,Xi)}}},this.copyFramebufferToTexture=function(ye,je,tt=0){if(je.isFramebufferTexture!==!0){console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.");return}let qe=Math.pow(2,-tt),st=Math.floor(je.image.width*qe),si=Math.floor(je.image.height*qe);Ue.setTexture2D(je,0),Y.copyTexSubImage2D(3553,tt,0,0,ye.x,ye.y,st,si),Le.unbindTexture()},this.copyTextureToTexture=function(ye,je,tt,qe=0){let st=je.image.width,si=je.image.height,Ci=we.convert(tt.format),yi=we.convert(tt.type);Ue.setTexture2D(tt,0),Y.pixelStorei(37440,tt.flipY),Y.pixelStorei(37441,tt.premultiplyAlpha),Y.pixelStorei(3317,tt.unpackAlignment),je.isDataTexture?Y.texSubImage2D(3553,qe,ye.x,ye.y,st,si,Ci,yi,je.image.data):je.isCompressedTexture?Y.compressedTexSubImage2D(3553,qe,ye.x,ye.y,je.mipmaps[0].width,je.mipmaps[0].height,Ci,je.mipmaps[0].data):Y.texSubImage2D(3553,qe,ye.x,ye.y,Ci,yi,je.image),qe===0&&tt.generateMipmaps&&Y.generateMipmap(3553),Le.unbindTexture()},this.copyTextureToTexture3D=function(ye,je,tt,qe,st=0){if(S.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let si=ye.max.x-ye.min.x+1,Ci=ye.max.y-ye.min.y+1,yi=ye.max.z-ye.min.z+1,Xi=we.convert(qe.format),xr=we.convert(qe.type),Yi;if(qe.isData3DTexture)Ue.setTexture3D(qe,0),Yi=32879;else if(qe.isDataArrayTexture)Ue.setTexture2DArray(qe,0),Yi=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Y.pixelStorei(37440,qe.flipY),Y.pixelStorei(37441,qe.premultiplyAlpha),Y.pixelStorei(3317,qe.unpackAlignment);let Ki=Y.getParameter(3314),tn=Y.getParameter(32878),Us=Y.getParameter(3316),co=Y.getParameter(3315),Po=Y.getParameter(32877),Q=tt.isCompressedTexture?tt.mipmaps[0]:tt.image;Y.pixelStorei(3314,Q.width),Y.pixelStorei(32878,Q.height),Y.pixelStorei(3316,ye.min.x),Y.pixelStorei(3315,ye.min.y),Y.pixelStorei(32877,ye.min.z),tt.isDataTexture||tt.isData3DTexture?Y.texSubImage3D(Yi,st,je.x,je.y,je.z,si,Ci,yi,Xi,xr,Q.data):tt.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Y.compressedTexSubImage3D(Yi,st,je.x,je.y,je.z,si,Ci,yi,Xi,Q.data)):Y.texSubImage3D(Yi,st,je.x,je.y,je.z,si,Ci,yi,Xi,xr,Q),Y.pixelStorei(3314,Ki),Y.pixelStorei(32878,tn),Y.pixelStorei(3316,Us),Y.pixelStorei(3315,co),Y.pixelStorei(32877,Po),st===0&&qe.generateMipmaps&&Y.generateMipmap(Yi),Le.unbindTexture()},this.initTexture=function(ye){Ue.setTexture2D(ye,0),Le.unbindTexture()},this.resetState=function(){T=0,A=0,P=null,Le.reset(),Ve.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Mn.prototype.isWebGLRenderer=!0;var hle=class extends Mn{};hle.prototype.isWebGL1Renderer=!0;var m7=class extends Sn{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(i,e){return super.copy(i,e),i.background!==null&&(this.background=i.background.clone()),i.environment!==null&&(this.environment=i.environment.clone()),i.fog!==null&&(this.fog=i.fog.clone()),i.overrideMaterial!==null&&(this.overrideMaterial=i.overrideMaterial.clone()),this.autoUpdate=i.autoUpdate,this.matrixAutoUpdate=i.matrixAutoUpdate,this}toJSON(i){let e=super.toJSON(i);return this.fog!==null&&(e.object.fog=this.fog.toJSON()),e}};m7.prototype.isScene=!0;var vC=class{constructor(e,t){this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=CA,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=xf()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let n=0,l=this.stride;n<l;n++)this.array[e+n]=t.array[r+n];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=xf()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=xf()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}};vC.prototype.isInterleavedBuffer=!0;var zl=new Te,FR=class{constructor(e,t,r,n=!1){this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=n===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)zl.fromBufferAttribute(this,t),zl.applyMatrix4(e),this.setXYZ(t,zl.x,zl.y,zl.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)zl.fromBufferAttribute(this,t),zl.applyNormalMatrix(e),this.setXYZ(t,zl.x,zl.y,zl.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)zl.fromBufferAttribute(this,t),zl.transformDirection(e),this.setXYZ(t,zl.x,zl.y,zl.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this}setXYZW(e,t,r,n,l){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this.data.array[e+3]=l,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let n=r*this.data.stride+this.offset;for(let l=0;l<this.itemSize;l++)t.push(this.data.array[n+l])}return new Da(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new FR(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let n=r*this.data.stride+this.offset;for(let l=0;l<this.itemSize;l++)t.push(this.data.array[n+l])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}};FR.prototype.isInterleavedBufferAttribute=!0;var $z=class extends za{constructor(i){super(),this.type="SpriteMaterial",this.color=new Ei(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(i)}copy(i){return super.copy(i),this.color.copy(i.color),this.map=i.map,this.alphaMap=i.alphaMap,this.rotation=i.rotation,this.sizeAttenuation=i.sizeAttenuation,this}};$z.prototype.isSpriteMaterial=!0;var Uw,VE=new Te,Hw=new Te,$w=new Te,Vw=new At,WE=new At,g7=new Bi,M2=new Te,jE=new Te,E2=new Te,pH=new At,zO=new At,mH=new At,dle=class extends Sn{constructor(i){if(super(),this.type="Sprite",Uw===void 0){Uw=new vs;let e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),t=new vC(e,5);Uw.setIndex([0,1,2,0,2,3]),Uw.setAttribute("position",new FR(t,3,0,!1)),Uw.setAttribute("uv",new FR(t,2,3,!1))}this.geometry=Uw,this.material=i!==void 0?i:new $z,this.center=new At(.5,.5)}raycast(i,e){i.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Hw.setFromMatrixScale(this.matrixWorld),g7.copy(i.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(i.camera.matrixWorldInverse,this.matrixWorld),$w.setFromMatrixPosition(this.modelViewMatrix),i.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Hw.multiplyScalar(-$w.z);let t=this.material.rotation,r,n;t!==0&&(n=Math.cos(t),r=Math.sin(t));let l=this.center;T2(M2.set(-.5,-.5,0),$w,l,Hw,r,n),T2(jE.set(.5,-.5,0),$w,l,Hw,r,n),T2(E2.set(.5,.5,0),$w,l,Hw,r,n),pH.set(0,0),zO.set(1,0),mH.set(1,1);let c=i.ray.intersectTriangle(M2,jE,E2,!1,VE);if(c===null&&(T2(jE.set(-.5,.5,0),$w,l,Hw,r,n),zO.set(0,1),c=i.ray.intersectTriangle(M2,E2,jE,!1,VE),c===null))return;let h=i.ray.origin.distanceTo(VE);h<i.near||h>i.far||e.push({distance:h,point:VE.clone(),uv:Xa.getUV(VE,M2,jE,E2,pH,zO,mH,new At),face:null,object:this})}copy(i){return super.copy(i),i.center!==void 0&&this.center.copy(i.center),this.material=i.material,this}};dle.prototype.isSprite=!0;function T2(i,e,t,r,n,l){Vw.subVectors(i,t).addScalar(.5).multiply(r),n!==void 0?(WE.x=l*Vw.x-n*Vw.y,WE.y=n*Vw.x+l*Vw.y):WE.copy(Vw),i.copy(e),i.x+=WE.x,i.y+=WE.y,i.applyMatrix4(g7)}var gH=new Te,vH=new wn,yH=new wn,fle=new Te,_H=new Bi,v7=class extends cu{constructor(i,e){super(i,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Bi,this.bindMatrixInverse=new Bi}copy(i){return super.copy(i),this.bindMode=i.bindMode,this.bindMatrix.copy(i.bindMatrix),this.bindMatrixInverse.copy(i.bindMatrixInverse),this.skeleton=i.skeleton,this}bind(i,e){this.skeleton=i,e===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let i=new wn,e=this.geometry.attributes.skinWeight;for(let t=0,r=e.count;t<r;t++){i.fromBufferAttribute(e,t);let n=1/i.manhattanLength();n!==1/0?i.multiplyScalar(n):i.set(1,0,0,0),e.setXYZW(t,i.x,i.y,i.z,i.w)}}updateMatrixWorld(i){super.updateMatrixWorld(i),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(i,e){let t=this.skeleton,r=this.geometry;vH.fromBufferAttribute(r.attributes.skinIndex,i),yH.fromBufferAttribute(r.attributes.skinWeight,i),gH.copy(e).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let n=0;n<4;n++){let l=yH.getComponent(n);if(l!==0){let c=vH.getComponent(n);_H.multiplyMatrices(t.bones[c].matrixWorld,t.boneInverses[c]),e.addScaledVector(fle.copy(gH).applyMatrix4(_H),l)}}return e.applyMatrix4(this.bindMatrixInverse)}};v7.prototype.isSkinnedMesh=!0;var ple=class extends Sn{constructor(){super(),this.type="Bone"}};ple.prototype.isBone=!0;var mle=class extends so{constructor(i=null,e=1,t=1,r,n,l,c,h,d=Ga,f=Ga,m,g){super(null,l,c,h,d,f,r,n,m,g),this.image={data:i,width:e,height:t},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};mle.prototype.isDataTexture=!0;var aF=class extends Da{constructor(e,t,r,n=1){typeof r=="number"&&(n=r,r=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,t,r),this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}};aF.prototype.isInstancedBufferAttribute=!0;var xH=new Bi,bH=new Bi,A2=[],GE=new cu,gle=class extends cu{constructor(i,e,t){super(i,e),this.instanceMatrix=new aF(new Float32Array(t*16),16),this.instanceColor=null,this.count=t,this.frustumCulled=!1}copy(i){return super.copy(i),this.instanceMatrix.copy(i.instanceMatrix),i.instanceColor!==null&&(this.instanceColor=i.instanceColor.clone()),this.count=i.count,this}getColorAt(i,e){e.fromArray(this.instanceColor.array,i*3)}getMatrixAt(i,e){e.fromArray(this.instanceMatrix.array,i*16)}raycast(i,e){let t=this.matrixWorld,r=this.count;if(GE.geometry=this.geometry,GE.material=this.material,GE.material!==void 0)for(let n=0;n<r;n++){this.getMatrixAt(n,xH),bH.multiplyMatrices(t,xH),GE.matrixWorld=bH,GE.raycast(i,A2);for(let l=0,c=A2.length;l<c;l++){let h=A2[l];h.instanceId=n,h.object=this,e.push(h)}A2.length=0}}setColorAt(i,e){this.instanceColor===null&&(this.instanceColor=new aF(new Float32Array(this.instanceMatrix.count*3),3)),e.toArray(this.instanceColor.array,i*3)}setMatrixAt(i,e){e.toArray(this.instanceMatrix.array,i*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}};gle.prototype.isInstancedMesh=!0;var dE=class extends za{constructor(e){super(),this.type="LineBasicMaterial",this.color=new Ei(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this}};dE.prototype.isLineBasicMaterial=!0;var wH=new Te,SH=new Te,MH=new Bi,BO=new uE,C2=new lE,Vz=class extends Sn{constructor(i=new vs,e=new dE){super(),this.type="Line",this.geometry=i,this.material=e,this.updateMorphTargets()}copy(i){return super.copy(i),this.material=i.material,this.geometry=i.geometry,this}computeLineDistances(){let i=this.geometry;if(i.isBufferGeometry)if(i.index===null){let e=i.attributes.position,t=[0];for(let r=1,n=e.count;r<n;r++)wH.fromBufferAttribute(e,r-1),SH.fromBufferAttribute(e,r),t[r]=t[r-1],t[r]+=wH.distanceTo(SH);i.setAttribute("lineDistance",new Ja(t,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else i.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(i,e){let t=this.geometry,r=this.matrixWorld,n=i.params.Line.threshold,l=t.drawRange;if(t.boundingSphere===null&&t.computeBoundingSphere(),C2.copy(t.boundingSphere),C2.applyMatrix4(r),C2.radius+=n,i.ray.intersectsSphere(C2)===!1)return;MH.copy(r).invert(),BO.copy(i.ray).applyMatrix4(MH);let c=n/((this.scale.x+this.scale.y+this.scale.z)/3),h=c*c,d=new Te,f=new Te,m=new Te,g=new Te,y=this.isLineSegments?2:1;if(t.isBufferGeometry){let _=t.index,b=t.attributes.position;if(_!==null){let S=Math.max(0,l.start),E=Math.min(_.count,l.start+l.count);for(let T=S,A=E-1;T<A;T+=y){let P=_.getX(T),O=_.getX(T+1);if(d.fromBufferAttribute(b,P),f.fromBufferAttribute(b,O),BO.distanceSqToSegment(d,f,g,m)>h)continue;g.applyMatrix4(this.matrixWorld);let R=i.ray.origin.distanceTo(g);R<i.near||R>i.far||e.push({distance:R,point:m.clone().applyMatrix4(this.matrixWorld),index:T,face:null,faceIndex:null,object:this})}}else{let S=Math.max(0,l.start),E=Math.min(b.count,l.start+l.count);for(let T=S,A=E-1;T<A;T+=y){if(d.fromBufferAttribute(b,T),f.fromBufferAttribute(b,T+1),BO.distanceSqToSegment(d,f,g,m)>h)continue;g.applyMatrix4(this.matrixWorld);let P=i.ray.origin.distanceTo(g);P<i.near||P>i.far||e.push({distance:P,point:m.clone().applyMatrix4(this.matrixWorld),index:T,face:null,faceIndex:null,object:this})}}}else t.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){let i=this.geometry;if(i.isBufferGeometry){let e=i.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let n=0,l=r.length;n<l;n++){let c=r[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=n}}}}else{let e=i.morphTargets;e!==void 0&&e.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}};Vz.prototype.isLine=!0;var EH=new Te,TH=new Te,Wz=class extends Vz{constructor(i,e){super(i,e),this.type="LineSegments"}computeLineDistances(){let i=this.geometry;if(i.isBufferGeometry)if(i.index===null){let e=i.attributes.position,t=[];for(let r=0,n=e.count;r<n;r+=2)EH.fromBufferAttribute(e,r),TH.fromBufferAttribute(e,r+1),t[r]=r===0?0:t[r-1],t[r+1]=t[r]+EH.distanceTo(TH);i.setAttribute("lineDistance",new Ja(t,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else i.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}};Wz.prototype.isLineSegments=!0;var vle=class extends Vz{constructor(i,e){super(i,e),this.type="LineLoop"}};vle.prototype.isLineLoop=!0;var jz=class extends za{constructor(i){super(),this.type="PointsMaterial",this.color=new Ei(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(i)}copy(i){return super.copy(i),this.color.copy(i.color),this.map=i.map,this.alphaMap=i.alphaMap,this.size=i.size,this.sizeAttenuation=i.sizeAttenuation,this}};jz.prototype.isPointsMaterial=!0;var AH=new Bi,oF=new uE,P2=new lE,R2=new Te,yle=class extends Sn{constructor(i=new vs,e=new jz){super(),this.type="Points",this.geometry=i,this.material=e,this.updateMorphTargets()}copy(i){return super.copy(i),this.material=i.material,this.geometry=i.geometry,this}raycast(i,e){let t=this.geometry,r=this.matrixWorld,n=i.params.Points.threshold,l=t.drawRange;if(t.boundingSphere===null&&t.computeBoundingSphere(),P2.copy(t.boundingSphere),P2.applyMatrix4(r),P2.radius+=n,i.ray.intersectsSphere(P2)===!1)return;AH.copy(r).invert(),oF.copy(i.ray).applyMatrix4(AH);let c=n/((this.scale.x+this.scale.y+this.scale.z)/3),h=c*c;if(t.isBufferGeometry){let d=t.index,f=t.attributes.position;if(d!==null){let m=Math.max(0,l.start),g=Math.min(d.count,l.start+l.count);for(let y=m,_=g;y<_;y++){let b=d.getX(y);R2.fromBufferAttribute(f,b),CH(R2,b,h,r,i,e,this)}}else{let m=Math.max(0,l.start),g=Math.min(f.count,l.start+l.count);for(let y=m,_=g;y<_;y++)R2.fromBufferAttribute(f,y),CH(R2,y,h,r,i,e,this)}}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){let i=this.geometry;if(i.isBufferGeometry){let e=i.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let n=0,l=r.length;n<l;n++){let c=r[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=n}}}}else{let e=i.morphTargets;e!==void 0&&e.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}};yle.prototype.isPoints=!0;function CH(i,e,t,r,n,l,c){let h=oF.distanceSqToPoint(i);if(h<t){let d=new Te;oF.closestPointToPoint(i,d),d.applyMatrix4(r);let f=n.ray.origin.distanceTo(d);if(f<n.near||f>n.far)return;l.push({distance:f,distanceToRay:Math.sqrt(h),point:d,index:e,face:null,object:c})}}var _le=class extends so{constructor(i,e,t,r,n,l,c,h,d){super(i,e,t,r,n,l,c,h,d),this.minFilter=l!==void 0?l:nu,this.magFilter=n!==void 0?n:nu,this.generateMipmaps=!1;let f=this;function m(){f.needsUpdate=!0,i.requestVideoFrameCallback(m)}"requestVideoFrameCallback"in i&&i.requestVideoFrameCallback(m)}clone(){return new this.constructor(this.image).copy(this)}update(){let i=this.image;!("requestVideoFrameCallback"in i)&&i.readyState>=i.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}};_le.prototype.isVideoTexture=!0;var xle=class extends so{constructor(i,e,t){super({width:i,height:e}),this.format=t,this.magFilter=Ga,this.minFilter=Ga,this.generateMipmaps=!1,this.needsUpdate=!0}};xle.prototype.isFramebufferTexture=!0;var ble=class extends so{constructor(i,e,t,r,n,l,c,h,d,f,m,g){super(null,l,c,h,d,f,r,n,m,g),this.image={width:e,height:t},this.mipmaps=i,this.flipY=!1,this.generateMipmaps=!1}};ble.prototype.isCompressedTexture=!0;var wle=class extends so{constructor(i,e,t,r,n,l,c,h,d){super(i,e,t,r,n,l,c,h,d),this.needsUpdate=!0}};wle.prototype.isCanvasTexture=!0;var lc=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],r,n=this.getPoint(0),l=0;t.push(0);for(let c=1;c<=e;c++)r=this.getPoint(c/e),l+=r.distanceTo(n),t.push(l),n=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let r=this.getLengths(),n=0,l=r.length,c;t?c=t:c=e*r[l-1];let h=0,d=l-1,f;for(;h<=d;)if(n=Math.floor(h+(d-h)/2),f=r[n]-c,f<0)h=n+1;else if(f>0)d=n-1;else{d=n;break}if(n=d,r[n]===c)return n/(l-1);let m=r[n],g=r[n+1]-m,y=(c-m)/g;return(n+y)/(l-1)}getTangent(e,t){let r=e-1e-4,n=e+1e-4;r<0&&(r=0),n>1&&(n=1);let l=this.getPoint(r),c=this.getPoint(n),h=t||(l.isVector2?new At:new Te);return h.copy(c).sub(l).normalize(),h}getTangentAt(e,t){let r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){let r=new Te,n=[],l=[],c=[],h=new Te,d=new Bi;for(let _=0;_<=e;_++){let b=_/e;n[_]=this.getTangentAt(b,new Te)}l[0]=new Te,c[0]=new Te;let f=Number.MAX_VALUE,m=Math.abs(n[0].x),g=Math.abs(n[0].y),y=Math.abs(n[0].z);m<=f&&(f=m,r.set(1,0,0)),g<=f&&(f=g,r.set(0,1,0)),y<=f&&r.set(0,0,1),h.crossVectors(n[0],r).normalize(),l[0].crossVectors(n[0],h),c[0].crossVectors(n[0],l[0]);for(let _=1;_<=e;_++){if(l[_]=l[_-1].clone(),c[_]=c[_-1].clone(),h.crossVectors(n[_-1],n[_]),h.length()>Number.EPSILON){h.normalize();let b=Math.acos(So(n[_-1].dot(n[_]),-1,1));l[_].applyMatrix4(d.makeRotationAxis(h,b))}c[_].crossVectors(n[_],l[_])}if(t===!0){let _=Math.acos(So(l[0].dot(l[e]),-1,1));_/=e,n[0].dot(h.crossVectors(l[0],l[e]))>0&&(_=-_);for(let b=1;b<=e;b++)l[b].applyMatrix4(d.makeRotationAxis(n[b],_*b)),c[b].crossVectors(n[b],l[b])}return{tangents:n,normals:l,binormals:c}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},KI=class extends lc{constructor(e=0,t=0,r=1,n=1,l=0,c=Math.PI*2,h=!1,d=0){super(),this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=n,this.aStartAngle=l,this.aEndAngle=c,this.aClockwise=h,this.aRotation=d}getPoint(e,t){let r=t||new At,n=Math.PI*2,l=this.aEndAngle-this.aStartAngle,c=Math.abs(l)<Number.EPSILON;for(;l<0;)l+=n;for(;l>n;)l-=n;l<Number.EPSILON&&(c?l=0:l=n),this.aClockwise===!0&&!c&&(l===n?l=-n:l=l-n);let h=this.aStartAngle+e*l,d=this.aX+this.xRadius*Math.cos(h),f=this.aY+this.yRadius*Math.sin(h);if(this.aRotation!==0){let m=Math.cos(this.aRotation),g=Math.sin(this.aRotation),y=d-this.aX,_=f-this.aY;d=y*m-_*g+this.aX,f=y*g+_*m+this.aY}return r.set(d,f)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}};KI.prototype.isEllipseCurve=!0;var y7=class extends KI{constructor(i,e,t,r,n,l){super(i,e,t,t,r,n,l),this.type="ArcCurve"}};y7.prototype.isArcCurve=!0;function Gz(){let i=0,e=0,t=0,r=0;function n(l,c,h,d){i=l,e=h,t=-3*l+3*c-2*h-d,r=2*l-2*c+h+d}return{initCatmullRom:function(l,c,h,d,f){n(c,h,f*(h-l),f*(d-c))},initNonuniformCatmullRom:function(l,c,h,d,f,m,g){let y=(c-l)/f-(h-l)/(f+m)+(h-c)/m,_=(h-c)/m-(d-c)/(m+g)+(d-h)/g;y*=m,_*=m,n(c,h,y,_)},calc:function(l){let c=l*l,h=c*l;return i+e*l+t*c+r*h}}}var I2=new Te,UO=new Gz,HO=new Gz,$O=new Gz,_7=class extends lc{constructor(i=[],e=!1,t="centripetal",r=.5){super(),this.type="CatmullRomCurve3",this.points=i,this.closed=e,this.curveType=t,this.tension=r}getPoint(i,e=new Te){let t=e,r=this.points,n=r.length,l=(n-(this.closed?0:1))*i,c=Math.floor(l),h=l-c;this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/n)+1)*n:h===0&&c===n-1&&(c=n-2,h=1);let d,f;this.closed||c>0?d=r[(c-1)%n]:(I2.subVectors(r[0],r[1]).add(r[0]),d=I2);let m=r[c%n],g=r[(c+1)%n];if(this.closed||c+2<n?f=r[(c+2)%n]:(I2.subVectors(r[n-1],r[n-2]).add(r[n-1]),f=I2),this.curveType==="centripetal"||this.curveType==="chordal"){let y=this.curveType==="chordal"?.5:.25,_=Math.pow(d.distanceToSquared(m),y),b=Math.pow(m.distanceToSquared(g),y),S=Math.pow(g.distanceToSquared(f),y);b<1e-4&&(b=1),_<1e-4&&(_=b),S<1e-4&&(S=b),UO.initNonuniformCatmullRom(d.x,m.x,g.x,f.x,_,b,S),HO.initNonuniformCatmullRom(d.y,m.y,g.y,f.y,_,b,S),$O.initNonuniformCatmullRom(d.z,m.z,g.z,f.z,_,b,S)}else this.curveType==="catmullrom"&&(UO.initCatmullRom(d.x,m.x,g.x,f.x,this.tension),HO.initCatmullRom(d.y,m.y,g.y,f.y,this.tension),$O.initCatmullRom(d.z,m.z,g.z,f.z,this.tension));return t.set(UO.calc(h),HO.calc(h),$O.calc(h)),t}copy(i){super.copy(i),this.points=[];for(let e=0,t=i.points.length;e<t;e++){let r=i.points[e];this.points.push(r.clone())}return this.closed=i.closed,this.curveType=i.curveType,this.tension=i.tension,this}toJSON(){let i=super.toJSON();i.points=[];for(let e=0,t=this.points.length;e<t;e++){let r=this.points[e];i.points.push(r.toArray())}return i.closed=this.closed,i.curveType=this.curveType,i.tension=this.tension,i}fromJSON(i){super.fromJSON(i),this.points=[];for(let e=0,t=i.points.length;e<t;e++){let r=i.points[e];this.points.push(new Te().fromArray(r))}return this.closed=i.closed,this.curveType=i.curveType,this.tension=i.tension,this}};_7.prototype.isCatmullRomCurve3=!0;function PH(i,e,t,r,n){let l=(r-e)*.5,c=(n-t)*.5,h=i*i,d=i*h;return(2*t-2*r+l+c)*d+(-3*t+3*r-2*l-c)*h+l*i+t}function Sle(i,e){let t=1-i;return t*t*e}function Mle(i,e){return 2*(1-i)*i*e}function Ele(i,e){return i*i*e}function XT(i,e,t,r){return Sle(i,e)+Mle(i,t)+Ele(i,r)}function Tle(i,e){let t=1-i;return t*t*t*e}function Ale(i,e){let t=1-i;return 3*t*t*i*e}function Cle(i,e){return 3*(1-i)*i*i*e}function Ple(i,e){return i*i*i*e}function ZT(i,e,t,r,n){return Tle(i,e)+Ale(i,t)+Cle(i,r)+Ple(i,n)}var qz=class extends lc{constructor(i=new At,e=new At,t=new At,r=new At){super(),this.type="CubicBezierCurve",this.v0=i,this.v1=e,this.v2=t,this.v3=r}getPoint(i,e=new At){let t=e,r=this.v0,n=this.v1,l=this.v2,c=this.v3;return t.set(ZT(i,r.x,n.x,l.x,c.x),ZT(i,r.y,n.y,l.y,c.y)),t}copy(i){return super.copy(i),this.v0.copy(i.v0),this.v1.copy(i.v1),this.v2.copy(i.v2),this.v3.copy(i.v3),this}toJSON(){let i=super.toJSON();return i.v0=this.v0.toArray(),i.v1=this.v1.toArray(),i.v2=this.v2.toArray(),i.v3=this.v3.toArray(),i}fromJSON(i){return super.fromJSON(i),this.v0.fromArray(i.v0),this.v1.fromArray(i.v1),this.v2.fromArray(i.v2),this.v3.fromArray(i.v3),this}};qz.prototype.isCubicBezierCurve=!0;var x7=class extends lc{constructor(i=new Te,e=new Te,t=new Te,r=new Te){super(),this.type="CubicBezierCurve3",this.v0=i,this.v1=e,this.v2=t,this.v3=r}getPoint(i,e=new Te){let t=e,r=this.v0,n=this.v1,l=this.v2,c=this.v3;return t.set(ZT(i,r.x,n.x,l.x,c.x),ZT(i,r.y,n.y,l.y,c.y),ZT(i,r.z,n.z,l.z,c.z)),t}copy(i){return super.copy(i),this.v0.copy(i.v0),this.v1.copy(i.v1),this.v2.copy(i.v2),this.v3.copy(i.v3),this}toJSON(){let i=super.toJSON();return i.v0=this.v0.toArray(),i.v1=this.v1.toArray(),i.v2=this.v2.toArray(),i.v3=this.v3.toArray(),i}fromJSON(i){return super.fromJSON(i),this.v0.fromArray(i.v0),this.v1.fromArray(i.v1),this.v2.fromArray(i.v2),this.v3.fromArray(i.v3),this}};x7.prototype.isCubicBezierCurve3=!0;var QI=class extends lc{constructor(e=new At,t=new At){super(),this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new At){let r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){let r=t||new At;return r.copy(this.v2).sub(this.v1).normalize(),r}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};QI.prototype.isLineCurve=!0;var Rle=class extends lc{constructor(i=new Te,e=new Te){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=i,this.v2=e}getPoint(i,e=new Te){let t=e;return i===1?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(i).add(this.v1)),t}getPointAt(i,e){return this.getPoint(i,e)}copy(i){return super.copy(i),this.v1.copy(i.v1),this.v2.copy(i.v2),this}toJSON(){let i=super.toJSON();return i.v1=this.v1.toArray(),i.v2=this.v2.toArray(),i}fromJSON(i){return super.fromJSON(i),this.v1.fromArray(i.v1),this.v2.fromArray(i.v2),this}},Xz=class extends lc{constructor(i=new At,e=new At,t=new At){super(),this.type="QuadraticBezierCurve",this.v0=i,this.v1=e,this.v2=t}getPoint(i,e=new At){let t=e,r=this.v0,n=this.v1,l=this.v2;return t.set(XT(i,r.x,n.x,l.x),XT(i,r.y,n.y,l.y)),t}copy(i){return super.copy(i),this.v0.copy(i.v0),this.v1.copy(i.v1),this.v2.copy(i.v2),this}toJSON(){let i=super.toJSON();return i.v0=this.v0.toArray(),i.v1=this.v1.toArray(),i.v2=this.v2.toArray(),i}fromJSON(i){return super.fromJSON(i),this.v0.fromArray(i.v0),this.v1.fromArray(i.v1),this.v2.fromArray(i.v2),this}};Xz.prototype.isQuadraticBezierCurve=!0;var b7=class extends lc{constructor(i=new Te,e=new Te,t=new Te){super(),this.type="QuadraticBezierCurve3",this.v0=i,this.v1=e,this.v2=t}getPoint(i,e=new Te){let t=e,r=this.v0,n=this.v1,l=this.v2;return t.set(XT(i,r.x,n.x,l.x),XT(i,r.y,n.y,l.y),XT(i,r.z,n.z,l.z)),t}copy(i){return super.copy(i),this.v0.copy(i.v0),this.v1.copy(i.v1),this.v2.copy(i.v2),this}toJSON(){let i=super.toJSON();return i.v0=this.v0.toArray(),i.v1=this.v1.toArray(),i.v2=this.v2.toArray(),i}fromJSON(i){return super.fromJSON(i),this.v0.fromArray(i.v0),this.v1.fromArray(i.v1),this.v2.fromArray(i.v2),this}};b7.prototype.isQuadraticBezierCurve3=!0;var Zz=class extends lc{constructor(i=[]){super(),this.type="SplineCurve",this.points=i}getPoint(i,e=new At){let t=e,r=this.points,n=(r.length-1)*i,l=Math.floor(n),c=n-l,h=r[l===0?l:l-1],d=r[l],f=r[l>r.length-2?r.length-1:l+1],m=r[l>r.length-3?r.length-1:l+2];return t.set(PH(c,h.x,d.x,f.x,m.x),PH(c,h.y,d.y,f.y,m.y)),t}copy(i){super.copy(i),this.points=[];for(let e=0,t=i.points.length;e<t;e++){let r=i.points[e];this.points.push(r.clone())}return this}toJSON(){let i=super.toJSON();i.points=[];for(let e=0,t=this.points.length;e<t;e++){let r=this.points[e];i.points.push(r.toArray())}return i}fromJSON(i){super.fromJSON(i),this.points=[];for(let e=0,t=i.points.length;e<t;e++){let r=i.points[e];this.points.push(new At().fromArray(r))}return this}};Zz.prototype.isSplineCurve=!0;var w7=Object.freeze({__proto__:null,ArcCurve:y7,CatmullRomCurve3:_7,CubicBezierCurve:qz,CubicBezierCurve3:x7,EllipseCurve:KI,LineCurve:QI,LineCurve3:Rle,QuadraticBezierCurve:Xz,QuadraticBezierCurve3:b7,SplineCurve:Zz}),Ile=class extends lc{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(i){this.curves.push(i)}closePath(){let i=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);i.equals(e)||this.curves.push(new QI(e,i))}getPoint(i,e){let t=i*this.getLength(),r=this.getCurveLengths(),n=0;for(;n<r.length;){if(r[n]>=t){let l=r[n]-t,c=this.curves[n],h=c.getLength(),d=h===0?0:1-l/h;return c.getPointAt(d,e)}n++}return null}getLength(){let i=this.getCurveLengths();return i[i.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let i=[],e=0;for(let t=0,r=this.curves.length;t<r;t++)e+=this.curves[t].getLength(),i.push(e);return this.cacheLengths=i,i}getSpacedPoints(i=40){let e=[];for(let t=0;t<=i;t++)e.push(this.getPoint(t/i));return this.autoClose&&e.push(e[0]),e}getPoints(i=12){let e=[],t;for(let r=0,n=this.curves;r<n.length;r++){let l=n[r],c=l.isEllipseCurve?i*2:l.isLineCurve||l.isLineCurve3?1:l.isSplineCurve?i*l.points.length:i,h=l.getPoints(c);for(let d=0;d<h.length;d++){let f=h[d];t&&t.equals(f)||(e.push(f),t=f)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(i){super.copy(i),this.curves=[];for(let e=0,t=i.curves.length;e<t;e++){let r=i.curves[e];this.curves.push(r.clone())}return this.autoClose=i.autoClose,this}toJSON(){let i=super.toJSON();i.autoClose=this.autoClose,i.curves=[];for(let e=0,t=this.curves.length;e<t;e++){let r=this.curves[e];i.curves.push(r.toJSON())}return i}fromJSON(i){super.fromJSON(i),this.autoClose=i.autoClose,this.curves=[];for(let e=0,t=i.curves.length;e<t;e++){let r=i.curves[e];this.curves.push(new w7[r.type]().fromJSON(r))}return this}},lF=class extends Ile{constructor(i){super(),this.type="Path",this.currentPoint=new At,i&&this.setFromPoints(i)}setFromPoints(i){this.moveTo(i[0].x,i[0].y);for(let e=1,t=i.length;e<t;e++)this.lineTo(i[e].x,i[e].y);return this}moveTo(i,e){return this.currentPoint.set(i,e),this}lineTo(i,e){let t=new QI(this.currentPoint.clone(),new At(i,e));return this.curves.push(t),this.currentPoint.set(i,e),this}quadraticCurveTo(i,e,t,r){let n=new Xz(this.currentPoint.clone(),new At(i,e),new At(t,r));return this.curves.push(n),this.currentPoint.set(t,r),this}bezierCurveTo(i,e,t,r,n,l){let c=new qz(this.currentPoint.clone(),new At(i,e),new At(t,r),new At(n,l));return this.curves.push(c),this.currentPoint.set(n,l),this}splineThru(i){let e=[this.currentPoint.clone()].concat(i),t=new Zz(e);return this.curves.push(t),this.currentPoint.copy(i[i.length-1]),this}arc(i,e,t,r,n,l){let c=this.currentPoint.x,h=this.currentPoint.y;return this.absarc(i+c,e+h,t,r,n,l),this}absarc(i,e,t,r,n,l){return this.absellipse(i,e,t,t,r,n,l),this}ellipse(i,e,t,r,n,l,c,h){let d=this.currentPoint.x,f=this.currentPoint.y;return this.absellipse(i+d,e+f,t,r,n,l,c,h),this}absellipse(i,e,t,r,n,l,c,h){let d=new KI(i,e,t,r,n,l,c,h);if(this.curves.length>0){let m=d.getPoint(0);m.equals(this.currentPoint)||this.lineTo(m.x,m.y)}this.curves.push(d);let f=d.getPoint(1);return this.currentPoint.copy(f),this}copy(i){return super.copy(i),this.currentPoint.copy(i.currentPoint),this}toJSON(){let i=super.toJSON();return i.currentPoint=this.currentPoint.toArray(),i}fromJSON(i){return super.fromJSON(i),this.currentPoint.fromArray(i.currentPoint),this}},fE=class extends lF{constructor(e){super(e),this.uuid=xf(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let r=0,n=this.holes.length;r<n;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let n=e.holes[t];this.holes.push(n.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){let n=this.holes[t];e.holes.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let n=e.holes[t];this.holes.push(new lF().fromJSON(n))}return this}},Lle={triangulate:function(i,e,t=2){let r=e&&e.length,n=r?e[0]*t:i.length,l=S7(i,0,n,t,!0),c=[];if(!l||l.next===l.prev)return c;let h,d,f,m,g,y,_;if(r&&(l=Fle(i,e,l,t)),i.length>80*t){h=f=i[0],d=m=i[1];for(let b=t;b<n;b+=t)g=i[b],y=i[b+1],g<h&&(h=g),y<d&&(d=y),g>f&&(f=g),y>m&&(m=y);_=Math.max(f-h,m-d),_=_!==0?1/_:0}return RA(l,c,t,h,d,_),c}};function S7(i,e,t,r,n){let l,c;if(n===Xle(i,e,t,r)>0)for(l=e;l<t;l+=r)c=RH(l,i[l],i[l+1],c);else for(l=t-r;l>=e;l-=r)c=RH(l,i[l],i[l+1],c);return c&&eL(c,c.next)&&(LA(c),c=c.next),c}function Jm(i,e){if(!i)return i;e||(e=i);let t=i,r;do if(r=!1,!t.steiner&&(eL(t,t.next)||ps(t.prev,t,t.next)===0)){if(LA(t),t=e=t.prev,t===t.next)break;r=!0}else t=t.next;while(r||t!==e);return e}function RA(i,e,t,r,n,l,c){if(!i)return;!c&&l&&$le(i,r,n,l);let h=i,d,f;for(;i.prev!==i.next;){if(d=i.prev,f=i.next,l?Nle(i,r,n,l):Ole(i)){e.push(d.i/t),e.push(i.i/t),e.push(f.i/t),LA(i),i=f.next,h=f.next;continue}if(i=f,i===h){c?c===1?(i=Dle(Jm(i),e,t),RA(i,e,t,r,n,l,2)):c===2&&kle(i,e,t,r,n,l):RA(Jm(i),e,t,r,n,l,1);break}}}function Ole(i){let e=i.prev,t=i,r=i.next;if(ps(e,t,r)>=0)return!1;let n=i.next.next;for(;n!==i.prev;){if(QS(e.x,e.y,t.x,t.y,r.x,r.y,n.x,n.y)&&ps(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function Nle(i,e,t,r){let n=i.prev,l=i,c=i.next;if(ps(n,l,c)>=0)return!1;let h=n.x<l.x?n.x<c.x?n.x:c.x:l.x<c.x?l.x:c.x,d=n.y<l.y?n.y<c.y?n.y:c.y:l.y<c.y?l.y:c.y,f=n.x>l.x?n.x>c.x?n.x:c.x:l.x>c.x?l.x:c.x,m=n.y>l.y?n.y>c.y?n.y:c.y:l.y>c.y?l.y:c.y,g=uF(h,d,e,t,r),y=uF(f,m,e,t,r),_=i.prevZ,b=i.nextZ;for(;_&&_.z>=g&&b&&b.z<=y;){if(_!==i.prev&&_!==i.next&&QS(n.x,n.y,l.x,l.y,c.x,c.y,_.x,_.y)&&ps(_.prev,_,_.next)>=0||(_=_.prevZ,b!==i.prev&&b!==i.next&&QS(n.x,n.y,l.x,l.y,c.x,c.y,b.x,b.y)&&ps(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;_&&_.z>=g;){if(_!==i.prev&&_!==i.next&&QS(n.x,n.y,l.x,l.y,c.x,c.y,_.x,_.y)&&ps(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;b&&b.z<=y;){if(b!==i.prev&&b!==i.next&&QS(n.x,n.y,l.x,l.y,c.x,c.y,b.x,b.y)&&ps(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function Dle(i,e,t){let r=i;do{let n=r.prev,l=r.next.next;!eL(n,l)&&M7(n,r,r.next,l)&&IA(n,l)&&IA(l,n)&&(e.push(n.i/t),e.push(r.i/t),e.push(l.i/t),LA(r),LA(r.next),r=i=l),r=r.next}while(r!==i);return Jm(r)}function kle(i,e,t,r,n,l){let c=i;do{let h=c.next.next;for(;h!==c.prev;){if(c.i!==h.i&&jle(c,h)){let d=E7(c,h);c=Jm(c,c.next),d=Jm(d,d.next),RA(c,e,t,r,n,l),RA(d,e,t,r,n,l);return}h=h.next}c=c.next}while(c!==i)}function Fle(i,e,t,r){let n=[],l,c,h,d,f;for(l=0,c=e.length;l<c;l++)h=e[l]*r,d=l<c-1?e[l+1]*r:i.length,f=S7(i,h,d,r,!1),f===f.next&&(f.steiner=!0),n.push(Wle(f));for(n.sort(zle),l=0;l<n.length;l++)Ble(n[l],t),t=Jm(t,t.next);return t}function zle(i,e){return i.x-e.x}function Ble(i,e){if(e=Ule(i,e),e){let t=E7(e,i);Jm(e,e.next),Jm(t,t.next)}}function Ule(i,e){let t=e,r=i.x,n=i.y,l=-1/0,c;do{if(n<=t.y&&n>=t.next.y&&t.next.y!==t.y){let y=t.x+(n-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(y<=r&&y>l){if(l=y,y===r){if(n===t.y)return t;if(n===t.next.y)return t.next}c=t.x<t.next.x?t:t.next}}t=t.next}while(t!==e);if(!c)return null;if(r===l)return c;let h=c,d=c.x,f=c.y,m=1/0,g;t=c;do r>=t.x&&t.x>=d&&r!==t.x&&QS(n<f?r:l,n,d,f,n<f?l:r,n,t.x,t.y)&&(g=Math.abs(n-t.y)/(r-t.x),IA(t,i)&&(g<m||g===m&&(t.x>c.x||t.x===c.x&&Hle(c,t)))&&(c=t,m=g)),t=t.next;while(t!==h);return c}function Hle(i,e){return ps(i.prev,i,e.prev)<0&&ps(e.next,i,i.next)<0}function $le(i,e,t,r){let n=i;do n.z===null&&(n.z=uF(n.x,n.y,e,t,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==i);n.prevZ.nextZ=null,n.prevZ=null,Vle(n)}function Vle(i){let e,t,r,n,l,c,h,d,f=1;do{for(t=i,i=null,l=null,c=0;t;){for(c++,r=t,h=0,e=0;e<f&&(h++,r=r.nextZ,!!r);e++);for(d=f;h>0||d>0&&r;)h!==0&&(d===0||!r||t.z<=r.z)?(n=t,t=t.nextZ,h--):(n=r,r=r.nextZ,d--),l?l.nextZ=n:i=n,n.prevZ=l,l=n;t=r}l.nextZ=null,f*=2}while(c>1);return i}function uF(i,e,t,r,n){return i=32767*(i-t)*n,e=32767*(e-r)*n,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}function Wle(i){let e=i,t=i;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==i);return t}function QS(i,e,t,r,n,l,c,h){return(n-c)*(e-h)-(i-c)*(l-h)>=0&&(i-c)*(r-h)-(t-c)*(e-h)>=0&&(t-c)*(l-h)-(n-c)*(r-h)>=0}function jle(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!Gle(i,e)&&(IA(i,e)&&IA(e,i)&&qle(i,e)&&(ps(i.prev,i,e.prev)||ps(i,e.prev,e))||eL(i,e)&&ps(i.prev,i,i.next)>0&&ps(e.prev,e,e.next)>0)}function ps(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function eL(i,e){return i.x===e.x&&i.y===e.y}function M7(i,e,t,r){let n=O2(ps(i,e,t)),l=O2(ps(i,e,r)),c=O2(ps(t,r,i)),h=O2(ps(t,r,e));return!!(n!==l&&c!==h||n===0&&L2(i,t,e)||l===0&&L2(i,r,e)||c===0&&L2(t,i,r)||h===0&&L2(t,e,r))}function L2(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function O2(i){return i>0?1:i<0?-1:0}function Gle(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&M7(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}function IA(i,e){return ps(i.prev,i,i.next)<0?ps(i,e,i.next)>=0&&ps(i,i.prev,e)>=0:ps(i,e,i.prev)<0||ps(i,i.next,e)<0}function qle(i,e){let t=i,r=!1,n=(i.x+e.x)/2,l=(i.y+e.y)/2;do t.y>l!=t.next.y>l&&t.next.y!==t.y&&n<(t.next.x-t.x)*(l-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next;while(t!==i);return r}function E7(i,e){let t=new cF(i.i,i.x,i.y),r=new cF(e.i,e.x,e.y),n=i.next,l=e.prev;return i.next=e,e.prev=i,t.next=n,n.prev=t,r.next=t,t.prev=r,l.next=r,r.prev=l,r}function RH(i,e,t,r){let n=new cF(i,e,t);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function LA(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function cF(i,e,t){this.i=i,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Xle(i,e,t,r){let n=0;for(let l=e,c=t-r;l<t;l+=r)n+=(i[c]-i[l])*(i[l+1]+i[c+1]),c=l;return n}var G1=class{static area(e){let t=e.length,r=0;for(let n=t-1,l=0;l<t;n=l++)r+=e[n].x*e[l].y-e[l].x*e[n].y;return r*.5}static isClockWise(e){return G1.area(e)<0}static triangulateShape(e,t){let r=[],n=[],l=[];IH(e),LH(r,e);let c=e.length;t.forEach(IH);for(let d=0;d<t.length;d++)n.push(c),c+=t[d].length,LH(r,t[d]);let h=Lle.triangulate(r,n);for(let d=0;d<h.length;d+=3)l.push(h.slice(d,d+3));return l}};function IH(i){let e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}function LH(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}var yC=class extends vs{constructor(e=new fE([new At(.5,.5),new At(-.5,.5),new At(-.5,-.5),new At(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];let r=this,n=[],l=[];for(let h=0,d=e.length;h<d;h++){let f=e[h];c(f)}this.setAttribute("position",new Ja(n,3)),this.setAttribute("uv",new Ja(l,2)),this.computeVertexNormals();function c(h){let d=[],f=t.curveSegments!==void 0?t.curveSegments:12,m=t.steps!==void 0?t.steps:1,g=t.depth!==void 0?t.depth:1,y=t.bevelEnabled!==void 0?t.bevelEnabled:!0,_=t.bevelThickness!==void 0?t.bevelThickness:.2,b=t.bevelSize!==void 0?t.bevelSize:_-.1,S=t.bevelOffset!==void 0?t.bevelOffset:0,E=t.bevelSegments!==void 0?t.bevelSegments:3,T=t.extrudePath,A=t.UVGenerator!==void 0?t.UVGenerator:Zle;t.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),g=t.amount);let P,O=!1,R,D,L,N;T&&(P=T.getSpacedPoints(m),O=!0,y=!1,R=T.computeFrenetFrames(m,!1),D=new Te,L=new Te,N=new Te),y||(E=0,_=0,b=0,S=0);let U=h.extractPoints(f),F=U.shape,z=U.holes;if(!G1.isClockWise(F)){F=F.reverse();for(let Ce=0,Ae=z.length;Ce<Ae;Ce++){let Ue=z[Ce];G1.isClockWise(Ue)&&(z[Ce]=Ue.reverse())}}let G=G1.triangulateShape(F,z),J=F;for(let Ce=0,Ae=z.length;Ce<Ae;Ce++){let Ue=z[Ce];F=F.concat(Ue)}function Z(Ce,Ae,Ue){return Ae||console.error("THREE.ExtrudeGeometry: vec does not exist"),Ae.clone().multiplyScalar(Ue).add(Ce)}let q=F.length,$=G.length;function H(Ce,Ae,Ue){let Ne,Ge,Ct,it=Ce.x-Ae.x,bt=Ce.y-Ae.y,Kt=Ue.x-Ce.x,kt=Ue.y-Ce.y,Pt=it*it+bt*bt,_e=it*kt-bt*Kt;if(Math.abs(_e)>Number.EPSILON){let ce=Math.sqrt(Pt),Fe=Math.sqrt(Kt*Kt+kt*kt),et=Ae.x-bt/ce,Dt=Ae.y+it/ce,gt=Ue.x-kt/Fe,xe=Ue.y+Kt/Fe,we=((gt-et)*kt-(xe-Dt)*Kt)/(it*kt-bt*Kt);Ne=et+it*we-Ce.x,Ge=Dt+bt*we-Ce.y;let Ve=Ne*Ne+Ge*Ge;if(Ve<=2)return new At(Ne,Ge);Ct=Math.sqrt(Ve/2)}else{let ce=!1;it>Number.EPSILON?Kt>Number.EPSILON&&(ce=!0):it<-Number.EPSILON?Kt<-Number.EPSILON&&(ce=!0):Math.sign(bt)===Math.sign(kt)&&(ce=!0),ce?(Ne=-bt,Ge=it,Ct=Math.sqrt(Pt)):(Ne=it,Ge=bt,Ct=Math.sqrt(Pt/2))}return new At(Ne/Ct,Ge/Ct)}let X=[];for(let Ce=0,Ae=J.length,Ue=Ae-1,Ne=Ce+1;Ce<Ae;Ce++,Ue++,Ne++)Ue===Ae&&(Ue=0),Ne===Ae&&(Ne=0),X[Ce]=H(J[Ce],J[Ue],J[Ne]);let re=[],ae,he=X.concat();for(let Ce=0,Ae=z.length;Ce<Ae;Ce++){let Ue=z[Ce];ae=[];for(let Ne=0,Ge=Ue.length,Ct=Ge-1,it=Ne+1;Ne<Ge;Ne++,Ct++,it++)Ct===Ge&&(Ct=0),it===Ge&&(it=0),ae[Ne]=H(Ue[Ne],Ue[Ct],Ue[it]);re.push(ae),he=he.concat(ae)}for(let Ce=0;Ce<E;Ce++){let Ae=Ce/E,Ue=_*Math.cos(Ae*Math.PI/2),Ne=b*Math.sin(Ae*Math.PI/2)+S;for(let Ge=0,Ct=J.length;Ge<Ct;Ge++){let it=Z(J[Ge],X[Ge],Ne);Y(it.x,it.y,-Ue)}for(let Ge=0,Ct=z.length;Ge<Ct;Ge++){let it=z[Ge];ae=re[Ge];for(let bt=0,Kt=it.length;bt<Kt;bt++){let kt=Z(it[bt],ae[bt],Ne);Y(kt.x,kt.y,-Ue)}}}let pe=b+S;for(let Ce=0;Ce<q;Ce++){let Ae=y?Z(F[Ce],he[Ce],pe):F[Ce];O?(L.copy(R.normals[0]).multiplyScalar(Ae.x),D.copy(R.binormals[0]).multiplyScalar(Ae.y),N.copy(P[0]).add(L).add(D),Y(N.x,N.y,N.z)):Y(Ae.x,Ae.y,0)}for(let Ce=1;Ce<=m;Ce++)for(let Ae=0;Ae<q;Ae++){let Ue=y?Z(F[Ae],he[Ae],pe):F[Ae];O?(L.copy(R.normals[Ce]).multiplyScalar(Ue.x),D.copy(R.binormals[Ce]).multiplyScalar(Ue.y),N.copy(P[Ce]).add(L).add(D),Y(N.x,N.y,N.z)):Y(Ue.x,Ue.y,g/m*Ce)}for(let Ce=E-1;Ce>=0;Ce--){let Ae=Ce/E,Ue=_*Math.cos(Ae*Math.PI/2),Ne=b*Math.sin(Ae*Math.PI/2)+S;for(let Ge=0,Ct=J.length;Ge<Ct;Ge++){let it=Z(J[Ge],X[Ge],Ne);Y(it.x,it.y,g+Ue)}for(let Ge=0,Ct=z.length;Ge<Ct;Ge++){let it=z[Ge];ae=re[Ge];for(let bt=0,Kt=it.length;bt<Kt;bt++){let kt=Z(it[bt],ae[bt],Ne);O?Y(kt.x,kt.y+P[m-1].y,P[m-1].x+Ue):Y(kt.x,kt.y,g+Ue)}}}de(),ee();function de(){let Ce=n.length/3;if(y){let Ae=0,Ue=q*Ae;for(let Ne=0;Ne<$;Ne++){let Ge=G[Ne];fe(Ge[2]+Ue,Ge[1]+Ue,Ge[0]+Ue)}Ae=m+E*2,Ue=q*Ae;for(let Ne=0;Ne<$;Ne++){let Ge=G[Ne];fe(Ge[0]+Ue,Ge[1]+Ue,Ge[2]+Ue)}}else{for(let Ae=0;Ae<$;Ae++){let Ue=G[Ae];fe(Ue[2],Ue[1],Ue[0])}for(let Ae=0;Ae<$;Ae++){let Ue=G[Ae];fe(Ue[0]+q*m,Ue[1]+q*m,Ue[2]+q*m)}}r.addGroup(Ce,n.length/3-Ce,0)}function ee(){let Ce=n.length/3,Ae=0;se(J,Ae),Ae+=J.length;for(let Ue=0,Ne=z.length;Ue<Ne;Ue++){let Ge=z[Ue];se(Ge,Ae),Ae+=Ge.length}r.addGroup(Ce,n.length/3-Ce,1)}function se(Ce,Ae){let Ue=Ce.length;for(;--Ue>=0;){let Ne=Ue,Ge=Ue-1;Ge<0&&(Ge=Ce.length-1);for(let Ct=0,it=m+E*2;Ct<it;Ct++){let bt=q*Ct,Kt=q*(Ct+1),kt=Ae+Ne+bt,Pt=Ae+Ge+bt,_e=Ae+Ge+Kt,ce=Ae+Ne+Kt;me(kt,Pt,_e,ce)}}}function Y(Ce,Ae,Ue){d.push(Ce),d.push(Ae),d.push(Ue)}function fe(Ce,Ae,Ue){De(Ce),De(Ae),De(Ue);let Ne=n.length/3,Ge=A.generateTopUV(r,n,Ne-3,Ne-2,Ne-1);Le(Ge[0]),Le(Ge[1]),Le(Ge[2])}function me(Ce,Ae,Ue,Ne){De(Ce),De(Ae),De(Ne),De(Ae),De(Ue),De(Ne);let Ge=n.length/3,Ct=A.generateSideWallUV(r,n,Ge-6,Ge-3,Ge-2,Ge-1);Le(Ct[0]),Le(Ct[1]),Le(Ct[3]),Le(Ct[1]),Le(Ct[2]),Le(Ct[3])}function De(Ce){n.push(d[Ce*3+0]),n.push(d[Ce*3+1]),n.push(d[Ce*3+2])}function Le(Ce){l.push(Ce.x),l.push(Ce.y)}}}toJSON(){let e=super.toJSON(),t=this.parameters.shapes,r=this.parameters.options;return Jle(t,r,e)}static fromJSON(e,t){let r=[];for(let l=0,c=e.shapes.length;l<c;l++){let h=t[e.shapes[l]];r.push(h)}let n=e.options.extrudePath;return n!==void 0&&(e.options.extrudePath=new w7[n.type]().fromJSON(n)),new yC(r,e.options)}},Zle={generateTopUV:function(i,e,t,r,n){let l=e[t*3],c=e[t*3+1],h=e[r*3],d=e[r*3+1],f=e[n*3],m=e[n*3+1];return[new At(l,c),new At(h,d),new At(f,m)]},generateSideWallUV:function(i,e,t,r,n,l){let c=e[t*3],h=e[t*3+1],d=e[t*3+2],f=e[r*3],m=e[r*3+1],g=e[r*3+2],y=e[n*3],_=e[n*3+1],b=e[n*3+2],S=e[l*3],E=e[l*3+1],T=e[l*3+2];return Math.abs(h-m)<Math.abs(c-f)?[new At(c,1-d),new At(f,1-g),new At(y,1-b),new At(S,1-T)]:[new At(h,1-d),new At(m,1-g),new At(_,1-b),new At(E,1-T)]}};function Jle(i,e,t){if(t.shapes=[],Array.isArray(i))for(let r=0,n=i.length;r<n;r++){let l=i[r];t.shapes.push(l.uuid)}else t.shapes.push(i.uuid);return e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}var T7=class extends vs{constructor(i=new fE([new At(0,.5),new At(-.5,-.5),new At(.5,-.5)]),e=12){super(),this.type="ShapeGeometry",this.parameters={shapes:i,curveSegments:e};let t=[],r=[],n=[],l=[],c=0,h=0;if(Array.isArray(i)===!1)d(i);else for(let f=0;f<i.length;f++)d(i[f]),this.addGroup(c,h,f),c+=h,h=0;this.setIndex(t),this.setAttribute("position",new Ja(r,3)),this.setAttribute("normal",new Ja(n,3)),this.setAttribute("uv",new Ja(l,2));function d(f){let m=r.length/3,g=f.extractPoints(e),y=g.shape,_=g.holes;G1.isClockWise(y)===!1&&(y=y.reverse());for(let S=0,E=_.length;S<E;S++){let T=_[S];G1.isClockWise(T)===!0&&(_[S]=T.reverse())}let b=G1.triangulateShape(y,_);for(let S=0,E=_.length;S<E;S++){let T=_[S];y=y.concat(T)}for(let S=0,E=y.length;S<E;S++){let T=y[S];r.push(T.x,T.y,0),n.push(0,0,1),l.push(T.x,T.y)}for(let S=0,E=b.length;S<E;S++){let T=b[S],A=T[0]+m,P=T[1]+m,O=T[2]+m;t.push(A,P,O),h+=3}}}toJSON(){let i=super.toJSON(),e=this.parameters.shapes;return Yle(e,i)}static fromJSON(i,e){let t=[];for(let r=0,n=i.shapes.length;r<n;r++){let l=e[i.shapes[r]];t.push(l)}return new T7(t,i.curveSegments)}};function Yle(i,e){if(e.shapes=[],Array.isArray(i))for(let t=0,r=i.length;t<r;t++){let n=i[t];e.shapes.push(n.uuid)}else e.shapes.push(i.uuid);return e}var A7=class extends za{constructor(i){super(),this.type="ShadowMaterial",this.color=new Ei(0),this.transparent=!0,this.setValues(i)}copy(i){return super.copy(i),this.color.copy(i.color),this}};A7.prototype.isShadowMaterial=!0;var C7=class extends Xd{constructor(i){super(i),this.type="RawShaderMaterial"}};C7.prototype.isRawShaderMaterial=!0;var Jz=class extends za{constructor(i){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ei(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ei(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=oE,this.normalScale=new At(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(i)}copy(i){return super.copy(i),this.defines={STANDARD:""},this.color.copy(i.color),this.roughness=i.roughness,this.metalness=i.metalness,this.map=i.map,this.lightMap=i.lightMap,this.lightMapIntensity=i.lightMapIntensity,this.aoMap=i.aoMap,this.aoMapIntensity=i.aoMapIntensity,this.emissive.copy(i.emissive),this.emissiveMap=i.emissiveMap,this.emissiveIntensity=i.emissiveIntensity,this.bumpMap=i.bumpMap,this.bumpScale=i.bumpScale,this.normalMap=i.normalMap,this.normalMapType=i.normalMapType,this.normalScale.copy(i.normalScale),this.displacementMap=i.displacementMap,this.displacementScale=i.displacementScale,this.displacementBias=i.displacementBias,this.roughnessMap=i.roughnessMap,this.metalnessMap=i.metalnessMap,this.alphaMap=i.alphaMap,this.envMap=i.envMap,this.envMapIntensity=i.envMapIntensity,this.wireframe=i.wireframe,this.wireframeLinewidth=i.wireframeLinewidth,this.wireframeLinecap=i.wireframeLinecap,this.wireframeLinejoin=i.wireframeLinejoin,this.flatShading=i.flatShading,this}};Jz.prototype.isMeshStandardMaterial=!0;var P7=class extends Jz{constructor(i){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new At(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return So(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.sheenColor=new Ei(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new Ei(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Ei(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(i)}get sheen(){return this._sheen}set sheen(i){this._sheen>0!=i>0&&this.version++,this._sheen=i}get clearcoat(){return this._clearcoat}set clearcoat(i){this._clearcoat>0!=i>0&&this.version++,this._clearcoat=i}get transmission(){return this._transmission}set transmission(i){this._transmission>0!=i>0&&this.version++,this._transmission=i}copy(i){return super.copy(i),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=i.clearcoat,this.clearcoatMap=i.clearcoatMap,this.clearcoatRoughness=i.clearcoatRoughness,this.clearcoatRoughnessMap=i.clearcoatRoughnessMap,this.clearcoatNormalMap=i.clearcoatNormalMap,this.clearcoatNormalScale.copy(i.clearcoatNormalScale),this.ior=i.ior,this.sheen=i.sheen,this.sheenColor.copy(i.sheenColor),this.sheenColorMap=i.sheenColorMap,this.sheenRoughness=i.sheenRoughness,this.sheenRoughnessMap=i.sheenRoughnessMap,this.transmission=i.transmission,this.transmissionMap=i.transmissionMap,this.thickness=i.thickness,this.thicknessMap=i.thicknessMap,this.attenuationDistance=i.attenuationDistance,this.attenuationColor.copy(i.attenuationColor),this.specularIntensity=i.specularIntensity,this.specularIntensityMap=i.specularIntensityMap,this.specularColor.copy(i.specularColor),this.specularColorMap=i.specularColorMap,this}};P7.prototype.isMeshPhysicalMaterial=!0;var R7=class extends za{constructor(i){super(),this.type="MeshPhongMaterial",this.color=new Ei(16777215),this.specular=new Ei(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ei(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=oE,this.normalScale=new At(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=VI,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(i)}copy(i){return super.copy(i),this.color.copy(i.color),this.specular.copy(i.specular),this.shininess=i.shininess,this.map=i.map,this.lightMap=i.lightMap,this.lightMapIntensity=i.lightMapIntensity,this.aoMap=i.aoMap,this.aoMapIntensity=i.aoMapIntensity,this.emissive.copy(i.emissive),this.emissiveMap=i.emissiveMap,this.emissiveIntensity=i.emissiveIntensity,this.bumpMap=i.bumpMap,this.bumpScale=i.bumpScale,this.normalMap=i.normalMap,this.normalMapType=i.normalMapType,this.normalScale.copy(i.normalScale),this.displacementMap=i.displacementMap,this.displacementScale=i.displacementScale,this.displacementBias=i.displacementBias,this.specularMap=i.specularMap,this.alphaMap=i.alphaMap,this.envMap=i.envMap,this.combine=i.combine,this.reflectivity=i.reflectivity,this.refractionRatio=i.refractionRatio,this.wireframe=i.wireframe,this.wireframeLinewidth=i.wireframeLinewidth,this.wireframeLinecap=i.wireframeLinecap,this.wireframeLinejoin=i.wireframeLinejoin,this.flatShading=i.flatShading,this}};R7.prototype.isMeshPhongMaterial=!0;var I7=class extends za{constructor(i){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ei(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ei(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=oE,this.normalScale=new At(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(i)}copy(i){return super.copy(i),this.color.copy(i.color),this.map=i.map,this.gradientMap=i.gradientMap,this.lightMap=i.lightMap,this.lightMapIntensity=i.lightMapIntensity,this.aoMap=i.aoMap,this.aoMapIntensity=i.aoMapIntensity,this.emissive.copy(i.emissive),this.emissiveMap=i.emissiveMap,this.emissiveIntensity=i.emissiveIntensity,this.bumpMap=i.bumpMap,this.bumpScale=i.bumpScale,this.normalMap=i.normalMap,this.normalMapType=i.normalMapType,this.normalScale.copy(i.normalScale),this.displacementMap=i.displacementMap,this.displacementScale=i.displacementScale,this.displacementBias=i.displacementBias,this.alphaMap=i.alphaMap,this.wireframe=i.wireframe,this.wireframeLinewidth=i.wireframeLinewidth,this.wireframeLinecap=i.wireframeLinecap,this.wireframeLinejoin=i.wireframeLinejoin,this}};I7.prototype.isMeshToonMaterial=!0;var L7=class extends za{constructor(i){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=oE,this.normalScale=new At(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(i)}copy(i){return super.copy(i),this.bumpMap=i.bumpMap,this.bumpScale=i.bumpScale,this.normalMap=i.normalMap,this.normalMapType=i.normalMapType,this.normalScale.copy(i.normalScale),this.displacementMap=i.displacementMap,this.displacementScale=i.displacementScale,this.displacementBias=i.displacementBias,this.wireframe=i.wireframe,this.wireframeLinewidth=i.wireframeLinewidth,this.flatShading=i.flatShading,this}};L7.prototype.isMeshNormalMaterial=!0;var O7=class extends za{constructor(e){super(),this.type="MeshLambertMaterial",this.color=new Ei(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ei(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=VI,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}};O7.prototype.isMeshLambertMaterial=!0;var N7=class extends za{constructor(e){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ei(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=oE,this.normalScale=new At(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}};N7.prototype.isMeshMatcapMaterial=!0;var D7=class extends dE{constructor(e){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}};D7.prototype.isLineDashedMaterial=!0;var Kle={ShadowMaterial:A7,SpriteMaterial:$z,RawShaderMaterial:C7,ShaderMaterial:Xd,PointsMaterial:jz,MeshPhysicalMaterial:P7,MeshStandardMaterial:Jz,MeshPhongMaterial:R7,MeshToonMaterial:I7,MeshNormalMaterial:L7,MeshLambertMaterial:O7,MeshDepthMaterial:Uz,MeshDistanceMaterial:Hz,MeshBasicMaterial:qI,MeshMatcapMaterial:N7,LineDashedMaterial:D7,LineBasicMaterial:dE,Material:za};za.fromType=function(i){return new Kle[i]};var Gn={arraySlice:function(i,e,t){return Gn.isTypedArray(i)?new i.constructor(i.subarray(e,t!==void 0?t:i.length)):i.slice(e,t)},convertArray:function(i,e,t){return!i||!t&&i.constructor===e?i:typeof e.BYTES_PER_ELEMENT=="number"?new e(i):Array.prototype.slice.call(i)},isTypedArray:function(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)},getKeyframeOrder:function(i){function e(n,l){return i[n]-i[l]}let t=i.length,r=new Array(t);for(let n=0;n!==t;++n)r[n]=n;return r.sort(e),r},sortedArray:function(i,e,t){let r=i.length,n=new i.constructor(r);for(let l=0,c=0;c!==r;++l){let h=t[l]*e;for(let d=0;d!==e;++d)n[c++]=i[h+d]}return n},flattenJSON:function(i,e,t,r){let n=1,l=i[0];for(;l!==void 0&&l[r]===void 0;)l=i[n++];if(l===void 0)return;let c=l[r];if(c!==void 0)if(Array.isArray(c))do c=l[r],c!==void 0&&(e.push(l.time),t.push.apply(t,c)),l=i[n++];while(l!==void 0);else if(c.toArray!==void 0)do c=l[r],c!==void 0&&(e.push(l.time),c.toArray(t,t.length)),l=i[n++];while(l!==void 0);else do c=l[r],c!==void 0&&(e.push(l.time),t.push(c)),l=i[n++];while(l!==void 0)},subclip:function(i,e,t,r,n=30){let l=i.clone();l.name=e;let c=[];for(let d=0;d<l.tracks.length;++d){let f=l.tracks[d],m=f.getValueSize(),g=[],y=[];for(let _=0;_<f.times.length;++_){let b=f.times[_]*n;if(!(b<t||b>=r)){g.push(f.times[_]);for(let S=0;S<m;++S)y.push(f.values[_*m+S])}}g.length!==0&&(f.times=Gn.convertArray(g,f.times.constructor),f.values=Gn.convertArray(y,f.values.constructor),c.push(f))}l.tracks=c;let h=1/0;for(let d=0;d<l.tracks.length;++d)h>l.tracks[d].times[0]&&(h=l.tracks[d].times[0]);for(let d=0;d<l.tracks.length;++d)l.tracks[d].shift(-1*h);return l.resetDuration(),l},makeClipAdditive:function(i,e=0,t=i,r=30){r<=0&&(r=30);let n=t.tracks.length,l=e/r;for(let c=0;c<n;++c){let h=t.tracks[c],d=h.ValueTypeName;if(d==="bool"||d==="string")continue;let f=i.tracks.find(function(T){return T.name===h.name&&T.ValueTypeName===d});if(f===void 0)continue;let m=0,g=h.getValueSize();h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(m=g/3);let y=0,_=f.getValueSize();f.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(y=_/3);let b=h.times.length-1,S;if(l<=h.times[0]){let T=m,A=g-m;S=Gn.arraySlice(h.values,T,A)}else if(l>=h.times[b]){let T=b*g+m,A=T+g-m;S=Gn.arraySlice(h.values,T,A)}else{let T=h.createInterpolant(),A=m,P=g-m;T.evaluate(l),S=Gn.arraySlice(T.resultBuffer,A,P)}d==="quaternion"&&new Xl().fromArray(S).normalize().conjugate().toArray(S);let E=f.times.length;for(let T=0;T<E;++T){let A=T*_+y;if(d==="quaternion")Xl.multiplyQuaternionsFlat(f.values,A,S,0,f.values,A);else{let P=_-y*2;for(let O=0;O<P;++O)f.values[A+O]-=S[O]}}}return i.blendMode=X8,i}},Ym=class{constructor(e,t,r,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=n!==void 0?n:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,r=this._cachedIndex,n=t[r],l=t[r-1];e:{t:{let c;i:{r:if(!(e<n)){for(let h=r+2;;){if(n===void 0){if(e<l)break r;return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,e,l)}if(r===h)break;if(l=n,n=t[++r],e<n)break t}c=t.length;break i}if(!(e>=l)){let h=t[1];e<h&&(r=2,l=h);for(let d=r-2;;){if(l===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,n);if(r===d)break;if(n=l,l=t[--r-1],e>=l)break t}c=r,r=0;break i}break e}for(;r<c;){let h=r+c>>>1;e<t[h]?c=h:r=h+1}if(n=t[r],l=t[r-1],l===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,n);if(n===void 0)return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,l,e)}this._cachedIndex=r,this.intervalChanged_(r,l,n)}return this.interpolate_(r,l,e,n)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,l=e*n;for(let c=0;c!==n;++c)t[c]=r[l+c];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}};Ym.prototype.beforeStart_=Ym.prototype.copySampleValue_;Ym.prototype.afterEnd_=Ym.prototype.copySampleValue_;var Qle=class extends Ym{constructor(i,e,t,r){super(i,e,t,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:JS,endingEnd:JS}}intervalChanged_(i,e,t){let r=this.parameterPositions,n=i-2,l=i+1,c=r[n],h=r[l];if(c===void 0)switch(this.getSettings_().endingStart){case YS:n=i,c=2*e-t;break;case DR:n=r.length-2,c=e+r[n]-r[n+1];break;default:n=i,c=t}if(h===void 0)switch(this.getSettings_().endingEnd){case YS:l=i,h=2*t-e;break;case DR:l=1,h=t+r[1]-r[0];break;default:l=i-1,h=e}let d=(t-e)*.5,f=this.valueSize;this._weightPrev=d/(e-c),this._weightNext=d/(h-t),this._offsetPrev=n*f,this._offsetNext=l*f}interpolate_(i,e,t,r){let n=this.resultBuffer,l=this.sampleValues,c=this.valueSize,h=i*c,d=h-c,f=this._offsetPrev,m=this._offsetNext,g=this._weightPrev,y=this._weightNext,_=(t-e)/(r-e),b=_*_,S=b*_,E=-g*S+2*g*b-g*_,T=(1+g)*S+(-1.5-2*g)*b+(-.5+g)*_+1,A=(-1-y)*S+(1.5+y)*b+.5*_,P=y*S-y*b;for(let O=0;O!==c;++O)n[O]=E*l[f+O]+T*l[d+O]+A*l[h+O]+P*l[m+O];return n}},k7=class extends Ym{constructor(e,t,r,n){super(e,t,r,n)}interpolate_(e,t,r,n){let l=this.resultBuffer,c=this.sampleValues,h=this.valueSize,d=e*h,f=d-h,m=(r-t)/(n-t),g=1-m;for(let y=0;y!==h;++y)l[y]=c[f+y]*g+c[d+y]*m;return l}},eue=class extends Ym{constructor(i,e,t,r){super(i,e,t,r)}interpolate_(i){return this.copySampleValue_(i-1)}},Af=class{constructor(e,t,r,n){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Gn.convertArray(t,this.TimeBufferType),this.values=Gn.convertArray(r,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}static toJSON(e){let t=e.constructor,r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:Gn.convertArray(e.times,Array),values:Gn.convertArray(e.values,Array)};let n=e.getInterpolation();n!==e.DefaultInterpolation&&(r.interpolation=n)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new eue(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new k7(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Qle(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case OR:t=this.InterpolantFactoryMethodDiscrete;break;case NR:t=this.InterpolantFactoryMethodLinear;break;case lO:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){let r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return OR;case this.InterpolantFactoryMethodLinear:return NR;case this.InterpolantFactoryMethodSmooth:return lO}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let t=this.times;for(let r=0,n=t.length;r!==n;++r)t[r]+=e}return this}scale(e){if(e!==1){let t=this.times;for(let r=0,n=t.length;r!==n;++r)t[r]*=e}return this}trim(e,t){let r=this.times,n=r.length,l=0,c=n-1;for(;l!==n&&r[l]<e;)++l;for(;c!==-1&&r[c]>t;)--c;if(++c,l!==0||c!==n){l>=c&&(c=Math.max(c,1),l=c-1);let h=this.getValueSize();this.times=Gn.arraySlice(r,l,c),this.values=Gn.arraySlice(this.values,l*h,c*h)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let r=this.times,n=this.values,l=r.length;l===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let c=null;for(let h=0;h!==l;h++){let d=r[h];if(typeof d=="number"&&isNaN(d)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,h,d),e=!1;break}if(c!==null&&c>d){console.error("THREE.KeyframeTrack: Out of order keys.",this,h,d,c),e=!1;break}c=d}if(n!==void 0&&Gn.isTypedArray(n))for(let h=0,d=n.length;h!==d;++h){let f=n[h];if(isNaN(f)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,h,f),e=!1;break}}return e}optimize(){let e=Gn.arraySlice(this.times),t=Gn.arraySlice(this.values),r=this.getValueSize(),n=this.getInterpolation()===lO,l=e.length-1,c=1;for(let h=1;h<l;++h){let d=!1,f=e[h],m=e[h+1];if(f!==m&&(h!==1||f!==e[0]))if(n)d=!0;else{let g=h*r,y=g-r,_=g+r;for(let b=0;b!==r;++b){let S=t[g+b];if(S!==t[y+b]||S!==t[_+b]){d=!0;break}}}if(d){if(h!==c){e[c]=e[h];let g=h*r,y=c*r;for(let _=0;_!==r;++_)t[y+_]=t[g+_]}++c}}if(l>0){e[c]=e[l];for(let h=l*r,d=c*r,f=0;f!==r;++f)t[d+f]=t[h+f];++c}return c!==e.length?(this.times=Gn.arraySlice(e,0,c),this.values=Gn.arraySlice(t,0,c*r)):(this.times=e,this.values=t),this}clone(){let e=Gn.arraySlice(this.times,0),t=Gn.arraySlice(this.values,0),r=this.constructor,n=new r(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}};Af.prototype.TimeBufferType=Float32Array;Af.prototype.ValueBufferType=Float32Array;Af.prototype.DefaultInterpolation=NR;var pE=class extends Af{};pE.prototype.ValueTypeName="bool";pE.prototype.ValueBufferType=Array;pE.prototype.DefaultInterpolation=OR;pE.prototype.InterpolantFactoryMethodLinear=void 0;pE.prototype.InterpolantFactoryMethodSmooth=void 0;var F7=class extends Af{};F7.prototype.ValueTypeName="color";var zR=class extends Af{};zR.prototype.ValueTypeName="number";var tue=class extends Ym{constructor(i,e,t,r){super(i,e,t,r)}interpolate_(i,e,t,r){let n=this.resultBuffer,l=this.sampleValues,c=this.valueSize,h=(t-e)/(r-e),d=i*c;for(let f=d+c;d!==f;d+=4)Xl.slerpFlat(n,0,l,d-c,l,d,h);return n}},_C=class extends Af{InterpolantFactoryMethodLinear(i){return new tue(this.times,this.values,this.getValueSize(),i)}};_C.prototype.ValueTypeName="quaternion";_C.prototype.DefaultInterpolation=NR;_C.prototype.InterpolantFactoryMethodSmooth=void 0;var mE=class extends Af{};mE.prototype.ValueTypeName="string";mE.prototype.ValueBufferType=Array;mE.prototype.DefaultInterpolation=OR;mE.prototype.InterpolantFactoryMethodLinear=void 0;mE.prototype.InterpolantFactoryMethodSmooth=void 0;var BR=class extends Af{};BR.prototype.ValueTypeName="vector";var OH=class{constructor(e,t=-1,r,n=Nz){this.name=e,this.tracks=r,this.duration=t,this.blendMode=n,this.uuid=xf(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],r=e.tracks,n=1/(e.fps||1);for(let c=0,h=r.length;c!==h;++c)t.push(rue(r[c]).scale(n));let l=new this(e.name,e.duration,t,e.blendMode);return l.uuid=e.uuid,l}static toJSON(e){let t=[],r=e.tracks,n={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let l=0,c=r.length;l!==c;++l)t.push(Af.toJSON(r[l]));return n}static CreateFromMorphTargetSequence(e,t,r,n){let l=t.length,c=[];for(let h=0;h<l;h++){let d=[],f=[];d.push((h+l-1)%l,h,(h+1)%l),f.push(0,1,0);let m=Gn.getKeyframeOrder(d);d=Gn.sortedArray(d,1,m),f=Gn.sortedArray(f,1,m),!n&&d[0]===0&&(d.push(l),f.push(f[0])),c.push(new zR(".morphTargetInfluences["+t[h].name+"]",d,f).scale(1/r))}return new this(e,-1,c)}static findByName(e,t){let r=e;if(!Array.isArray(e)){let n=e;r=n.geometry&&n.geometry.animations||n.animations}for(let n=0;n<r.length;n++)if(r[n].name===t)return r[n];return null}static CreateClipsFromMorphTargetSequences(e,t,r){let n={},l=/^([\w-]*?)([\d]+)$/;for(let h=0,d=e.length;h<d;h++){let f=e[h],m=f.name.match(l);if(m&&m.length>1){let g=m[1],y=n[g];y||(n[g]=y=[]),y.push(f)}}let c=[];for(let h in n)c.push(this.CreateFromMorphTargetSequence(h,n[h],t,r));return c}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let r=function(m,g,y,_,b){if(y.length!==0){let S=[],E=[];Gn.flattenJSON(y,S,E,_),S.length!==0&&b.push(new m(g,S,E))}},n=[],l=e.name||"default",c=e.fps||30,h=e.blendMode,d=e.length||-1,f=e.hierarchy||[];for(let m=0;m<f.length;m++){let g=f[m].keys;if(!(!g||g.length===0))if(g[0].morphTargets){let y={},_;for(_=0;_<g.length;_++)if(g[_].morphTargets)for(let b=0;b<g[_].morphTargets.length;b++)y[g[_].morphTargets[b]]=-1;for(let b in y){let S=[],E=[];for(let T=0;T!==g[_].morphTargets.length;++T){let A=g[_];S.push(A.time),E.push(A.morphTarget===b?1:0)}n.push(new zR(".morphTargetInfluence["+b+"]",S,E))}d=y.length*c}else{let y=".bones["+t[m].name+"]";r(BR,y+".position",g,"pos",n),r(_C,y+".quaternion",g,"rot",n),r(BR,y+".scale",g,"scl",n)}}return n.length===0?null:new this(l,d,n,h)}resetDuration(){let e=this.tracks,t=0;for(let r=0,n=e.length;r!==n;++r){let l=this.tracks[r];t=Math.max(t,l.times[l.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function iue(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return zR;case"vector":case"vector2":case"vector3":case"vector4":return BR;case"color":return F7;case"quaternion":return _C;case"bool":case"boolean":return pE;case"string":return mE}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}function rue(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let e=iue(i.type);if(i.times===void 0){let t=[],r=[];Gn.flattenJSON(i.keys,t,r,"value"),i.times=t,i.values=r}return e.parse!==void 0?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}var BM={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(this.files[i]=e)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}},nue=class{constructor(i,e,t){let r=this,n=!1,l=0,c=0,h,d=[];this.onStart=void 0,this.onLoad=i,this.onProgress=e,this.onError=t,this.itemStart=function(f){c++,n===!1&&r.onStart!==void 0&&r.onStart(f,l,c),n=!0},this.itemEnd=function(f){l++,r.onProgress!==void 0&&r.onProgress(f,l,c),l===c&&(n=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(f){r.onError!==void 0&&r.onError(f)},this.resolveURL=function(f){return h?h(f):f},this.setURLModifier=function(f){return h=f,this},this.addHandler=function(f,m){return d.push(f,m),this},this.removeHandler=function(f){let m=d.indexOf(f);return m!==-1&&d.splice(m,2),this},this.getHandler=function(f){for(let m=0,g=d.length;m<g;m+=2){let y=d[m],_=d[m+1];if(y.global&&(y.lastIndex=0),y.test(f))return _}return null}}},sue=new nue,sg=class{constructor(e){this.manager=e!==void 0?e:sue,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){let r=this;return new Promise(function(n,l){r.load(e,n,t,l)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}},Uf={},aue=class extends sg{constructor(i){super(i)}load(i,e,t,r){i===void 0&&(i=""),this.path!==void 0&&(i=this.path+i),i=this.manager.resolveURL(i);let n=BM.get(i);if(n!==void 0)return this.manager.itemStart(i),setTimeout(()=>{e&&e(n),this.manager.itemEnd(i)},0),n;if(Uf[i]!==void 0){Uf[i].push({onLoad:e,onProgress:t,onError:r});return}Uf[i]=[],Uf[i].push({onLoad:e,onProgress:t,onError:r});let l=new Request(i,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),c=this.mimeType,h=this.responseType;fetch(l).then(d=>{if(d.status===200||d.status===0){if(d.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||d.body===void 0||d.body.getReader===void 0)return d;let f=Uf[i],m=d.body.getReader(),g=d.headers.get("Content-Length"),y=g?parseInt(g):0,_=y!==0,b=0,S=new ReadableStream({start(E){T();function T(){m.read().then(({done:A,value:P})=>{if(A)E.close();else{b+=P.byteLength;let O=new ProgressEvent("progress",{lengthComputable:_,loaded:b,total:y});for(let R=0,D=f.length;R<D;R++){let L=f[R];L.onProgress&&L.onProgress(O)}E.enqueue(P),T()}})}}});return new Response(S)}else throw Error(`fetch for "${d.url}" responded with ${d.status}: ${d.statusText}`)}).then(d=>{switch(h){case"arraybuffer":return d.arrayBuffer();case"blob":return d.blob();case"document":return d.text().then(f=>new DOMParser().parseFromString(f,c));case"json":return d.json();default:if(c===void 0)return d.text();{let f=/charset="?([^;"\s]*)"?/i.exec(c),m=f&&f[1]?f[1].toLowerCase():void 0,g=new TextDecoder(m);return d.arrayBuffer().then(y=>g.decode(y))}}}).then(d=>{BM.add(i,d);let f=Uf[i];delete Uf[i];for(let m=0,g=f.length;m<g;m++){let y=f[m];y.onLoad&&y.onLoad(d)}}).catch(d=>{let f=Uf[i];if(f===void 0)throw this.manager.itemError(i),d;delete Uf[i];for(let m=0,g=f.length;m<g;m++){let y=f[m];y.onError&&y.onError(d)}this.manager.itemError(i)}).finally(()=>{this.manager.itemEnd(i)}),this.manager.itemStart(i)}setResponseType(i){return this.responseType=i,this}setMimeType(i){return this.mimeType=i,this}},z7=class extends sg{constructor(e){super(e)}load(e,t,r,n){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let l=this,c=BM.get(e);if(c!==void 0)return l.manager.itemStart(e),setTimeout(function(){t&&t(c),l.manager.itemEnd(e)},0),c;let h=PA("img");function d(){m(),BM.add(e,this),t&&t(this),l.manager.itemEnd(e)}function f(g){m(),n&&n(g),l.manager.itemError(e),l.manager.itemEnd(e)}function m(){h.removeEventListener("load",d,!1),h.removeEventListener("error",f,!1)}return h.addEventListener("load",d,!1),h.addEventListener("error",f,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(h.crossOrigin=this.crossOrigin),l.manager.itemStart(e),h.src=e,h}},oue=class extends sg{constructor(i){super(i)}load(i,e,t,r){let n=new ZI,l=new z7(this.manager);l.setCrossOrigin(this.crossOrigin),l.setPath(this.path);let c=0;function h(d){l.load(i[d],function(f){n.images[d]=f,c++,c===6&&(n.needsUpdate=!0,e&&e(n))},void 0,r)}for(let d=0;d<i.length;++d)h(d);return n}},lue=class extends sg{constructor(i){super(i)}load(i,e,t,r){let n=new so,l=new z7(this.manager);return l.setCrossOrigin(this.crossOrigin),l.setPath(this.path),l.load(i,function(c){n.image=c,n.needsUpdate=!0,e!==void 0&&e(n)},t,r),n}},wf=class extends Sn{constructor(e,t=1){super(),this.type="Light",this.color=new Ei(e),this.intensity=t}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}};wf.prototype.isLight=!0;var uue=class extends wf{constructor(i,e,t){super(i,t),this.type="HemisphereLight",this.position.copy(Sn.DefaultUp),this.updateMatrix(),this.groundColor=new Ei(e)}copy(i){return wf.prototype.copy.call(this,i),this.groundColor.copy(i.groundColor),this}};uue.prototype.isHemisphereLight=!0;var NH=new Bi,DH=new Te,kH=new Te,Yz=class{constructor(i){this.camera=i,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new At(512,512),this.map=null,this.mapPass=null,this.matrix=new Bi,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new JI,this._frameExtents=new At(1,1),this._viewportCount=1,this._viewports=[new wn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(i){let e=this.camera,t=this.matrix;DH.setFromMatrixPosition(i.matrixWorld),e.position.copy(DH),kH.setFromMatrixPosition(i.target.matrixWorld),e.lookAt(kH),e.updateMatrixWorld(),NH.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(NH),t.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),t.multiply(e.projectionMatrix),t.multiply(e.matrixWorldInverse)}getViewport(i){return this._viewports[i]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(i){return this.camera=i.camera.clone(),this.bias=i.bias,this.radius=i.radius,this.mapSize.copy(i.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let i={};return this.bias!==0&&(i.bias=this.bias),this.normalBias!==0&&(i.normalBias=this.normalBias),this.radius!==1&&(i.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(i.mapSize=this.mapSize.toArray()),i.camera=this.camera.toJSON(!1).object,delete i.camera.matrix,i}},B7=class extends Yz{constructor(){super(new su(50,1,.5,500)),this.focus=1}updateMatrices(e){let t=this.camera,r=rF*2*e.angle*this.focus,n=this.mapSize.width/this.mapSize.height,l=e.distance||t.far;(r!==t.fov||n!==t.aspect||l!==t.far)&&(t.fov=r,t.aspect=n,t.far=l,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}};B7.prototype.isSpotLightShadow=!0;var cue=class extends wf{constructor(e,t,r=0,n=Math.PI/3,l=0,c=1){super(e,t),this.type="SpotLight",this.position.copy(Sn.DefaultUp),this.updateMatrix(),this.target=new Sn,this.distance=r,this.angle=n,this.penumbra=l,this.decay=c,this.shadow=new B7}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}};cue.prototype.isSpotLight=!0;var FH=new Bi,qE=new Te,VO=new Te,U7=class extends Yz{constructor(){super(new su(90,1,.5,500)),this._frameExtents=new At(4,2),this._viewportCount=6,this._viewports=[new wn(2,1,1,1),new wn(0,1,1,1),new wn(3,1,1,1),new wn(1,1,1,1),new wn(3,0,1,1),new wn(1,0,1,1)],this._cubeDirections=[new Te(1,0,0),new Te(-1,0,0),new Te(0,0,1),new Te(0,0,-1),new Te(0,1,0),new Te(0,-1,0)],this._cubeUps=[new Te(0,1,0),new Te(0,1,0),new Te(0,1,0),new Te(0,1,0),new Te(0,0,1),new Te(0,0,-1)]}updateMatrices(e,t=0){let r=this.camera,n=this.matrix,l=e.distance||r.far;l!==r.far&&(r.far=l,r.updateProjectionMatrix()),qE.setFromMatrixPosition(e.matrixWorld),r.position.copy(qE),VO.copy(r.position),VO.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(VO),r.updateMatrixWorld(),n.makeTranslation(-qE.x,-qE.y,-qE.z),FH.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(FH)}};U7.prototype.isPointLightShadow=!0;var hue=class extends wf{constructor(e,t,r=0,n=1){super(e,t),this.type="PointLight",this.distance=r,this.decay=n,this.shadow=new U7}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}};hue.prototype.isPointLight=!0;var H7=class extends Yz{constructor(){super(new zz(-5,5,5,-5,.5,500))}};H7.prototype.isDirectionalLightShadow=!0;var due=class extends wf{constructor(e,t){super(e,t),this.type="DirectionalLight",this.position.copy(Sn.DefaultUp),this.updateMatrix(),this.target=new Sn,this.shadow=new H7}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}};due.prototype.isDirectionalLight=!0;var fue=class extends wf{constructor(e,t){super(e,t),this.type="AmbientLight"}};fue.prototype.isAmbientLight=!0;var pue=class extends wf{constructor(i,e,t=10,r=10){super(i,e),this.type="RectAreaLight",this.width=t,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(i){this.intensity=i/(this.width*this.height*Math.PI)}copy(i){return super.copy(i),this.width=i.width,this.height=i.height,this}toJSON(i){let e=super.toJSON(i);return e.object.width=this.width,e.object.height=this.height,e}};pue.prototype.isRectAreaLight=!0;var $7=class{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Te)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){let r=e.x,n=e.y,l=e.z,c=this.coefficients;return t.copy(c[0]).multiplyScalar(.282095),t.addScaledVector(c[1],.488603*n),t.addScaledVector(c[2],.488603*l),t.addScaledVector(c[3],.488603*r),t.addScaledVector(c[4],1.092548*(r*n)),t.addScaledVector(c[5],1.092548*(n*l)),t.addScaledVector(c[6],.315392*(3*l*l-1)),t.addScaledVector(c[7],1.092548*(r*l)),t.addScaledVector(c[8],.546274*(r*r-n*n)),t}getIrradianceAt(e,t){let r=e.x,n=e.y,l=e.z,c=this.coefficients;return t.copy(c[0]).multiplyScalar(.886227),t.addScaledVector(c[1],2*.511664*n),t.addScaledVector(c[2],2*.511664*l),t.addScaledVector(c[3],2*.511664*r),t.addScaledVector(c[4],2*.429043*r*n),t.addScaledVector(c[5],2*.429043*n*l),t.addScaledVector(c[6],.743125*l*l-.247708),t.addScaledVector(c[7],2*.429043*r*l),t.addScaledVector(c[8],.429043*(r*r-n*n)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let r=0;r<9;r++)this.coefficients[r].addScaledVector(e.coefficients[r],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let r=0;r<9;r++)this.coefficients[r].lerp(e.coefficients[r],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){let r=this.coefficients;for(let n=0;n<9;n++)r[n].fromArray(e,t+n*3);return this}toArray(e=[],t=0){let r=this.coefficients;for(let n=0;n<9;n++)r[n].toArray(e,t+n*3);return e}static getBasisAt(e,t){let r=e.x,n=e.y,l=e.z;t[0]=.282095,t[1]=.488603*n,t[2]=.488603*l,t[3]=.488603*r,t[4]=1.092548*r*n,t[5]=1.092548*n*l,t[6]=.315392*(3*l*l-1),t[7]=1.092548*r*l,t[8]=.546274*(r*r-n*n)}};$7.prototype.isSphericalHarmonics3=!0;var Kz=class extends wf{constructor(i=new $7,e=1){super(void 0,e),this.sh=i}copy(i){return super.copy(i),this.sh.copy(i.sh),this}fromJSON(i){return this.intensity=i.intensity,this.sh.fromArray(i.sh),this}toJSON(i){let e=super.toJSON(i);return e.object.sh=this.sh.toArray(),e}};Kz.prototype.isLightProbe=!0;var mue=class{static decodeText(i){if(typeof TextDecoder<"u")return new TextDecoder().decode(i);let e="";for(let t=0,r=i.length;t<r;t++)e+=String.fromCharCode(i[t]);try{return decodeURIComponent(escape(e))}catch{return e}}static extractUrlBase(i){let e=i.lastIndexOf("/");return e===-1?"./":i.slice(0,e+1)}static resolveURL(i,e){return typeof i!="string"||i===""?"":(/^https?:\/\//i.test(e)&&/^\//.test(i)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(i)||/^data:.*,.*$/i.test(i)||/^blob:.*$/i.test(i)?i:e+i)}},gue=class extends vs{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return new this.constructor().copy(this)}toJSON(){let e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}};gue.prototype.isInstancedBufferGeometry=!0;var vue=class extends sg{constructor(i){super(i),typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(i){return this.options=i,this}load(i,e,t,r){i===void 0&&(i=""),this.path!==void 0&&(i=this.path+i),i=this.manager.resolveURL(i);let n=this,l=BM.get(i);if(l!==void 0)return n.manager.itemStart(i),setTimeout(function(){e&&e(l),n.manager.itemEnd(i)},0),l;let c={};c.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",c.headers=this.requestHeader,fetch(i,c).then(function(h){return h.blob()}).then(function(h){return createImageBitmap(h,Object.assign(n.options,{colorSpaceConversion:"none"}))}).then(function(h){BM.add(i,h),e&&e(h),n.manager.itemEnd(i)}).catch(function(h){r&&r(h),n.manager.itemError(i),n.manager.itemEnd(i)}),n.manager.itemStart(i)}};vue.prototype.isImageBitmapLoader=!0;var N2,yue={getContext:function(){return N2===void 0&&(N2=new(window.AudioContext||window.webkitAudioContext)),N2},setContext:function(i){N2=i}},_ue=class extends sg{constructor(i){super(i)}load(i,e,t,r){let n=this,l=new aue(this.manager);l.setResponseType("arraybuffer"),l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(i,function(c){try{let h=c.slice(0);yue.getContext().decodeAudioData(h,function(d){e(d)})}catch(h){r?r(h):console.error(h),n.manager.itemError(i)}},t,r)}},xue=class extends Kz{constructor(i,e,t=1){super(void 0,t);let r=new Ei().set(i),n=new Ei().set(e),l=new Te(r.r,r.g,r.b),c=new Te(n.r,n.g,n.b),h=Math.sqrt(Math.PI),d=h*Math.sqrt(.75);this.sh.coefficients[0].copy(l).add(c).multiplyScalar(h),this.sh.coefficients[1].copy(l).sub(c).multiplyScalar(d)}};xue.prototype.isHemisphereLightProbe=!0;var bue=class extends Kz{constructor(i,e=1){super(void 0,e);let t=new Ei().set(i);this.sh.coefficients[0].set(t.r,t.g,t.b).multiplyScalar(2*Math.sqrt(Math.PI))}};bue.prototype.isAmbientLightProbe=!0;var Qz=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=zH(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=zH();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};function zH(){return(typeof performance>"u"?Date:performance).now()}var wue=class extends Sn{constructor(i){super(),this.type="Audio",this.listener=i,this.context=i.context,this.gain=this.context.createGain(),this.gain.connect(i.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(i){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=i,this.connect(),this}setMediaElementSource(i){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(i),this.connect(),this}setMediaStreamSource(i){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(i),this.connect(),this}setBuffer(i){return this.buffer=i,this.sourceType="buffer",this.autoplay&&this.play(),this}play(i=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+i;let e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let i=1,e=this.filters.length;i<e;i++)this.filters[i-1].connect(this.filters[i]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let i=1,e=this.filters.length;i<e;i++)this.filters[i-1].disconnect(this.filters[i]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(i){return i||(i=[]),this._connected===!0?(this.disconnect(),this.filters=i.slice(),this.connect()):this.filters=i.slice(),this}setDetune(i){if(this.detune=i,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(i){return this.setFilters(i?[i]:[])}setPlaybackRate(i){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=i,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(i){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=i,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(i){return this.loopStart=i,this}setLoopEnd(i){return this.loopEnd=i,this}getVolume(){return this.gain.gain.value}setVolume(i){return this.gain.gain.setTargetAtTime(i,this.context.currentTime,.01),this}},Sue=class{constructor(i,e,t){this.binding=i,this.valueSize=t;let r,n,l;switch(e){case"quaternion":r=this._slerp,n=this._slerpAdditive,l=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(t*6),this._workIndex=5;break;case"string":case"bool":r=this._select,n=this._select,l=this._setAdditiveIdentityOther,this.buffer=new Array(t*5);break;default:r=this._lerp,n=this._lerpAdditive,l=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(t*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=n,this._setIdentity=l,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(i,e){let t=this.buffer,r=this.valueSize,n=i*r+r,l=this.cumulativeWeight;if(l===0){for(let c=0;c!==r;++c)t[n+c]=t[c];l=e}else{l+=e;let c=e/l;this._mixBufferRegion(t,n,0,c,r)}this.cumulativeWeight=l}accumulateAdditive(i){let e=this.buffer,t=this.valueSize,r=t*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(e,r,0,i,t),this.cumulativeWeightAdditive+=i}apply(i){let e=this.valueSize,t=this.buffer,r=i*e+e,n=this.cumulativeWeight,l=this.cumulativeWeightAdditive,c=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,n<1){let h=e*this._origIndex;this._mixBufferRegion(t,r,h,1-n,e)}l>0&&this._mixBufferRegionAdditive(t,r,this._addIndex*e,1,e);for(let h=e,d=e+e;h!==d;++h)if(t[h]!==t[h+e]){c.setValue(t,r);break}}saveOriginalState(){let i=this.binding,e=this.buffer,t=this.valueSize,r=t*this._origIndex;i.getValue(e,r);for(let n=t,l=r;n!==l;++n)e[n]=e[r+n%t];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let i=this.valueSize*3;this.binding.setValue(this.buffer,i)}_setAdditiveIdentityNumeric(){let i=this._addIndex*this.valueSize,e=i+this.valueSize;for(let t=i;t<e;t++)this.buffer[t]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let i=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let t=0;t<this.valueSize;t++)this.buffer[e+t]=this.buffer[i+t]}_select(i,e,t,r,n){if(r>=.5)for(let l=0;l!==n;++l)i[e+l]=i[t+l]}_slerp(i,e,t,r){Xl.slerpFlat(i,e,i,e,i,t,r)}_slerpAdditive(i,e,t,r,n){let l=this._workIndex*n;Xl.multiplyQuaternionsFlat(i,l,i,e,i,t),Xl.slerpFlat(i,e,i,e,i,l,r)}_lerp(i,e,t,r,n){let l=1-r;for(let c=0;c!==n;++c){let h=e+c;i[h]=i[h]*l+i[t+c]*r}}_lerpAdditive(i,e,t,r,n){for(let l=0;l!==n;++l){let c=e+l;i[c]=i[c]+i[t+l]*r}}},eB="\\[\\]\\.:\\/",Mue=new RegExp("["+eB+"]","g"),tB="[^"+eB+"]",Eue="[^"+eB.replace("\\.","")+"]",Tue=/((?:WC+[\/:])*)/.source.replace("WC",tB),Aue=/(WCOD+)?/.source.replace("WCOD",Eue),Cue=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",tB),Pue=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",tB),Rue=new RegExp("^"+Tue+Aue+Cue+Pue+"$"),Iue=["material","materials","bones"],Lue=class{constructor(i,e,t){let r=t||_n.parseTrackName(e);this._targetGroup=i,this._bindings=i.subscribe_(e,r)}getValue(i,e){this.bind();let t=this._targetGroup.nCachedObjects_,r=this._bindings[t];r!==void 0&&r.getValue(i,e)}setValue(i,e){let t=this._bindings;for(let r=this._targetGroup.nCachedObjects_,n=t.length;r!==n;++r)t[r].setValue(i,e)}bind(){let i=this._bindings;for(let e=this._targetGroup.nCachedObjects_,t=i.length;e!==t;++e)i[e].bind()}unbind(){let i=this._bindings;for(let e=this._targetGroup.nCachedObjects_,t=i.length;e!==t;++e)i[e].unbind()}},_n=class{constructor(e,t,r){this.path=t,this.parsedPath=r||_n.parseTrackName(t),this.node=_n.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new _n.Composite(e,t,r):new _n(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Mue,"")}static parseTrackName(e){let t=Rue.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);let r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=r.nodeName&&r.nodeName.lastIndexOf(".");if(n!==void 0&&n!==-1){let l=r.nodeName.substring(n+1);Iue.indexOf(l)!==-1&&(r.nodeName=r.nodeName.substring(0,n),r.objectName=l)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){let r=e.skeleton.getBoneByName(t);if(r!==void 0)return r}if(e.children){let r=function(l){for(let c=0;c<l.length;c++){let h=l[c];if(h.name===t||h.uuid===t)return h;let d=r(h.children);if(d)return d}return null},n=r(e.children);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){let r=this.resolvedProperty;for(let n=0,l=r.length;n!==l;++n)e[t++]=r[n]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){let r=this.resolvedProperty;for(let n=0,l=r.length;n!==l;++n)r[n]=e[t++]}_setValue_array_setNeedsUpdate(e,t){let r=this.resolvedProperty;for(let n=0,l=r.length;n!==l;++n)r[n]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){let r=this.resolvedProperty;for(let n=0,l=r.length;n!==l;++n)r[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node,t=this.parsedPath,r=t.objectName,n=t.propertyName,l=t.propertyIndex;if(e||(e=_n.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(r){let f=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let m=0;m<e.length;m++)if(e[m].name===f){f=m;break}break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(f!==void 0){if(e[f]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[f]}}let c=e[n];if(c===void 0){let f=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+f+"."+n+" but it wasn't found.",e);return}let h=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?h=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(h=this.Versioning.MatrixWorldNeedsUpdate);let d=this.BindingType.Direct;if(l!==void 0){if(n==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[l]!==void 0&&(l=e.morphTargetDictionary[l])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}d=this.BindingType.ArrayElement,this.resolvedProperty=c,this.propertyIndex=l}else c.fromArray!==void 0&&c.toArray!==void 0?(d=this.BindingType.HasFromToArray,this.resolvedProperty=c):Array.isArray(c)?(d=this.BindingType.EntireArray,this.resolvedProperty=c):this.propertyName=n;this.getValue=this.GetterByBindingType[d],this.setValue=this.SetterByBindingTypeAndVersioning[d][h]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};_n.Composite=Lue;_n.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};_n.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};_n.prototype.GetterByBindingType=[_n.prototype._getValue_direct,_n.prototype._getValue_array,_n.prototype._getValue_arrayElement,_n.prototype._getValue_toArray];_n.prototype.SetterByBindingTypeAndVersioning=[[_n.prototype._setValue_direct,_n.prototype._setValue_direct_setNeedsUpdate,_n.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[_n.prototype._setValue_array,_n.prototype._setValue_array_setNeedsUpdate,_n.prototype._setValue_array_setMatrixWorldNeedsUpdate],[_n.prototype._setValue_arrayElement,_n.prototype._setValue_arrayElement_setNeedsUpdate,_n.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[_n.prototype._setValue_fromArray,_n.prototype._setValue_fromArray_setNeedsUpdate,_n.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var Oue=class{constructor(i,e,t=null,r=e.blendMode){this._mixer=i,this._clip=e,this._localRoot=t,this.blendMode=r;let n=e.tracks,l=n.length,c=new Array(l),h={endingStart:JS,endingEnd:JS};for(let d=0;d!==l;++d){let f=n[d].createInterpolant(null);c[d]=f,f.settings=h}this._interpolantSettings=h,this._interpolants=c,this._propertyBindings=new Array(l),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=vre,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(i){return this._startTime=i,this}setLoop(i,e){return this.loop=i,this.repetitions=e,this}setEffectiveWeight(i){return this.weight=i,this._effectiveWeight=this.enabled?i:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(i){return this._scheduleFading(i,0,1)}fadeOut(i){return this._scheduleFading(i,1,0)}crossFadeFrom(i,e,t){if(i.fadeOut(e),this.fadeIn(e),t){let r=this._clip.duration,n=i._clip.duration,l=n/r,c=r/n;i.warp(1,l,e),this.warp(c,1,e)}return this}crossFadeTo(i,e,t){return i.crossFadeFrom(this,e,t)}stopFading(){let i=this._weightInterpolant;return i!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(i)),this}setEffectiveTimeScale(i){return this.timeScale=i,this._effectiveTimeScale=this.paused?0:i,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(i){return this.timeScale=this._clip.duration/i,this.stopWarping()}syncWith(i){return this.time=i.time,this.timeScale=i.timeScale,this.stopWarping()}halt(i){return this.warp(this._effectiveTimeScale,0,i)}warp(i,e,t){let r=this._mixer,n=r.time,l=this.timeScale,c=this._timeScaleInterpolant;c===null&&(c=r._lendControlInterpolant(),this._timeScaleInterpolant=c);let h=c.parameterPositions,d=c.sampleValues;return h[0]=n,h[1]=n+t,d[0]=i/l,d[1]=e/l,this}stopWarping(){let i=this._timeScaleInterpolant;return i!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(i)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(i,e,t,r){if(!this.enabled){this._updateWeight(i);return}let n=this._startTime;if(n!==null){let h=(i-n)*t;if(h<0||t===0)return;this._startTime=null,e=t*h}e*=this._updateTimeScale(i);let l=this._updateTime(e),c=this._updateWeight(i);if(c>0){let h=this._interpolants,d=this._propertyBindings;switch(this.blendMode){case X8:for(let f=0,m=h.length;f!==m;++f)h[f].evaluate(l),d[f].accumulateAdditive(c);break;case Nz:default:for(let f=0,m=h.length;f!==m;++f)h[f].evaluate(l),d[f].accumulate(r,c)}}}_updateWeight(i){let e=0;if(this.enabled){e=this.weight;let t=this._weightInterpolant;if(t!==null){let r=t.evaluate(i)[0];e*=r,i>t.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(i){let e=0;if(!this.paused){e=this.timeScale;let t=this._timeScaleInterpolant;t!==null&&(e*=t.evaluate(i)[0],i>t.parameterPositions[1]&&(this.stopWarping(),e===0?this.paused=!0:this.timeScale=e))}return this._effectiveTimeScale=e,e}_updateTime(i){let e=this._clip.duration,t=this.loop,r=this.time+i,n=this._loopCount,l=t===yre;if(i===0)return n===-1?r:l&&(n&1)===1?e-r:r;if(t===gre){n===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=e)r=e;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:i<0?-1:1})}}else{if(n===-1&&(i>=0?(n=0,this._setEndings(!0,this.repetitions===0,l)):this._setEndings(this.repetitions===0,!0,l)),r>=e||r<0){let c=Math.floor(r/e);r-=e*c,n+=Math.abs(c);let h=this.repetitions-n;if(h<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=i>0?e:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:i>0?1:-1});else{if(h===1){let d=i<0;this._setEndings(d,!d,l)}else this._setEndings(!1,!1,l);this._loopCount=n,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:c})}}else this.time=r;if(l&&(n&1)===1)return e-r}return r}_setEndings(i,e,t){let r=this._interpolantSettings;t?(r.endingStart=YS,r.endingEnd=YS):(i?r.endingStart=this.zeroSlopeAtStart?YS:JS:r.endingStart=DR,e?r.endingEnd=this.zeroSlopeAtEnd?YS:JS:r.endingEnd=DR)}_scheduleFading(i,e,t){let r=this._mixer,n=r.time,l=this._weightInterpolant;l===null&&(l=r._lendControlInterpolant(),this._weightInterpolant=l);let c=l.parameterPositions,h=l.sampleValues;return c[0]=n,h[0]=e,c[1]=n+i,h[1]=t,this}},Nue=class extends yw{constructor(i){super(),this._root=i,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(i,e){let t=i._localRoot||this._root,r=i._clip.tracks,n=r.length,l=i._propertyBindings,c=i._interpolants,h=t.uuid,d=this._bindingsByRootAndName,f=d[h];f===void 0&&(f={},d[h]=f);for(let m=0;m!==n;++m){let g=r[m],y=g.name,_=f[y];if(_!==void 0)++_.referenceCount,l[m]=_;else{if(_=l[m],_!==void 0){_._cacheIndex===null&&(++_.referenceCount,this._addInactiveBinding(_,h,y));continue}let b=e&&e._propertyBindings[m].binding.parsedPath;_=new Sue(_n.create(t,y,b),g.ValueTypeName,g.getValueSize()),++_.referenceCount,this._addInactiveBinding(_,h,y),l[m]=_}c[m].resultBuffer=_.buffer}}_activateAction(i){if(!this._isActiveAction(i)){if(i._cacheIndex===null){let t=(i._localRoot||this._root).uuid,r=i._clip.uuid,n=this._actionsByClip[r];this._bindAction(i,n&&n.knownActions[0]),this._addInactiveAction(i,r,t)}let e=i._propertyBindings;for(let t=0,r=e.length;t!==r;++t){let n=e[t];n.useCount++===0&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(i)}}_deactivateAction(i){if(this._isActiveAction(i)){let e=i._propertyBindings;for(let t=0,r=e.length;t!==r;++t){let n=e[t];--n.useCount===0&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(i)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let i=this;this.stats={actions:{get total(){return i._actions.length},get inUse(){return i._nActiveActions}},bindings:{get total(){return i._bindings.length},get inUse(){return i._nActiveBindings}},controlInterpolants:{get total(){return i._controlInterpolants.length},get inUse(){return i._nActiveControlInterpolants}}}}_isActiveAction(i){let e=i._cacheIndex;return e!==null&&e<this._nActiveActions}_addInactiveAction(i,e,t){let r=this._actions,n=this._actionsByClip,l=n[e];if(l===void 0)l={knownActions:[i],actionByRoot:{}},i._byClipCacheIndex=0,n[e]=l;else{let c=l.knownActions;i._byClipCacheIndex=c.length,c.push(i)}i._cacheIndex=r.length,r.push(i),l.actionByRoot[t]=i}_removeInactiveAction(i){let e=this._actions,t=e[e.length-1],r=i._cacheIndex;t._cacheIndex=r,e[r]=t,e.pop(),i._cacheIndex=null;let n=i._clip.uuid,l=this._actionsByClip,c=l[n],h=c.knownActions,d=h[h.length-1],f=i._byClipCacheIndex;d._byClipCacheIndex=f,h[f]=d,h.pop(),i._byClipCacheIndex=null;let m=c.actionByRoot,g=(i._localRoot||this._root).uuid;delete m[g],h.length===0&&delete l[n],this._removeInactiveBindingsForAction(i)}_removeInactiveBindingsForAction(i){let e=i._propertyBindings;for(let t=0,r=e.length;t!==r;++t){let n=e[t];--n.referenceCount===0&&this._removeInactiveBinding(n)}}_lendAction(i){let e=this._actions,t=i._cacheIndex,r=this._nActiveActions++,n=e[r];i._cacheIndex=r,e[r]=i,n._cacheIndex=t,e[t]=n}_takeBackAction(i){let e=this._actions,t=i._cacheIndex,r=--this._nActiveActions,n=e[r];i._cacheIndex=r,e[r]=i,n._cacheIndex=t,e[t]=n}_addInactiveBinding(i,e,t){let r=this._bindingsByRootAndName,n=this._bindings,l=r[e];l===void 0&&(l={},r[e]=l),l[t]=i,i._cacheIndex=n.length,n.push(i)}_removeInactiveBinding(i){let e=this._bindings,t=i.binding,r=t.rootNode.uuid,n=t.path,l=this._bindingsByRootAndName,c=l[r],h=e[e.length-1],d=i._cacheIndex;h._cacheIndex=d,e[d]=h,e.pop(),delete c[n],Object.keys(c).length===0&&delete l[r]}_lendBinding(i){let e=this._bindings,t=i._cacheIndex,r=this._nActiveBindings++,n=e[r];i._cacheIndex=r,e[r]=i,n._cacheIndex=t,e[t]=n}_takeBackBinding(i){let e=this._bindings,t=i._cacheIndex,r=--this._nActiveBindings,n=e[r];i._cacheIndex=r,e[r]=i,n._cacheIndex=t,e[t]=n}_lendControlInterpolant(){let i=this._controlInterpolants,e=this._nActiveControlInterpolants++,t=i[e];return t===void 0&&(t=new k7(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),t.__cacheIndex=e,i[e]=t),t}_takeBackControlInterpolant(i){let e=this._controlInterpolants,t=i.__cacheIndex,r=--this._nActiveControlInterpolants,n=e[r];i.__cacheIndex=r,e[r]=i,n.__cacheIndex=t,e[t]=n}clipAction(i,e,t){let r=e||this._root,n=r.uuid,l=typeof i=="string"?OH.findByName(r,i):i,c=l!==null?l.uuid:i,h=this._actionsByClip[c],d=null;if(t===void 0&&(l!==null?t=l.blendMode:t=Nz),h!==void 0){let m=h.actionByRoot[n];if(m!==void 0&&m.blendMode===t)return m;d=h.knownActions[0],l===null&&(l=d._clip)}if(l===null)return null;let f=new Oue(this,l,e,t);return this._bindAction(f,d),this._addInactiveAction(f,c,n),f}existingAction(i,e){let t=e||this._root,r=t.uuid,n=typeof i=="string"?OH.findByName(t,i):i,l=n?n.uuid:i,c=this._actionsByClip[l];return c!==void 0&&c.actionByRoot[r]||null}stopAllAction(){let i=this._actions,e=this._nActiveActions;for(let t=e-1;t>=0;--t)i[t].stop();return this}update(i){i*=this.timeScale;let e=this._actions,t=this._nActiveActions,r=this.time+=i,n=Math.sign(i),l=this._accuIndex^=1;for(let d=0;d!==t;++d)e[d]._update(r,i,n,l);let c=this._bindings,h=this._nActiveBindings;for(let d=0;d!==h;++d)c[d].apply(l);return this}setTime(i){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(i)}getRoot(){return this._root}uncacheClip(i){let e=this._actions,t=i.uuid,r=this._actionsByClip,n=r[t];if(n!==void 0){let l=n.knownActions;for(let c=0,h=l.length;c!==h;++c){let d=l[c];this._deactivateAction(d);let f=d._cacheIndex,m=e[e.length-1];d._cacheIndex=null,d._byClipCacheIndex=null,m._cacheIndex=f,e[f]=m,e.pop(),this._removeInactiveBindingsForAction(d)}delete r[t]}}uncacheRoot(i){let e=i.uuid,t=this._actionsByClip;for(let l in t){let c=t[l].actionByRoot,h=c[e];h!==void 0&&(this._deactivateAction(h),this._removeInactiveAction(h))}let r=this._bindingsByRootAndName,n=r[e];if(n!==void 0)for(let l in n){let c=n[l];c.restoreOriginalState(),this._removeInactiveBinding(c)}}uncacheAction(i,e){let t=this.existingAction(i,e);t!==null&&(this._deactivateAction(t),this._removeInactiveAction(t))}};Nue.prototype._controlInterpolantsResultBuffer=new Float32Array(1);var Due=class extends vC{constructor(i,e,t=1){super(i,e),this.meshPerAttribute=t}copy(i){return super.copy(i),this.meshPerAttribute=i.meshPerAttribute,this}clone(i){let e=super.clone(i);return e.meshPerAttribute=this.meshPerAttribute,e}toJSON(i){let e=super.toJSON(i);return e.isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}};Due.prototype.isInstancedInterleavedBuffer=!0;var Xp=new Te,D2=new Bi,WO=new Bi,kue=class extends Wz{constructor(i){let e=V7(i),t=new vs,r=[],n=[],l=new Ei(0,0,1),c=new Ei(0,1,0);for(let d=0;d<e.length;d++){let f=e[d];f.parent&&f.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),n.push(l.r,l.g,l.b),n.push(c.r,c.g,c.b))}t.setAttribute("position",new Ja(r,3)),t.setAttribute("color",new Ja(n,3));let h=new dE({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(t,h),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=i,this.bones=e,this.matrix=i.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(i){let e=this.bones,t=this.geometry,r=t.getAttribute("position");WO.copy(this.root.matrixWorld).invert();for(let n=0,l=0;n<e.length;n++){let c=e[n];c.parent&&c.parent.isBone&&(D2.multiplyMatrices(WO,c.matrixWorld),Xp.setFromMatrixPosition(D2),r.setXYZ(l,Xp.x,Xp.y,Xp.z),D2.multiplyMatrices(WO,c.parent.matrixWorld),Xp.setFromMatrixPosition(D2),r.setXYZ(l+1,Xp.x,Xp.y,Xp.z),l+=2)}t.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(i)}};function V7(i){let e=[];i.isBone===!0&&e.push(i);for(let t=0;t<i.children.length;t++)e.push.apply(e,V7(i.children[t]));return e}var Fue=class extends Wz{constructor(i=10,e=10,t=4473924,r=8947848){t=new Ei(t),r=new Ei(r);let n=e/2,l=i/e,c=i/2,h=[],d=[];for(let g=0,y=0,_=-c;g<=e;g++,_+=l){h.push(-c,0,_,c,0,_),h.push(_,0,-c,_,0,c);let b=g===n?t:r;b.toArray(d,y),y+=3,b.toArray(d,y),y+=3,b.toArray(d,y),y+=3,b.toArray(d,y),y+=3}let f=new vs;f.setAttribute("position",new Ja(h,3)),f.setAttribute("color",new Ja(d,3));let m=new dE({vertexColors:!0,toneMapped:!1});super(f,m),this.type="GridHelper"}},sf=new Uint32Array(512),af=new Uint32Array(512);for(let i=0;i<256;++i){let e=i-127;e<-27?(sf[i]=0,sf[i|256]=32768,af[i]=24,af[i|256]=24):e<-14?(sf[i]=1024>>-e-14,sf[i|256]=1024>>-e-14|32768,af[i]=-e-1,af[i|256]=-e-1):e<=15?(sf[i]=e+15<<10,sf[i|256]=e+15<<10|32768,af[i]=13,af[i|256]=13):e<128?(sf[i]=31744,sf[i|256]=64512,af[i]=24,af[i|256]=24):(sf[i]=31744,sf[i|256]=64512,af[i]=13,af[i|256]=13)}var W7=new Uint32Array(2048),xC=new Uint32Array(64),zue=new Uint32Array(64);for(let i=1;i<1024;++i){let e=i<<13,t=0;for(;!(e&8388608);)e<<=1,t-=8388608;e&=-8388609,t+=947912704,W7[i]=e|t}for(let i=1024;i<2048;++i)W7[i]=939524096+(i-1024<<13);for(let i=1;i<31;++i)xC[i]=i<<23;xC[31]=1199570944;xC[32]=2147483648;for(let i=33;i<63;++i)xC[i]=2147483648+(i-32<<23);xC[63]=3347054592;for(let i=1;i<64;++i)i!==32&&(zue[i]=1024);lc.create=function(i,e){return console.log("THREE.Curve.create() has been deprecated"),i.prototype=Object.create(lc.prototype),i.prototype.constructor=i,i.prototype.getPoint=e,i};lF.prototype.fromPoints=function(i){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(i)};Fue.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")};kue.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};sg.prototype.extractUrlBase=function(i){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),mue.extractUrlBase(i)};sg.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}};ef.prototype.center=function(i){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(i)};ef.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()};ef.prototype.isIntersectionBox=function(i){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(i)};ef.prototype.isIntersectionSphere=function(i){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(i)};ef.prototype.size=function(i){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(i)};cE.prototype.toVector3=function(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")};lE.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()};JI.prototype.setFromMatrix=function(i){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(i)};io.prototype.flattenToArrayOffset=function(i,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(i,e)};io.prototype.multiplyVector3=function(i){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),i.applyMatrix3(this)};io.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")};io.prototype.applyToBufferAttribute=function(i){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),i.applyMatrix3(this)};io.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")};io.prototype.getInverse=function(i){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(i).invert()};Bi.prototype.extractPosition=function(i){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(i)};Bi.prototype.flattenToArrayOffset=function(i,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(i,e)};Bi.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new Te().setFromMatrixColumn(this,3)};Bi.prototype.setRotationFromQuaternion=function(i){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(i)};Bi.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")};Bi.prototype.multiplyVector3=function(i){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)};Bi.prototype.multiplyVector4=function(i){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)};Bi.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")};Bi.prototype.rotateAxis=function(i){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),i.transformDirection(this)};Bi.prototype.crossVector=function(i){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)};Bi.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")};Bi.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")};Bi.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")};Bi.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")};Bi.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")};Bi.prototype.applyToBufferAttribute=function(i){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)};Bi.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")};Bi.prototype.makeFrustum=function(i,e,t,r,n,l){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(i,e,r,t,n,l)};Bi.prototype.getInverse=function(i){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(i).invert()};cp.prototype.isIntersectionLine=function(i){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(i)};Xl.prototype.multiplyVector3=function(i){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),i.applyQuaternion(this)};Xl.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()};uE.prototype.isIntersectionBox=function(i){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(i)};uE.prototype.isIntersectionPlane=function(i){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(i)};uE.prototype.isIntersectionSphere=function(i){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(i)};Xa.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()};Xa.prototype.barycoordFromPoint=function(i,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(i,e)};Xa.prototype.midpoint=function(i){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(i)};Xa.prototypenormal=function(i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(i)};Xa.prototype.plane=function(i){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(i)};Xa.barycoordFromPoint=function(i,e,t,r,n){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Xa.getBarycoord(i,e,t,r,n)};Xa.normal=function(i,e,t,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Xa.getNormal(i,e,t,r)};fE.prototype.extractAllPoints=function(i){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(i)};fE.prototype.extrude=function(i){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new yC(this,i)};fE.prototype.makeGeometry=function(i){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new T7(this,i)};At.prototype.fromAttribute=function(i,e,t){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(i,e,t)};At.prototype.distanceToManhattan=function(i){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(i)};At.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()};Te.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")};Te.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")};Te.prototype.getPositionFromMatrix=function(i){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(i)};Te.prototype.getScaleFromMatrix=function(i){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(i)};Te.prototype.getColumnFromMatrix=function(i,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,i)};Te.prototype.applyProjection=function(i){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(i)};Te.prototype.fromAttribute=function(i,e,t){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(i,e,t)};Te.prototype.distanceToManhattan=function(i){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(i)};Te.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()};wn.prototype.fromAttribute=function(i,e,t){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(i,e,t)};wn.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()};Sn.prototype.getChildByName=function(i){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(i)};Sn.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")};Sn.prototype.translate=function(i,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,i)};Sn.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")};Sn.prototype.applyMatrix=function(i){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(i)};Object.defineProperties(Sn.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(i){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=i}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}});cu.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")};Object.defineProperties(cu.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Z8},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}});v7.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")};su.prototype.setLens=function(i,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),e!==void 0&&(this.filmGauge=e),this.setFocalLength(i)};Object.defineProperties(wf.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(i){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=i}},shadowCameraLeft:{set:function(i){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=i}},shadowCameraRight:{set:function(i){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=i}},shadowCameraTop:{set:function(i){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=i}},shadowCameraBottom:{set:function(i){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=i}},shadowCameraNear:{set:function(i){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=i}},shadowCameraFar:{set:function(i){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=i}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(i){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=i}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(i){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=i}},shadowMapHeight:{set:function(i){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=i}}});Object.defineProperties(Da.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===kR},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(kR)}}});Da.prototype.setDynamic=function(i){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(i===!0?kR:CA),this};Da.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},Da.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")};vs.prototype.addIndex=function(i){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(i)};vs.prototype.addAttribute=function(i,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),!(e&&e.isBufferAttribute)&&!(e&&e.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(i,new Da(arguments[1],arguments[2]))):i==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(i,e)};vs.prototype.addDrawCall=function(i,e,t){t!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(i,e)};vs.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()};vs.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")};vs.prototype.removeAttribute=function(i){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(i)};vs.prototype.applyMatrix=function(i){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(i)};Object.defineProperties(vs.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}});vC.prototype.setDynamic=function(i){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(i===!0?kR:CA),this};vC.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")};yC.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")};yC.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")};yC.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")};m7.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")};Object.defineProperties(za.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Ei}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(i){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=i===W8}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(i){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=i}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}});Object.defineProperties(Xd.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(i){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=i}}});Mn.prototype.clearTarget=function(i,e,t,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(i),this.clear(e,t,r)};Mn.prototype.animate=function(i){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(i)};Mn.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()};Mn.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()};Mn.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision};Mn.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()};Mn.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")};Mn.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")};Mn.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")};Mn.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")};Mn.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")};Mn.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")};Mn.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures};Mn.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")};Mn.prototype.enableScissorTest=function(i){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(i)};Mn.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")};Mn.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")};Mn.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")};Mn.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")};Mn.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")};Mn.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")};Mn.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")};Mn.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")};Mn.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")};Mn.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()};Object.defineProperties(Mn.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(i){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=i}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(i){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=i}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(i){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=i===!0?jn:Tp}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}},gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}});Object.defineProperties(d7.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});Object.defineProperties(Nu.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(i){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=i}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(i){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=i}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(i){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=i}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(i){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=i}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(i){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=i}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(i){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=i}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(i){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=i}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(i){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=i}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(i){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=i}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(i){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=i}}});wue.prototype.load=function(i){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");let e=this;return new _ue().load(i,function(t){e.setBuffer(t)}),this};Fz.prototype.updateCubeMap=function(i,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(i,e)};Fz.prototype.clear=function(i,e,t,r){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(i,e,t,r)};_w.crossOrigin=void 0;_w.loadTexture=function(i,e,t,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");let n=new lue;n.setCrossOrigin(this.crossOrigin);let l=n.load(i,t,void 0,r);return e&&(l.mapping=e),l};_w.loadTextureCube=function(i,e,t,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");let n=new oue;n.setCrossOrigin(this.crossOrigin);let l=n.load(i,t,void 0,r);return e&&(l.mapping=e),l};_w.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")};_w.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Oz}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Oz);var j7="139",hF=0,Bue=1,iB=2,Uue=1,BH=1,Hue=100,$ue=204,Vue=205,Wue=3,rB=0,G7=300,OA=1e3,DT=1001,dF=1002,fF=1003,jue=1004,Gue=1005,nB=1006,que=1007,sB=1008,Xue=1009,Zue=1015,q7=1023,NA=2300,UM=2301,jO=2302,UH=2400,HH=2401,$H=2402,Jue=2500,Yue=2501,Kue=1,Que=2,ece=3e3,DA=3001,tce=3200,bC=0,op="srgb",O1="srgb-linear",GO=7680,ice=519,pF=35044,tL=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;let r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;let r=this._listeners[e];if(r!==void 0){let n=r.indexOf(t);n!==-1&&r.splice(n,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let t=this._listeners[e.type];if(t!==void 0){e.target=this;let r=t.slice(0);for(let n=0,l=r.length;n<l;n++)r[n].call(this,e);e.target=null}}},X7={};oie(X7,{DEG2RAD:()=>JT,RAD2DEG:()=>kA,ceilPowerOfTwo:()=>Z7,clamp:()=>Wl,damp:()=>sce,degToRad:()=>fce,denormalize:()=>yce,euclideanModulo:()=>aB,floorPowerOfTwo:()=>gce,generateUUID:()=>Wd,inverseLerp:()=>nce,isPowerOfTwo:()=>mce,lerp:()=>YT,mapLinear:()=>rce,normalize:()=>_ce,pingpong:()=>ace,radToDeg:()=>pce,randFloat:()=>cce,randFloatSpread:()=>hce,randInt:()=>uce,seededRandom:()=>dce,setQuaternionFromProperEuler:()=>vce,smootherstep:()=>lce,smoothstep:()=>oce});var Qa=[];for(let i=0;i<256;i++)Qa[i]=(i<16?"0":"")+i.toString(16);var VH=1234567,JT=Math.PI/180,kA=180/Math.PI;function Wd(){let i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(Qa[i&255]+Qa[i>>8&255]+Qa[i>>16&255]+Qa[i>>24&255]+"-"+Qa[e&255]+Qa[e>>8&255]+"-"+Qa[e>>16&15|64]+Qa[e>>24&255]+"-"+Qa[t&63|128]+Qa[t>>8&255]+"-"+Qa[t>>16&255]+Qa[t>>24&255]+Qa[r&255]+Qa[r>>8&255]+Qa[r>>16&255]+Qa[r>>24&255]).toLowerCase()}function Wl(i,e,t){return Math.max(e,Math.min(t,i))}function aB(i,e){return(i%e+e)%e}function rce(i,e,t,r,n){return r+(i-e)*(n-r)/(t-e)}function nce(i,e,t){return i!==e?(t-i)/(e-i):0}function YT(i,e,t){return(1-t)*i+t*e}function sce(i,e,t,r){return YT(i,e,1-Math.exp(-t*r))}function ace(i,e=1){return e-Math.abs(aB(i,e*2)-e)}function oce(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*(3-2*i))}function lce(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*i*(i*(i*6-15)+10))}function uce(i,e){return i+Math.floor(Math.random()*(e-i+1))}function cce(i,e){return i+Math.random()*(e-i)}function hce(i){return i*(.5-Math.random())}function dce(i){i!==void 0&&(VH=i);let e=VH+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function fce(i){return i*JT}function pce(i){return i*kA}function mce(i){return(i&i-1)===0&&i!==0}function Z7(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function gce(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function vce(i,e,t,r,n){let l=Math.cos,c=Math.sin,h=l(t/2),d=c(t/2),f=l((e+r)/2),m=c((e+r)/2),g=l((e-r)/2),y=c((e-r)/2),_=l((r-e)/2),b=c((r-e)/2);switch(n){case"XYX":i.set(h*m,d*g,d*y,h*f);break;case"YZY":i.set(d*y,h*m,d*g,h*f);break;case"ZXZ":i.set(d*g,d*y,h*m,h*f);break;case"XZX":i.set(h*m,d*b,d*_,h*f);break;case"YXY":i.set(d*_,h*m,d*b,h*f);break;case"ZYZ":i.set(d*b,d*_,h*m,h*f);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}function yce(i,e){switch(e.constructor){case Float32Array:return i;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function _ce(i,e){switch(e.constructor){case Float32Array:return i;case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}var $n=class{constructor(e=0,t=0){this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,r=this.y,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6],this.y=n[1]*t+n[4]*r+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,r){return r!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let r=Math.cos(t),n=Math.sin(t),l=this.x-e.x,c=this.y-e.y;return this.x=l*r-c*n+e.x,this.y=l*n+c*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}};$n.prototype.isVector2=!0;var wC=class{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,r,n,l,c,h,d,f){let m=this.elements;return m[0]=e,m[1]=n,m[2]=h,m[3]=t,m[4]=l,m[5]=d,m[6]=r,m[7]=c,m[8]=f,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,n=t.elements,l=this.elements,c=r[0],h=r[3],d=r[6],f=r[1],m=r[4],g=r[7],y=r[2],_=r[5],b=r[8],S=n[0],E=n[3],T=n[6],A=n[1],P=n[4],O=n[7],R=n[2],D=n[5],L=n[8];return l[0]=c*S+h*A+d*R,l[3]=c*E+h*P+d*D,l[6]=c*T+h*O+d*L,l[1]=f*S+m*A+g*R,l[4]=f*E+m*P+g*D,l[7]=f*T+m*O+g*L,l[2]=y*S+_*A+b*R,l[5]=y*E+_*P+b*D,l[8]=y*T+_*O+b*L,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[1],n=e[2],l=e[3],c=e[4],h=e[5],d=e[6],f=e[7],m=e[8];return t*c*m-t*h*f-r*l*m+r*h*d+n*l*f-n*c*d}invert(){let e=this.elements,t=e[0],r=e[1],n=e[2],l=e[3],c=e[4],h=e[5],d=e[6],f=e[7],m=e[8],g=m*c-h*f,y=h*d-m*l,_=f*l-c*d,b=t*g+r*y+n*_;if(b===0)return this.set(0,0,0,0,0,0,0,0,0);let S=1/b;return e[0]=g*S,e[1]=(n*f-m*r)*S,e[2]=(h*r-n*c)*S,e[3]=y*S,e[4]=(m*t-n*d)*S,e[5]=(n*l-h*t)*S,e[6]=_*S,e[7]=(r*d-f*t)*S,e[8]=(c*t-r*l)*S,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,n,l,c,h){let d=Math.cos(l),f=Math.sin(l);return this.set(r*d,r*f,-r*(d*c+f*h)+c+e,-n*f,n*d,-n*(-f*c+d*h)+h+t,0,0,1),this}scale(e,t){let r=this.elements;return r[0]*=e,r[3]*=e,r[6]*=e,r[1]*=t,r[4]*=t,r[7]*=t,this}rotate(e){let t=Math.cos(e),r=Math.sin(e),n=this.elements,l=n[0],c=n[3],h=n[6],d=n[1],f=n[4],m=n[7];return n[0]=t*l+r*d,n[3]=t*c+r*f,n[6]=t*h+r*m,n[1]=-r*l+t*d,n[4]=-r*c+t*f,n[7]=-r*h+t*m,this}translate(e,t){let r=this.elements;return r[0]+=e*r[2],r[3]+=e*r[5],r[6]+=e*r[8],r[1]+=t*r[2],r[4]+=t*r[5],r[7]+=t*r[8],this}equals(e){let t=this.elements,r=e.elements;for(let n=0;n<9;n++)if(t[n]!==r[n])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){let r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}};wC.prototype.isMatrix3=!0;function xce(i){for(let e=i.length-1;e>=0;--e)if(i[e]>65535)return!0;return!1}function mF(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function q1(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function jP(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}var qO={[op]:{[O1]:q1},[O1]:{[op]:jP}},wd={legacyMode:!0,get workingColorSpace(){return O1},set workingColorSpace(i){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(i,e,t){if(this.legacyMode||e===t||!e||!t)return i;if(qO[e]&&qO[e][t]!==void 0){let r=qO[e][t];return i.r=r(i.r),i.g=r(i.g),i.b=r(i.b),i}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(i,e){return this.convert(i,this.workingColorSpace,e)},toWorkingColorSpace:function(i,e){return this.convert(i,e,this.workingColorSpace)}},J7={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ca={r:0,g:0,b:0},Sd={h:0,s:0,l:0},k2={h:0,s:0,l:0};function XO(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}function F2(i,e){return e.r=i.r,e.g=i.g,e.b=i.b,e}var Ar=class{constructor(e,t,r){return t===void 0&&r===void 0?this.set(e):this.setRGB(e,t,r)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=op){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,wd.toWorkingColorSpace(this,t),this}setRGB(e,t,r,n=O1){return this.r=e,this.g=t,this.b=r,wd.toWorkingColorSpace(this,n),this}setHSL(e,t,r,n=O1){if(e=aB(e,1),t=Wl(t,0,1),r=Wl(r,0,1),t===0)this.r=this.g=this.b=r;else{let l=r<=.5?r*(1+t):r+t-r*t,c=2*r-l;this.r=XO(c,l,e+1/3),this.g=XO(c,l,e),this.b=XO(c,l,e-1/3)}return wd.toWorkingColorSpace(this,n),this}setStyle(e,t=op){function r(l){l!==void 0&&parseFloat(l)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let l,c=n[1],h=n[2];switch(c){case"rgb":case"rgba":if(l=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return this.r=Math.min(255,parseInt(l[1],10))/255,this.g=Math.min(255,parseInt(l[2],10))/255,this.b=Math.min(255,parseInt(l[3],10))/255,wd.toWorkingColorSpace(this,t),r(l[4]),this;if(l=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return this.r=Math.min(100,parseInt(l[1],10))/100,this.g=Math.min(100,parseInt(l[2],10))/100,this.b=Math.min(100,parseInt(l[3],10))/100,wd.toWorkingColorSpace(this,t),r(l[4]),this;break;case"hsl":case"hsla":if(l=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h)){let d=parseFloat(l[1])/360,f=parseInt(l[2],10)/100,m=parseInt(l[3],10)/100;return r(l[4]),this.setHSL(d,f,m,t)}break}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){let l=n[1],c=l.length;if(c===3)return this.r=parseInt(l.charAt(0)+l.charAt(0),16)/255,this.g=parseInt(l.charAt(1)+l.charAt(1),16)/255,this.b=parseInt(l.charAt(2)+l.charAt(2),16)/255,wd.toWorkingColorSpace(this,t),this;if(c===6)return this.r=parseInt(l.charAt(0)+l.charAt(1),16)/255,this.g=parseInt(l.charAt(2)+l.charAt(3),16)/255,this.b=parseInt(l.charAt(4)+l.charAt(5),16)/255,wd.toWorkingColorSpace(this,t),this}return e&&e.length>0?this.setColorName(e,t):this}setColorName(e,t=op){let r=J7[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=q1(e.r),this.g=q1(e.g),this.b=q1(e.b),this}copyLinearToSRGB(e){return this.r=jP(e.r),this.g=jP(e.g),this.b=jP(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=op){return wd.fromWorkingColorSpace(F2(this,Ca),e),Wl(Ca.r*255,0,255)<<16^Wl(Ca.g*255,0,255)<<8^Wl(Ca.b*255,0,255)<<0}getHexString(e=op){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=O1){wd.fromWorkingColorSpace(F2(this,Ca),t);let r=Ca.r,n=Ca.g,l=Ca.b,c=Math.max(r,n,l),h=Math.min(r,n,l),d,f,m=(h+c)/2;if(h===c)d=0,f=0;else{let g=c-h;switch(f=m<=.5?g/(c+h):g/(2-c-h),c){case r:d=(n-l)/g+(n<l?6:0);break;case n:d=(l-r)/g+2;break;case l:d=(r-n)/g+4;break}d/=6}return e.h=d,e.s=f,e.l=m,e}getRGB(e,t=O1){return wd.fromWorkingColorSpace(F2(this,Ca),t),e.r=Ca.r,e.g=Ca.g,e.b=Ca.b,e}getStyle(e=op){return wd.fromWorkingColorSpace(F2(this,Ca),e),e!==op?`color(${e} ${Ca.r} ${Ca.g} ${Ca.b})`:`rgb(${Ca.r*255|0},${Ca.g*255|0},${Ca.b*255|0})`}offsetHSL(e,t,r){return this.getHSL(Sd),Sd.h+=e,Sd.s+=t,Sd.l+=r,this.setHSL(Sd.h,Sd.s,Sd.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(Sd),e.getHSL(k2);let r=YT(Sd.h,k2.h,t),n=YT(Sd.s,k2.s,t),l=YT(Sd.l,k2.l,t);return this.setHSL(r,n,l),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),e.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}};Ar.NAMES=J7;Ar.prototype.isColor=!0;Ar.prototype.r=1;Ar.prototype.g=1;Ar.prototype.b=1;var Ww,bce=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Ww===void 0&&(Ww=mF("canvas")),Ww.width=e.width,Ww.height=e.height;let r=Ww.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=Ww}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=mF("canvas");t.width=e.width,t.height=e.height;let r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);let n=r.getImageData(0,0,e.width,e.height),l=n.data;for(let c=0;c<l.length;c++)l[c]=q1(l[c]/255)*255;return r.putImageData(n,0,0),t}else if(e.data){let t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(q1(t[r]/255)*255):t[r]=q1(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},Y7=class{constructor(i=null){this.uuid=Wd(),this.data=i,this.version=0}set needsUpdate(i){i===!0&&this.version++}toJSON(i){let e=i===void 0||typeof i=="string";if(!e&&i.images[this.uuid]!==void 0)return i.images[this.uuid];let t={uuid:this.uuid,url:""},r=this.data;if(r!==null){let n;if(Array.isArray(r)){n=[];for(let l=0,c=r.length;l<c;l++)r[l].isDataTexture?n.push(ZO(r[l].image)):n.push(ZO(r[l]))}else n=ZO(r);t.url=n}return e||(i.images[this.uuid]=t),t}};function ZO(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?bce.getDataURL(i):i.data?{data:Array.prototype.slice.call(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}Y7.prototype.isSource=!0;var wce=0,Ap=class extends tL{constructor(e=Ap.DEFAULT_IMAGE,t=Ap.DEFAULT_MAPPING,r=DT,n=DT,l=nB,c=sB,h=q7,d=Xue,f=1,m=ece){super(),Object.defineProperty(this,"id",{value:wce++}),this.uuid=Wd(),this.name="",this.source=new Y7(e),this.mipmaps=[],this.mapping=t,this.wrapS=r,this.wrapT=n,this.magFilter=l,this.minFilter=c,this.anisotropy=f,this.format=h,this.internalFormat=null,this.type=d,this.offset=new $n(0,0),this.repeat=new $n(1,1),this.center=new $n(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new wC,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=m,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];let r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return JSON.stringify(this.userData)!=="{}"&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==G7)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case OA:e.x=e.x-Math.floor(e.x);break;case DT:e.x=e.x<0?0:1;break;case dF:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case OA:e.y=e.y-Math.floor(e.y);break;case DT:e.y=e.y<0?0:1;break;case dF:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}};Ap.DEFAULT_IMAGE=null;Ap.DEFAULT_MAPPING=G7;Ap.prototype.isTexture=!0;var Qu=class{constructor(e=0,t=0,r=0,n=1){this.x=e,this.y=t,this.z=r,this.w=n}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,r=this.y,n=this.z,l=this.w,c=e.elements;return this.x=c[0]*t+c[4]*r+c[8]*n+c[12]*l,this.y=c[1]*t+c[5]*r+c[9]*n+c[13]*l,this.z=c[2]*t+c[6]*r+c[10]*n+c[14]*l,this.w=c[3]*t+c[7]*r+c[11]*n+c[15]*l,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,n,l,c=e.elements,h=c[0],d=c[4],f=c[8],m=c[1],g=c[5],y=c[9],_=c[2],b=c[6],S=c[10];if(Math.abs(d-m)<.01&&Math.abs(f-_)<.01&&Math.abs(y-b)<.01){if(Math.abs(d+m)<.1&&Math.abs(f+_)<.1&&Math.abs(y+b)<.1&&Math.abs(h+g+S-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let T=(h+1)/2,A=(g+1)/2,P=(S+1)/2,O=(d+m)/4,R=(f+_)/4,D=(y+b)/4;return T>A&&T>P?T<.01?(r=0,n=.707106781,l=.707106781):(r=Math.sqrt(T),n=O/r,l=R/r):A>P?A<.01?(r=.707106781,n=0,l=.707106781):(n=Math.sqrt(A),r=O/n,l=D/n):P<.01?(r=.707106781,n=.707106781,l=0):(l=Math.sqrt(P),r=R/l,n=D/l),this.set(r,n,l,t),this}let E=Math.sqrt((b-y)*(b-y)+(f-_)*(f-_)+(m-d)*(m-d));return Math.abs(E)<.001&&(E=1),this.x=(b-y)/E,this.y=(f-_)/E,this.z=(m-d)/E,this.w=Math.acos((h+g+S-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,r){return r!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}};Qu.prototype.isVector4=!0;var Zd=class{constructor(e=0,t=0,r=0,n=1){this._x=e,this._y=t,this._z=r,this._w=n}static slerp(e,t,r,n){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),r.slerpQuaternions(e,t,n)}static slerpFlat(e,t,r,n,l,c,h){let d=r[n+0],f=r[n+1],m=r[n+2],g=r[n+3],y=l[c+0],_=l[c+1],b=l[c+2],S=l[c+3];if(h===0){e[t+0]=d,e[t+1]=f,e[t+2]=m,e[t+3]=g;return}if(h===1){e[t+0]=y,e[t+1]=_,e[t+2]=b,e[t+3]=S;return}if(g!==S||d!==y||f!==_||m!==b){let E=1-h,T=d*y+f*_+m*b+g*S,A=T>=0?1:-1,P=1-T*T;if(P>Number.EPSILON){let R=Math.sqrt(P),D=Math.atan2(R,T*A);E=Math.sin(E*D)/R,h=Math.sin(h*D)/R}let O=h*A;if(d=d*E+y*O,f=f*E+_*O,m=m*E+b*O,g=g*E+S*O,E===1-h){let R=1/Math.sqrt(d*d+f*f+m*m+g*g);d*=R,f*=R,m*=R,g*=R}}e[t]=d,e[t+1]=f,e[t+2]=m,e[t+3]=g}static multiplyQuaternionsFlat(e,t,r,n,l,c){let h=r[n],d=r[n+1],f=r[n+2],m=r[n+3],g=l[c],y=l[c+1],_=l[c+2],b=l[c+3];return e[t]=h*b+m*g+d*_-f*y,e[t+1]=d*b+m*y+f*g-h*_,e[t+2]=f*b+m*_+h*y-d*g,e[t+3]=m*b-h*g-d*y-f*_,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!(e&&e.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");let r=e._x,n=e._y,l=e._z,c=e._order,h=Math.cos,d=Math.sin,f=h(r/2),m=h(n/2),g=h(l/2),y=d(r/2),_=d(n/2),b=d(l/2);switch(c){case"XYZ":this._x=y*m*g+f*_*b,this._y=f*_*g-y*m*b,this._z=f*m*b+y*_*g,this._w=f*m*g-y*_*b;break;case"YXZ":this._x=y*m*g+f*_*b,this._y=f*_*g-y*m*b,this._z=f*m*b-y*_*g,this._w=f*m*g+y*_*b;break;case"ZXY":this._x=y*m*g-f*_*b,this._y=f*_*g+y*m*b,this._z=f*m*b+y*_*g,this._w=f*m*g-y*_*b;break;case"ZYX":this._x=y*m*g-f*_*b,this._y=f*_*g+y*m*b,this._z=f*m*b-y*_*g,this._w=f*m*g+y*_*b;break;case"YZX":this._x=y*m*g+f*_*b,this._y=f*_*g+y*m*b,this._z=f*m*b-y*_*g,this._w=f*m*g-y*_*b;break;case"XZY":this._x=y*m*g-f*_*b,this._y=f*_*g-y*m*b,this._z=f*m*b+y*_*g,this._w=f*m*g+y*_*b;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+c)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let r=t/2,n=Math.sin(r);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,r=t[0],n=t[4],l=t[8],c=t[1],h=t[5],d=t[9],f=t[2],m=t[6],g=t[10],y=r+h+g;if(y>0){let _=.5/Math.sqrt(y+1);this._w=.25/_,this._x=(m-d)*_,this._y=(l-f)*_,this._z=(c-n)*_}else if(r>h&&r>g){let _=2*Math.sqrt(1+r-h-g);this._w=(m-d)/_,this._x=.25*_,this._y=(n+c)/_,this._z=(l+f)/_}else if(h>g){let _=2*Math.sqrt(1+h-r-g);this._w=(l-f)/_,this._x=(n+c)/_,this._y=.25*_,this._z=(d+m)/_}else{let _=2*Math.sqrt(1+g-r-h);this._w=(c-n)/_,this._x=(l+f)/_,this._y=(d+m)/_,this._z=.25*_}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Wl(this.dot(e),-1,1)))}rotateTowards(e,t){let r=this.angleTo(e);if(r===0)return this;let n=Math.min(1,t/r);return this.slerp(e,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return t!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let r=e._x,n=e._y,l=e._z,c=e._w,h=t._x,d=t._y,f=t._z,m=t._w;return this._x=r*m+c*h+n*f-l*d,this._y=n*m+c*d+l*h-r*f,this._z=l*m+c*f+r*d-n*h,this._w=c*m-r*h-n*d-l*f,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let r=this._x,n=this._y,l=this._z,c=this._w,h=c*e._w+r*e._x+n*e._y+l*e._z;if(h<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,h=-h):this.copy(e),h>=1)return this._w=c,this._x=r,this._y=n,this._z=l,this;let d=1-h*h;if(d<=Number.EPSILON){let _=1-t;return this._w=_*c+t*this._w,this._x=_*r+t*this._x,this._y=_*n+t*this._y,this._z=_*l+t*this._z,this.normalize(),this._onChangeCallback(),this}let f=Math.sqrt(d),m=Math.atan2(f,h),g=Math.sin((1-t)*m)/f,y=Math.sin(t*m)/f;return this._w=c*g+this._w*y,this._x=r*g+this._x*y,this._y=n*g+this._y*y,this._z=l*g+this._z*y,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){let e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),n=2*Math.PI*Math.random(),l=2*Math.PI*Math.random();return this.set(t*Math.cos(n),r*Math.sin(l),r*Math.cos(l),t*Math.sin(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}};Zd.prototype.isQuaternion=!0;var Qe=class{constructor(e=0,t=0,r=0){this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return t!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(WH.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(WH.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,r=this.y,n=this.z,l=e.elements;return this.x=l[0]*t+l[3]*r+l[6]*n,this.y=l[1]*t+l[4]*r+l[7]*n,this.z=l[2]*t+l[5]*r+l[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,r=this.y,n=this.z,l=e.elements,c=1/(l[3]*t+l[7]*r+l[11]*n+l[15]);return this.x=(l[0]*t+l[4]*r+l[8]*n+l[12])*c,this.y=(l[1]*t+l[5]*r+l[9]*n+l[13])*c,this.z=(l[2]*t+l[6]*r+l[10]*n+l[14])*c,this}applyQuaternion(e){let t=this.x,r=this.y,n=this.z,l=e.x,c=e.y,h=e.z,d=e.w,f=d*t+c*n-h*r,m=d*r+h*t-l*n,g=d*n+l*r-c*t,y=-l*t-c*r-h*n;return this.x=f*d+y*-l+m*-h-g*-c,this.y=m*d+y*-c+g*-l-f*-h,this.z=g*d+y*-h+f*-c-m*-l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,r=this.y,n=this.z,l=e.elements;return this.x=l[0]*t+l[4]*r+l[8]*n,this.y=l[1]*t+l[5]*r+l[9]*n,this.z=l[2]*t+l[6]*r+l[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e,t){return t!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){let r=e.x,n=e.y,l=e.z,c=t.x,h=t.y,d=t.z;return this.x=n*d-l*h,this.y=l*c-r*d,this.z=r*h-n*c,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return JO.copy(this).projectOnVector(e),this.sub(JO)}reflect(e){return this.sub(JO.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let r=this.dot(e)/t;return Math.acos(Wl(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){let n=Math.sin(t)*e;return this.x=n*Math.sin(r),this.y=Math.cos(t)*e,this.z=n*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=n,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,r){return r!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,r=Math.sqrt(1-B8(e,2));return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}};Qe.prototype.isVector3=!0;var JO=new Qe,WH=new Zd,xw=class{constructor(e=new Qe(1/0,1/0,1/0),t=new Qe(-1/0,-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,r=1/0,n=1/0,l=-1/0,c=-1/0,h=-1/0;for(let d=0,f=e.length;d<f;d+=3){let m=e[d],g=e[d+1],y=e[d+2];m<t&&(t=m),g<r&&(r=g),y<n&&(n=y),m>l&&(l=m),g>c&&(c=g),y>h&&(h=y)}return this.min.set(t,r,n),this.max.set(l,c,h),this}setFromBufferAttribute(e){let t=1/0,r=1/0,n=1/0,l=-1/0,c=-1/0,h=-1/0;for(let d=0,f=e.count;d<f;d++){let m=e.getX(d),g=e.getY(d),y=e.getZ(d);m<t&&(t=m),g<r&&(r=g),y<n&&(n=y),m>l&&(l=m),g>c&&(c=g),y>h&&(h=y)}return this.min.set(t,r,n),this.max.set(l,c,h),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=n1.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let r=e.geometry;if(r!==void 0)if(t&&r.attributes!=null&&r.attributes.position!==void 0){let l=r.attributes.position;for(let c=0,h=l.count;c<h;c++)n1.fromBufferAttribute(l,c).applyMatrix4(e.matrixWorld),this.expandByPoint(n1)}else r.boundingBox===null&&r.computeBoundingBox(),YO.copy(r.boundingBox),YO.applyMatrix4(e.matrixWorld),this.union(YO);let n=e.children;for(let l=0,c=n.length;l<c;l++)this.expandByObject(n[l],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,n1),n1.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(XE),z2.subVectors(this.max,XE),jw.subVectors(e.a,XE),Gw.subVectors(e.b,XE),qw.subVectors(e.c,XE),Zp.subVectors(Gw,jw),Jp.subVectors(qw,Gw),s1.subVectors(jw,qw);let t=[0,-Zp.z,Zp.y,0,-Jp.z,Jp.y,0,-s1.z,s1.y,Zp.z,0,-Zp.x,Jp.z,0,-Jp.x,s1.z,0,-s1.x,-Zp.y,Zp.x,0,-Jp.y,Jp.x,0,-s1.y,s1.x,0];return!KO(t,jw,Gw,qw,z2)||(t=[1,0,0,0,1,0,0,0,1],!KO(t,jw,Gw,qw,z2))?!1:(B2.crossVectors(Zp,Jp),t=[B2.x,B2.y,B2.z],KO(t,jw,Gw,qw,z2))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return n1.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(n1).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Hf[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Hf[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Hf[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Hf[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Hf[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Hf[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Hf[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Hf[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Hf),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}};xw.prototype.isBox3=!0;var Hf=[new Qe,new Qe,new Qe,new Qe,new Qe,new Qe,new Qe,new Qe],n1=new Qe,YO=new xw,jw=new Qe,Gw=new Qe,qw=new Qe,Zp=new Qe,Jp=new Qe,s1=new Qe,XE=new Qe,z2=new Qe,B2=new Qe,a1=new Qe;function KO(i,e,t,r,n){for(let l=0,c=i.length-3;l<=c;l+=3){a1.fromArray(i,l);let h=n.x*Math.abs(a1.x)+n.y*Math.abs(a1.y)+n.z*Math.abs(a1.z),d=e.dot(a1),f=t.dot(a1),m=r.dot(a1);if(Math.max(-Math.max(d,f,m),Math.min(d,f,m))>h)return!1}return!0}var Sce=new xw,jH=new Qe,U2=new Qe,QO=new Qe,gE=class{constructor(e=new Qe,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let r=this.center;t!==void 0?r.copy(t):Sce.setFromPoints(e).getCenter(r);let n=0;for(let l=0,c=e.length;l<c;l++)n=Math.max(n,r.distanceToSquared(e[l]));return this.radius=Math.sqrt(n),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){QO.subVectors(e,this.center);let t=QO.lengthSq();if(t>this.radius*this.radius){let r=Math.sqrt(t),n=(r-this.radius)*.5;this.center.add(QO.multiplyScalar(n/r)),this.radius+=n}return this}union(e){return this.center.equals(e.center)===!0?U2.set(0,0,1).multiplyScalar(e.radius):U2.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(jH.copy(e.center).add(U2)),this.expandByPoint(jH.copy(e.center).sub(U2)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}},$f=new Qe,eN=new Qe,H2=new Qe,Yp=new Qe,tN=new Qe,$2=new Qe,iN=new Qe,oB=class{constructor(e=new Qe,t=new Qe(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,$f)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(r).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=$f.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):($f.copy(this.direction).multiplyScalar(t).add(this.origin),$f.distanceToSquared(e))}distanceSqToSegment(e,t,r,n){eN.copy(e).add(t).multiplyScalar(.5),H2.copy(t).sub(e).normalize(),Yp.copy(this.origin).sub(eN);let l=e.distanceTo(t)*.5,c=-this.direction.dot(H2),h=Yp.dot(this.direction),d=-Yp.dot(H2),f=Yp.lengthSq(),m=Math.abs(1-c*c),g,y,_,b;if(m>0)if(g=c*d-h,y=c*h-d,b=l*m,g>=0)if(y>=-b)if(y<=b){let S=1/m;g*=S,y*=S,_=g*(g+c*y+2*h)+y*(c*g+y+2*d)+f}else y=l,g=Math.max(0,-(c*y+h)),_=-g*g+y*(y+2*d)+f;else y=-l,g=Math.max(0,-(c*y+h)),_=-g*g+y*(y+2*d)+f;else y<=-b?(g=Math.max(0,-(-c*l+h)),y=g>0?-l:Math.min(Math.max(-l,-d),l),_=-g*g+y*(y+2*d)+f):y<=b?(g=0,y=Math.min(Math.max(-l,-d),l),_=y*(y+2*d)+f):(g=Math.max(0,-(c*l+h)),y=g>0?l:Math.min(Math.max(-l,-d),l),_=-g*g+y*(y+2*d)+f);else y=c>0?-l:l,g=Math.max(0,-(c*y+h)),_=-g*g+y*(y+2*d)+f;return r&&r.copy(this.direction).multiplyScalar(g).add(this.origin),n&&n.copy(H2).multiplyScalar(y).add(eN),_}intersectSphere(e,t){$f.subVectors(e.center,this.origin);let r=$f.dot(this.direction),n=$f.dot($f)-r*r,l=e.radius*e.radius;if(n>l)return null;let c=Math.sqrt(l-n),h=r-c,d=r+c;return h<0&&d<0?null:h<0?this.at(d,t):this.at(h,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;let r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){let r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,n,l,c,h,d,f=1/this.direction.x,m=1/this.direction.y,g=1/this.direction.z,y=this.origin;return f>=0?(r=(e.min.x-y.x)*f,n=(e.max.x-y.x)*f):(r=(e.max.x-y.x)*f,n=(e.min.x-y.x)*f),m>=0?(l=(e.min.y-y.y)*m,c=(e.max.y-y.y)*m):(l=(e.max.y-y.y)*m,c=(e.min.y-y.y)*m),r>c||l>n||((l>r||r!==r)&&(r=l),(c<n||n!==n)&&(n=c),g>=0?(h=(e.min.z-y.z)*g,d=(e.max.z-y.z)*g):(h=(e.max.z-y.z)*g,d=(e.min.z-y.z)*g),r>d||h>n)||((h>r||r!==r)&&(r=h),(d<n||n!==n)&&(n=d),n<0)?null:this.at(r>=0?r:n,t)}intersectsBox(e){return this.intersectBox(e,$f)!==null}intersectTriangle(e,t,r,n,l){tN.subVectors(t,e),$2.subVectors(r,e),iN.crossVectors(tN,$2);let c=this.direction.dot(iN),h;if(c>0){if(n)return null;h=1}else if(c<0)h=-1,c=-c;else return null;Yp.subVectors(this.origin,e);let d=h*this.direction.dot($2.crossVectors(Yp,$2));if(d<0)return null;let f=h*this.direction.dot(tN.cross(Yp));if(f<0||d+f>c)return null;let m=-h*Yp.dot(iN);return m<0?null:this.at(m/c,l)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},Yr=class{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,r,n,l,c,h,d,f,m,g,y,_,b,S,E){let T=this.elements;return T[0]=e,T[4]=t,T[8]=r,T[12]=n,T[1]=l,T[5]=c,T[9]=h,T[13]=d,T[2]=f,T[6]=m,T[10]=g,T[14]=y,T[3]=_,T[7]=b,T[11]=S,T[15]=E,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Yr().fromArray(this.elements)}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){let t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,r=e.elements,n=1/Xw.setFromMatrixColumn(e,0).length(),l=1/Xw.setFromMatrixColumn(e,1).length(),c=1/Xw.setFromMatrixColumn(e,2).length();return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=0,t[4]=r[4]*l,t[5]=r[5]*l,t[6]=r[6]*l,t[7]=0,t[8]=r[8]*c,t[9]=r[9]*c,t[10]=r[10]*c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");let t=this.elements,r=e.x,n=e.y,l=e.z,c=Math.cos(r),h=Math.sin(r),d=Math.cos(n),f=Math.sin(n),m=Math.cos(l),g=Math.sin(l);if(e.order==="XYZ"){let y=c*m,_=c*g,b=h*m,S=h*g;t[0]=d*m,t[4]=-d*g,t[8]=f,t[1]=_+b*f,t[5]=y-S*f,t[9]=-h*d,t[2]=S-y*f,t[6]=b+_*f,t[10]=c*d}else if(e.order==="YXZ"){let y=d*m,_=d*g,b=f*m,S=f*g;t[0]=y+S*h,t[4]=b*h-_,t[8]=c*f,t[1]=c*g,t[5]=c*m,t[9]=-h,t[2]=_*h-b,t[6]=S+y*h,t[10]=c*d}else if(e.order==="ZXY"){let y=d*m,_=d*g,b=f*m,S=f*g;t[0]=y-S*h,t[4]=-c*g,t[8]=b+_*h,t[1]=_+b*h,t[5]=c*m,t[9]=S-y*h,t[2]=-c*f,t[6]=h,t[10]=c*d}else if(e.order==="ZYX"){let y=c*m,_=c*g,b=h*m,S=h*g;t[0]=d*m,t[4]=b*f-_,t[8]=y*f+S,t[1]=d*g,t[5]=S*f+y,t[9]=_*f-b,t[2]=-f,t[6]=h*d,t[10]=c*d}else if(e.order==="YZX"){let y=c*d,_=c*f,b=h*d,S=h*f;t[0]=d*m,t[4]=S-y*g,t[8]=b*g+_,t[1]=g,t[5]=c*m,t[9]=-h*m,t[2]=-f*m,t[6]=_*g+b,t[10]=y-S*g}else if(e.order==="XZY"){let y=c*d,_=c*f,b=h*d,S=h*f;t[0]=d*m,t[4]=-g,t[8]=f*m,t[1]=y*g+S,t[5]=c*m,t[9]=_*g-b,t[2]=b*g-_,t[6]=h*m,t[10]=S*g+y}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Mce,e,Ece)}lookAt(e,t,r){let n=this.elements;return Su.subVectors(e,t),Su.lengthSq()===0&&(Su.z=1),Su.normalize(),Kp.crossVectors(r,Su),Kp.lengthSq()===0&&(Math.abs(r.z)===1?Su.x+=1e-4:Su.z+=1e-4,Su.normalize(),Kp.crossVectors(r,Su)),Kp.normalize(),V2.crossVectors(Su,Kp),n[0]=Kp.x,n[4]=V2.x,n[8]=Su.x,n[1]=Kp.y,n[5]=V2.y,n[9]=Su.y,n[2]=Kp.z,n[6]=V2.z,n[10]=Su.z,this}multiply(e,t){return t!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,n=t.elements,l=this.elements,c=r[0],h=r[4],d=r[8],f=r[12],m=r[1],g=r[5],y=r[9],_=r[13],b=r[2],S=r[6],E=r[10],T=r[14],A=r[3],P=r[7],O=r[11],R=r[15],D=n[0],L=n[4],N=n[8],U=n[12],F=n[1],z=n[5],G=n[9],J=n[13],Z=n[2],q=n[6],$=n[10],H=n[14],X=n[3],re=n[7],ae=n[11],he=n[15];return l[0]=c*D+h*F+d*Z+f*X,l[4]=c*L+h*z+d*q+f*re,l[8]=c*N+h*G+d*$+f*ae,l[12]=c*U+h*J+d*H+f*he,l[1]=m*D+g*F+y*Z+_*X,l[5]=m*L+g*z+y*q+_*re,l[9]=m*N+g*G+y*$+_*ae,l[13]=m*U+g*J+y*H+_*he,l[2]=b*D+S*F+E*Z+T*X,l[6]=b*L+S*z+E*q+T*re,l[10]=b*N+S*G+E*$+T*ae,l[14]=b*U+S*J+E*H+T*he,l[3]=A*D+P*F+O*Z+R*X,l[7]=A*L+P*z+O*q+R*re,l[11]=A*N+P*G+O*$+R*ae,l[15]=A*U+P*J+O*H+R*he,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[4],n=e[8],l=e[12],c=e[1],h=e[5],d=e[9],f=e[13],m=e[2],g=e[6],y=e[10],_=e[14],b=e[3],S=e[7],E=e[11],T=e[15];return b*(+l*d*g-n*f*g-l*h*y+r*f*y+n*h*_-r*d*_)+S*(+t*d*_-t*f*y+l*c*y-n*c*_+n*f*m-l*d*m)+E*(+t*f*g-t*h*_-l*c*g+r*c*_+l*h*m-r*f*m)+T*(-n*h*m-t*d*g+t*h*y+n*c*g-r*c*y+r*d*m)}transpose(){let e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){let n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=r),this}invert(){let e=this.elements,t=e[0],r=e[1],n=e[2],l=e[3],c=e[4],h=e[5],d=e[6],f=e[7],m=e[8],g=e[9],y=e[10],_=e[11],b=e[12],S=e[13],E=e[14],T=e[15],A=g*E*f-S*y*f+S*d*_-h*E*_-g*d*T+h*y*T,P=b*y*f-m*E*f-b*d*_+c*E*_+m*d*T-c*y*T,O=m*S*f-b*g*f+b*h*_-c*S*_-m*h*T+c*g*T,R=b*g*d-m*S*d-b*h*y+c*S*y+m*h*E-c*g*E,D=t*A+r*P+n*O+l*R;if(D===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let L=1/D;return e[0]=A*L,e[1]=(S*y*l-g*E*l-S*n*_+r*E*_+g*n*T-r*y*T)*L,e[2]=(h*E*l-S*d*l+S*n*f-r*E*f-h*n*T+r*d*T)*L,e[3]=(g*d*l-h*y*l-g*n*f+r*y*f+h*n*_-r*d*_)*L,e[4]=P*L,e[5]=(m*E*l-b*y*l+b*n*_-t*E*_-m*n*T+t*y*T)*L,e[6]=(b*d*l-c*E*l-b*n*f+t*E*f+c*n*T-t*d*T)*L,e[7]=(c*y*l-m*d*l+m*n*f-t*y*f-c*n*_+t*d*_)*L,e[8]=O*L,e[9]=(b*g*l-m*S*l-b*r*_+t*S*_+m*r*T-t*g*T)*L,e[10]=(c*S*l-b*h*l+b*r*f-t*S*f-c*r*T+t*h*T)*L,e[11]=(m*h*l-c*g*l-m*r*f+t*g*f+c*r*_-t*h*_)*L,e[12]=R*L,e[13]=(m*S*n-b*g*n+b*r*y-t*S*y-m*r*E+t*g*E)*L,e[14]=(b*h*n-c*S*n-b*r*d+t*S*d+c*r*E-t*h*E)*L,e[15]=(c*g*n-m*h*n+m*r*d-t*g*d-c*r*y+t*h*y)*L,this}scale(e){let t=this.elements,r=e.x,n=e.y,l=e.z;return t[0]*=r,t[4]*=n,t[8]*=l,t[1]*=r,t[5]*=n,t[9]*=l,t[2]*=r,t[6]*=n,t[10]*=l,t[3]*=r,t[7]*=n,t[11]*=l,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,n))}makeTranslation(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let r=Math.cos(t),n=Math.sin(t),l=1-r,c=e.x,h=e.y,d=e.z,f=l*c,m=l*h;return this.set(f*c+r,f*h-n*d,f*d+n*h,0,f*h+n*d,m*h+r,m*d-n*c,0,f*d-n*h,m*d+n*c,l*d*d+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,n,l,c){return this.set(1,r,l,0,e,1,c,0,t,n,1,0,0,0,0,1),this}compose(e,t,r){let n=this.elements,l=t._x,c=t._y,h=t._z,d=t._w,f=l+l,m=c+c,g=h+h,y=l*f,_=l*m,b=l*g,S=c*m,E=c*g,T=h*g,A=d*f,P=d*m,O=d*g,R=r.x,D=r.y,L=r.z;return n[0]=(1-(S+T))*R,n[1]=(_+O)*R,n[2]=(b-P)*R,n[3]=0,n[4]=(_-O)*D,n[5]=(1-(y+T))*D,n[6]=(E+A)*D,n[7]=0,n[8]=(b+P)*L,n[9]=(E-A)*L,n[10]=(1-(y+S))*L,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,t,r){let n=this.elements,l=Xw.set(n[0],n[1],n[2]).length(),c=Xw.set(n[4],n[5],n[6]).length(),h=Xw.set(n[8],n[9],n[10]).length();this.determinant()<0&&(l=-l),e.x=n[12],e.y=n[13],e.z=n[14],Md.copy(this);let d=1/l,f=1/c,m=1/h;return Md.elements[0]*=d,Md.elements[1]*=d,Md.elements[2]*=d,Md.elements[4]*=f,Md.elements[5]*=f,Md.elements[6]*=f,Md.elements[8]*=m,Md.elements[9]*=m,Md.elements[10]*=m,t.setFromRotationMatrix(Md),r.x=l,r.y=c,r.z=h,this}makePerspective(e,t,r,n,l,c){c===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");let h=this.elements,d=2*l/(t-e),f=2*l/(r-n),m=(t+e)/(t-e),g=(r+n)/(r-n),y=-(c+l)/(c-l),_=-2*c*l/(c-l);return h[0]=d,h[4]=0,h[8]=m,h[12]=0,h[1]=0,h[5]=f,h[9]=g,h[13]=0,h[2]=0,h[6]=0,h[10]=y,h[14]=_,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this}makeOrthographic(e,t,r,n,l,c){let h=this.elements,d=1/(t-e),f=1/(r-n),m=1/(c-l),g=(t+e)*d,y=(r+n)*f,_=(c+l)*m;return h[0]=2*d,h[4]=0,h[8]=0,h[12]=-g,h[1]=0,h[5]=2*f,h[9]=0,h[13]=-y,h[2]=0,h[6]=0,h[10]=-2*m,h[14]=-_,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this}equals(e){let t=this.elements,r=e.elements;for(let n=0;n<16;n++)if(t[n]!==r[n])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){let r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}};Yr.prototype.isMatrix4=!0;var Xw=new Qe,Md=new Yr,Mce=new Qe(0,0,0),Ece=new Qe(1,1,1),Kp=new Qe,V2=new Qe,Su=new Qe,GH=new Yr,qH=new Zd,SC=class{constructor(e=0,t=0,r=0,n=SC.DefaultOrder){this._x=e,this._y=t,this._z=r,this._order=n}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,n=this._order){return this._x=e,this._y=t,this._z=r,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){let n=e.elements,l=n[0],c=n[4],h=n[8],d=n[1],f=n[5],m=n[9],g=n[2],y=n[6],_=n[10];switch(t){case"XYZ":this._y=Math.asin(Wl(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-m,_),this._z=Math.atan2(-c,l)):(this._x=Math.atan2(y,f),this._z=0);break;case"YXZ":this._x=Math.asin(-Wl(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(h,_),this._z=Math.atan2(d,f)):(this._y=Math.atan2(-g,l),this._z=0);break;case"ZXY":this._x=Math.asin(Wl(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(-g,_),this._z=Math.atan2(-c,f)):(this._y=0,this._z=Math.atan2(d,l));break;case"ZYX":this._y=Math.asin(-Wl(g,-1,1)),Math.abs(g)<.9999999?(this._x=Math.atan2(y,_),this._z=Math.atan2(d,l)):(this._x=0,this._z=Math.atan2(-c,f));break;case"YZX":this._z=Math.asin(Wl(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(-m,f),this._y=Math.atan2(-g,l)):(this._x=0,this._y=Math.atan2(h,_));break;case"XZY":this._z=Math.asin(-Wl(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(y,f),this._y=Math.atan2(h,l)):(this._x=Math.atan2(-m,_),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return GH.makeRotationFromQuaternion(e),this.setFromRotationMatrix(GH,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return qH.setFromEuler(this),this.setFromQuaternion(qH,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}};SC.prototype.isEuler=!0;SC.DefaultOrder="XYZ";SC.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];var Tce=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},Ace=0,XH=new Qe,Zw=new Zd,Vf=new Yr,W2=new Qe,ZE=new Qe,Cce=new Qe,Pce=new Zd,ZH=new Qe(1,0,0),JH=new Qe(0,1,0),YH=new Qe(0,0,1),Rce={type:"added"},KH={type:"removed"},ka=class extends tL{constructor(){super(),Object.defineProperty(this,"id",{value:Ace++}),this.uuid=Wd(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ka.DefaultUp.clone();let e=new Qe,t=new SC,r=new Zd,n=new Qe(1,1,1);function l(){r.setFromEuler(t,!1)}function c(){t.setFromQuaternion(r,void 0,!1)}t._onChange(l),r._onChange(c),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new Yr},normalMatrix:{value:new wC}}),this.matrix=new Yr,this.matrixWorld=new Yr,this.matrixAutoUpdate=ka.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Tce,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Zw.setFromAxisAngle(e,t),this.quaternion.multiply(Zw),this}rotateOnWorldAxis(e,t){return Zw.setFromAxisAngle(e,t),this.quaternion.premultiply(Zw),this}rotateX(e){return this.rotateOnAxis(ZH,e)}rotateY(e){return this.rotateOnAxis(JH,e)}rotateZ(e){return this.rotateOnAxis(YH,e)}translateOnAxis(e,t){return XH.copy(e).applyQuaternion(this.quaternion),this.position.add(XH.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(ZH,e)}translateY(e){return this.translateOnAxis(JH,e)}translateZ(e){return this.translateOnAxis(YH,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(Vf.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?W2.copy(e):W2.set(e,t,r);let n=this.parent;this.updateWorldMatrix(!0,!1),ZE.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Vf.lookAt(ZE,W2,this.up):Vf.lookAt(W2,ZE,this.up),this.quaternion.setFromRotationMatrix(Vf),n&&(Vf.extractRotation(n.matrixWorld),Zw.setFromRotationMatrix(Vf),this.quaternion.premultiply(Zw.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Rce)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}let t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(KH)),this}removeFromParent(){let e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){let t=this.children[e];t.parent=null,t.dispatchEvent(KH)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),Vf.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Vf.multiply(e.parent.matrixWorld)),e.applyMatrix4(Vf),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,n=this.children.length;r<n;r++){let l=this.children[r].getObjectByProperty(e,t);if(l!==void 0)return l}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ZE,e,Cce),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ZE,Pce,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);let t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);let t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverseVisible(e)}traverseAncestors(e){let t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);let t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].updateMatrixWorld(e)}updateWorldMatrix(e,t){let r=this.parent;if(e===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){let n=this.children;for(let l=0,c=n.length;l<c;l++)n[l].updateWorldMatrix(!1,!0)}}toJSON(e){let t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});let n={};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.castShadow===!0&&(n.castShadow=!0),this.receiveShadow===!0&&(n.receiveShadow=!0),this.visible===!1&&(n.visible=!1),this.frustumCulled===!1&&(n.frustumCulled=!1),this.renderOrder!==0&&(n.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(n.instanceColor=this.instanceColor.toJSON()));function l(h,d){return h[d.uuid]===void 0&&(h[d.uuid]=d.toJSON(e)),d.uuid}if(this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(n.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=l(e.geometries,this.geometry);let h=this.geometry.parameters;if(h!==void 0&&h.shapes!==void 0){let d=h.shapes;if(Array.isArray(d))for(let f=0,m=d.length;f<m;f++){let g=d[f];l(e.shapes,g)}else l(e.shapes,d)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(l(e.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let h=[];for(let d=0,f=this.material.length;d<f;d++)h.push(l(e.materials,this.material[d]));n.material=h}else n.material=l(e.materials,this.material);if(this.children.length>0){n.children=[];for(let h=0;h<this.children.length;h++)n.children.push(this.children[h].toJSON(e).object)}if(this.animations.length>0){n.animations=[];for(let h=0;h<this.animations.length;h++){let d=this.animations[h];n.animations.push(l(e.animations,d))}}if(t){let h=c(e.geometries),d=c(e.materials),f=c(e.textures),m=c(e.images),g=c(e.shapes),y=c(e.skeletons),_=c(e.animations),b=c(e.nodes);h.length>0&&(r.geometries=h),d.length>0&&(r.materials=d),f.length>0&&(r.textures=f),m.length>0&&(r.images=m),g.length>0&&(r.shapes=g),y.length>0&&(r.skeletons=y),_.length>0&&(r.animations=_),b.length>0&&(r.nodes=b)}return r.object=n,r;function c(h){let d=[];for(let f in h){let m=h[f];delete m.metadata,d.push(m)}return d}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){let n=e.children[r];this.add(n.clone())}return this}};ka.DefaultUp=new Qe(0,1,0);ka.DefaultMatrixAutoUpdate=!0;ka.prototype.isObject3D=!0;var Ed=new Qe,Wf=new Qe,rN=new Qe,jf=new Qe,Jw=new Qe,Yw=new Qe,QH=new Qe,nN=new Qe,sN=new Qe,aN=new Qe,Em=class{constructor(e=new Qe,t=new Qe,r=new Qe){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,n){n.subVectors(r,t),Ed.subVectors(e,t),n.cross(Ed);let l=n.lengthSq();return l>0?n.multiplyScalar(1/Math.sqrt(l)):n.set(0,0,0)}static getBarycoord(e,t,r,n,l){Ed.subVectors(n,t),Wf.subVectors(r,t),rN.subVectors(e,t);let c=Ed.dot(Ed),h=Ed.dot(Wf),d=Ed.dot(rN),f=Wf.dot(Wf),m=Wf.dot(rN),g=c*f-h*h;if(g===0)return l.set(-2,-1,-1);let y=1/g,_=(f*d-h*m)*y,b=(c*m-h*d)*y;return l.set(1-_-b,b,_)}static containsPoint(e,t,r,n){return this.getBarycoord(e,t,r,n,jf),jf.x>=0&&jf.y>=0&&jf.x+jf.y<=1}static getUV(e,t,r,n,l,c,h,d){return this.getBarycoord(e,t,r,n,jf),d.set(0,0),d.addScaledVector(l,jf.x),d.addScaledVector(c,jf.y),d.addScaledVector(h,jf.z),d}static isFrontFacing(e,t,r,n){return Ed.subVectors(r,t),Wf.subVectors(e,t),Ed.cross(Wf).dot(n)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,n){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[n]),this}setFromAttributeAndIndices(e,t,r,n){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ed.subVectors(this.c,this.b),Wf.subVectors(this.a,this.b),Ed.cross(Wf).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Em.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Em.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,r,n,l){return Em.getUV(e,this.a,this.b,this.c,t,r,n,l)}containsPoint(e){return Em.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Em.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let r=this.a,n=this.b,l=this.c,c,h;Jw.subVectors(n,r),Yw.subVectors(l,r),nN.subVectors(e,r);let d=Jw.dot(nN),f=Yw.dot(nN);if(d<=0&&f<=0)return t.copy(r);sN.subVectors(e,n);let m=Jw.dot(sN),g=Yw.dot(sN);if(m>=0&&g<=m)return t.copy(n);let y=d*g-m*f;if(y<=0&&d>=0&&m<=0)return c=d/(d-m),t.copy(r).addScaledVector(Jw,c);aN.subVectors(e,l);let _=Jw.dot(aN),b=Yw.dot(aN);if(b>=0&&_<=b)return t.copy(l);let S=_*f-d*b;if(S<=0&&f>=0&&b<=0)return h=f/(f-b),t.copy(r).addScaledVector(Yw,h);let E=m*b-_*g;if(E<=0&&g-m>=0&&_-b>=0)return QH.subVectors(l,n),h=(g-m)/(g-m+(_-b)),t.copy(n).addScaledVector(QH,h);let T=1/(E+S+y);return c=S*T,h=y*T,t.copy(r).addScaledVector(Jw,c).addScaledVector(Yw,h)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},Ice=0,Cs=class extends tL{constructor(){super(),Object.defineProperty(this,"id",{value:Ice++}),this.uuid=Wd(),this.name="",this.type="Material",this.fog=!0,this.blending=BH,this.side=hF,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=$ue,this.blendDst=Vue,this.blendEquation=Hue,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Wue,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=ice,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=GO,this.stencilZFail=GO,this.stencilZPass=GO,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let t in e){let r=e[t];if(r===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if(t==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=r===Uue;continue}let n=this[t];if(n===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}n&&n.isColor?n.set(r):n&&n.isVector3&&r&&r.isVector3?n.copy(r):this[t]=r}}toJSON(e){let t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});let r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==BH&&(r.blending=this.blending),this.side!==hF&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(r.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=this.flatShading),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(r.userData=this.userData);function n(l){let c=[];for(let h in l){let d=l[h];delete d.metadata,c.push(d)}return c}if(t){let l=n(e.textures),c=n(e.images);l.length>0&&(r.textures=l),c.length>0&&(r.images=c)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,r=null;if(t!==null){let n=t.length;r=new Array(n);for(let l=0;l!==n;++l)r[l]=t[l].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}};Cs.prototype.isMaterial=!0;Cs.fromType=function(){return null};var pp=class extends Cs{constructor(e){super(),this.type="MeshBasicMaterial",this.color=new Ar(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=rB,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}};pp.prototype.isMeshBasicMaterial=!0;var Ds=new Qe,j2=new $n,Du=class{constructor(e,t,r){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r===!0,this.usage=pF,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let n=0,l=this.itemSize;n<l;n++)this.array[e+n]=t.array[r+n];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){let t=this.array,r=0;for(let n=0,l=e.length;n<l;n++){let c=e[n];c===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),c=new Ar),t[r++]=c.r,t[r++]=c.g,t[r++]=c.b}return this}copyVector2sArray(e){let t=this.array,r=0;for(let n=0,l=e.length;n<l;n++){let c=e[n];c===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),c=new $n),t[r++]=c.x,t[r++]=c.y}return this}copyVector3sArray(e){let t=this.array,r=0;for(let n=0,l=e.length;n<l;n++){let c=e[n];c===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),c=new Qe),t[r++]=c.x,t[r++]=c.y,t[r++]=c.z}return this}copyVector4sArray(e){let t=this.array,r=0;for(let n=0,l=e.length;n<l;n++){let c=e[n];c===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),c=new Qu),t[r++]=c.x,t[r++]=c.y,t[r++]=c.z,t[r++]=c.w}return this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)j2.fromBufferAttribute(this,t),j2.applyMatrix3(e),this.setXY(t,j2.x,j2.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)Ds.fromBufferAttribute(this,t),Ds.applyMatrix3(e),this.setXYZ(t,Ds.x,Ds.y,Ds.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)Ds.fromBufferAttribute(this,t),Ds.applyMatrix4(e),this.setXYZ(t,Ds.x,Ds.y,Ds.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Ds.fromBufferAttribute(this,t),Ds.applyNormalMatrix(e),this.setXYZ(t,Ds.x,Ds.y,Ds.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Ds.fromBufferAttribute(this,t),Ds.transformDirection(e),this.setXYZ(t,Ds.x,Ds.y,Ds.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this}setXYZW(e,t,r,n,l){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this.array[e+3]=l,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==pF&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}};Du.prototype.isBufferAttribute=!0;var Lce=class extends Du{constructor(e,t,r){super(new Uint16Array(e),t,r)}},Oce=class extends Du{constructor(e,t,r){super(new Uint32Array(e),t,r)}},Nce=class extends Du{constructor(e,t,r){super(new Uint16Array(e),t,r)}};Nce.prototype.isFloat16BufferAttribute=!0;var lB=class extends Du{constructor(e,t,r){super(new Float32Array(e),t,r)}},Dce=0,Wu=new Yr,oN=new ka,Kw=new Qe,Mu=new xw,JE=new xw,$a=new Qe,vE=class extends tL{constructor(){super(),Object.defineProperty(this,"id",{value:Dce++}),this.uuid=Wd(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(i){return Array.isArray(i)?this.index=new(xce(i)?Oce:Lce)(i,1):this.index=i,this}getAttribute(i){return this.attributes[i]}setAttribute(i,e){return this.attributes[i]=e,this}deleteAttribute(i){return delete this.attributes[i],this}hasAttribute(i){return this.attributes[i]!==void 0}addGroup(i,e,t=0){this.groups.push({start:i,count:e,materialIndex:t})}clearGroups(){this.groups=[]}setDrawRange(i,e){this.drawRange.start=i,this.drawRange.count=e}applyMatrix4(i){let e=this.attributes.position;e!==void 0&&(e.applyMatrix4(i),e.needsUpdate=!0);let t=this.attributes.normal;if(t!==void 0){let n=new wC().getNormalMatrix(i);t.applyNormalMatrix(n),t.needsUpdate=!0}let r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(i),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(i){return Wu.makeRotationFromQuaternion(i),this.applyMatrix4(Wu),this}rotateX(i){return Wu.makeRotationX(i),this.applyMatrix4(Wu),this}rotateY(i){return Wu.makeRotationY(i),this.applyMatrix4(Wu),this}rotateZ(i){return Wu.makeRotationZ(i),this.applyMatrix4(Wu),this}translate(i,e,t){return Wu.makeTranslation(i,e,t),this.applyMatrix4(Wu),this}scale(i,e,t){return Wu.makeScale(i,e,t),this.applyMatrix4(Wu),this}lookAt(i){return oN.lookAt(i),oN.updateMatrix(),this.applyMatrix4(oN.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Kw).negate(),this.translate(Kw.x,Kw.y,Kw.z),this}setFromPoints(i){let e=[];for(let t=0,r=i.length;t<r;t++){let n=i[t];e.push(n.x,n.y,n.z||0)}return this.setAttribute("position",new lB(e,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new xw);let i=this.attributes.position,e=this.morphAttributes.position;if(i&&i.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Qe(-1/0,-1/0,-1/0),new Qe(1/0,1/0,1/0));return}if(i!==void 0){if(this.boundingBox.setFromBufferAttribute(i),e)for(let t=0,r=e.length;t<r;t++){let n=e[t];Mu.setFromBufferAttribute(n),this.morphTargetsRelative?($a.addVectors(this.boundingBox.min,Mu.min),this.boundingBox.expandByPoint($a),$a.addVectors(this.boundingBox.max,Mu.max),this.boundingBox.expandByPoint($a)):(this.boundingBox.expandByPoint(Mu.min),this.boundingBox.expandByPoint(Mu.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new gE);let i=this.attributes.position,e=this.morphAttributes.position;if(i&&i.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Qe,1/0);return}if(i){let t=this.boundingSphere.center;if(Mu.setFromBufferAttribute(i),e)for(let n=0,l=e.length;n<l;n++){let c=e[n];JE.setFromBufferAttribute(c),this.morphTargetsRelative?($a.addVectors(Mu.min,JE.min),Mu.expandByPoint($a),$a.addVectors(Mu.max,JE.max),Mu.expandByPoint($a)):(Mu.expandByPoint(JE.min),Mu.expandByPoint(JE.max))}Mu.getCenter(t);let r=0;for(let n=0,l=i.count;n<l;n++)$a.fromBufferAttribute(i,n),r=Math.max(r,t.distanceToSquared($a));if(e)for(let n=0,l=e.length;n<l;n++){let c=e[n],h=this.morphTargetsRelative;for(let d=0,f=c.count;d<f;d++)$a.fromBufferAttribute(c,d),h&&(Kw.fromBufferAttribute(i,d),$a.add(Kw)),r=Math.max(r,t.distanceToSquared($a))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let i=this.index,e=this.attributes;if(i===null||e.position===void 0||e.normal===void 0||e.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let t=i.array,r=e.position.array,n=e.normal.array,l=e.uv.array,c=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Du(new Float32Array(4*c),4));let h=this.getAttribute("tangent").array,d=[],f=[];for(let U=0;U<c;U++)d[U]=new Qe,f[U]=new Qe;let m=new Qe,g=new Qe,y=new Qe,_=new $n,b=new $n,S=new $n,E=new Qe,T=new Qe;function A(U,F,z){m.fromArray(r,U*3),g.fromArray(r,F*3),y.fromArray(r,z*3),_.fromArray(l,U*2),b.fromArray(l,F*2),S.fromArray(l,z*2),g.sub(m),y.sub(m),b.sub(_),S.sub(_);let G=1/(b.x*S.y-S.x*b.y);!isFinite(G)||(E.copy(g).multiplyScalar(S.y).addScaledVector(y,-b.y).multiplyScalar(G),T.copy(y).multiplyScalar(b.x).addScaledVector(g,-S.x).multiplyScalar(G),d[U].add(E),d[F].add(E),d[z].add(E),f[U].add(T),f[F].add(T),f[z].add(T))}let P=this.groups;P.length===0&&(P=[{start:0,count:t.length}]);for(let U=0,F=P.length;U<F;++U){let z=P[U],G=z.start,J=z.count;for(let Z=G,q=G+J;Z<q;Z+=3)A(t[Z+0],t[Z+1],t[Z+2])}let O=new Qe,R=new Qe,D=new Qe,L=new Qe;function N(U){D.fromArray(n,U*3),L.copy(D);let F=d[U];O.copy(F),O.sub(D.multiplyScalar(D.dot(F))).normalize(),R.crossVectors(L,F);let z=R.dot(f[U])<0?-1:1;h[U*4]=O.x,h[U*4+1]=O.y,h[U*4+2]=O.z,h[U*4+3]=z}for(let U=0,F=P.length;U<F;++U){let z=P[U],G=z.start,J=z.count;for(let Z=G,q=G+J;Z<q;Z+=3)N(t[Z+0]),N(t[Z+1]),N(t[Z+2])}}computeVertexNormals(){let i=this.index,e=this.getAttribute("position");if(e!==void 0){let t=this.getAttribute("normal");if(t===void 0)t=new Du(new Float32Array(e.count*3),3),this.setAttribute("normal",t);else for(let g=0,y=t.count;g<y;g++)t.setXYZ(g,0,0,0);let r=new Qe,n=new Qe,l=new Qe,c=new Qe,h=new Qe,d=new Qe,f=new Qe,m=new Qe;if(i)for(let g=0,y=i.count;g<y;g+=3){let _=i.getX(g+0),b=i.getX(g+1),S=i.getX(g+2);r.fromBufferAttribute(e,_),n.fromBufferAttribute(e,b),l.fromBufferAttribute(e,S),f.subVectors(l,n),m.subVectors(r,n),f.cross(m),c.fromBufferAttribute(t,_),h.fromBufferAttribute(t,b),d.fromBufferAttribute(t,S),c.add(f),h.add(f),d.add(f),t.setXYZ(_,c.x,c.y,c.z),t.setXYZ(b,h.x,h.y,h.z),t.setXYZ(S,d.x,d.y,d.z)}else for(let g=0,y=e.count;g<y;g+=3)r.fromBufferAttribute(e,g+0),n.fromBufferAttribute(e,g+1),l.fromBufferAttribute(e,g+2),f.subVectors(l,n),m.subVectors(r,n),f.cross(m),t.setXYZ(g+0,f.x,f.y,f.z),t.setXYZ(g+1,f.x,f.y,f.z),t.setXYZ(g+2,f.x,f.y,f.z);this.normalizeNormals(),t.needsUpdate=!0}}merge(i,e){if(!(i&&i.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",i);return}e===void 0&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));let t=this.attributes;for(let r in t){if(i.attributes[r]===void 0)continue;let n=t[r].array,l=i.attributes[r],c=l.array,h=l.itemSize*e,d=Math.min(c.length,n.length-h);for(let f=0,m=h;f<d;f++,m++)n[m]=c[f]}return this}normalizeNormals(){let i=this.attributes.normal;for(let e=0,t=i.count;e<t;e++)$a.fromBufferAttribute(i,e),$a.normalize(),i.setXYZ(e,$a.x,$a.y,$a.z)}toNonIndexed(){function i(c,h){let d=c.array,f=c.itemSize,m=c.normalized,g=new d.constructor(h.length*f),y=0,_=0;for(let b=0,S=h.length;b<S;b++){c.isInterleavedBufferAttribute?y=h[b]*c.data.stride+c.offset:y=h[b]*f;for(let E=0;E<f;E++)g[_++]=d[y++]}return new Du(g,f,m)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let e=new vE,t=this.index.array,r=this.attributes;for(let c in r){let h=r[c],d=i(h,t);e.setAttribute(c,d)}let n=this.morphAttributes;for(let c in n){let h=[],d=n[c];for(let f=0,m=d.length;f<m;f++){let g=d[f],y=i(g,t);h.push(y)}e.morphAttributes[c]=h}e.morphTargetsRelative=this.morphTargetsRelative;let l=this.groups;for(let c=0,h=l.length;c<h;c++){let d=l[c];e.addGroup(d.start,d.count,d.materialIndex)}return e}toJSON(){let i={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),Object.keys(this.userData).length>0&&(i.userData=this.userData),this.parameters!==void 0){let h=this.parameters;for(let d in h)h[d]!==void 0&&(i[d]=h[d]);return i}i.data={attributes:{}};let e=this.index;e!==null&&(i.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});let t=this.attributes;for(let h in t){let d=t[h];i.data.attributes[h]=d.toJSON(i.data)}let r={},n=!1;for(let h in this.morphAttributes){let d=this.morphAttributes[h],f=[];for(let m=0,g=d.length;m<g;m++){let y=d[m];f.push(y.toJSON(i.data))}f.length>0&&(r[h]=f,n=!0)}n&&(i.data.morphAttributes=r,i.data.morphTargetsRelative=this.morphTargetsRelative);let l=this.groups;l.length>0&&(i.data.groups=JSON.parse(JSON.stringify(l)));let c=this.boundingSphere;return c!==null&&(i.data.boundingSphere={center:c.center.toArray(),radius:c.radius}),i}clone(){return new this.constructor().copy(this)}copy(i){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let e={};this.name=i.name;let t=i.index;t!==null&&this.setIndex(t.clone(e));let r=i.attributes;for(let d in r){let f=r[d];this.setAttribute(d,f.clone(e))}let n=i.morphAttributes;for(let d in n){let f=[],m=n[d];for(let g=0,y=m.length;g<y;g++)f.push(m[g].clone(e));this.morphAttributes[d]=f}this.morphTargetsRelative=i.morphTargetsRelative;let l=i.groups;for(let d=0,f=l.length;d<f;d++){let m=l[d];this.addGroup(m.start,m.count,m.materialIndex)}let c=i.boundingBox;c!==null&&(this.boundingBox=c.clone());let h=i.boundingSphere;return h!==null&&(this.boundingSphere=h.clone()),this.drawRange.start=i.drawRange.start,this.drawRange.count=i.drawRange.count,this.userData=i.userData,i.parameters!==void 0&&(this.parameters=Object.assign({},i.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}};vE.prototype.isBufferGeometry=!0;var e$=new Yr,Qw=new oB,lN=new gE,Qp=new Qe,em=new Qe,tm=new Qe,uN=new Qe,cN=new Qe,hN=new Qe,G2=new Qe,q2=new Qe,X2=new Qe,Z2=new $n,J2=new $n,Y2=new $n,dN=new Qe,K2=new Qe,MC=class extends ka{constructor(e=new vE,t=new pp){super(),this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry;if(e.isBufferGeometry){let t=e.morphAttributes,r=Object.keys(t);if(r.length>0){let n=t[r[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,c=n.length;l<c;l++){let h=n[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[h]=l}}}}else{let t=e.morphTargets;t!==void 0&&t.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(e,t){let r=this.geometry,n=this.material,l=this.matrixWorld;if(n===void 0||(r.boundingSphere===null&&r.computeBoundingSphere(),lN.copy(r.boundingSphere),lN.applyMatrix4(l),e.ray.intersectsSphere(lN)===!1)||(e$.copy(l).invert(),Qw.copy(e.ray).applyMatrix4(e$),r.boundingBox!==null&&Qw.intersectsBox(r.boundingBox)===!1))return;let c;if(r.isBufferGeometry){let h=r.index,d=r.attributes.position,f=r.morphAttributes.position,m=r.morphTargetsRelative,g=r.attributes.uv,y=r.attributes.uv2,_=r.groups,b=r.drawRange;if(h!==null)if(Array.isArray(n))for(let S=0,E=_.length;S<E;S++){let T=_[S],A=n[T.materialIndex],P=Math.max(T.start,b.start),O=Math.min(h.count,Math.min(T.start+T.count,b.start+b.count));for(let R=P,D=O;R<D;R+=3){let L=h.getX(R),N=h.getX(R+1),U=h.getX(R+2);c=Q2(this,A,e,Qw,d,f,m,g,y,L,N,U),c&&(c.faceIndex=Math.floor(R/3),c.face.materialIndex=T.materialIndex,t.push(c))}}else{let S=Math.max(0,b.start),E=Math.min(h.count,b.start+b.count);for(let T=S,A=E;T<A;T+=3){let P=h.getX(T),O=h.getX(T+1),R=h.getX(T+2);c=Q2(this,n,e,Qw,d,f,m,g,y,P,O,R),c&&(c.faceIndex=Math.floor(T/3),t.push(c))}}else if(d!==void 0)if(Array.isArray(n))for(let S=0,E=_.length;S<E;S++){let T=_[S],A=n[T.materialIndex],P=Math.max(T.start,b.start),O=Math.min(d.count,Math.min(T.start+T.count,b.start+b.count));for(let R=P,D=O;R<D;R+=3){let L=R,N=R+1,U=R+2;c=Q2(this,A,e,Qw,d,f,m,g,y,L,N,U),c&&(c.faceIndex=Math.floor(R/3),c.face.materialIndex=T.materialIndex,t.push(c))}}else{let S=Math.max(0,b.start),E=Math.min(d.count,b.start+b.count);for(let T=S,A=E;T<A;T+=3){let P=T,O=T+1,R=T+2;c=Q2(this,n,e,Qw,d,f,m,g,y,P,O,R),c&&(c.faceIndex=Math.floor(T/3),t.push(c))}}}else r.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}};MC.prototype.isMesh=!0;function kce(i,e,t,r,n,l,c,h){let d;if(e.side===Bue?d=r.intersectTriangle(c,l,n,!0,h):d=r.intersectTriangle(n,l,c,e.side!==iB,h),d===null)return null;K2.copy(h),K2.applyMatrix4(i.matrixWorld);let f=t.ray.origin.distanceTo(K2);return f<t.near||f>t.far?null:{distance:f,point:K2.clone(),object:i}}function Q2(i,e,t,r,n,l,c,h,d,f,m,g){Qp.fromBufferAttribute(n,f),em.fromBufferAttribute(n,m),tm.fromBufferAttribute(n,g);let y=i.morphTargetInfluences;if(l&&y){G2.set(0,0,0),q2.set(0,0,0),X2.set(0,0,0);for(let b=0,S=l.length;b<S;b++){let E=y[b],T=l[b];E!==0&&(uN.fromBufferAttribute(T,f),cN.fromBufferAttribute(T,m),hN.fromBufferAttribute(T,g),c?(G2.addScaledVector(uN,E),q2.addScaledVector(cN,E),X2.addScaledVector(hN,E)):(G2.addScaledVector(uN.sub(Qp),E),q2.addScaledVector(cN.sub(em),E),X2.addScaledVector(hN.sub(tm),E)))}Qp.add(G2),em.add(q2),tm.add(X2)}i.isSkinnedMesh&&(i.boneTransform(f,Qp),i.boneTransform(m,em),i.boneTransform(g,tm));let _=kce(i,e,t,r,Qp,em,tm,dN);if(_){h&&(Z2.fromBufferAttribute(h,f),J2.fromBufferAttribute(h,m),Y2.fromBufferAttribute(h,g),_.uv=Em.getUV(dN,Qp,em,tm,Z2,J2,Y2,new $n)),d&&(Z2.fromBufferAttribute(d,f),J2.fromBufferAttribute(d,m),Y2.fromBufferAttribute(d,g),_.uv2=Em.getUV(dN,Qp,em,tm,Z2,J2,Y2,new $n));let b={a:f,b:m,c:g,normal:new Qe,materialIndex:0};Em.getNormal(Qp,em,tm,b.normal),_.face=b}return _}function Fce(i){let e={};for(let t in i){e[t]={};for(let r in i[t]){let n=i[t][r];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?e[t][r]=n.clone():Array.isArray(n)?e[t][r]=n.slice():e[t][r]=n}}return e}var zce=`
void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
`,Bce=`
void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}
`,uB=class extends Cs{constructor(e){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=zce,this.fragmentShader=Bce,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&(e.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Fce(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let n in this.uniforms){let l=this.uniforms[n].value;l&&l.isTexture?t.uniforms[n]={type:"t",value:l.toJSON(e).uuid}:l&&l.isColor?t.uniforms[n]={type:"c",value:l.getHex()}:l&&l.isVector2?t.uniforms[n]={type:"v2",value:l.toArray()}:l&&l.isVector3?t.uniforms[n]={type:"v3",value:l.toArray()}:l&&l.isVector4?t.uniforms[n]={type:"v4",value:l.toArray()}:l&&l.isMatrix3?t.uniforms[n]={type:"m3",value:l.toArray()}:l&&l.isMatrix4?t.uniforms[n]={type:"m4",value:l.toArray()}:t.uniforms[n]={value:l}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;let r={};for(let n in this.extensions)this.extensions[n]===!0&&(r[n]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}};uB.prototype.isShaderMaterial=!0;var cB=class extends ka{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new Yr,this.projectionMatrix=new Yr,this.projectionMatrixInverse=new Yr}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}};cB.prototype.isCamera=!0;var iL=class extends cB{constructor(e=50,t=1,r=.1,n=2e3){super(),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=n,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=kA*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(JT*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return kA*2*Math.atan(Math.tan(JT*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,n,l,c){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=l,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(JT*.5*this.fov)/this.zoom,r=2*t,n=this.aspect*r,l=-.5*n,c=this.view;if(this.view!==null&&this.view.enabled){let d=c.fullWidth,f=c.fullHeight;l+=c.offsetX*n/d,t-=c.offsetY*r/f,n*=c.width/d,r*=c.height/f}let h=this.filmOffset;h!==0&&(l+=e*h/this.getFilmWidth()),this.projectionMatrix.makePerspective(l,l+n,t,t-r,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}};iL.prototype.isPerspectiveCamera=!0;var fN=new Qe,Uce=new Qe,Hce=new wC,S1=class{constructor(e=new Qe(1,0,0),t=0){this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,n){return this.normal.set(e,t,r),this.constant=n,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){let n=fN.subVectors(r,t).cross(Uce.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){let r=e.delta(fN),n=this.normal.dot(r);if(n===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let l=-(e.start.dot(this.normal)+this.constant)/n;return l<0||l>1?null:t.copy(r).multiplyScalar(l).add(e.start)}intersectsLine(e){let t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let r=t||Hce.getNormalMatrix(e),n=this.coplanarPoint(fN).applyMatrix4(e),l=this.normal.applyMatrix3(r).normalize();return this.constant=-n.dot(l),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}};S1.prototype.isPlane=!0;var eS=new gE,e3=new Qe,$ce=class{constructor(e=new S1,t=new S1,r=new S1,n=new S1,l=new S1,c=new S1){this.planes=[e,t,r,n,l,c]}set(e,t,r,n,l,c){let h=this.planes;return h[0].copy(e),h[1].copy(t),h[2].copy(r),h[3].copy(n),h[4].copy(l),h[5].copy(c),this}copy(e){let t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e){let t=this.planes,r=e.elements,n=r[0],l=r[1],c=r[2],h=r[3],d=r[4],f=r[5],m=r[6],g=r[7],y=r[8],_=r[9],b=r[10],S=r[11],E=r[12],T=r[13],A=r[14],P=r[15];return t[0].setComponents(h-n,g-d,S-y,P-E).normalize(),t[1].setComponents(h+n,g+d,S+y,P+E).normalize(),t[2].setComponents(h+l,g+f,S+_,P+T).normalize(),t[3].setComponents(h-l,g-f,S-_,P-T).normalize(),t[4].setComponents(h-c,g-m,S-b,P-A).normalize(),t[5].setComponents(h+c,g+m,S+b,P+A).normalize(),this}intersectsObject(e){let t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),eS.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(eS)}intersectsSprite(e){return eS.center.set(0,0,0),eS.radius=.7071067811865476,eS.applyMatrix4(e.matrixWorld),this.intersectsSphere(eS)}intersectsSphere(e){let t=this.planes,r=e.center,n=-e.radius;for(let l=0;l<6;l++)if(t[l].distanceToPoint(r)<n)return!1;return!0}intersectsBox(e){let t=this.planes;for(let r=0;r<6;r++){let n=t[r];if(e3.x=n.normal.x>0?e.max.x:e.min.x,e3.y=n.normal.y>0?e.max.y:e.min.y,e3.z=n.normal.z>0?e.max.z:e.min.z,n.distanceToPoint(e3)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}},hB=class extends cB{constructor(e=-1,t=1,r=1,n=-1,l=.1,c=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=n,this.near=l,this.far=c,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,n,l,c){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=l,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2,l=r-e,c=r+e,h=n+t,d=n-t;if(this.view!==null&&this.view.enabled){let f=(this.right-this.left)/this.view.fullWidth/this.zoom,m=(this.top-this.bottom)/this.view.fullHeight/this.zoom;l+=f*this.view.offsetX,c=l+f*this.view.width,h-=m*this.view.offsetY,d=h-m*this.view.height}this.projectionMatrix.makeOrthographic(l,c,h,d,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}};hB.prototype.isOrthographicCamera=!0;var K7=class extends Cs{constructor(i){super(),this.type="MeshDepthMaterial",this.depthPacking=tce,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(i)}copy(i){return super.copy(i),this.depthPacking=i.depthPacking,this.map=i.map,this.alphaMap=i.alphaMap,this.displacementMap=i.displacementMap,this.displacementScale=i.displacementScale,this.displacementBias=i.displacementBias,this.wireframe=i.wireframe,this.wireframeLinewidth=i.wireframeLinewidth,this}};K7.prototype.isMeshDepthMaterial=!0;var Q7=class extends Cs{constructor(i){super(),this.type="MeshDistanceMaterial",this.referencePosition=new Qe,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(i)}copy(i){return super.copy(i),this.referencePosition.copy(i.referencePosition),this.nearDistance=i.nearDistance,this.farDistance=i.farDistance,this.map=i.map,this.alphaMap=i.alphaMap,this.displacementMap=i.displacementMap,this.displacementScale=i.displacementScale,this.displacementBias=i.displacementBias,this}};Q7.prototype.isMeshDistanceMaterial=!0;var GP=class extends ka{constructor(){super(),this.type="Group"}};GP.prototype.isGroup=!0;var eq=class{constructor(e,t){this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=pF,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Wd()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let n=0,l=this.stride;n<l;n++)this.array[e+n]=t.array[r+n];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Wd()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Wd()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}};eq.prototype.isInterleavedBuffer=!0;var Bl=new Qe,dB=class{constructor(e,t,r,n=!1){this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=n===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)Bl.fromBufferAttribute(this,t),Bl.applyMatrix4(e),this.setXYZ(t,Bl.x,Bl.y,Bl.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Bl.fromBufferAttribute(this,t),Bl.applyNormalMatrix(e),this.setXYZ(t,Bl.x,Bl.y,Bl.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Bl.fromBufferAttribute(this,t),Bl.transformDirection(e),this.setXYZ(t,Bl.x,Bl.y,Bl.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this}setXYZW(e,t,r,n,l){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this.data.array[e+3]=l,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let n=r*this.data.stride+this.offset;for(let l=0;l<this.itemSize;l++)t.push(this.data.array[n+l])}return new Du(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new dB(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let n=r*this.data.stride+this.offset;for(let l=0;l<this.itemSize;l++)t.push(this.data.array[n+l])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}};dB.prototype.isInterleavedBufferAttribute=!0;var tq=class extends Cs{constructor(i){super(),this.type="SpriteMaterial",this.color=new Ar(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(i)}copy(i){return super.copy(i),this.color.copy(i.color),this.map=i.map,this.alphaMap=i.alphaMap,this.rotation=i.rotation,this.sizeAttenuation=i.sizeAttenuation,this}};tq.prototype.isSpriteMaterial=!0;var t$=new Qe,i$=new Qu,r$=new Qu,Vce=new Qe,n$=new Yr,iq=class extends MC{constructor(e,t){super(e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Yr,this.bindMatrixInverse=new Yr}copy(e){return super.copy(e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let e=new Qu,t=this.geometry.attributes.skinWeight;for(let r=0,n=t.count;r<n;r++){e.fromBufferAttribute(t,r);let l=1/e.manhattanLength();l!==1/0?e.multiplyScalar(l):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){let r=this.skeleton,n=this.geometry;i$.fromBufferAttribute(n.attributes.skinIndex,e),r$.fromBufferAttribute(n.attributes.skinWeight,e),t$.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let l=0;l<4;l++){let c=r$.getComponent(l);if(c!==0){let h=i$.getComponent(l);n$.multiplyMatrices(r.bones[h].matrixWorld,r.boneInverses[h]),t.addScaledVector(Vce.copy(t$).applyMatrix4(n$),c)}}return t.applyMatrix4(this.bindMatrixInverse)}};iq.prototype.isSkinnedMesh=!0;var fB=class extends ka{constructor(){super(),this.type="Bone"}};fB.prototype.isBone=!0;var rq=class extends Ap{constructor(i=null,e=1,t=1,r,n,l,c,h,d=fF,f=fF,m,g){super(null,l,c,h,d,f,r,n,m,g),this.image={data:i,width:e,height:t},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};rq.prototype.isDataTexture=!0;var s$=new Yr,Wce=new Yr,nq=class{constructor(e=[],t=[]){this.uuid=Wd(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,n=this.bones.length;r<n;r++)this.boneInverses.push(new Yr)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let r=new Yr;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){let e=this.bones,t=this.boneInverses,r=this.boneMatrices,n=this.boneTexture;for(let l=0,c=e.length;l<c;l++){let h=e[l]?e[l].matrixWorld:Wce;s$.multiplyMatrices(h,t[l]),s$.toArray(r,l*16)}n!==null&&(n.needsUpdate=!0)}clone(){return new nq(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Z7(e),e=Math.max(e,4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let r=new rq(t,e,e,q7,Zue);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){let n=this.bones[t];if(n.name===e)return n}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,n=e.bones.length;r<n;r++){let l=e.bones[r],c=t[l];c===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",l),c=new fB),this.bones.push(c),this.boneInverses.push(new Yr().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){let e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,r=this.boneInverses;for(let n=0,l=t.length;n<l;n++){let c=t[n];e.bones.push(c.uuid);let h=r[n];e.boneInverses.push(h.toArray())}return e}},gF=class extends Du{constructor(e,t,r,n=1){typeof r=="number"&&(n=r,r=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,t,r),this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}};gF.prototype.isInstancedBufferAttribute=!0;var a$=new Yr,o$=new Yr,t3=[],YE=new MC,sq=class extends MC{constructor(e,t,r){super(e,t),this.instanceMatrix=new gF(new Float32Array(r*16),16),this.instanceColor=null,this.count=r,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){let r=this.matrixWorld,n=this.count;if(YE.geometry=this.geometry,YE.material=this.material,YE.material!==void 0)for(let l=0;l<n;l++){this.getMatrixAt(l,a$),o$.multiplyMatrices(r,a$),YE.matrixWorld=o$,YE.raycast(e,t3);for(let c=0,h=t3.length;c<h;c++){let d=t3[c];d.instanceId=l,d.object=this,t.push(d)}t3.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new gF(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}};sq.prototype.isInstancedMesh=!0;var EC=class extends Cs{constructor(e){super(),this.type="LineBasicMaterial",this.color=new Ar(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this}};EC.prototype.isLineBasicMaterial=!0;var l$=new Qe,u$=new Qe,c$=new Yr,pN=new oB,i3=new gE,rL=class extends ka{constructor(e=new vE,t=new EC){super(),this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.isBufferGeometry)if(e.index===null){let t=e.attributes.position,r=[0];for(let n=1,l=t.count;n<l;n++)l$.fromBufferAttribute(t,n-1),u$.fromBufferAttribute(t,n),r[n]=r[n-1],r[n]+=l$.distanceTo(u$);e.setAttribute("lineDistance",new lB(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(e,t){let r=this.geometry,n=this.matrixWorld,l=e.params.Line.threshold,c=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),i3.copy(r.boundingSphere),i3.applyMatrix4(n),i3.radius+=l,e.ray.intersectsSphere(i3)===!1)return;c$.copy(n).invert(),pN.copy(e.ray).applyMatrix4(c$);let h=l/((this.scale.x+this.scale.y+this.scale.z)/3),d=h*h,f=new Qe,m=new Qe,g=new Qe,y=new Qe,_=this.isLineSegments?2:1;if(r.isBufferGeometry){let b=r.index,S=r.attributes.position;if(b!==null){let E=Math.max(0,c.start),T=Math.min(b.count,c.start+c.count);for(let A=E,P=T-1;A<P;A+=_){let O=b.getX(A),R=b.getX(A+1);if(f.fromBufferAttribute(S,O),m.fromBufferAttribute(S,R),pN.distanceSqToSegment(f,m,y,g)>d)continue;y.applyMatrix4(this.matrixWorld);let D=e.ray.origin.distanceTo(y);D<e.near||D>e.far||t.push({distance:D,point:g.clone().applyMatrix4(this.matrixWorld),index:A,face:null,faceIndex:null,object:this})}}else{let E=Math.max(0,c.start),T=Math.min(S.count,c.start+c.count);for(let A=E,P=T-1;A<P;A+=_){if(f.fromBufferAttribute(S,A),m.fromBufferAttribute(S,A+1),pN.distanceSqToSegment(f,m,y,g)>d)continue;y.applyMatrix4(this.matrixWorld);let O=e.ray.origin.distanceTo(y);O<e.near||O>e.far||t.push({distance:O,point:g.clone().applyMatrix4(this.matrixWorld),index:A,face:null,faceIndex:null,object:this})}}}else r.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){let e=this.geometry;if(e.isBufferGeometry){let t=e.morphAttributes,r=Object.keys(t);if(r.length>0){let n=t[r[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,c=n.length;l<c;l++){let h=n[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[h]=l}}}}else{let t=e.morphTargets;t!==void 0&&t.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}};rL.prototype.isLine=!0;var h$=new Qe,d$=new Qe,aq=class extends rL{constructor(e,t){super(e,t),this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.isBufferGeometry)if(e.index===null){let t=e.attributes.position,r=[];for(let n=0,l=t.count;n<l;n+=2)h$.fromBufferAttribute(t,n),d$.fromBufferAttribute(t,n+1),r[n]=n===0?0:r[n-1],r[n+1]=r[n]+h$.distanceTo(d$);e.setAttribute("lineDistance",new lB(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}};aq.prototype.isLineSegments=!0;var oq=class extends rL{constructor(e,t){super(e,t),this.type="LineLoop"}};oq.prototype.isLineLoop=!0;var nL=class extends Cs{constructor(e){super(),this.type="PointsMaterial",this.color=new Ar(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this}};nL.prototype.isPointsMaterial=!0;var f$=new Yr,vF=new oB,r3=new gE,n3=new Qe,lq=class extends ka{constructor(e=new vE,t=new nL){super(),this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){let r=this.geometry,n=this.matrixWorld,l=e.params.Points.threshold,c=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),r3.copy(r.boundingSphere),r3.applyMatrix4(n),r3.radius+=l,e.ray.intersectsSphere(r3)===!1)return;f$.copy(n).invert(),vF.copy(e.ray).applyMatrix4(f$);let h=l/((this.scale.x+this.scale.y+this.scale.z)/3),d=h*h;if(r.isBufferGeometry){let f=r.index,m=r.attributes.position;if(f!==null){let g=Math.max(0,c.start),y=Math.min(f.count,c.start+c.count);for(let _=g,b=y;_<b;_++){let S=f.getX(_);n3.fromBufferAttribute(m,S),p$(n3,S,d,n,e,t,this)}}else{let g=Math.max(0,c.start),y=Math.min(m.count,c.start+c.count);for(let _=g,b=y;_<b;_++)n3.fromBufferAttribute(m,_),p$(n3,_,d,n,e,t,this)}}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){let e=this.geometry;if(e.isBufferGeometry){let t=e.morphAttributes,r=Object.keys(t);if(r.length>0){let n=t[r[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,c=n.length;l<c;l++){let h=n[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[h]=l}}}}else{let t=e.morphTargets;t!==void 0&&t.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}};lq.prototype.isPoints=!0;function p$(i,e,t,r,n,l,c){let h=vF.distanceSqToPoint(i);if(h<t){let d=new Qe;vF.closestPointToPoint(i,d),d.applyMatrix4(r);let f=n.ray.origin.distanceTo(d);if(f<n.near||f>n.far)return;l.push({distance:f,distanceToRay:Math.sqrt(h),point:d,index:e,face:null,object:c})}}var uq=class extends Cs{constructor(i){super(),this.type="ShadowMaterial",this.color=new Ar(0),this.transparent=!0,this.setValues(i)}copy(i){return super.copy(i),this.color.copy(i.color),this}};uq.prototype.isShadowMaterial=!0;var cq=class extends uB{constructor(i){super(i),this.type="RawShaderMaterial"}};cq.prototype.isRawShaderMaterial=!0;var TC=class extends Cs{constructor(e){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ar(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ar(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bC,this.normalScale=new $n(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}};TC.prototype.isMeshStandardMaterial=!0;var zp=class extends TC{constructor(e){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new $n(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Wl(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.sheenColor=new Ar(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new Ar(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Ar(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}};zp.prototype.isMeshPhysicalMaterial=!0;var hq=class extends Cs{constructor(i){super(),this.type="MeshPhongMaterial",this.color=new Ar(16777215),this.specular=new Ar(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ar(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bC,this.normalScale=new $n(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=rB,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(i)}copy(i){return super.copy(i),this.color.copy(i.color),this.specular.copy(i.specular),this.shininess=i.shininess,this.map=i.map,this.lightMap=i.lightMap,this.lightMapIntensity=i.lightMapIntensity,this.aoMap=i.aoMap,this.aoMapIntensity=i.aoMapIntensity,this.emissive.copy(i.emissive),this.emissiveMap=i.emissiveMap,this.emissiveIntensity=i.emissiveIntensity,this.bumpMap=i.bumpMap,this.bumpScale=i.bumpScale,this.normalMap=i.normalMap,this.normalMapType=i.normalMapType,this.normalScale.copy(i.normalScale),this.displacementMap=i.displacementMap,this.displacementScale=i.displacementScale,this.displacementBias=i.displacementBias,this.specularMap=i.specularMap,this.alphaMap=i.alphaMap,this.envMap=i.envMap,this.combine=i.combine,this.reflectivity=i.reflectivity,this.refractionRatio=i.refractionRatio,this.wireframe=i.wireframe,this.wireframeLinewidth=i.wireframeLinewidth,this.wireframeLinecap=i.wireframeLinecap,this.wireframeLinejoin=i.wireframeLinejoin,this.flatShading=i.flatShading,this}};hq.prototype.isMeshPhongMaterial=!0;var dq=class extends Cs{constructor(i){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ar(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ar(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bC,this.normalScale=new $n(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(i)}copy(i){return super.copy(i),this.color.copy(i.color),this.map=i.map,this.gradientMap=i.gradientMap,this.lightMap=i.lightMap,this.lightMapIntensity=i.lightMapIntensity,this.aoMap=i.aoMap,this.aoMapIntensity=i.aoMapIntensity,this.emissive.copy(i.emissive),this.emissiveMap=i.emissiveMap,this.emissiveIntensity=i.emissiveIntensity,this.bumpMap=i.bumpMap,this.bumpScale=i.bumpScale,this.normalMap=i.normalMap,this.normalMapType=i.normalMapType,this.normalScale.copy(i.normalScale),this.displacementMap=i.displacementMap,this.displacementScale=i.displacementScale,this.displacementBias=i.displacementBias,this.alphaMap=i.alphaMap,this.wireframe=i.wireframe,this.wireframeLinewidth=i.wireframeLinewidth,this.wireframeLinecap=i.wireframeLinecap,this.wireframeLinejoin=i.wireframeLinejoin,this}};dq.prototype.isMeshToonMaterial=!0;var fq=class extends Cs{constructor(i){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bC,this.normalScale=new $n(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(i)}copy(i){return super.copy(i),this.bumpMap=i.bumpMap,this.bumpScale=i.bumpScale,this.normalMap=i.normalMap,this.normalMapType=i.normalMapType,this.normalScale.copy(i.normalScale),this.displacementMap=i.displacementMap,this.displacementScale=i.displacementScale,this.displacementBias=i.displacementBias,this.wireframe=i.wireframe,this.wireframeLinewidth=i.wireframeLinewidth,this.flatShading=i.flatShading,this}};fq.prototype.isMeshNormalMaterial=!0;var pq=class extends Cs{constructor(e){super(),this.type="MeshLambertMaterial",this.color=new Ar(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ar(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=rB,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}};pq.prototype.isMeshLambertMaterial=!0;var mq=class extends Cs{constructor(e){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ar(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bC,this.normalScale=new $n(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}};mq.prototype.isMeshMatcapMaterial=!0;var gq=class extends EC{constructor(e){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}};gq.prototype.isLineDashedMaterial=!0;var jce={ShadowMaterial:uq,SpriteMaterial:tq,RawShaderMaterial:cq,ShaderMaterial:uB,PointsMaterial:nL,MeshPhysicalMaterial:zp,MeshStandardMaterial:TC,MeshPhongMaterial:hq,MeshToonMaterial:dq,MeshNormalMaterial:fq,MeshLambertMaterial:pq,MeshDepthMaterial:K7,MeshDistanceMaterial:Q7,MeshBasicMaterial:pp,MeshMatcapMaterial:mq,LineDashedMaterial:gq,LineBasicMaterial:EC,Material:Cs};Cs.fromType=function(i){return new jce[i]};var qn={arraySlice:function(i,e,t){return qn.isTypedArray(i)?new i.constructor(i.subarray(e,t!==void 0?t:i.length)):i.slice(e,t)},convertArray:function(i,e,t){return!i||!t&&i.constructor===e?i:typeof e.BYTES_PER_ELEMENT=="number"?new e(i):Array.prototype.slice.call(i)},isTypedArray:function(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)},getKeyframeOrder:function(i){function e(n,l){return i[n]-i[l]}let t=i.length,r=new Array(t);for(let n=0;n!==t;++n)r[n]=n;return r.sort(e),r},sortedArray:function(i,e,t){let r=i.length,n=new i.constructor(r);for(let l=0,c=0;c!==r;++l){let h=t[l]*e;for(let d=0;d!==e;++d)n[c++]=i[h+d]}return n},flattenJSON:function(i,e,t,r){let n=1,l=i[0];for(;l!==void 0&&l[r]===void 0;)l=i[n++];if(l===void 0)return;let c=l[r];if(c!==void 0)if(Array.isArray(c))do c=l[r],c!==void 0&&(e.push(l.time),t.push.apply(t,c)),l=i[n++];while(l!==void 0);else if(c.toArray!==void 0)do c=l[r],c!==void 0&&(e.push(l.time),c.toArray(t,t.length)),l=i[n++];while(l!==void 0);else do c=l[r],c!==void 0&&(e.push(l.time),t.push(c)),l=i[n++];while(l!==void 0)},subclip:function(i,e,t,r,n=30){let l=i.clone();l.name=e;let c=[];for(let d=0;d<l.tracks.length;++d){let f=l.tracks[d],m=f.getValueSize(),g=[],y=[];for(let _=0;_<f.times.length;++_){let b=f.times[_]*n;if(!(b<t||b>=r)){g.push(f.times[_]);for(let S=0;S<m;++S)y.push(f.values[_*m+S])}}g.length!==0&&(f.times=qn.convertArray(g,f.times.constructor),f.values=qn.convertArray(y,f.values.constructor),c.push(f))}l.tracks=c;let h=1/0;for(let d=0;d<l.tracks.length;++d)h>l.tracks[d].times[0]&&(h=l.tracks[d].times[0]);for(let d=0;d<l.tracks.length;++d)l.tracks[d].shift(-1*h);return l.resetDuration(),l},makeClipAdditive:function(i,e=0,t=i,r=30){r<=0&&(r=30);let n=t.tracks.length,l=e/r;for(let c=0;c<n;++c){let h=t.tracks[c],d=h.ValueTypeName;if(d==="bool"||d==="string")continue;let f=i.tracks.find(function(T){return T.name===h.name&&T.ValueTypeName===d});if(f===void 0)continue;let m=0,g=h.getValueSize();h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(m=g/3);let y=0,_=f.getValueSize();f.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(y=_/3);let b=h.times.length-1,S;if(l<=h.times[0]){let T=m,A=g-m;S=qn.arraySlice(h.values,T,A)}else if(l>=h.times[b]){let T=b*g+m,A=T+g-m;S=qn.arraySlice(h.values,T,A)}else{let T=h.createInterpolant(),A=m,P=g-m;T.evaluate(l),S=qn.arraySlice(T.resultBuffer,A,P)}d==="quaternion"&&new Zd().fromArray(S).normalize().conjugate().toArray(S);let E=f.times.length;for(let T=0;T<E;++T){let A=T*_+y;if(d==="quaternion")Zd.multiplyQuaternionsFlat(f.values,A,S,0,f.values,A);else{let P=_-y*2;for(let O=0;O<P;++O)f.values[A+O]-=S[O]}}}return i.blendMode=Yue,i}},Cp=class{constructor(e,t,r,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=n!==void 0?n:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,r=this._cachedIndex,n=t[r],l=t[r-1];e:{t:{let c;i:{r:if(!(e<n)){for(let h=r+2;;){if(n===void 0){if(e<l)break r;return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,e,l)}if(r===h)break;if(l=n,n=t[++r],e<n)break t}c=t.length;break i}if(!(e>=l)){let h=t[1];e<h&&(r=2,l=h);for(let d=r-2;;){if(l===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,n);if(r===d)break;if(n=l,l=t[--r-1],e>=l)break t}c=r,r=0;break i}break e}for(;r<c;){let h=r+c>>>1;e<t[h]?c=h:r=h+1}if(n=t[r],l=t[r-1],l===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,n);if(n===void 0)return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,l,e)}this._cachedIndex=r,this.intervalChanged_(r,l,n)}return this.interpolate_(r,l,e,n)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,l=e*n;for(let c=0;c!==n;++c)t[c]=r[l+c];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}};Cp.prototype.beforeStart_=Cp.prototype.copySampleValue_;Cp.prototype.afterEnd_=Cp.prototype.copySampleValue_;var Gce=class extends Cp{constructor(e,t,r,n){super(e,t,r,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:UH,endingEnd:UH}}intervalChanged_(e,t,r){let n=this.parameterPositions,l=e-2,c=e+1,h=n[l],d=n[c];if(h===void 0)switch(this.getSettings_().endingStart){case HH:l=e,h=2*t-r;break;case $H:l=n.length-2,h=t+n[l]-n[l+1];break;default:l=e,h=r}if(d===void 0)switch(this.getSettings_().endingEnd){case HH:c=e,d=2*r-t;break;case $H:c=1,d=r+n[1]-n[0];break;default:c=e-1,d=t}let f=(r-t)*.5,m=this.valueSize;this._weightPrev=f/(t-h),this._weightNext=f/(d-r),this._offsetPrev=l*m,this._offsetNext=c*m}interpolate_(e,t,r,n){let l=this.resultBuffer,c=this.sampleValues,h=this.valueSize,d=e*h,f=d-h,m=this._offsetPrev,g=this._offsetNext,y=this._weightPrev,_=this._weightNext,b=(r-t)/(n-t),S=b*b,E=S*b,T=-y*E+2*y*S-y*b,A=(1+y)*E+(-1.5-2*y)*S+(-.5+y)*b+1,P=(-1-_)*E+(1.5+_)*S+.5*b,O=_*E-_*S;for(let R=0;R!==h;++R)l[R]=T*c[m+R]+A*c[f+R]+P*c[d+R]+O*c[g+R];return l}},qce=class extends Cp{constructor(e,t,r,n){super(e,t,r,n)}interpolate_(e,t,r,n){let l=this.resultBuffer,c=this.sampleValues,h=this.valueSize,d=e*h,f=d-h,m=(r-t)/(n-t),g=1-m;for(let y=0;y!==h;++y)l[y]=c[f+y]*g+c[d+y]*m;return l}},Xce=class extends Cp{constructor(e,t,r,n){super(e,t,r,n)}interpolate_(e){return this.copySampleValue_(e-1)}},Cf=class{constructor(e,t,r,n){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=qn.convertArray(t,this.TimeBufferType),this.values=qn.convertArray(r,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}static toJSON(e){let t=e.constructor,r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:qn.convertArray(e.times,Array),values:qn.convertArray(e.values,Array)};let n=e.getInterpolation();n!==e.DefaultInterpolation&&(r.interpolation=n)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new Xce(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new qce(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Gce(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case NA:t=this.InterpolantFactoryMethodDiscrete;break;case UM:t=this.InterpolantFactoryMethodLinear;break;case jO:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){let r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return NA;case this.InterpolantFactoryMethodLinear:return UM;case this.InterpolantFactoryMethodSmooth:return jO}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let t=this.times;for(let r=0,n=t.length;r!==n;++r)t[r]+=e}return this}scale(e){if(e!==1){let t=this.times;for(let r=0,n=t.length;r!==n;++r)t[r]*=e}return this}trim(e,t){let r=this.times,n=r.length,l=0,c=n-1;for(;l!==n&&r[l]<e;)++l;for(;c!==-1&&r[c]>t;)--c;if(++c,l!==0||c!==n){l>=c&&(c=Math.max(c,1),l=c-1);let h=this.getValueSize();this.times=qn.arraySlice(r,l,c),this.values=qn.arraySlice(this.values,l*h,c*h)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let r=this.times,n=this.values,l=r.length;l===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let c=null;for(let h=0;h!==l;h++){let d=r[h];if(typeof d=="number"&&isNaN(d)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,h,d),e=!1;break}if(c!==null&&c>d){console.error("THREE.KeyframeTrack: Out of order keys.",this,h,d,c),e=!1;break}c=d}if(n!==void 0&&qn.isTypedArray(n))for(let h=0,d=n.length;h!==d;++h){let f=n[h];if(isNaN(f)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,h,f),e=!1;break}}return e}optimize(){let e=qn.arraySlice(this.times),t=qn.arraySlice(this.values),r=this.getValueSize(),n=this.getInterpolation()===jO,l=e.length-1,c=1;for(let h=1;h<l;++h){let d=!1,f=e[h],m=e[h+1];if(f!==m&&(h!==1||f!==e[0]))if(n)d=!0;else{let g=h*r,y=g-r,_=g+r;for(let b=0;b!==r;++b){let S=t[g+b];if(S!==t[y+b]||S!==t[_+b]){d=!0;break}}}if(d){if(h!==c){e[c]=e[h];let g=h*r,y=c*r;for(let _=0;_!==r;++_)t[y+_]=t[g+_]}++c}}if(l>0){e[c]=e[l];for(let h=l*r,d=c*r,f=0;f!==r;++f)t[d+f]=t[h+f];++c}return c!==e.length?(this.times=qn.arraySlice(e,0,c),this.values=qn.arraySlice(t,0,c*r)):(this.times=e,this.values=t),this}clone(){let e=qn.arraySlice(this.times,0),t=qn.arraySlice(this.values,0),r=this.constructor,n=new r(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}};Cf.prototype.TimeBufferType=Float32Array;Cf.prototype.ValueBufferType=Float32Array;Cf.prototype.DefaultInterpolation=UM;var yE=class extends Cf{};yE.prototype.ValueTypeName="bool";yE.prototype.ValueBufferType=Array;yE.prototype.DefaultInterpolation=NA;yE.prototype.InterpolantFactoryMethodLinear=void 0;yE.prototype.InterpolantFactoryMethodSmooth=void 0;var vq=class extends Cf{};vq.prototype.ValueTypeName="color";var FA=class extends Cf{};FA.prototype.ValueTypeName="number";var Zce=class extends Cp{constructor(e,t,r,n){super(e,t,r,n)}interpolate_(e,t,r,n){let l=this.resultBuffer,c=this.sampleValues,h=this.valueSize,d=(r-t)/(n-t),f=e*h;for(let m=f+h;f!==m;f+=4)Zd.slerpFlat(l,0,c,f-h,c,f,d);return l}},nw=class extends Cf{InterpolantFactoryMethodLinear(e){return new Zce(this.times,this.values,this.getValueSize(),e)}};nw.prototype.ValueTypeName="quaternion";nw.prototype.DefaultInterpolation=UM;nw.prototype.InterpolantFactoryMethodSmooth=void 0;var _E=class extends Cf{};_E.prototype.ValueTypeName="string";_E.prototype.ValueBufferType=Array;_E.prototype.DefaultInterpolation=NA;_E.prototype.InterpolantFactoryMethodLinear=void 0;_E.prototype.InterpolantFactoryMethodSmooth=void 0;var zA=class extends Cf{};zA.prototype.ValueTypeName="vector";var Jce=class{constructor(e,t=-1,r,n=Jue){this.name=e,this.tracks=r,this.duration=t,this.blendMode=n,this.uuid=Wd(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],r=e.tracks,n=1/(e.fps||1);for(let c=0,h=r.length;c!==h;++c)t.push(Kce(r[c]).scale(n));let l=new this(e.name,e.duration,t,e.blendMode);return l.uuid=e.uuid,l}static toJSON(e){let t=[],r=e.tracks,n={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let l=0,c=r.length;l!==c;++l)t.push(Cf.toJSON(r[l]));return n}static CreateFromMorphTargetSequence(e,t,r,n){let l=t.length,c=[];for(let h=0;h<l;h++){let d=[],f=[];d.push((h+l-1)%l,h,(h+1)%l),f.push(0,1,0);let m=qn.getKeyframeOrder(d);d=qn.sortedArray(d,1,m),f=qn.sortedArray(f,1,m),!n&&d[0]===0&&(d.push(l),f.push(f[0])),c.push(new FA(".morphTargetInfluences["+t[h].name+"]",d,f).scale(1/r))}return new this(e,-1,c)}static findByName(e,t){let r=e;if(!Array.isArray(e)){let n=e;r=n.geometry&&n.geometry.animations||n.animations}for(let n=0;n<r.length;n++)if(r[n].name===t)return r[n];return null}static CreateClipsFromMorphTargetSequences(e,t,r){let n={},l=/^([\w-]*?)([\d]+)$/;for(let h=0,d=e.length;h<d;h++){let f=e[h],m=f.name.match(l);if(m&&m.length>1){let g=m[1],y=n[g];y||(n[g]=y=[]),y.push(f)}}let c=[];for(let h in n)c.push(this.CreateFromMorphTargetSequence(h,n[h],t,r));return c}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let r=function(m,g,y,_,b){if(y.length!==0){let S=[],E=[];qn.flattenJSON(y,S,E,_),S.length!==0&&b.push(new m(g,S,E))}},n=[],l=e.name||"default",c=e.fps||30,h=e.blendMode,d=e.length||-1,f=e.hierarchy||[];for(let m=0;m<f.length;m++){let g=f[m].keys;if(!(!g||g.length===0))if(g[0].morphTargets){let y={},_;for(_=0;_<g.length;_++)if(g[_].morphTargets)for(let b=0;b<g[_].morphTargets.length;b++)y[g[_].morphTargets[b]]=-1;for(let b in y){let S=[],E=[];for(let T=0;T!==g[_].morphTargets.length;++T){let A=g[_];S.push(A.time),E.push(A.morphTarget===b?1:0)}n.push(new FA(".morphTargetInfluence["+b+"]",S,E))}d=y.length*c}else{let y=".bones["+t[m].name+"]";r(zA,y+".position",g,"pos",n),r(nw,y+".quaternion",g,"rot",n),r(zA,y+".scale",g,"scl",n)}}return n.length===0?null:new this(l,d,n,h)}resetDuration(){let e=this.tracks,t=0;for(let r=0,n=e.length;r!==n;++r){let l=this.tracks[r];t=Math.max(t,l.times[l.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function Yce(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return FA;case"vector":case"vector2":case"vector3":case"vector4":return zA;case"color":return vq;case"quaternion":return nw;case"bool":case"boolean":return yE;case"string":return _E}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}function Kce(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let e=Yce(i.type);if(i.times===void 0){let t=[],r=[];qn.flattenJSON(i.keys,t,r,"value"),i.times=t,i.values=r}return e.parse!==void 0?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}var HM={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(this.files[i]=e)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}},Qce=class{constructor(i,e,t){let r=this,n=!1,l=0,c=0,h,d=[];this.onStart=void 0,this.onLoad=i,this.onProgress=e,this.onError=t,this.itemStart=function(f){c++,n===!1&&r.onStart!==void 0&&r.onStart(f,l,c),n=!0},this.itemEnd=function(f){l++,r.onProgress!==void 0&&r.onProgress(f,l,c),l===c&&(n=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(f){r.onError!==void 0&&r.onError(f)},this.resolveURL=function(f){return h?h(f):f},this.setURLModifier=function(f){return h=f,this},this.addHandler=function(f,m){return d.push(f,m),this},this.removeHandler=function(f){let m=d.indexOf(f);return m!==-1&&d.splice(m,2),this},this.getHandler=function(f){for(let m=0,g=d.length;m<g;m+=2){let y=d[m],_=d[m+1];if(y.global&&(y.lastIndex=0),y.test(f))return _}return null}}},ehe=new Qce,AC=class{constructor(e){this.manager=e!==void 0?e:ehe,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){let r=this;return new Promise(function(n,l){r.load(e,n,t,l)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}},Gf={},yq=class extends AC{constructor(e){super(e)}load(e,t,r,n){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let l=HM.get(e);if(l!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(l),this.manager.itemEnd(e)},0),l;if(Gf[e]!==void 0){Gf[e].push({onLoad:t,onProgress:r,onError:n});return}Gf[e]=[],Gf[e].push({onLoad:t,onProgress:r,onError:n});let c=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),h=this.mimeType,d=this.responseType;fetch(c).then(f=>{if(f.status===200||f.status===0){if(f.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||f.body===void 0||f.body.getReader===void 0)return f;let m=Gf[e],g=f.body.getReader(),y=f.headers.get("Content-Length"),_=y?parseInt(y):0,b=_!==0,S=0,E=new ReadableStream({start(T){A();function A(){g.read().then(({done:P,value:O})=>{if(P)T.close();else{S+=O.byteLength;let R=new ProgressEvent("progress",{lengthComputable:b,loaded:S,total:_});for(let D=0,L=m.length;D<L;D++){let N=m[D];N.onProgress&&N.onProgress(R)}T.enqueue(O),A()}})}}});return new Response(E)}else throw Error(`fetch for "${f.url}" responded with ${f.status}: ${f.statusText}`)}).then(f=>{switch(d){case"arraybuffer":return f.arrayBuffer();case"blob":return f.blob();case"document":return f.text().then(m=>new DOMParser().parseFromString(m,h));case"json":return f.json();default:if(h===void 0)return f.text();{let m=/charset="?([^;"\s]*)"?/i.exec(h),g=m&&m[1]?m[1].toLowerCase():void 0,y=new TextDecoder(g);return f.arrayBuffer().then(_=>y.decode(_))}}}).then(f=>{HM.add(e,f);let m=Gf[e];delete Gf[e];for(let g=0,y=m.length;g<y;g++){let _=m[g];_.onLoad&&_.onLoad(f)}}).catch(f=>{let m=Gf[e];if(m===void 0)throw this.manager.itemError(e),f;delete Gf[e];for(let g=0,y=m.length;g<y;g++){let _=m[g];_.onError&&_.onError(f)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}},the=class extends AC{constructor(e){super(e)}load(e,t,r,n){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let l=this,c=HM.get(e);if(c!==void 0)return l.manager.itemStart(e),setTimeout(function(){t&&t(c),l.manager.itemEnd(e)},0),c;let h=mF("img");function d(){m(),HM.add(e,this),t&&t(this),l.manager.itemEnd(e)}function f(g){m(),n&&n(g),l.manager.itemError(e),l.manager.itemEnd(e)}function m(){h.removeEventListener("load",d,!1),h.removeEventListener("error",f,!1)}return h.addEventListener("load",d,!1),h.addEventListener("error",f,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(h.crossOrigin=this.crossOrigin),l.manager.itemStart(e),h.src=e,h}},ihe=class extends AC{constructor(i){super(i)}load(i,e,t,r){let n=new Ap,l=new the(this.manager);return l.setCrossOrigin(this.crossOrigin),l.setPath(this.path),l.load(i,function(c){n.image=c,n.needsUpdate=!0,e!==void 0&&e(n)},t,r),n}},sL=class extends ka{constructor(e,t=1){super(),this.type="Light",this.color=new Ar(e),this.intensity=t}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}};sL.prototype.isLight=!0;var m$=new Yr,g$=new Qe,v$=new Qe,pB=class{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new $n(512,512),this.map=null,this.mapPass=null,this.matrix=new Yr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new $ce,this._frameExtents=new $n(1,1),this._viewportCount=1,this._viewports=[new Qu(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,r=this.matrix;g$.setFromMatrixPosition(e.matrixWorld),t.position.copy(g$),v$.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(v$),t.updateMatrixWorld(),m$.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(m$),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(t.projectionMatrix),r.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},_q=class extends pB{constructor(){super(new iL(50,1,.5,500)),this.focus=1}updateMatrices(i){let e=this.camera,t=kA*2*i.angle*this.focus,r=this.mapSize.width/this.mapSize.height,n=i.distance||e.far;(t!==e.fov||r!==e.aspect||n!==e.far)&&(e.fov=t,e.aspect=r,e.far=n,e.updateProjectionMatrix()),super.updateMatrices(i)}copy(i){return super.copy(i),this.focus=i.focus,this}};_q.prototype.isSpotLightShadow=!0;var xq=class extends sL{constructor(e,t,r=0,n=Math.PI/3,l=0,c=1){super(e,t),this.type="SpotLight",this.position.copy(ka.DefaultUp),this.updateMatrix(),this.target=new ka,this.distance=r,this.angle=n,this.penumbra=l,this.decay=c,this.shadow=new _q}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}};xq.prototype.isSpotLight=!0;var y$=new Yr,KE=new Qe,mN=new Qe,bq=class extends pB{constructor(){super(new iL(90,1,.5,500)),this._frameExtents=new $n(4,2),this._viewportCount=6,this._viewports=[new Qu(2,1,1,1),new Qu(0,1,1,1),new Qu(3,1,1,1),new Qu(1,1,1,1),new Qu(3,0,1,1),new Qu(1,0,1,1)],this._cubeDirections=[new Qe(1,0,0),new Qe(-1,0,0),new Qe(0,0,1),new Qe(0,0,-1),new Qe(0,1,0),new Qe(0,-1,0)],this._cubeUps=[new Qe(0,1,0),new Qe(0,1,0),new Qe(0,1,0),new Qe(0,1,0),new Qe(0,0,1),new Qe(0,0,-1)]}updateMatrices(i,e=0){let t=this.camera,r=this.matrix,n=i.distance||t.far;n!==t.far&&(t.far=n,t.updateProjectionMatrix()),KE.setFromMatrixPosition(i.matrixWorld),t.position.copy(KE),mN.copy(t.position),mN.add(this._cubeDirections[e]),t.up.copy(this._cubeUps[e]),t.lookAt(mN),t.updateMatrixWorld(),r.makeTranslation(-KE.x,-KE.y,-KE.z),y$.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(y$)}};bq.prototype.isPointLightShadow=!0;var wq=class extends sL{constructor(e,t,r=0,n=1){super(e,t),this.type="PointLight",this.distance=r,this.decay=n,this.shadow=new bq}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}};wq.prototype.isPointLight=!0;var Sq=class extends pB{constructor(){super(new hB(-5,5,5,-5,.5,500))}};Sq.prototype.isDirectionalLightShadow=!0;var Mq=class extends sL{constructor(e,t){super(e,t),this.type="DirectionalLight",this.position.copy(ka.DefaultUp),this.updateMatrix(),this.target=new ka,this.shadow=new Sq}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}};Mq.prototype.isDirectionalLight=!0;var yF=class{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let r=0,n=e.length;r<n;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){let t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}},Eq=class extends AC{constructor(e){super(e),typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,r,n){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let l=this,c=HM.get(e);if(c!==void 0)return l.manager.itemStart(e),setTimeout(function(){t&&t(c),l.manager.itemEnd(e)},0),c;let h={};h.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",h.headers=this.requestHeader,fetch(e,h).then(function(d){return d.blob()}).then(function(d){return createImageBitmap(d,Object.assign(l.options,{colorSpaceConversion:"none"}))}).then(function(d){HM.add(e,d),t&&t(d),l.manager.itemEnd(e)}).catch(function(d){n&&n(d),l.manager.itemError(e),l.manager.itemEnd(e)}),l.manager.itemStart(e)}};Eq.prototype.isImageBitmapLoader=!0;var mB="\\[\\]\\.:\\/",rhe=new RegExp("["+mB+"]","g"),gB="[^"+mB+"]",nhe="[^"+mB.replace("\\.","")+"]",she=/((?:WC+[\/:])*)/.source.replace("WC",gB),ahe=/(WCOD+)?/.source.replace("WCOD",nhe),ohe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",gB),lhe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",gB),uhe=new RegExp("^"+she+ahe+ohe+lhe+"$"),che=["material","materials","bones"],hhe=class{constructor(i,e,t){let r=t||xn.parseTrackName(e);this._targetGroup=i,this._bindings=i.subscribe_(e,r)}getValue(i,e){this.bind();let t=this._targetGroup.nCachedObjects_,r=this._bindings[t];r!==void 0&&r.getValue(i,e)}setValue(i,e){let t=this._bindings;for(let r=this._targetGroup.nCachedObjects_,n=t.length;r!==n;++r)t[r].setValue(i,e)}bind(){let i=this._bindings;for(let e=this._targetGroup.nCachedObjects_,t=i.length;e!==t;++e)i[e].bind()}unbind(){let i=this._bindings;for(let e=this._targetGroup.nCachedObjects_,t=i.length;e!==t;++e)i[e].unbind()}},xn=class{constructor(e,t,r){this.path=t,this.parsedPath=r||xn.parseTrackName(t),this.node=xn.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new xn.Composite(e,t,r):new xn(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(rhe,"")}static parseTrackName(e){let t=uhe.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);let r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=r.nodeName&&r.nodeName.lastIndexOf(".");if(n!==void 0&&n!==-1){let l=r.nodeName.substring(n+1);che.indexOf(l)!==-1&&(r.nodeName=r.nodeName.substring(0,n),r.objectName=l)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){let r=e.skeleton.getBoneByName(t);if(r!==void 0)return r}if(e.children){let r=function(l){for(let c=0;c<l.length;c++){let h=l[c];if(h.name===t||h.uuid===t)return h;let d=r(h.children);if(d)return d}return null},n=r(e.children);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){let r=this.resolvedProperty;for(let n=0,l=r.length;n!==l;++n)e[t++]=r[n]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){let r=this.resolvedProperty;for(let n=0,l=r.length;n!==l;++n)r[n]=e[t++]}_setValue_array_setNeedsUpdate(e,t){let r=this.resolvedProperty;for(let n=0,l=r.length;n!==l;++n)r[n]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){let r=this.resolvedProperty;for(let n=0,l=r.length;n!==l;++n)r[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node,t=this.parsedPath,r=t.objectName,n=t.propertyName,l=t.propertyIndex;if(e||(e=xn.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(r){let f=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let m=0;m<e.length;m++)if(e[m].name===f){f=m;break}break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(f!==void 0){if(e[f]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[f]}}let c=e[n];if(c===void 0){let f=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+f+"."+n+" but it wasn't found.",e);return}let h=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?h=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(h=this.Versioning.MatrixWorldNeedsUpdate);let d=this.BindingType.Direct;if(l!==void 0){if(n==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[l]!==void 0&&(l=e.morphTargetDictionary[l])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}d=this.BindingType.ArrayElement,this.resolvedProperty=c,this.propertyIndex=l}else c.fromArray!==void 0&&c.toArray!==void 0?(d=this.BindingType.HasFromToArray,this.resolvedProperty=c):Array.isArray(c)?(d=this.BindingType.EntireArray,this.resolvedProperty=c):this.propertyName=n;this.getValue=this.GetterByBindingType[d],this.setValue=this.SetterByBindingTypeAndVersioning[d][h]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};xn.Composite=hhe;xn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};xn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};xn.prototype.GetterByBindingType=[xn.prototype._getValue_direct,xn.prototype._getValue_array,xn.prototype._getValue_arrayElement,xn.prototype._getValue_toArray];xn.prototype.SetterByBindingTypeAndVersioning=[[xn.prototype._setValue_direct,xn.prototype._setValue_direct_setNeedsUpdate,xn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[xn.prototype._setValue_array,xn.prototype._setValue_array_setNeedsUpdate,xn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[xn.prototype._setValue_arrayElement,xn.prototype._setValue_arrayElement_setNeedsUpdate,xn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[xn.prototype._setValue_fromArray,xn.prototype._setValue_fromArray_setNeedsUpdate,xn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:j7}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=j7);function _$(i,e){if(e===Z8)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),i;if(e===L6||e===_re){let t=i.getIndex();if(t===null){let c=[],h=i.getAttribute("position");if(h!==void 0){for(let d=0;d<h.count;d++)c.push(d);i.setIndex(c),t=i.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i}let r=t.count-2,n=[];if(e===L6)for(let c=1;c<=r;c++)n.push(t.getX(0)),n.push(t.getX(c)),n.push(t.getX(c+1));else for(let c=0;c<r;c++)c%2===0?(n.push(t.getX(c)),n.push(t.getX(c+1)),n.push(t.getX(c+2))):(n.push(t.getX(c+2)),n.push(t.getX(c+1)),n.push(t.getX(c)));n.length/3!==r&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let l=i.clone();return l.setIndex(n),l.clearGroups(),l}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),i}var dhe=class extends AC{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new vhe(t)}),this.register(function(t){return new Mhe(t)}),this.register(function(t){return new Ehe(t)}),this.register(function(t){return new The(t)}),this.register(function(t){return new _he(t)}),this.register(function(t){return new xhe(t)}),this.register(function(t){return new bhe(t)}),this.register(function(t){return new whe(t)}),this.register(function(t){return new ghe(t)}),this.register(function(t){return new She(t)}),this.register(function(t){return new yhe(t)}),this.register(function(t){return new phe(t)}),this.register(function(t){return new Ahe(t)}),this.register(function(t){return new Che(t)})}load(e,t,r,n){let l=this,c;this.resourcePath!==""?c=this.resourcePath:this.path!==""?c=this.path:c=yF.extractUrlBase(e),this.manager.itemStart(e);let h=function(f){n?n(f):console.error(f),l.manager.itemError(e),l.manager.itemEnd(e)},d=new yq(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(e,function(f){try{l.parse(f,c,function(m){t(m),l.manager.itemEnd(e)},h)}catch(m){h(m)}},r,h)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,r,n){let l,c={},h={},d=new TextDecoder;if(typeof e=="string")l=JSON.parse(e);else if(e instanceof ArrayBuffer)if(d.decode(new Uint8Array(e,0,4))===Tq){try{c[Wr.KHR_BINARY_GLTF]=new Phe(e)}catch(m){n&&n(m);return}l=JSON.parse(c[Wr.KHR_BINARY_GLTF].content)}else l=JSON.parse(d.decode(e));else l=e;if(l.asset===void 0||l.asset.version[0]<2){n&&n(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}let f=new $he(l,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});f.fileLoader.setRequestHeader(this.requestHeader);for(let m=0;m<this.pluginCallbacks.length;m++){let g=this.pluginCallbacks[m](f);h[g.name]=g,c[g.name]=!0}if(l.extensionsUsed)for(let m=0;m<l.extensionsUsed.length;++m){let g=l.extensionsUsed[m],y=l.extensionsRequired||[];switch(g){case Wr.KHR_MATERIALS_UNLIT:c[g]=new mhe;break;case Wr.KHR_DRACO_MESH_COMPRESSION:c[g]=new Rhe(l,this.dracoLoader);break;case Wr.KHR_TEXTURE_TRANSFORM:c[g]=new Ihe;break;case Wr.KHR_MESH_QUANTIZATION:c[g]=new Lhe;break;default:y.indexOf(g)>=0&&h[g]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+g+'".')}}f.setExtensions(c),f.setPlugins(h),f.parse(r,n)}parseAsync(e,t){let r=this;return new Promise(function(n,l){r.parse(e,t,n,l)})}};function fhe(){let i={};return{get:function(e){return i[e]},add:function(e,t){i[e]=t},remove:function(e){delete i[e]},removeAll:function(){i={}}}}var Wr={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"},phe=class{constructor(i){this.parser=i,this.name=Wr.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){let i=this.parser,e=this.parser.json.nodes||[];for(let t=0,r=e.length;t<r;t++){let n=e[t];n.extensions&&n.extensions[this.name]&&n.extensions[this.name].light!==void 0&&i._addNodeRef(this.cache,n.extensions[this.name].light)}}_loadLight(i){let e=this.parser,t="light:"+i,r=e.cache.get(t);if(r)return r;let n=e.json,l=((n.extensions&&n.extensions[this.name]||{}).lights||[])[i],c,h=new Ar(16777215);l.color!==void 0&&h.fromArray(l.color);let d=l.range!==void 0?l.range:0;switch(l.type){case"directional":c=new Mq(h),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new wq(h),c.distance=d;break;case"spot":c=new xq(h),c.distance=d,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,_m(c,l),l.intensity!==void 0&&(c.intensity=l.intensity),c.name=e.createUniqueName(l.name||"light_"+i),r=Promise.resolve(c),e.cache.add(t,r),r}getDependency(i,e){if(i==="light")return this._loadLight(e)}createNodeAttachment(i){let e=this,t=this.parser,r=t.json.nodes[i],n=(r.extensions&&r.extensions[this.name]||{}).light;return n===void 0?null:this._loadLight(n).then(function(l){return t._getNodeRef(e.cache,n,l)})}},mhe=class{constructor(){this.name=Wr.KHR_MATERIALS_UNLIT}getMaterialType(){return pp}extendParams(i,e,t){let r=[];i.color=new Ar(1,1,1),i.opacity=1;let n=e.pbrMetallicRoughness;if(n){if(Array.isArray(n.baseColorFactor)){let l=n.baseColorFactor;i.color.fromArray(l),i.opacity=l[3]}n.baseColorTexture!==void 0&&r.push(t.assignTexture(i,"map",n.baseColorTexture,DA))}return Promise.all(r)}},ghe=class{constructor(i){this.parser=i,this.name=Wr.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(i,e){let t=this.parser.json.materials[i];if(!t.extensions||!t.extensions[this.name])return Promise.resolve();let r=t.extensions[this.name].emissiveStrength;return r!==void 0&&(e.emissiveIntensity=r),Promise.resolve()}},vhe=class{constructor(i){this.parser=i,this.name=Wr.KHR_MATERIALS_CLEARCOAT}getMaterialType(i){let e=this.parser.json.materials[i];return!e.extensions||!e.extensions[this.name]?null:zp}extendMaterialParams(i,e){let t=this.parser,r=t.json.materials[i];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let n=[],l=r.extensions[this.name];if(l.clearcoatFactor!==void 0&&(e.clearcoat=l.clearcoatFactor),l.clearcoatTexture!==void 0&&n.push(t.assignTexture(e,"clearcoatMap",l.clearcoatTexture)),l.clearcoatRoughnessFactor!==void 0&&(e.clearcoatRoughness=l.clearcoatRoughnessFactor),l.clearcoatRoughnessTexture!==void 0&&n.push(t.assignTexture(e,"clearcoatRoughnessMap",l.clearcoatRoughnessTexture)),l.clearcoatNormalTexture!==void 0&&(n.push(t.assignTexture(e,"clearcoatNormalMap",l.clearcoatNormalTexture)),l.clearcoatNormalTexture.scale!==void 0)){let c=l.clearcoatNormalTexture.scale;e.clearcoatNormalScale=new $n(c,c)}return Promise.all(n)}},yhe=class{constructor(i){this.parser=i,this.name=Wr.KHR_MATERIALS_IRIDESCENCE}getMaterialType(i){let e=this.parser.json.materials[i];return!e.extensions||!e.extensions[this.name]?null:zp}extendMaterialParams(i,e){let t=this.parser,r=t.json.materials[i];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let n=[],l=r.extensions[this.name];return l.iridescenceFactor!==void 0&&(e.iridescence=l.iridescenceFactor),l.iridescenceTexture!==void 0&&n.push(t.assignTexture(e,"iridescenceMap",l.iridescenceTexture)),l.iridescenceIor!==void 0&&(e.iridescenceIOR=l.iridescenceIor),e.iridescenceThicknessRange===void 0&&(e.iridescenceThicknessRange=[100,400]),l.iridescenceThicknessMinimum!==void 0&&(e.iridescenceThicknessRange[0]=l.iridescenceThicknessMinimum),l.iridescenceThicknessMaximum!==void 0&&(e.iridescenceThicknessRange[1]=l.iridescenceThicknessMaximum),l.iridescenceThicknessTexture!==void 0&&n.push(t.assignTexture(e,"iridescenceThicknessMap",l.iridescenceThicknessTexture)),Promise.all(n)}},_he=class{constructor(i){this.parser=i,this.name=Wr.KHR_MATERIALS_SHEEN}getMaterialType(i){let e=this.parser.json.materials[i];return!e.extensions||!e.extensions[this.name]?null:zp}extendMaterialParams(i,e){let t=this.parser,r=t.json.materials[i];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let n=[];e.sheenColor=new Ar(0,0,0),e.sheenRoughness=0,e.sheen=1;let l=r.extensions[this.name];return l.sheenColorFactor!==void 0&&e.sheenColor.fromArray(l.sheenColorFactor),l.sheenRoughnessFactor!==void 0&&(e.sheenRoughness=l.sheenRoughnessFactor),l.sheenColorTexture!==void 0&&n.push(t.assignTexture(e,"sheenColorMap",l.sheenColorTexture,DA)),l.sheenRoughnessTexture!==void 0&&n.push(t.assignTexture(e,"sheenRoughnessMap",l.sheenRoughnessTexture)),Promise.all(n)}},xhe=class{constructor(i){this.parser=i,this.name=Wr.KHR_MATERIALS_TRANSMISSION}getMaterialType(i){let e=this.parser.json.materials[i];return!e.extensions||!e.extensions[this.name]?null:zp}extendMaterialParams(i,e){let t=this.parser,r=t.json.materials[i];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let n=[],l=r.extensions[this.name];return l.transmissionFactor!==void 0&&(e.transmission=l.transmissionFactor),l.transmissionTexture!==void 0&&n.push(t.assignTexture(e,"transmissionMap",l.transmissionTexture)),Promise.all(n)}},bhe=class{constructor(i){this.parser=i,this.name=Wr.KHR_MATERIALS_VOLUME}getMaterialType(i){let e=this.parser.json.materials[i];return!e.extensions||!e.extensions[this.name]?null:zp}extendMaterialParams(i,e){let t=this.parser,r=t.json.materials[i];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let n=[],l=r.extensions[this.name];e.thickness=l.thicknessFactor!==void 0?l.thicknessFactor:0,l.thicknessTexture!==void 0&&n.push(t.assignTexture(e,"thicknessMap",l.thicknessTexture)),e.attenuationDistance=l.attenuationDistance||1/0;let c=l.attenuationColor||[1,1,1];return e.attenuationColor=new Ar(c[0],c[1],c[2]),Promise.all(n)}},whe=class{constructor(i){this.parser=i,this.name=Wr.KHR_MATERIALS_IOR}getMaterialType(i){let e=this.parser.json.materials[i];return!e.extensions||!e.extensions[this.name]?null:zp}extendMaterialParams(i,e){let t=this.parser.json.materials[i];if(!t.extensions||!t.extensions[this.name])return Promise.resolve();let r=t.extensions[this.name];return e.ior=r.ior!==void 0?r.ior:1.5,Promise.resolve()}},She=class{constructor(i){this.parser=i,this.name=Wr.KHR_MATERIALS_SPECULAR}getMaterialType(i){let e=this.parser.json.materials[i];return!e.extensions||!e.extensions[this.name]?null:zp}extendMaterialParams(i,e){let t=this.parser,r=t.json.materials[i];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let n=[],l=r.extensions[this.name];e.specularIntensity=l.specularFactor!==void 0?l.specularFactor:1,l.specularTexture!==void 0&&n.push(t.assignTexture(e,"specularIntensityMap",l.specularTexture));let c=l.specularColorFactor||[1,1,1];return e.specularColor=new Ar(c[0],c[1],c[2]),l.specularColorTexture!==void 0&&n.push(t.assignTexture(e,"specularColorMap",l.specularColorTexture,DA)),Promise.all(n)}},Mhe=class{constructor(i){this.parser=i,this.name=Wr.KHR_TEXTURE_BASISU}loadTexture(i){let e=this.parser,t=e.json,r=t.textures[i];if(!r.extensions||!r.extensions[this.name])return null;let n=r.extensions[this.name],l=e.options.ktx2Loader;if(!l){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return e.loadTextureImage(i,n.source,l)}},Ehe=class{constructor(i){this.parser=i,this.name=Wr.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(i){let e=this.name,t=this.parser,r=t.json,n=r.textures[i];if(!n.extensions||!n.extensions[e])return null;let l=n.extensions[e],c=r.images[l.source],h=t.textureLoader;if(c.uri){let d=t.options.manager.getHandler(c.uri);d!==null&&(h=d)}return this.detectSupport().then(function(d){if(d)return t.loadTextureImage(i,l.source,h);if(r.extensionsRequired&&r.extensionsRequired.indexOf(e)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return t.loadTexture(i)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(i){let e=new Image;e.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",e.onload=e.onerror=function(){i(e.height===1)}})),this.isSupported}},The=class{constructor(i){this.parser=i,this.name=Wr.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(i){let e=this.name,t=this.parser,r=t.json,n=r.textures[i];if(!n.extensions||!n.extensions[e])return null;let l=n.extensions[e],c=r.images[l.source],h=t.textureLoader;if(c.uri){let d=t.options.manager.getHandler(c.uri);d!==null&&(h=d)}return this.detectSupport().then(function(d){if(d)return t.loadTextureImage(i,l.source,h);if(r.extensionsRequired&&r.extensionsRequired.indexOf(e)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return t.loadTexture(i)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(i){let e=new Image;e.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",e.onload=e.onerror=function(){i(e.height===1)}})),this.isSupported}},Ahe=class{constructor(i){this.name=Wr.EXT_MESHOPT_COMPRESSION,this.parser=i}loadBufferView(i){let e=this.parser.json,t=e.bufferViews[i];if(t.extensions&&t.extensions[this.name]){let r=t.extensions[this.name],n=this.parser.getDependency("buffer",r.buffer),l=this.parser.options.meshoptDecoder;if(!l||!l.supported){if(e.extensionsRequired&&e.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return n.then(function(c){let h=r.byteOffset||0,d=r.byteLength||0,f=r.count,m=r.byteStride,g=new Uint8Array(c,h,d);return l.decodeGltfBufferAsync?l.decodeGltfBufferAsync(f,m,g,r.mode,r.filter).then(function(y){return y.buffer}):l.ready.then(function(){let y=new ArrayBuffer(f*m);return l.decodeGltfBuffer(new Uint8Array(y),f,m,g,r.mode,r.filter),y})})}else return null}},Che=class{constructor(i){this.name=Wr.EXT_MESH_GPU_INSTANCING,this.parser=i}createNodeMesh(i){let e=this.parser.json,t=e.nodes[i];if(!t.extensions||!t.extensions[this.name]||t.mesh===void 0)return null;let r=e.meshes[t.mesh];for(let h of r.primitives)if(h.mode!==Xu.TRIANGLES&&h.mode!==Xu.TRIANGLE_STRIP&&h.mode!==Xu.TRIANGLE_FAN&&h.mode!==void 0)return null;let n=t.extensions[this.name].attributes,l=[],c={};for(let h in n)l.push(this.parser.getDependency("accessor",n[h]).then(d=>(c[h]=d,c[h])));return l.length<1?null:(l.push(this.parser.createNodeMesh(i)),Promise.all(l).then(h=>{let d=h.pop(),f=d.isGroup?d.children:[d],m=h[0].count,g=[];for(let y of f){let _=new Yr,b=new Qe,S=new Zd,E=new Qe(1,1,1),T=new sq(y.geometry,y.material,m);for(let A=0;A<m;A++)c.TRANSLATION&&b.fromBufferAttribute(c.TRANSLATION,A),c.ROTATION&&S.fromBufferAttribute(c.ROTATION,A),c.SCALE&&E.fromBufferAttribute(c.SCALE,A),T.setMatrixAt(A,_.compose(b,S,E));for(let A in c)A!=="TRANSLATION"&&A!=="ROTATION"&&A!=="SCALE"&&y.geometry.setAttribute(A,c[A]);ka.prototype.copy.call(T,y),this.parser.assignFinalMaterial(T),g.push(T)}return d.isGroup?(d.clear(),d.add(...g),d):g[0]}))}},Tq="glTF",QE=12,x$={JSON:1313821514,BIN:5130562},Phe=class{constructor(i){this.name=Wr.KHR_BINARY_GLTF,this.content=null,this.body=null;let e=new DataView(i,0,QE),t=new TextDecoder;if(this.header={magic:t.decode(new Uint8Array(i.slice(0,4))),version:e.getUint32(4,!0),length:e.getUint32(8,!0)},this.header.magic!==Tq)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");let r=this.header.length-QE,n=new DataView(i,QE),l=0;for(;l<r;){let c=n.getUint32(l,!0);l+=4;let h=n.getUint32(l,!0);if(l+=4,h===x$.JSON){let d=new Uint8Array(i,QE+l,c);this.content=t.decode(d)}else if(h===x$.BIN){let d=QE+l;this.body=i.slice(d,d+c)}l+=c}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}},Rhe=class{constructor(i,e){if(!e)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Wr.KHR_DRACO_MESH_COMPRESSION,this.json=i,this.dracoLoader=e,this.dracoLoader.preload()}decodePrimitive(i,e){let t=this.json,r=this.dracoLoader,n=i.extensions[this.name].bufferView,l=i.extensions[this.name].attributes,c={},h={},d={};for(let f in l){let m=_F[f]||f.toLowerCase();c[m]=l[f]}for(let f in i.attributes){let m=_F[f]||f.toLowerCase();if(l[f]!==void 0){let g=t.accessors[i.attributes[f]],y=gM[g.componentType];d[m]=y.name,h[m]=g.normalized===!0}}return e.getDependency("bufferView",n).then(function(f){return new Promise(function(m){r.decodeDracoFile(f,function(g){for(let y in g.attributes){let _=g.attributes[y],b=h[y];b!==void 0&&(_.normalized=b)}m(g)},c,d)})})}},Ihe=class{constructor(){this.name=Wr.KHR_TEXTURE_TRANSFORM}extendTexture(i,e){return e.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.offset===void 0&&e.rotation===void 0&&e.scale===void 0||(i=i.clone(),e.offset!==void 0&&i.offset.fromArray(e.offset),e.rotation!==void 0&&(i.rotation=e.rotation),e.scale!==void 0&&i.repeat.fromArray(e.scale),i.needsUpdate=!0),i}},Lhe=class{constructor(){this.name=Wr.KHR_MESH_QUANTIZATION}},Aq=class extends Cp{constructor(e,t,r,n){super(e,t,r,n)}copySampleValue_(e){let t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,l=e*n*3+n;for(let c=0;c!==n;c++)t[c]=r[l+c];return t}interpolate_(e,t,r,n){let l=this.resultBuffer,c=this.sampleValues,h=this.valueSize,d=h*2,f=h*3,m=n-t,g=(r-t)/m,y=g*g,_=y*g,b=e*f,S=b-f,E=-2*_+3*y,T=_-y,A=1-E,P=T-y+g;for(let O=0;O!==h;O++){let R=c[S+O+h],D=c[S+O+d]*m,L=c[b+O+h],N=c[b+O]*m;l[O]=A*R+P*D+E*L+T*N}return l}},Ohe=new Zd,Nhe=class extends Aq{interpolate_(i,e,t,r){let n=super.interpolate_(i,e,t,r);return Ohe.fromArray(n).normalize().toArray(n),n}},Xu={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},gM={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},b$={9728:fF,9729:nB,9984:jue,9985:que,9986:Gue,9987:sB},w$={33071:DT,33648:dF,10497:OA},gN={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},_F={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},im={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Dhe={CUBICSPLINE:void 0,LINEAR:UM,STEP:NA},vN={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function khe(i){return i.DefaultMaterial===void 0&&(i.DefaultMaterial=new TC({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:hF})),i.DefaultMaterial}function eT(i,e,t){for(let r in t.extensions)i[r]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[r]=t.extensions[r])}function _m(i,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(i.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Fhe(i,e,t){let r=!1,n=!1,l=!1;for(let f=0,m=e.length;f<m;f++){let g=e[f];if(g.POSITION!==void 0&&(r=!0),g.NORMAL!==void 0&&(n=!0),g.COLOR_0!==void 0&&(l=!0),r&&n&&l)break}if(!r&&!n&&!l)return Promise.resolve(i);let c=[],h=[],d=[];for(let f=0,m=e.length;f<m;f++){let g=e[f];if(r){let y=g.POSITION!==void 0?t.getDependency("accessor",g.POSITION):i.attributes.position;c.push(y)}if(n){let y=g.NORMAL!==void 0?t.getDependency("accessor",g.NORMAL):i.attributes.normal;h.push(y)}if(l){let y=g.COLOR_0!==void 0?t.getDependency("accessor",g.COLOR_0):i.attributes.color;d.push(y)}}return Promise.all([Promise.all(c),Promise.all(h),Promise.all(d)]).then(function(f){let m=f[0],g=f[1],y=f[2];return r&&(i.morphAttributes.position=m),n&&(i.morphAttributes.normal=g),l&&(i.morphAttributes.color=y),i.morphTargetsRelative=!0,i})}function zhe(i,e){if(i.updateMorphTargets(),e.weights!==void 0)for(let t=0,r=e.weights.length;t<r;t++)i.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){let t=e.extras.targetNames;if(i.morphTargetInfluences.length===t.length){i.morphTargetDictionary={};for(let r=0,n=t.length;r<n;r++)i.morphTargetDictionary[t[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Bhe(i){let e=i.extensions&&i.extensions[Wr.KHR_DRACO_MESH_COMPRESSION],t;return e?t="draco:"+e.bufferView+":"+e.indices+":"+S$(e.attributes):t=i.indices+":"+S$(i.attributes)+":"+i.mode,t}function S$(i){let e="",t=Object.keys(i).sort();for(let r=0,n=t.length;r<n;r++)e+=t[r]+":"+i[t[r]]+";";return e}function xF(i){switch(i){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Uhe(i){return i.search(/\.jpe?g($|\?)/i)>0||i.search(/^data\:image\/jpeg/)===0?"image/jpeg":i.search(/\.webp($|\?)/i)>0||i.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}var Hhe=new Yr,$he=class{constructor(i={},e={}){this.json=i,this.extensions={},this.plugins={},this.options=e,this.cache=new fhe,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let t=!1,r=!1,n=-1;typeof navigator<"u"&&(t=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,r=navigator.userAgent.indexOf("Firefox")>-1,n=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||t||r&&n<98?this.textureLoader=new ihe(this.options.manager):this.textureLoader=new Eq(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new yq(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(i){this.extensions=i}setPlugins(i){this.plugins=i}parse(i,e){let t=this,r=this.json,n=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(l){return l._markDefs&&l._markDefs()}),Promise.all(this._invokeAll(function(l){return l.beforeRoot&&l.beforeRoot()})).then(function(){return Promise.all([t.getDependencies("scene"),t.getDependencies("animation"),t.getDependencies("camera")])}).then(function(l){let c={scene:l[0][r.scene||0],scenes:l[0],animations:l[1],cameras:l[2],asset:r.asset,parser:t,userData:{}};eT(n,c,r),_m(c,r),Promise.all(t._invokeAll(function(h){return h.afterRoot&&h.afterRoot(c)})).then(function(){i(c)})}).catch(e)}_markDefs(){let i=this.json.nodes||[],e=this.json.skins||[],t=this.json.meshes||[];for(let r=0,n=e.length;r<n;r++){let l=e[r].joints;for(let c=0,h=l.length;c<h;c++)i[l[c]].isBone=!0}for(let r=0,n=i.length;r<n;r++){let l=i[r];l.mesh!==void 0&&(this._addNodeRef(this.meshCache,l.mesh),l.skin!==void 0&&(t[l.mesh].isSkinnedMesh=!0)),l.camera!==void 0&&this._addNodeRef(this.cameraCache,l.camera)}}_addNodeRef(i,e){e!==void 0&&(i.refs[e]===void 0&&(i.refs[e]=i.uses[e]=0),i.refs[e]++)}_getNodeRef(i,e,t){if(i.refs[e]<=1)return t;let r=t.clone(),n=(l,c)=>{let h=this.associations.get(l);h!=null&&this.associations.set(c,h);for(let[d,f]of l.children.entries())n(f,c.children[d])};return n(t,r),r.name+="_instance_"+i.uses[e]++,r}_invokeOne(i){let e=Object.values(this.plugins);e.push(this);for(let t=0;t<e.length;t++){let r=i(e[t]);if(r)return r}return null}_invokeAll(i){let e=Object.values(this.plugins);e.unshift(this);let t=[];for(let r=0;r<e.length;r++){let n=i(e[r]);n&&t.push(n)}return t}getDependency(i,e){let t=i+":"+e,r=this.cache.get(t);if(!r){switch(i){case"scene":r=this.loadScene(e);break;case"node":r=this._invokeOne(function(n){return n.loadNode&&n.loadNode(e)});break;case"mesh":r=this._invokeOne(function(n){return n.loadMesh&&n.loadMesh(e)});break;case"accessor":r=this.loadAccessor(e);break;case"bufferView":r=this._invokeOne(function(n){return n.loadBufferView&&n.loadBufferView(e)});break;case"buffer":r=this.loadBuffer(e);break;case"material":r=this._invokeOne(function(n){return n.loadMaterial&&n.loadMaterial(e)});break;case"texture":r=this._invokeOne(function(n){return n.loadTexture&&n.loadTexture(e)});break;case"skin":r=this.loadSkin(e);break;case"animation":r=this._invokeOne(function(n){return n.loadAnimation&&n.loadAnimation(e)});break;case"camera":r=this.loadCamera(e);break;default:if(r=this._invokeOne(function(n){return n!=this&&n.getDependency&&n.getDependency(i,e)}),!r)throw new Error("Unknown type: "+i);break}this.cache.add(t,r)}return r}getDependencies(i){let e=this.cache.get(i);if(!e){let t=this,r=this.json[i+(i==="mesh"?"es":"s")]||[];e=Promise.all(r.map(function(n,l){return t.getDependency(i,l)})),this.cache.add(i,e)}return e}loadBuffer(i){let e=this.json.buffers[i],t=this.fileLoader;if(e.type&&e.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+e.type+" buffer type is not supported.");if(e.uri===void 0&&i===0)return Promise.resolve(this.extensions[Wr.KHR_BINARY_GLTF].body);let r=this.options;return new Promise(function(n,l){t.load(yF.resolveURL(e.uri,r.path),n,void 0,function(){l(new Error('THREE.GLTFLoader: Failed to load buffer "'+e.uri+'".'))})})}loadBufferView(i){let e=this.json.bufferViews[i];return this.getDependency("buffer",e.buffer).then(function(t){let r=e.byteLength||0,n=e.byteOffset||0;return t.slice(n,n+r)})}loadAccessor(i){let e=this,t=this.json,r=this.json.accessors[i];if(r.bufferView===void 0&&r.sparse===void 0){let l=gN[r.type],c=gM[r.componentType],h=r.normalized===!0,d=new c(r.count*l);return Promise.resolve(new Du(d,l,h))}let n=[];return r.bufferView!==void 0?n.push(this.getDependency("bufferView",r.bufferView)):n.push(null),r.sparse!==void 0&&(n.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),n.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(n).then(function(l){let c=l[0],h=gN[r.type],d=gM[r.componentType],f=d.BYTES_PER_ELEMENT,m=f*h,g=r.byteOffset||0,y=r.bufferView!==void 0?t.bufferViews[r.bufferView].byteStride:void 0,_=r.normalized===!0,b,S;if(y&&y!==m){let E=Math.floor(g/y),T="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+E+":"+r.count,A=e.cache.get(T);A||(b=new d(c,E*y,r.count*y/f),A=new eq(b,y/f),e.cache.add(T,A)),S=new dB(A,h,g%y/f,_)}else c===null?b=new d(r.count*h):b=new d(c,g,r.count*h),S=new Du(b,h,_);if(r.sparse!==void 0){let E=gN.SCALAR,T=gM[r.sparse.indices.componentType],A=r.sparse.indices.byteOffset||0,P=r.sparse.values.byteOffset||0,O=new T(l[1],A,r.sparse.count*E),R=new d(l[2],P,r.sparse.count*h);c!==null&&(S=new Du(S.array.slice(),S.itemSize,S.normalized));for(let D=0,L=O.length;D<L;D++){let N=O[D];if(S.setX(N,R[D*h]),h>=2&&S.setY(N,R[D*h+1]),h>=3&&S.setZ(N,R[D*h+2]),h>=4&&S.setW(N,R[D*h+3]),h>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return S})}loadTexture(i){let e=this.json,t=this.options,r=e.textures[i].source,n=e.images[r],l=this.textureLoader;if(n.uri){let c=t.manager.getHandler(n.uri);c!==null&&(l=c)}return this.loadTextureImage(i,r,l)}loadTextureImage(i,e,t){let r=this,n=this.json,l=n.textures[i],c=n.images[e],h=(c.uri||c.bufferView)+":"+l.sampler;if(this.textureCache[h])return this.textureCache[h];let d=this.loadImageSource(e,t).then(function(f){f.flipY=!1,f.name=l.name||c.name||"",f.name===""&&typeof c.uri=="string"&&c.uri.startsWith("data:image/")===!1&&(f.name=c.uri);let m=(n.samplers||{})[l.sampler]||{};return f.magFilter=b$[m.magFilter]||nB,f.minFilter=b$[m.minFilter]||sB,f.wrapS=w$[m.wrapS]||OA,f.wrapT=w$[m.wrapT]||OA,r.associations.set(f,{textures:i}),f}).catch(function(){return null});return this.textureCache[h]=d,d}loadImageSource(i,e){let t=this,r=this.json,n=this.options;if(this.sourceCache[i]!==void 0)return this.sourceCache[i].then(m=>m.clone());let l=r.images[i],c=self.URL||self.webkitURL,h=l.uri||"",d=!1;if(l.bufferView!==void 0)h=t.getDependency("bufferView",l.bufferView).then(function(m){d=!0;let g=new Blob([m],{type:l.mimeType});return h=c.createObjectURL(g),h});else if(l.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+i+" is missing URI and bufferView");let f=Promise.resolve(h).then(function(m){return new Promise(function(g,y){let _=g;e.isImageBitmapLoader===!0&&(_=function(b){let S=new Ap(b);S.needsUpdate=!0,g(S)}),e.load(yF.resolveURL(m,n.path),_,void 0,y)})}).then(function(m){return d===!0&&c.revokeObjectURL(h),m.userData.mimeType=l.mimeType||Uhe(l.uri),m}).catch(function(m){throw console.error("THREE.GLTFLoader: Couldn't load texture",h),m});return this.sourceCache[i]=f,f}assignTexture(i,e,t,r){let n=this;return this.getDependency("texture",t.index).then(function(l){if(!l)return null;if(t.texCoord!==void 0&&t.texCoord!=0&&!(e==="aoMap"&&t.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+t.texCoord+" for texture "+e+" not yet supported."),n.extensions[Wr.KHR_TEXTURE_TRANSFORM]){let c=t.extensions!==void 0?t.extensions[Wr.KHR_TEXTURE_TRANSFORM]:void 0;if(c){let h=n.associations.get(l);l=n.extensions[Wr.KHR_TEXTURE_TRANSFORM].extendTexture(l,c),n.associations.set(l,h)}}return r!==void 0&&(l.encoding=r),i[e]=l,l})}assignFinalMaterial(i){let e=i.geometry,t=i.material,r=e.attributes.tangent===void 0,n=e.attributes.color!==void 0,l=e.attributes.normal===void 0;if(i.isPoints){let c="PointsMaterial:"+t.uuid,h=this.cache.get(c);h||(h=new nL,Cs.prototype.copy.call(h,t),h.color.copy(t.color),h.map=t.map,h.sizeAttenuation=!1,this.cache.add(c,h)),t=h}else if(i.isLine){let c="LineBasicMaterial:"+t.uuid,h=this.cache.get(c);h||(h=new EC,Cs.prototype.copy.call(h,t),h.color.copy(t.color),this.cache.add(c,h)),t=h}if(r||n||l){let c="ClonedMaterial:"+t.uuid+":";r&&(c+="derivative-tangents:"),n&&(c+="vertex-colors:"),l&&(c+="flat-shading:");let h=this.cache.get(c);h||(h=t.clone(),n&&(h.vertexColors=!0),l&&(h.flatShading=!0),r&&(h.normalScale&&(h.normalScale.y*=-1),h.clearcoatNormalScale&&(h.clearcoatNormalScale.y*=-1)),this.cache.add(c,h),this.associations.set(h,this.associations.get(t))),t=h}t.aoMap&&e.attributes.uv2===void 0&&e.attributes.uv!==void 0&&e.setAttribute("uv2",e.attributes.uv),i.material=t}getMaterialType(){return TC}loadMaterial(i){let e=this,t=this.json,r=this.extensions,n=t.materials[i],l,c={},h=n.extensions||{},d=[];if(h[Wr.KHR_MATERIALS_UNLIT]){let m=r[Wr.KHR_MATERIALS_UNLIT];l=m.getMaterialType(),d.push(m.extendParams(c,n,e))}else{let m=n.pbrMetallicRoughness||{};if(c.color=new Ar(1,1,1),c.opacity=1,Array.isArray(m.baseColorFactor)){let g=m.baseColorFactor;c.color.fromArray(g),c.opacity=g[3]}m.baseColorTexture!==void 0&&d.push(e.assignTexture(c,"map",m.baseColorTexture,DA)),c.metalness=m.metallicFactor!==void 0?m.metallicFactor:1,c.roughness=m.roughnessFactor!==void 0?m.roughnessFactor:1,m.metallicRoughnessTexture!==void 0&&(d.push(e.assignTexture(c,"metalnessMap",m.metallicRoughnessTexture)),d.push(e.assignTexture(c,"roughnessMap",m.metallicRoughnessTexture))),l=this._invokeOne(function(g){return g.getMaterialType&&g.getMaterialType(i)}),d.push(Promise.all(this._invokeAll(function(g){return g.extendMaterialParams&&g.extendMaterialParams(i,c)})))}n.doubleSided===!0&&(c.side=iB);let f=n.alphaMode||vN.OPAQUE;if(f===vN.BLEND?(c.transparent=!0,c.depthWrite=!1):(c.transparent=!1,f===vN.MASK&&(c.alphaTest=n.alphaCutoff!==void 0?n.alphaCutoff:.5)),n.normalTexture!==void 0&&l!==pp&&(d.push(e.assignTexture(c,"normalMap",n.normalTexture)),c.normalScale=new $n(1,1),n.normalTexture.scale!==void 0)){let m=n.normalTexture.scale;c.normalScale.set(m,m)}return n.occlusionTexture!==void 0&&l!==pp&&(d.push(e.assignTexture(c,"aoMap",n.occlusionTexture)),n.occlusionTexture.strength!==void 0&&(c.aoMapIntensity=n.occlusionTexture.strength)),n.emissiveFactor!==void 0&&l!==pp&&(c.emissive=new Ar().fromArray(n.emissiveFactor)),n.emissiveTexture!==void 0&&l!==pp&&d.push(e.assignTexture(c,"emissiveMap",n.emissiveTexture,DA)),Promise.all(d).then(function(){let m=new l(c);return n.name&&(m.name=n.name),_m(m,n),e.associations.set(m,{materials:i}),n.extensions&&eT(r,m,n),m})}createUniqueName(i){let e=xn.sanitizeNodeName(i||""),t=e;for(let r=1;this.nodeNamesUsed[t];++r)t=e+"_"+r;return this.nodeNamesUsed[t]=!0,t}loadGeometries(i){let e=this,t=this.extensions,r=this.primitiveCache;function n(c){return t[Wr.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(c,e).then(function(h){return M$(h,c,e)})}let l=[];for(let c=0,h=i.length;c<h;c++){let d=i[c],f=Bhe(d),m=r[f];if(m)l.push(m.promise);else{let g;d.extensions&&d.extensions[Wr.KHR_DRACO_MESH_COMPRESSION]?g=n(d):g=M$(new vE,d,e),r[f]={primitive:d,promise:g},l.push(g)}}return Promise.all(l)}loadMesh(i){let e=this,t=this.json,r=this.extensions,n=t.meshes[i],l=n.primitives,c=[];for(let h=0,d=l.length;h<d;h++){let f=l[h].material===void 0?khe(this.cache):this.getDependency("material",l[h].material);c.push(f)}return c.push(e.loadGeometries(l)),Promise.all(c).then(function(h){let d=h.slice(0,h.length-1),f=h[h.length-1],m=[];for(let y=0,_=f.length;y<_;y++){let b=f[y],S=l[y],E,T=d[y];if(S.mode===Xu.TRIANGLES||S.mode===Xu.TRIANGLE_STRIP||S.mode===Xu.TRIANGLE_FAN||S.mode===void 0)E=n.isSkinnedMesh===!0?new iq(b,T):new MC(b,T),E.isSkinnedMesh===!0&&E.normalizeSkinWeights(),S.mode===Xu.TRIANGLE_STRIP?E.geometry=_$(E.geometry,Kue):S.mode===Xu.TRIANGLE_FAN&&(E.geometry=_$(E.geometry,Que));else if(S.mode===Xu.LINES)E=new aq(b,T);else if(S.mode===Xu.LINE_STRIP)E=new rL(b,T);else if(S.mode===Xu.LINE_LOOP)E=new oq(b,T);else if(S.mode===Xu.POINTS)E=new lq(b,T);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+S.mode);Object.keys(E.geometry.morphAttributes).length>0&&zhe(E,n),E.name=e.createUniqueName(n.name||"mesh_"+i),_m(E,n),S.extensions&&eT(r,E,S),e.assignFinalMaterial(E),m.push(E)}for(let y=0,_=m.length;y<_;y++)e.associations.set(m[y],{meshes:i,primitives:y});if(m.length===1)return m[0];let g=new GP;e.associations.set(g,{meshes:i});for(let y=0,_=m.length;y<_;y++)g.add(m[y]);return g})}loadCamera(i){let e,t=this.json.cameras[i],r=t[t.type];if(!r){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return t.type==="perspective"?e=new iL(X7.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):t.type==="orthographic"&&(e=new hB(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),t.name&&(e.name=this.createUniqueName(t.name)),_m(e,t),Promise.resolve(e)}loadSkin(i){let e=this.json.skins[i],t=[];for(let r=0,n=e.joints.length;r<n;r++)t.push(this._loadNodeShallow(e.joints[r]));return e.inverseBindMatrices!==void 0?t.push(this.getDependency("accessor",e.inverseBindMatrices)):t.push(null),Promise.all(t).then(function(r){let n=r.pop(),l=r,c=[],h=[];for(let d=0,f=l.length;d<f;d++){let m=l[d];if(m){c.push(m);let g=new Yr;n!==null&&g.fromArray(n.array,d*16),h.push(g)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',e.joints[d])}return new nq(c,h)})}loadAnimation(i){let e=this.json.animations[i],t=[],r=[],n=[],l=[],c=[];for(let h=0,d=e.channels.length;h<d;h++){let f=e.channels[h],m=e.samplers[f.sampler],g=f.target,y=g.node,_=e.parameters!==void 0?e.parameters[m.input]:m.input,b=e.parameters!==void 0?e.parameters[m.output]:m.output;t.push(this.getDependency("node",y)),r.push(this.getDependency("accessor",_)),n.push(this.getDependency("accessor",b)),l.push(m),c.push(g)}return Promise.all([Promise.all(t),Promise.all(r),Promise.all(n),Promise.all(l),Promise.all(c)]).then(function(h){let d=h[0],f=h[1],m=h[2],g=h[3],y=h[4],_=[];for(let S=0,E=d.length;S<E;S++){let T=d[S],A=f[S],P=m[S],O=g[S],R=y[S];if(T===void 0)continue;T.updateMatrix();let D;switch(im[R.path]){case im.weights:D=FA;break;case im.rotation:D=nw;break;case im.position:case im.scale:default:D=zA;break}let L=T.name?T.name:T.uuid,N=O.interpolation!==void 0?Dhe[O.interpolation]:UM,U=[];im[R.path]===im.weights?T.traverse(function(z){z.morphTargetInfluences&&U.push(z.name?z.name:z.uuid)}):U.push(L);let F=P.array;if(P.normalized){let z=xF(F.constructor),G=new Float32Array(F.length);for(let J=0,Z=F.length;J<Z;J++)G[J]=F[J]*z;F=G}for(let z=0,G=U.length;z<G;z++){let J=new D(U[z]+"."+im[R.path],A.array,F,N);O.interpolation==="CUBICSPLINE"&&(J.createInterpolant=function(Z){let q=this instanceof nw?Nhe:Aq;return new q(this.times,this.values,this.getValueSize()/3,Z)},J.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),_.push(J)}}let b=e.name?e.name:"animation_"+i;return new Jce(b,void 0,_)})}createNodeMesh(i){let e=this.json,t=this,r=e.nodes[i];return r.mesh===void 0?null:t.getDependency("mesh",r.mesh).then(function(n){let l=t._getNodeRef(t.meshCache,r.mesh,n);return r.weights!==void 0&&l.traverse(function(c){if(c.isMesh)for(let h=0,d=r.weights.length;h<d;h++)c.morphTargetInfluences[h]=r.weights[h]}),l})}loadNode(i){let e=this.json,t=this,r=e.nodes[i],n=t._loadNodeShallow(i),l=[],c=r.children||[];for(let d=0,f=c.length;d<f;d++)l.push(t.getDependency("node",c[d]));let h=r.skin===void 0?Promise.resolve(null):t.getDependency("skin",r.skin);return Promise.all([n,Promise.all(l),h]).then(function(d){let f=d[0],m=d[1],g=d[2];g!==null&&f.traverse(function(y){!y.isSkinnedMesh||y.bind(g,Hhe)});for(let y=0,_=m.length;y<_;y++)f.add(m[y]);return f})}_loadNodeShallow(i){let e=this.json,t=this.extensions,r=this;if(this.nodeCache[i]!==void 0)return this.nodeCache[i];let n=e.nodes[i],l=n.name?r.createUniqueName(n.name):"",c=[],h=r._invokeOne(function(d){return d.createNodeMesh&&d.createNodeMesh(i)});return h&&c.push(h),n.camera!==void 0&&c.push(r.getDependency("camera",n.camera).then(function(d){return r._getNodeRef(r.cameraCache,n.camera,d)})),r._invokeAll(function(d){return d.createNodeAttachment&&d.createNodeAttachment(i)}).forEach(function(d){c.push(d)}),this.nodeCache[i]=Promise.all(c).then(function(d){let f;if(n.isBone===!0?f=new fB:d.length>1?f=new GP:d.length===1?f=d[0]:f=new ka,f!==d[0])for(let m=0,g=d.length;m<g;m++)f.add(d[m]);if(n.name&&(f.userData.name=n.name,f.name=l),_m(f,n),n.extensions&&eT(t,f,n),n.matrix!==void 0){let m=new Yr;m.fromArray(n.matrix),f.applyMatrix4(m)}else n.translation!==void 0&&f.position.fromArray(n.translation),n.rotation!==void 0&&f.quaternion.fromArray(n.rotation),n.scale!==void 0&&f.scale.fromArray(n.scale);return r.associations.has(f)||r.associations.set(f,{}),r.associations.get(f).nodes=i,f}),this.nodeCache[i]}loadScene(i){let e=this.extensions,t=this.json.scenes[i],r=this,n=new GP;t.name&&(n.name=r.createUniqueName(t.name)),_m(n,t),t.extensions&&eT(e,n,t);let l=t.nodes||[],c=[];for(let h=0,d=l.length;h<d;h++)c.push(r.getDependency("node",l[h]));return Promise.all(c).then(function(h){for(let f=0,m=h.length;f<m;f++)n.add(h[f]);let d=f=>{let m=new Map;for(let[g,y]of r.associations)(g instanceof Cs||g instanceof Ap)&&m.set(g,y);return f.traverse(g=>{let y=r.associations.get(g);y!=null&&m.set(g,y)}),m};return r.associations=d(n),n})}};function Vhe(i,e,t){let r=e.attributes,n=new xw;if(r.POSITION!==void 0){let h=t.json.accessors[r.POSITION],d=h.min,f=h.max;if(d!==void 0&&f!==void 0){if(n.set(new Qe(d[0],d[1],d[2]),new Qe(f[0],f[1],f[2])),h.normalized){let m=xF(gM[h.componentType]);n.min.multiplyScalar(m),n.max.multiplyScalar(m)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;let l=e.targets;if(l!==void 0){let h=new Qe,d=new Qe;for(let f=0,m=l.length;f<m;f++){let g=l[f];if(g.POSITION!==void 0){let y=t.json.accessors[g.POSITION],_=y.min,b=y.max;if(_!==void 0&&b!==void 0){if(d.setX(Math.max(Math.abs(_[0]),Math.abs(b[0]))),d.setY(Math.max(Math.abs(_[1]),Math.abs(b[1]))),d.setZ(Math.max(Math.abs(_[2]),Math.abs(b[2]))),y.normalized){let S=xF(gM[y.componentType]);d.multiplyScalar(S)}h.max(d)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}n.expandByVector(h)}i.boundingBox=n;let c=new gE;n.getCenter(c.center),c.radius=n.min.distanceTo(n.max)/2,i.boundingSphere=c}function M$(i,e,t){let r=e.attributes,n=[];function l(c,h){return t.getDependency("accessor",c).then(function(d){i.setAttribute(h,d)})}for(let c in r){let h=_F[c]||c.toLowerCase();h in i.attributes||n.push(l(r[c],h))}if(e.indices!==void 0&&!i.index){let c=t.getDependency("accessor",e.indices).then(function(h){i.setIndex(h)});n.push(c)}return _m(i,e),Vhe(i,e,t),Promise.all(n).then(function(){return e.targets!==void 0?Fhe(i,e.targets,t):i})}var Whe=class{parse(e,t,r={}){if(r=Object.assign({version:"1.4.1",author:null,textureDirectory:"",upAxis:"Y_UP",unitName:null,unitMeter:null},r),r.upAxis.match(/^[XYZ]_UP$/)===null)return console.error("ColladaExporter: Invalid upAxis: valid values are X_UP, Y_UP or Z_UP."),null;if(r.unitName!==null&&r.unitMeter===null)return console.error("ColladaExporter: unitMeter needs to be specified if unitName is specified."),null;if(r.unitMeter!==null&&r.unitName===null)return console.error("ColladaExporter: unitName needs to be specified if unitMeter is specified."),null;r.textureDirectory!==""&&(r.textureDirectory=`${r.textureDirectory}/`.replace(/\\/g,"/").replace(/\/+/g,"/"));let n=r.version;if(n!=="1.4.1"&&n!=="1.5.0")return console.warn(`ColladaExporter : Version ${n} not supported for export. Only 1.4.1 and 1.5.0.`),null;function l($){let H=/^<\//,X=/(\?>$)|(\/>$)/,re=/<[^>]+>[^<]*<\/[^<]+>/,ae=(pe,de)=>de>0?pe+ae(pe,de-1):"",he=0;return $.match(/(<[^>]+>[^<]+<\/[^<]+>)|(<[^>]+>)/g).map(pe=>{!re.test(pe)&&!X.test(pe)&&H.test(pe)&&he--;let de=`${ae("  ",he)}${pe}`;return!re.test(pe)&&!X.test(pe)&&!H.test(pe)&&he++,de}).join(`
`)}function c($){let H=atob($),X=new Uint8Array(H.length);for(let re=0,ae=X.length;re<ae;re++)X[re]=H.charCodeAt(re);return X}let h,d;function f($,H){h=h||document.createElement("canvas"),d=d||h.getContext("2d"),h.width=$.width,h.height=$.height,d.drawImage($,0,0);let X=h.toDataURL(`image/${H}`,1).replace(/^data:image\/(png|jpg);base64,/,"");return c(X)}let m=["getX","getY","getZ","getW"],g=new Ar;function y($,H=!1){if(H){let X=new Float32Array($.count*3);for(let re=0,ae=$.count;re<ae;re++)g.fromBufferAttribute($,re).convertLinearToSRGB(),X[3*re+0]=g.r,X[3*re+1]=g.g,X[3*re+2]=g.b;return X}else if($.isInterleavedBufferAttribute){let X=new $.array.constructor($.count*$.itemSize),re=$.itemSize;for(let ae=0,he=$.count;ae<he;ae++)for(let pe=0;pe<re;pe++)X[ae*re+pe]=$[m[pe]](ae);return X}else return $.array}function _($,H,X){return Array.isArray($)?$.slice(H,H+X):new $.constructor($.buffer,H*$.BYTES_PER_ELEMENT,X)}function b($,H,X,re,ae=!1){let he=y($,ae);return`<source id="${H}"><float_array id="${H}-array" count="${he.length}">`+he.join(" ")+`</float_array><technique_common><accessor source="#${H}-array" count="${Math.floor(he.length/$.itemSize)}" stride="${$.itemSize}">`+X.map(pe=>`<param name="${pe}" type="${re}" />`).join("")+"</accessor></technique_common></source>"}let S;function E($){return $.updateMatrix(),S=S||new Yr,S.copy($.matrix),S.transpose(),`<matrix>${S.toArray().join(" ")}</matrix>`}function T($){let H=R.get($);if(!H){let X=$;if(X.isBufferGeometry!==!0)throw new Error("THREE.ColladaExporter: Geometry is not of type THREE.BufferGeometry.");let re=`Mesh${F.length+1}`,ae=X.index?X.index.count*X.index.itemSize:X.attributes.position.count,he=X.groups!=null&&X.groups.length!==0?X.groups:[{start:0,count:ae,materialIndex:0}],pe=$.name?` name="${$.name}"`:"",de=`<geometry id="${re}"${pe}><mesh>`,ee=`${re}-position`,se=`${re}-vertices`;de+=b(X.attributes.position,ee,["X","Y","Z"],"float"),de+=`<vertices id="${se}"><input semantic="POSITION" source="#${ee}" /></vertices>`;let Y=`<input semantic="VERTEX" source="#${se}" offset="0" />`;if("normal"in X.attributes){let me=`${re}-normal`;de+=b(X.attributes.normal,me,["X","Y","Z"],"float"),Y+=`<input semantic="NORMAL" source="#${me}" offset="0" />`}if("uv"in X.attributes){let me=`${re}-texcoord`;de+=b(X.attributes.uv,me,["S","T"],"float"),Y+=`<input semantic="TEXCOORD" source="#${me}" offset="0" set="0" />`}if("uv2"in X.attributes){let me=`${re}-texcoord2`;de+=b(X.attributes.uv2,me,["S","T"],"float"),Y+=`<input semantic="TEXCOORD" source="#${me}" offset="0" set="1" />`}if("color"in X.attributes){let me=`${re}-color`;de+=b(X.attributes.color,me,["R","G","B"],"float",!0),Y+=`<input semantic="COLOR" source="#${me}" offset="0" />`}let fe=null;if(X.index)fe=y(X.index);else{fe=new Array(ae);for(let me=0,De=fe.length;me<De;me++)fe[me]=me}for(let me=0,De=he.length;me<De;me++){let Le=he[me],Ce=_(fe,Le.start,Le.count),Ae=Ce.length/3;de+=`<triangles material="MESH_MATERIAL_${Le.materialIndex}" count="${Ae}">`,de+=Y,de+=`<p>${Ce.join(" ")}</p>`,de+="</triangles>"}de+="</mesh></geometry>",F.push(de),H={meshid:re,bufferGeometry:X},R.set($,H)}return H}function A($){let H=L.get($);if(H==null){H=`image-${U.length+1}`;let X="png",re=$.name||H,ae=`<image id="${H}" name="${re}">`;n==="1.5.0"?ae+=`<init_from><ref>${r.textureDirectory}${re}.${X}</ref></init_from>`:ae+=`<init_from>${r.textureDirectory}${re}.${X}</init_from>`,ae+="</image>",U.push(ae),L.set($,H),N.push({directory:r.textureDirectory,name:re,ext:X,data:f($.image,X),original:$})}return H}function P($){let H=D.get($);if(H==null){H=`Mat${z.length+1}`;let X="phong";$.isMeshLambertMaterial===!0?X="lambert":$.isMeshBasicMaterial===!0&&(X="constant",$.map!==null&&console.warn("ColladaExporter: Texture maps not supported with MeshBasicMaterial."));let re=$.emissive?$.emissive:new Ar(0,0,0),ae=$.color?$.color:new Ar(0,0,0),he=$.specular?$.specular:new Ar(1,1,1),pe=$.shininess||0,de=$.reflectivity||0;re.convertLinearToSRGB(),he.convertLinearToSRGB(),ae.convertLinearToSRGB();let ee="";$.transparent===!0&&(ee+="<transparent>"+($.map?'<texture texture="diffuse-sampler"></texture>':"<float>1</float>")+"</transparent>",$.opacity<1&&(ee+=`<transparency><float>${$.opacity}</float></transparency>`));let se=`<technique sid="common"><${X}><emission>`+($.emissiveMap?'<texture texture="emissive-sampler" texcoord="TEXCOORD" />':`<color sid="emission">${re.r} ${re.g} ${re.b} 1</color>`)+"</emission>"+(X!=="constant"?"<diffuse>"+($.map?'<texture texture="diffuse-sampler" texcoord="TEXCOORD" />':`<color sid="diffuse">${ae.r} ${ae.g} ${ae.b} 1</color>`)+"</diffuse>":"")+(X!=="constant"?"<bump>"+($.normalMap?'<texture texture="bump-sampler" texcoord="TEXCOORD" />':"")+"</bump>":"")+(X==="phong"?`<specular><color sid="specular">${he.r} ${he.g} ${he.b} 1</color></specular><shininess>`+($.specularMap?'<texture texture="specular-sampler" texcoord="TEXCOORD" />':`<float sid="shininess">${pe}</float>`)+"</shininess>":"")+`<reflective><color>${ae.r} ${ae.g} ${ae.b} 1</color></reflective><reflectivity><float>${de}</float></reflectivity>`+ee+`</${X}></technique>`,Y=`<effect id="${H}-effect"><profile_COMMON>`+($.map?`<newparam sid="diffuse-surface"><surface type="2D"><init_from>${A($.map)}</init_from></surface></newparam><newparam sid="diffuse-sampler"><sampler2D><source>diffuse-surface</source></sampler2D></newparam>`:"")+($.specularMap?`<newparam sid="specular-surface"><surface type="2D"><init_from>${A($.specularMap)}</init_from></surface></newparam><newparam sid="specular-sampler"><sampler2D><source>specular-surface</source></sampler2D></newparam>`:"")+($.emissiveMap?`<newparam sid="emissive-surface"><surface type="2D"><init_from>${A($.emissiveMap)}</init_from></surface></newparam><newparam sid="emissive-sampler"><sampler2D><source>emissive-surface</source></sampler2D></newparam>`:"")+($.normalMap?`<newparam sid="bump-surface"><surface type="2D"><init_from>${A($.normalMap)}</init_from></surface></newparam><newparam sid="bump-sampler"><sampler2D><source>bump-surface</source></sampler2D></newparam>`:"")+se+($.side===iB?'<extra><technique profile="THREEJS"><double_sided sid="double_sided" type="int">1</double_sided></technique></extra>':"")+"</profile_COMMON></effect>",fe=$.name?` name="${$.name}"`:"",me=`<material id="${H}"${fe}><instance_effect url="#${H}-effect" /></material>`;G.push(me),z.push(Y),D.set($,H)}return H}function O($){let H=`<node name="${$.name}">`;if(H+=E($),$.isMesh===!0&&$.geometry!==null){let X=T($.geometry),re=X.meshid,ae=X.bufferGeometry,he=null,pe,de=$.material||new pp,ee=Array.isArray(de)?de:[de];ae.groups.length>ee.length?pe=new Array(ae.groups.length):pe=new Array(ee.length),he=pe.fill().map((se,Y)=>P(ee[Y%ee.length])),H+=`<instance_geometry url="#${re}">`+(he.length>0?"<bind_material><technique_common>"+he.map((se,Y)=>`<instance_material symbol="MESH_MATERIAL_${Y}" target="#${se}" ><bind_vertex_input semantic="TEXCOORD" input_semantic="TEXCOORD" input_set="0" /></instance_material>`).join("")+"</technique_common></bind_material>":"")+"</instance_geometry>"}return $.children.forEach(X=>H+=O(X)),H+="</node>",H}let R=new WeakMap,D=new WeakMap,L=new WeakMap,N=[],U=[],F=[],z=[],G=[],J=O(e),Z=`<?xml version="1.0" encoding="UTF-8" standalone="no" ?><COLLADA xmlns="${n==="1.4.1"?"http://www.collada.org/2005/11/COLLADASchema":"https://www.khronos.org/collada/"}" version="${n}"><asset>`+("<contributor><authoring_tool>three.js Collada Exporter</authoring_tool>"+(r.author!==null?`<author>${r.author}</author>`:"")+`</contributor><created>${new Date().toISOString()}</created><modified>${new Date().toISOString()}</modified>`+(r.unitName!==null?`<unit name="${r.unitName}" meter="${r.unitMeter}" />`:"")+`<up_axis>${r.upAxis}</up_axis>`)+"</asset>";Z+=`<library_images>${U.join("")}</library_images>`,Z+=`<library_effects>${z.join("")}</library_effects>`,Z+=`<library_materials>${G.join("")}</library_materials>`,Z+=`<library_geometries>${F.join("")}</library_geometries>`,Z+=`<library_visual_scenes><visual_scene id="Scene" name="scene">${J}</visual_scene></library_visual_scenes>`,Z+='<scene><instance_visual_scene url="#Scene"/></scene>',Z+="</COLLADA>";let q={data:l(Z),textures:N};return typeof t=="function"&&requestAnimationFrame(()=>t(q)),q}},jhe=function(){var i=null,e=null,t,r,n=null,l={},c={},h={},d={},f={},m={},g={},y={},_={},b,S,E,T,A,P,O,R,D=THREE.SmoothShading,L={centerGeometry:!1,convertUpAxis:!1,subdivideFaces:!0,upAxis:"Y",defaultEnvMap:null},N=1;function U(Q,le,oe,ve){n=le;var ke=new DOMParser,Oe=ke.parseFromString(Q,"application/xml");F(Oe,void 0,Q)}function F(Q,le,oe){if(i=Q,le=le||n,oe!==void 0){var ve=oe.split("/");ve.pop(),A=(ve.length<1?".":ve.join("/"))+"/"}G(),c=J("library_images image",Ge,"image"),m=J("library_materials material",wt,"material"),g=J("library_effects effect",ci,"effect"),f=J("library_geometries geometry",et,"geometry"),y=J("library_cameras camera",oo,"camera"),_=J("library_lights light",uo,"light"),d=J("library_controllers controller",Ct,"controller"),h=J("library_animations animation",Ji,"animation"),E=J("library_visual_scenes visual_scene",Kt,"visual_scene"),T=J("library_kinematics_models kinematics_model",yu,"kinematics_model"),P=[],O=[],t=Z(),e=new THREE.Group;for(var ke=0;ke<t.nodes.length;ke++)e.add(Y(t.nodes[ke]));e.scale.multiplyScalar(N),$(),r=q(),se();var Oe={scene:e,morphs:P,skins:O,animations:b,kinematics:S,dae:{images:c,materials:m,cameras:y,lights:_,effects:g,geometries:f,controllers:d,animations:h,visualScenes:E,visualScene:t,scene:t,kinematicsModels:T,kinematicsModel:r}};return le&&le(Oe),Oe}function z(Q){D=Q}function G(){var Q=i.querySelectorAll("asset"),le=Q[0];if(le&&le.childNodes)for(var oe=0;oe<le.childNodes.length;oe++){var ve=le.childNodes[oe];switch(ve.nodeName){case"unit":var ke=ve.getAttribute("meter");ke&&(N=parseFloat(ke));break;case"up_axis":ve.textContent.charAt(0);break}}}function J(Q,le,oe){for(var ve=i.querySelectorAll(Q),ke={},Oe=0,Je=ve.length,mt=0;mt<Je;mt++){var vt=ve[mt],ct=new le().parse(vt);(!ct.id||ct.id.length===0)&&(ct.id=oe+Oe++),ke[ct.id]=ct}return ke}function Z(){var Q=i.querySelectorAll("scene instance_visual_scene")[0];if(Q){var le=Q.getAttribute("url").replace(/^#/,"");return E[le.length>0?le:"visual_scene0"]}else return null}function q(){var Q=i.querySelectorAll("instance_kinematics_model")[0];if(Q){var le=Q.getAttribute("url").replace(/^#/,"");return T[le.length>0?le:"kinematics_model0"]}else return null}function $(){b=[],H(e)}function H(Q){var le=t.getChildById(Q.colladaId,!0),oe=null;if(le&&le.keys){oe={fps:60,hierarchy:[{node:le,keys:le.keys,sids:le.sids}],node:Q,name:"animation_"+Q.name,length:0},b.push(oe);for(var ve=0,ke=le.keys.length;ve<ke;ve++)oe.length=Math.max(oe.length,le.keys[ve].time)}else oe={hierarchy:[{keys:[],sids:[]}]};for(var ve=0,ke=Q.children.length;ve<ke;ve++)for(var Oe=H(Q.children[ve]),Je=0,mt=Oe.hierarchy.length;Je<mt;Je++)oe.hierarchy.push({keys:[],sids:[]});return oe}function X(){var Q=1e6,le=-Q,oe=0,ve;for(var ke in h){var Oe=h[ke];ve=ve||Oe.id;for(var Je=0;Je<Oe.sampler.length;Je++){var mt=Oe.sampler[Je];mt.create(),Q=Math.min(Q,mt.startTime),le=Math.max(le,mt.endTime),oe=Math.max(oe,mt.input.length)}}return{start:Q,end:le,frames:oe,ID:ve}}function re(Q,le){var oe=le instanceof _e?d[le.url]:le;if(!oe||!oe.morph){console.log("could not find morph controller!");return}for(var ve=oe.morph,ke=0;ke<ve.targets.length;ke++){var Oe=ve.targets[ke],Je=f[Oe];if(!(!Je.mesh||!Je.mesh.primitives||!Je.mesh.primitives.length)){var mt=Je.mesh.primitives[0].geometry;mt.vertices.length===Q.vertices.length&&Q.morphTargets.push({name:"target_1",vertices:mt.vertices})}}Q.morphTargets.push({name:"target_Z",vertices:Q.vertices})}function ae(Q,le,oe,ve){if(Q.world=Q.world||new THREE.Matrix4,Q.localworld=Q.localworld||new THREE.Matrix4,Q.world.copy(Q.matrix),Q.localworld.copy(Q.matrix),Q.channels&&Q.channels.length){var ke=Q.channels[0],Oe=ke.sampler.output[oe];Oe instanceof THREE.Matrix4&&(Q.world.copy(Oe),Q.localworld.copy(Oe),oe===0&&Q.matrix.copy(Oe))}ve&&Q.world.multiplyMatrices(ve,Q.world),le.push(Q);for(var Je=0;Je<Q.nodes.length;Je++)ae(Q.nodes[Je],le,oe,Q.world)}function he(Q,le){for(var oe=0;oe<Q.length;oe++){var ve=Q[oe],ke=-1;if(ve.type=="JOINT"){for(var Oe=0;Oe<le.joints.length;Oe++)if(ve.sid===le.joints[Oe]){ke=Oe;break}if(ke>=0){var Je=le.invBindMatrices[ke];ve.invBindMatrix=Je,ve.skinningMatrix=new THREE.Matrix4,ve.skinningMatrix.multiplyMatrices(ve.world,Je),ve.animatrix=new THREE.Matrix4,ve.animatrix.copy(ve.localworld),ve.weights=[];for(var Oe=0;Oe<le.weights.length;Oe++)for(var mt=0;mt<le.weights[Oe].length;mt++){var vt=le.weights[Oe][mt];vt.joint===ke&&ve.weights.push(vt)}}else console.warn("ColladaLoader: Could not find joint '"+ve.sid+"'."),ve.skinningMatrix=new THREE.Matrix4,ve.weights=[]}}}function pe(Q){var le=[],oe=function(ve,ke,Oe){var Je={};Je.name=ke.sid,Je.parent=ve,Je.matrix=ke.matrix;var mt=[new THREE.Vector3,new THREE.Quaternion,new THREE.Vector3];Je.matrix.decompose(mt[0],mt[1],mt[2]),Je.pos=[mt[0].x,mt[0].y,mt[0].z],Je.scl=[mt[2].x,mt[2].y,mt[2].z],Je.rotq=[mt[1].x,mt[1].y,mt[1].z,mt[1].w],Oe.push(Je);for(var vt in ke.nodes)oe(ke.sid,ke.nodes[vt],Oe)};return oe(-1,Q,le),le}function de(Q,le,oe){var ve=[];ae(le,ve,-1),he(ve,oe.skin),v=new THREE.Vector3;for(var ke=[],Oe=0;Oe<Q.vertices.length;Oe++)ke.push(new THREE.Vector3);for(Oe=0;Oe<ve.length;Oe++)if(ve[Oe].type=="JOINT")for(j=0;j<ve[Oe].weights.length;j++)w=ve[Oe].weights[j],vidx=w.index,weight=w.weight,o=Q.vertices[vidx],s=ke[vidx],v.x=o.x,v.y=o.y,v.z=o.z,v.applyMatrix4(ve[Oe].skinningMatrix),s.x+=v.x*weight,s.y+=v.y*weight,s.z+=v.z*weight;for(var Oe=0;Oe<Q.vertices.length;Oe++)Q.vertices[Oe]=ke[Oe]}function ee(Q,le,oe){var ve=d[le.url];if(oe=oe!==void 0?oe:40,!ve||!ve.skin){console.log("ColladaLoader: Could not find skin controller.");return}if(!le.skeleton||!le.skeleton.length){console.log("ColladaLoader: Could not find the skeleton for the skin. ");return}for(var ke=X(),Oe=t.getChildById(le.skeleton[0],!0)||t.getChildBySid(le.skeleton[0],!0),Je=pe(Oe),mt=ve.skin.joints,vt=[],ct=0;ct<mt.length;ct++)for(var It=0;It<Je.length;It++)Je[It].name===mt[ct]&&(vt[ct]=Je[It]);for(var ct=0;ct<vt.length;ct++)for(var It=0;It<vt.length;It++)vt[ct].parent===vt[It].name&&(vt[ct].parent=It);var ct,It,Ht;for(new THREE.Vector3,ct=0;ct<Q.vertices.length;ct++)Q.vertices[ct].applyMatrix4(ve.skin.bindShapeMatrix);for(var qi=[],Ui=[],Ai=ve.skin.weights,ct=0;ct<Ai.length;ct++){var Pr=new THREE.Vector4(Ai[ct][0]?Ai[ct][0].joint:0,Ai[ct][1]?Ai[ct][1].joint:0,Ai[ct][2]?Ai[ct][2].joint:0,Ai[ct][3]?Ai[ct][3].joint:0),Ht=new THREE.Vector4(Ai[ct][0]?Ai[ct][0].weight:0,Ai[ct][1]?Ai[ct][1].weight:0,Ai[ct][2]?Ai[ct][2].weight:0,Ai[ct][3]?Ai[ct][3].weight:0);qi.push(Pr),Ui.push(Ht)}Q.skinIndices=qi,Q.skinWeights=Ui,Q.bones=vt;for(var Rr={name:ke.ID,fps:30,length:ke.frames/30,hierarchy:[]},It=0;It<vt.length;It++)Rr.hierarchy.push({parent:vt[It].parent,name:vt[It].name,keys:[]});for(console.log("ColladaLoader:",ke.ID+" has "+vt.length+" bones."),de(Q,Oe,ve),oe=0;oe<ke.frames;oe++){var Kr=[];ae(Oe,Kr,oe),he(Kr,ve.skin);for(var ct=0;ct<Kr.length;ct++)for(var It=0;It<Rr.hierarchy.length;It++)if(Rr.hierarchy[It].name===Kr[ct].sid){var or={};or.time=oe/30,or.matrix=Kr[ct].animatrix,oe===0&&(Kr[ct].matrix=or.matrix);var ui=[new THREE.Vector3,new THREE.Quaternion,new THREE.Vector3];or.matrix.decompose(ui[0],ui[1],ui[2]),or.pos=[ui[0].x,ui[0].y,ui[0].z],or.scl=[ui[2].x,ui[2].y,ui[2].z],or.rot=ui[1],Rr.hierarchy[It].keys.push(or)}Q.animation=Rr}}function se(){if(r&&r.joints.length===0){S=void 0;return}var Q={},le=function(It,Ht){var qi=Ht.getAttribute("id"),Ui=t.getChildById(qi,!0),Ai=r.joints[It];e.traverse(function(Pr){Pr.colladaId==qi&&(Q[It]={node:Pr,transforms:Ui.transforms,joint:Ai,position:Ai.zeroPosition})})};S={joints:r&&r.joints,getJointValue:function(It){var Ht=Q[It];if(Ht)return Ht.position;console.log("getJointValue: joint "+It+" doesn't exist")},setJointValue:function(It,Ht){var qi=Q[It];if(qi){var Ui=qi.joint;if(Ht>Ui.limits.max||Ht<Ui.limits.min)console.log("setJointValue: joint "+It+" value "+Ht+" outside of limits (min: "+Ui.limits.min+", max: "+Ui.limits.max+")");else if(Ui.static)console.log("setJointValue: joint "+It+" is static");else{var Ai=qi.node,Pr=Ui.axis,Rr=qi.transforms,Kr=new THREE.Matrix4;for(ve=0;ve<Rr.length;ve++){var or=Rr[ve];if(or.sid&&or.sid.indexOf("joint"+It)!==-1)switch(Ui.type){case"revolute":Kr.multiply(ui.makeRotationAxis(Pr,THREE.Math.degToRad(Ht)));break;case"prismatic":Kr.multiply(ui.makeTranslation(Pr.x*Ht,Pr.y*Ht,Pr.z*Ht));break;default:console.warn("setJointValue: unknown joint type: "+Ui.type);break}else{var ui=new THREE.Matrix4;switch(or.type){case"matrix":Kr.multiply(or.obj);break;case"translate":Kr.multiply(ui.makeTranslation(or.obj.x,or.obj.y,or.obj.z));break;case"rotate":Kr.multiply(ui.makeRotationAxis(or.obj,or.angle));break}}}var pn=Kr.elements,_r=Array.prototype.slice.call(pn),br=[_r[0],_r[4],_r[8],_r[12],_r[1],_r[5],_r[9],_r[13],_r[2],_r[6],_r[10],_r[14],_r[3],_r[7],_r[11],_r[15]];Ai.matrix.set.apply(Ai.matrix,br),Ai.matrix.decompose(Ai.position,Ai.quaternion,Ai.scale)}}else console.log("setJointValue: joint "+It+" doesn't exist")}};var oe=i.querySelector("scene instance_kinematics_scene");if(oe)for(var ve=0;ve<oe.childNodes.length;ve++){var ke=oe.childNodes[ve];if(ke.nodeType==1)switch(ke.nodeName){case"bind_joint_axis":var Oe=ke.getAttribute("target").split("/").pop(),Je=ke.querySelector("axis param").textContent,mt=parseInt(Je.split("joint").pop().split(".")[0]),vt=i.querySelector('[sid="'+Oe+'"]');if(vt){var ct=vt.parentElement;le(mt,ct)}break}}}function Y(Q,le){var oe=new THREE.Object3D,ve,ke,Oe,Je;for(Oe=0;Oe<Q.controllers.length;Oe++){var mt=d[Q.controllers[Oe].url];switch(mt.type){case"skin":if(f[mt.skin.source]){var vt=new Fe;vt.url=mt.skin.source,vt.instance_material=Q.controllers[Oe].instance_material,Q.geometries.push(vt),ve=Q.controllers[Oe]}else if(d[mt.skin.source]){var ct=d[mt.skin.source];if(ke=ct,ct.morph&&f[ct.morph.source]){var vt=new Fe;vt.url=ct.morph.source,vt.instance_material=Q.controllers[Oe].instance_material,Q.geometries.push(vt)}}break;case"morph":if(f[mt.morph.source]){var vt=new Fe;vt.url=mt.morph.source,vt.instance_material=Q.controllers[Oe].instance_material,Q.geometries.push(vt),ke=Q.controllers[Oe]}console.log("ColladaLoader: Morph-controller partially supported.")}}var It={};for(Oe=0;Oe<Q.geometries.length;Oe++){var Ht=Q.geometries[Oe],qi=Ht.instance_material,Ui=f[Ht.url],Ai={},Pr=[],Rr=0,Kr;if(Ui){if(!Ui.mesh||!Ui.mesh.primitives)continue;if(oe.name.length===0&&(oe.name=Ui.id),qi)for(Je=0;Je<qi.length;Je++){var or=qi[Je],ui=m[or.target],pn=ui.instance_effect.url,_r=g[pn].shader,br=_r.material;if(Ui.doubleSided){if(!(or.symbol in It)){var jr=br.clone();jr.side=THREE.DoubleSide,It[or.symbol]=jr}br=It[or.symbol]}br.opacity=br.opacity?br.opacity:1,Ai[or.symbol]=Rr,Pr.push(br),Kr=br,Kr.name=ui.name===null||ui.name===""?ui.id:ui.name,Rr++}var Gr,Ss=Kr||new THREE.MeshLambertMaterial({color:14540253,side:Ui.doubleSided?THREE.DoubleSide:THREE.FrontSide}),fn=Ui.mesh.geometry3js;if(Rr>1)for(Ss=new THREE.MeshFaceMaterial(Pr),Je=0;Je<fn.faces.length;Je++){var Qr=fn.faces[Je];Qr.materialIndex=Ai[Qr.daeMaterial]}ve!==void 0?(ee(fn,ve),fn.morphTargets.length>0?(Ss.morphTargets=!0,Ss.skinning=!1):(Ss.morphTargets=!1,Ss.skinning=!0),Gr=new THREE.SkinnedMesh(fn,Ss,!1),Gr.name="skin_"+O.length,O.push(Gr)):ke!==void 0?(re(fn,ke),Ss.morphTargets=!0,Gr=new THREE.Mesh(fn,Ss),Gr.name="morph_"+P.length,P.push(Gr)):fn.isLineStrip===!0?Gr=new THREE.Line(fn):Gr=new THREE.Mesh(fn,Ss),oe.add(Gr)}}for(Oe=0;Oe<Q.cameras.length;Oe++){var Yn=Q.cameras[Oe],Vr=y[Yn.url],xu=new THREE.PerspectiveCamera(Vr.yfov,parseFloat(Vr.aspect_ratio),parseFloat(Vr.znear),parseFloat(Vr.zfar));oe.add(xu)}for(Oe=0;Oe<Q.lights.length;Oe++){var Os=null,Lf=Q.lights[Oe],Hs=_[Lf.url];if(Hs&&Hs.technique){var ho=Hs.color.getHex(),Ro=Hs.intensity,Io=Hs.distance,Of=Hs.falloff_angle,Nf;switch(Hs.technique){case"directional":Os=new THREE.DirectionalLight(ho,Ro,Io),Os.position.set(0,0,1);break;case"point":Os=new THREE.PointLight(ho,Ro,Io);break;case"spot":Os=new THREE.SpotLight(ho,Ro,Io,Of,Nf),Os.position.set(0,0,1);break;case"ambient":Os=new THREE.AmbientLight(ho);break}}Os&&oe.add(Os)}for(oe.name=Q.name||Q.id||"",oe.colladaId=Q.id||"",oe.layer=Q.layer||"",oe.matrix=Q.matrix,oe.matrix.decompose(oe.position,oe.quaternion,oe.scale),L.centerGeometry,Oe=0;Oe<Q.nodes.length;Oe++)oe.add(Y(Q.nodes[Oe]));return oe}function fe(Q){for(var le=i.querySelectorAll("library_nodes node"),oe=0;oe<le.length;oe++){var ve=le[oe].attributes.getNamedItem("id");if(ve&&ve.value===Q)return le[oe]}}function me(Q){var le=[],oe=1e6,ve=-1e6;for(var ke in h)for(var Oe=h[ke],Je=0;Je<Oe.channel.length;Je++){var mt=Oe.channel[Je],vt=Oe.sampler[Je],ke=mt.target.split("/")[0];ke==Q.id&&(vt.create(),mt.sampler=vt,oe=Math.min(oe,vt.startTime),ve=Math.max(ve,vt.endTime),le.push(mt))}return le.length&&(Q.startTime=oe,Q.endTime=ve),le}function De(Q){if(Q.channels&&Q.channels.length){for(var le=[],oe=[],ve=0,ke=Q.channels.length;ve<ke;ve++){var Oe=Q.channels[ve],Je=Oe.fullSid,mt=Oe.sampler,vt=mt.input,ct=Q.getTransformBySid(Oe.sid),It;if(Oe.arrIndices){It=[];for(var Ht=0,qi=Oe.arrIndices.length;Ht<qi;Ht++)It[Ht]=co(Oe.arrIndices[Ht])}else It=Oe.member;if(ct){oe.indexOf(Je)===-1&&oe.push(Je);for(var Ht=0,qi=vt.length;Ht<qi;Ht++){var Ui=vt[Ht],Ai=mt.getData(ct.type,Ht,It),Pr=Le(le,Ui);if(!Pr){Pr=new ao(Ui);var Rr=Ce(le,Ui);le.splice(Rr===-1?le.length:Rr,0,Pr)}Pr.addTarget(Je,ct,It,Ai)}}else console.log('Could not find transform "'+Oe.sid+'" in node '+Q.id)}for(var ve=0;ve<oe.length;ve++)for(var Kr=oe[ve],Ht=0;Ht<le.length;Ht++){var Pr=le[Ht];Pr.hasTarget(Kr)||Ae(le,Pr,Ht,Kr)}Q.keys=le,Q.sids=oe}}function Le(Q,le){for(var oe=null,ve=0,ke=Q.length;ve<ke&&oe===null;ve++){var Oe=Q[ve];if(Oe.time===le)oe=Oe;else if(Oe.time>le)break}return oe}function Ce(Q,le){for(var oe=-1,ve=0,ke=Q.length;ve<ke&&oe===-1;ve++){var Oe=Q[ve];Oe.time>=le&&(oe=ve)}return oe}function Ae(Q,le,oe,ve){var ke=Ne(Q,ve,oe?oe-1:0),Oe=Ue(Q,ve,oe+1);if(ke&&Oe){var Je=(le.time-ke.time)/(Oe.time-ke.time),mt=ke.getTarget(ve),vt=Oe.getTarget(ve).data,ct=mt.data,It;if(mt.type==="matrix")It=ct;else if(ct.length){It=[];for(var Ht=0;Ht<ct.length;++Ht)It[Ht]=ct[Ht]+(vt[Ht]-ct[Ht])*Je}else It=ct+(vt-ct)*Je;le.addTarget(ve,mt.transform,mt.member,It)}}function Ue(Q,le,oe){for(;oe<Q.length;oe++){var ve=Q[oe];if(ve.hasTarget(le))return ve}return null}function Ne(Q,le,oe){for(oe=oe>=0?oe:oe+Q.length;oe>=0;oe--){var ve=Q[oe];if(ve.hasTarget(le))return ve}return null}function Ge(){this.id="",this.init_from=""}Ge.prototype.parse=function(Q){this.id=Q.getAttribute("id");for(var le=0;le<Q.childNodes.length;le++){var oe=Q.childNodes[le];oe.nodeName==="init_from"&&(this.init_from=oe.textContent)}return this};function Ct(){this.id="",this.name="",this.type="",this.skin=null,this.morph=null}Ct.prototype.parse=function(Q){this.id=Q.getAttribute("id"),this.name=Q.getAttribute("name"),this.type="none";for(var le=0;le<Q.childNodes.length;le++){var oe=Q.childNodes[le];switch(oe.nodeName){case"skin":this.skin=new bt().parse(oe),this.type=oe.nodeName;break;case"morph":this.morph=new it().parse(oe),this.type=oe.nodeName;break}}return this};function it(){this.method=null,this.source=null,this.targets=null,this.weights=null}it.prototype.parse=function(Q){var le={},oe=[],ve;for(this.method=Q.getAttribute("method"),this.source=Q.getAttribute("source").replace(/^#/,""),ve=0;ve<Q.childNodes.length;ve++){var ke=Q.childNodes[ve];if(ke.nodeType==1)switch(ke.nodeName){case"source":var Oe=new _t().parse(ke);le[Oe.id]=Oe;break;case"targets":oe=this.parseInputs(ke);break;default:console.log(ke.nodeName);break}}for(ve=0;ve<oe.length;ve++){var Je=oe[ve],Oe=le[Je.source];switch(Je.semantic){case"MORPH_TARGET":this.targets=Oe.read();break;case"MORPH_WEIGHT":this.weights=Oe.read();break}}return this},it.prototype.parseInputs=function(Q){for(var le=[],oe=0;oe<Q.childNodes.length;oe++){var ve=Q.childNodes[oe];if(ve.nodeType==1)switch(ve.nodeName){case"input":le.push(new Ee().parse(ve));break}}return le};function bt(){this.source="",this.bindShapeMatrix=null,this.invBindMatrices=[],this.joints=[],this.weights=[]}bt.prototype.parse=function(Q){var le={},oe,ve;this.source=Q.getAttribute("source").replace(/^#/,""),this.invBindMatrices=[],this.joints=[],this.weights=[];for(var ke=0;ke<Q.childNodes.length;ke++){var Oe=Q.childNodes[ke];if(Oe.nodeType==1)switch(Oe.nodeName){case"bind_shape_matrix":var Je=qe(Oe.textContent);this.bindShapeMatrix=Us(Je);break;case"source":var mt=new _t().parse(Oe);le[mt.id]=mt;break;case"joints":oe=Oe;break;case"vertex_weights":ve=Oe;break;default:console.log(Oe.nodeName);break}}return this.parseJoints(oe,le),this.parseWeights(ve,le),this},bt.prototype.parseJoints=function(Q,le){for(var oe=0;oe<Q.childNodes.length;oe++){var ve=Q.childNodes[oe];if(ve.nodeType==1)switch(ve.nodeName){case"input":var ke=new Ee().parse(ve),Oe=le[ke.source];ke.semantic==="JOINT"?this.joints=Oe.read():ke.semantic==="INV_BIND_MATRIX"&&(this.invBindMatrices=Oe.read());break}}},bt.prototype.parseWeights=function(Q,le){for(var oe,ve,ke=[],Oe=0;Oe<Q.childNodes.length;Oe++){var Je=Q.childNodes[Oe];if(Je.nodeType==1)switch(Je.nodeName){case"input":ke.push(new Ee().parse(Je));break;case"v":oe=st(Je.textContent);break;case"vcount":ve=st(Je.textContent);break}}for(var mt=0,Oe=0;Oe<ve.length;Oe++){for(var vt=ve[Oe],ct=[],It=0;It<vt;It++){for(var Ht={},qi=0;qi<ke.length;qi++){var Ui=ke[qi],Ai=oe[mt+Ui.offset];switch(Ui.semantic){case"JOINT":Ht.joint=Ai;break;case"WEIGHT":Ht.weight=le[Ui.source].data[Ai];break}}ct.push(Ht),mt+=ke.length}for(var It=0;It<ct.length;It++)ct[It].index=Oe;this.weights.push(ct)}};function Kt(){this.id="",this.name="",this.nodes=[],this.scene=new THREE.Group}Kt.prototype.getChildById=function(Q,le){for(var oe=0;oe<this.nodes.length;oe++){var ve=this.nodes[oe].getChildById(Q,le);if(ve)return ve}return null},Kt.prototype.getChildBySid=function(Q,le){for(var oe=0;oe<this.nodes.length;oe++){var ve=this.nodes[oe].getChildBySid(Q,le);if(ve)return ve}return null},Kt.prototype.parse=function(Q){this.id=Q.getAttribute("id"),this.name=Q.getAttribute("name"),this.nodes=[];for(var le=0;le<Q.childNodes.length;le++){var oe=Q.childNodes[le];if(oe.nodeType==1)switch(oe.nodeName){case"node":this.nodes.push(new kt().parse(oe));break}}return this};function kt(){this.id="",this.name="",this.sid="",this.nodes=[],this.controllers=[],this.transforms=[],this.geometries=[],this.channels=[],this.matrix=new THREE.Matrix4}kt.prototype.getChannelForTransform=function(Q){for(var le=0;le<this.channels.length;le++){var oe=this.channels[le],ve=oe.target.split("/");ve.shift();var ke=ve.shift(),Oe=ke.indexOf(".")>=0,Je=ke.indexOf("(")>=0,mt;if(Oe)ve=ke.split("."),ke=ve.shift(),ve.shift();else if(Je){mt=ke.split("("),ke=mt.shift();for(var vt=0;vt<mt.length;vt++)mt[vt]=parseInt(mt[vt].replace(/\)/,""))}if(ke===Q)return oe.info={sid:ke,dotSyntax:Oe,arrSyntax:Je,arrIndices:mt},oe}return null},kt.prototype.getChildById=function(Q,le){if(this.id===Q)return this;if(le)for(var oe=0;oe<this.nodes.length;oe++){var ve=this.nodes[oe].getChildById(Q,le);if(ve)return ve}return null},kt.prototype.getChildBySid=function(Q,le){if(this.sid===Q)return this;if(le)for(var oe=0;oe<this.nodes.length;oe++){var ve=this.nodes[oe].getChildBySid(Q,le);if(ve)return ve}return null},kt.prototype.getTransformBySid=function(Q){for(var le=0;le<this.transforms.length;le++)if(this.transforms[le].sid===Q)return this.transforms[le];return null},kt.prototype.parse=function(Q){var le;this.id=Q.getAttribute("id"),this.sid=Q.getAttribute("sid"),this.name=Q.getAttribute("name"),this.type=Q.getAttribute("type"),this.layer=Q.getAttribute("layer"),this.type=this.type==="JOINT"?this.type:"NODE",this.nodes=[],this.transforms=[],this.geometries=[],this.cameras=[],this.lights=[],this.controllers=[],this.matrix=new THREE.Matrix4;for(var oe=0;oe<Q.childNodes.length;oe++){var ve=Q.childNodes[oe];if(ve.nodeType==1)switch(ve.nodeName){case"node":this.nodes.push(new kt().parse(ve));break;case"instance_camera":this.cameras.push(new lo().parse(ve));break;case"instance_controller":this.controllers.push(new _e().parse(ve));break;case"instance_geometry":this.geometries.push(new Fe().parse(ve));break;case"instance_light":this.lights.push(new vu().parse(ve));break;case"instance_node":le=ve.getAttribute("url").replace(/^#/,"");var ke=fe(le);ke&&this.nodes.push(new kt().parse(ke));break;case"rotate":case"translate":case"scale":case"matrix":case"lookat":case"skew":this.transforms.push(new Pt().parse(ve));break;case"extra":break;default:console.log(ve.nodeName);break}}return this.channels=me(this),De(this),this.updateMatrix(),this},kt.prototype.updateMatrix=function(){this.matrix.identity();for(var Q=0;Q<this.transforms.length;Q++)this.transforms[Q].apply(this.matrix)};function Pt(){this.sid="",this.type="",this.data=[],this.obj=null}Pt.prototype.parse=function(Q){return this.sid=Q.getAttribute("sid"),this.type=Q.nodeName,this.data=qe(Q.textContent),this.convert(),this},Pt.prototype.convert=function(){switch(this.type){case"matrix":this.obj=Us(this.data);break;case"rotate":this.angle=THREE.Math.degToRad(this.data[3]);case"translate":this.data,this.obj=new THREE.Vector3(this.data[0],this.data[1],this.data[2]);break;case"scale":this.data,this.obj=new THREE.Vector3(this.data[0],this.data[1],this.data[2]);break;default:console.log("Can not convert Transform of type "+this.type);break}},Pt.prototype.apply=function(){var Q=new THREE.Matrix4;return function(le){switch(this.type){case"matrix":le.multiply(this.obj);break;case"translate":le.multiply(Q.makeTranslation(this.obj.x,this.obj.y,this.obj.z));break;case"rotate":le.multiply(Q.makeRotationAxis(this.obj,this.angle));break;case"scale":le.scale(this.obj);break}}}(),Pt.prototype.update=function(Q,le){var oe=["X","Y","Z","ANGLE"];switch(this.type){case"matrix":if(!le)this.obj.copy(Q);else if(le.length===1)switch(le[0]){case 0:this.obj.n11=Q[0],this.obj.n21=Q[1],this.obj.n31=Q[2],this.obj.n41=Q[3];break;case 1:this.obj.n12=Q[0],this.obj.n22=Q[1],this.obj.n32=Q[2],this.obj.n42=Q[3];break;case 2:this.obj.n13=Q[0],this.obj.n23=Q[1],this.obj.n33=Q[2],this.obj.n43=Q[3];break;case 3:this.obj.n14=Q[0],this.obj.n24=Q[1],this.obj.n34=Q[2],this.obj.n44=Q[3];break}else if(le.length===2){var ve="n"+(le[0]+1)+(le[1]+1);this.obj[ve]=Q}else console.log("Incorrect addressing of matrix in transform.");break;case"translate":case"scale":switch(Object.prototype.toString.call(le)==="[object Array]"&&(le=oe[le[0]]),le){case"X":this.obj.x=Q;break;case"Y":this.obj.y=Q;break;case"Z":this.obj.z=Q;break;default:this.obj.x=Q[0],this.obj.y=Q[1],this.obj.z=Q[2];break}break;case"rotate":switch(Object.prototype.toString.call(le)==="[object Array]"&&(le=oe[le[0]]),le){case"X":this.obj.x=Q;break;case"Y":this.obj.y=Q;break;case"Z":this.obj.z=Q;break;case"ANGLE":this.angle=THREE.Math.degToRad(Q);break;default:this.obj.x=Q[0],this.obj.y=Q[1],this.obj.z=Q[2],this.angle=THREE.Math.degToRad(Q[3]);break}break}};function _e(){this.url="",this.skeleton=[],this.instance_material=[]}_e.prototype.parse=function(Q){this.url=Q.getAttribute("url").replace(/^#/,""),this.skeleton=[],this.instance_material=[];for(var le=0;le<Q.childNodes.length;le++){var oe=Q.childNodes[le];if(oe.nodeType===1)switch(oe.nodeName){case"skeleton":this.skeleton.push(oe.textContent.replace(/^#/,""));break;case"bind_material":for(var ve=oe.querySelectorAll("instance_material"),ke=0;ke<ve.length;ke++){var Oe=ve[ke];this.instance_material.push(new ce().parse(Oe))}break}}return this};function ce(){this.symbol="",this.target=""}ce.prototype.parse=function(Q){return this.symbol=Q.getAttribute("symbol"),this.target=Q.getAttribute("target").replace(/^#/,""),this};function Fe(){this.url="",this.instance_material=[]}Fe.prototype.parse=function(Q){this.url=Q.getAttribute("url").replace(/^#/,""),this.instance_material=[];for(var le=0;le<Q.childNodes.length;le++){var oe=Q.childNodes[le];if(oe.nodeType==1&&oe.nodeName==="bind_material"){for(var ve=oe.querySelectorAll("instance_material"),ke=0;ke<ve.length;ke++){var Oe=ve[ke];this.instance_material.push(new ce().parse(Oe))}break}}return this};function et(){this.id="",this.mesh=null}et.prototype.parse=function(Q){this.id=Q.getAttribute("id"),xr(this,Q);for(var le=0;le<Q.childNodes.length;le++){var oe=Q.childNodes[le];switch(oe.nodeName){case"mesh":this.mesh=new Dt(this).parse(oe);break}}return this};function Dt(Q){this.geometry=Q.id,this.primitives=[],this.vertices=null,this.geometry3js=null}Dt.prototype.parse=function(Q){this.primitives=[];for(var le=0;le<Q.childNodes.length;le++){var oe=Q.childNodes[le];switch(oe.nodeName){case"source":je(oe);break;case"vertices":this.vertices=new lt().parse(oe);break;case"linestrips":this.primitives.push(new we().parse(oe));break;case"triangles":this.primitives.push(new Ve().parse(oe));break;case"polygons":this.primitives.push(new gt().parse(oe));break;case"polylist":this.primitives.push(new xe().parse(oe));break}}if(this.geometry3js=new THREE.Geometry,this.vertices===null)return this;for(var ve=l[this.vertices.input.POSITION.source].data,le=0;le<ve.length;le+=3)this.geometry3js.vertices.push(tn(ve,le).clone());for(var le=0;le<this.primitives.length;le++){var ke=this.primitives[le];ke.setVertices(this.vertices),this.handlePrimitive(ke,this.geometry3js)}return this.geometry3js.calcNormals&&(this.geometry3js.computeVertexNormals(),delete this.geometry3js.calcNormals),this},Dt.prototype.handlePrimitive=function(Q,le){if(Q instanceof we){le.isLineStrip=!0;return}var oe,ve,ke=Q.p,Oe=Q.inputs,Je,mt,vt,ct,It,Ht=0,qi=3,Ui=0,Ai=[];for(oe=0;oe<Oe.length;oe++){Je=Oe[oe];var Pr=Je.offset+1;switch(Ui=Ui<Pr?Pr:Ui,Je.semantic){case"TEXCOORD":Ai.push(Je.set);break}}for(var Rr=0;Rr<ke.length;++Rr)for(var Kr=ke[Rr],or=0;or<Kr.length;){var ui=[],pn=[],_r=null,br=[];for(Q.vcount?qi=Q.vcount.length?Q.vcount[Ht++]:Q.vcount:qi=Kr.length/Ui,oe=0;oe<qi;oe++)for(ve=0;ve<Oe.length;ve++)switch(Je=Oe[ve],ct=l[Je.source],mt=Kr[or+oe*Ui+Je.offset],It=ct.accessor.params.length,vt=mt*It,Je.semantic){case"VERTEX":ui.push(mt);break;case"NORMAL":pn.push(tn(ct.data,vt));break;case"TEXCOORD":_r=_r||{},_r[Je.set]===void 0&&(_r[Je.set]=[]),_r[Je.set].push(new THREE.Vector2(ct.data[vt],ct.data[vt+1]));break;case"COLOR":br.push(new THREE.Color().setRGB(ct.data[vt],ct.data[vt+1],ct.data[vt+2]));break}if(pn.length===0)if(Je=this.vertices.input.NORMAL,Je){ct=l[Je.source],It=ct.accessor.params.length;for(var jr=0,Gr=ui.length;jr<Gr;jr++)pn.push(tn(ct.data,ui[jr]*It))}else le.calcNormals=!0;if(!_r&&(_r={},Je=this.vertices.input.TEXCOORD,Je)){Ai.push(Je.set),ct=l[Je.source],It=ct.accessor.params.length;for(var jr=0,Gr=ui.length;jr<Gr;jr++)vt=ui[jr]*It,_r[Je.set]===void 0&&(_r[Je.set]=[]),_r[Je.set].push(new THREE.Vector2(ct.data[vt],1-ct.data[vt+1]))}if(br.length===0&&(Je=this.vertices.input.COLOR,Je)){ct=l[Je.source],It=ct.accessor.params.length;for(var jr=0,Gr=ui.length;jr<Gr;jr++)vt=ui[jr]*It,br.push(new THREE.Color().setRGB(ct.data[vt],ct.data[vt+1],ct.data[vt+2]))}var Ss=null,fn=[],Qr,Yn;if(qi===3)fn.push(new THREE.Face3(ui[0],ui[1],ui[2],pn,br.length?br:new THREE.Color));else if(qi===4)fn.push(new THREE.Face3(ui[0],ui[1],ui[3],[pn[0].clone(),pn[1].clone(),pn[3].clone()],br.length?[br[0],br[1],br[3]]:new THREE.Color)),fn.push(new THREE.Face3(ui[1],ui[2],ui[3],[pn[1].clone(),pn[2].clone(),pn[3].clone()],br.length?[br[1],br[2],br[3]]:new THREE.Color));else if(qi>4&&L.subdivideFaces){var Vr=br.length?br:new THREE.Color;for(ve=1;ve<qi-1;)fn.push(new THREE.Face3(ui[0],ui[ve],ui[ve+1],[pn[0].clone(),pn[ve++].clone(),pn[ve].clone()],Vr))}if(fn.length)for(var jr=0,Gr=fn.length;jr<Gr;jr++)for(Ss=fn[jr],Ss.daeMaterial=Q.material,le.faces.push(Ss),ve=0;ve<Ai.length;ve++)Qr=_r[Ai[ve]],qi>4?Yn=[Qr[0],Qr[jr+1],Qr[jr+2]]:qi===4?jr===0?Yn=[Qr[0],Qr[1],Qr[3]]:Yn=[Qr[1].clone(),Qr[2],Qr[3].clone()]:Yn=[Qr[0],Qr[1],Qr[2]],le.faceVertexUvs[ve]===void 0&&(le.faceVertexUvs[ve]=[]),le.faceVertexUvs[ve].push(Yn);else console.log("dropped face with vcount "+qi+" for geometry with id: "+le.id);or+=Ui*qi}};function gt(){this.material="",this.count=0,this.inputs=[],this.vcount=null,this.p=[],this.geometry=new THREE.Geometry}gt.prototype.setVertices=function(Q){for(var le=0;le<this.inputs.length;le++)this.inputs[le].source===Q.id&&(this.inputs[le].source=Q.input.POSITION.source)},gt.prototype.parse=function(Q){this.material=Q.getAttribute("material"),this.count=yi(Q,"count",0);for(var le=0;le<Q.childNodes.length;le++){var oe=Q.childNodes[le];switch(oe.nodeName){case"input":this.inputs.push(new Ee().parse(Q.childNodes[le]));break;case"vcount":this.vcount=st(oe.textContent);break;case"p":this.p.push(st(oe.textContent));break;case"ph":console.warn("polygon holes not yet supported!");break}}return this};function xe(){gt.call(this),this.vcount=[]}xe.prototype=Object.create(gt.prototype),xe.prototype.constructor=xe;function we(){gt.call(this),this.vcount=1}we.prototype=Object.create(gt.prototype),we.prototype.constructor=we;function Ve(){gt.call(this),this.vcount=3}Ve.prototype=Object.create(gt.prototype),Ve.prototype.constructor=Ve;function ut(){this.source="",this.count=0,this.stride=0,this.params=[]}ut.prototype.parse=function(Q){this.params=[],this.source=Q.getAttribute("source"),this.count=yi(Q,"count",0),this.stride=yi(Q,"stride",0);for(var le=0;le<Q.childNodes.length;le++){var oe=Q.childNodes[le];if(oe.nodeName==="param"){var ve={};ve.name=oe.getAttribute("name"),ve.type=oe.getAttribute("type"),this.params.push(ve)}}return this};function lt(){this.input={}}lt.prototype.parse=function(Q){this.id=Q.getAttribute("id");for(var le=0;le<Q.childNodes.length;le++)if(Q.childNodes[le].nodeName==="input"){var oe=new Ee().parse(Q.childNodes[le]);this.input[oe.semantic]=oe}return this};function Ee(){this.semantic="",this.offset=0,this.source="",this.set=0}Ee.prototype.parse=function(Q){return this.semantic=Q.getAttribute("semantic"),this.source=Q.getAttribute("source").replace(/^#/,""),this.set=yi(Q,"set",-1),this.offset=yi(Q,"offset",0),this.semantic==="TEXCOORD"&&this.set<0&&(this.set=0),this};function _t(Q){this.id=Q,this.type=null}_t.prototype.parse=function(Q){this.id=Q.getAttribute("id");for(var le=0;le<Q.childNodes.length;le++){var oe=Q.childNodes[le];switch(oe.nodeName){case"bool_array":this.data=tt(oe.textContent),this.type=oe.nodeName;break;case"float_array":this.data=qe(oe.textContent),this.type=oe.nodeName;break;case"int_array":this.data=st(oe.textContent),this.type=oe.nodeName;break;case"IDREF_array":case"Name_array":this.data=si(oe.textContent),this.type=oe.nodeName;break;case"technique_common":for(var ve=0;ve<oe.childNodes.length;ve++)if(oe.childNodes[ve].nodeName==="accessor"){this.accessor=new ut().parse(oe.childNodes[ve]);break}break}}return this},_t.prototype.read=function(){var Q=[],le=this.accessor.params[0];switch(le.type){case"IDREF":case"Name":case"name":case"float":return this.data;case"float4x4":for(var oe=0;oe<this.data.length;oe+=16){var ve=this.data.slice(oe,oe+16),ke=Us(ve);Q.push(ke)}break;default:console.log("ColladaLoader: Source: Read dont know how to read "+le.type+".");break}return Q};function wt(){this.id="",this.name="",this.instance_effect=null}wt.prototype.parse=function(Q){this.id=Q.getAttribute("id"),this.name=Q.getAttribute("name");for(var le=0;le<Q.childNodes.length;le++)if(Q.childNodes[le].nodeName==="instance_effect"){this.instance_effect=new ji().parse(Q.childNodes[le]);break}return this};function Xt(){this.color=new THREE.Color,this.color.setRGB(Math.random(),Math.random(),Math.random()),this.color.a=1,this.texture=null,this.texcoord=null,this.texOpts=null}Xt.prototype.isColor=function(){return this.texture===null},Xt.prototype.isTexture=function(){return this.texture!=null},Xt.prototype.parse=function(Q){Q.nodeName==="transparent"&&(this.opaque=Q.getAttribute("opaque"));for(var le=0;le<Q.childNodes.length;le++){var oe=Q.childNodes[le];if(oe.nodeType==1)switch(oe.nodeName){case"color":var ve=qe(oe.textContent);this.color=new THREE.Color,this.color.setRGB(ve[0],ve[1],ve[2]),this.color.a=ve[3];break;case"texture":this.texture=oe.getAttribute("texture"),this.texcoord=oe.getAttribute("texcoord"),this.texOpts={offsetU:0,offsetV:0,repeatU:1,repeatV:1,wrapU:1,wrapV:1},this.parseTexture(oe);break}}return this},Xt.prototype.parseTexture=function(Q){if(!Q.childNodes)return this;Q.childNodes[1]&&Q.childNodes[1].nodeName==="extra"&&(Q=Q.childNodes[1],Q.childNodes[1]&&Q.childNodes[1].nodeName==="technique"&&(Q=Q.childNodes[1]));for(var le=0;le<Q.childNodes.length;le++){var oe=Q.childNodes[le];switch(oe.nodeName){case"offsetU":case"offsetV":case"repeatU":case"repeatV":this.texOpts[oe.nodeName]=parseFloat(oe.textContent);break;case"wrapU":case"wrapV":oe.textContent.toUpperCase()==="TRUE"?this.texOpts[oe.nodeName]=1:this.texOpts[oe.nodeName]=parseInt(oe.textContent);break;default:this.texOpts[oe.nodeName]=oe.textContent;break}}return this};function Ft(Q,le){this.type=Q,this.effect=le,this.material=null}Ft.prototype.parse=function(Q){for(var le=0;le<Q.childNodes.length;le++){var oe=Q.childNodes[le];if(oe.nodeType==1)switch(oe.nodeName){case"emission":case"diffuse":case"specular":case"transparent":this[oe.nodeName]=new Xt().parse(oe);break;case"bump":var ve=oe.getAttribute("bumptype");ve?ve.toLowerCase()==="heightfield"?this.bump=new Xt().parse(oe):ve.toLowerCase()==="normalmap"?this.normal=new Xt().parse(oe):(console.error("Shader.prototype.parse: Invalid value for attribute 'bumptype' ("+ve+") - valid bumptypes are 'HEIGHTFIELD' and 'NORMALMAP' - defaulting to 'HEIGHTFIELD'"),this.bump=new Xt().parse(oe)):(console.warn("Shader.prototype.parse: Attribute 'bumptype' missing from bump node - defaulting to 'HEIGHTFIELD'"),this.bump=new Xt().parse(oe));break;case"shininess":case"reflectivity":case"index_of_refraction":case"transparency":var ke=oe.querySelectorAll("float");ke.length>0&&(this[oe.nodeName]=parseFloat(ke[0].textContent));break}}return this.create(),this},Ft.prototype.create=function(){var Q={},le=!1;if(this.transparency!==void 0&&this.transparent!==void 0){this.transparent;var oe=(this.transparent.color.r+this.transparent.color.g+this.transparent.color.b)/3*this.transparency;oe>0&&(le=!0,Q.transparent=!0,Q.opacity=1-oe)}var ve={diffuse:"map",ambient:"lightMap",specular:"specularMap",emission:"emissionMap",bump:"bumpMap",normal:"normalMap"};for(var ke in this)switch(ke){case"ambient":case"emission":case"diffuse":case"specular":case"bump":case"normal":var Oe=this[ke];if(Oe instanceof Xt)if(Oe.isTexture()){var Je=Oe.texture,mt=this.effect.sampler[Je];if(mt!==void 0&&mt.source!==void 0){var vt=this.effect.surface[mt.source];if(vt!==void 0){var ct=c[vt.init_from];if(ct){var It=A+ct.init_from,Ht,qi=THREE.Loader.Handlers.get(It);qi!==null?Ht=qi.load(It):(Ht=new THREE.Texture,Xi(Ht,It)),Ht.wrapS=Oe.texOpts.wrapU?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,Ht.wrapT=Oe.texOpts.wrapV?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,Ht.offset.x=Oe.texOpts.offsetU,Ht.offset.y=Oe.texOpts.offsetV,Ht.repeat.x=Oe.texOpts.repeatU,Ht.repeat.y=Oe.texOpts.repeatV,Q[ve[ke]]=Ht,ke==="emission"&&(Q.emissive=16777215)}}}}else(ke==="diffuse"||!le)&&(ke==="emission"?Q.emissive=Oe.color.getHex():Q[ke]=Oe.color.getHex());break;case"shininess":Q[ke]=this[ke];break;case"reflectivity":Q[ke]=this[ke],Q[ke]>0&&(Q.envMap=L.defaultEnvMap),Q.combine=THREE.MixOperation;break;case"index_of_refraction":Q.refractionRatio=this[ke],this[ke]!==1&&(Q.envMap=L.defaultEnvMap);break}switch(Q.shading=D,Q.side=this.effect.doubleSided?THREE.DoubleSide:THREE.FrontSide,this.type){case"constant":Q.emissive!=null&&(Q.color=Q.emissive),this.material=new THREE.MeshBasicMaterial(Q);break;case"phong":case"blinn":Q.diffuse!=null&&(Q.color=Q.diffuse),this.material=new THREE.MeshPhongMaterial(Q);break;case"lambert":default:Q.diffuse!=null&&(Q.color=Q.diffuse),this.material=new THREE.MeshLambertMaterial(Q);break}return this.material};function gi(Q){this.effect=Q,this.init_from=null,this.format=null}gi.prototype.parse=function(Q){for(var le=0;le<Q.childNodes.length;le++){var oe=Q.childNodes[le];if(oe.nodeType==1)switch(oe.nodeName){case"init_from":this.init_from=oe.textContent;break;case"format":this.format=oe.textContent;break;default:console.log("unhandled Surface prop: "+oe.nodeName);break}}return this};function Rt(Q){this.effect=Q,this.source=null,this.wrap_s=null,this.wrap_t=null,this.minfilter=null,this.magfilter=null,this.mipfilter=null}Rt.prototype.parse=function(Q){for(var le=0;le<Q.childNodes.length;le++){var oe=Q.childNodes[le];if(oe.nodeType==1)switch(oe.nodeName){case"source":this.source=oe.textContent;break;case"minfilter":this.minfilter=oe.textContent;break;case"magfilter":this.magfilter=oe.textContent;break;case"mipfilter":this.mipfilter=oe.textContent;break;case"wrap_s":this.wrap_s=oe.textContent;break;case"wrap_t":this.wrap_t=oe.textContent;break;default:console.log("unhandled Sampler2D prop: "+oe.nodeName);break}}return this};function ci(){this.id="",this.name="",this.shader=null,this.surface={},this.sampler={}}ci.prototype.create=function(){if(this.shader===null)return null},ci.prototype.parse=function(Q){this.id=Q.getAttribute("id"),this.name=Q.getAttribute("name"),xr(this,Q),this.shader=null;for(var le=0;le<Q.childNodes.length;le++){var oe=Q.childNodes[le];if(oe.nodeType==1)switch(oe.nodeName){case"profile_COMMON":this.parseTechnique(this.parseProfileCOMMON(oe));break}}return this},ci.prototype.parseNewparam=function(Q){for(var le=Q.getAttribute("sid"),oe=0;oe<Q.childNodes.length;oe++){var ve=Q.childNodes[oe];if(ve.nodeType==1)switch(ve.nodeName){case"surface":this.surface[le]=new gi(this).parse(ve);break;case"sampler2D":this.sampler[le]=new Rt(this).parse(ve);break;case"extra":break;default:console.log(ve.nodeName);break}}},ci.prototype.parseProfileCOMMON=function(Q){for(var le,oe=0;oe<Q.childNodes.length;oe++){var ve=Q.childNodes[oe];if(ve.nodeType==1)switch(ve.nodeName){case"profile_COMMON":this.parseProfileCOMMON(ve);break;case"technique":le=ve;break;case"newparam":this.parseNewparam(ve);break;case"image":var ke=new Ge().parse(ve);c[ke.id]=ke;break;case"extra":break;default:console.log(ve.nodeName);break}}return le},ci.prototype.parseTechnique=function(Q){for(var le=0;le<Q.childNodes.length;le++){var oe=Q.childNodes[le];if(oe.nodeType==1)switch(oe.nodeName){case"constant":case"lambert":case"blinn":case"phong":this.shader=new Ft(oe.nodeName,this).parse(oe);break;case"extra":this.parseExtra(oe);break}}},ci.prototype.parseExtra=function(Q){for(var le=0;le<Q.childNodes.length;le++){var oe=Q.childNodes[le];if(oe.nodeType==1)switch(oe.nodeName){case"technique":this.parseExtraTechnique(oe);break}}},ci.prototype.parseExtraTechnique=function(Q){for(var le=0;le<Q.childNodes.length;le++){var oe=Q.childNodes[le];if(oe.nodeType==1)switch(oe.nodeName){case"bump":this.shader.parse(Q);break}}};function ji(){this.url=""}ji.prototype.parse=function(Q){return this.url=Q.getAttribute("url").replace(/^#/,""),this};function Ji(){this.id="",this.name="",this.source={},this.sampler=[],this.channel=[]}Ji.prototype.parse=function(Q){this.id=Q.getAttribute("id"),this.name=Q.getAttribute("name"),this.source={};for(var le=0;le<Q.childNodes.length;le++){var oe=Q.childNodes[le];if(oe.nodeType==1)switch(oe.nodeName){case"animation":var ve=new Ji().parse(oe);for(var Oe in ve.source)this.source[Oe]=ve.source[Oe];for(var ke=0;ke<ve.channel.length;ke++)this.channel.push(ve.channel[ke]),this.sampler.push(ve.sampler[ke]);break;case"source":var Oe=new _t().parse(oe);this.source[Oe.id]=Oe;break;case"sampler":this.sampler.push(new Jn(this).parse(oe));break;case"channel":this.channel.push(new ws(this).parse(oe));break}}return this};function ws(Q){this.animation=Q,this.source="",this.target="",this.fullSid=null,this.sid=null,this.dotSyntax=null,this.arrSyntax=null,this.arrIndices=null,this.member=null}ws.prototype.parse=function(Q){this.source=Q.getAttribute("source").replace(/^#/,""),this.target=Q.getAttribute("target");var le=this.target.split("/");le.shift();var oe=le.shift(),ve=oe.indexOf(".")>=0,ke=oe.indexOf("(")>=0;if(ve)le=oe.split("."),this.sid=le.shift(),this.member=le.shift();else if(ke){var Oe=oe.split("(");this.sid=Oe.shift();for(var Je=0;Je<Oe.length;Je++)Oe[Je]=parseInt(Oe[Je].replace(/\)/,""));this.arrIndices=Oe}else this.sid=oe;return this.fullSid=oe,this.dotSyntax=ve,this.arrSyntax=ke,this};function Jn(Q){this.id="",this.animation=Q,this.inputs=[],this.input=null,this.output=null,this.strideOut=null,this.interpolation=null,this.startTime=null,this.endTime=null,this.duration=0}Jn.prototype.parse=function(Q){this.id=Q.getAttribute("id"),this.inputs=[];for(var le=0;le<Q.childNodes.length;le++){var oe=Q.childNodes[le];if(oe.nodeType==1)switch(oe.nodeName){case"input":this.inputs.push(new Ee().parse(oe));break}}return this},Jn.prototype.create=function(){for(var Q=0;Q<this.inputs.length;Q++){var le=this.inputs[Q],oe=this.animation.source[le.source];switch(le.semantic){case"INPUT":this.input=oe.read();break;case"OUTPUT":this.output=oe.read(),this.strideOut=oe.accessor.stride;break;case"INTERPOLATION":this.interpolation=oe.read();break;case"IN_TANGENT":break;case"OUT_TANGENT":break;default:console.log(le.semantic);break}}if(this.startTime=0,this.endTime=0,this.duration=0,this.input.length){this.startTime=1e8,this.endTime=-1e8;for(var Q=0;Q<this.input.length;Q++)this.startTime=Math.min(this.startTime,this.input[Q]),this.endTime=Math.max(this.endTime,this.input[Q]);this.duration=this.endTime-this.startTime}},Jn.prototype.getData=function(Q,le,oe){var ve;if(Q==="matrix"&&this.strideOut===16)ve=this.output[le];else if(this.strideOut>1){ve=[],le*=this.strideOut;for(var ke=0;ke<this.strideOut;++ke)ve[ke]=this.output[le+ke];this.strideOut===3||this.strideOut===4&&Q==="matrix"&&void 0}else ve=this.output[le],oe&&Q==="translate"&&(ve=Ki(oe,ve));return ve};function ao(Q){this.targets=[],this.time=Q}ao.prototype.addTarget=function(Q,le,oe,ve){this.targets.push({sid:Q,member:oe,transform:le,data:ve})},ao.prototype.apply=function(Q){for(var le=0;le<this.targets.length;++le){var oe=this.targets[le];(!Q||oe.sid===Q)&&oe.transform.update(oe.data,oe.member)}},ao.prototype.getTarget=function(Q){for(var le=0;le<this.targets.length;++le)if(this.targets[le].sid===Q)return this.targets[le];return null},ao.prototype.hasTarget=function(Q){for(var le=0;le<this.targets.length;++le)if(this.targets[le].sid===Q)return!0;return!1},ao.prototype.interpolate=function(Q,le){for(var oe=0,ve=this.targets.length;oe<ve;oe++){var ke=this.targets[oe],Oe=Q.getTarget(ke.sid),Je;if(ke.transform.type!=="matrix"&&Oe){var mt=(le-this.time)/(Q.time-this.time),vt=Oe.data,ct=ke.data;if(mt<0&&(mt=0),mt>1&&(mt=1),ct.length){Je=[];for(var It=0;It<ct.length;++It)Je[It]=ct[It]+(vt[It]-ct[It])*mt}else Je=ct+(vt-ct)*mt}else Je=ke.data;ke.transform.update(Je,ke.member)}};function oo(){this.id="",this.name="",this.technique=""}oo.prototype.parse=function(Q){this.id=Q.getAttribute("id"),this.name=Q.getAttribute("name");for(var le=0;le<Q.childNodes.length;le++){var oe=Q.childNodes[le];if(oe.nodeType==1)switch(oe.nodeName){case"optics":this.parseOptics(oe);break}}return this},oo.prototype.parseOptics=function(Q){for(var le=0;le<Q.childNodes.length;le++)if(Q.childNodes[le].nodeName==="technique_common"){for(var oe=Q.childNodes[le],ve=0;ve<oe.childNodes.length;ve++)if(this.technique=oe.childNodes[ve].nodeName,this.technique==="perspective")for(var ke=oe.childNodes[ve],Oe=0;Oe<ke.childNodes.length;Oe++){var Je=ke.childNodes[Oe];switch(Je.nodeName){case"yfov":this.yfov=Je.textContent;break;case"xfov":this.xfov=Je.textContent;break;case"znear":this.znear=Je.textContent;break;case"zfar":this.zfar=Je.textContent;break;case"aspect_ratio":this.aspect_ratio=Je.textContent;break}}else if(this.technique==="orthographic")for(var mt=oe.childNodes[ve],Oe=0;Oe<mt.childNodes.length;Oe++){var Je=mt.childNodes[Oe];switch(Je.nodeName){case"xmag":this.xmag=Je.textContent;break;case"ymag":this.ymag=Je.textContent;break;case"znear":this.znear=Je.textContent;break;case"zfar":this.zfar=Je.textContent;break;case"aspect_ratio":this.aspect_ratio=Je.textContent;break}}}return this};function lo(){this.url=""}lo.prototype.parse=function(Q){return this.url=Q.getAttribute("url").replace(/^#/,""),this};function uo(){this.id="",this.name="",this.technique=""}uo.prototype.parse=function(Q){this.id=Q.getAttribute("id"),this.name=Q.getAttribute("name");for(var le=0;le<Q.childNodes.length;le++){var oe=Q.childNodes[le];if(oe.nodeType==1)switch(oe.nodeName){case"technique_common":this.parseCommon(oe);break;case"technique":this.parseTechnique(oe);break}}return this},uo.prototype.parseCommon=function(Q){for(var le=0;le<Q.childNodes.length;le++)switch(Q.childNodes[le].nodeName){case"directional":case"point":case"spot":case"ambient":this.technique=Q.childNodes[le].nodeName;for(var oe=Q.childNodes[le],ve=0;ve<oe.childNodes.length;ve++){var ke=oe.childNodes[ve];switch(ke.nodeName){case"color":var Oe=qe(ke.textContent);this.color=new THREE.Color(0),this.color.setRGB(Oe[0],Oe[1],Oe[2]),this.color.a=Oe[3];break;case"falloff_angle":this.falloff_angle=parseFloat(ke.textContent);break;case"quadratic_attenuation":var Je=parseFloat(ke.textContent);this.distance=Je?Math.sqrt(1/Je):0}}}return this},uo.prototype.parseTechnique=function(Q){this.profile=Q.getAttribute("profile");for(var le=0;le<Q.childNodes.length;le++){var oe=Q.childNodes[le];switch(oe.nodeName){case"intensity":this.intensity=parseFloat(oe.textContent);break}}return this};function vu(){this.url=""}vu.prototype.parse=function(Q){return this.url=Q.getAttribute("url").replace(/^#/,""),this};function yu(){this.id="",this.name="",this.joints=[],this.links=[]}yu.prototype.parse=function(Q){this.id=Q.getAttribute("id"),this.name=Q.getAttribute("name"),this.joints=[],this.links=[];for(var le=0;le<Q.childNodes.length;le++){var oe=Q.childNodes[le];if(oe.nodeType==1)switch(oe.nodeName){case"technique_common":this.parseCommon(oe);break}}return this},yu.prototype.parseCommon=function(Q){for(var le=0;le<Q.childNodes.length;le++){var oe=Q.childNodes[le];if(oe.nodeType==1)switch(Q.childNodes[le].nodeName){case"joint":this.joints.push(new Ls().parse(oe));break;case"link":this.links.push(new _u().parse(oe));break}}return this};function Ls(){this.sid="",this.name="",this.axis=new THREE.Vector3,this.limits={min:0,max:0},this.type="",this.static=!1,this.zeroPosition=0,this.middlePosition=0}Ls.prototype.parse=function(Q){this.sid=Q.getAttribute("sid"),this.name=Q.getAttribute("name"),this.axis=new THREE.Vector3,this.limits={min:0,max:0},this.type="",this.static=!1,this.zeroPosition=0,this.middlePosition=0;var le=Q.querySelector("axis"),oe=qe(le.textContent);this.axis=tn(oe,0);var ve=Q.querySelector("limits min")?parseFloat(Q.querySelector("limits min").textContent):-360,ke=Q.querySelector("limits max")?parseFloat(Q.querySelector("limits max").textContent):360;this.limits={min:ve,max:ke};for(var Oe=["prismatic","revolute"],Je=0;Je<Oe.length;Je++){var mt=Oe[Je],vt=Q.querySelector(mt);vt&&(this.type=mt)}return this.limits.min>=this.limits.max&&(this.static=!0),this.middlePosition=(this.limits.min+this.limits.max)/2,this};function _u(){this.sid="",this.name="",this.transforms=[],this.attachments=[]}_u.prototype.parse=function(Q){this.sid=Q.getAttribute("sid"),this.name=Q.getAttribute("name"),this.transforms=[],this.attachments=[];for(var le=0;le<Q.childNodes.length;le++){var oe=Q.childNodes[le];if(oe.nodeType==1)switch(oe.nodeName){case"attachment_full":this.attachments.push(new ye().parse(oe));break;case"rotate":case"translate":case"matrix":this.transforms.push(new Pt().parse(oe));break}}return this};function ye(){this.joint="",this.transforms=[],this.links=[]}ye.prototype.parse=function(Q){this.joint=Q.getAttribute("joint").split("/").pop(),this.links=[];for(var le=0;le<Q.childNodes.length;le++){var oe=Q.childNodes[le];if(oe.nodeType==1)switch(oe.nodeName){case"link":this.links.push(new _u().parse(oe));break;case"rotate":case"translate":case"matrix":this.transforms.push(new Pt().parse(oe));break}}return this};function je(Q){var le=Q.getAttribute("id");return l[le]!=null||(l[le]=new _t(le).parse(Q)),l[le]}function tt(Q){for(var le=si(Q),oe=[],ve=0,ke=le.length;ve<ke;ve++)oe.push(le[ve]==="true"||le[ve]==="1");return oe}function qe(Q){for(var le=si(Q),oe=[],ve=0,ke=le.length;ve<ke;ve++)oe.push(parseFloat(le[ve]));return oe}function st(Q){for(var le=si(Q),oe=[],ve=0,ke=le.length;ve<ke;ve++)oe.push(parseInt(le[ve],10));return oe}function si(Q){return Q.length>0?Ci(Q).split(/\s+/):[]}function Ci(Q){return Q.replace(/^\s+/,"").replace(/\s+$/,"")}function yi(Q,le,oe){return Q.hasAttribute(le)?parseInt(Q.getAttribute(le),10):oe}function Xi(Q,le){R=new THREE.ImageLoader,R.load(le,function(oe){Q.image=oe,Q.needsUpdate=!0})}function xr(Q,le){Q.doubleSided=!1;var oe=le.querySelectorAll("extra double_sided")[0];oe&&oe&&parseInt(oe.textContent,10)===1&&(Q.doubleSided=!0)}function Yi(Q,le){}function Ki(Q,le){return le}function tn(Q,le){var oe=[Q[le],Q[le+1],Q[le+2]];return new THREE.Vector3(oe[0],oe[1],oe[2])}function Us(Q){return new THREE.Matrix4().set(Q[0],Q[1],Q[2],Q[3],Q[4],Q[5],Q[6],Q[7],Q[8],Q[9],Q[10],Q[11],Q[12],Q[13],Q[14],Q[15])}function co(Q){if(Q>-1&&Q<3){var le=["X","Y","Z"],oe={X:0,Y:1,Z:2};Q=le[Q],Q=oe[Q]}return Q}function Po(Q){return Q}return{load:U,parse:F,setPreferredShading:z,applySkin:ee,geometries:f,options:L}},Ghe=(i,e,t,r)=>new Promise((n,l)=>{let c=new i.Object3D,h=new i.Group,d=f=>{let m=f.textures[0].data,g=new i.Texture,y=new Blob([m],{type:"image/png"});createImageBitmap(y).then(function(_){g.image=_,g.needsUpdate=!0}),new jhe().load(f.data,_=>{var b,S,E,T;console.log("collada loaded",_);let A=(S=(b=_.scene.children[0].children[0])==null?void 0:b.children[1])==null?void 0:S.children[0];if(A){A.rotation.set(0,3.14,0);let O=A.material;O.map=g}let P=(T=(E=_.scene.children[0].children[0])==null?void 0:E.children[2])==null?void 0:T.children[0];if(P){P.rotation.set(0,3.14,0);let O=P.material;if(!O)return;O.map=g,O.transparent=!0}h.add(_.scene),h.scale.set(t,t,t),h.position.set(0,r,0),c.add(h),n(c)})};new Whe().parse(e,d,{upAxis:"Y_UP",unitName:"meter",unitMeter:1})}),qhe=class{constructor(e,t,r){this.target=new Te(0,0,0),this.position=new Te(0,0,0),this.curPosition=new Te(0,0,0),this.quaternion=new Xl(0,0,0,0),this.load=function(){return Ts(this,null,function*(){let n=new dhe;return new Promise((l,c)=>{n.load(this.url,h=>Ts(this,null,function*(){if(this.model=yield Ghe(THREE,h.scene,this.scale,this.height),!this.model)throw new Error("error creating avatar in forge");l(this.model)}),h=>{console.log(`${h.loaded/h.total*100} % loaded`)},h=>{console.error("An error happened loading the avatar",h),c(h)})})})},this.url=e,this.scale=t,this.height=r,this.clock=new Qz,this.clock.start(),this.lerpAnimationFrame=requestAnimationFrame(this.animate.bind(this))}setPosition(e){!e||e.x===0&&e.y===0&&e.z===0||this.position.set(e.x,e.y,e.z)}setQuaternion(e){!e||this.quaternion.set(e._x,e._y,e._z,e._w)}destroy(){cancelAnimationFrame(this.lerpAnimationFrame),this.model.parent.remove(this.model)}animate(){if(this.lerpAnimationFrame=requestAnimationFrame(this.animate.bind(this)),!this.model||!this.position||!this.quaternion)return;let e=this.clock.getDelta(),t=2*e;this.curPosition.lerp(this.position,t),this.model.position.set(this.curPosition.x,this.curPosition.y,this.curPosition.z);let r=this.model.quaternion.clone();r.slerp(this.quaternion,t),this.model.quaternion.set(r.x,r.y,r.z,r.w)}},BA=(i=>(i[i["#31E0B0"]=0]="#31E0B0",i[i["#FF5E10"]=1]="#FF5E10",i[i["#00ABF7"]=2]="#00ABF7",i[i["#FF00BB"]=3]="#FF00BB",i[i["#9C29FF"]=4]="#9C29FF",i[i["#6FDD00"]=5]="#6FDD00",i[i["#E30000"]=6]="#E30000",i[i["#304AFF"]=7]="#304AFF",i[i["#FF89C4"]=8]="#FF89C4",i[i["#D597FF"]=9]="#D597FF",i[i["#C6EC5C"]=10]="#C6EC5C",i[i["#FFA115"]=11]="#FFA115",i[i["#75DEFE"]=12]="#75DEFE",i[i["#FAA291"]=13]="#FAA291",i[i["#BB813F"]=14]="#BB813F",i[i["#F4CE00"]=15]="#F4CE00",i[i["#878291"]=16]="#878291",i))(BA||{}),bF=["#000000","#FFFFFF","#000000","#FFFFFF","#FFFFFF","#000000","#FFFFFF","#FFFFFF","#000000","#000000","#000000","#000000","#000000","#000000","#FFFFFF","#000000","#FFFFFF"],Xhe=class{constructor(e,t,r,n){if(this.load=()=>Ts(this,null,function*(){return new Promise(l=>{let c=document.createElement("script");window._typeface_js={faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace},c.setAttribute("src","https://production.storage.superviz.com/static/fonts/OpenSans.js"),c.onload=()=>Ts(this,null,function*(){let h=yield this.createTextGeometry(this.name,this.textColor);h.position.set(0,this.height,0),this.mesh=h,this.renderFrame=requestAnimationFrame(this.render.bind(this)),l(h)}),document.body.appendChild(c)})}),this.createTextGeometry=(l,c)=>Ts(this,null,function*(){let h=new THREE.TextGeometry(l,{font:"open sans",size:.08,height:0,curveSegments:3});h.computeBoundingBox();let d=new THREE.MeshBasicMaterial({color:c}),f=new THREE.Mesh(h,d);return f.geometry.center(),this.createBackground(f,this.backgroundColor),f}),this.createBackground=(l,c)=>Ts(this,null,function*(){let h=new THREE.Box3().setFromObject(l),d=new THREE.Vector3(0,0,0);h.getSize(d);let{x:f,y:m}=d,g=.12,y=.06,_=-(f/2+g/2),b=-(m/2+y/2)-.002,S=f+g,E=m+y,T=.078,A=new fE;A.moveTo(_,b+T),A.lineTo(_,b+E-T),A.quadraticCurveTo(_,b+E,_+T,b+E),A.lineTo(_+S-T,b+E),A.quadraticCurveTo(_+S,b+E,_+S,b+E-T),A.lineTo(_+S,b+T),A.quadraticCurveTo(_+S,b,_+S-T,b),A.lineTo(_+T,b),A.quadraticCurveTo(_,b,_,b+T);let P=new THREE.ShapeGeometry(A),O=new THREE.MeshBasicMaterial({color:c,side:THREE.DoubleSide}),R=new THREE.Mesh(P,O);l.add(R),R.position.set(0,0,-.01)}),this.name=e,this.viewer=n,t)this.backgroundColor=BA[t],this.textColor=bF[t];else{let l=BA[0];this.textColor=bF[0],this.backgroundColor=l}this.height=r,this.slot=t}render(){if(this.renderFrame=requestAnimationFrame(this.render.bind(this)),this.viewer&&this.mesh){let e=this.viewer.getCamera();this.curQuaternion=this.mesh.parent.quaternion.clone().invert().multiply(e.quaternion.clone()),this.mesh.setRotationFromQuaternion(this.curQuaternion)}}destroy(){cancelAnimationFrame(this.renderFrame)}},Zhe=class{constructor(e,t,r){this.position=new THREE.Vector3(0,0,0),this.quaternion=new THREE.Quaternion(0,0,0,0),this.mousePosition=new THREE.Vector3(0,0,0),this.lerpedMousePosition=new THREE.Vector3(0,0,0),this.colorIndex=0,this.material=new THREE.MeshBasicMaterial,this.viewer=e,this.laserOrigin=r,this.clock=new Qz,this.clock.start(),this.isDestroyed=!1,this.lerpAnimationFrame=requestAnimationFrame(this.animate.bind(this)),this.generateMaterial(t)}destroy(){this.isDestroyed=!0,cancelAnimationFrame(this.lerpAnimationFrame),this.mesh&&(this.viewer.overlays.removeMesh(this.mesh,"avatars-scene"),this.mesh.geometry.dispose(),this.mesh=null)}setAvatar(e){!e||(this.avatar=e)}setMousePosition(e){!e||this.mousePosition.set(e.x,e.y,e.z)}setColorIndex(e){e!==this.colorIndex&&e!==void 0&&(this.generateMaterial(e),this.colorIndex=e)}animate(){let e=this.clock.getDelta();if(setTimeout(()=>{this.isDestroyed||(this.lerpAnimationFrame=requestAnimationFrame(this.animate.bind(this)))},1e3/20),!this.avatar||(this.mesh&&(this.mesh.geometry.dispose(),this.viewer.overlays.removeMesh(this.mesh,"avatars-scene")),this.position=this.avatar.model.position,this.quaternion=this.avatar.model.quaternion,!this.position||!this.mousePosition||!this.quaternion||!this.material))return;let t=new THREE.Vector3(this.position.x,this.position.y,this.position.z),r=new THREE.Vector3(this.laserOrigin.x,this.laserOrigin.y,this.laserOrigin.z).applyQuaternion(new THREE.Quaternion(this.quaternion.x,this.quaternion.y,this.quaternion.z,this.quaternion.w));t.add(r.multiplyScalar(1)),this.lerpedMousePosition.lerp(this.mousePosition,e/1e3*1e3);let l=new THREE.LineCurve3(t,new THREE.Vector3(this.lerpedMousePosition.x,this.lerpedMousePosition.y,this.lerpedMousePosition.z)),c=.005,h=new THREE.TubeGeometry(l,3,c,4,!1);this.mesh=new THREE.Mesh(h,this.material),this.viewer.overlays.hasScene("avatars-scene")&&this.viewer.overlays.addMesh(this.mesh,"avatars-scene")}createTextureCanvas(){let e=document.createElement("canvas"),t=e.getContext("2d");e.width=1,e.height=64;let r=t.createLinearGradient(0,0,e.width,e.height);return r.addColorStop(0,"rgba(  0,  0,  0,0.2)"),r.addColorStop(.1,"rgba(160,160,160,0.5)"),r.addColorStop(.5,"rgba(255,255,255,0.8)"),r.addColorStop(.9,"rgba(160,160,160,0.5)"),r.addColorStop(1,"rgba(  0,  0,  0,0.2)"),t.fillStyle=r,t.fillRect(0,0,e.width,e.height),e}generateMaterial(e){let t=BA[e],r=this.createTextureCanvas(),n=new THREE.Texture(r);n.needsUpdate=!0,this.material=new THREE.MeshBasicMaterial({map:n,blending:THREE.AdditiveBlending,color:t,side:THREE.DoubleSide,depthWrite:!1,transparent:!1})}},E$=(i,e)=>{let t=i.x-e.x,r=i.y-e.y,n=i.z-e.z;return Math.sqrt(t*t+r*r+n*n)},Jhe=class{constructor(e,t){this.destPos=new THREE.Vector3(0,0,0),this.curScreenPos=new THREE.Vector2(0,0),this.colorIndex=0,this.update=(r,n=0)=>{n!==void 0&&(this.colorIndex=n),!(!r||r.x===0&&r.y===0&&r.z===0)&&(this.destPos.x=r.x,this.destPos.y=r.y,this.destPos.z=r.z)},this.clock=new Qz,this.viewer=e,this.userId=t,this.renderFrame=requestAnimationFrame(this.render.bind(this)),this.renderDivWrapper()}load(e,t){return Ts(this,null,function*(){if(!(!e||t===void 0))return new Promise(()=>{let r=`https://production.storage.superviz.com/static/pointers-v2/${t}.svg`,n=document.createElement("div");n.setAttribute("id",`mouse_${this.userId}`),n.setAttribute("style",`background-image:url('${r}')`),n.style.position="absolute",n.style.zIndex="3",n.style.width="15px",n.style.height="15px",n.style.pointerEvents="none",n.style.transition="all 75ms ease",n.style.top="-100px",n.style.left="-100px",this.mousesWrapper.appendChild(n);let l=document.createElement("div");if(!e.trim().length)return;let c=BA[t];l.setAttribute("style",`background-color:${c}`),l.style.borderRadius="30px",l.style.fontSize="14px",l.style.fontWeight="700",l.style.zIndex="3",l.style.fontWeight="600",l.style.fontFamily="Open Sans",l.style.width="fit-content",l.style.whiteSpace="nowrap",l.innerHTML+=e,l.style.marginLeft="12px",l.style.marginTop="9px",l.style.pointerEvents="none",l.style.color=bF[t].toString(),l.style.padding="2px 8px 2px 8px",n.appendChild(l)})})}destroy(){cancelAnimationFrame(this.renderFrame),document.getElementById(`mouse_${this.userId}`).remove()}render(){return Ts(this,null,function*(){if(this.renderDivWrapper(),this.renderFrame=requestAnimationFrame(this.render.bind(this)),this.destPos.x===0&&this.destPos.y===0)return;let e=this.clock.getDelta(),t=2e3,r=this.viewer.worldToClient(this.destPos),n=1,l=this.viewer.utilities.getHitPoint(r.x/this.mousesWrapper.clientWidth,r.y/this.mousesWrapper.clientHeight);if(l){let c=this.viewer.navigation.getPosition(),h=E$(l,c),d=E$(this.destPos,c);Math.abs(d-h)>1&&(n=.2)}if(r){this.curScreenPos.lerp(r,e/100*t);let c=this.curScreenPos.y,h=this.curScreenPos.x;c===0&&h===0&&(n=0);let d=document.getElementById(`mouse_${this.userId}`);d?(d.style.top=`${c}px`,d.style.left=`${h}px`,d.style.opacity=`${n}`):console.warn("no mouse element")}})}renderDivWrapper(){let e=this.viewer.canvas.getBoundingClientRect(),t=document.getElementById("superviz-autodesk-mouse-wrapper");t||(t=document.createElement("div"),t.id="superviz-autodesk-mouse-wrapper"),t.style.position="absolute",t.style.top=`${this.viewer.canvas.offsetTop}px`,t.style.left=`${this.viewer.canvas.offsetLeft}px`,t.style.width=`${e.width}px`,t.style.height=`${e.height}px`,t.style.pointerEvents="none",t.style.overflow="hidden",this.viewer.canvas.parentElement.style.position==="static"&&(this.viewer.canvas.parentElement.style.position="relative"),document.getElementById("superviz-autodesk-mouse-wrapper")||this.viewer.canvas.parentElement.appendChild(t),this.mousesWrapper=t}},Yhe=$I(U8()),Cq=class{constructor(e){this.debug=(0,Yhe.default)(e)}log(e,...t){this.debug(e,...t)}},Khe=$I(Sie()),Qhe=class{constructor(e={}){this.subscribe=n=>{this.callbacks.push(n)},this.unsubscribe=n=>{this.callbacks=this.callbacks.filter(l=>l!==n)},this.publish=(...n)=>{!this.callbacks||this.callbacks.forEach(l=>{this.callListener(l,n).catch(c=>{this.logger.log("superviz-sdk:observer-helper:publish:error",`
            Failed to execute callback on publish value.
            Callback: ${l}
            Event: ${JSON.stringify(n)}
            Error: ${c}
          `)})})},this.reset=()=>{this.callbacks=[]},this.destroy=()=>{delete this.logger,delete this.callbacks},this.callListener=(n,l)=>new Promise((c,h)=>{try{let d=n(...l);c(d)}catch(d){h(d)}});let{logger:t,throttleTime:r}=e;this.logger=t??new Cq("@superviz/sdk/observer-helper"),this.throttle=r,this.callbacks=[],this.throttle&&(this.publish=(0,Khe.default)(this.publish,this.throttle))}},ede=class{constructor(e){this.isPinsVisible=!0,this.commentsSide="left",this.localParticipant={},this.isDragging=!1,this.hasLayerSelected=!1,this.animate=()=>{this.positionWrapper(),this.renderFrame=requestAnimationFrame(this.animate)},this.setCommentsMetadata=(t,r,n)=>{this.commentsSide=t,this.localParticipant.avatar=r,this.localParticipant.name=n},this.onAggregateSelectionChanged=t=>{this.hasLayerSelected=!!t.selections.length,this.renderAnnotationsPins()},this.onCameraMove=()=>{!this.isActive&&!this.isPinsVisible||this.renderAnnotationsPins()},this.annotationSelected=({detail:t})=>{var r,n;let{uuid:l,haltGoToPin:c}=t;if(!l)return;let h=JSON.parse((n=(r=this.selectedPin)==null?void 0:r.getAttribute("annotation"))!=null?n:"{}");if(this.resetPins(),(h==null?void 0:h.uuid)===l)return;document.body.dispatchEvent(new CustomEvent("close-temporary-annotation"));let d=this.pins.get(l);if(!d)return;d.setAttribute("active",""),this.selectedPin=d;let{position:f}=this.annotations.find(m=>m.uuid===l);if(f&&!c){let m=JSON.parse(f);this.onClickedPin(m)}},this.hideTemporaryPin=t=>{var r;let n=t.target;this.viewer.canvas.contains(n)||(r=this.pins.get("temporary-pin"))!=null&&r.contains(n)||this.removeAnnotationPin("temporary-pin")},this.resetPins=t=>{t&&(t==null?void 0:t.key)!=="Escape"||(this.resetSelectedPin(),this.removeAnnotationPin("temporary-pin"),this.temporaryPinCoordinates=null)},this.renderDivWrapper=()=>{let t=this.viewer.canvas.getBoundingClientRect(),r=this.divWrapper;r||(r=document.createElement("div"),r.id="superviz-autodesk-pins-wrapper"),r.style.position="fixed",r.style.top=`${this.viewer.canvas.offsetTop}px`,r.style.left=`${this.viewer.canvas.offsetLeft}px`,r.style.width=`${t.width}px`,r.style.height=`${t.height}px`,r.style.pointerEvents="none",r.style.overflow="hidden",r.style.zIndex="1",document.getElementById("superviz-autodesk-pins-wrapper")||document.body.appendChild(r),this.divWrapper=r},this.distanceBetween=(t,r)=>{let n=t.x-r.x,l=t.y-r.y,c=t.z-r.z;return Math.sqrt(n*n+l*l+c*c)},this.onMouseUp=t=>{if(this.isDragging)return;let r=this.viewer.clientToWorld(t.offsetX,t.offsetY,!1).point;if(r){let n={x:r.x,y:r.y,z:r.z,type:"autodesk"},l=this.viewer.navigation.getCamera();l.updateMatrixWorld();let c=new Te(0,0,0);l.getWorldPosition(c);let h={position:n,camera:c};this.resetSelectedPin(),this.onPinFixedObserver.publish(h),this.createTemporaryPin(n)}},this.onMouseDown=t=>{this.isDragging=!1},this.onMouseMove=t=>{this.isDragging=!0;let{x:r,y:n}=t;this.mouseElement||(this.mouseElement=this.createMouseElement());let l=n-this.pinHeight;this.mouseElement.setAttribute("position",JSON.stringify({x:r,y:l}))},this.onMouseLeave=()=>{this.mouseElement&&(this.mouseElement.remove(),this.mouseElement=null),this.viewer.canvas.style.cursor="default"},this.onMouseEnter=()=>{this.mouseElement||(this.mouseElement=this.createMouseElement())},this.onToggleAnnotationSidebar=({detail:t})=>{let{open:r}=t;r||(this.pins.forEach(n=>{n.removeAttribute("active")}),this.pins.has("temporary-pin")&&this.removeAnnotationPin("temporary-pin"))},this.viewer=e,this.logger=new Cq("@superviz/sdk/comments-component/autodesk-adapter"),this.isActive=!1,this.pins=new Map,this.pinHeight=32,this.viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraMove),this.viewer.addEventListener(Autodesk.Viewing.AGGREGATE_SELECTION_CHANGED_EVENT,this.onAggregateSelectionChanged),document.body.addEventListener("select-annotation",this.annotationSelected),document.body.addEventListener("toggle-annotation-sidebar",this.onToggleAnnotationSidebar),document.body.style.position="relative",this.onPinFixedObserver=new Qhe,this.annotations=[],this.renderAnnotationsPins(),this.showcaseSides=this.viewer.canvas.getBoundingClientRect(),this.renderDivWrapper(),this.renderFrame=requestAnimationFrame(this.animate)}destroy(){this.viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraMove),this.viewer.removeEventListener(Autodesk.Viewing.AGGREGATE_SELECTION_CHANGED_EVENT,this.onAggregateSelectionChanged),document.body.removeEventListener("select-annotation",this.annotationSelected),document.body.removeEventListener("toggle-annotation-sidebar",this.onToggleAnnotationSidebar),this.removeAnnotationsPins(),this.removeListeners(),cancelAnimationFrame(this.renderFrame),this.mouseElement=null}setActive(e){if(this.isActive=e,this.isActive){this.addListeners();return}this.removeListeners()}setPinsVisibility(e){if(this.isPinsVisible=e,this.isPinsVisible){this.renderAnnotationsPins();return}this.removeAnnotationsPins()}positionWrapper(){let e=this.viewer.canvas.getBoundingClientRect();this.divWrapper.style.position="fixed",this.divWrapper.style.top=`${e.top}px`,this.divWrapper.style.left=`${e.left}px`,this.divWrapper.style.width=`${e.width}px`,this.divWrapper.style.height=`${e.height}px`}updateAnnotations(e){this.logger.log("updateAnnotations",e),this.annotations=e,!(!this.isActive&&!this.isPinsVisible)&&(this.removeAnnotationsPins(),this.renderAnnotationsPins())}removeAnnotationPin(e){let t=this.pins.get(e);!t||(t.remove(),this.pins.delete(e),this.annotations=this.annotations.filter(r=>r.uuid!==e))}createTemporaryPin(e){var t,r;let n=document.getElementById("superviz-temporary-pin");this.temporaryPinCoordinates=e,!n&&(n=document.createElement("superviz-comments-annotation-pin"),n.id="superviz-temporary-pin",n.setAttribute("type","add"),n.setAttribute("showInput",""),n.setAttribute("containerSides",JSON.stringify(this.showcaseSides)),n.setAttribute("commentsSide",this.commentsSide),n.setAttribute("localAvatar",(t=this.localParticipant.avatar)!=null?t:""),n.setAttribute("participantsList",JSON.stringify(this.participants)),n.setAttribute("localName",(r=this.localParticipant.name)!=null?r:""),n.setAttribute("position",JSON.stringify(this.temporaryPinCoordinates)),n.setAttribute("annotation",JSON.stringify({})),n.setAttributeNode(document.createAttribute("active")),n.style.pointerEvents="auto");let l=this.position3DToScreen(e,0,this.pinHeight),c={x:l.left,y:l.top,type:e.type};n.setAttribute("position",JSON.stringify(c)),this.divWrapper.appendChild(n),this.pins.set("temporary-pin",n),this.renderAnnotationsPins()}addListeners(){this.viewer.canvas.addEventListener("mouseup",this.onMouseUp),this.viewer.canvas.addEventListener("mousedown",this.onMouseDown),this.viewer.canvas.addEventListener("mousemove",this.onMouseMove),this.viewer.canvas.addEventListener("mouseout",this.onMouseLeave),this.viewer.canvas.addEventListener("mouseenter",this.onMouseEnter),document.body.addEventListener("keyup",this.resetPins),document.body.addEventListener("click",this.hideTemporaryPin)}removeListeners(){this.viewer.canvas.removeEventListener("mouseup",this.onMouseUp),this.viewer.canvas.removeEventListener("mousedown",this.onMouseDown),this.viewer.canvas.removeEventListener("mousemove",this.onMouseMove),this.viewer.canvas.removeEventListener("mouseout",this.onMouseLeave),this.viewer.canvas.removeEventListener("mouseenter",this.onMouseEnter),document.body.removeEventListener("keyup",this.resetPins),document.body.removeEventListener("click",this.hideTemporaryPin)}renderAnnotationsPins(){return Ts(this,null,function*(){if(this.annotations.forEach(e=>Ts(this,null,function*(){let t=JSON.parse(e.position).position;if((t==null?void 0:t.type)!=="autodesk"||e.resolved)return;if(!this.pins.has(e.uuid)){this.createPin(e,t);return}let r=this.position3DToScreen(t,0,this.pinHeight),n=yield this.checkIsVisible(r,t),l=this.pins.get(e.uuid);n?(l.setAttribute("style","opacity: 1"),this.pins.get(e.uuid).setAttribute("position",JSON.stringify({x:r.left,y:r.top}))):l.setAttribute("style","opacity: 0")})),this.pins.get("temporary-pin")){let e=this.position3DToScreen(this.temporaryPinCoordinates,0,this.pinHeight),t=yield this.checkIsVisible(e,this.temporaryPinCoordinates),r=this.pins.get("temporary-pin");t?(r.setAttribute("style","opacity: 1"),r.setAttribute("position",JSON.stringify({x:e.left,y:e.top}))):r.setAttribute("style","opacity: 0")}})}createPin(e,t){let r=this.position3DToScreen(t,0,this.pinHeight),n=document.createElement("superviz-comments-annotation-pin");this.divWrapper.appendChild(n),n.setAttribute("type","show"),n.setAttribute("annotation",JSON.stringify(e)),n.setAttribute("position",JSON.stringify({x:r.left,y:r.top})),n.setAttribute("participantsList",JSON.stringify(this.participants)),n.style.pointerEvents="auto",this.pins.set(e.uuid,n)}onClickedPin(e){let t=e.position,r=this.viewer.navigation.getCamera();r.updateMatrixWorld();let n=new Te(e.camera.x,e.camera.y,e.camera.z),l=new THREE.Vector3(t.x,t.y,t.z),c;l.distanceTo(n)>5?c=n.lerp(l,.6):c=n,this.onPinFixedObserver.publish({x:e.position.x,y:e.position.y,z:e.position.z,type:"autodesk"}),this.viewer.utilities.setPivotPoint(l,!1,!1),this.viewer.utilities.transitionView(c,l,r.fov,r.up,r.worldup,!0,l)}removeAnnotationsPins(){this.pins.forEach(e=>{e.remove()}),this.pins.clear()}resetSelectedPin(){!this.selectedPin||(this.selectedPin.removeAttribute("active"),this.selectedPin=null)}set participantsList(e){this.participants=e}position3DToScreen(e,t,r){let n=this.viewer.worldToClient(e);return{top:n.y-r,left:n.x-t}}checkIsVisible(e,t){return Ts(this,null,function*(){let r=!0,n=this.viewer.clientToWorld(e.left,e.top+this.pinHeight,!1);if(n){let l=n.point,c=this.distanceBetween(l,t),h=Math.abs(c),d=this.hasLayerSelected?8:3;h>d&&(r=!1)}return r})}createMouseElement(){let e=document.createElement("superviz-comments-annotation-pin");return e.setAttribute("type","add"),e.setAttribute("annotation",JSON.stringify({})),e.setAttribute("position",JSON.stringify({x:0,y:0})),document.body.appendChild(e),this.viewer.canvas.style.cursor="none",e}},tde=$I(U8()),ide=class{constructor(e){this.debug=(0,tde.default)(e)}log(e,...t){this.debug(e,...t)}},T$={model3DUrl:"https://production.storage.superviz.com/readyplayerme/1.glb",imageUrl:"https://production.cdn.superviz.com/static/default-avatars/1.png"},rde=class{constructor(i,e){this.participants=[],this.isAttached=!1,this.avatars={},this.lasers={},this.names={},this.mouses={},this.positionInfos={},this.renderSilentInterval=null,this.lastSyncedData={},this.attach=c=>{if(Object.values(c).includes(null)||Object.values(c).includes(void 0)){let m="autodesk-viewer component @ attach - params are required";throw this.logger.log(m),new Error(m)}let{realtime:h,localParticipant:d,eventBus:f}=c;this.realtime=h,this.localParticipant=d,this.isAttached=!0,this.eventBus=f,this.logger.log("attached"),this.start()},this.detach=()=>{if(!this.isAttached){this.logger.log("autodesk-viewer component @ detach - component is not attached}");return}this.logger.log("detached"),this.destroy(),this.realtime=void 0,this.localParticipant=void 0,this.isAttached=!1},this.destroy=()=>{this.unsubscribeToRealtimeEvents(),this.unsubscribeToEventBusEvents(),this.realtime.leavePresence3DChannel(),this.isAttached=!1,this.viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChanged),this.viewer.canvas.removeEventListener("mousemove",this.onMouseMove),clearInterval(this.renderSilentInterval),this.participants.forEach(c=>{this.removeParticipant(c,!0)}),this.avatars={},this.lasers={},this.mouses={},this.positionInfos={},this.realtime=void 0,this.viewer.overlays.clearScene("avatars-scene"),this.viewer.overlays.removeScene("avatars-scene")},this.start=c=>{if(c||this.realtime.enterPresence3DChannel(this.localParticipant),!this.realtime.isJoinedRoom||!this.realtime.isJoinedPresence3D){this.logger.log("autodesk-viewer component @ start - not joined yet"),setTimeout(()=>{this.logger.log("autodesk-viewer component @ start - retrying"),this.start(!0)},1e3);return}this.subscribeToRealtimeEvents(),this.subscribeToEventBusEvents(),this.createParticipantList(),this.renderSilentInterval=window.setInterval(this.renderSilent,1),this.sync()},this.subscribeToRealtimeEvents=()=>{this.logger.log("autodesk-viewer component @ subscribeToRealtimeEvents"),this.realtime.presence3dObserver.subscribe(this.onParticipantsUpdated),this.realtime.presence3dJoinedObserver.subscribe(this.onParticipantJoined),this.realtime.presence3dLeaveObserver.subscribe(this.onParticipantLeave),this.realtime.roomInfoUpdatedObserver.subscribe(this.onRoomInfoUpdate)},this.unsubscribeToRealtimeEvents=()=>{this.logger.log("autodesk-viewer component @ unsubscribeToRealtimeEvents"),this.realtime.presence3dJoinedObserver.unsubscribe(this.onParticipantJoined),this.realtime.presence3dLeaveObserver.unsubscribe(this.onParticipantLeave),this.realtime.presence3dObserver.unsubscribe(this.onParticipantsUpdated),this.realtime.roomInfoUpdatedObserver.unsubscribe(this.onRoomInfoUpdate)},this.subscribeToEventBusEvents=()=>{this.logger.log("autodesk-viewer component @ subscribeToEventBusEvents"),this.eventBus.subscribe("realtime.go-to-participant",this.goTo),this.eventBus.subscribe("realtime.local-follow-participant",this.localFollow),this.eventBus.subscribe("realtime.follow",this.follow),this.eventBus.subscribe("realtime.private-mode",this.setPrivate)},this.unsubscribeToEventBusEvents=()=>{this.logger.log("autodesk-viewer component @ unsubscribeToEventBusEvents"),this.eventBus.unsubscribe("realtime.go-to-participant",this.goTo),this.eventBus.unsubscribe("realtime.local-follow-participant",this.localFollow),this.eventBus.unsubscribe("realtime.follow",this.follow),this.eventBus.unsubscribe("realtime.private-mode",this.setPrivate)},this.onParticipantJoined=c=>{if(!c.data)return;this.logger.log("autodesk-viewer component @ onParticipantJoined",c);let{id:h,name:d,avatar:f,avatarConfig:m,type:g}=c.data;if(h===this.localFollowParticipantId){this.onLocalParticipantJoined(c.data);return}this.addParticipant({id:h,name:d,avatar:f,avatarConfig:m,type:g})},this.onLocalParticipantJoined=c=>{var h,d,f,m;this.config.avatarConfig&&this.realtime.setParticipantData({avatarConfig:this.config.avatarConfig}),(h=c.avatar)!=null&&h.model3DUrl&&this.realtime.setParticipantData({avatar:{model3DUrl:c.avatar.model3DUrl,imageUrl:(d=c.avatar)==null?void 0:d.imageUrl}}),(f=c.avatar)!=null&&f.model3DUrl||this.realtime.setParticipantData({avatar:{model3DUrl:T$.model3DUrl,imageUrl:(m=c.avatar)==null?void 0:m.imageUrl}})},this.onParticipantLeave=c=>{this.logger.log("autodesk-viewer component @ onParticipantLeave",c);let h=this.participants.find(d=>d.id===c.clientId);!h||this.removeParticipant(h,!0)},this.onParticipantUpdated=c=>{var h,d;this.logger.log("autodesk-viewer component @ onParticipantUpdated",c);let{id:f,name:m,avatar:g,avatarConfig:y,position:_,rotation:b,type:S}=(h=c.data)!=null?h:c;this.updateParticipant({position:_,rotation:b,id:f,name:m,avatar:g,avatarConfig:y,type:S}),(this.localFollowParticipantId||this.followParticipantId)&&this.moveToAnotherParticipant((d=this.localFollowParticipantId)!=null?d:this.followParticipantId)},this.updateParticipant=c=>Ts(this,null,function*(){var h,d;if(!this.participants||this.participants.length===0||!c||!c.id)return;let f=this.participants.find(m=>m.id===c.id);if(!f){this.addParticipant(c);return}if(((h=f.avatar)==null?void 0:h.model3DUrl)!==((d=c.avatar)==null?void 0:d.model3DUrl)||!(0,Mie.isEqual)(f.avatarConfig,c.avatarConfig)||f.name!==c.name)this.removeParticipant(c,!0),this.addParticipant(c);else{let m=this.participants.findIndex(g=>g.id===c.id);m!==-1&&(this.participants[m]=c)}this.logger.log("autodesk-viewer component @ updateParticipant",{participant:c,participants:this.participants})}),this.onRoomInfoUpdate=c=>{this.logger.log("autodesk-viewer component @ onRoomInfoUpdate",c);let{gather:h,hostClientId:d,followParticipantId:f}=c;this.followParticipantId=f,h&&this.moveToAnotherParticipant(d),this.realtime.hostClientId===this.localParticipant.id&&h&&this.realtime.setGather(!1)},this.createParticipantList=()=>{let c=this.realtime.getParticipants;Object.values(c).forEach(h=>{let{data:d}=h;this.addParticipant(d)}),this.logger.log("autodesk-viewer component @ createParticipantList",this.participants)},this.createParticipantOn3D=({id:c,name:h,avatar:d,avatarConfig:f,type:m})=>{let g={id:c,name:h,avatar:d,isAudience:m==="audience",avatarConfig:c===this.localParticipantId?this.config.avatarConfig:f,position:{x:0,y:0,z:0},rotation:{x:0,y:0}};return this.logger.log("autodesk-viewer component @ createParticipantOn3D",g),g},this.removeParticipant=(c,h)=>{this.logger.log("autodesk-viewer component @ removeParticipant",{participant:c,unsubscribe:h}),this.participants=this.participants.filter(d=>d.id!==c.id),this.destroyAvatar(c),this.destroyLaser(c),this.destroyMouse(c),h&&this.realtime.unsubscribeFromParticipant3DUpdate(c.id,this.onParticipantUpdated)},this.addParticipant=c=>Ts(this,null,function*(){if(!c||!c.id||c.type==="audience")return;let h=this.createParticipantOn3D(c);if(this.participants.find(d=>d.id===h.id)){this.logger.log("autodesk-viewer component @ addParticipant - participant already exists"),this.onParticipantUpdated(c);return}this.participants.push(h),this.logger.log("autodesk-viewer component @ addParticipant",{participant:c,participantOn3D:h,participants:this.participants}),this.realtime.subscribeToParticipant3DUpdate(h.id,this.onParticipantUpdated),this.create3dPresence(h)}),this.goTo=c=>{this.logger.log("autodesk-viewer component @ goTo",c),this.moveToAnotherParticipant(c)},this.gather=()=>{this.logger.log("autodesk-viewer component @ gather"),this.realtime.setGather(!0)},this.setPrivate=c=>{this.logger.log("autodesk-viewer component @ private mode"),this.realtime.updatePresence3D({id:this.localParticipantId,isPrivate:c})},this.localFollow=c=>{this.localFollowParticipantId=c},this.onCameraChanged=()=>{!this.isAttached||(this.viewer.impl.overlayScenes["avatars-scene"]&&this.viewer.impl.requestSilentRender(),this.sync())},this.renderSilent=()=>{if(this.viewer.impl.overlayScenes["avatars-scene"]){this.viewer.impl.requestSilentRender();let c=!1,h=[];Object.values(this.avatars).forEach(d=>{!(d!=null&&d.model)||this.lastSyncedData.position.distanceTo(d.model.position)<1&&(c=!0,h.push(d))}),c?h.forEach(d=>{!(d!=null&&d.model)||(d.model.visible=!1)}):Object.values(this.avatars).forEach(d=>{!(d!=null&&d.model)||(d.model.visible=!0)})}},this.onParticipantsUpdated=c=>{Object.values(c).forEach(h=>{if(!this.isAttached||h.clientId===this.localParticipantId)return;let d=h.clientId,f=this.avatars[d],m=this.lasers[d],g=this.mouses[d],y=this.realtime.getParticipantSlot(d),{position:_,quaternion:b,target:S,mouse:E,isPrivate:T}=h.data;this.positionInfos[h.clientId]={position:_,quaternion:b,target:S},T&&this.avatars[d]&&this.removeParticipant(h.data,!0),!T&&!this.avatars[d]&&this.addParticipant(h.data),f&&(f.setPosition(_),f.setQuaternion(b),f.target=S),m&&(m.setAvatar(f),m.setMousePosition(E),m.setColorIndex(y)),g&&this.mouses[d].update(E,y)})},this.onMouseMove=c=>{var h;if(!this.viewer||!THREE)return;let d=this.viewer.clientToWorld(c.offsetX,c.offsetY,!1);d!==null&&(this.lastSyncedData.mouse=d.point,(h=this.realtime)==null||h.updatePresence3D(i6({id:this.localParticipantId},this.lastSyncedData)))};var t,r,n,l;if(!i)throw new Error("autodesk viewer instance is required");this.name="presence3dAutodesk",this.logger=new ide("@superviz/sdk/autodesk-viewer-component"),this.logger.log("autodesk-viewer component @ constructor",{viewer:i,options:e}),this.config={isAvatarsEnabled:(t=e==null?void 0:e.isAvatarsEnabled)!=null?t:!0,isLaserEnabled:(r=e==null?void 0:e.isLaserEnabled)!=null?r:!0,isNameEnabled:(n=e==null?void 0:e.isNameEnabled)!=null?n:!0,isMouseEnabled:(l=e==null?void 0:e.isMouseEnabled)!=null?l:!0,avatarConfig:e==null?void 0:e.avatarConfig},this.logger.log("autodesk-viewer component @ constructor - config",this.config),this.viewer=i,this.viewer.canvas.addEventListener("mousemove",this.onMouseMove),this.viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChanged)}get localParticipantId(){var i;return(i=this.localParticipant)==null?void 0:i.id}create3dPresence(i){return Ts(this,null,function*(){if(i.id!==this.localParticipantId){if(this.config.isAvatarsEnabled){let e=yield this.createAvatar(i);this.config.isNameEnabled&&this.createName(i,e)}this.config.isMouseEnabled&&this.createMouse(i),this.config.isLaserEnabled&&this.createLaser(i)}})}follow(i){this.logger.log("autodesk-viewer component @ follow"),this.realtime.setFollowParticipant(i)}createAvatar(i){return Ts(this,null,function*(){var e,t,r,n;if(this.logger.log("autodesk-viewer component @ createAvatar",i),!this.isAttached||i.id===this.localParticipantId)return;this.avatars[i.id]&&this.avatars[i.id].destroy();let l=((e=i.avatarConfig)==null?void 0:e.scale)||1,c=((t=i.avatarConfig)==null?void 0:t.height)||0,h=(n=(r=i.avatar)==null?void 0:r.model3DUrl)!=null?n:T$.model3DUrl,d=new qhe(h,l,c),f=yield d.load();return this.viewer.overlays.hasScene("avatars-scene")||this.viewer.overlays.addScene("avatars-scene"),this.viewer.overlays.addMesh(f,"avatars-scene"),this.avatars[i.id]=d,f})}destroyAvatar(i){return Ts(this,null,function*(){this.avatars[i.id]&&(this.names[i.id]&&(this.names[i.id].destroy(),this.names[i.id]=null),this.avatars[i.id].destroy(),delete this.avatars[i.id],this.avatars[i.id]=null)})}createLaser(i){var e;if(!this.isAttached)return;let t=new Te(0,0,0);(e=i.avatarConfig)!=null&&e.laserOrigin&&(t=new Te(i.avatarConfig.laserOrigin.x,i.avatarConfig.laserOrigin.y,i.avatarConfig.laserOrigin.z));let r=this.realtime.getParticipantSlot(i.id);this.lasers[i.id]=new Zhe(this.viewer,r,t)}destroyLaser(i){return Ts(this,null,function*(){this.lasers[i.id]&&(this.lasers[i.id].destroy(),delete this.lasers[i.id],this.lasers[i.id]=null)})}createName(i,e){return Ts(this,null,function*(){if(this.logger.log("autodesk-viewer component @ createName",i),!i.name.trim().length)return;let t=new THREE.Box3().setFromObject(e),r=new Te(0,0,0);t.getSize(r);let n=this.realtime.getParticipantSlot(i.id),l=t.min.y+r.y*1.25,c=new Xhe(i.name,n,l,this.viewer),h=yield c.load();e.add(h),this.names[i.id]=c})}createMouse(i){return Ts(this,null,function*(){if(!this.isAttached)return;let e=this.realtime.getParticipantSlot(i.id),t=new Jhe(this.viewer,i.id);this.mouses[i.id]=t,t.load(i.name,e)})}destroyMouse(i){return Ts(this,null,function*(){this.mouses[i.id]&&(this.mouses[i.id].destroy(),delete this.mouses[i.id])})}moveToAnotherParticipant(i){if(!this.positionInfos[i]||!this.isAttached)return;let{position:e,target:t}=this.positionInfos[i];if(!t||!e)return;let r=new Te(e.x,e.y,e.z),n=new Te(t.x,t.y,t.z),l=this.viewer.navigation.getCamera();this.viewer.navigation.setRequestTransition(!0,r,n,l.fov,!0,l.pivot)}sync(){var i,e,t,r,n,l,c,h;if(!this.viewer||!this.isAttached)return;let d=(e=(i=this.viewer)==null?void 0:i.navigation)==null?void 0:e.getPosition(),f=(r=(t=this.viewer)==null?void 0:t.navigation)==null?void 0:r.getTarget(),m=(l=(n=this.viewer)==null?void 0:n.navigation)==null?void 0:l.getCamera(),{quaternion:g}=m,y=(c=this.realtime.participantsOn3d)==null?void 0:c[this.localParticipantId];if(this.lastSyncedData.position=d,this.lastSyncedData.target=f,this.lastSyncedData.quaternion=g,(h=y==null?void 0:y.data)!=null&&h.position){let _=Math.abs(y.data.position.x-d.x)<.1,b=Math.abs(y.data.position.y-d.y)<.1,S=Math.abs(y.data.position.z-d.z)<.1;if(_&&b&&S)return}this.realtime.updatePresence3D(i6({id:this.localParticipantId},this.lastSyncedData))}};window&&(window.Presence3D=rde,window.AutodeskPin=ede);/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 *//**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var wF={exports:{}},yN,A$;function nde(){if(A$)return yN;A$=1;var i=1e3,e=i*60,t=e*60,r=t*24,n=r*7,l=r*365.25;yN=function(m,g){g=g||{};var y=typeof m;if(y==="string"&&m.length>0)return c(m);if(y==="number"&&isFinite(m))return g.long?d(m):h(m);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(m))};function c(m){if(m=String(m),!(m.length>100)){var g=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(m);if(g){var y=parseFloat(g[1]),_=(g[2]||"ms").toLowerCase();switch(_){case"years":case"year":case"yrs":case"yr":case"y":return y*l;case"weeks":case"week":case"w":return y*n;case"days":case"day":case"d":return y*r;case"hours":case"hour":case"hrs":case"hr":case"h":return y*t;case"minutes":case"minute":case"mins":case"min":case"m":return y*e;case"seconds":case"second":case"secs":case"sec":case"s":return y*i;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return y;default:return}}}}function h(m){var g=Math.abs(m);return g>=r?Math.round(m/r)+"d":g>=t?Math.round(m/t)+"h":g>=e?Math.round(m/e)+"m":g>=i?Math.round(m/i)+"s":m+"ms"}function d(m){var g=Math.abs(m);return g>=r?f(m,g,r,"day"):g>=t?f(m,g,t,"hour"):g>=e?f(m,g,e,"minute"):g>=i?f(m,g,i,"second"):m+" ms"}function f(m,g,y,_){var b=g>=y*1.5;return Math.round(m/y)+" "+_+(b?"s":"")}return yN}function sde(i){t.debug=t,t.default=t,t.coerce=d,t.disable=l,t.enable=n,t.enabled=c,t.humanize=nde(),t.destroy=f,Object.keys(i).forEach(m=>{t[m]=i[m]}),t.names=[],t.skips=[],t.formatters={};function e(m){let g=0;for(let y=0;y<m.length;y++)g=(g<<5)-g+m.charCodeAt(y),g|=0;return t.colors[Math.abs(g)%t.colors.length]}t.selectColor=e;function t(m){let g,y=null,_,b;function S(...E){if(!S.enabled)return;const T=S,A=Number(new Date),P=A-(g||A);T.diff=P,T.prev=g,T.curr=A,g=A,E[0]=t.coerce(E[0]),typeof E[0]!="string"&&E.unshift("%O");let O=0;E[0]=E[0].replace(/%([a-zA-Z%])/g,(D,L)=>{if(D==="%%")return"%";O++;const N=t.formatters[L];if(typeof N=="function"){const U=E[O];D=N.call(T,U),E.splice(O,1),O--}return D}),t.formatArgs.call(T,E),(T.log||t.log).apply(T,E)}return S.namespace=m,S.useColors=t.useColors(),S.color=t.selectColor(m),S.extend=r,S.destroy=t.destroy,Object.defineProperty(S,"enabled",{enumerable:!0,configurable:!1,get:()=>y!==null?y:(_!==t.namespaces&&(_=t.namespaces,b=t.enabled(m)),b),set:E=>{y=E}}),typeof t.init=="function"&&t.init(S),S}function r(m,g){const y=t(this.namespace+(typeof g>"u"?":":g)+m);return y.log=this.log,y}function n(m){t.save(m),t.namespaces=m,t.names=[],t.skips=[];let g;const y=(typeof m=="string"?m:"").split(/[\s,]+/),_=y.length;for(g=0;g<_;g++)y[g]&&(m=y[g].replace(/\*/g,".*?"),m[0]==="-"?t.skips.push(new RegExp("^"+m.slice(1)+"$")):t.names.push(new RegExp("^"+m+"$")))}function l(){const m=[...t.names.map(h),...t.skips.map(h).map(g=>"-"+g)].join(",");return t.enable(""),m}function c(m){if(m[m.length-1]==="*")return!0;let g,y;for(g=0,y=t.skips.length;g<y;g++)if(t.skips[g].test(m))return!1;for(g=0,y=t.names.length;g<y;g++)if(t.names[g].test(m))return!0;return!1}function h(m){return m.toString().substring(2,m.toString().length-2).replace(/\.\*\?$/,"*")}function d(m){return m instanceof Error?m.stack||m.message:m}function f(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}var ade=sde;(function(i,e){var t={};e.formatArgs=n,e.save=l,e.load=c,e.useColors=r,e.storage=h(),e.destroy=(()=>{let f=!1;return()=>{f||(f=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function n(f){if(f[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+f[0]+(this.useColors?"%c ":" ")+"+"+i.exports.humanize(this.diff),!this.useColors)return;const m="color: "+this.color;f.splice(1,0,m,"color: inherit");let g=0,y=0;f[0].replace(/%[a-zA-Z%]/g,_=>{_!=="%%"&&(g++,_==="%c"&&(y=g))}),f.splice(y,0,m)}e.log=console.debug||console.log||(()=>{});function l(f){try{f?e.storage.setItem("debug",f):e.storage.removeItem("debug")}catch{}}function c(){let f;try{f=e.storage.getItem("debug")}catch{}return!f&&typeof process<"u"&&"env"in process&&(f=t.DEBUG),f}function h(){try{return localStorage}catch{}}i.exports=ade(e);const{formatters:d}=i.exports;d.j=function(f){try{return JSON.stringify(f)}catch(m){return"[UnexpectedJSONParseError]: "+m.message}}})(wF,wF.exports);var SF=wF.exports;const ode=Qd(SF);function lde(i){var e=typeof i;return i!=null&&(e=="object"||e=="function")}var vB=lde,ude=typeof lu=="object"&&lu&&lu.Object===Object&&lu,cde=ude,hde=cde,dde=typeof self=="object"&&self&&self.Object===Object&&self,fde=hde||dde||Function("return this")(),Pq=fde,pde=Pq,mde=function(){return pde.Date.now()},gde=mde,vde=/\s/;function yde(i){for(var e=i.length;e--&&vde.test(i.charAt(e)););return e}var _de=yde,xde=_de,bde=/^\s+/;function wde(i){return i&&i.slice(0,xde(i)+1).replace(bde,"")}var Sde=wde,Mde=Pq,Ede=Mde.Symbol,Rq=Ede,C$=Rq,Iq=Object.prototype,Tde=Iq.hasOwnProperty,Ade=Iq.toString,tT=C$?C$.toStringTag:void 0;function Cde(i){var e=Tde.call(i,tT),t=i[tT];try{i[tT]=void 0;var r=!0}catch{}var n=Ade.call(i);return r&&(e?i[tT]=t:delete i[tT]),n}var Pde=Cde,Rde=Object.prototype,Ide=Rde.toString;function Lde(i){return Ide.call(i)}var Ode=Lde,P$=Rq,Nde=Pde,Dde=Ode,kde="[object Null]",Fde="[object Undefined]",R$=P$?P$.toStringTag:void 0;function zde(i){return i==null?i===void 0?Fde:kde:R$&&R$ in Object(i)?Nde(i):Dde(i)}var Bde=zde;function Ude(i){return i!=null&&typeof i=="object"}var Hde=Ude,$de=Bde,Vde=Hde,Wde="[object Symbol]";function jde(i){return typeof i=="symbol"||Vde(i)&&$de(i)==Wde}var Gde=jde,qde=Sde,I$=vB,Xde=Gde,L$=NaN,Zde=/^[-+]0x[0-9a-f]+$/i,Jde=/^0b[01]+$/i,Yde=/^0o[0-7]+$/i,Kde=parseInt;function Qde(i){if(typeof i=="number")return i;if(Xde(i))return L$;if(I$(i)){var e=typeof i.valueOf=="function"?i.valueOf():i;i=I$(e)?e+"":e}if(typeof i!="string")return i===0?i:+i;i=qde(i);var t=Jde.test(i);return t||Yde.test(i)?Kde(i.slice(2),t?2:8):Zde.test(i)?L$:+i}var efe=Qde,tfe=vB,_N=gde,O$=efe,ife="Expected a function",rfe=Math.max,nfe=Math.min;function sfe(i,e,t){var r,n,l,c,h,d,f=0,m=!1,g=!1,y=!0;if(typeof i!="function")throw new TypeError(ife);e=O$(e)||0,tfe(t)&&(m=!!t.leading,g="maxWait"in t,l=g?rfe(O$(t.maxWait)||0,e):l,y="trailing"in t?!!t.trailing:y);function _(D){var L=r,N=n;return r=n=void 0,f=D,c=i.apply(N,L),c}function b(D){return f=D,h=setTimeout(T,e),m?_(D):c}function S(D){var L=D-d,N=D-f,U=e-L;return g?nfe(U,l-N):U}function E(D){var L=D-d,N=D-f;return d===void 0||L>=e||L<0||g&&N>=l}function T(){var D=_N();if(E(D))return A(D);h=setTimeout(T,S(D))}function A(D){return h=void 0,y&&r?_(D):(r=n=void 0,c)}function P(){h!==void 0&&clearTimeout(h),f=0,r=d=n=h=void 0}function O(){return h===void 0?c:A(_N())}function R(){var D=_N(),L=E(D);if(r=arguments,n=this,d=D,L){if(h===void 0)return b(d);if(g)return clearTimeout(h),h=setTimeout(T,e),_(d)}return h===void 0&&(h=setTimeout(T,e)),c}return R.cancel=P,R.flush=O,R}var afe=sfe,ofe=afe,lfe=vB,ufe="Expected a function";function cfe(i,e,t){var r=!0,n=!0;if(typeof i!="function")throw new TypeError(ufe);return lfe(t)&&(r="leading"in t?!!t.leading:r,n="trailing"in t?!!t.trailing:n),ofe(i,e,{leading:r,maxWait:e,trailing:n})}var hfe=cfe;const UR=Qd(hfe);var HR={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */HR.exports;(function(i,e){(function(){var t,r="4.17.21",n=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",c="Expected a function",h="Invalid `variable` option passed into `_.template`",d="__lodash_hash_undefined__",f=500,m="__lodash_placeholder__",g=1,y=2,_=4,b=1,S=2,E=1,T=2,A=4,P=8,O=16,R=32,D=64,L=128,N=256,U=512,F=30,z="...",G=800,J=16,Z=1,q=2,$=3,H=1/0,X=9007199254740991,re=17976931348623157e292,ae=NaN,he=4294967295,pe=he-1,de=he>>>1,ee=[["ary",L],["bind",E],["bindKey",T],["curry",P],["curryRight",O],["flip",U],["partial",R],["partialRight",D],["rearg",N]],se="[object Arguments]",Y="[object Array]",fe="[object AsyncFunction]",me="[object Boolean]",De="[object Date]",Le="[object DOMException]",Ce="[object Error]",Ae="[object Function]",Ue="[object GeneratorFunction]",Ne="[object Map]",Ge="[object Number]",Ct="[object Null]",it="[object Object]",bt="[object Promise]",Kt="[object Proxy]",kt="[object RegExp]",Pt="[object Set]",_e="[object String]",ce="[object Symbol]",Fe="[object Undefined]",et="[object WeakMap]",Dt="[object WeakSet]",gt="[object ArrayBuffer]",xe="[object DataView]",we="[object Float32Array]",Ve="[object Float64Array]",ut="[object Int8Array]",lt="[object Int16Array]",Ee="[object Int32Array]",_t="[object Uint8Array]",wt="[object Uint8ClampedArray]",Xt="[object Uint16Array]",Ft="[object Uint32Array]",gi=/\b__p \+= '';/g,Rt=/\b(__p \+=) '' \+/g,ci=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ji=/&(?:amp|lt|gt|quot|#39);/g,Ji=/[&<>"']/g,ws=RegExp(ji.source),Jn=RegExp(Ji.source),ao=/<%-([\s\S]+?)%>/g,oo=/<%([\s\S]+?)%>/g,lo=/<%=([\s\S]+?)%>/g,uo=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,vu=/^\w*$/,yu=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ls=/[\\^$.*+?()[\]{}|]/g,_u=RegExp(Ls.source),ye=/^\s+/,je=/\s/,tt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,qe=/\{\n\/\* \[wrapped with (.+)\] \*/,st=/,? & /,si=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ci=/[()=,{}\[\]\/\s]/,yi=/\\(\\)?/g,Xi=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,xr=/\w*$/,Yi=/^[-+]0x[0-9a-f]+$/i,Ki=/^0b[01]+$/i,tn=/^\[object .+?Constructor\]$/,Us=/^0o[0-7]+$/i,co=/^(?:0|[1-9]\d*)$/,Po=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Q=/($^)/,le=/['\n\r\u2028\u2029\\]/g,oe="\\ud800-\\udfff",ve="\\u0300-\\u036f",ke="\\ufe20-\\ufe2f",Oe="\\u20d0-\\u20ff",Je=ve+ke+Oe,mt="\\u2700-\\u27bf",vt="a-z\\xdf-\\xf6\\xf8-\\xff",ct="\\xac\\xb1\\xd7\\xf7",It="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Ht="\\u2000-\\u206f",qi=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ui="A-Z\\xc0-\\xd6\\xd8-\\xde",Ai="\\ufe0e\\ufe0f",Pr=ct+It+Ht+qi,Rr="['’]",Kr="["+oe+"]",or="["+Pr+"]",ui="["+Je+"]",pn="\\d+",_r="["+mt+"]",br="["+vt+"]",jr="[^"+oe+Pr+pn+mt+vt+Ui+"]",Gr="\\ud83c[\\udffb-\\udfff]",Ss="(?:"+ui+"|"+Gr+")",fn="[^"+oe+"]",Qr="(?:\\ud83c[\\udde6-\\uddff]){2}",Yn="[\\ud800-\\udbff][\\udc00-\\udfff]",Vr="["+Ui+"]",xu="\\u200d",Os="(?:"+br+"|"+jr+")",Lf="(?:"+Vr+"|"+jr+")",Hs="(?:"+Rr+"(?:d|ll|m|re|s|t|ve))?",ho="(?:"+Rr+"(?:D|LL|M|RE|S|T|VE))?",Ro=Ss+"?",Io="["+Ai+"]?",Of="(?:"+xu+"(?:"+[fn,Qr,Yn].join("|")+")"+Io+Ro+")*",Nf="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",og="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",uc=Io+Ro+Of,lg="(?:"+[_r,Qr,Yn].join("|")+")"+uc,ug="(?:"+[fn+ui+"?",ui,Qr,Yn,Kr].join("|")+")",cg=RegExp(Rr,"g"),hg=RegExp(ui,"g"),Lo=RegExp(Gr+"(?="+Gr+")|"+ug+uc,"g"),dg=RegExp([Vr+"?"+br+"+"+Hs+"(?="+[or,Vr,"$"].join("|")+")",Lf+"+"+ho+"(?="+[or,Vr+Os,"$"].join("|")+")",Vr+"?"+Os+"+"+Hs,Vr+"+"+ho,og,Nf,pn,lg].join("|"),"g"),fg=RegExp("["+xu+oe+Je+Ai+"]"),pg=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,mg=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],gg=-1,yt={};yt[we]=yt[Ve]=yt[ut]=yt[lt]=yt[Ee]=yt[_t]=yt[wt]=yt[Xt]=yt[Ft]=!0,yt[se]=yt[Y]=yt[gt]=yt[me]=yt[xe]=yt[De]=yt[Ce]=yt[Ae]=yt[Ne]=yt[Ge]=yt[it]=yt[kt]=yt[Pt]=yt[_e]=yt[et]=!1;var pt={};pt[se]=pt[Y]=pt[gt]=pt[xe]=pt[me]=pt[De]=pt[we]=pt[Ve]=pt[ut]=pt[lt]=pt[Ee]=pt[Ne]=pt[Ge]=pt[it]=pt[kt]=pt[Pt]=pt[_e]=pt[ce]=pt[_t]=pt[wt]=pt[Xt]=pt[Ft]=!0,pt[Ce]=pt[Ae]=pt[et]=!1;var vg={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},yg={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},_g={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},xg={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},bg=parseFloat,wg=parseInt,cc=typeof lu=="object"&&lu&&lu.Object===Object&&lu,Sg=typeof self=="object"&&self&&self.Object===Object&&self,Gt=cc||Sg||Function("return this")(),Oo=e&&!e.nodeType&&e,rn=Oo&&!0&&i&&!i.nodeType&&i,hc=rn&&rn.exports===Oo,No=hc&&cc.process,Pi=function(){try{var V=rn&&rn.require&&rn.require("util").types;return V||No&&No.binding&&No.binding("util")}catch{}}(),dc=Pi&&Pi.isArrayBuffer,fc=Pi&&Pi.isDate,pc=Pi&&Pi.isMap,mc=Pi&&Pi.isRegExp,gc=Pi&&Pi.isSet,vc=Pi&&Pi.isTypedArray;function _i(V,te,K){switch(K.length){case 0:return V.call(te);case 1:return V.call(te,K[0]);case 2:return V.call(te,K[0],K[1]);case 3:return V.call(te,K[0],K[1],K[2])}return V.apply(te,K)}function Mg(V,te,K,be){for(var ze=-1,rt=V==null?0:V.length;++ze<rt;){var Bt=V[ze];te(be,Bt,K(Bt),V)}return be}function Ri(V,te){for(var K=-1,be=V==null?0:V.length;++K<be&&te(V[K],K,V)!==!1;);return V}function Eg(V,te){for(var K=V==null?0:V.length;K--&&te(V[K],K,V)!==!1;);return V}function yc(V,te){for(var K=-1,be=V==null?0:V.length;++K<be;)if(!te(V[K],K,V))return!1;return!0}function Ir(V,te){for(var K=-1,be=V==null?0:V.length,ze=0,rt=[];++K<be;){var Bt=V[K];te(Bt,K,V)&&(rt[ze++]=Bt)}return rt}function $s(V,te){var K=V==null?0:V.length;return!!K&&En(V,te,0)>-1}function Do(V,te,K){for(var be=-1,ze=V==null?0:V.length;++be<ze;)if(K(te,V[be]))return!0;return!1}function xt(V,te){for(var K=-1,be=V==null?0:V.length,ze=Array(be);++K<be;)ze[K]=te(V[K],K,V);return ze}function Lr(V,te){for(var K=-1,be=te.length,ze=V.length;++K<be;)V[ze+K]=te[K];return V}function ko(V,te,K,be){var ze=-1,rt=V==null?0:V.length;for(be&&rt&&(K=V[++ze]);++ze<rt;)K=te(K,V[ze],ze,V);return K}function Tg(V,te,K,be){var ze=V==null?0:V.length;for(be&&ze&&(K=V[--ze]);ze--;)K=te(K,V[ze],ze,V);return K}function Fo(V,te){for(var K=-1,be=V==null?0:V.length;++K<be;)if(te(V[K],K,V))return!0;return!1}var Ag=zo("length");function Cg(V){return V.split("")}function Pg(V){return V.match(si)||[]}function _c(V,te,K){var be;return K(V,function(ze,rt,Bt){if(te(ze,rt,Bt))return be=rt,!1}),be}function Vs(V,te,K,be){for(var ze=V.length,rt=K+(be?1:-1);be?rt--:++rt<ze;)if(te(V[rt],rt,V))return rt;return-1}function En(V,te,K){return te===te?Hg(V,te,K):Vs(V,xc,K)}function Rg(V,te,K,be){for(var ze=K-1,rt=V.length;++ze<rt;)if(be(V[ze],te))return ze;return-1}function xc(V){return V!==V}function bc(V,te){var K=V==null?0:V.length;return K?Uo(V,te)/K:ae}function zo(V){return function(te){return te==null?t:te[V]}}function Bo(V){return function(te){return V==null?t:V[te]}}function wc(V,te,K,be,ze){return ze(V,function(rt,Bt,dt){K=be?(be=!1,rt):te(K,rt,Bt,dt)}),K}function Ig(V,te){var K=V.length;for(V.sort(te);K--;)V[K]=V[K].value;return V}function Uo(V,te){for(var K,be=-1,ze=V.length;++be<ze;){var rt=te(V[be]);rt!==t&&(K=K===t?rt:K+rt)}return K}function Ho(V,te){for(var K=-1,be=Array(V);++K<V;)be[K]=te(K);return be}function Lg(V,te){return xt(te,function(K){return[K,V[K]]})}function Sc(V){return V&&V.slice(0,Ac(V)+1).replace(ye,"")}function xi(V){return function(te){return V(te)}}function $o(V,te){return xt(te,function(K){return V[K]})}function Kn(V,te){return V.has(te)}function Mc(V,te){for(var K=-1,be=V.length;++K<be&&En(te,V[K],0)>-1;);return K}function Ec(V,te){for(var K=V.length;K--&&En(te,V[K],0)>-1;);return K}function Og(V,te){for(var K=V.length,be=0;K--;)V[K]===te&&++be;return be}var Ng=Bo(vg),Dg=Bo(yg);function kg(V){return"\\"+xg[V]}function Fg(V,te){return V==null?t:V[te]}function Tn(V){return fg.test(V)}function zg(V){return pg.test(V)}function Bg(V){for(var te,K=[];!(te=V.next()).done;)K.push(te.value);return K}function Vo(V){var te=-1,K=Array(V.size);return V.forEach(function(be,ze){K[++te]=[ze,be]}),K}function Tc(V,te){return function(K){return V(te(K))}}function Or(V,te){for(var K=-1,be=V.length,ze=0,rt=[];++K<be;){var Bt=V[K];(Bt===te||Bt===m)&&(V[K]=m,rt[ze++]=K)}return rt}function Ws(V){var te=-1,K=Array(V.size);return V.forEach(function(be){K[++te]=be}),K}function Ug(V){var te=-1,K=Array(V.size);return V.forEach(function(be){K[++te]=[be,be]}),K}function Hg(V,te,K){for(var be=K-1,ze=V.length;++be<ze;)if(V[be]===te)return be;return-1}function $g(V,te,K){for(var be=K+1;be--;)if(V[be]===te)return be;return be}function An(V){return Tn(V)?Wg(V):Ag(V)}function Hi(V){return Tn(V)?jg(V):Cg(V)}function Ac(V){for(var te=V.length;te--&&je.test(V.charAt(te)););return te}var Vg=Bo(_g);function Wg(V){for(var te=Lo.lastIndex=0;Lo.test(V);)++te;return te}function jg(V){return V.match(Lo)||[]}function Gg(V){return V.match(dg)||[]}var qg=function V(te){te=te==null?Gt:qr.defaults(Gt.Object(),te,qr.pick(Gt,mg));var K=te.Array,be=te.Date,ze=te.Error,rt=te.Function,Bt=te.Math,dt=te.Object,Wo=te.RegExp,Xg=te.String,Ii=te.TypeError,js=K.prototype,Zg=rt.prototype,Cn=dt.prototype,Gs=te["__core-js_shared__"],qs=Zg.toString,ot=Cn.hasOwnProperty,Jg=0,Cc=function(){var a=/[^.]+$/.exec(Gs&&Gs.keys&&Gs.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}(),Xs=Cn.toString,Yg=qs.call(dt),Kg=Gt._,Qg=Wo("^"+qs.call(ot).replace(Ls,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Zs=hc?te.Buffer:t,Nr=te.Symbol,Js=te.Uint8Array,Pc=Zs?Zs.allocUnsafe:t,Ys=Tc(dt.getPrototypeOf,dt),Rc=dt.create,Ic=Cn.propertyIsEnumerable,Ks=js.splice,Lc=Nr?Nr.isConcatSpreadable:t,Qn=Nr?Nr.iterator:t,nn=Nr?Nr.toStringTag:t,Qs=function(){try{var a=un(dt,"defineProperty");return a({},"",{}),a}catch{}}(),ev=te.clearTimeout!==Gt.clearTimeout&&te.clearTimeout,tv=be&&be.now!==Gt.Date.now&&be.now,iv=te.setTimeout!==Gt.setTimeout&&te.setTimeout,ea=Bt.ceil,ta=Bt.floor,jo=dt.getOwnPropertySymbols,rv=Zs?Zs.isBuffer:t,Oc=te.isFinite,nv=js.join,sv=Tc(dt.keys,dt),Ut=Bt.max,ei=Bt.min,av=be.now,ov=te.parseInt,Nc=Bt.random,lv=js.reverse,Go=un(te,"DataView"),es=un(te,"Map"),qo=un(te,"Promise"),Pn=un(te,"Set"),ts=un(te,"WeakMap"),is=un(dt,"create"),ia=ts&&new ts,Rn={},uv=cn(Go),cv=cn(es),hv=cn(qo),dv=cn(Pn),fv=cn(ts),ra=Nr?Nr.prototype:t,rs=ra?ra.valueOf:t,Dc=ra?ra.toString:t;function C(a){if(Tt(a)&&!Be(a)&&!(a instanceof Ye)){if(a instanceof Li)return a;if(ot.call(a,"__wrapped__"))return kh(a)}return new Li(a)}var In=function(){function a(){}return function(u){if(!St(u))return{};if(Rc)return Rc(u);a.prototype=u;var p=new a;return a.prototype=t,p}}();function na(){}function Li(a,u){this.__wrapped__=a,this.__actions__=[],this.__chain__=!!u,this.__index__=0,this.__values__=t}C.templateSettings={escape:ao,evaluate:oo,interpolate:lo,variable:"",imports:{_:C}},C.prototype=na.prototype,C.prototype.constructor=C,Li.prototype=In(na.prototype),Li.prototype.constructor=Li;function Ye(a){this.__wrapped__=a,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=he,this.__views__=[]}function pv(){var a=new Ye(this.__wrapped__);return a.__actions__=hi(this.__actions__),a.__dir__=this.__dir__,a.__filtered__=this.__filtered__,a.__iteratees__=hi(this.__iteratees__),a.__takeCount__=this.__takeCount__,a.__views__=hi(this.__views__),a}function mv(){if(this.__filtered__){var a=new Ye(this);a.__dir__=-1,a.__filtered__=!0}else a=this.clone(),a.__dir__*=-1;return a}function gv(){var a=this.__wrapped__.value(),u=this.__dir__,p=Be(a),x=u<0,M=p?a.length:0,I=Cy(0,M,this.__views__),k=I.start,B=I.end,W=B-k,ie=x?B:k-1,ne=this.__iteratees__,ue=ne.length,ge=0,Me=ei(W,this.__takeCount__);if(!p||!x&&M==W&&Me==W)return sh(a,this.__actions__);var Re=[];e:for(;W--&&ge<Me;){ie+=u;for(var $e=-1,Ie=a[ie];++$e<ue;){var Xe=ne[$e],Ke=Xe.iteratee,Si=Xe.type,li=Ke(Ie);if(Si==q)Ie=li;else if(!li){if(Si==Z)continue e;break e}}Re[ge++]=Ie}return Re}Ye.prototype=In(na.prototype),Ye.prototype.constructor=Ye;function sn(a){var u=-1,p=a==null?0:a.length;for(this.clear();++u<p;){var x=a[u];this.set(x[0],x[1])}}function vv(){this.__data__=is?is(null):{},this.size=0}function yv(a){var u=this.has(a)&&delete this.__data__[a];return this.size-=u?1:0,u}function _v(a){var u=this.__data__;if(is){var p=u[a];return p===d?t:p}return ot.call(u,a)?u[a]:t}function xv(a){var u=this.__data__;return is?u[a]!==t:ot.call(u,a)}function bv(a,u){var p=this.__data__;return this.size+=this.has(a)?0:1,p[a]=is&&u===t?d:u,this}sn.prototype.clear=vv,sn.prototype.delete=yv,sn.prototype.get=_v,sn.prototype.has=xv,sn.prototype.set=bv;function ur(a){var u=-1,p=a==null?0:a.length;for(this.clear();++u<p;){var x=a[u];this.set(x[0],x[1])}}function wv(){this.__data__=[],this.size=0}function Sv(a){var u=this.__data__,p=sa(u,a);if(p<0)return!1;var x=u.length-1;return p==x?u.pop():Ks.call(u,p,1),--this.size,!0}function Mv(a){var u=this.__data__,p=sa(u,a);return p<0?t:u[p][1]}function Ev(a){return sa(this.__data__,a)>-1}function Tv(a,u){var p=this.__data__,x=sa(p,a);return x<0?(++this.size,p.push([a,u])):p[x][1]=u,this}ur.prototype.clear=wv,ur.prototype.delete=Sv,ur.prototype.get=Mv,ur.prototype.has=Ev,ur.prototype.set=Tv;function cr(a){var u=-1,p=a==null?0:a.length;for(this.clear();++u<p;){var x=a[u];this.set(x[0],x[1])}}function Av(){this.size=0,this.__data__={hash:new sn,map:new(es||ur),string:new sn}}function Cv(a){var u=va(this,a).delete(a);return this.size-=u?1:0,u}function Pv(a){return va(this,a).get(a)}function Rv(a){return va(this,a).has(a)}function Iv(a,u){var p=va(this,a),x=p.size;return p.set(a,u),this.size+=p.size==x?0:1,this}cr.prototype.clear=Av,cr.prototype.delete=Cv,cr.prototype.get=Pv,cr.prototype.has=Rv,cr.prototype.set=Iv;function an(a){var u=-1,p=a==null?0:a.length;for(this.__data__=new cr;++u<p;)this.add(a[u])}function Lv(a){return this.__data__.set(a,d),this}function Ov(a){return this.__data__.has(a)}an.prototype.add=an.prototype.push=Lv,an.prototype.has=Ov;function $i(a){var u=this.__data__=new ur(a);this.size=u.size}function Nv(){this.__data__=new ur,this.size=0}function Dv(a){var u=this.__data__,p=u.delete(a);return this.size=u.size,p}function kv(a){return this.__data__.get(a)}function Fv(a){return this.__data__.has(a)}function zv(a,u){var p=this.__data__;if(p instanceof ur){var x=p.__data__;if(!es||x.length<n-1)return x.push([a,u]),this.size=++p.size,this;p=this.__data__=new cr(x)}return p.set(a,u),this.size=p.size,this}$i.prototype.clear=Nv,$i.prototype.delete=Dv,$i.prototype.get=kv,$i.prototype.has=Fv,$i.prototype.set=zv;function kc(a,u){var p=Be(a),x=!p&&hn(a),M=!p&&!x&&Br(a),I=!p&&!x&&!M&&Dn(a),k=p||x||M||I,B=k?Ho(a.length,Xg):[],W=B.length;for(var ie in a)(u||ot.call(a,ie))&&!(k&&(ie=="length"||M&&(ie=="offset"||ie=="parent")||I&&(ie=="buffer"||ie=="byteLength"||ie=="byteOffset")||pr(ie,W)))&&B.push(ie);return B}function Fc(a){var u=a.length;return u?a[nl(0,u-1)]:t}function Bv(a,u){return ya(hi(a),on(u,0,a.length))}function Uv(a){return ya(hi(a))}function Xo(a,u,p){(p!==t&&!Vi(a[u],p)||p===t&&!(u in a))&&hr(a,u,p)}function ns(a,u,p){var x=a[u];(!(ot.call(a,u)&&Vi(x,p))||p===t&&!(u in a))&&hr(a,u,p)}function sa(a,u){for(var p=a.length;p--;)if(Vi(a[p][0],u))return p;return-1}function Hv(a,u,p,x){return Dr(a,function(M,I,k){u(x,M,p(M),k)}),x}function zc(a,u){return a&&er(u,Wt(u),a)}function $v(a,u){return a&&er(u,fi(u),a)}function hr(a,u,p){u=="__proto__"&&Qs?Qs(a,u,{configurable:!0,enumerable:!0,value:p,writable:!0}):a[u]=p}function Zo(a,u){for(var p=-1,x=u.length,M=K(x),I=a==null;++p<x;)M[p]=I?t:Pl(a,u[p]);return M}function on(a,u,p){return a===a&&(p!==t&&(a=a<=p?a:p),u!==t&&(a=a>=u?a:u)),a}function Oi(a,u,p,x,M,I){var k,B=u&g,W=u&y,ie=u&_;if(p&&(k=M?p(a,x,M,I):p(a)),k!==t)return k;if(!St(a))return a;var ne=Be(a);if(ne){if(k=Ry(a),!B)return hi(a,k)}else{var ue=ti(a),ge=ue==Ae||ue==Ue;if(Br(a))return lh(a,B);if(ue==it||ue==se||ge&&!M){if(k=W||ge?{}:Ah(a),!B)return W?_y(a,$v(k,a)):yy(a,zc(k,a))}else{if(!pt[ue])return M?a:{};k=Iy(a,ue,B)}}I||(I=new $i);var Me=I.get(a);if(Me)return Me;I.set(a,k),id(a)?a.forEach(function(Ie){k.add(Oi(Ie,u,p,Ie,a,I))}):ed(a)&&a.forEach(function(Ie,Xe){k.set(Xe,Oi(Ie,u,p,Xe,a,I))});var Re=ie?W?ml:pl:W?fi:Wt,$e=ne?t:Re(a);return Ri($e||a,function(Ie,Xe){$e&&(Xe=Ie,Ie=a[Xe]),ns(k,Xe,Oi(Ie,u,p,Xe,a,I))}),k}function Vv(a){var u=Wt(a);return function(p){return Bc(p,a,u)}}function Bc(a,u,p){var x=p.length;if(a==null)return!x;for(a=dt(a);x--;){var M=p[x],I=u[M],k=a[M];if(k===t&&!(M in a)||!I(k))return!1}return!0}function Uc(a,u,p){if(typeof a!="function")throw new Ii(c);return hs(function(){a.apply(t,p)},u)}function ss(a,u,p,x){var M=-1,I=$s,k=!0,B=a.length,W=[],ie=u.length;if(!B)return W;p&&(u=xt(u,xi(p))),x?(I=Do,k=!1):u.length>=n&&(I=Kn,k=!1,u=new an(u));e:for(;++M<B;){var ne=a[M],ue=p==null?ne:p(ne);if(ne=x||ne!==0?ne:0,k&&ue===ue){for(var ge=ie;ge--;)if(u[ge]===ue)continue e;W.push(ne)}else I(u,ue,x)||W.push(ne)}return W}var Dr=fh(Qi),Hc=fh(Yo,!0);function Wv(a,u){var p=!0;return Dr(a,function(x,M,I){return p=!!u(x,M,I),p}),p}function aa(a,u,p){for(var x=-1,M=a.length;++x<M;){var I=a[x],k=u(I);if(k!=null&&(B===t?k===k&&!wi(k):p(k,B)))var B=k,W=I}return W}function jv(a,u,p,x){var M=a.length;for(p=He(p),p<0&&(p=-p>M?0:M+p),x=x===t||x>M?M:He(x),x<0&&(x+=M),x=p>x?0:nd(x);p<x;)a[p++]=u;return a}function $c(a,u){var p=[];return Dr(a,function(x,M,I){u(x,M,I)&&p.push(x)}),p}function Zt(a,u,p,x,M){var I=-1,k=a.length;for(p||(p=Oy),M||(M=[]);++I<k;){var B=a[I];u>0&&p(B)?u>1?Zt(B,u-1,p,x,M):Lr(M,B):x||(M[M.length]=B)}return M}var Jo=ph(),Vc=ph(!0);function Qi(a,u){return a&&Jo(a,u,Wt)}function Yo(a,u){return a&&Vc(a,u,Wt)}function oa(a,u){return Ir(u,function(p){return mr(a[p])})}function ln(a,u){u=Fr(u,a);for(var p=0,x=u.length;a!=null&&p<x;)a=a[tr(u[p++])];return p&&p==x?a:t}function Wc(a,u,p){var x=u(a);return Be(a)?x:Lr(x,p(a))}function ai(a){return a==null?a===t?Fe:Ct:nn&&nn in dt(a)?Ay(a):Uy(a)}function Ko(a,u){return a>u}function Gv(a,u){return a!=null&&ot.call(a,u)}function qv(a,u){return a!=null&&u in dt(a)}function Xv(a,u,p){return a>=ei(u,p)&&a<Ut(u,p)}function Qo(a,u,p){for(var x=p?Do:$s,M=a[0].length,I=a.length,k=I,B=K(I),W=1/0,ie=[];k--;){var ne=a[k];k&&u&&(ne=xt(ne,xi(u))),W=ei(ne.length,W),B[k]=!p&&(u||M>=120&&ne.length>=120)?new an(k&&ne):t}ne=a[0];var ue=-1,ge=B[0];e:for(;++ue<M&&ie.length<W;){var Me=ne[ue],Re=u?u(Me):Me;if(Me=p||Me!==0?Me:0,!(ge?Kn(ge,Re):x(ie,Re,p))){for(k=I;--k;){var $e=B[k];if(!($e?Kn($e,Re):x(a[k],Re,p)))continue e}ge&&ge.push(Re),ie.push(Me)}}return ie}function Zv(a,u,p,x){return Qi(a,function(M,I,k){u(x,p(M),I,k)}),x}function as(a,u,p){u=Fr(u,a),a=Ih(a,u);var x=a==null?a:a[tr(Di(u))];return x==null?t:_i(x,a,p)}function jc(a){return Tt(a)&&ai(a)==se}function Jv(a){return Tt(a)&&ai(a)==gt}function Yv(a){return Tt(a)&&ai(a)==De}function os(a,u,p,x,M){return a===u?!0:a==null||u==null||!Tt(a)&&!Tt(u)?a!==a&&u!==u:Kv(a,u,p,x,os,M)}function Kv(a,u,p,x,M,I){var k=Be(a),B=Be(u),W=k?Y:ti(a),ie=B?Y:ti(u);W=W==se?it:W,ie=ie==se?it:ie;var ne=W==it,ue=ie==it,ge=W==ie;if(ge&&Br(a)){if(!Br(u))return!1;k=!0,ne=!1}if(ge&&!ne)return I||(I=new $i),k||Dn(a)?Mh(a,u,p,x,M,I):Ey(a,u,W,p,x,M,I);if(!(p&b)){var Me=ne&&ot.call(a,"__wrapped__"),Re=ue&&ot.call(u,"__wrapped__");if(Me||Re){var $e=Me?a.value():a,Ie=Re?u.value():u;return I||(I=new $i),M($e,Ie,p,x,I)}}return ge?(I||(I=new $i),Ty(a,u,p,x,M,I)):!1}function Qv(a){return Tt(a)&&ti(a)==Ne}function el(a,u,p,x){var M=p.length,I=M,k=!x;if(a==null)return!I;for(a=dt(a);M--;){var B=p[M];if(k&&B[2]?B[1]!==a[B[0]]:!(B[0]in a))return!1}for(;++M<I;){B=p[M];var W=B[0],ie=a[W],ne=B[1];if(k&&B[2]){if(ie===t&&!(W in a))return!1}else{var ue=new $i;if(x)var ge=x(ie,ne,W,a,u,ue);if(!(ge===t?os(ne,ie,b|S,x,ue):ge))return!1}}return!0}function Gc(a){if(!St(a)||Dy(a))return!1;var u=mr(a)?Qg:tn;return u.test(cn(a))}function ey(a){return Tt(a)&&ai(a)==kt}function ty(a){return Tt(a)&&ti(a)==Pt}function iy(a){return Tt(a)&&Ma(a.length)&&!!yt[ai(a)]}function qc(a){return typeof a=="function"?a:a==null?pi:typeof a=="object"?Be(a)?Jc(a[0],a[1]):Zc(a):md(a)}function tl(a){if(!cs(a))return sv(a);var u=[];for(var p in dt(a))ot.call(a,p)&&p!="constructor"&&u.push(p);return u}function ry(a){if(!St(a))return By(a);var u=cs(a),p=[];for(var x in a)x=="constructor"&&(u||!ot.call(a,x))||p.push(x);return p}function il(a,u){return a<u}function Xc(a,u){var p=-1,x=di(a)?K(a.length):[];return Dr(a,function(M,I,k){x[++p]=u(M,I,k)}),x}function Zc(a){var u=vl(a);return u.length==1&&u[0][2]?Ph(u[0][0],u[0][1]):function(p){return p===a||el(p,a,u)}}function Jc(a,u){return _l(a)&&Ch(u)?Ph(tr(a),u):function(p){var x=Pl(p,a);return x===t&&x===u?Rl(p,a):os(u,x,b|S)}}function la(a,u,p,x,M){a!==u&&Jo(u,function(I,k){if(M||(M=new $i),St(I))ny(a,u,k,p,la,x,M);else{var B=x?x(bl(a,k),I,k+"",a,u,M):t;B===t&&(B=I),Xo(a,k,B)}},fi)}function ny(a,u,p,x,M,I,k){var B=bl(a,p),W=bl(u,p),ie=k.get(W);if(ie){Xo(a,p,ie);return}var ne=I?I(B,W,p+"",a,u,k):t,ue=ne===t;if(ue){var ge=Be(W),Me=!ge&&Br(W),Re=!ge&&!Me&&Dn(W);ne=W,ge||Me||Re?Be(B)?ne=B:Lt(B)?ne=hi(B):Me?(ue=!1,ne=lh(W,!0)):Re?(ue=!1,ne=uh(W,!0)):ne=[]:ds(W)||hn(W)?(ne=B,hn(B)?ne=sd(B):(!St(B)||mr(B))&&(ne=Ah(W))):ue=!1}ue&&(k.set(W,ne),M(ne,W,x,I,k),k.delete(W)),Xo(a,p,ne)}function Yc(a,u){var p=a.length;if(p)return u+=u<0?p:0,pr(u,p)?a[u]:t}function Kc(a,u,p){u.length?u=xt(u,function(I){return Be(I)?function(k){return ln(k,I.length===1?I[0]:I)}:I}):u=[pi];var x=-1;u=xt(u,xi(Pe()));var M=Xc(a,function(I,k,B){var W=xt(u,function(ie){return ie(I)});return{criteria:W,index:++x,value:I}});return Ig(M,function(I,k){return vy(I,k,p)})}function sy(a,u){return Qc(a,u,function(p,x){return Rl(a,x)})}function Qc(a,u,p){for(var x=-1,M=u.length,I={};++x<M;){var k=u[x],B=ln(a,k);p(B,k)&&ls(I,Fr(k,a),B)}return I}function ay(a){return function(u){return ln(u,a)}}function rl(a,u,p,x){var M=x?Rg:En,I=-1,k=u.length,B=a;for(a===u&&(u=hi(u)),p&&(B=xt(a,xi(p)));++I<k;)for(var W=0,ie=u[I],ne=p?p(ie):ie;(W=M(B,ne,W,x))>-1;)B!==a&&Ks.call(B,W,1),Ks.call(a,W,1);return a}function eh(a,u){for(var p=a?u.length:0,x=p-1;p--;){var M=u[p];if(p==x||M!==I){var I=M;pr(M)?Ks.call(a,M,1):ol(a,M)}}return a}function nl(a,u){return a+ta(Nc()*(u-a+1))}function oy(a,u,p,x){for(var M=-1,I=Ut(ea((u-a)/(p||1)),0),k=K(I);I--;)k[x?I:++M]=a,a+=p;return k}function sl(a,u){var p="";if(!a||u<1||u>X)return p;do u%2&&(p+=a),u=ta(u/2),u&&(a+=a);while(u);return p}function We(a,u){return wl(Rh(a,u,pi),a+"")}function ly(a){return Fc(kn(a))}function uy(a,u){var p=kn(a);return ya(p,on(u,0,p.length))}function ls(a,u,p,x){if(!St(a))return a;u=Fr(u,a);for(var M=-1,I=u.length,k=I-1,B=a;B!=null&&++M<I;){var W=tr(u[M]),ie=p;if(W==="__proto__"||W==="constructor"||W==="prototype")return a;if(M!=k){var ne=B[W];ie=x?x(ne,W,B):t,ie===t&&(ie=St(ne)?ne:pr(u[M+1])?[]:{})}ns(B,W,ie),B=B[W]}return a}var th=ia?function(a,u){return ia.set(a,u),a}:pi,cy=Qs?function(a,u){return Qs(a,"toString",{configurable:!0,enumerable:!1,value:Ll(u),writable:!0})}:pi;function hy(a){return ya(kn(a))}function Ni(a,u,p){var x=-1,M=a.length;u<0&&(u=-u>M?0:M+u),p=p>M?M:p,p<0&&(p+=M),M=u>p?0:p-u>>>0,u>>>=0;for(var I=K(M);++x<M;)I[x]=a[x+u];return I}function dy(a,u){var p;return Dr(a,function(x,M,I){return p=u(x,M,I),!p}),!!p}function ua(a,u,p){var x=0,M=a==null?x:a.length;if(typeof u=="number"&&u===u&&M<=de){for(;x<M;){var I=x+M>>>1,k=a[I];k!==null&&!wi(k)&&(p?k<=u:k<u)?x=I+1:M=I}return M}return al(a,u,pi,p)}function al(a,u,p,x){var M=0,I=a==null?0:a.length;if(I===0)return 0;u=p(u);for(var k=u!==u,B=u===null,W=wi(u),ie=u===t;M<I;){var ne=ta((M+I)/2),ue=p(a[ne]),ge=ue!==t,Me=ue===null,Re=ue===ue,$e=wi(ue);if(k)var Ie=x||Re;else ie?Ie=Re&&(x||ge):B?Ie=Re&&ge&&(x||!Me):W?Ie=Re&&ge&&!Me&&(x||!$e):Me||$e?Ie=!1:Ie=x?ue<=u:ue<u;Ie?M=ne+1:I=ne}return ei(I,pe)}function ih(a,u){for(var p=-1,x=a.length,M=0,I=[];++p<x;){var k=a[p],B=u?u(k):k;if(!p||!Vi(B,W)){var W=B;I[M++]=k===0?0:k}}return I}function rh(a){return typeof a=="number"?a:wi(a)?ae:+a}function bi(a){if(typeof a=="string")return a;if(Be(a))return xt(a,bi)+"";if(wi(a))return Dc?Dc.call(a):"";var u=a+"";return u=="0"&&1/a==-H?"-0":u}function kr(a,u,p){var x=-1,M=$s,I=a.length,k=!0,B=[],W=B;if(p)k=!1,M=Do;else if(I>=n){var ie=u?null:Sy(a);if(ie)return Ws(ie);k=!1,M=Kn,W=new an}else W=u?[]:B;e:for(;++x<I;){var ne=a[x],ue=u?u(ne):ne;if(ne=p||ne!==0?ne:0,k&&ue===ue){for(var ge=W.length;ge--;)if(W[ge]===ue)continue e;u&&W.push(ue),B.push(ne)}else M(W,ue,p)||(W!==B&&W.push(ue),B.push(ne))}return B}function ol(a,u){return u=Fr(u,a),a=Ih(a,u),a==null||delete a[tr(Di(u))]}function nh(a,u,p,x){return ls(a,u,p(ln(a,u)),x)}function ca(a,u,p,x){for(var M=a.length,I=x?M:-1;(x?I--:++I<M)&&u(a[I],I,a););return p?Ni(a,x?0:I,x?I+1:M):Ni(a,x?I+1:0,x?M:I)}function sh(a,u){var p=a;return p instanceof Ye&&(p=p.value()),ko(u,function(x,M){return M.func.apply(M.thisArg,Lr([x],M.args))},p)}function ll(a,u,p){var x=a.length;if(x<2)return x?kr(a[0]):[];for(var M=-1,I=K(x);++M<x;)for(var k=a[M],B=-1;++B<x;)B!=M&&(I[M]=ss(I[M]||k,a[B],u,p));return kr(Zt(I,1),u,p)}function ah(a,u,p){for(var x=-1,M=a.length,I=u.length,k={};++x<M;){var B=x<I?u[x]:t;p(k,a[x],B)}return k}function ul(a){return Lt(a)?a:[]}function cl(a){return typeof a=="function"?a:pi}function Fr(a,u){return Be(a)?a:_l(a,u)?[a]:Dh(at(a))}var fy=We;function zr(a,u,p){var x=a.length;return p=p===t?x:p,!u&&p>=x?a:Ni(a,u,p)}var oh=ev||function(a){return Gt.clearTimeout(a)};function lh(a,u){if(u)return a.slice();var p=a.length,x=Pc?Pc(p):new a.constructor(p);return a.copy(x),x}function hl(a){var u=new a.constructor(a.byteLength);return new Js(u).set(new Js(a)),u}function py(a,u){var p=u?hl(a.buffer):a.buffer;return new a.constructor(p,a.byteOffset,a.byteLength)}function my(a){var u=new a.constructor(a.source,xr.exec(a));return u.lastIndex=a.lastIndex,u}function gy(a){return rs?dt(rs.call(a)):{}}function uh(a,u){var p=u?hl(a.buffer):a.buffer;return new a.constructor(p,a.byteOffset,a.length)}function ch(a,u){if(a!==u){var p=a!==t,x=a===null,M=a===a,I=wi(a),k=u!==t,B=u===null,W=u===u,ie=wi(u);if(!B&&!ie&&!I&&a>u||I&&k&&W&&!B&&!ie||x&&k&&W||!p&&W||!M)return 1;if(!x&&!I&&!ie&&a<u||ie&&p&&M&&!x&&!I||B&&p&&M||!k&&M||!W)return-1}return 0}function vy(a,u,p){for(var x=-1,M=a.criteria,I=u.criteria,k=M.length,B=p.length;++x<k;){var W=ch(M[x],I[x]);if(W){if(x>=B)return W;var ie=p[x];return W*(ie=="desc"?-1:1)}}return a.index-u.index}function hh(a,u,p,x){for(var M=-1,I=a.length,k=p.length,B=-1,W=u.length,ie=Ut(I-k,0),ne=K(W+ie),ue=!x;++B<W;)ne[B]=u[B];for(;++M<k;)(ue||M<I)&&(ne[p[M]]=a[M]);for(;ie--;)ne[B++]=a[M++];return ne}function dh(a,u,p,x){for(var M=-1,I=a.length,k=-1,B=p.length,W=-1,ie=u.length,ne=Ut(I-B,0),ue=K(ne+ie),ge=!x;++M<ne;)ue[M]=a[M];for(var Me=M;++W<ie;)ue[Me+W]=u[W];for(;++k<B;)(ge||M<I)&&(ue[Me+p[k]]=a[M++]);return ue}function hi(a,u){var p=-1,x=a.length;for(u||(u=K(x));++p<x;)u[p]=a[p];return u}function er(a,u,p,x){var M=!p;p||(p={});for(var I=-1,k=u.length;++I<k;){var B=u[I],W=x?x(p[B],a[B],B,p,a):t;W===t&&(W=a[B]),M?hr(p,B,W):ns(p,B,W)}return p}function yy(a,u){return er(a,yl(a),u)}function _y(a,u){return er(a,Eh(a),u)}function ha(a,u){return function(p,x){var M=Be(p)?Mg:Hv,I=u?u():{};return M(p,a,Pe(x,2),I)}}function Ln(a){return We(function(u,p){var x=-1,M=p.length,I=M>1?p[M-1]:t,k=M>2?p[2]:t;for(I=a.length>3&&typeof I=="function"?(M--,I):t,k&&oi(p[0],p[1],k)&&(I=M<3?t:I,M=1),u=dt(u);++x<M;){var B=p[x];B&&a(u,B,x,I)}return u})}function fh(a,u){return function(p,x){if(p==null)return p;if(!di(p))return a(p,x);for(var M=p.length,I=u?M:-1,k=dt(p);(u?I--:++I<M)&&x(k[I],I,k)!==!1;);return p}}function ph(a){return function(u,p,x){for(var M=-1,I=dt(u),k=x(u),B=k.length;B--;){var W=k[a?B:++M];if(p(I[W],W,I)===!1)break}return u}}function xy(a,u,p){var x=u&E,M=us(a);function I(){var k=this&&this!==Gt&&this instanceof I?M:a;return k.apply(x?p:this,arguments)}return I}function mh(a){return function(u){u=at(u);var p=Tn(u)?Hi(u):t,x=p?p[0]:u.charAt(0),M=p?zr(p,1).join(""):u.slice(1);return x[a]()+M}}function On(a){return function(u){return ko(fd(dd(u).replace(cg,"")),a,"")}}function us(a){return function(){var u=arguments;switch(u.length){case 0:return new a;case 1:return new a(u[0]);case 2:return new a(u[0],u[1]);case 3:return new a(u[0],u[1],u[2]);case 4:return new a(u[0],u[1],u[2],u[3]);case 5:return new a(u[0],u[1],u[2],u[3],u[4]);case 6:return new a(u[0],u[1],u[2],u[3],u[4],u[5]);case 7:return new a(u[0],u[1],u[2],u[3],u[4],u[5],u[6])}var p=In(a.prototype),x=a.apply(p,u);return St(x)?x:p}}function by(a,u,p){var x=us(a);function M(){for(var I=arguments.length,k=K(I),B=I,W=Nn(M);B--;)k[B]=arguments[B];var ie=I<3&&k[0]!==W&&k[I-1]!==W?[]:Or(k,W);if(I-=ie.length,I<p)return xh(a,u,da,M.placeholder,t,k,ie,t,t,p-I);var ne=this&&this!==Gt&&this instanceof M?x:a;return _i(ne,this,k)}return M}function gh(a){return function(u,p,x){var M=dt(u);if(!di(u)){var I=Pe(p,3);u=Wt(u),p=function(B){return I(M[B],B,M)}}var k=a(u,p,x);return k>-1?M[I?u[k]:k]:t}}function vh(a){return fr(function(u){var p=u.length,x=p,M=Li.prototype.thru;for(a&&u.reverse();x--;){var I=u[x];if(typeof I!="function")throw new Ii(c);if(M&&!k&&ga(I)=="wrapper")var k=new Li([],!0)}for(x=k?x:p;++x<p;){I=u[x];var B=ga(I),W=B=="wrapper"?gl(I):t;W&&xl(W[0])&&W[1]==(L|P|R|N)&&!W[4].length&&W[9]==1?k=k[ga(W[0])].apply(k,W[3]):k=I.length==1&&xl(I)?k[B]():k.thru(I)}return function(){var ie=arguments,ne=ie[0];if(k&&ie.length==1&&Be(ne))return k.plant(ne).value();for(var ue=0,ge=p?u[ue].apply(this,ie):ne;++ue<p;)ge=u[ue].call(this,ge);return ge}})}function da(a,u,p,x,M,I,k,B,W,ie){var ne=u&L,ue=u&E,ge=u&T,Me=u&(P|O),Re=u&U,$e=ge?t:us(a);function Ie(){for(var Xe=arguments.length,Ke=K(Xe),Si=Xe;Si--;)Ke[Si]=arguments[Si];if(Me)var li=Nn(Ie),Mi=Og(Ke,li);if(x&&(Ke=hh(Ke,x,M,Me)),I&&(Ke=dh(Ke,I,k,Me)),Xe-=Mi,Me&&Xe<ie){var Ot=Or(Ke,li);return xh(a,u,da,Ie.placeholder,p,Ke,Ot,B,W,ie-Xe)}var Wi=ue?p:this,vr=ge?Wi[a]:a;return Xe=Ke.length,B?Ke=Hy(Ke,B):Re&&Xe>1&&Ke.reverse(),ne&&W<Xe&&(Ke.length=W),this&&this!==Gt&&this instanceof Ie&&(vr=$e||us(vr)),vr.apply(Wi,Ke)}return Ie}function yh(a,u){return function(p,x){return Zv(p,a,u(x),{})}}function fa(a,u){return function(p,x){var M;if(p===t&&x===t)return u;if(p!==t&&(M=p),x!==t){if(M===t)return x;typeof p=="string"||typeof x=="string"?(p=bi(p),x=bi(x)):(p=rh(p),x=rh(x)),M=a(p,x)}return M}}function dl(a){return fr(function(u){return u=xt(u,xi(Pe())),We(function(p){var x=this;return a(u,function(M){return _i(M,x,p)})})})}function pa(a,u){u=u===t?" ":bi(u);var p=u.length;if(p<2)return p?sl(u,a):u;var x=sl(u,ea(a/An(u)));return Tn(u)?zr(Hi(x),0,a).join(""):x.slice(0,a)}function wy(a,u,p,x){var M=u&E,I=us(a);function k(){for(var B=-1,W=arguments.length,ie=-1,ne=x.length,ue=K(ne+W),ge=this&&this!==Gt&&this instanceof k?I:a;++ie<ne;)ue[ie]=x[ie];for(;W--;)ue[ie++]=arguments[++B];return _i(ge,M?p:this,ue)}return k}function _h(a){return function(u,p,x){return x&&typeof x!="number"&&oi(u,p,x)&&(p=x=t),u=gr(u),p===t?(p=u,u=0):p=gr(p),x=x===t?u<p?1:-1:gr(x),oy(u,p,x,a)}}function ma(a){return function(u,p){return typeof u=="string"&&typeof p=="string"||(u=ki(u),p=ki(p)),a(u,p)}}function xh(a,u,p,x,M,I,k,B,W,ie){var ne=u&P,ue=ne?k:t,ge=ne?t:k,Me=ne?I:t,Re=ne?t:I;u|=ne?R:D,u&=~(ne?D:R),u&A||(u&=~(E|T));var $e=[a,u,M,Me,ue,Re,ge,B,W,ie],Ie=p.apply(t,$e);return xl(a)&&Lh(Ie,$e),Ie.placeholder=x,Oh(Ie,a,u)}function fl(a){var u=Bt[a];return function(p,x){if(p=ki(p),x=x==null?0:ei(He(x),292),x&&Oc(p)){var M=(at(p)+"e").split("e"),I=u(M[0]+"e"+(+M[1]+x));return M=(at(I)+"e").split("e"),+(M[0]+"e"+(+M[1]-x))}return u(p)}}var Sy=Pn&&1/Ws(new Pn([,-0]))[1]==H?function(a){return new Pn(a)}:Dl;function bh(a){return function(u){var p=ti(u);return p==Ne?Vo(u):p==Pt?Ug(u):Lg(u,a(u))}}function dr(a,u,p,x,M,I,k,B){var W=u&T;if(!W&&typeof a!="function")throw new Ii(c);var ie=x?x.length:0;if(ie||(u&=~(R|D),x=M=t),k=k===t?k:Ut(He(k),0),B=B===t?B:He(B),ie-=M?M.length:0,u&D){var ne=x,ue=M;x=M=t}var ge=W?t:gl(a),Me=[a,u,p,x,M,ne,ue,I,k,B];if(ge&&zy(Me,ge),a=Me[0],u=Me[1],p=Me[2],x=Me[3],M=Me[4],B=Me[9]=Me[9]===t?W?0:a.length:Ut(Me[9]-ie,0),!B&&u&(P|O)&&(u&=~(P|O)),!u||u==E)var Re=xy(a,u,p);else u==P||u==O?Re=by(a,u,B):(u==R||u==(E|R))&&!M.length?Re=wy(a,u,p,x):Re=da.apply(t,Me);var $e=ge?th:Lh;return Oh($e(Re,Me),a,u)}function wh(a,u,p,x){return a===t||Vi(a,Cn[p])&&!ot.call(x,p)?u:a}function Sh(a,u,p,x,M,I){return St(a)&&St(u)&&(I.set(u,a),la(a,u,t,Sh,I),I.delete(u)),a}function My(a){return ds(a)?t:a}function Mh(a,u,p,x,M,I){var k=p&b,B=a.length,W=u.length;if(B!=W&&!(k&&W>B))return!1;var ie=I.get(a),ne=I.get(u);if(ie&&ne)return ie==u&&ne==a;var ue=-1,ge=!0,Me=p&S?new an:t;for(I.set(a,u),I.set(u,a);++ue<B;){var Re=a[ue],$e=u[ue];if(x)var Ie=k?x($e,Re,ue,u,a,I):x(Re,$e,ue,a,u,I);if(Ie!==t){if(Ie)continue;ge=!1;break}if(Me){if(!Fo(u,function(Xe,Ke){if(!Kn(Me,Ke)&&(Re===Xe||M(Re,Xe,p,x,I)))return Me.push(Ke)})){ge=!1;break}}else if(!(Re===$e||M(Re,$e,p,x,I))){ge=!1;break}}return I.delete(a),I.delete(u),ge}function Ey(a,u,p,x,M,I,k){switch(p){case xe:if(a.byteLength!=u.byteLength||a.byteOffset!=u.byteOffset)return!1;a=a.buffer,u=u.buffer;case gt:return!(a.byteLength!=u.byteLength||!I(new Js(a),new Js(u)));case me:case De:case Ge:return Vi(+a,+u);case Ce:return a.name==u.name&&a.message==u.message;case kt:case _e:return a==u+"";case Ne:var B=Vo;case Pt:var W=x&b;if(B||(B=Ws),a.size!=u.size&&!W)return!1;var ie=k.get(a);if(ie)return ie==u;x|=S,k.set(a,u);var ne=Mh(B(a),B(u),x,M,I,k);return k.delete(a),ne;case ce:if(rs)return rs.call(a)==rs.call(u)}return!1}function Ty(a,u,p,x,M,I){var k=p&b,B=pl(a),W=B.length,ie=pl(u),ne=ie.length;if(W!=ne&&!k)return!1;for(var ue=W;ue--;){var ge=B[ue];if(!(k?ge in u:ot.call(u,ge)))return!1}var Me=I.get(a),Re=I.get(u);if(Me&&Re)return Me==u&&Re==a;var $e=!0;I.set(a,u),I.set(u,a);for(var Ie=k;++ue<W;){ge=B[ue];var Xe=a[ge],Ke=u[ge];if(x)var Si=k?x(Ke,Xe,ge,u,a,I):x(Xe,Ke,ge,a,u,I);if(!(Si===t?Xe===Ke||M(Xe,Ke,p,x,I):Si)){$e=!1;break}Ie||(Ie=ge=="constructor")}if($e&&!Ie){var li=a.constructor,Mi=u.constructor;li!=Mi&&"constructor"in a&&"constructor"in u&&!(typeof li=="function"&&li instanceof li&&typeof Mi=="function"&&Mi instanceof Mi)&&($e=!1)}return I.delete(a),I.delete(u),$e}function fr(a){return wl(Rh(a,t,Bh),a+"")}function pl(a){return Wc(a,Wt,yl)}function ml(a){return Wc(a,fi,Eh)}var gl=ia?function(a){return ia.get(a)}:Dl;function ga(a){for(var u=a.name+"",p=Rn[u],x=ot.call(Rn,u)?p.length:0;x--;){var M=p[x],I=M.func;if(I==null||I==a)return M.name}return u}function Nn(a){var u=ot.call(C,"placeholder")?C:a;return u.placeholder}function Pe(){var a=C.iteratee||Ol;return a=a===Ol?qc:a,arguments.length?a(arguments[0],arguments[1]):a}function va(a,u){var p=a.__data__;return Ny(u)?p[typeof u=="string"?"string":"hash"]:p.map}function vl(a){for(var u=Wt(a),p=u.length;p--;){var x=u[p],M=a[x];u[p]=[x,M,Ch(M)]}return u}function un(a,u){var p=Fg(a,u);return Gc(p)?p:t}function Ay(a){var u=ot.call(a,nn),p=a[nn];try{a[nn]=t;var x=!0}catch{}var M=Xs.call(a);return x&&(u?a[nn]=p:delete a[nn]),M}var yl=jo?function(a){return a==null?[]:(a=dt(a),Ir(jo(a),function(u){return Ic.call(a,u)}))}:kl,Eh=jo?function(a){for(var u=[];a;)Lr(u,yl(a)),a=Ys(a);return u}:kl,ti=ai;(Go&&ti(new Go(new ArrayBuffer(1)))!=xe||es&&ti(new es)!=Ne||qo&&ti(qo.resolve())!=bt||Pn&&ti(new Pn)!=Pt||ts&&ti(new ts)!=et)&&(ti=function(a){var u=ai(a),p=u==it?a.constructor:t,x=p?cn(p):"";if(x)switch(x){case uv:return xe;case cv:return Ne;case hv:return bt;case dv:return Pt;case fv:return et}return u});function Cy(a,u,p){for(var x=-1,M=p.length;++x<M;){var I=p[x],k=I.size;switch(I.type){case"drop":a+=k;break;case"dropRight":u-=k;break;case"take":u=ei(u,a+k);break;case"takeRight":a=Ut(a,u-k);break}}return{start:a,end:u}}function Py(a){var u=a.match(qe);return u?u[1].split(st):[]}function Th(a,u,p){u=Fr(u,a);for(var x=-1,M=u.length,I=!1;++x<M;){var k=tr(u[x]);if(!(I=a!=null&&p(a,k)))break;a=a[k]}return I||++x!=M?I:(M=a==null?0:a.length,!!M&&Ma(M)&&pr(k,M)&&(Be(a)||hn(a)))}function Ry(a){var u=a.length,p=new a.constructor(u);return u&&typeof a[0]=="string"&&ot.call(a,"index")&&(p.index=a.index,p.input=a.input),p}function Ah(a){return typeof a.constructor=="function"&&!cs(a)?In(Ys(a)):{}}function Iy(a,u,p){var x=a.constructor;switch(u){case gt:return hl(a);case me:case De:return new x(+a);case xe:return py(a,p);case we:case Ve:case ut:case lt:case Ee:case _t:case wt:case Xt:case Ft:return uh(a,p);case Ne:return new x;case Ge:case _e:return new x(a);case kt:return my(a);case Pt:return new x;case ce:return gy(a)}}function Ly(a,u){var p=u.length;if(!p)return a;var x=p-1;return u[x]=(p>1?"& ":"")+u[x],u=u.join(p>2?", ":" "),a.replace(tt,`{
/* [wrapped with `+u+`] */
`)}function Oy(a){return Be(a)||hn(a)||!!(Lc&&a&&a[Lc])}function pr(a,u){var p=typeof a;return u=u??X,!!u&&(p=="number"||p!="symbol"&&co.test(a))&&a>-1&&a%1==0&&a<u}function oi(a,u,p){if(!St(p))return!1;var x=typeof u;return(x=="number"?di(p)&&pr(u,p.length):x=="string"&&u in p)?Vi(p[u],a):!1}function _l(a,u){if(Be(a))return!1;var p=typeof a;return p=="number"||p=="symbol"||p=="boolean"||a==null||wi(a)?!0:vu.test(a)||!uo.test(a)||u!=null&&a in dt(u)}function Ny(a){var u=typeof a;return u=="string"||u=="number"||u=="symbol"||u=="boolean"?a!=="__proto__":a===null}function xl(a){var u=ga(a),p=C[u];if(typeof p!="function"||!(u in Ye.prototype))return!1;if(a===p)return!0;var x=gl(p);return!!x&&a===x[0]}function Dy(a){return!!Cc&&Cc in a}var ky=Gs?mr:Fl;function cs(a){var u=a&&a.constructor,p=typeof u=="function"&&u.prototype||Cn;return a===p}function Ch(a){return a===a&&!St(a)}function Ph(a,u){return function(p){return p==null?!1:p[a]===u&&(u!==t||a in dt(p))}}function Fy(a){var u=wa(a,function(x){return p.size===f&&p.clear(),x}),p=u.cache;return u}function zy(a,u){var p=a[1],x=u[1],M=p|x,I=M<(E|T|L),k=x==L&&p==P||x==L&&p==N&&a[7].length<=u[8]||x==(L|N)&&u[7].length<=u[8]&&p==P;if(!(I||k))return a;x&E&&(a[2]=u[2],M|=p&E?0:A);var B=u[3];if(B){var W=a[3];a[3]=W?hh(W,B,u[4]):B,a[4]=W?Or(a[3],m):u[4]}return B=u[5],B&&(W=a[5],a[5]=W?dh(W,B,u[6]):B,a[6]=W?Or(a[5],m):u[6]),B=u[7],B&&(a[7]=B),x&L&&(a[8]=a[8]==null?u[8]:ei(a[8],u[8])),a[9]==null&&(a[9]=u[9]),a[0]=u[0],a[1]=M,a}function By(a){var u=[];if(a!=null)for(var p in dt(a))u.push(p);return u}function Uy(a){return Xs.call(a)}function Rh(a,u,p){return u=Ut(u===t?a.length-1:u,0),function(){for(var x=arguments,M=-1,I=Ut(x.length-u,0),k=K(I);++M<I;)k[M]=x[u+M];M=-1;for(var B=K(u+1);++M<u;)B[M]=x[M];return B[u]=p(k),_i(a,this,B)}}function Ih(a,u){return u.length<2?a:ln(a,Ni(u,0,-1))}function Hy(a,u){for(var p=a.length,x=ei(u.length,p),M=hi(a);x--;){var I=u[x];a[x]=pr(I,p)?M[I]:t}return a}function bl(a,u){if(!(u==="constructor"&&typeof a[u]=="function")&&u!="__proto__")return a[u]}var Lh=Nh(th),hs=iv||function(a,u){return Gt.setTimeout(a,u)},wl=Nh(cy);function Oh(a,u,p){var x=u+"";return wl(a,Ly(x,$y(Py(x),p)))}function Nh(a){var u=0,p=0;return function(){var x=av(),M=J-(x-p);if(p=x,M>0){if(++u>=G)return arguments[0]}else u=0;return a.apply(t,arguments)}}function ya(a,u){var p=-1,x=a.length,M=x-1;for(u=u===t?x:u;++p<u;){var I=nl(p,M),k=a[I];a[I]=a[p],a[p]=k}return a.length=u,a}var Dh=Fy(function(a){var u=[];return a.charCodeAt(0)===46&&u.push(""),a.replace(yu,function(p,x,M,I){u.push(M?I.replace(yi,"$1"):x||p)}),u});function tr(a){if(typeof a=="string"||wi(a))return a;var u=a+"";return u=="0"&&1/a==-H?"-0":u}function cn(a){if(a!=null){try{return qs.call(a)}catch{}try{return a+""}catch{}}return""}function $y(a,u){return Ri(ee,function(p){var x="_."+p[0];u&p[1]&&!$s(a,x)&&a.push(x)}),a.sort()}function kh(a){if(a instanceof Ye)return a.clone();var u=new Li(a.__wrapped__,a.__chain__);return u.__actions__=hi(a.__actions__),u.__index__=a.__index__,u.__values__=a.__values__,u}function Vy(a,u,p){(p?oi(a,u,p):u===t)?u=1:u=Ut(He(u),0);var x=a==null?0:a.length;if(!x||u<1)return[];for(var M=0,I=0,k=K(ea(x/u));M<x;)k[I++]=Ni(a,M,M+=u);return k}function Wy(a){for(var u=-1,p=a==null?0:a.length,x=0,M=[];++u<p;){var I=a[u];I&&(M[x++]=I)}return M}function jy(){var a=arguments.length;if(!a)return[];for(var u=K(a-1),p=arguments[0],x=a;x--;)u[x-1]=arguments[x];return Lr(Be(p)?hi(p):[p],Zt(u,1))}var Gy=We(function(a,u){return Lt(a)?ss(a,Zt(u,1,Lt,!0)):[]}),qy=We(function(a,u){var p=Di(u);return Lt(p)&&(p=t),Lt(a)?ss(a,Zt(u,1,Lt,!0),Pe(p,2)):[]}),Xy=We(function(a,u){var p=Di(u);return Lt(p)&&(p=t),Lt(a)?ss(a,Zt(u,1,Lt,!0),t,p):[]});function Zy(a,u,p){var x=a==null?0:a.length;return x?(u=p||u===t?1:He(u),Ni(a,u<0?0:u,x)):[]}function Jy(a,u,p){var x=a==null?0:a.length;return x?(u=p||u===t?1:He(u),u=x-u,Ni(a,0,u<0?0:u)):[]}function Yy(a,u){return a&&a.length?ca(a,Pe(u,3),!0,!0):[]}function Ky(a,u){return a&&a.length?ca(a,Pe(u,3),!0):[]}function Qy(a,u,p,x){var M=a==null?0:a.length;return M?(p&&typeof p!="number"&&oi(a,u,p)&&(p=0,x=M),jv(a,u,p,x)):[]}function Fh(a,u,p){var x=a==null?0:a.length;if(!x)return-1;var M=p==null?0:He(p);return M<0&&(M=Ut(x+M,0)),Vs(a,Pe(u,3),M)}function zh(a,u,p){var x=a==null?0:a.length;if(!x)return-1;var M=x-1;return p!==t&&(M=He(p),M=p<0?Ut(x+M,0):ei(M,x-1)),Vs(a,Pe(u,3),M,!0)}function Bh(a){var u=a==null?0:a.length;return u?Zt(a,1):[]}function e0(a){var u=a==null?0:a.length;return u?Zt(a,H):[]}function t0(a,u){var p=a==null?0:a.length;return p?(u=u===t?1:He(u),Zt(a,u)):[]}function i0(a){for(var u=-1,p=a==null?0:a.length,x={};++u<p;){var M=a[u];x[M[0]]=M[1]}return x}function Uh(a){return a&&a.length?a[0]:t}function r0(a,u,p){var x=a==null?0:a.length;if(!x)return-1;var M=p==null?0:He(p);return M<0&&(M=Ut(x+M,0)),En(a,u,M)}function n0(a){var u=a==null?0:a.length;return u?Ni(a,0,-1):[]}var s0=We(function(a){var u=xt(a,ul);return u.length&&u[0]===a[0]?Qo(u):[]}),a0=We(function(a){var u=Di(a),p=xt(a,ul);return u===Di(p)?u=t:p.pop(),p.length&&p[0]===a[0]?Qo(p,Pe(u,2)):[]}),o0=We(function(a){var u=Di(a),p=xt(a,ul);return u=typeof u=="function"?u:t,u&&p.pop(),p.length&&p[0]===a[0]?Qo(p,t,u):[]});function l0(a,u){return a==null?"":nv.call(a,u)}function Di(a){var u=a==null?0:a.length;return u?a[u-1]:t}function u0(a,u,p){var x=a==null?0:a.length;if(!x)return-1;var M=x;return p!==t&&(M=He(p),M=M<0?Ut(x+M,0):ei(M,x-1)),u===u?$g(a,u,M):Vs(a,xc,M,!0)}function c0(a,u){return a&&a.length?Yc(a,He(u)):t}var h0=We(Hh);function Hh(a,u){return a&&a.length&&u&&u.length?rl(a,u):a}function d0(a,u,p){return a&&a.length&&u&&u.length?rl(a,u,Pe(p,2)):a}function f0(a,u,p){return a&&a.length&&u&&u.length?rl(a,u,t,p):a}var p0=fr(function(a,u){var p=a==null?0:a.length,x=Zo(a,u);return eh(a,xt(u,function(M){return pr(M,p)?+M:M}).sort(ch)),x});function m0(a,u){var p=[];if(!(a&&a.length))return p;var x=-1,M=[],I=a.length;for(u=Pe(u,3);++x<I;){var k=a[x];u(k,x,a)&&(p.push(k),M.push(x))}return eh(a,M),p}function Sl(a){return a==null?a:lv.call(a)}function g0(a,u,p){var x=a==null?0:a.length;return x?(p&&typeof p!="number"&&oi(a,u,p)?(u=0,p=x):(u=u==null?0:He(u),p=p===t?x:He(p)),Ni(a,u,p)):[]}function v0(a,u){return ua(a,u)}function y0(a,u,p){return al(a,u,Pe(p,2))}function _0(a,u){var p=a==null?0:a.length;if(p){var x=ua(a,u);if(x<p&&Vi(a[x],u))return x}return-1}function x0(a,u){return ua(a,u,!0)}function b0(a,u,p){return al(a,u,Pe(p,2),!0)}function w0(a,u){var p=a==null?0:a.length;if(p){var x=ua(a,u,!0)-1;if(Vi(a[x],u))return x}return-1}function S0(a){return a&&a.length?ih(a):[]}function M0(a,u){return a&&a.length?ih(a,Pe(u,2)):[]}function E0(a){var u=a==null?0:a.length;return u?Ni(a,1,u):[]}function T0(a,u,p){return a&&a.length?(u=p||u===t?1:He(u),Ni(a,0,u<0?0:u)):[]}function A0(a,u,p){var x=a==null?0:a.length;return x?(u=p||u===t?1:He(u),u=x-u,Ni(a,u<0?0:u,x)):[]}function C0(a,u){return a&&a.length?ca(a,Pe(u,3),!1,!0):[]}function P0(a,u){return a&&a.length?ca(a,Pe(u,3)):[]}var R0=We(function(a){return kr(Zt(a,1,Lt,!0))}),I0=We(function(a){var u=Di(a);return Lt(u)&&(u=t),kr(Zt(a,1,Lt,!0),Pe(u,2))}),L0=We(function(a){var u=Di(a);return u=typeof u=="function"?u:t,kr(Zt(a,1,Lt,!0),t,u)});function O0(a){return a&&a.length?kr(a):[]}function N0(a,u){return a&&a.length?kr(a,Pe(u,2)):[]}function D0(a,u){return u=typeof u=="function"?u:t,a&&a.length?kr(a,t,u):[]}function Ml(a){if(!(a&&a.length))return[];var u=0;return a=Ir(a,function(p){if(Lt(p))return u=Ut(p.length,u),!0}),Ho(u,function(p){return xt(a,zo(p))})}function $h(a,u){if(!(a&&a.length))return[];var p=Ml(a);return u==null?p:xt(p,function(x){return _i(u,t,x)})}var k0=We(function(a,u){return Lt(a)?ss(a,u):[]}),F0=We(function(a){return ll(Ir(a,Lt))}),z0=We(function(a){var u=Di(a);return Lt(u)&&(u=t),ll(Ir(a,Lt),Pe(u,2))}),B0=We(function(a){var u=Di(a);return u=typeof u=="function"?u:t,ll(Ir(a,Lt),t,u)}),U0=We(Ml);function H0(a,u){return ah(a||[],u||[],ns)}function $0(a,u){return ah(a||[],u||[],ls)}var V0=We(function(a){var u=a.length,p=u>1?a[u-1]:t;return p=typeof p=="function"?(a.pop(),p):t,$h(a,p)});function Vh(a){var u=C(a);return u.__chain__=!0,u}function W0(a,u){return u(a),a}function _a(a,u){return u(a)}var j0=fr(function(a){var u=a.length,p=u?a[0]:0,x=this.__wrapped__,M=function(I){return Zo(I,a)};return u>1||this.__actions__.length||!(x instanceof Ye)||!pr(p)?this.thru(M):(x=x.slice(p,+p+(u?1:0)),x.__actions__.push({func:_a,args:[M],thisArg:t}),new Li(x,this.__chain__).thru(function(I){return u&&!I.length&&I.push(t),I}))});function G0(){return Vh(this)}function q0(){return new Li(this.value(),this.__chain__)}function X0(){this.__values__===t&&(this.__values__=rd(this.value()));var a=this.__index__>=this.__values__.length,u=a?t:this.__values__[this.__index__++];return{done:a,value:u}}function Z0(){return this}function J0(a){for(var u,p=this;p instanceof na;){var x=kh(p);x.__index__=0,x.__values__=t,u?M.__wrapped__=x:u=x;var M=x;p=p.__wrapped__}return M.__wrapped__=a,u}function Y0(){var a=this.__wrapped__;if(a instanceof Ye){var u=a;return this.__actions__.length&&(u=new Ye(this)),u=u.reverse(),u.__actions__.push({func:_a,args:[Sl],thisArg:t}),new Li(u,this.__chain__)}return this.thru(Sl)}function K0(){return sh(this.__wrapped__,this.__actions__)}var Q0=ha(function(a,u,p){ot.call(a,p)?++a[p]:hr(a,p,1)});function e_(a,u,p){var x=Be(a)?yc:Wv;return p&&oi(a,u,p)&&(u=t),x(a,Pe(u,3))}function t_(a,u){var p=Be(a)?Ir:$c;return p(a,Pe(u,3))}var i_=gh(Fh),r_=gh(zh);function n_(a,u){return Zt(xa(a,u),1)}function s_(a,u){return Zt(xa(a,u),H)}function a_(a,u,p){return p=p===t?1:He(p),Zt(xa(a,u),p)}function Wh(a,u){var p=Be(a)?Ri:Dr;return p(a,Pe(u,3))}function jh(a,u){var p=Be(a)?Eg:Hc;return p(a,Pe(u,3))}var o_=ha(function(a,u,p){ot.call(a,p)?a[p].push(u):hr(a,p,[u])});function l_(a,u,p,x){a=di(a)?a:kn(a),p=p&&!x?He(p):0;var M=a.length;return p<0&&(p=Ut(M+p,0)),Ea(a)?p<=M&&a.indexOf(u,p)>-1:!!M&&En(a,u,p)>-1}var u_=We(function(a,u,p){var x=-1,M=typeof u=="function",I=di(a)?K(a.length):[];return Dr(a,function(k){I[++x]=M?_i(u,k,p):as(k,u,p)}),I}),c_=ha(function(a,u,p){hr(a,p,u)});function xa(a,u){var p=Be(a)?xt:Xc;return p(a,Pe(u,3))}function h_(a,u,p,x){return a==null?[]:(Be(u)||(u=u==null?[]:[u]),p=x?t:p,Be(p)||(p=p==null?[]:[p]),Kc(a,u,p))}var d_=ha(function(a,u,p){a[p?0:1].push(u)},function(){return[[],[]]});function f_(a,u,p){var x=Be(a)?ko:wc,M=arguments.length<3;return x(a,Pe(u,4),p,M,Dr)}function p_(a,u,p){var x=Be(a)?Tg:wc,M=arguments.length<3;return x(a,Pe(u,4),p,M,Hc)}function m_(a,u){var p=Be(a)?Ir:$c;return p(a,Sa(Pe(u,3)))}function g_(a){var u=Be(a)?Fc:ly;return u(a)}function v_(a,u,p){(p?oi(a,u,p):u===t)?u=1:u=He(u);var x=Be(a)?Bv:uy;return x(a,u)}function y_(a){var u=Be(a)?Uv:hy;return u(a)}function __(a){if(a==null)return 0;if(di(a))return Ea(a)?An(a):a.length;var u=ti(a);return u==Ne||u==Pt?a.size:tl(a).length}function x_(a,u,p){var x=Be(a)?Fo:dy;return p&&oi(a,u,p)&&(u=t),x(a,Pe(u,3))}var b_=We(function(a,u){if(a==null)return[];var p=u.length;return p>1&&oi(a,u[0],u[1])?u=[]:p>2&&oi(u[0],u[1],u[2])&&(u=[u[0]]),Kc(a,Zt(u,1),[])}),ba=tv||function(){return Gt.Date.now()};function w_(a,u){if(typeof u!="function")throw new Ii(c);return a=He(a),function(){if(--a<1)return u.apply(this,arguments)}}function Gh(a,u,p){return u=p?t:u,u=a&&u==null?a.length:u,dr(a,L,t,t,t,t,u)}function qh(a,u){var p;if(typeof u!="function")throw new Ii(c);return a=He(a),function(){return--a>0&&(p=u.apply(this,arguments)),a<=1&&(u=t),p}}var El=We(function(a,u,p){var x=E;if(p.length){var M=Or(p,Nn(El));x|=R}return dr(a,x,u,p,M)}),Xh=We(function(a,u,p){var x=E|T;if(p.length){var M=Or(p,Nn(Xh));x|=R}return dr(u,x,a,p,M)});function Zh(a,u,p){u=p?t:u;var x=dr(a,P,t,t,t,t,t,u);return x.placeholder=Zh.placeholder,x}function Jh(a,u,p){u=p?t:u;var x=dr(a,O,t,t,t,t,t,u);return x.placeholder=Jh.placeholder,x}function Yh(a,u,p){var x,M,I,k,B,W,ie=0,ne=!1,ue=!1,ge=!0;if(typeof a!="function")throw new Ii(c);u=ki(u)||0,St(p)&&(ne=!!p.leading,ue="maxWait"in p,I=ue?Ut(ki(p.maxWait)||0,u):I,ge="trailing"in p?!!p.trailing:ge);function Me(Ot){var Wi=x,vr=M;return x=M=t,ie=Ot,k=a.apply(vr,Wi),k}function Re(Ot){return ie=Ot,B=hs(Xe,u),ne?Me(Ot):k}function $e(Ot){var Wi=Ot-W,vr=Ot-ie,gd=u-Wi;return ue?ei(gd,I-vr):gd}function Ie(Ot){var Wi=Ot-W,vr=Ot-ie;return W===t||Wi>=u||Wi<0||ue&&vr>=I}function Xe(){var Ot=ba();if(Ie(Ot))return Ke(Ot);B=hs(Xe,$e(Ot))}function Ke(Ot){return B=t,ge&&x?Me(Ot):(x=M=t,k)}function Si(){B!==t&&oh(B),ie=0,x=W=M=B=t}function li(){return B===t?k:Ke(ba())}function Mi(){var Ot=ba(),Wi=Ie(Ot);if(x=arguments,M=this,W=Ot,Wi){if(B===t)return Re(W);if(ue)return oh(B),B=hs(Xe,u),Me(W)}return B===t&&(B=hs(Xe,u)),k}return Mi.cancel=Si,Mi.flush=li,Mi}var S_=We(function(a,u){return Uc(a,1,u)}),M_=We(function(a,u,p){return Uc(a,ki(u)||0,p)});function E_(a){return dr(a,U)}function wa(a,u){if(typeof a!="function"||u!=null&&typeof u!="function")throw new Ii(c);var p=function(){var x=arguments,M=u?u.apply(this,x):x[0],I=p.cache;if(I.has(M))return I.get(M);var k=a.apply(this,x);return p.cache=I.set(M,k)||I,k};return p.cache=new(wa.Cache||cr),p}wa.Cache=cr;function Sa(a){if(typeof a!="function")throw new Ii(c);return function(){var u=arguments;switch(u.length){case 0:return!a.call(this);case 1:return!a.call(this,u[0]);case 2:return!a.call(this,u[0],u[1]);case 3:return!a.call(this,u[0],u[1],u[2])}return!a.apply(this,u)}}function T_(a){return qh(2,a)}var A_=fy(function(a,u){u=u.length==1&&Be(u[0])?xt(u[0],xi(Pe())):xt(Zt(u,1),xi(Pe()));var p=u.length;return We(function(x){for(var M=-1,I=ei(x.length,p);++M<I;)x[M]=u[M].call(this,x[M]);return _i(a,this,x)})}),Tl=We(function(a,u){var p=Or(u,Nn(Tl));return dr(a,R,t,u,p)}),Kh=We(function(a,u){var p=Or(u,Nn(Kh));return dr(a,D,t,u,p)}),C_=fr(function(a,u){return dr(a,N,t,t,t,u)});function P_(a,u){if(typeof a!="function")throw new Ii(c);return u=u===t?u:He(u),We(a,u)}function R_(a,u){if(typeof a!="function")throw new Ii(c);return u=u==null?0:Ut(He(u),0),We(function(p){var x=p[u],M=zr(p,0,u);return x&&Lr(M,x),_i(a,this,M)})}function I_(a,u,p){var x=!0,M=!0;if(typeof a!="function")throw new Ii(c);return St(p)&&(x="leading"in p?!!p.leading:x,M="trailing"in p?!!p.trailing:M),Yh(a,u,{leading:x,maxWait:u,trailing:M})}function L_(a){return Gh(a,1)}function O_(a,u){return Tl(cl(u),a)}function N_(){if(!arguments.length)return[];var a=arguments[0];return Be(a)?a:[a]}function D_(a){return Oi(a,_)}function k_(a,u){return u=typeof u=="function"?u:t,Oi(a,_,u)}function F_(a){return Oi(a,g|_)}function z_(a,u){return u=typeof u=="function"?u:t,Oi(a,g|_,u)}function B_(a,u){return u==null||Bc(a,u,Wt(u))}function Vi(a,u){return a===u||a!==a&&u!==u}var U_=ma(Ko),H_=ma(function(a,u){return a>=u}),hn=jc(function(){return arguments}())?jc:function(a){return Tt(a)&&ot.call(a,"callee")&&!Ic.call(a,"callee")},Be=K.isArray,$_=dc?xi(dc):Jv;function di(a){return a!=null&&Ma(a.length)&&!mr(a)}function Lt(a){return Tt(a)&&di(a)}function V_(a){return a===!0||a===!1||Tt(a)&&ai(a)==me}var Br=rv||Fl,W_=fc?xi(fc):Yv;function j_(a){return Tt(a)&&a.nodeType===1&&!ds(a)}function G_(a){if(a==null)return!0;if(di(a)&&(Be(a)||typeof a=="string"||typeof a.splice=="function"||Br(a)||Dn(a)||hn(a)))return!a.length;var u=ti(a);if(u==Ne||u==Pt)return!a.size;if(cs(a))return!tl(a).length;for(var p in a)if(ot.call(a,p))return!1;return!0}function q_(a,u){return os(a,u)}function X_(a,u,p){p=typeof p=="function"?p:t;var x=p?p(a,u):t;return x===t?os(a,u,t,p):!!x}function Al(a){if(!Tt(a))return!1;var u=ai(a);return u==Ce||u==Le||typeof a.message=="string"&&typeof a.name=="string"&&!ds(a)}function Z_(a){return typeof a=="number"&&Oc(a)}function mr(a){if(!St(a))return!1;var u=ai(a);return u==Ae||u==Ue||u==fe||u==Kt}function Qh(a){return typeof a=="number"&&a==He(a)}function Ma(a){return typeof a=="number"&&a>-1&&a%1==0&&a<=X}function St(a){var u=typeof a;return a!=null&&(u=="object"||u=="function")}function Tt(a){return a!=null&&typeof a=="object"}var ed=pc?xi(pc):Qv;function J_(a,u){return a===u||el(a,u,vl(u))}function Y_(a,u,p){return p=typeof p=="function"?p:t,el(a,u,vl(u),p)}function K_(a){return td(a)&&a!=+a}function Q_(a){if(ky(a))throw new ze(l);return Gc(a)}function ex(a){return a===null}function tx(a){return a==null}function td(a){return typeof a=="number"||Tt(a)&&ai(a)==Ge}function ds(a){if(!Tt(a)||ai(a)!=it)return!1;var u=Ys(a);if(u===null)return!0;var p=ot.call(u,"constructor")&&u.constructor;return typeof p=="function"&&p instanceof p&&qs.call(p)==Yg}var Cl=mc?xi(mc):ey;function ix(a){return Qh(a)&&a>=-X&&a<=X}var id=gc?xi(gc):ty;function Ea(a){return typeof a=="string"||!Be(a)&&Tt(a)&&ai(a)==_e}function wi(a){return typeof a=="symbol"||Tt(a)&&ai(a)==ce}var Dn=vc?xi(vc):iy;function rx(a){return a===t}function nx(a){return Tt(a)&&ti(a)==et}function sx(a){return Tt(a)&&ai(a)==Dt}var ax=ma(il),ox=ma(function(a,u){return a<=u});function rd(a){if(!a)return[];if(di(a))return Ea(a)?Hi(a):hi(a);if(Qn&&a[Qn])return Bg(a[Qn]());var u=ti(a),p=u==Ne?Vo:u==Pt?Ws:kn;return p(a)}function gr(a){if(!a)return a===0?a:0;if(a=ki(a),a===H||a===-H){var u=a<0?-1:1;return u*re}return a===a?a:0}function He(a){var u=gr(a),p=u%1;return u===u?p?u-p:u:0}function nd(a){return a?on(He(a),0,he):0}function ki(a){if(typeof a=="number")return a;if(wi(a))return ae;if(St(a)){var u=typeof a.valueOf=="function"?a.valueOf():a;a=St(u)?u+"":u}if(typeof a!="string")return a===0?a:+a;a=Sc(a);var p=Ki.test(a);return p||Us.test(a)?wg(a.slice(2),p?2:8):Yi.test(a)?ae:+a}function sd(a){return er(a,fi(a))}function lx(a){return a?on(He(a),-X,X):a===0?a:0}function at(a){return a==null?"":bi(a)}var ux=Ln(function(a,u){if(cs(u)||di(u)){er(u,Wt(u),a);return}for(var p in u)ot.call(u,p)&&ns(a,p,u[p])}),ad=Ln(function(a,u){er(u,fi(u),a)}),Ta=Ln(function(a,u,p,x){er(u,fi(u),a,x)}),cx=Ln(function(a,u,p,x){er(u,Wt(u),a,x)}),hx=fr(Zo);function dx(a,u){var p=In(a);return u==null?p:zc(p,u)}var fx=We(function(a,u){a=dt(a);var p=-1,x=u.length,M=x>2?u[2]:t;for(M&&oi(u[0],u[1],M)&&(x=1);++p<x;)for(var I=u[p],k=fi(I),B=-1,W=k.length;++B<W;){var ie=k[B],ne=a[ie];(ne===t||Vi(ne,Cn[ie])&&!ot.call(a,ie))&&(a[ie]=I[ie])}return a}),px=We(function(a){return a.push(t,Sh),_i(od,t,a)});function mx(a,u){return _c(a,Pe(u,3),Qi)}function gx(a,u){return _c(a,Pe(u,3),Yo)}function vx(a,u){return a==null?a:Jo(a,Pe(u,3),fi)}function yx(a,u){return a==null?a:Vc(a,Pe(u,3),fi)}function _x(a,u){return a&&Qi(a,Pe(u,3))}function xx(a,u){return a&&Yo(a,Pe(u,3))}function bx(a){return a==null?[]:oa(a,Wt(a))}function wx(a){return a==null?[]:oa(a,fi(a))}function Pl(a,u,p){var x=a==null?t:ln(a,u);return x===t?p:x}function Sx(a,u){return a!=null&&Th(a,u,Gv)}function Rl(a,u){return a!=null&&Th(a,u,qv)}var Mx=yh(function(a,u,p){u!=null&&typeof u.toString!="function"&&(u=Xs.call(u)),a[u]=p},Ll(pi)),Ex=yh(function(a,u,p){u!=null&&typeof u.toString!="function"&&(u=Xs.call(u)),ot.call(a,u)?a[u].push(p):a[u]=[p]},Pe),Tx=We(as);function Wt(a){return di(a)?kc(a):tl(a)}function fi(a){return di(a)?kc(a,!0):ry(a)}function Ax(a,u){var p={};return u=Pe(u,3),Qi(a,function(x,M,I){hr(p,u(x,M,I),x)}),p}function Cx(a,u){var p={};return u=Pe(u,3),Qi(a,function(x,M,I){hr(p,M,u(x,M,I))}),p}var Px=Ln(function(a,u,p){la(a,u,p)}),od=Ln(function(a,u,p,x){la(a,u,p,x)}),Rx=fr(function(a,u){var p={};if(a==null)return p;var x=!1;u=xt(u,function(I){return I=Fr(I,a),x||(x=I.length>1),I}),er(a,ml(a),p),x&&(p=Oi(p,g|y|_,My));for(var M=u.length;M--;)ol(p,u[M]);return p});function Ix(a,u){return ld(a,Sa(Pe(u)))}var Lx=fr(function(a,u){return a==null?{}:sy(a,u)});function ld(a,u){if(a==null)return{};var p=xt(ml(a),function(x){return[x]});return u=Pe(u),Qc(a,p,function(x,M){return u(x,M[0])})}function Ox(a,u,p){u=Fr(u,a);var x=-1,M=u.length;for(M||(M=1,a=t);++x<M;){var I=a==null?t:a[tr(u[x])];I===t&&(x=M,I=p),a=mr(I)?I.call(a):I}return a}function Nx(a,u,p){return a==null?a:ls(a,u,p)}function Dx(a,u,p,x){return x=typeof x=="function"?x:t,a==null?a:ls(a,u,p,x)}var ud=bh(Wt),cd=bh(fi);function kx(a,u,p){var x=Be(a),M=x||Br(a)||Dn(a);if(u=Pe(u,4),p==null){var I=a&&a.constructor;M?p=x?new I:[]:St(a)?p=mr(I)?In(Ys(a)):{}:p={}}return(M?Ri:Qi)(a,function(k,B,W){return u(p,k,B,W)}),p}function Fx(a,u){return a==null?!0:ol(a,u)}function zx(a,u,p){return a==null?a:nh(a,u,cl(p))}function Bx(a,u,p,x){return x=typeof x=="function"?x:t,a==null?a:nh(a,u,cl(p),x)}function kn(a){return a==null?[]:$o(a,Wt(a))}function Ux(a){return a==null?[]:$o(a,fi(a))}function Hx(a,u,p){return p===t&&(p=u,u=t),p!==t&&(p=ki(p),p=p===p?p:0),u!==t&&(u=ki(u),u=u===u?u:0),on(ki(a),u,p)}function $x(a,u,p){return u=gr(u),p===t?(p=u,u=0):p=gr(p),a=ki(a),Xv(a,u,p)}function Vx(a,u,p){if(p&&typeof p!="boolean"&&oi(a,u,p)&&(u=p=t),p===t&&(typeof u=="boolean"?(p=u,u=t):typeof a=="boolean"&&(p=a,a=t)),a===t&&u===t?(a=0,u=1):(a=gr(a),u===t?(u=a,a=0):u=gr(u)),a>u){var x=a;a=u,u=x}if(p||a%1||u%1){var M=Nc();return ei(a+M*(u-a+bg("1e-"+((M+"").length-1))),u)}return nl(a,u)}var Wx=On(function(a,u,p){return u=u.toLowerCase(),a+(p?hd(u):u)});function hd(a){return Il(at(a).toLowerCase())}function dd(a){return a=at(a),a&&a.replace(Po,Ng).replace(hg,"")}function jx(a,u,p){a=at(a),u=bi(u);var x=a.length;p=p===t?x:on(He(p),0,x);var M=p;return p-=u.length,p>=0&&a.slice(p,M)==u}function Gx(a){return a=at(a),a&&Jn.test(a)?a.replace(Ji,Dg):a}function qx(a){return a=at(a),a&&_u.test(a)?a.replace(Ls,"\\$&"):a}var Xx=On(function(a,u,p){return a+(p?"-":"")+u.toLowerCase()}),Zx=On(function(a,u,p){return a+(p?" ":"")+u.toLowerCase()}),Jx=mh("toLowerCase");function Yx(a,u,p){a=at(a),u=He(u);var x=u?An(a):0;if(!u||x>=u)return a;var M=(u-x)/2;return pa(ta(M),p)+a+pa(ea(M),p)}function Kx(a,u,p){a=at(a),u=He(u);var x=u?An(a):0;return u&&x<u?a+pa(u-x,p):a}function Qx(a,u,p){a=at(a),u=He(u);var x=u?An(a):0;return u&&x<u?pa(u-x,p)+a:a}function eb(a,u,p){return p||u==null?u=0:u&&(u=+u),ov(at(a).replace(ye,""),u||0)}function tb(a,u,p){return(p?oi(a,u,p):u===t)?u=1:u=He(u),sl(at(a),u)}function ib(){var a=arguments,u=at(a[0]);return a.length<3?u:u.replace(a[1],a[2])}var rb=On(function(a,u,p){return a+(p?"_":"")+u.toLowerCase()});function nb(a,u,p){return p&&typeof p!="number"&&oi(a,u,p)&&(u=p=t),p=p===t?he:p>>>0,p?(a=at(a),a&&(typeof u=="string"||u!=null&&!Cl(u))&&(u=bi(u),!u&&Tn(a))?zr(Hi(a),0,p):a.split(u,p)):[]}var sb=On(function(a,u,p){return a+(p?" ":"")+Il(u)});function ab(a,u,p){return a=at(a),p=p==null?0:on(He(p),0,a.length),u=bi(u),a.slice(p,p+u.length)==u}function ob(a,u,p){var x=C.templateSettings;p&&oi(a,u,p)&&(u=t),a=at(a),u=Ta({},u,x,wh);var M=Ta({},u.imports,x.imports,wh),I=Wt(M),k=$o(M,I),B,W,ie=0,ne=u.interpolate||Q,ue="__p += '",ge=Wo((u.escape||Q).source+"|"+ne.source+"|"+(ne===lo?Xi:Q).source+"|"+(u.evaluate||Q).source+"|$","g"),Me="//# sourceURL="+(ot.call(u,"sourceURL")?(u.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++gg+"]")+`
`;a.replace(ge,function(Ie,Xe,Ke,Si,li,Mi){return Ke||(Ke=Si),ue+=a.slice(ie,Mi).replace(le,kg),Xe&&(B=!0,ue+=`' +
__e(`+Xe+`) +
'`),li&&(W=!0,ue+=`';
`+li+`;
__p += '`),Ke&&(ue+=`' +
((__t = (`+Ke+`)) == null ? '' : __t) +
'`),ie=Mi+Ie.length,Ie}),ue+=`';
`;var Re=ot.call(u,"variable")&&u.variable;if(!Re)ue=`with (obj) {
`+ue+`
}
`;else if(Ci.test(Re))throw new ze(h);ue=(W?ue.replace(gi,""):ue).replace(Rt,"$1").replace(ci,"$1;"),ue="function("+(Re||"obj")+`) {
`+(Re?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(B?", __e = _.escape":"")+(W?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ue+`return __p
}`;var $e=pd(function(){return rt(I,Me+"return "+ue).apply(t,k)});if($e.source=ue,Al($e))throw $e;return $e}function lb(a){return at(a).toLowerCase()}function ub(a){return at(a).toUpperCase()}function cb(a,u,p){if(a=at(a),a&&(p||u===t))return Sc(a);if(!a||!(u=bi(u)))return a;var x=Hi(a),M=Hi(u),I=Mc(x,M),k=Ec(x,M)+1;return zr(x,I,k).join("")}function hb(a,u,p){if(a=at(a),a&&(p||u===t))return a.slice(0,Ac(a)+1);if(!a||!(u=bi(u)))return a;var x=Hi(a),M=Ec(x,Hi(u))+1;return zr(x,0,M).join("")}function db(a,u,p){if(a=at(a),a&&(p||u===t))return a.replace(ye,"");if(!a||!(u=bi(u)))return a;var x=Hi(a),M=Mc(x,Hi(u));return zr(x,M).join("")}function fb(a,u){var p=F,x=z;if(St(u)){var M="separator"in u?u.separator:M;p="length"in u?He(u.length):p,x="omission"in u?bi(u.omission):x}a=at(a);var I=a.length;if(Tn(a)){var k=Hi(a);I=k.length}if(p>=I)return a;var B=p-An(x);if(B<1)return x;var W=k?zr(k,0,B).join(""):a.slice(0,B);if(M===t)return W+x;if(k&&(B+=W.length-B),Cl(M)){if(a.slice(B).search(M)){var ie,ne=W;for(M.global||(M=Wo(M.source,at(xr.exec(M))+"g")),M.lastIndex=0;ie=M.exec(ne);)var ue=ie.index;W=W.slice(0,ue===t?B:ue)}}else if(a.indexOf(bi(M),B)!=B){var ge=W.lastIndexOf(M);ge>-1&&(W=W.slice(0,ge))}return W+x}function pb(a){return a=at(a),a&&ws.test(a)?a.replace(ji,Vg):a}var mb=On(function(a,u,p){return a+(p?" ":"")+u.toUpperCase()}),Il=mh("toUpperCase");function fd(a,u,p){return a=at(a),u=p?t:u,u===t?zg(a)?Gg(a):Pg(a):a.match(u)||[]}var pd=We(function(a,u){try{return _i(a,t,u)}catch(p){return Al(p)?p:new ze(p)}}),gb=fr(function(a,u){return Ri(u,function(p){p=tr(p),hr(a,p,El(a[p],a))}),a});function vb(a){var u=a==null?0:a.length,p=Pe();return a=u?xt(a,function(x){if(typeof x[1]!="function")throw new Ii(c);return[p(x[0]),x[1]]}):[],We(function(x){for(var M=-1;++M<u;){var I=a[M];if(_i(I[0],this,x))return _i(I[1],this,x)}})}function yb(a){return Vv(Oi(a,g))}function Ll(a){return function(){return a}}function _b(a,u){return a==null||a!==a?u:a}var xb=vh(),bb=vh(!0);function pi(a){return a}function Ol(a){return qc(typeof a=="function"?a:Oi(a,g))}function wb(a){return Zc(Oi(a,g))}function Sb(a,u){return Jc(a,Oi(u,g))}var Mb=We(function(a,u){return function(p){return as(p,a,u)}}),Eb=We(function(a,u){return function(p){return as(a,p,u)}});function Nl(a,u,p){var x=Wt(u),M=oa(u,x);p==null&&!(St(u)&&(M.length||!x.length))&&(p=u,u=a,a=this,M=oa(u,Wt(u)));var I=!(St(p)&&"chain"in p)||!!p.chain,k=mr(a);return Ri(M,function(B){var W=u[B];a[B]=W,k&&(a.prototype[B]=function(){var ie=this.__chain__;if(I||ie){var ne=a(this.__wrapped__),ue=ne.__actions__=hi(this.__actions__);return ue.push({func:W,args:arguments,thisArg:a}),ne.__chain__=ie,ne}return W.apply(a,Lr([this.value()],arguments))})}),a}function Tb(){return Gt._===this&&(Gt._=Kg),this}function Dl(){}function Ab(a){return a=He(a),We(function(u){return Yc(u,a)})}var Cb=dl(xt),Pb=dl(yc),Rb=dl(Fo);function md(a){return _l(a)?zo(tr(a)):ay(a)}function Ib(a){return function(u){return a==null?t:ln(a,u)}}var Lb=_h(),Ob=_h(!0);function kl(){return[]}function Fl(){return!1}function Nb(){return{}}function Db(){return""}function kb(){return!0}function Fb(a,u){if(a=He(a),a<1||a>X)return[];var p=he,x=ei(a,he);u=Pe(u),a-=he;for(var M=Ho(x,u);++p<a;)u(p);return M}function zb(a){return Be(a)?xt(a,tr):wi(a)?[a]:hi(Dh(at(a)))}function Bb(a){var u=++Jg;return at(a)+u}var Ub=fa(function(a,u){return a+u},0),Hb=fl("ceil"),$b=fa(function(a,u){return a/u},1),Vb=fl("floor");function Wb(a){return a&&a.length?aa(a,pi,Ko):t}function jb(a,u){return a&&a.length?aa(a,Pe(u,2),Ko):t}function Gb(a){return bc(a,pi)}function qb(a,u){return bc(a,Pe(u,2))}function Xb(a){return a&&a.length?aa(a,pi,il):t}function Zb(a,u){return a&&a.length?aa(a,Pe(u,2),il):t}var Jb=fa(function(a,u){return a*u},1),Yb=fl("round"),Kb=fa(function(a,u){return a-u},0);function Qb(a){return a&&a.length?Uo(a,pi):0}function e1(a,u){return a&&a.length?Uo(a,Pe(u,2)):0}return C.after=w_,C.ary=Gh,C.assign=ux,C.assignIn=ad,C.assignInWith=Ta,C.assignWith=cx,C.at=hx,C.before=qh,C.bind=El,C.bindAll=gb,C.bindKey=Xh,C.castArray=N_,C.chain=Vh,C.chunk=Vy,C.compact=Wy,C.concat=jy,C.cond=vb,C.conforms=yb,C.constant=Ll,C.countBy=Q0,C.create=dx,C.curry=Zh,C.curryRight=Jh,C.debounce=Yh,C.defaults=fx,C.defaultsDeep=px,C.defer=S_,C.delay=M_,C.difference=Gy,C.differenceBy=qy,C.differenceWith=Xy,C.drop=Zy,C.dropRight=Jy,C.dropRightWhile=Yy,C.dropWhile=Ky,C.fill=Qy,C.filter=t_,C.flatMap=n_,C.flatMapDeep=s_,C.flatMapDepth=a_,C.flatten=Bh,C.flattenDeep=e0,C.flattenDepth=t0,C.flip=E_,C.flow=xb,C.flowRight=bb,C.fromPairs=i0,C.functions=bx,C.functionsIn=wx,C.groupBy=o_,C.initial=n0,C.intersection=s0,C.intersectionBy=a0,C.intersectionWith=o0,C.invert=Mx,C.invertBy=Ex,C.invokeMap=u_,C.iteratee=Ol,C.keyBy=c_,C.keys=Wt,C.keysIn=fi,C.map=xa,C.mapKeys=Ax,C.mapValues=Cx,C.matches=wb,C.matchesProperty=Sb,C.memoize=wa,C.merge=Px,C.mergeWith=od,C.method=Mb,C.methodOf=Eb,C.mixin=Nl,C.negate=Sa,C.nthArg=Ab,C.omit=Rx,C.omitBy=Ix,C.once=T_,C.orderBy=h_,C.over=Cb,C.overArgs=A_,C.overEvery=Pb,C.overSome=Rb,C.partial=Tl,C.partialRight=Kh,C.partition=d_,C.pick=Lx,C.pickBy=ld,C.property=md,C.propertyOf=Ib,C.pull=h0,C.pullAll=Hh,C.pullAllBy=d0,C.pullAllWith=f0,C.pullAt=p0,C.range=Lb,C.rangeRight=Ob,C.rearg=C_,C.reject=m_,C.remove=m0,C.rest=P_,C.reverse=Sl,C.sampleSize=v_,C.set=Nx,C.setWith=Dx,C.shuffle=y_,C.slice=g0,C.sortBy=b_,C.sortedUniq=S0,C.sortedUniqBy=M0,C.split=nb,C.spread=R_,C.tail=E0,C.take=T0,C.takeRight=A0,C.takeRightWhile=C0,C.takeWhile=P0,C.tap=W0,C.throttle=I_,C.thru=_a,C.toArray=rd,C.toPairs=ud,C.toPairsIn=cd,C.toPath=zb,C.toPlainObject=sd,C.transform=kx,C.unary=L_,C.union=R0,C.unionBy=I0,C.unionWith=L0,C.uniq=O0,C.uniqBy=N0,C.uniqWith=D0,C.unset=Fx,C.unzip=Ml,C.unzipWith=$h,C.update=zx,C.updateWith=Bx,C.values=kn,C.valuesIn=Ux,C.without=k0,C.words=fd,C.wrap=O_,C.xor=F0,C.xorBy=z0,C.xorWith=B0,C.zip=U0,C.zipObject=H0,C.zipObjectDeep=$0,C.zipWith=V0,C.entries=ud,C.entriesIn=cd,C.extend=ad,C.extendWith=Ta,Nl(C,C),C.add=Ub,C.attempt=pd,C.camelCase=Wx,C.capitalize=hd,C.ceil=Hb,C.clamp=Hx,C.clone=D_,C.cloneDeep=F_,C.cloneDeepWith=z_,C.cloneWith=k_,C.conformsTo=B_,C.deburr=dd,C.defaultTo=_b,C.divide=$b,C.endsWith=jx,C.eq=Vi,C.escape=Gx,C.escapeRegExp=qx,C.every=e_,C.find=i_,C.findIndex=Fh,C.findKey=mx,C.findLast=r_,C.findLastIndex=zh,C.findLastKey=gx,C.floor=Vb,C.forEach=Wh,C.forEachRight=jh,C.forIn=vx,C.forInRight=yx,C.forOwn=_x,C.forOwnRight=xx,C.get=Pl,C.gt=U_,C.gte=H_,C.has=Sx,C.hasIn=Rl,C.head=Uh,C.identity=pi,C.includes=l_,C.indexOf=r0,C.inRange=$x,C.invoke=Tx,C.isArguments=hn,C.isArray=Be,C.isArrayBuffer=$_,C.isArrayLike=di,C.isArrayLikeObject=Lt,C.isBoolean=V_,C.isBuffer=Br,C.isDate=W_,C.isElement=j_,C.isEmpty=G_,C.isEqual=q_,C.isEqualWith=X_,C.isError=Al,C.isFinite=Z_,C.isFunction=mr,C.isInteger=Qh,C.isLength=Ma,C.isMap=ed,C.isMatch=J_,C.isMatchWith=Y_,C.isNaN=K_,C.isNative=Q_,C.isNil=tx,C.isNull=ex,C.isNumber=td,C.isObject=St,C.isObjectLike=Tt,C.isPlainObject=ds,C.isRegExp=Cl,C.isSafeInteger=ix,C.isSet=id,C.isString=Ea,C.isSymbol=wi,C.isTypedArray=Dn,C.isUndefined=rx,C.isWeakMap=nx,C.isWeakSet=sx,C.join=l0,C.kebabCase=Xx,C.last=Di,C.lastIndexOf=u0,C.lowerCase=Zx,C.lowerFirst=Jx,C.lt=ax,C.lte=ox,C.max=Wb,C.maxBy=jb,C.mean=Gb,C.meanBy=qb,C.min=Xb,C.minBy=Zb,C.stubArray=kl,C.stubFalse=Fl,C.stubObject=Nb,C.stubString=Db,C.stubTrue=kb,C.multiply=Jb,C.nth=c0,C.noConflict=Tb,C.noop=Dl,C.now=ba,C.pad=Yx,C.padEnd=Kx,C.padStart=Qx,C.parseInt=eb,C.random=Vx,C.reduce=f_,C.reduceRight=p_,C.repeat=tb,C.replace=ib,C.result=Ox,C.round=Yb,C.runInContext=V,C.sample=g_,C.size=__,C.snakeCase=rb,C.some=x_,C.sortedIndex=v0,C.sortedIndexBy=y0,C.sortedIndexOf=_0,C.sortedLastIndex=x0,C.sortedLastIndexBy=b0,C.sortedLastIndexOf=w0,C.startCase=sb,C.startsWith=ab,C.subtract=Kb,C.sum=Qb,C.sumBy=e1,C.template=ob,C.times=Fb,C.toFinite=gr,C.toInteger=He,C.toLength=nd,C.toLower=lb,C.toNumber=ki,C.toSafeInteger=lx,C.toString=at,C.toUpper=ub,C.trim=cb,C.trimEnd=hb,C.trimStart=db,C.truncate=fb,C.unescape=pb,C.uniqueId=Bb,C.upperCase=mb,C.upperFirst=Il,C.each=Wh,C.eachRight=jh,C.first=Uh,Nl(C,function(){var a={};return Qi(C,function(u,p){ot.call(C.prototype,p)||(a[p]=u)}),a}(),{chain:!1}),C.VERSION=r,Ri(["bind","bindKey","curry","curryRight","partial","partialRight"],function(a){C[a].placeholder=C}),Ri(["drop","take"],function(a,u){Ye.prototype[a]=function(p){p=p===t?1:Ut(He(p),0);var x=this.__filtered__&&!u?new Ye(this):this.clone();return x.__filtered__?x.__takeCount__=ei(p,x.__takeCount__):x.__views__.push({size:ei(p,he),type:a+(x.__dir__<0?"Right":"")}),x},Ye.prototype[a+"Right"]=function(p){return this.reverse()[a](p).reverse()}}),Ri(["filter","map","takeWhile"],function(a,u){var p=u+1,x=p==Z||p==$;Ye.prototype[a]=function(M){var I=this.clone();return I.__iteratees__.push({iteratee:Pe(M,3),type:p}),I.__filtered__=I.__filtered__||x,I}}),Ri(["head","last"],function(a,u){var p="take"+(u?"Right":"");Ye.prototype[a]=function(){return this[p](1).value()[0]}}),Ri(["initial","tail"],function(a,u){var p="drop"+(u?"":"Right");Ye.prototype[a]=function(){return this.__filtered__?new Ye(this):this[p](1)}}),Ye.prototype.compact=function(){return this.filter(pi)},Ye.prototype.find=function(a){return this.filter(a).head()},Ye.prototype.findLast=function(a){return this.reverse().find(a)},Ye.prototype.invokeMap=We(function(a,u){return typeof a=="function"?new Ye(this):this.map(function(p){return as(p,a,u)})}),Ye.prototype.reject=function(a){return this.filter(Sa(Pe(a)))},Ye.prototype.slice=function(a,u){a=He(a);var p=this;return p.__filtered__&&(a>0||u<0)?new Ye(p):(a<0?p=p.takeRight(-a):a&&(p=p.drop(a)),u!==t&&(u=He(u),p=u<0?p.dropRight(-u):p.take(u-a)),p)},Ye.prototype.takeRightWhile=function(a){return this.reverse().takeWhile(a).reverse()},Ye.prototype.toArray=function(){return this.take(he)},Qi(Ye.prototype,function(a,u){var p=/^(?:filter|find|map|reject)|While$/.test(u),x=/^(?:head|last)$/.test(u),M=C[x?"take"+(u=="last"?"Right":""):u],I=x||/^find/.test(u);M&&(C.prototype[u]=function(){var k=this.__wrapped__,B=x?[1]:arguments,W=k instanceof Ye,ie=B[0],ne=W||Be(k),ue=function(Xe){var Ke=M.apply(C,Lr([Xe],B));return x&&ge?Ke[0]:Ke};ne&&p&&typeof ie=="function"&&ie.length!=1&&(W=ne=!1);var ge=this.__chain__,Me=!!this.__actions__.length,Re=I&&!ge,$e=W&&!Me;if(!I&&ne){k=$e?k:new Ye(this);var Ie=a.apply(k,B);return Ie.__actions__.push({func:_a,args:[ue],thisArg:t}),new Li(Ie,ge)}return Re&&$e?a.apply(this,B):(Ie=this.thru(ue),Re?x?Ie.value()[0]:Ie.value():Ie)})}),Ri(["pop","push","shift","sort","splice","unshift"],function(a){var u=js[a],p=/^(?:push|sort|unshift)$/.test(a)?"tap":"thru",x=/^(?:pop|shift)$/.test(a);C.prototype[a]=function(){var M=arguments;if(x&&!this.__chain__){var I=this.value();return u.apply(Be(I)?I:[],M)}return this[p](function(k){return u.apply(Be(k)?k:[],M)})}}),Qi(Ye.prototype,function(a,u){var p=C[u];if(p){var x=p.name+"";ot.call(Rn,x)||(Rn[x]=[]),Rn[x].push({name:u,func:p})}}),Rn[da(t,T).name]=[{name:"wrapper",func:t}],Ye.prototype.clone=pv,Ye.prototype.reverse=mv,Ye.prototype.value=gv,C.prototype.at=j0,C.prototype.chain=G0,C.prototype.commit=q0,C.prototype.next=X0,C.prototype.plant=J0,C.prototype.reverse=Y0,C.prototype.toJSON=C.prototype.valueOf=C.prototype.value=K0,C.prototype.first=C.prototype.head,Qn&&(C.prototype[Qn]=Z0),C},qr=qg();rn?((rn.exports=qr)._=qr,Oo._=qr):Gt._=qr}).call(lu)})(HR,HR.exports);var Pp=HR.exports;const dfe=Qd(Pp);var MF=function(i,e){return MF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])},MF(i,e)};function Pf(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");MF(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var EF=function(){return EF=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])}return e},EF.apply(this,arguments)};function ffe(i,e,t,r){function n(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function h(m){try{f(r.next(m))}catch(g){c(g)}}function d(m){try{f(r.throw(m))}catch(g){c(g)}}function f(m){m.done?l(m.value):n(m.value).then(h,d)}f((r=r.apply(i,e||[])).next())})}function Lq(i,e){var t={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},r,n,l,c;return c={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function h(f){return function(m){return d([f,m])}}function d(f){if(r)throw new TypeError("Generator is already executing.");for(;c&&(c=0,f[0]&&(t=0)),t;)try{if(r=1,n&&(l=f[0]&2?n.return:f[0]?n.throw||((l=n.return)&&l.call(n),0):n.next)&&!(l=l.call(n,f[1])).done)return l;switch(n=0,l&&(f=[f[0]&2,l.value]),f[0]){case 0:case 1:l=f;break;case 4:return t.label++,{value:f[1],done:!1};case 5:t.label++,n=f[1],f=[0];continue;case 7:f=t.ops.pop(),t.trys.pop();continue;default:if(l=t.trys,!(l=l.length>0&&l[l.length-1])&&(f[0]===6||f[0]===2)){t=0;continue}if(f[0]===3&&(!l||f[1]>l[0]&&f[1]<l[3])){t.label=f[1];break}if(f[0]===6&&t.label<l[1]){t.label=l[1],l=f;break}if(l&&t.label<l[2]){t.label=l[2],t.ops.push(f);break}l[2]&&t.ops.pop(),t.trys.pop();continue}f=e.call(i,t)}catch(m){f=[6,m],n=0}finally{r=l=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function $M(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],r=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&r>=i.length&&(i=void 0),{value:i&&i[r++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function sw(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var r=t.call(i),n,l=[],c;try{for(;(e===void 0||e-- >0)&&!(n=r.next()).done;)l.push(n.value)}catch(h){c={error:h}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(c)throw c.error}}return l}function VM(i,e,t){if(t||arguments.length===2)for(var r=0,n=e.length,l;r<n;r++)(l||!(r in e))&&(l||(l=Array.prototype.slice.call(e,0,r)),l[r]=e[r]);return i.concat(l||Array.prototype.slice.call(e))}function vM(i){return this instanceof vM?(this.v=i,this):new vM(i)}function pfe(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(i,e||[]),n,l=[];return n={},c("next"),c("throw"),c("return"),n[Symbol.asyncIterator]=function(){return this},n;function c(y){r[y]&&(n[y]=function(_){return new Promise(function(b,S){l.push([y,_,b,S])>1||h(y,_)})})}function h(y,_){try{d(r[y](_))}catch(b){g(l[0][3],b)}}function d(y){y.value instanceof vM?Promise.resolve(y.value.v).then(f,m):g(l[0][2],y)}function f(y){h("next",y)}function m(y){h("throw",y)}function g(y,_){y(_),l.shift(),l.length&&h(l[0][0],l[0][1])}}function mfe(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof $M=="function"?$M(i):i[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(l){t[l]=i[l]&&function(c){return new Promise(function(h,d){c=i[l](c),n(h,d,c.done,c.value)})}}function n(l,c,h,d){Promise.resolve(d).then(function(f){l({value:f,done:h})},c)}}function Vn(i){return typeof i=="function"}function Oq(i){var e=function(r){Error.call(r),r.stack=new Error().stack},t=i(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var xN=Oq(function(i){return function(t){i(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(r,n){return n+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function $R(i,e){if(i){var t=i.indexOf(e);0<=t&&i.splice(t,1)}}var CC=function(){function i(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return i.prototype.unsubscribe=function(){var e,t,r,n,l;if(!this.closed){this.closed=!0;var c=this._parentage;if(c)if(this._parentage=null,Array.isArray(c))try{for(var h=$M(c),d=h.next();!d.done;d=h.next()){var f=d.value;f.remove(this)}}catch(S){e={error:S}}finally{try{d&&!d.done&&(t=h.return)&&t.call(h)}finally{if(e)throw e.error}}else c.remove(this);var m=this.initialTeardown;if(Vn(m))try{m()}catch(S){l=S instanceof xN?S.errors:[S]}var g=this._finalizers;if(g){this._finalizers=null;try{for(var y=$M(g),_=y.next();!_.done;_=y.next()){var b=_.value;try{N$(b)}catch(S){l=l??[],S instanceof xN?l=VM(VM([],sw(l)),sw(S.errors)):l.push(S)}}}catch(S){r={error:S}}finally{try{_&&!_.done&&(n=y.return)&&n.call(y)}finally{if(r)throw r.error}}}if(l)throw new xN(l)}},i.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)N$(e);else{if(e instanceof i){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},i.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},i.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},i.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&$R(t,e)},i.prototype.remove=function(e){var t=this._finalizers;t&&$R(t,e),e instanceof i&&e._removeParent(this)},i.EMPTY=function(){var e=new i;return e.closed=!0,e}(),i}(),Nq=CC.EMPTY;function Dq(i){return i instanceof CC||i&&"closed"in i&&Vn(i.remove)&&Vn(i.add)&&Vn(i.unsubscribe)}function N$(i){Vn(i)?i():i.unsubscribe()}var kq={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Fq={setTimeout:function(i,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return setTimeout.apply(void 0,VM([i,e],sw(t)))},clearTimeout:function(i){var e=Fq.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(i)},delegate:void 0};function zq(i){Fq.setTimeout(function(){throw i})}function D$(){}function qP(i){i()}var yB=function(i){Pf(e,i);function e(t){var r=i.call(this)||this;return r.isStopped=!1,t?(r.destination=t,Dq(t)&&t.add(r)):r.destination=_fe,r}return e.create=function(t,r,n){return new UA(t,r,n)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,i.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(CC),gfe=Function.prototype.bind;function bN(i,e){return gfe.call(i,e)}var vfe=function(){function i(e){this.partialObserver=e}return i.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(r){s3(r)}},i.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(r){s3(r)}else s3(e)},i.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){s3(t)}},i}(),UA=function(i){Pf(e,i);function e(t,r,n){var l=i.call(this)||this,c;if(Vn(t)||!t)c={next:t??void 0,error:r??void 0,complete:n??void 0};else{var h;l&&kq.useDeprecatedNextContext?(h=Object.create(t),h.unsubscribe=function(){return l.unsubscribe()},c={next:t.next&&bN(t.next,h),error:t.error&&bN(t.error,h),complete:t.complete&&bN(t.complete,h)}):c=t}return l.destination=new vfe(c),l}return e}(yB);function s3(i){zq(i)}function yfe(i){throw i}var _fe={closed:!0,next:D$,error:yfe,complete:D$},_B=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Bq(i){return i}function xfe(i){return i.length===0?Bq:i.length===1?i[0]:function(t){return i.reduce(function(r,n){return n(r)},t)}}var Sf=function(){function i(e){e&&(this._subscribe=e)}return i.prototype.lift=function(e){var t=new i;return t.source=this,t.operator=e,t},i.prototype.subscribe=function(e,t,r){var n=this,l=wfe(e)?e:new UA(e,t,r);return qP(function(){var c=n,h=c.operator,d=c.source;l.add(h?h.call(l,d):d?n._subscribe(l):n._trySubscribe(l))}),l},i.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},i.prototype.forEach=function(e,t){var r=this;return t=k$(t),new t(function(n,l){var c=new UA({next:function(h){try{e(h)}catch(d){l(d),c.unsubscribe()}},error:l,complete:n});r.subscribe(c)})},i.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},i.prototype[_B]=function(){return this},i.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return xfe(e)(this)},i.prototype.toPromise=function(e){var t=this;return e=k$(e),new e(function(r,n){var l;t.subscribe(function(c){return l=c},function(c){return n(c)},function(){return r(l)})})},i.create=function(e){return new i(e)},i}();function k$(i){var e;return(e=i??kq.Promise)!==null&&e!==void 0?e:Promise}function bfe(i){return i&&Vn(i.next)&&Vn(i.error)&&Vn(i.complete)}function wfe(i){return i&&i instanceof yB||bfe(i)&&Dq(i)}function Sfe(i){return Vn(i==null?void 0:i.lift)}function PC(i){return function(e){if(Sfe(e))return e.lift(function(t){try{return i(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function WM(i,e,t,r,n){return new Mfe(i,e,t,r,n)}var Mfe=function(i){Pf(e,i);function e(t,r,n,l,c,h){var d=i.call(this,t)||this;return d.onFinalize=c,d.shouldUnsubscribe=h,d._next=r?function(f){try{r(f)}catch(m){t.error(m)}}:i.prototype._next,d._error=l?function(f){try{l(f)}catch(m){t.error(m)}finally{this.unsubscribe()}}:i.prototype._error,d._complete=n?function(){try{n()}catch(f){t.error(f)}finally{this.unsubscribe()}}:i.prototype._complete,d}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;i.prototype.unsubscribe.call(this),!r&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e}(yB),Efe=Oq(function(i){return function(){i(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),RC=function(i){Pf(e,i);function e(){var t=i.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var r=new F$(this,this);return r.operator=t,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new Efe},e.prototype.next=function(t){var r=this;qP(function(){var n,l;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var c=$M(r.currentObservers),h=c.next();!h.done;h=c.next()){var d=h.value;d.next(t)}}catch(f){n={error:f}}finally{try{h&&!h.done&&(l=c.return)&&l.call(c)}finally{if(n)throw n.error}}}})},e.prototype.error=function(t){var r=this;qP(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=t;for(var n=r.observers;n.length;)n.shift().error(t)}})},e.prototype.complete=function(){var t=this;qP(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var r=t.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),i.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var r=this,n=this,l=n.hasError,c=n.isStopped,h=n.observers;return l||c?Nq:(this.currentObservers=null,h.push(t),new CC(function(){r.currentObservers=null,$R(h,t)}))},e.prototype._checkFinalizedStatuses=function(t){var r=this,n=r.hasError,l=r.thrownError,c=r.isStopped;n?t.error(l):c&&t.complete()},e.prototype.asObservable=function(){var t=new Sf;return t.source=this,t},e.create=function(t,r){return new F$(t,r)},e}(Sf),F$=function(i){Pf(e,i);function e(t,r){var n=i.call(this)||this;return n.destination=t,n.source=r,n}return e.prototype.next=function(t){var r,n;(n=(r=this.destination)===null||r===void 0?void 0:r.next)===null||n===void 0||n.call(r,t)},e.prototype.error=function(t){var r,n;(n=(r=this.destination)===null||r===void 0?void 0:r.error)===null||n===void 0||n.call(r,t)},e.prototype.complete=function(){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||r===void 0||r.call(t)},e.prototype._subscribe=function(t){var r,n;return(n=(r=this.source)===null||r===void 0?void 0:r.subscribe(t))!==null&&n!==void 0?n:Nq},e}(RC),Tfe=function(i){Pf(e,i);function e(t){var r=i.call(this)||this;return r._value=t,r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(t){var r=i.prototype._subscribe.call(this,t);return!r.closed&&t.next(this._value),r},e.prototype.getValue=function(){var t=this,r=t.hasError,n=t.thrownError,l=t._value;if(r)throw n;return this._throwIfClosed(),l},e.prototype.next=function(t){i.prototype.next.call(this,this._value=t)},e}(RC),xB={now:function(){return(xB.delegate||Date).now()},delegate:void 0},Afe=function(i){Pf(e,i);function e(t,r,n){t===void 0&&(t=1/0),r===void 0&&(r=1/0),n===void 0&&(n=xB);var l=i.call(this)||this;return l._bufferSize=t,l._windowTime=r,l._timestampProvider=n,l._buffer=[],l._infiniteTimeWindow=!0,l._infiniteTimeWindow=r===1/0,l._bufferSize=Math.max(1,t),l._windowTime=Math.max(1,r),l}return e.prototype.next=function(t){var r=this,n=r.isStopped,l=r._buffer,c=r._infiniteTimeWindow,h=r._timestampProvider,d=r._windowTime;n||(l.push(t),!c&&l.push(h.now()+d)),this._trimBuffer(),i.prototype.next.call(this,t)},e.prototype._subscribe=function(t){this._throwIfClosed(),this._trimBuffer();for(var r=this._innerSubscribe(t),n=this,l=n._infiniteTimeWindow,c=n._buffer,h=c.slice(),d=0;d<h.length&&!t.closed;d+=l?1:2)t.next(h[d]);return this._checkFinalizedStatuses(t),r},e.prototype._trimBuffer=function(){var t=this,r=t._bufferSize,n=t._timestampProvider,l=t._buffer,c=t._infiniteTimeWindow,h=(c?1:2)*r;if(r<1/0&&h<l.length&&l.splice(0,l.length-h),!c){for(var d=n.now(),f=0,m=1;m<l.length&&l[m]<=d;m+=2)f=m;f&&l.splice(0,f+1)}},e}(RC),Cfe=function(i){Pf(e,i);function e(t,r){return i.call(this)||this}return e.prototype.schedule=function(t,r){return this},e}(CC),TF={setInterval:function(i,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return setInterval.apply(void 0,VM([i,e],sw(t)))},clearInterval:function(i){var e=TF.delegate;return((e==null?void 0:e.clearInterval)||clearInterval)(i)},delegate:void 0},Pfe=function(i){Pf(e,i);function e(t,r){var n=i.call(this,t,r)||this;return n.scheduler=t,n.work=r,n.pending=!1,n}return e.prototype.schedule=function(t,r){var n;if(r===void 0&&(r=0),this.closed)return this;this.state=t;var l=this.id,c=this.scheduler;return l!=null&&(this.id=this.recycleAsyncId(c,l,r)),this.pending=!0,this.delay=r,this.id=(n=this.id)!==null&&n!==void 0?n:this.requestAsyncId(c,this.id,r),this},e.prototype.requestAsyncId=function(t,r,n){return n===void 0&&(n=0),TF.setInterval(t.flush.bind(t,this),n)},e.prototype.recycleAsyncId=function(t,r,n){if(n===void 0&&(n=0),n!=null&&this.delay===n&&this.pending===!1)return r;r!=null&&TF.clearInterval(r)},e.prototype.execute=function(t,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(t,r);if(n)return n;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,r){var n=!1,l;try{this.work(t)}catch(c){n=!0,l=c||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),l},e.prototype.unsubscribe=function(){if(!this.closed){var t=this,r=t.id,n=t.scheduler,l=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,$R(l,this),r!=null&&(this.id=this.recycleAsyncId(n,r,null)),this.delay=null,i.prototype.unsubscribe.call(this)}},e}(Cfe),z$=function(){function i(e,t){t===void 0&&(t=i.now),this.schedulerActionCtor=e,this.now=t}return i.prototype.schedule=function(e,t,r){return t===void 0&&(t=0),new this.schedulerActionCtor(this,e).schedule(r,t)},i.now=xB.now,i}(),Rfe=function(i){Pf(e,i);function e(t,r){r===void 0&&(r=z$.now);var n=i.call(this,t,r)||this;return n.actions=[],n._active=!1,n}return e.prototype.flush=function(t){var r=this.actions;if(this._active){r.push(t);return}var n;this._active=!0;do if(n=t.execute(t.state,t.delay))break;while(t=r.shift());if(this._active=!1,n){for(;t=r.shift();)t.unsubscribe();throw n}},e}(z$),Uq=new Rfe(Pfe),Ife=Uq;function Lfe(i){return i&&Vn(i.schedule)}var Hq=function(i){return i&&typeof i.length=="number"&&typeof i!="function"};function Ofe(i){return Vn(i==null?void 0:i.then)}function Nfe(i){return Vn(i[_B])}function Dfe(i){return Symbol.asyncIterator&&Vn(i==null?void 0:i[Symbol.asyncIterator])}function kfe(i){return new TypeError("You provided "+(i!==null&&typeof i=="object"?"an invalid object":"'"+i+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Ffe(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var zfe=Ffe();function Bfe(i){return Vn(i==null?void 0:i[zfe])}function Ufe(i){return pfe(this,arguments,function(){var t,r,n,l;return Lq(this,function(c){switch(c.label){case 0:t=i.getReader(),c.label=1;case 1:c.trys.push([1,,9,10]),c.label=2;case 2:return[4,vM(t.read())];case 3:return r=c.sent(),n=r.value,l=r.done,l?[4,vM(void 0)]:[3,5];case 4:return[2,c.sent()];case 5:return[4,vM(n)];case 6:return[4,c.sent()];case 7:return c.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function Hfe(i){return Vn(i==null?void 0:i.getReader)}function xE(i){if(i instanceof Sf)return i;if(i!=null){if(Nfe(i))return $fe(i);if(Hq(i))return Vfe(i);if(Ofe(i))return Wfe(i);if(Dfe(i))return $q(i);if(Bfe(i))return jfe(i);if(Hfe(i))return Gfe(i)}throw kfe(i)}function $fe(i){return new Sf(function(e){var t=i[_B]();if(Vn(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Vfe(i){return new Sf(function(e){for(var t=0;t<i.length&&!e.closed;t++)e.next(i[t]);e.complete()})}function Wfe(i){return new Sf(function(e){i.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,zq)})}function jfe(i){return new Sf(function(e){var t,r;try{for(var n=$M(i),l=n.next();!l.done;l=n.next()){var c=l.value;if(e.next(c),e.closed)return}}catch(h){t={error:h}}finally{try{l&&!l.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}e.complete()})}function $q(i){return new Sf(function(e){qfe(i,e).catch(function(t){return e.error(t)})})}function Gfe(i){return $q(Ufe(i))}function qfe(i,e){var t,r,n,l;return ffe(this,void 0,void 0,function(){var c,h;return Lq(this,function(d){switch(d.label){case 0:d.trys.push([0,5,6,11]),t=mfe(i),d.label=1;case 1:return[4,t.next()];case 2:if(r=d.sent(),!!r.done)return[3,4];if(c=r.value,e.next(c),e.closed)return[2];d.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return h=d.sent(),n={error:h},[3,11];case 6:return d.trys.push([6,,9,10]),r&&!r.done&&(l=t.return)?[4,l.call(t)]:[3,8];case 7:d.sent(),d.label=8;case 8:return[3,10];case 9:if(n)throw n.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function Xfe(i,e,t,r,n){r===void 0&&(r=0),n===void 0&&(n=!1);var l=e.schedule(function(){t(),n?i.add(this.schedule(null,r)):this.unsubscribe()},r);if(i.add(l),!n)return l}function Zfe(i){return i instanceof Date&&!isNaN(i)}function Vq(i,e){return PC(function(t,r){var n=0;t.subscribe(WM(r,function(l){r.next(i.call(e,l,n++))}))})}var Jfe=Array.isArray;function Yfe(i,e){return Jfe(e)?i.apply(void 0,VM([],sw(e))):i(e)}function Kfe(i){return Vq(function(e){return Yfe(i,e)})}function Qfe(i,e,t,r,n,l,c,h){var d=[],f=0,m=0,g=!1,y=function(){g&&!d.length&&!f&&e.complete()},_=function(S){return f<r?b(S):d.push(S)},b=function(S){l&&e.next(S),f++;var E=!1;xE(t(S,m++)).subscribe(WM(e,function(T){n==null||n(T),l?_(T):e.next(T)},function(){E=!0},void 0,function(){if(E)try{f--;for(var T=function(){var A=d.shift();c?Xfe(e,c,function(){return b(A)}):b(A)};d.length&&f<r;)T();y()}catch(A){e.error(A)}}))};return i.subscribe(WM(e,_,function(){g=!0,y()})),function(){h==null||h()}}function Wq(i,e,t){return t===void 0&&(t=1/0),Vn(e)?Wq(function(r,n){return Vq(function(l,c){return e(r,l,n,c)})(xE(i(r,n)))},t):(typeof e=="number"&&(t=e),PC(function(r,n){return Qfe(r,n,i,t)}))}var epe=["addListener","removeListener"],tpe=["addEventListener","removeEventListener"],ipe=["on","off"];function AF(i,e,t,r){if(Vn(t)&&(r=t,t=void 0),r)return AF(i,e,t).pipe(Kfe(r));var n=sw(spe(i)?tpe.map(function(h){return function(d){return i[h](e,d,t)}}):rpe(i)?epe.map(B$(i,e)):npe(i)?ipe.map(B$(i,e)):[],2),l=n[0],c=n[1];if(!l&&Hq(i))return Wq(function(h){return AF(h,e,t)})(xE(i));if(!l)throw new TypeError("Invalid event target");return new Sf(function(h){var d=function(){for(var f=[],m=0;m<arguments.length;m++)f[m]=arguments[m];return h.next(1<f.length?f:f[0])};return l(d),function(){return c(d)}})}function B$(i,e){return function(t){return function(r){return i[t](e,r)}}}function rpe(i){return Vn(i.addListener)&&Vn(i.removeListener)}function npe(i){return Vn(i.on)&&Vn(i.off)}function spe(i){return Vn(i.addEventListener)&&Vn(i.removeEventListener)}function ape(i,e,t){i===void 0&&(i=0),t===void 0&&(t=Ife);var r=-1;return e!=null&&(Lfe(e)?t=e:r=e),new Sf(function(n){var l=Zfe(i)?+i-t.now():i;l<0&&(l=0);var c=0;return t.schedule(function(){n.closed||(n.next(c++),0<=r?this.schedule(void 0,r):n.complete())},l)})}function ope(i,e){return e===void 0&&(e=Bq),i=i??lpe,PC(function(t,r){var n,l=!0;t.subscribe(WM(r,function(c){var h=e(c);(l||!i(n,h))&&(l=!1,n=h,r.next(c))}))})}function lpe(i,e){return i===e}function upe(i){i===void 0&&(i={});var e=i.connector,t=e===void 0?function(){return new RC}:e,r=i.resetOnError,n=r===void 0?!0:r,l=i.resetOnComplete,c=l===void 0?!0:l,h=i.resetOnRefCountZero,d=h===void 0?!0:h;return function(f){var m,g,y,_=0,b=!1,S=!1,E=function(){g==null||g.unsubscribe(),g=void 0},T=function(){E(),m=y=void 0,b=S=!1},A=function(){var P=m;T(),P==null||P.unsubscribe()};return PC(function(P,O){_++,!S&&!b&&E();var R=y=y??t();O.add(function(){_--,_===0&&!S&&!b&&(g=wN(A,d))}),R.subscribe(O),!m&&_>0&&(m=new UA({next:function(D){return R.next(D)},error:function(D){S=!0,E(),g=wN(T,n,D),R.error(D)},complete:function(){b=!0,E(),g=wN(T,c),R.complete()}}),xE(P).subscribe(m))})(f)}}function wN(i,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];if(e===!0){i();return}if(e!==!1){var n=new UA({next:function(){n.unsubscribe(),i()}});return xE(e.apply(void 0,VM([],sw(t)))).subscribe(n)}}function cpe(i,e,t){var r,n,l,c,h=!1;return i&&typeof i=="object"?(r=i.bufferSize,c=r===void 0?1/0:r,n=i.windowTime,e=n===void 0?1/0:n,l=i.refCount,h=l===void 0?!1:l,t=i.scheduler):c=i??1/0,upe({connector:function(){return new Afe(c,e,t)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:h})}function hpe(i,e){return PC(function(t,r){var n=e??{},l=n.leading,c=l===void 0?!0:l,h=n.trailing,d=h===void 0?!1:h,f=!1,m=null,g=null,y=!1,_=function(){g==null||g.unsubscribe(),g=null,d&&(E(),y&&r.complete())},b=function(){g=null,y&&r.complete()},S=function(T){return g=xE(i(T)).subscribe(WM(r,_,b))},E=function(){if(f){f=!1;var T=m;m=null,r.next(T),!y&&S(T)}};t.subscribe(WM(r,function(T){f=!0,m=T,!(g&&!g.closed)&&(c?E():S(T))},function(){y=!0,!(d&&f&&g&&!g.closed)&&r.complete()}))})}function dpe(i,e,t){e===void 0&&(e=Uq);var r=ape(i,e);return hpe(function(){return r},t)}const fpe={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},jq={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},Ms={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},Hl={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},gm={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"};class ft{static getFirstMatch(e,t){const r=t.match(e);return r&&r.length>0&&r[1]||""}static getSecondMatch(e,t){const r=t.match(e);return r&&r.length>1&&r[2]||""}static matchAndReturnConst(e,t,r){if(e.test(t))return r}static getWindowsVersionName(e){switch(e){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}static getMacOSVersionName(e){const t=e.split(".").splice(0,2).map(r=>parseInt(r,10)||0);if(t.push(0),t[0]===10)switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}static getAndroidVersionName(e){const t=e.split(".").splice(0,2).map(r=>parseInt(r,10)||0);if(t.push(0),!(t[0]===1&&t[1]<5)){if(t[0]===1&&t[1]<6)return"Cupcake";if(t[0]===1&&t[1]>=6)return"Donut";if(t[0]===2&&t[1]<2)return"Eclair";if(t[0]===2&&t[1]===2)return"Froyo";if(t[0]===2&&t[1]>2)return"Gingerbread";if(t[0]===3)return"Honeycomb";if(t[0]===4&&t[1]<1)return"Ice Cream Sandwich";if(t[0]===4&&t[1]<4)return"Jelly Bean";if(t[0]===4&&t[1]>=4)return"KitKat";if(t[0]===5)return"Lollipop";if(t[0]===6)return"Marshmallow";if(t[0]===7)return"Nougat";if(t[0]===8)return"Oreo";if(t[0]===9)return"Pie"}}static getVersionPrecision(e){return e.split(".").length}static compareVersions(e,t,r=!1){const n=ft.getVersionPrecision(e),l=ft.getVersionPrecision(t);let c=Math.max(n,l),h=0;const d=ft.map([e,t],f=>{const m=c-ft.getVersionPrecision(f),g=f+new Array(m+1).join(".0");return ft.map(g.split("."),y=>new Array(20-y.length).join("0")+y).reverse()});for(r&&(h=c-Math.min(n,l)),c-=1;c>=h;){if(d[0][c]>d[1][c])return 1;if(d[0][c]===d[1][c]){if(c===h)return 0;c-=1}else if(d[0][c]<d[1][c])return-1}}static map(e,t){const r=[];let n;if(Array.prototype.map)return Array.prototype.map.call(e,t);for(n=0;n<e.length;n+=1)r.push(t(e[n]));return r}static find(e,t){let r,n;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(r=0,n=e.length;r<n;r+=1){const l=e[r];if(t(l,r))return l}}static assign(e,...t){const r=e;let n,l;if(Object.assign)return Object.assign(e,...t);for(n=0,l=t.length;n<l;n+=1){const c=t[n];typeof c=="object"&&c!==null&&Object.keys(c).forEach(d=>{r[d]=c[d]})}return e}static getBrowserAlias(e){return fpe[e]}static getBrowserTypeByAlias(e){return jq[e]||""}}const Fn=/version\/(\d+(\.?_?\d+)+)/i,ppe=[{test:[/googlebot/i],describe(i){const e={name:"Googlebot"},t=ft.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,i)||ft.getFirstMatch(Fn,i);return t&&(e.version=t),e}},{test:[/opera/i],describe(i){const e={name:"Opera"},t=ft.getFirstMatch(Fn,i)||ft.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,i);return t&&(e.version=t),e}},{test:[/opr\/|opios/i],describe(i){const e={name:"Opera"},t=ft.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,i)||ft.getFirstMatch(Fn,i);return t&&(e.version=t),e}},{test:[/SamsungBrowser/i],describe(i){const e={name:"Samsung Internet for Android"},t=ft.getFirstMatch(Fn,i)||ft.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,i);return t&&(e.version=t),e}},{test:[/Whale/i],describe(i){const e={name:"NAVER Whale Browser"},t=ft.getFirstMatch(Fn,i)||ft.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,i);return t&&(e.version=t),e}},{test:[/MZBrowser/i],describe(i){const e={name:"MZ Browser"},t=ft.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,i)||ft.getFirstMatch(Fn,i);return t&&(e.version=t),e}},{test:[/focus/i],describe(i){const e={name:"Focus"},t=ft.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,i)||ft.getFirstMatch(Fn,i);return t&&(e.version=t),e}},{test:[/swing/i],describe(i){const e={name:"Swing"},t=ft.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,i)||ft.getFirstMatch(Fn,i);return t&&(e.version=t),e}},{test:[/coast/i],describe(i){const e={name:"Opera Coast"},t=ft.getFirstMatch(Fn,i)||ft.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,i);return t&&(e.version=t),e}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe(i){const e={name:"Opera Touch"},t=ft.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,i)||ft.getFirstMatch(Fn,i);return t&&(e.version=t),e}},{test:[/yabrowser/i],describe(i){const e={name:"Yandex Browser"},t=ft.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,i)||ft.getFirstMatch(Fn,i);return t&&(e.version=t),e}},{test:[/ucbrowser/i],describe(i){const e={name:"UC Browser"},t=ft.getFirstMatch(Fn,i)||ft.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,i);return t&&(e.version=t),e}},{test:[/Maxthon|mxios/i],describe(i){const e={name:"Maxthon"},t=ft.getFirstMatch(Fn,i)||ft.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,i);return t&&(e.version=t),e}},{test:[/epiphany/i],describe(i){const e={name:"Epiphany"},t=ft.getFirstMatch(Fn,i)||ft.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,i);return t&&(e.version=t),e}},{test:[/puffin/i],describe(i){const e={name:"Puffin"},t=ft.getFirstMatch(Fn,i)||ft.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,i);return t&&(e.version=t),e}},{test:[/sleipnir/i],describe(i){const e={name:"Sleipnir"},t=ft.getFirstMatch(Fn,i)||ft.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,i);return t&&(e.version=t),e}},{test:[/k-meleon/i],describe(i){const e={name:"K-Meleon"},t=ft.getFirstMatch(Fn,i)||ft.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,i);return t&&(e.version=t),e}},{test:[/micromessenger/i],describe(i){const e={name:"WeChat"},t=ft.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,i)||ft.getFirstMatch(Fn,i);return t&&(e.version=t),e}},{test:[/qqbrowser/i],describe(i){const e={name:/qqbrowserlite/i.test(i)?"QQ Browser Lite":"QQ Browser"},t=ft.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,i)||ft.getFirstMatch(Fn,i);return t&&(e.version=t),e}},{test:[/msie|trident/i],describe(i){const e={name:"Internet Explorer"},t=ft.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,i);return t&&(e.version=t),e}},{test:[/\sedg\//i],describe(i){const e={name:"Microsoft Edge"},t=ft.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,i);return t&&(e.version=t),e}},{test:[/edg([ea]|ios)/i],describe(i){const e={name:"Microsoft Edge"},t=ft.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,i);return t&&(e.version=t),e}},{test:[/vivaldi/i],describe(i){const e={name:"Vivaldi"},t=ft.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,i);return t&&(e.version=t),e}},{test:[/seamonkey/i],describe(i){const e={name:"SeaMonkey"},t=ft.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,i);return t&&(e.version=t),e}},{test:[/sailfish/i],describe(i){const e={name:"Sailfish"},t=ft.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,i);return t&&(e.version=t),e}},{test:[/silk/i],describe(i){const e={name:"Amazon Silk"},t=ft.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,i);return t&&(e.version=t),e}},{test:[/phantom/i],describe(i){const e={name:"PhantomJS"},t=ft.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,i);return t&&(e.version=t),e}},{test:[/slimerjs/i],describe(i){const e={name:"SlimerJS"},t=ft.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,i);return t&&(e.version=t),e}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(i){const e={name:"BlackBerry"},t=ft.getFirstMatch(Fn,i)||ft.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,i);return t&&(e.version=t),e}},{test:[/(web|hpw)[o0]s/i],describe(i){const e={name:"WebOS Browser"},t=ft.getFirstMatch(Fn,i)||ft.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,i);return t&&(e.version=t),e}},{test:[/bada/i],describe(i){const e={name:"Bada"},t=ft.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,i);return t&&(e.version=t),e}},{test:[/tizen/i],describe(i){const e={name:"Tizen"},t=ft.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,i)||ft.getFirstMatch(Fn,i);return t&&(e.version=t),e}},{test:[/qupzilla/i],describe(i){const e={name:"QupZilla"},t=ft.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,i)||ft.getFirstMatch(Fn,i);return t&&(e.version=t),e}},{test:[/firefox|iceweasel|fxios/i],describe(i){const e={name:"Firefox"},t=ft.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,i);return t&&(e.version=t),e}},{test:[/electron/i],describe(i){const e={name:"Electron"},t=ft.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,i);return t&&(e.version=t),e}},{test:[/MiuiBrowser/i],describe(i){const e={name:"Miui"},t=ft.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,i);return t&&(e.version=t),e}},{test:[/chromium/i],describe(i){const e={name:"Chromium"},t=ft.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,i)||ft.getFirstMatch(Fn,i);return t&&(e.version=t),e}},{test:[/chrome|crios|crmo/i],describe(i){const e={name:"Chrome"},t=ft.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,i);return t&&(e.version=t),e}},{test:[/GSA/i],describe(i){const e={name:"Google Search"},t=ft.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,i);return t&&(e.version=t),e}},{test(i){const e=!i.test(/like android/i),t=i.test(/android/i);return e&&t},describe(i){const e={name:"Android Browser"},t=ft.getFirstMatch(Fn,i);return t&&(e.version=t),e}},{test:[/playstation 4/i],describe(i){const e={name:"PlayStation 4"},t=ft.getFirstMatch(Fn,i);return t&&(e.version=t),e}},{test:[/safari|applewebkit/i],describe(i){const e={name:"Safari"},t=ft.getFirstMatch(Fn,i);return t&&(e.version=t),e}},{test:[/.*/i],describe(i){const e=/^(.*)\/(.*) /,t=/^(.*)\/(.*)[ \t]\((.*)/,n=i.search("\\(")!==-1?t:e;return{name:ft.getFirstMatch(n,i),version:ft.getSecondMatch(n,i)}}}],mpe=[{test:[/Roku\/DVP/],describe(i){const e=ft.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,i);return{name:Hl.Roku,version:e}}},{test:[/windows phone/i],describe(i){const e=ft.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,i);return{name:Hl.WindowsPhone,version:e}}},{test:[/windows /i],describe(i){const e=ft.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,i),t=ft.getWindowsVersionName(e);return{name:Hl.Windows,version:e,versionName:t}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(i){const e={name:Hl.iOS},t=ft.getSecondMatch(/(Version\/)(\d[\d.]+)/,i);return t&&(e.version=t),e}},{test:[/macintosh/i],describe(i){const e=ft.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,i).replace(/[_\s]/g,"."),t=ft.getMacOSVersionName(e),r={name:Hl.MacOS,version:e};return t&&(r.versionName=t),r}},{test:[/(ipod|iphone|ipad)/i],describe(i){const e=ft.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,i).replace(/[_\s]/g,".");return{name:Hl.iOS,version:e}}},{test(i){const e=!i.test(/like android/i),t=i.test(/android/i);return e&&t},describe(i){const e=ft.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,i),t=ft.getAndroidVersionName(e),r={name:Hl.Android,version:e};return t&&(r.versionName=t),r}},{test:[/(web|hpw)[o0]s/i],describe(i){const e=ft.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,i),t={name:Hl.WebOS};return e&&e.length&&(t.version=e),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(i){const e=ft.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,i)||ft.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,i)||ft.getFirstMatch(/\bbb(\d+)/i,i);return{name:Hl.BlackBerry,version:e}}},{test:[/bada/i],describe(i){const e=ft.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,i);return{name:Hl.Bada,version:e}}},{test:[/tizen/i],describe(i){const e=ft.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,i);return{name:Hl.Tizen,version:e}}},{test:[/linux/i],describe(){return{name:Hl.Linux}}},{test:[/CrOS/],describe(){return{name:Hl.ChromeOS}}},{test:[/PlayStation 4/],describe(i){const e=ft.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,i);return{name:Hl.PlayStation4,version:e}}}],gpe=[{test:[/googlebot/i],describe(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe(i){const e=ft.getFirstMatch(/(can-l01)/i,i)&&"Nova",t={type:Ms.mobile,vendor:"Huawei"};return e&&(t.model=e),t}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe(){return{type:Ms.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe(){return{type:Ms.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(){return{type:Ms.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe(){return{type:Ms.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe(){return{type:Ms.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe(){return{type:Ms.tablet}}},{test(i){const e=i.test(/ipod|iphone/i),t=i.test(/like (ipod|iphone)/i);return e&&!t},describe(i){const e=ft.getFirstMatch(/(ipod|iphone)/i,i);return{type:Ms.mobile,vendor:"Apple",model:e}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe(){return{type:Ms.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe(){return{type:Ms.mobile}}},{test(i){return i.getBrowserName(!0)==="blackberry"},describe(){return{type:Ms.mobile,vendor:"BlackBerry"}}},{test(i){return i.getBrowserName(!0)==="bada"},describe(){return{type:Ms.mobile}}},{test(i){return i.getBrowserName()==="windows phone"},describe(){return{type:Ms.mobile,vendor:"Microsoft"}}},{test(i){const e=Number(String(i.getOSVersion()).split(".")[0]);return i.getOSName(!0)==="android"&&e>=3},describe(){return{type:Ms.tablet}}},{test(i){return i.getOSName(!0)==="android"},describe(){return{type:Ms.mobile}}},{test(i){return i.getOSName(!0)==="macos"},describe(){return{type:Ms.desktop,vendor:"Apple"}}},{test(i){return i.getOSName(!0)==="windows"},describe(){return{type:Ms.desktop}}},{test(i){return i.getOSName(!0)==="linux"},describe(){return{type:Ms.desktop}}},{test(i){return i.getOSName(!0)==="playstation 4"},describe(){return{type:Ms.tv}}},{test(i){return i.getOSName(!0)==="roku"},describe(){return{type:Ms.tv}}}],vpe=[{test(i){return i.getBrowserName(!0)==="microsoft edge"},describe(i){if(/\sedg\//i.test(i))return{name:gm.Blink};const t=ft.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,i);return{name:gm.EdgeHTML,version:t}}},{test:[/trident/i],describe(i){const e={name:gm.Trident},t=ft.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,i);return t&&(e.version=t),e}},{test(i){return i.test(/presto/i)},describe(i){const e={name:gm.Presto},t=ft.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,i);return t&&(e.version=t),e}},{test(i){const e=i.test(/gecko/i),t=i.test(/like gecko/i);return e&&!t},describe(i){const e={name:gm.Gecko},t=ft.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,i);return t&&(e.version=t),e}},{test:[/(apple)?webkit\/537\.36/i],describe(){return{name:gm.Blink}}},{test:[/(apple)?webkit/i],describe(i){const e={name:gm.WebKit},t=ft.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,i);return t&&(e.version=t),e}}];class U${constructor(e,t=!1){if(e==null||e==="")throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},t!==!0&&this.parse()}getUA(){return this._ua}test(e){return e.test(this._ua)}parseBrowser(){this.parsedResult.browser={};const e=ft.find(ppe,t=>{if(typeof t.test=="function")return t.test(this);if(t.test instanceof Array)return t.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.browser=e.describe(this.getUA())),this.parsedResult.browser}getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}getBrowserName(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}getBrowserVersion(){return this.getBrowser().version}getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}parseOS(){this.parsedResult.os={};const e=ft.find(mpe,t=>{if(typeof t.test=="function")return t.test(this);if(t.test instanceof Array)return t.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.os=e.describe(this.getUA())),this.parsedResult.os}getOSName(e){const{name:t}=this.getOS();return e?String(t).toLowerCase()||"":t||""}getOSVersion(){return this.getOS().version}getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}getPlatformType(e=!1){const{type:t}=this.getPlatform();return e?String(t).toLowerCase()||"":t||""}parsePlatform(){this.parsedResult.platform={};const e=ft.find(gpe,t=>{if(typeof t.test=="function")return t.test(this);if(t.test instanceof Array)return t.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.platform=e.describe(this.getUA())),this.parsedResult.platform}getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}getEngineName(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}parseEngine(){this.parsedResult.engine={};const e=ft.find(vpe,t=>{if(typeof t.test=="function")return t.test(this);if(t.test instanceof Array)return t.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.engine=e.describe(this.getUA())),this.parsedResult.engine}parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}getResult(){return ft.assign({},this.parsedResult)}satisfies(e){const t={};let r=0;const n={};let l=0;if(Object.keys(e).forEach(h=>{const d=e[h];typeof d=="string"?(n[h]=d,l+=1):typeof d=="object"&&(t[h]=d,r+=1)}),r>0){const h=Object.keys(t),d=ft.find(h,m=>this.isOS(m));if(d){const m=this.satisfies(t[d]);if(m!==void 0)return m}const f=ft.find(h,m=>this.isPlatform(m));if(f){const m=this.satisfies(t[f]);if(m!==void 0)return m}}if(l>0){const h=Object.keys(n),d=ft.find(h,f=>this.isBrowser(f,!0));if(d!==void 0)return this.compareVersion(n[d])}}isBrowser(e,t=!1){const r=this.getBrowserName().toLowerCase();let n=e.toLowerCase();const l=ft.getBrowserTypeByAlias(n);return t&&l&&(n=l.toLowerCase()),n===r}compareVersion(e){let t=[0],r=e,n=!1;const l=this.getBrowserVersion();if(typeof l=="string")return e[0]===">"||e[0]==="<"?(r=e.substr(1),e[1]==="="?(n=!0,r=e.substr(2)):t=[],e[0]===">"?t.push(1):t.push(-1)):e[0]==="="?r=e.substr(1):e[0]==="~"&&(n=!0,r=e.substr(1)),t.indexOf(ft.compareVersions(l,r,n))>-1}isOS(e){return this.getOSName(!0)===String(e).toLowerCase()}isPlatform(e){return this.getPlatformType(!0)===String(e).toLowerCase()}isEngine(e){return this.getEngineName(!0)===String(e).toLowerCase()}is(e,t=!1){return this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)}some(e=[]){return e.some(t=>this.is(t))}}/*!
 * Bowser - a browser detector
 * https://github.com/lancedikson/bowser
 * MIT License | (c) Dustin Diaz 2012-2015
 * MIT License | (c) Denis Demchenko 2015-2019
 */class qf{static getParser(e,t=!1){if(typeof e!="string")throw new Error("UserAgent should be a string");return new U$(e,t)}static parse(e){return new U$(e).getResult()}static get BROWSER_MAP(){return jq}static get ENGINE_MAP(){return gm}static get OS_MAP(){return Hl}static get PLATFORMS_MAP(){return Ms}}var ype=Object.create,aL=Object.defineProperty,_pe=Object.defineProperties,xpe=Object.getOwnPropertyDescriptor,bpe=Object.getOwnPropertyDescriptors,wpe=Object.getOwnPropertyNames,H$=Object.getOwnPropertySymbols,Spe=Object.getPrototypeOf,Gq=Object.prototype.hasOwnProperty,Mpe=Object.prototype.propertyIsEnumerable,$$=(i,e,t)=>e in i?aL(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,ht=(i,e)=>{for(var t in e||(e={}))Gq.call(e,t)&&$$(i,t,e[t]);if(H$)for(var t of H$(e))Mpe.call(e,t)&&$$(i,t,e[t]);return i},Gi=(i,e)=>_pe(i,bpe(e)),Epe=(i,e)=>()=>(i&&(e=i(i=0)),e),bB=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),Tpe=(i,e)=>{for(var t in e)aL(i,t,{get:e[t],enumerable:!0})},Ape=(i,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of wpe(e))!Gq.call(i,n)&&n!==t&&aL(i,n,{get:()=>e[n],enumerable:!(r=xpe(e,n))||r.enumerable});return i},Cpe=(i,e,t)=>(t=i!=null?ype(Spe(i)):{},Ape(e||!i||!i.__esModule?aL(t,"default",{value:i,enumerable:!0}):t,i)),Km=(i,e,t)=>new Promise((r,n)=>{var l=d=>{try{h(t.next(d))}catch(f){n(f)}},c=d=>{try{h(t.throw(d))}catch(f){n(f)}},h=d=>d.done?r(d.value):Promise.resolve(d.value).then(l,c);h((t=t.apply(i,e)).next())}),qq,ri=Epe(()=>{qq={}}),Ppe=bB((i,e)=>{ri();var t=1e3,r=t*60,n=r*60,l=n*24,c=l*7,h=l*365.25;e.exports=function(y,_){_=_||{};var b=typeof y;if(b==="string"&&y.length>0)return d(y);if(b==="number"&&isFinite(y))return _.long?m(y):f(y);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(y))};function d(y){if(y=String(y),!(y.length>100)){var _=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(y);if(_){var b=parseFloat(_[1]),S=(_[2]||"ms").toLowerCase();switch(S){case"years":case"year":case"yrs":case"yr":case"y":return b*h;case"weeks":case"week":case"w":return b*c;case"days":case"day":case"d":return b*l;case"hours":case"hour":case"hrs":case"hr":case"h":return b*n;case"minutes":case"minute":case"mins":case"min":case"m":return b*r;case"seconds":case"second":case"secs":case"sec":case"s":return b*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return b;default:return}}}}function f(y){var _=Math.abs(y);return _>=l?Math.round(y/l)+"d":_>=n?Math.round(y/n)+"h":_>=r?Math.round(y/r)+"m":_>=t?Math.round(y/t)+"s":y+"ms"}function m(y){var _=Math.abs(y);return _>=l?g(y,_,l,"day"):_>=n?g(y,_,n,"hour"):_>=r?g(y,_,r,"minute"):_>=t?g(y,_,t,"second"):y+" ms"}function g(y,_,b,S){var E=_>=b*1.5;return Math.round(y/b)+" "+S+(E?"s":"")}}),Rpe=bB((i,e)=>{ri();function t(r){l.debug=l,l.default=l,l.coerce=g,l.disable=d,l.enable=h,l.enabled=f,l.humanize=Ppe(),l.destroy=y,Object.keys(r).forEach(_=>{l[_]=r[_]}),l.names=[],l.skips=[],l.formatters={};function n(_){let b=0;for(let S=0;S<_.length;S++)b=(b<<5)-b+_.charCodeAt(S),b|=0;return l.colors[Math.abs(b)%l.colors.length]}l.selectColor=n;function l(_){let b,S=null,E,T;function A(...P){if(!A.enabled)return;let O=A,R=Number(new Date),D=R-(b||R);O.diff=D,O.prev=b,O.curr=R,b=R,P[0]=l.coerce(P[0]),typeof P[0]!="string"&&P.unshift("%O");let L=0;P[0]=P[0].replace(/%([a-zA-Z%])/g,(N,U)=>{if(N==="%%")return"%";L++;let F=l.formatters[U];if(typeof F=="function"){let z=P[L];N=F.call(O,z),P.splice(L,1),L--}return N}),l.formatArgs.call(O,P),(O.log||l.log).apply(O,P)}return A.namespace=_,A.useColors=l.useColors(),A.color=l.selectColor(_),A.extend=c,A.destroy=l.destroy,Object.defineProperty(A,"enabled",{enumerable:!0,configurable:!1,get:()=>S!==null?S:(E!==l.namespaces&&(E=l.namespaces,T=l.enabled(_)),T),set:P=>{S=P}}),typeof l.init=="function"&&l.init(A),A}function c(_,b){let S=l(this.namespace+(typeof b>"u"?":":b)+_);return S.log=this.log,S}function h(_){l.save(_),l.namespaces=_,l.names=[],l.skips=[];let b,S=(typeof _=="string"?_:"").split(/[\s,]+/),E=S.length;for(b=0;b<E;b++)!S[b]||(_=S[b].replace(/\*/g,".*?"),_[0]==="-"?l.skips.push(new RegExp("^"+_.slice(1)+"$")):l.names.push(new RegExp("^"+_+"$")))}function d(){let _=[...l.names.map(m),...l.skips.map(m).map(b=>"-"+b)].join(",");return l.enable(""),_}function f(_){if(_[_.length-1]==="*")return!0;let b,S;for(b=0,S=l.skips.length;b<S;b++)if(l.skips[b].test(_))return!1;for(b=0,S=l.names.length;b<S;b++)if(l.names[b].test(_))return!0;return!1}function m(_){return _.toString().substring(2,_.toString().length-2).replace(/\.\*\?$/,"*")}function g(_){return _ instanceof Error?_.stack||_.message:_}function y(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return l.enable(l.load()),l}e.exports=t}),Ipe=bB((i,e)=>{ri(),i.formatArgs=r,i.save=n,i.load=l,i.useColors=t,i.storage=c(),i.destroy=(()=>{let d=!1;return()=>{d||(d=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),i.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function t(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(d){if(d[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+d[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;let f="color: "+this.color;d.splice(1,0,f,"color: inherit");let m=0,g=0;d[0].replace(/%[a-zA-Z%]/g,y=>{y!=="%%"&&(m++,y==="%c"&&(g=m))}),d.splice(g,0,f)}i.log=console.debug||console.log||(()=>{});function n(d){try{d?i.storage.setItem("debug",d):i.storage.removeItem("debug")}catch{}}function l(){let d;try{d=i.storage.getItem("debug")}catch{}return!d&&typeof process<"u"&&"env"in process&&(d=qq.DEBUG),d}function c(){try{return localStorage}catch{}}e.exports=Rpe()(i);var{formatters:h}=e.exports;h.j=function(d){try{return JSON.stringify(d)}catch(f){return"[UnexpectedJSONParseError]: "+f.message}}});ri();ri();var Lpe=(i=>(i.JOIN_ROOM="room.join",i.JOINED_ROOM="room.joined",i.LEAVE_ROOM="room.leave",i.UPDATE="room.update",i.ERROR="room.error",i))(Lpe||{}),bs=(i=>(i.JOINED_ROOM="presence.joined-room",i.LEAVE="presence.leave",i.ERROR="presence.error",i.UPDATE="presence.update",i))(bs||{});ri();var Ope=(i=>(i.CONNECTED="CONNECTED",i.CONNECTING="CONNECTING",i.DISCONNECTED="DISCONNECTED",i.CONNECTION_ERROR="CONNECTION_ERROR",i.RECONNECTING="RECONNECTING",i.RECONNECT_ERROR="RECONNECT_ERROR",i))(Ope||{});ri();ri();ri();ri();ri();var CF=function(i,e){return CF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])},CF(i,e)};function oL(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");CF(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function PF(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],r=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&r>=i.length&&(i=void 0),{value:i&&i[r++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function RF(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var r=t.call(i),n,l=[],c;try{for(;(e===void 0||e-- >0)&&!(n=r.next()).done;)l.push(n.value)}catch(h){c={error:h}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(c)throw c.error}}return l}function IF(i,e,t){if(t||arguments.length===2)for(var r=0,n=e.length,l;r<n;r++)(l||!(r in e))&&(l||(l=Array.prototype.slice.call(e,0,r)),l[r]=e[r]);return i.concat(l||Array.prototype.slice.call(e))}ri();function yp(i){return typeof i=="function"}ri();ri();ri();function Xq(i){var e=function(r){Error.call(r),r.stack=new Error().stack},t=i(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var SN=Xq(function(i){return function(e){i(this),this.message=e?e.length+` errors occurred during unsubscription:
`+e.map(function(t,r){return r+1+") "+t.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=e}});ri();function LF(i,e){if(i){var t=i.indexOf(e);0<=t&&i.splice(t,1)}}var lL=function(){function i(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return i.prototype.unsubscribe=function(){var e,t,r,n,l;if(!this.closed){this.closed=!0;var c=this._parentage;if(c)if(this._parentage=null,Array.isArray(c))try{for(var h=PF(c),d=h.next();!d.done;d=h.next()){var f=d.value;f.remove(this)}}catch(S){e={error:S}}finally{try{d&&!d.done&&(t=h.return)&&t.call(h)}finally{if(e)throw e.error}}else c.remove(this);var m=this.initialTeardown;if(yp(m))try{m()}catch(S){l=S instanceof SN?S.errors:[S]}var g=this._finalizers;if(g){this._finalizers=null;try{for(var y=PF(g),_=y.next();!_.done;_=y.next()){var b=_.value;try{V$(b)}catch(S){l=l??[],S instanceof SN?l=IF(IF([],RF(l)),RF(S.errors)):l.push(S)}}}catch(S){r={error:S}}finally{try{_&&!_.done&&(n=y.return)&&n.call(y)}finally{if(r)throw r.error}}}if(l)throw new SN(l)}},i.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)V$(e);else{if(e instanceof i){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},i.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},i.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},i.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&LF(t,e)},i.prototype.remove=function(e){var t=this._finalizers;t&&LF(t,e),e instanceof i&&e._removeParent(this)},i.EMPTY=function(){var e=new i;return e.closed=!0,e}(),i}(),Zq=lL.EMPTY;function Jq(i){return i instanceof lL||i&&"closed"in i&&yp(i.remove)&&yp(i.add)&&yp(i.unsubscribe)}function V$(i){yp(i)?i():i.unsubscribe()}ri();var Yq={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};ri();ri();var Npe={setTimeout:function(i,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return setTimeout.apply(void 0,IF([i,e],RF(t)))},clearTimeout:function(i){return clearTimeout(i)},delegate:void 0};function Dpe(i){Npe.setTimeout(function(){throw i})}ri();function W$(){}ri();ri();function XP(i){i()}var Kq=function(i){oL(e,i);function e(t){var r=i.call(this)||this;return r.isStopped=!1,t?(r.destination=t,Jq(t)&&t.add(r)):r.destination=Bpe,r}return e.create=function(t,r,n){return new OF(t,r,n)},e.prototype.next=function(t){this.isStopped?void 0:this._next(t)},e.prototype.error=function(t){this.isStopped?void 0:(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped?void 0:(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,i.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(lL),kpe=Function.prototype.bind;function MN(i,e){return kpe.call(i,e)}var Fpe=function(){function i(e){this.partialObserver=e}return i.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(r){a3(r)}},i.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(r){a3(r)}else a3(e)},i.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){a3(t)}},i}(),OF=function(i){oL(e,i);function e(t,r,n){var l=i.call(this)||this,c;if(yp(t)||!t)c={next:t??void 0,error:r??void 0,complete:n??void 0};else{var h;l&&Yq.useDeprecatedNextContext?(h=Object.create(t),h.unsubscribe=function(){return l.unsubscribe()},c={next:t.next&&MN(t.next,h),error:t.error&&MN(t.error,h),complete:t.complete&&MN(t.complete,h)}):c=t}return l.destination=new Fpe(c),l}return e}(Kq);function a3(i){Dpe(i)}function zpe(i){throw i}var Bpe={closed:!0,next:W$,error:zpe,complete:W$};ri();var Upe=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();ri();ri();function Hpe(i){return i}function $pe(i){return i.length===0?Hpe:i.length===1?i[0]:function(e){return i.reduce(function(t,r){return r(t)},e)}}var j$=function(){function i(e){e&&(this._subscribe=e)}return i.prototype.lift=function(e){var t=new i;return t.source=this,t.operator=e,t},i.prototype.subscribe=function(e,t,r){var n=this,l=Wpe(e)?e:new OF(e,t,r);return XP(function(){var c=n,h=c.operator,d=c.source;l.add(h?h.call(l,d):d?n._subscribe(l):n._trySubscribe(l))}),l},i.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},i.prototype.forEach=function(e,t){var r=this;return t=G$(t),new t(function(n,l){var c=new OF({next:function(h){try{e(h)}catch(d){l(d),c.unsubscribe()}},error:l,complete:n});r.subscribe(c)})},i.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},i.prototype[Upe]=function(){return this},i.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return $pe(e)(this)},i.prototype.toPromise=function(e){var t=this;return e=G$(e),new e(function(r,n){var l;t.subscribe(function(c){return l=c},function(c){return n(c)},function(){return r(l)})})},i.create=function(e){return new i(e)},i}();function G$(i){var e;return(e=i??Yq.Promise)!==null&&e!==void 0?e:Promise}function Vpe(i){return i&&yp(i.next)&&yp(i.error)&&yp(i.complete)}function Wpe(i){return i&&i instanceof Kq||Vpe(i)&&Jq(i)}ri();ri();var jpe=Xq(function(i){return function(){i(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),N1=function(i){oL(e,i);function e(){var t=i.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var r=new q$(this,this);return r.operator=t,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new jpe},e.prototype.next=function(t){var r=this;XP(function(){var n,l;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var c=PF(r.currentObservers),h=c.next();!h.done;h=c.next()){var d=h.value;d.next(t)}}catch(f){n={error:f}}finally{try{h&&!h.done&&(l=c.return)&&l.call(c)}finally{if(n)throw n.error}}}})},e.prototype.error=function(t){var r=this;XP(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=t;for(var n=r.observers;n.length;)n.shift().error(t)}})},e.prototype.complete=function(){var t=this;XP(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var r=t.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),i.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var r=this,n=this,l=n.hasError,c=n.isStopped,h=n.observers;return l||c?Zq:(this.currentObservers=null,h.push(t),new lL(function(){r.currentObservers=null,LF(h,t)}))},e.prototype._checkFinalizedStatuses=function(t){var r=this,n=r.hasError,l=r.thrownError,c=r.isStopped;n?t.error(l):c&&t.complete()},e.prototype.asObservable=function(){var t=new j$;return t.source=this,t},e.create=function(t,r){return new q$(t,r)},e}(j$),q$=function(i){oL(e,i);function e(t,r){var n=i.call(this)||this;return n.destination=t,n.source=r,n}return e.prototype.next=function(t){var r,n;(n=(r=this.destination)===null||r===void 0?void 0:r.next)===null||n===void 0||n.call(r,t)},e.prototype.error=function(t){var r,n;(n=(r=this.destination)===null||r===void 0?void 0:r.error)===null||n===void 0||n.call(r,t)},e.prototype.complete=function(){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||r===void 0||r.call(t)},e.prototype._subscribe=function(t){var r,n;return(n=(r=this.source)===null||r===void 0?void 0:r.subscribe(t))!==null&&n!==void 0?n:Zq},e}(N1);ri();ri();var X$=Cpe(Ipe()),wB=class{constructor(e){this.debug=(0,X$.default)(e),X$.default.enable("*")}log(e,...t){this.debug(e,...t)}},Qq=class{constructor(e,t,r){this.io=e,this.presence=t,this.roomId=r,this.presences=new Set,this.observers=new Map,this.onPresenceJoin=n=>{n.roomId===this.roomId&&(this.logger.log("presence room @ presence join",n),this.presences.add(n),this.observers.get("presence.joined-room").next({connectionId:n.connectionId,data:n.data,id:n.id,name:n.name,timestamp:n.timestamp}))},this.onPresenceLeave=n=>{n.roomId===this.roomId&&(this.logger.log("presence room @ presence leave",n),this.presences.delete(n),this.observers.get("presence.leave").next(n))},this.onPresenceUpdate=n=>{n.roomId===this.roomId&&(this.logger.log("presence room @ presence update",n),this.observers.get("presence.update").next({connectionId:n.connectionId,data:n.data,id:n.id,name:n.name,roomId:n.roomId,timestamp:n.timestamp}))},this.logger=new wB("@superviz/socket-client/presence"),this.registerSubsjects(),this.subscribeToPresenceEvents()}static register(e,t,r){return new Qq(e,t,r)}get(e,t){let r=new N1;r.subscribe({next:e,error:t});let n=l=>{let c=l.presences.map(h=>({connectionId:h.connectionId,data:h.data,id:h.id,name:h.name,timestamp:h.timestamp}));this.logger.log("presence room @ get",l),this.io.off("presence.get",n),r.next(c),r.complete()};this.io.on("presence.get",n),this.io.emit("presence.get",this.roomId)}update(e){let t={connectionId:this.io.id,data:e,id:this.presence.id,name:this.presence.name,timestamp:Date.now()};this.io.emit("presence.update",this.roomId,t),this.logger.log("presence room @ update",this.roomId,t)}registerSubsjects(){this.observers.set("presence.joined-room",new N1),this.observers.set("presence.leave",new N1),this.observers.set("presence.update",new N1)}on(e,t,r){this.observers.get(e).subscribe({error:r,next:t})}off(e){this.observers.get(e).unsubscribe()}subscribeToPresenceEvents(){this.io.on("presence.joined-room",this.onPresenceJoin),this.io.on("presence.leave",this.onPresenceLeave),this.io.on("presence.update",this.onPresenceUpdate)}};ri();ri();ri();ri();ri();ri();ri();ri();ri();ri();ri();ri();var Mf=Object.create(null);Mf.open="0";Mf.close="1";Mf.ping="2";Mf.pong="3";Mf.message="4";Mf.upgrade="5";Mf.noop="6";var ZP=Object.create(null);Object.keys(Mf).forEach(i=>{ZP[Mf[i]]=i});var NF={type:"error",data:"parser error"},eX=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",tX=typeof ArrayBuffer=="function",iX=i=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(i):i&&i.buffer instanceof ArrayBuffer,SB=({type:i,data:e},t,r)=>eX&&e instanceof Blob?t?r(e):Z$(e,r):tX&&(e instanceof ArrayBuffer||iX(e))?t?r(e):Z$(new Blob([e]),r):r(Mf[i]+(e||"")),Z$=(i,e)=>{let t=new FileReader;return t.onload=function(){let r=t.result.split(",")[1];e("b"+(r||""))},t.readAsDataURL(i)};function J$(i){return i instanceof Uint8Array?i:i instanceof ArrayBuffer?new Uint8Array(i):new Uint8Array(i.buffer,i.byteOffset,i.byteLength)}var EN;function Gpe(i,e){if(eX&&i.data instanceof Blob)return i.data.arrayBuffer().then(J$).then(e);if(tX&&(i.data instanceof ArrayBuffer||iX(i.data)))return e(J$(i.data));SB(i,!1,t=>{EN||(EN=new TextEncoder),e(EN.encode(t))})}ri();ri();var Y$="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",kT=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let i=0;i<Y$.length;i++)kT[Y$.charCodeAt(i)]=i;var qpe=i=>{let e=i.length*.75,t=i.length,r,n=0,l,c,h,d;i[i.length-1]==="="&&(e--,i[i.length-2]==="="&&e--);let f=new ArrayBuffer(e),m=new Uint8Array(f);for(r=0;r<t;r+=4)l=kT[i.charCodeAt(r)],c=kT[i.charCodeAt(r+1)],h=kT[i.charCodeAt(r+2)],d=kT[i.charCodeAt(r+3)],m[n++]=l<<2|c>>4,m[n++]=(c&15)<<4|h>>2,m[n++]=(h&3)<<6|d&63;return f},Xpe=typeof ArrayBuffer=="function",MB=(i,e)=>{if(typeof i!="string")return{type:"message",data:rX(i,e)};let t=i.charAt(0);return t==="b"?{type:"message",data:Zpe(i.substring(1),e)}:ZP[t]?i.length>1?{type:ZP[t],data:i.substring(1)}:{type:ZP[t]}:NF},Zpe=(i,e)=>{if(Xpe){let t=qpe(i);return rX(t,e)}else return{base64:!0,data:i}},rX=(i,e)=>{switch(e){case"blob":return i instanceof Blob?i:new Blob([i]);case"arraybuffer":default:return i instanceof ArrayBuffer?i:i.buffer}},nX="",Jpe=(i,e)=>{let t=i.length,r=new Array(t),n=0;i.forEach((l,c)=>{SB(l,!1,h=>{r[c]=h,++n===t&&e(r.join(nX))})})},Ype=(i,e)=>{let t=i.split(nX),r=[];for(let n=0;n<t.length;n++){let l=MB(t[n],e);if(r.push(l),l.type==="error")break}return r};function Kpe(){return new TransformStream({transform(i,e){Gpe(i,t=>{let r=t.length,n;if(r<126)n=new Uint8Array(1),new DataView(n.buffer).setUint8(0,r);else if(r<65536){n=new Uint8Array(3);let l=new DataView(n.buffer);l.setUint8(0,126),l.setUint16(1,r)}else{n=new Uint8Array(9);let l=new DataView(n.buffer);l.setUint8(0,127),l.setBigUint64(1,BigInt(r))}i.data&&typeof i.data!="string"&&(n[0]|=128),e.enqueue(n),e.enqueue(t)})}})}var TN;function o3(i){return i.reduce((e,t)=>e+t.length,0)}function l3(i,e){if(i[0].length===e)return i.shift();let t=new Uint8Array(e),r=0;for(let n=0;n<e;n++)t[n]=i[0][r++],r===i[0].length&&(i.shift(),r=0);return i.length&&r<i[0].length&&(i[0]=i[0].slice(r)),t}function Qpe(i,e){TN||(TN=new TextDecoder);let t=[],r=0,n=-1,l=!1;return new TransformStream({transform(c,h){for(t.push(c);;){if(r===0){if(o3(t)<1)break;let d=l3(t,1);l=(d[0]&128)===128,n=d[0]&127,n<126?r=3:n===126?r=1:r=2}else if(r===1){if(o3(t)<2)break;let d=l3(t,2);n=new DataView(d.buffer,d.byteOffset,d.length).getUint16(0),r=3}else if(r===2){if(o3(t)<8)break;let d=l3(t,8),f=new DataView(d.buffer,d.byteOffset,d.length),m=f.getUint32(0);if(m>Math.pow(2,21)-1){h.enqueue(NF);break}n=m*Math.pow(2,32)+f.getUint32(4),r=3}else{if(o3(t)<n)break;let d=l3(t,n);h.enqueue(MB(l?d:TN.decode(d),e)),r=0}if(n===0||n>i){h.enqueue(NF);break}}}})}var sX=4;ri();function Bs(i){if(i)return eme(i)}function eme(i){for(var e in Bs.prototype)i[e]=Bs.prototype[e];return i}Bs.prototype.on=Bs.prototype.addEventListener=function(i,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+i]=this._callbacks["$"+i]||[]).push(e),this};Bs.prototype.once=function(i,e){function t(){this.off(i,t),e.apply(this,arguments)}return t.fn=e,this.on(i,t),this};Bs.prototype.off=Bs.prototype.removeListener=Bs.prototype.removeAllListeners=Bs.prototype.removeEventListener=function(i,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+i];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+i],this;for(var r,n=0;n<t.length;n++)if(r=t[n],r===e||r.fn===e){t.splice(n,1);break}return t.length===0&&delete this._callbacks["$"+i],this};Bs.prototype.emit=function(i){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+i],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(t){t=t.slice(0);for(var r=0,n=t.length;r<n;++r)t[r].apply(this,e)}return this};Bs.prototype.emitReserved=Bs.prototype.emit;Bs.prototype.listeners=function(i){return this._callbacks=this._callbacks||{},this._callbacks["$"+i]||[]};Bs.prototype.hasListeners=function(i){return!!this.listeners(i).length};ri();ri();var ec=typeof self<"u"?self:typeof window<"u"?window:Function("return this")();function aX(i,...e){return e.reduce((t,r)=>(i.hasOwnProperty(r)&&(t[r]=i[r]),t),{})}var tme=ec.setTimeout,ime=ec.clearTimeout;function uL(i,e){e.useNativeTimers?(i.setTimeoutFn=tme.bind(ec),i.clearTimeoutFn=ime.bind(ec)):(i.setTimeoutFn=ec.setTimeout.bind(ec),i.clearTimeoutFn=ec.clearTimeout.bind(ec))}var rme=1.33;function nme(i){return typeof i=="string"?sme(i):Math.ceil((i.byteLength||i.size)*rme)}function sme(i){let e=0,t=0;for(let r=0,n=i.length;r<n;r++)e=i.charCodeAt(r),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(r++,t+=4);return t}ri();function ame(i){let e="";for(let t in i)i.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(i[t]));return e}function ome(i){let e={},t=i.split("&");for(let r=0,n=t.length;r<n;r++){let l=t[r].split("=");e[decodeURIComponent(l[0])]=decodeURIComponent(l[1])}return e}var lme=class extends Error{constructor(e,t,r){super(e),this.description=t,this.context=r,this.type="TransportError"}},EB=class extends Bs{constructor(e){super(),this.writable=!1,uL(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,t,r){return super.emitReserved("error",new lme(e,t,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){let t=MB(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){let e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){let t=ame(e);return t.length?"?"+t:""}};ri();var oX="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),DF=64,ume={},K$=0,u3=0,Q$;function eV(i){let e="";do e=oX[i%DF]+e,i=Math.floor(i/DF);while(i>0);return e}function lX(){let i=eV(+new Date);return i!==Q$?(K$=0,Q$=i):i+"."+eV(K$++)}for(;u3<DF;u3++)ume[oX[u3]]=u3;ri();ri();var uX=!1;try{uX=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}var cme=uX;function cX(i){let e=i.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||cme))return new XMLHttpRequest}catch{}if(!e)try{return new ec[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function hme(){}var dme=function(){return new cX({xdomain:!1}).responseType!=null}(),fme=class extends EB{constructor(e){if(super(e),this.polling=!1,typeof location<"u"){let r=location.protocol==="https:",n=location.port;n||(n=r?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||n!==e.port}let t=e&&e.forceBase64;this.supportsBinary=dme&&!t,this.opts.withCredentials&&(this.cookieJar=void 0)}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";let t=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let r=0;this.polling&&(r++,this.once("pollComplete",function(){--r||t()})),this.writable||(r++,this.once("drain",function(){--r||t()}))}else t()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){let t=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};Ype(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){let e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,Jpe(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=lX()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}request(e={}){return Object.assign(e,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new _p(this.uri(),e)}doWrite(e,t){let r=this.request({method:"POST",data:e});r.on("success",t),r.on("error",(n,l)=>{this.onError("xhr post error",n,l)})}doPoll(){let e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,r)=>{this.onError("xhr poll error",t,r)}),this.pollXhr=e}},_p=class extends Bs{constructor(e,t){super(),uL(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.data=t.data!==void 0?t.data:null,this.create()}create(){var e;let t=aX(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd;let r=this.xhr=new cX(t);try{r.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let n in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(n)&&r.setRequestHeader(n,this.opts.extraHeaders[n])}}catch{}if(this.method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(e=this.opts.cookieJar)===null||e===void 0||e.addCookies(r),"withCredentials"in r&&(r.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(r.timeout=this.opts.requestTimeout),r.onreadystatechange=()=>{var n;r.readyState===3&&((n=this.opts.cookieJar)===null||n===void 0||n.parseCookies(r)),r.readyState===4&&(r.status===200||r.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof r.status=="number"?r.status:0)},0))},r.send(this.data)}catch(n){this.setTimeoutFn(()=>{this.onError(n)},0);return}typeof document<"u"&&(this.index=_p.requestsCount++,_p.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=hme,e)try{this.xhr.abort()}catch{}typeof document<"u"&&delete _p.requests[this.index],this.xhr=null}}onLoad(){let e=this.xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}};_p.requestsCount=0;_p.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",tV);else if(typeof addEventListener=="function"){let i="onpagehide"in ec?"pagehide":"unload";addEventListener(i,tV,!1)}}function tV(){for(let i in _p.requests)_p.requests.hasOwnProperty(i)&&_p.requests[i].abort()}ri();ri();var TB=typeof Promise=="function"&&typeof Promise.resolve=="function"?i=>Promise.resolve().then(i):(i,e)=>e(i,0),c3=ec.WebSocket||ec.MozWebSocket,iV=!0,pme="arraybuffer",rV=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",mme=class extends EB{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;let e=this.uri(),t=this.opts.protocols,r=rV?{}:aX(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=iV&&!rV?t?new c3(e,t):new c3(e):new c3(e,t,r)}catch(n){return this.emitReserved("error",n)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let r=e[t],n=t===e.length-1;SB(r,this.supportsBinary,l=>{let c={};try{iV?this.ws.send(l):this.ws.send(l,c)}catch{}n&&TB(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){let e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=lX()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}check(){return!!c3}};ri();var gme=class extends EB{get name(){return"webtransport"}doOpen(){typeof WebTransport=="function"&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this.transport.ready.then(()=>{this.transport.createBidirectionalStream().then(e=>{let t=Qpe(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=e.readable.pipeThrough(t).getReader(),n=Kpe();n.readable.pipeTo(e.writable),this.writer=n.writable.getWriter();let l=()=>{r.read().then(({done:h,value:d})=>{h||(this.onPacket(d),l())}).catch(h=>{})};l();let c={type:"open"};this.query.sid&&(c.data=`{"sid":"${this.query.sid}"}`),this.writer.write(c).then(()=>this.onOpen())})}))}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let r=e[t],n=t===e.length-1;this.writer.write(r).then(()=>{n&&TB(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this.transport)===null||e===void 0||e.close()}},vme={websocket:mme,webtransport:gme,polling:fme};ri();var yme=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,_me=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function kF(i){if(i.length>2e3)throw"URI too long";let e=i,t=i.indexOf("["),r=i.indexOf("]");t!=-1&&r!=-1&&(i=i.substring(0,t)+i.substring(t,r).replace(/:/g,";")+i.substring(r,i.length));let n=yme.exec(i||""),l={},c=14;for(;c--;)l[_me[c]]=n[c]||"";return t!=-1&&r!=-1&&(l.source=e,l.host=l.host.substring(1,l.host.length-1).replace(/;/g,":"),l.authority=l.authority.replace("[","").replace("]","").replace(/;/g,":"),l.ipv6uri=!0),l.pathNames=xme(l,l.path),l.queryKey=bme(l,l.query),l}function xme(i,e){let t=/\/{2,9}/g,r=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&r.splice(0,1),e.slice(-1)=="/"&&r.splice(r.length-1,1),r}function bme(i,e){let t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,n,l){n&&(t[n]=l)}),t}var A1=class extends Bs{constructor(e,t={}){super(),this.binaryType=pme,this.writeBuffer=[],e&&typeof e=="object"&&(t=e,e=null),e?(e=kF(e),t.hostname=e.host,t.secure=e.protocol==="https"||e.protocol==="wss",t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=kF(t.host).host),uL(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=ome(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){let t=Object.assign({},this.opts.query);t.EIO=sX,t.transport=e,this.id&&(t.sid=this.id);let r=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new vme[e](r)}open(){let e;if(this.opts.rememberUpgrade&&A1.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)e="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else e=this.transports[0];this.readyState="opening";try{e=this.createTransport(e)}catch{this.transports.shift(),this.open();return}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",t=>this.onClose("transport close",t))}probe(e){let t=this.createTransport(e),r=!1;A1.priorWebsocketSuccess=!1;let n=()=>{r||(t.send([{type:"ping",data:"probe"}]),t.once("packet",g=>{if(!r)if(g.type==="pong"&&g.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;A1.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(m(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{let y=new Error("probe error");y.transport=t.name,this.emitReserved("upgradeError",y)}}))};function l(){r||(r=!0,m(),t.close(),t=null)}let c=g=>{let y=new Error("probe error: "+g);y.transport=t.name,l(),this.emitReserved("upgradeError",y)};function h(){c("transport closed")}function d(){c("socket closed")}function f(g){t&&g.name!==t.name&&l()}let m=()=>{t.removeListener("open",n),t.removeListener("error",c),t.removeListener("close",h),this.off("close",d),this.off("upgrading",f)};t.once("open",n),t.once("error",c),t.once("close",h),this.once("close",d),this.once("upgrading",f),this.upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{r||t.open()},200):t.open()}onOpen(){if(this.readyState="open",A1.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade){let e=0,t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),this.resetPingTimeout(),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":let t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let t=0;t<this.writeBuffer.length;t++){let r=this.writeBuffer[t].data;if(r&&(e+=nme(r)),t>0&&e>this.maxPayload)return this.writeBuffer.slice(0,t);e+=2}return this.writeBuffer}write(e,t,r){return this.sendPacket("message",e,t,r),this}send(e,t,r){return this.sendPacket("message",e,t,r),this}sendPacket(e,t,r,n){if(typeof t=="function"&&(n=t,t=void 0),typeof r=="function"&&(n=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;let l={type:e,data:t,options:r};this.emitReserved("packetCreate",l),this.writeBuffer.push(l),n&&this.once("flush",n),this.flush()}close(){let e=()=>{this.onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},r=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():e()}):this.upgrading?r():e()),this}onError(e){A1.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,t){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){let t=[],r=0,n=e.length;for(;r<n;r++)~this.transports.indexOf(e[r])&&t.push(e[r]);return t}};A1.protocol=sX;function wme(i,e="",t){let r=i;t=t||typeof location<"u"&&location,i==null&&(i=t.protocol+"//"+t.host),typeof i=="string"&&(i.charAt(0)==="/"&&(i.charAt(1)==="/"?i=t.protocol+i:i=t.host+i),/^(https?|wss?):\/\//.test(i)||(typeof t<"u"?i=t.protocol+"//"+i:i="https://"+i),r=kF(i)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";let n=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+n+":"+r.port+e,r.href=r.protocol+"://"+n+(t&&t.port===r.port?"":":"+r.port),r}ri();ri();var hX={};Tpe(hX,{Decoder:()=>fX,Encoder:()=>Ime,PacketType:()=>Ur,protocol:()=>Rme});ri();ri();ri();var Sme=typeof ArrayBuffer=="function",Mme=i=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(i):i.buffer instanceof ArrayBuffer,dX=Object.prototype.toString,Eme=typeof Blob=="function"||typeof Blob<"u"&&dX.call(Blob)==="[object BlobConstructor]",Tme=typeof File=="function"||typeof File<"u"&&dX.call(File)==="[object FileConstructor]";function AB(i){return Sme&&(i instanceof ArrayBuffer||Mme(i))||Eme&&i instanceof Blob||Tme&&i instanceof File}function JP(i,e){if(!i||typeof i!="object")return!1;if(Array.isArray(i)){for(let t=0,r=i.length;t<r;t++)if(JP(i[t]))return!0;return!1}if(AB(i))return!0;if(i.toJSON&&typeof i.toJSON=="function"&&arguments.length===1)return JP(i.toJSON(),!0);for(let t in i)if(Object.prototype.hasOwnProperty.call(i,t)&&JP(i[t]))return!0;return!1}function Ame(i){let e=[],t=i.data,r=i;return r.data=FF(t,e),r.attachments=e.length,{packet:r,buffers:e}}function FF(i,e){if(!i)return i;if(AB(i)){let t={_placeholder:!0,num:e.length};return e.push(i),t}else if(Array.isArray(i)){let t=new Array(i.length);for(let r=0;r<i.length;r++)t[r]=FF(i[r],e);return t}else if(typeof i=="object"&&!(i instanceof Date)){let t={};for(let r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=FF(i[r],e));return t}return i}function Cme(i,e){return i.data=zF(i.data,e),delete i.attachments,i}function zF(i,e){if(!i)return i;if(i&&i._placeholder===!0){if(typeof i.num=="number"&&i.num>=0&&i.num<e.length)return e[i.num];throw new Error("illegal attachments")}else if(Array.isArray(i))for(let t=0;t<i.length;t++)i[t]=zF(i[t],e);else if(typeof i=="object")for(let t in i)Object.prototype.hasOwnProperty.call(i,t)&&(i[t]=zF(i[t],e));return i}var Pme=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Rme=5,Ur;(function(i){i[i.CONNECT=0]="CONNECT",i[i.DISCONNECT=1]="DISCONNECT",i[i.EVENT=2]="EVENT",i[i.ACK=3]="ACK",i[i.CONNECT_ERROR=4]="CONNECT_ERROR",i[i.BINARY_EVENT=5]="BINARY_EVENT",i[i.BINARY_ACK=6]="BINARY_ACK"})(Ur||(Ur={}));var Ime=class{constructor(e){this.replacer=e}encode(e){return(e.type===Ur.EVENT||e.type===Ur.ACK)&&JP(e)?this.encodeAsBinary({type:e.type===Ur.EVENT?Ur.BINARY_EVENT:Ur.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===Ur.BINARY_EVENT||e.type===Ur.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){let t=Ame(e),r=this.encodeAsString(t.packet),n=t.buffers;return n.unshift(r),n}};function nV(i){return Object.prototype.toString.call(i)==="[object Object]"}var fX=class extends Bs{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);let r=t.type===Ur.BINARY_EVENT;r||t.type===Ur.BINARY_ACK?(t.type=r?Ur.EVENT:Ur.ACK,this.reconstructor=new Lme(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(AB(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0,r={type:Number(e.charAt(0))};if(Ur[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===Ur.BINARY_EVENT||r.type===Ur.BINARY_ACK){let l=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);let c=e.substring(l,t);if(c!=Number(c)||e.charAt(t)!=="-")throw new Error("Illegal attachments");r.attachments=Number(c)}if(e.charAt(t+1)==="/"){let l=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););r.nsp=e.substring(l,t)}else r.nsp="/";let n=e.charAt(t+1);if(n!==""&&Number(n)==n){let l=t+1;for(;++t;){let c=e.charAt(t);if(c==null||Number(c)!=c){--t;break}if(t===e.length)break}r.id=Number(e.substring(l,t+1))}if(e.charAt(++t)){let l=this.tryParse(e.substr(t));if(fX.isPayloadValid(r.type,l))r.data=l;else throw new Error("invalid payload")}return r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case Ur.CONNECT:return nV(t);case Ur.DISCONNECT:return t===void 0;case Ur.CONNECT_ERROR:return typeof t=="string"||nV(t);case Ur.EVENT:case Ur.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&Pme.indexOf(t[0])===-1);case Ur.ACK:case Ur.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}},Lme=class{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){let t=Cme(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}};ri();function Dd(i,e,t){return i.on(e,t),function(){i.off(e,t)}}var Ome=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),pX=class extends Bs{constructor(e,t,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let e=this.io;this.subs=[Dd(e,"open",this.onopen.bind(this)),Dd(e,"packet",this.onpacket.bind(this)),Dd(e,"error",this.onerror.bind(this)),Dd(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(Ome.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;let r={type:Ur.EVENT,data:t};if(r.options={},r.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){let l=this.ids++,c=t.pop();this._registerAckCallback(l,c),r.id=l}let n=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!n||!this.connected)||(this.connected?(this.notifyOutgoingListeners(r),this.packet(r)):this.sendBuffer.push(r)),this.flags={},this}_registerAckCallback(e,t){var r;let n=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(n===void 0){this.acks[e]=t;return}let l=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let h=0;h<this.sendBuffer.length;h++)this.sendBuffer[h].id===e&&this.sendBuffer.splice(h,1);t.call(this,new Error("operation has timed out"))},n),c=(...h)=>{this.io.clearTimeoutFn(l),t.apply(this,h)};c.withError=!0,this.acks[e]=c}emitWithAck(e,...t){return new Promise((r,n)=>{let l=(c,h)=>c?n(c):r(h);l.withError=!0,t.push(l),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());let r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((n,...l)=>r!==this._queue[0]?void 0:(n!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(n)):(this._queue.shift(),t&&t(null,...l)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;let t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:Ur.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(t=>String(t.id)===e)){let t=this.acks[e];delete this.acks[e],t.withError&&t.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Ur.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Ur.EVENT:case Ur.BINARY_EVENT:this.onevent(e);break;case Ur.ACK:case Ur.BINARY_ACK:this.onack(e);break;case Ur.DISCONNECT:this.ondisconnect();break;case Ur.CONNECT_ERROR:this.destroy();let t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t);break}}onevent(e){let t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){let t=this._anyListeners.slice();for(let r of t)r.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){let t=this,r=!1;return function(...n){r||(r=!0,t.packet({type:Ur.ACK,id:e,data:n}))}}onack(e){let t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Ur.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){let t=this._anyListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){let t=this._anyOutgoingListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){let t=this._anyOutgoingListeners.slice();for(let r of t)r.apply(this,e.data)}}};ri();function bE(i){i=i||{},this.ms=i.min||100,this.max=i.max||1e4,this.factor=i.factor||2,this.jitter=i.jitter>0&&i.jitter<=1?i.jitter:0,this.attempts=0}bE.prototype.duration=function(){var i=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*i);i=Math.floor(e*10)&1?i+t:i-t}return Math.min(i,this.max)|0};bE.prototype.reset=function(){this.attempts=0};bE.prototype.setMin=function(i){this.ms=i};bE.prototype.setMax=function(i){this.max=i};bE.prototype.setJitter=function(i){this.jitter=i};var VR=class extends Bs{constructor(e,t){var r;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,uL(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((r=t.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new bE({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;let n=t.parser||hX;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new A1(this.uri,this.opts);let t=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;let n=Dd(t,"open",function(){r.onopen(),e&&e()}),l=h=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",h),e?e(h):this.maybeReconnectOnOpen()},c=Dd(t,"error",l);if(this._timeout!==!1){let h=this._timeout,d=this.setTimeoutFn(()=>{n(),l(new Error("timeout")),t.close()},h);this.opts.autoUnref&&d.unref(),this.subs.push(()=>{this.clearTimeoutFn(d)})}return this.subs.push(n),this.subs.push(c),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");let e=this.engine;this.subs.push(Dd(e,"ping",this.onping.bind(this)),Dd(e,"data",this.ondata.bind(this)),Dd(e,"error",this.onerror.bind(this)),Dd(e,"close",this.onclose.bind(this)),Dd(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){TB(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let r=this.nsps[e];return r?this._autoConnect&&!r.active&&r.connect():(r=new pX(this,e,t),this.nsps[e]=r),r}_destroy(e){let t=Object.keys(this.nsps);for(let r of t)if(this.nsps[r].active)return;this._close()}_packet(e){let t=this.encoder.encode(e);for(let r=0;r<t.length;r++)this.engine.write(t[r],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let t=this.backoff.duration();this._reconnecting=!0;let r=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(n=>{n?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",n)):e.onreconnect()}))},t);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){let e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}},iT={};function AN(i,e){typeof i=="object"&&(e=i,i=void 0),e=e||{};let t=wme(i,e.path||"/socket.io"),r=t.source,n=t.id,l=t.path,c=iT[n]&&l in iT[n].nsps,h=e.forceNew||e["force new connection"]||e.multiplex===!1||c,d;return h?d=new VR(r,e):(iT[n]||(iT[n]=new VR(r,e)),d=iT[n]),t.query&&!e.query&&(e.query=t.queryKey),d.socket(t.path,e)}Object.assign(AN,{Manager:VR,Socket:pX,io:AN,connect:AN});ri();ri();var en;(function(i){i.assertEqual=n=>n;function e(n){}i.assertIs=e;function t(n){throw new Error}i.assertNever=t,i.arrayToEnum=n=>{let l={};for(let c of n)l[c]=c;return l},i.getValidEnumValues=n=>{let l=i.objectKeys(n).filter(h=>typeof n[n[h]]!="number"),c={};for(let h of l)c[h]=n[h];return i.objectValues(c)},i.objectValues=n=>i.objectKeys(n).map(function(l){return n[l]}),i.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{let l=[];for(let c in n)Object.prototype.hasOwnProperty.call(n,c)&&l.push(c);return l},i.find=(n,l)=>{for(let c of n)if(l(c))return c},i.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&isFinite(n)&&Math.floor(n)===n;function r(n,l=" | "){return n.map(c=>typeof c=="string"?`'${c}'`:c).join(l)}i.joinValues=r,i.jsonStringifyReplacer=(n,l)=>typeof l=="bigint"?l.toString():l})(en||(en={}));var BF;(function(i){i.mergeShapes=(e,t)=>ht(ht({},e),t)})(BF||(BF={}));var Qt=en.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Tm=i=>{switch(typeof i){case"undefined":return Qt.undefined;case"string":return Qt.string;case"number":return isNaN(i)?Qt.nan:Qt.number;case"boolean":return Qt.boolean;case"function":return Qt.function;case"bigint":return Qt.bigint;case"symbol":return Qt.symbol;case"object":return Array.isArray(i)?Qt.array:i===null?Qt.null:i.then&&typeof i.then=="function"&&i.catch&&typeof i.catch=="function"?Qt.promise:typeof Map<"u"&&i instanceof Map?Qt.map:typeof Set<"u"&&i instanceof Set?Qt.set:typeof Date<"u"&&i instanceof Date?Qt.date:Qt.object;default:return Qt.unknown}},Nt=en.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Nme=i=>JSON.stringify(i,null,2).replace(/"([^"]+)":/g,"$1:"),jd=class extends Error{constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){let t=e||function(l){return l.message},r={_errors:[]},n=l=>{for(let c of l.issues)if(c.code==="invalid_union")c.unionErrors.map(n);else if(c.code==="invalid_return_type")n(c.returnTypeError);else if(c.code==="invalid_arguments")n(c.argumentsError);else if(c.path.length===0)r._errors.push(t(c));else{let h=r,d=0;for(;d<c.path.length;){let f=c.path[d];d===c.path.length-1?(h[f]=h[f]||{_errors:[]},h[f]._errors.push(t(c))):h[f]=h[f]||{_errors:[]},h=h[f],d++}}};return n(this),r}toString(){return this.message}get message(){return JSON.stringify(this.issues,en.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){let t={},r=[];for(let n of this.issues)n.path.length>0?(t[n.path[0]]=t[n.path[0]]||[],t[n.path[0]].push(e(n))):r.push(e(n));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}};jd.create=i=>new jd(i);var HA=(i,e)=>{let t;switch(i.code){case Nt.invalid_type:i.received===Qt.undefined?t="Required":t=`Expected ${i.expected}, received ${i.received}`;break;case Nt.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(i.expected,en.jsonStringifyReplacer)}`;break;case Nt.unrecognized_keys:t=`Unrecognized key(s) in object: ${en.joinValues(i.keys,", ")}`;break;case Nt.invalid_union:t="Invalid input";break;case Nt.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${en.joinValues(i.options)}`;break;case Nt.invalid_enum_value:t=`Invalid enum value. Expected ${en.joinValues(i.options)}, received '${i.received}'`;break;case Nt.invalid_arguments:t="Invalid function arguments";break;case Nt.invalid_return_type:t="Invalid function return type";break;case Nt.invalid_date:t="Invalid date";break;case Nt.invalid_string:typeof i.validation=="object"?"includes"in i.validation?(t=`Invalid input: must include "${i.validation.includes}"`,typeof i.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${i.validation.position}`)):"startsWith"in i.validation?t=`Invalid input: must start with "${i.validation.startsWith}"`:"endsWith"in i.validation?t=`Invalid input: must end with "${i.validation.endsWith}"`:en.assertNever(i.validation):i.validation!=="regex"?t=`Invalid ${i.validation}`:t="Invalid";break;case Nt.too_small:i.type==="array"?t=`Array must contain ${i.exact?"exactly":i.inclusive?"at least":"more than"} ${i.minimum} element(s)`:i.type==="string"?t=`String must contain ${i.exact?"exactly":i.inclusive?"at least":"over"} ${i.minimum} character(s)`:i.type==="number"?t=`Number must be ${i.exact?"exactly equal to ":i.inclusive?"greater than or equal to ":"greater than "}${i.minimum}`:i.type==="date"?t=`Date must be ${i.exact?"exactly equal to ":i.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(i.minimum))}`:t="Invalid input";break;case Nt.too_big:i.type==="array"?t=`Array must contain ${i.exact?"exactly":i.inclusive?"at most":"less than"} ${i.maximum} element(s)`:i.type==="string"?t=`String must contain ${i.exact?"exactly":i.inclusive?"at most":"under"} ${i.maximum} character(s)`:i.type==="number"?t=`Number must be ${i.exact?"exactly":i.inclusive?"less than or equal to":"less than"} ${i.maximum}`:i.type==="bigint"?t=`BigInt must be ${i.exact?"exactly":i.inclusive?"less than or equal to":"less than"} ${i.maximum}`:i.type==="date"?t=`Date must be ${i.exact?"exactly":i.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(i.maximum))}`:t="Invalid input";break;case Nt.custom:t="Invalid input";break;case Nt.invalid_intersection_types:t="Intersection results could not be merged";break;case Nt.not_multiple_of:t=`Number must be a multiple of ${i.multipleOf}`;break;case Nt.not_finite:t="Number must be finite";break;default:t=e.defaultError,en.assertNever(i)}return{message:t}},mX=HA;function Dme(i){mX=i}function WR(){return mX}var jR=i=>{let{data:e,path:t,errorMaps:r,issueData:n}=i,l=[...t,...n.path||[]],c=Gi(ht({},n),{path:l}),h="",d=r.filter(f=>!!f).slice().reverse();for(let f of d)h=f(c,{data:e,defaultError:h}).message;return Gi(ht({},n),{path:l,message:n.message||h})},kme=[];function ii(i,e){let t=jR({issueData:e,data:i.data,path:i.path,errorMaps:[i.common.contextualErrorMap,i.schemaErrorMap,WR(),HA].filter(r=>!!r)});i.common.issues.push(t)}var Jl=class{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){let r=[];for(let n of t){if(n.status==="aborted")return rr;n.status==="dirty"&&e.dirty(),r.push(n.value)}return{status:e.value,value:r}}static mergeObjectAsync(e,t){return Km(this,null,function*(){let r=[];for(let n of t)r.push({key:yield n.key,value:yield n.value});return Jl.mergeObjectSync(e,r)})}static mergeObjectSync(e,t){let r={};for(let n of t){let{key:l,value:c}=n;if(l.status==="aborted"||c.status==="aborted")return rr;l.status==="dirty"&&e.dirty(),c.status==="dirty"&&e.dirty(),l.value!=="__proto__"&&(typeof c.value<"u"||n.alwaysSet)&&(r[l.value]=c.value)}return{status:e.value,value:r}}},rr=Object.freeze({status:"aborted"}),gX=i=>({status:"dirty",value:i}),Yl=i=>({status:"valid",value:i}),UF=i=>i.status==="aborted",HF=i=>i.status==="dirty",$A=i=>i.status==="valid",GR=i=>typeof Promise<"u"&&i instanceof Promise,Ti;(function(i){i.errToObj=e=>typeof e=="string"?{message:e}:e||{},i.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(Ti||(Ti={}));var Ef=class{constructor(e,t,r,n){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},sV=(i,e)=>{if($A(e))return{success:!0,data:e.value};if(!i.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new jd(i.common.issues);return this._error=t,this._error}}};function sr(i){if(!i)return{};let{errorMap:e,invalid_type_error:t,required_error:r,description:n}=i;if(e&&(t||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:(l,c)=>l.code!=="invalid_type"?{message:c.defaultError}:typeof c.data>"u"?{message:r??c.defaultError}:{message:t??c.defaultError},description:n}}var lr=class{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return Tm(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Tm(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Jl,ctx:{common:e.parent.common,data:e.data,parsedType:Tm(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(GR(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){let t=this._parse(e);return Promise.resolve(t)}parse(e,t){let r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){var r;let n={common:{issues:[],async:(r=t==null?void 0:t.async)!==null&&r!==void 0?r:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Tm(e)},l=this._parseSync({data:e,path:n.path,parent:n});return sV(n,l)}parseAsync(e,t){return Km(this,null,function*(){let r=yield this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error})}safeParseAsync(e,t){return Km(this,null,function*(){let r={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Tm(e)},n=this._parse({data:e,path:r.path,parent:r}),l=yield GR(n)?n:Promise.resolve(n);return sV(r,l)})}refine(e,t){let r=n=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(n):t;return this._refinement((n,l)=>{let c=e(n),h=()=>l.addIssue(ht({code:Nt.custom},r(n)));return typeof Promise<"u"&&c instanceof Promise?c.then(d=>d?!0:(h(),!1)):c?!0:(h(),!1)})}refinement(e,t){return this._refinement((r,n)=>e(r)?!0:(n.addIssue(typeof t=="function"?t(r,n):t),!1))}_refinement(e){return new Jd({schema:this,typeName:zi.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return xp.create(this,this._def)}nullable(){return uw.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return bf.create(this,this._def)}promise(){return XM.create(this,this._def)}or(e){return GA.create([this,e],this._def)}and(e){return qA.create(this,e,this._def)}transform(e){return new Jd(Gi(ht({},sr(this._def)),{schema:this,typeName:zi.ZodEffects,effect:{type:"transform",transform:e}}))}default(e){let t=typeof e=="function"?e:()=>e;return new YA(Gi(ht({},sr(this._def)),{innerType:this,defaultValue:t,typeName:zi.ZodDefault}))}brand(){return new yX(ht({typeName:zi.ZodBranded,type:this},sr(this._def)))}catch(e){let t=typeof e=="function"?e:()=>e;return new YR(Gi(ht({},sr(this._def)),{innerType:this,catchValue:t,typeName:zi.ZodCatch}))}describe(e){let t=this.constructor;return new t(Gi(ht({},this._def),{description:e}))}pipe(e){return cL.create(this,e)}readonly(){return QR.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},Fme=/^c[^\s-]{8,}$/i,zme=/^[a-z][a-z0-9]*$/,Bme=/^[0-9A-HJKMNP-TV-Z]{26}$/,Ume=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Hme=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,$me="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",CN,Vme=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,Wme=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,jme=i=>i.precision?i.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${i.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${i.precision}}Z$`):i.precision===0?i.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):i.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function Gme(i,e){return!!((e==="v4"||!e)&&Vme.test(i)||(e==="v6"||!e)&&Wme.test(i))}var gf=class extends lr{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==Qt.string){let n=this._getOrReturnCtx(e);return ii(n,{code:Nt.invalid_type,expected:Qt.string,received:n.parsedType}),rr}let t=new Jl,r;for(let n of this._def.checks)if(n.kind==="min")e.data.length<n.value&&(r=this._getOrReturnCtx(e,r),ii(r,{code:Nt.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),t.dirty());else if(n.kind==="max")e.data.length>n.value&&(r=this._getOrReturnCtx(e,r),ii(r,{code:Nt.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),t.dirty());else if(n.kind==="length"){let l=e.data.length>n.value,c=e.data.length<n.value;(l||c)&&(r=this._getOrReturnCtx(e,r),l?ii(r,{code:Nt.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):c&&ii(r,{code:Nt.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),t.dirty())}else if(n.kind==="email")Hme.test(e.data)||(r=this._getOrReturnCtx(e,r),ii(r,{validation:"email",code:Nt.invalid_string,message:n.message}),t.dirty());else if(n.kind==="emoji")CN||(CN=new RegExp($me,"u")),CN.test(e.data)||(r=this._getOrReturnCtx(e,r),ii(r,{validation:"emoji",code:Nt.invalid_string,message:n.message}),t.dirty());else if(n.kind==="uuid")Ume.test(e.data)||(r=this._getOrReturnCtx(e,r),ii(r,{validation:"uuid",code:Nt.invalid_string,message:n.message}),t.dirty());else if(n.kind==="cuid")Fme.test(e.data)||(r=this._getOrReturnCtx(e,r),ii(r,{validation:"cuid",code:Nt.invalid_string,message:n.message}),t.dirty());else if(n.kind==="cuid2")zme.test(e.data)||(r=this._getOrReturnCtx(e,r),ii(r,{validation:"cuid2",code:Nt.invalid_string,message:n.message}),t.dirty());else if(n.kind==="ulid")Bme.test(e.data)||(r=this._getOrReturnCtx(e,r),ii(r,{validation:"ulid",code:Nt.invalid_string,message:n.message}),t.dirty());else if(n.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),ii(r,{validation:"url",code:Nt.invalid_string,message:n.message}),t.dirty()}else n.kind==="regex"?(n.regex.lastIndex=0,n.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),ii(r,{validation:"regex",code:Nt.invalid_string,message:n.message}),t.dirty())):n.kind==="trim"?e.data=e.data.trim():n.kind==="includes"?e.data.includes(n.value,n.position)||(r=this._getOrReturnCtx(e,r),ii(r,{code:Nt.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),t.dirty()):n.kind==="toLowerCase"?e.data=e.data.toLowerCase():n.kind==="toUpperCase"?e.data=e.data.toUpperCase():n.kind==="startsWith"?e.data.startsWith(n.value)||(r=this._getOrReturnCtx(e,r),ii(r,{code:Nt.invalid_string,validation:{startsWith:n.value},message:n.message}),t.dirty()):n.kind==="endsWith"?e.data.endsWith(n.value)||(r=this._getOrReturnCtx(e,r),ii(r,{code:Nt.invalid_string,validation:{endsWith:n.value},message:n.message}),t.dirty()):n.kind==="datetime"?jme(n).test(e.data)||(r=this._getOrReturnCtx(e,r),ii(r,{code:Nt.invalid_string,validation:"datetime",message:n.message}),t.dirty()):n.kind==="ip"?Gme(e.data,n.version)||(r=this._getOrReturnCtx(e,r),ii(r,{validation:"ip",code:Nt.invalid_string,message:n.message}),t.dirty()):en.assertNever(n);return{status:t.value,value:e.data}}_regex(e,t,r){return this.refinement(n=>e.test(n),ht({validation:t,code:Nt.invalid_string},Ti.errToObj(r)))}_addCheck(e){return new gf(Gi(ht({},this._def),{checks:[...this._def.checks,e]}))}email(e){return this._addCheck(ht({kind:"email"},Ti.errToObj(e)))}url(e){return this._addCheck(ht({kind:"url"},Ti.errToObj(e)))}emoji(e){return this._addCheck(ht({kind:"emoji"},Ti.errToObj(e)))}uuid(e){return this._addCheck(ht({kind:"uuid"},Ti.errToObj(e)))}cuid(e){return this._addCheck(ht({kind:"cuid"},Ti.errToObj(e)))}cuid2(e){return this._addCheck(ht({kind:"cuid2"},Ti.errToObj(e)))}ulid(e){return this._addCheck(ht({kind:"ulid"},Ti.errToObj(e)))}ip(e){return this._addCheck(ht({kind:"ip"},Ti.errToObj(e)))}datetime(e){var t;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck(ht({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(t=e==null?void 0:e.offset)!==null&&t!==void 0?t:!1},Ti.errToObj(e==null?void 0:e.message)))}regex(e,t){return this._addCheck(ht({kind:"regex",regex:e},Ti.errToObj(t)))}includes(e,t){return this._addCheck(ht({kind:"includes",value:e,position:t==null?void 0:t.position},Ti.errToObj(t==null?void 0:t.message)))}startsWith(e,t){return this._addCheck(ht({kind:"startsWith",value:e},Ti.errToObj(t)))}endsWith(e,t){return this._addCheck(ht({kind:"endsWith",value:e},Ti.errToObj(t)))}min(e,t){return this._addCheck(ht({kind:"min",value:e},Ti.errToObj(t)))}max(e,t){return this._addCheck(ht({kind:"max",value:e},Ti.errToObj(t)))}length(e,t){return this._addCheck(ht({kind:"length",value:e},Ti.errToObj(t)))}nonempty(e){return this.min(1,Ti.errToObj(e))}trim(){return new gf(Gi(ht({},this._def),{checks:[...this._def.checks,{kind:"trim"}]}))}toLowerCase(){return new gf(Gi(ht({},this._def),{checks:[...this._def.checks,{kind:"toLowerCase"}]}))}toUpperCase(){return new gf(Gi(ht({},this._def),{checks:[...this._def.checks,{kind:"toUpperCase"}]}))}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get minLength(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};gf.create=i=>{var e;return new gf(ht({checks:[],typeName:zi.ZodString,coerce:(e=i==null?void 0:i.coerce)!==null&&e!==void 0?e:!1},sr(i)))};function qme(i,e){let t=(i.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,n=t>r?t:r,l=parseInt(i.toFixed(n).replace(".","")),c=parseInt(e.toFixed(n).replace(".",""));return l%c/Math.pow(10,n)}var aw=class extends lr{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==Qt.number){let n=this._getOrReturnCtx(e);return ii(n,{code:Nt.invalid_type,expected:Qt.number,received:n.parsedType}),rr}let t,r=new Jl;for(let n of this._def.checks)n.kind==="int"?en.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),ii(t,{code:Nt.invalid_type,expected:"integer",received:"float",message:n.message}),r.dirty()):n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(t=this._getOrReturnCtx(e,t),ii(t,{code:Nt.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(t=this._getOrReturnCtx(e,t),ii(t,{code:Nt.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):n.kind==="multipleOf"?qme(e.data,n.value)!==0&&(t=this._getOrReturnCtx(e,t),ii(t,{code:Nt.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):n.kind==="finite"?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),ii(t,{code:Nt.not_finite,message:n.message}),r.dirty()):en.assertNever(n);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,Ti.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Ti.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Ti.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Ti.toString(t))}setLimit(e,t,r,n){return new aw(Gi(ht({},this._def),{checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:Ti.toString(n)}]}))}_addCheck(e){return new aw(Gi(ht({},this._def),{checks:[...this._def.checks,e]}))}int(e){return this._addCheck({kind:"int",message:Ti.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Ti.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Ti.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Ti.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Ti.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Ti.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:Ti.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Ti.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Ti.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&en.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(t===null||r.value>t)&&(t=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}};aw.create=i=>new aw(ht({checks:[],typeName:zi.ZodNumber,coerce:(i==null?void 0:i.coerce)||!1},sr(i)));var ow=class extends lr{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==Qt.bigint){let n=this._getOrReturnCtx(e);return ii(n,{code:Nt.invalid_type,expected:Qt.bigint,received:n.parsedType}),rr}let t,r=new Jl;for(let n of this._def.checks)n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(t=this._getOrReturnCtx(e,t),ii(t,{code:Nt.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(t=this._getOrReturnCtx(e,t),ii(t,{code:Nt.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):n.kind==="multipleOf"?e.data%n.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),ii(t,{code:Nt.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):en.assertNever(n);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,Ti.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Ti.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Ti.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Ti.toString(t))}setLimit(e,t,r,n){return new ow(Gi(ht({},this._def),{checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:Ti.toString(n)}]}))}_addCheck(e){return new ow(Gi(ht({},this._def),{checks:[...this._def.checks,e]}))}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Ti.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Ti.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Ti.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Ti.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Ti.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};ow.create=i=>{var e;return new ow(ht({checks:[],typeName:zi.ZodBigInt,coerce:(e=i==null?void 0:i.coerce)!==null&&e!==void 0?e:!1},sr(i)))};var VA=class extends lr{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==Qt.boolean){let t=this._getOrReturnCtx(e);return ii(t,{code:Nt.invalid_type,expected:Qt.boolean,received:t.parsedType}),rr}return Yl(e.data)}};VA.create=i=>new VA(ht({typeName:zi.ZodBoolean,coerce:(i==null?void 0:i.coerce)||!1},sr(i)));var jM=class extends lr{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==Qt.date){let n=this._getOrReturnCtx(e);return ii(n,{code:Nt.invalid_type,expected:Qt.date,received:n.parsedType}),rr}if(isNaN(e.data.getTime())){let n=this._getOrReturnCtx(e);return ii(n,{code:Nt.invalid_date}),rr}let t=new Jl,r;for(let n of this._def.checks)n.kind==="min"?e.data.getTime()<n.value&&(r=this._getOrReturnCtx(e,r),ii(r,{code:Nt.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),t.dirty()):n.kind==="max"?e.data.getTime()>n.value&&(r=this._getOrReturnCtx(e,r),ii(r,{code:Nt.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),t.dirty()):en.assertNever(n);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new jM(Gi(ht({},this._def),{checks:[...this._def.checks,e]}))}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:Ti.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:Ti.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}};jM.create=i=>new jM(ht({checks:[],coerce:(i==null?void 0:i.coerce)||!1,typeName:zi.ZodDate},sr(i)));var qR=class extends lr{_parse(e){if(this._getType(e)!==Qt.symbol){let t=this._getOrReturnCtx(e);return ii(t,{code:Nt.invalid_type,expected:Qt.symbol,received:t.parsedType}),rr}return Yl(e.data)}};qR.create=i=>new qR(ht({typeName:zi.ZodSymbol},sr(i)));var WA=class extends lr{_parse(e){if(this._getType(e)!==Qt.undefined){let t=this._getOrReturnCtx(e);return ii(t,{code:Nt.invalid_type,expected:Qt.undefined,received:t.parsedType}),rr}return Yl(e.data)}};WA.create=i=>new WA(ht({typeName:zi.ZodUndefined},sr(i)));var jA=class extends lr{_parse(e){if(this._getType(e)!==Qt.null){let t=this._getOrReturnCtx(e);return ii(t,{code:Nt.invalid_type,expected:Qt.null,received:t.parsedType}),rr}return Yl(e.data)}};jA.create=i=>new jA(ht({typeName:zi.ZodNull},sr(i)));var GM=class extends lr{constructor(){super(...arguments),this._any=!0}_parse(e){return Yl(e.data)}};GM.create=i=>new GM(ht({typeName:zi.ZodAny},sr(i)));var X1=class extends lr{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Yl(e.data)}};X1.create=i=>new X1(ht({typeName:zi.ZodUnknown},sr(i)));var Rp=class extends lr{_parse(e){let t=this._getOrReturnCtx(e);return ii(t,{code:Nt.invalid_type,expected:Qt.never,received:t.parsedType}),rr}};Rp.create=i=>new Rp(ht({typeName:zi.ZodNever},sr(i)));var XR=class extends lr{_parse(e){if(this._getType(e)!==Qt.undefined){let t=this._getOrReturnCtx(e);return ii(t,{code:Nt.invalid_type,expected:Qt.void,received:t.parsedType}),rr}return Yl(e.data)}};XR.create=i=>new XR(ht({typeName:zi.ZodVoid},sr(i)));var bf=class extends lr{_parse(e){let{ctx:t,status:r}=this._processInputParams(e),n=this._def;if(t.parsedType!==Qt.array)return ii(t,{code:Nt.invalid_type,expected:Qt.array,received:t.parsedType}),rr;if(n.exactLength!==null){let c=t.data.length>n.exactLength.value,h=t.data.length<n.exactLength.value;(c||h)&&(ii(t,{code:c?Nt.too_big:Nt.too_small,minimum:h?n.exactLength.value:void 0,maximum:c?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),r.dirty())}if(n.minLength!==null&&t.data.length<n.minLength.value&&(ii(t,{code:Nt.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),r.dirty()),n.maxLength!==null&&t.data.length>n.maxLength.value&&(ii(t,{code:Nt.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((c,h)=>n.type._parseAsync(new Ef(t,c,t.path,h)))).then(c=>Jl.mergeArray(r,c));let l=[...t.data].map((c,h)=>n.type._parseSync(new Ef(t,c,t.path,h)));return Jl.mergeArray(r,l)}get element(){return this._def.type}min(e,t){return new bf(Gi(ht({},this._def),{minLength:{value:e,message:Ti.toString(t)}}))}max(e,t){return new bf(Gi(ht({},this._def),{maxLength:{value:e,message:Ti.toString(t)}}))}length(e,t){return new bf(Gi(ht({},this._def),{exactLength:{value:e,message:Ti.toString(t)}}))}nonempty(e){return this.min(1,e)}};bf.create=(i,e)=>new bf(ht({type:i,minLength:null,maxLength:null,exactLength:null,typeName:zi.ZodArray},sr(e)));function DS(i){if(i instanceof _s){let e={};for(let t in i.shape){let r=i.shape[t];e[t]=xp.create(DS(r))}return new _s(Gi(ht({},i._def),{shape:()=>e}))}else return i instanceof bf?new bf(Gi(ht({},i._def),{type:DS(i.element)})):i instanceof xp?xp.create(DS(i.unwrap())):i instanceof uw?uw.create(DS(i.unwrap())):i instanceof Ip?Ip.create(i.items.map(e=>DS(e))):i}var _s=class extends lr{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),t=en.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==Qt.object){let d=this._getOrReturnCtx(e);return ii(d,{code:Nt.invalid_type,expected:Qt.object,received:d.parsedType}),rr}let{status:t,ctx:r}=this._processInputParams(e),{shape:n,keys:l}=this._getCached(),c=[];if(!(this._def.catchall instanceof Rp&&this._def.unknownKeys==="strip"))for(let d in r.data)l.includes(d)||c.push(d);let h=[];for(let d of l){let f=n[d],m=r.data[d];h.push({key:{status:"valid",value:d},value:f._parse(new Ef(r,m,r.path,d)),alwaysSet:d in r.data})}if(this._def.catchall instanceof Rp){let d=this._def.unknownKeys;if(d==="passthrough")for(let f of c)h.push({key:{status:"valid",value:f},value:{status:"valid",value:r.data[f]}});else if(d==="strict")c.length>0&&(ii(r,{code:Nt.unrecognized_keys,keys:c}),t.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let d=this._def.catchall;for(let f of c){let m=r.data[f];h.push({key:{status:"valid",value:f},value:d._parse(new Ef(r,m,r.path,f)),alwaysSet:f in r.data})}}return r.common.async?Promise.resolve().then(()=>Km(this,null,function*(){let d=[];for(let f of h){let m=yield f.key;d.push({key:m,value:yield f.value,alwaysSet:f.alwaysSet})}return d})).then(d=>Jl.mergeObjectSync(t,d)):Jl.mergeObjectSync(t,h)}get shape(){return this._def.shape()}strict(e){return Ti.errToObj,new _s(ht(Gi(ht({},this._def),{unknownKeys:"strict"}),e!==void 0?{errorMap:(t,r)=>{var n,l,c,h;let d=(c=(l=(n=this._def).errorMap)===null||l===void 0?void 0:l.call(n,t,r).message)!==null&&c!==void 0?c:r.defaultError;return t.code==="unrecognized_keys"?{message:(h=Ti.errToObj(e).message)!==null&&h!==void 0?h:d}:{message:d}}}:{}))}strip(){return new _s(Gi(ht({},this._def),{unknownKeys:"strip"}))}passthrough(){return new _s(Gi(ht({},this._def),{unknownKeys:"passthrough"}))}extend(e){return new _s(Gi(ht({},this._def),{shape:()=>ht(ht({},this._def.shape()),e)}))}merge(e){return new _s({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>ht(ht({},this._def.shape()),e._def.shape()),typeName:zi.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new _s(Gi(ht({},this._def),{catchall:e}))}pick(e){let t={};return en.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(t[r]=this.shape[r])}),new _s(Gi(ht({},this._def),{shape:()=>t}))}omit(e){let t={};return en.objectKeys(this.shape).forEach(r=>{e[r]||(t[r]=this.shape[r])}),new _s(Gi(ht({},this._def),{shape:()=>t}))}deepPartial(){return DS(this)}partial(e){let t={};return en.objectKeys(this.shape).forEach(r=>{let n=this.shape[r];e&&!e[r]?t[r]=n:t[r]=n.optional()}),new _s(Gi(ht({},this._def),{shape:()=>t}))}required(e){let t={};return en.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])t[r]=this.shape[r];else{let n=this.shape[r];for(;n instanceof xp;)n=n._def.innerType;t[r]=n}}),new _s(Gi(ht({},this._def),{shape:()=>t}))}keyof(){return vX(en.objectKeys(this.shape))}};_s.create=(i,e)=>new _s(ht({shape:()=>i,unknownKeys:"strip",catchall:Rp.create(),typeName:zi.ZodObject},sr(e)));_s.strictCreate=(i,e)=>new _s(ht({shape:()=>i,unknownKeys:"strict",catchall:Rp.create(),typeName:zi.ZodObject},sr(e)));_s.lazycreate=(i,e)=>new _s(ht({shape:i,unknownKeys:"strip",catchall:Rp.create(),typeName:zi.ZodObject},sr(e)));var GA=class extends lr{_parse(e){let{ctx:t}=this._processInputParams(e),r=this._def.options;function n(l){for(let h of l)if(h.result.status==="valid")return h.result;for(let h of l)if(h.result.status==="dirty")return t.common.issues.push(...h.ctx.common.issues),h.result;let c=l.map(h=>new jd(h.ctx.common.issues));return ii(t,{code:Nt.invalid_union,unionErrors:c}),rr}if(t.common.async)return Promise.all(r.map(l=>Km(this,null,function*(){let c=Gi(ht({},t),{common:Gi(ht({},t.common),{issues:[]}),parent:null});return{result:yield l._parseAsync({data:t.data,path:t.path,parent:c}),ctx:c}}))).then(n);{let l,c=[];for(let d of r){let f=Gi(ht({},t),{common:Gi(ht({},t.common),{issues:[]}),parent:null}),m=d._parseSync({data:t.data,path:t.path,parent:f});if(m.status==="valid")return m;m.status==="dirty"&&!l&&(l={result:m,ctx:f}),f.common.issues.length&&c.push(f.common.issues)}if(l)return t.common.issues.push(...l.ctx.common.issues),l.result;let h=c.map(d=>new jd(d));return ii(t,{code:Nt.invalid_union,unionErrors:h}),rr}}get options(){return this._def.options}};GA.create=(i,e)=>new GA(ht({options:i,typeName:zi.ZodUnion},sr(e)));var YP=i=>i instanceof XA?YP(i.schema):i instanceof Jd?YP(i.innerType()):i instanceof ZA?[i.value]:i instanceof lw?i.options:i instanceof JA?Object.keys(i.enum):i instanceof YA?YP(i._def.innerType):i instanceof WA?[void 0]:i instanceof jA?[null]:null,CB=class extends lr{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==Qt.object)return ii(t,{code:Nt.invalid_type,expected:Qt.object,received:t.parsedType}),rr;let r=this.discriminator,n=t.data[r],l=this.optionsMap.get(n);return l?t.common.async?l._parseAsync({data:t.data,path:t.path,parent:t}):l._parseSync({data:t.data,path:t.path,parent:t}):(ii(t,{code:Nt.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),rr)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){let n=new Map;for(let l of t){let c=YP(l.shape[e]);if(!c)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let h of c){if(n.has(h))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(h)}`);n.set(h,l)}}return new CB(ht({typeName:zi.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:n},sr(r)))}};function $F(i,e){let t=Tm(i),r=Tm(e);if(i===e)return{valid:!0,data:i};if(t===Qt.object&&r===Qt.object){let n=en.objectKeys(e),l=en.objectKeys(i).filter(h=>n.indexOf(h)!==-1),c=ht(ht({},i),e);for(let h of l){let d=$F(i[h],e[h]);if(!d.valid)return{valid:!1};c[h]=d.data}return{valid:!0,data:c}}else if(t===Qt.array&&r===Qt.array){if(i.length!==e.length)return{valid:!1};let n=[];for(let l=0;l<i.length;l++){let c=i[l],h=e[l],d=$F(c,h);if(!d.valid)return{valid:!1};n.push(d.data)}return{valid:!0,data:n}}else return t===Qt.date&&r===Qt.date&&+i==+e?{valid:!0,data:i}:{valid:!1}}var qA=class extends lr{_parse(e){let{status:t,ctx:r}=this._processInputParams(e),n=(l,c)=>{if(UF(l)||UF(c))return rr;let h=$F(l.value,c.value);return h.valid?((HF(l)||HF(c))&&t.dirty(),{status:t.value,value:h.data}):(ii(r,{code:Nt.invalid_intersection_types}),rr)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([l,c])=>n(l,c)):n(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}};qA.create=(i,e,t)=>new qA(ht({left:i,right:e,typeName:zi.ZodIntersection},sr(t)));var Ip=class extends lr{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==Qt.array)return ii(r,{code:Nt.invalid_type,expected:Qt.array,received:r.parsedType}),rr;if(r.data.length<this._def.items.length)return ii(r,{code:Nt.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),rr;!this._def.rest&&r.data.length>this._def.items.length&&(ii(r,{code:Nt.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let n=[...r.data].map((l,c)=>{let h=this._def.items[c]||this._def.rest;return h?h._parse(new Ef(r,l,r.path,c)):null}).filter(l=>!!l);return r.common.async?Promise.all(n).then(l=>Jl.mergeArray(t,l)):Jl.mergeArray(t,n)}get items(){return this._def.items}rest(e){return new Ip(Gi(ht({},this._def),{rest:e}))}};Ip.create=(i,e)=>{if(!Array.isArray(i))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ip(ht({items:i,typeName:zi.ZodTuple,rest:null},sr(e)))};var ZR=class extends lr{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==Qt.object)return ii(r,{code:Nt.invalid_type,expected:Qt.object,received:r.parsedType}),rr;let n=[],l=this._def.keyType,c=this._def.valueType;for(let h in r.data)n.push({key:l._parse(new Ef(r,h,r.path,h)),value:c._parse(new Ef(r,r.data[h],r.path,h))});return r.common.async?Jl.mergeObjectAsync(t,n):Jl.mergeObjectSync(t,n)}get element(){return this._def.valueType}static create(e,t,r){return t instanceof lr?new ZR(ht({keyType:e,valueType:t,typeName:zi.ZodRecord},sr(r))):new ZR(ht({keyType:gf.create(),valueType:e,typeName:zi.ZodRecord},sr(t)))}},JR=class extends lr{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==Qt.map)return ii(r,{code:Nt.invalid_type,expected:Qt.map,received:r.parsedType}),rr;let n=this._def.keyType,l=this._def.valueType,c=[...r.data.entries()].map(([h,d],f)=>({key:n._parse(new Ef(r,h,r.path,[f,"key"])),value:l._parse(new Ef(r,d,r.path,[f,"value"]))}));if(r.common.async){let h=new Map;return Promise.resolve().then(()=>Km(this,null,function*(){for(let d of c){let f=yield d.key,m=yield d.value;if(f.status==="aborted"||m.status==="aborted")return rr;(f.status==="dirty"||m.status==="dirty")&&t.dirty(),h.set(f.value,m.value)}return{status:t.value,value:h}}))}else{let h=new Map;for(let d of c){let f=d.key,m=d.value;if(f.status==="aborted"||m.status==="aborted")return rr;(f.status==="dirty"||m.status==="dirty")&&t.dirty(),h.set(f.value,m.value)}return{status:t.value,value:h}}}};JR.create=(i,e,t)=>new JR(ht({valueType:e,keyType:i,typeName:zi.ZodMap},sr(t)));var qM=class extends lr{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==Qt.set)return ii(r,{code:Nt.invalid_type,expected:Qt.set,received:r.parsedType}),rr;let n=this._def;n.minSize!==null&&r.data.size<n.minSize.value&&(ii(r,{code:Nt.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),t.dirty()),n.maxSize!==null&&r.data.size>n.maxSize.value&&(ii(r,{code:Nt.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),t.dirty());let l=this._def.valueType;function c(d){let f=new Set;for(let m of d){if(m.status==="aborted")return rr;m.status==="dirty"&&t.dirty(),f.add(m.value)}return{status:t.value,value:f}}let h=[...r.data.values()].map((d,f)=>l._parse(new Ef(r,d,r.path,f)));return r.common.async?Promise.all(h).then(d=>c(d)):c(h)}min(e,t){return new qM(Gi(ht({},this._def),{minSize:{value:e,message:Ti.toString(t)}}))}max(e,t){return new qM(Gi(ht({},this._def),{maxSize:{value:e,message:Ti.toString(t)}}))}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}};qM.create=(i,e)=>new qM(ht({valueType:i,minSize:null,maxSize:null,typeName:zi.ZodSet},sr(e)));var KT=class extends lr{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==Qt.function)return ii(t,{code:Nt.invalid_type,expected:Qt.function,received:t.parsedType}),rr;function r(h,d){return jR({data:h,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,WR(),HA].filter(f=>!!f),issueData:{code:Nt.invalid_arguments,argumentsError:d}})}function n(h,d){return jR({data:h,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,WR(),HA].filter(f=>!!f),issueData:{code:Nt.invalid_return_type,returnTypeError:d}})}let l={errorMap:t.common.contextualErrorMap},c=t.data;if(this._def.returns instanceof XM){let h=this;return Yl(function(...d){return Km(this,null,function*(){let f=new jd([]),m=yield h._def.args.parseAsync(d,l).catch(y=>{throw f.addIssue(r(d,y)),f}),g=yield Reflect.apply(c,this,m);return yield h._def.returns._def.type.parseAsync(g,l).catch(y=>{throw f.addIssue(n(g,y)),f})})})}else{let h=this;return Yl(function(...d){let f=h._def.args.safeParse(d,l);if(!f.success)throw new jd([r(d,f.error)]);let m=Reflect.apply(c,this,f.data),g=h._def.returns.safeParse(m,l);if(!g.success)throw new jd([n(m,g.error)]);return g.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new KT(Gi(ht({},this._def),{args:Ip.create(e).rest(X1.create())}))}returns(e){return new KT(Gi(ht({},this._def),{returns:e}))}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new KT(ht({args:e||Ip.create([]).rest(X1.create()),returns:t||X1.create(),typeName:zi.ZodFunction},sr(r)))}},XA=class extends lr{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}};XA.create=(i,e)=>new XA(ht({getter:i,typeName:zi.ZodLazy},sr(e)));var ZA=class extends lr{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return ii(t,{received:t.data,code:Nt.invalid_literal,expected:this._def.value}),rr}return{status:"valid",value:e.data}}get value(){return this._def.value}};ZA.create=(i,e)=>new ZA(ht({value:i,typeName:zi.ZodLiteral},sr(e)));function vX(i,e){return new lw(ht({values:i,typeName:zi.ZodEnum},sr(e)))}var lw=class extends lr{_parse(e){if(typeof e.data!="string"){let t=this._getOrReturnCtx(e),r=this._def.values;return ii(t,{expected:en.joinValues(r),received:t.parsedType,code:Nt.invalid_type}),rr}if(this._def.values.indexOf(e.data)===-1){let t=this._getOrReturnCtx(e),r=this._def.values;return ii(t,{received:t.data,code:Nt.invalid_enum_value,options:r}),rr}return Yl(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e){return lw.create(e)}exclude(e){return lw.create(this.options.filter(t=>!e.includes(t)))}};lw.create=vX;var JA=class extends lr{_parse(e){let t=en.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==Qt.string&&r.parsedType!==Qt.number){let n=en.objectValues(t);return ii(r,{expected:en.joinValues(n),received:r.parsedType,code:Nt.invalid_type}),rr}if(t.indexOf(e.data)===-1){let n=en.objectValues(t);return ii(r,{received:r.data,code:Nt.invalid_enum_value,options:n}),rr}return Yl(e.data)}get enum(){return this._def.values}};JA.create=(i,e)=>new JA(ht({values:i,typeName:zi.ZodNativeEnum},sr(e)));var XM=class extends lr{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==Qt.promise&&t.common.async===!1)return ii(t,{code:Nt.invalid_type,expected:Qt.promise,received:t.parsedType}),rr;let r=t.parsedType===Qt.promise?t.data:Promise.resolve(t.data);return Yl(r.then(n=>this._def.type.parseAsync(n,{path:t.path,errorMap:t.common.contextualErrorMap})))}};XM.create=(i,e)=>new XM(ht({type:i,typeName:zi.ZodPromise},sr(e)));var Jd=class extends lr{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===zi.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:r}=this._processInputParams(e),n=this._def.effect||null,l={addIssue:c=>{ii(r,c),c.fatal?t.abort():t.dirty()},get path(){return r.path}};if(l.addIssue=l.addIssue.bind(l),n.type==="preprocess"){let c=n.transform(r.data,l);return r.common.issues.length?{status:"dirty",value:r.data}:r.common.async?Promise.resolve(c).then(h=>this._def.schema._parseAsync({data:h,path:r.path,parent:r})):this._def.schema._parseSync({data:c,path:r.path,parent:r})}if(n.type==="refinement"){let c=h=>{let d=n.refinement(h,l);if(r.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return h};if(r.common.async===!1){let h=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return h.status==="aborted"?rr:(h.status==="dirty"&&t.dirty(),c(h.value),{status:t.value,value:h.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(h=>h.status==="aborted"?rr:(h.status==="dirty"&&t.dirty(),c(h.value).then(()=>({status:t.value,value:h.value}))))}if(n.type==="transform")if(r.common.async===!1){let c=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!$A(c))return c;let h=n.transform(c.value,l);if(h instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:h}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(c=>$A(c)?Promise.resolve(n.transform(c.value,l)).then(h=>({status:t.value,value:h})):c);en.assertNever(n)}};Jd.create=(i,e,t)=>new Jd(ht({schema:i,typeName:zi.ZodEffects,effect:e},sr(t)));Jd.createWithPreprocess=(i,e,t)=>new Jd(ht({schema:e,effect:{type:"preprocess",transform:i},typeName:zi.ZodEffects},sr(t)));var xp=class extends lr{_parse(e){return this._getType(e)===Qt.undefined?Yl(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};xp.create=(i,e)=>new xp(ht({innerType:i,typeName:zi.ZodOptional},sr(e)));var uw=class extends lr{_parse(e){return this._getType(e)===Qt.null?Yl(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};uw.create=(i,e)=>new uw(ht({innerType:i,typeName:zi.ZodNullable},sr(e)));var YA=class extends lr{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return t.parsedType===Qt.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}};YA.create=(i,e)=>new YA(ht({innerType:i,typeName:zi.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default},sr(e)));var YR=class extends lr{_parse(e){let{ctx:t}=this._processInputParams(e),r=Gi(ht({},t),{common:Gi(ht({},t.common),{issues:[]})}),n=this._def.innerType._parse({data:r.data,path:r.path,parent:ht({},r)});return GR(n)?n.then(l=>({status:"valid",value:l.status==="valid"?l.value:this._def.catchValue({get error(){return new jd(r.common.issues)},input:r.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new jd(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}};YR.create=(i,e)=>new YR(ht({innerType:i,typeName:zi.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch},sr(e)));var KR=class extends lr{_parse(e){if(this._getType(e)!==Qt.nan){let t=this._getOrReturnCtx(e);return ii(t,{code:Nt.invalid_type,expected:Qt.nan,received:t.parsedType}),rr}return{status:"valid",value:e.data}}};KR.create=i=>new KR(ht({typeName:zi.ZodNaN},sr(i)));var Xme=Symbol("zod_brand"),yX=class extends lr{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}},cL=class extends lr{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return Km(this,null,function*(){let n=yield this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return n.status==="aborted"?rr:n.status==="dirty"?(t.dirty(),gX(n.value)):this._def.out._parseAsync({data:n.value,path:r.path,parent:r})});{let n=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return n.status==="aborted"?rr:n.status==="dirty"?(t.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:r.path,parent:r})}}static create(e,t){return new cL({in:e,out:t,typeName:zi.ZodPipeline})}},QR=class extends lr{_parse(e){let t=this._def.innerType._parse(e);return $A(t)&&(t.value=Object.freeze(t.value)),t}};QR.create=(i,e)=>new QR(ht({innerType:i,typeName:zi.ZodReadonly},sr(e)));var _X=(i,e={},t)=>i?GM.create().superRefine((r,n)=>{var l,c;if(!i(r)){let h=typeof e=="function"?e(r):typeof e=="string"?{message:e}:e,d=(c=(l=h.fatal)!==null&&l!==void 0?l:t)!==null&&c!==void 0?c:!0,f=typeof h=="string"?{message:h}:h;n.addIssue(Gi(ht({code:"custom"},f),{fatal:d}))}}):GM.create(),Zme={object:_s.lazycreate},zi;(function(i){i.ZodString="ZodString",i.ZodNumber="ZodNumber",i.ZodNaN="ZodNaN",i.ZodBigInt="ZodBigInt",i.ZodBoolean="ZodBoolean",i.ZodDate="ZodDate",i.ZodSymbol="ZodSymbol",i.ZodUndefined="ZodUndefined",i.ZodNull="ZodNull",i.ZodAny="ZodAny",i.ZodUnknown="ZodUnknown",i.ZodNever="ZodNever",i.ZodVoid="ZodVoid",i.ZodArray="ZodArray",i.ZodObject="ZodObject",i.ZodUnion="ZodUnion",i.ZodDiscriminatedUnion="ZodDiscriminatedUnion",i.ZodIntersection="ZodIntersection",i.ZodTuple="ZodTuple",i.ZodRecord="ZodRecord",i.ZodMap="ZodMap",i.ZodSet="ZodSet",i.ZodFunction="ZodFunction",i.ZodLazy="ZodLazy",i.ZodLiteral="ZodLiteral",i.ZodEnum="ZodEnum",i.ZodEffects="ZodEffects",i.ZodNativeEnum="ZodNativeEnum",i.ZodOptional="ZodOptional",i.ZodNullable="ZodNullable",i.ZodDefault="ZodDefault",i.ZodCatch="ZodCatch",i.ZodPromise="ZodPromise",i.ZodBranded="ZodBranded",i.ZodPipeline="ZodPipeline",i.ZodReadonly="ZodReadonly"})(zi||(zi={}));var Jme=(i,e={message:`Input not instance of ${i.name}`})=>_X(t=>t instanceof i,e),xX=gf.create,bX=aw.create,Yme=KR.create,Kme=ow.create,wX=VA.create,Qme=jM.create,ege=qR.create,tge=WA.create,ige=jA.create,rge=GM.create,nge=X1.create,sge=Rp.create,age=XR.create,oge=bf.create,lge=_s.create,uge=_s.strictCreate,cge=GA.create,hge=CB.create,dge=qA.create,fge=Ip.create,pge=ZR.create,mge=JR.create,gge=qM.create,vge=KT.create,yge=XA.create,_ge=ZA.create,xge=lw.create,bge=JA.create,wge=XM.create,aV=Jd.create,Sge=xp.create,Mge=uw.create,Ege=Jd.createWithPreprocess,Tge=cL.create,Age=()=>xX().optional(),Cge=()=>bX().optional(),Pge=()=>wX().optional(),Rge={string:i=>gf.create(Gi(ht({},i),{coerce:!0})),number:i=>aw.create(Gi(ht({},i),{coerce:!0})),boolean:i=>VA.create(Gi(ht({},i),{coerce:!0})),bigint:i=>ow.create(Gi(ht({},i),{coerce:!0})),date:i=>jM.create(Gi(ht({},i),{coerce:!0}))},Ige=rr,Z1=Object.freeze({__proto__:null,defaultErrorMap:HA,setErrorMap:Dme,getErrorMap:WR,makeIssue:jR,EMPTY_PATH:kme,addIssueToContext:ii,ParseStatus:Jl,INVALID:rr,DIRTY:gX,OK:Yl,isAborted:UF,isDirty:HF,isValid:$A,isAsync:GR,get util(){return en},get objectUtil(){return BF},ZodParsedType:Qt,getParsedType:Tm,ZodType:lr,ZodString:gf,ZodNumber:aw,ZodBigInt:ow,ZodBoolean:VA,ZodDate:jM,ZodSymbol:qR,ZodUndefined:WA,ZodNull:jA,ZodAny:GM,ZodUnknown:X1,ZodNever:Rp,ZodVoid:XR,ZodArray:bf,ZodObject:_s,ZodUnion:GA,ZodDiscriminatedUnion:CB,ZodIntersection:qA,ZodTuple:Ip,ZodRecord:ZR,ZodMap:JR,ZodSet:qM,ZodFunction:KT,ZodLazy:XA,ZodLiteral:ZA,ZodEnum:lw,ZodNativeEnum:JA,ZodPromise:XM,ZodEffects:Jd,ZodTransformer:Jd,ZodOptional:xp,ZodNullable:uw,ZodDefault:YA,ZodCatch:YR,ZodNaN:KR,BRAND:Xme,ZodBranded:yX,ZodPipeline:cL,ZodReadonly:QR,custom:_X,Schema:lr,ZodSchema:lr,late:Zme,get ZodFirstPartyTypeKind(){return zi},coerce:Rge,any:rge,array:oge,bigint:Kme,boolean:wX,date:Qme,discriminatedUnion:hge,effect:aV,enum:xge,function:vge,instanceof:Jme,intersection:dge,lazy:yge,literal:_ge,map:mge,nan:Yme,nativeEnum:bge,never:sge,null:ige,nullable:Mge,number:bX,object:lge,oboolean:Pge,onumber:Cge,optional:Sge,ostring:Age,pipeline:Tge,preprocess:Ege,promise:wge,record:pge,set:gge,strictObject:uge,string:xX,symbol:ege,transformer:aV,tuple:fge,undefined:tge,union:cge,unknown:nge,void:age,NEVER:Ige,ZodIssueCode:Nt,quotelessJson:Nme,ZodError:jd}),Lge=Z1.object({serverUrl:Z1.string()}),Oge=Lge.parse({serverUrl:"https://io.superviz.com"});ri();var Nge=class{constructor(e){this.socket=e,this.onConnect=()=>{this.logger.log("connection @ on connect","Connected to the socket"),this.changeState("CONNECTED")},this.onDisconnect=t=>{this.logger.log("connection @ on disconnect","Disconnected from the socket"),this.changeState("DISCONNECTED",t)},this.onConnectError=t=>{this.logger.log("connection @ on connect error","Connection error",t),this.changeState("CONNECTION_ERROR",t.message)},this.onConnectionError=t=>{this.logger.log("connection @ on connection error","Connection error",t),this.changeState("CONNECTION_ERROR",t.message)},this.onReconnect=()=>{this.logger.log("connection @ on reconnect","Reconnected to the socket"),this.changeState("CONNECTED")},this.onReconnectError=t=>{this.logger.log("connection @ on reconnect error","Reconnect error",t),this.changeState("RECONNECT_ERROR",t.message)},this.onReconnectFailed=()=>{this.logger.log("connection @ on reconnect failed","Failed to reconnect to the socket"),this.changeState("RECONNECT_ERROR")},this.onReconnecAttempt=t=>{this.logger.log("connection @ on reconnect attempt",`Reconnect attempt #${t}`),this.changeState("RECONNECTING",`Reconnect attempt #${t}`)},this.onRateLimit=t=>{console.warn("Warn you have been rate limited",t)},this.logger=new wB("@superviz/socket-client/connection"),this.subscribeToManagerEvents(),this.stateObserver=new N1}on(e,t){this.stateObserver.subscribe({next:e,error:t})}off(){this.stateObserver.unsubscribe()}subscribeToManagerEvents(){this.socket.on("connect",this.onConnect),this.socket.on("disconnect",this.onDisconnect),this.socket.on("connect_error",this.onConnectError),this.socket.on("rate-limit",this.onRateLimit),this.socket.io.on("error",this.onConnectionError),this.socket.io.on("reconnect",this.onReconnect),this.socket.io.on("reconnect_attempt",this.onReconnecAttempt),this.socket.io.on("reconnect_error",this.onReconnectError),this.socket.io.on("reconnect_failed",this.onReconnectFailed)}changeState(e,t){this.state=e,this.stateObserver.next({state:e,reason:t})}};ri();var SX=class{constructor(e,t,r){this.io=e,this.user=t,this.roomId=r,this.isJoined=!1,this.onJoinedRoom=l=>{this.isJoined=!0,this.io.emit("room.joined",this.roomId,l.data),this.logger.log("room @ joined",l)},this.logger=new wB("@superviz/socket-client/room");let n={name:r,user:t};this.presence=Qq.register(e,t,r),this.io.emit("room.join",n),this.subscribeToRoomEvents()}static register(e,t,r){return new SX(e,t,r)}on(e,t){this.logger.log("room @ on",e),this.io.on(e,t)}off(e,t){this.logger.log("room @ off",e),this.io.off(e,t)}emit(e,t){if(!this.isJoined){this.logger.log("Cannot emit event. Not joined to room");return}let r={name:e,roomId:this.roomId,presence:this.user,connectionId:this.io.id,data:t,timestamp:Date.now()};this.io.emit("room.update",this.roomId,r),this.logger.log("room @ emit",e,t)}history(e,t){let r=new N1;r.subscribe({next:e,error:t});let n=l=>{this.logger.log("room @ history",l),this.io.off("room.get",n),r.next(l),r.complete()};this.io.on("room.get",n),this.io.emit("room.get",this.roomId)}disconnect(){this.logger.log("room @ disconnect","Leaving room...",this.roomId),this.io.emit("room.leave",this.roomId)}subscribeToRoomEvents(){this.io.on("room.joined",this.onJoinedRoom),this.io.on("room.error",e=>{this.logger.log("Error:",e.data)})}},Dge=class{constructor(e,t,r){this.apiKey=e,this.envirioment=t,this.presence=r,this.manager=new VR(Oge.serverUrl,{secure:!0,withCredentials:!0,reconnection:!0,reconnectionDelay:1e3,reconnectionDelayMax:5e3,reconnectionAttempts:5,extraHeaders:{"sv-api-key":this.apiKey}});let{origin:n}=window.location;this.socket=this.manager.socket("/",{auth:{apiKey:this.apiKey,origin:n,envirioment:this.envirioment}}),this.connection=new Nge(this.socket)}get state(){return this.connection.state}connect(e){return SX.register(this.socket,this.presence,e)}destroy(){this.socket.disconnect()}};ri();ri();var kge=Z1.object({id:Z1.string(),name:Z1.string()});Z1.object({name:Z1.string(),user:kge});var MX={exports:{}};/*!
 * @license Copyright 2015-2022 Ably Real-time Ltd (ably.com)
 * 
 * Ably JavaScript Library v1.2.49
 * https://github.com/ably/ably-js
 * 
 * Released under the Apache Licence v2.0
 */(function(i,e){(function(r,n){i.exports=n()})(window,function(){return function(t){var r={};function n(l){if(r[l])return r[l].exports;var c=r[l]={i:l,l:!1,exports:{}};return t[l].call(c.exports,c,c.exports,n),c.l=!0,c.exports}return n.m=t,n.c=r,n.d=function(l,c,h){n.o(l,c)||Object.defineProperty(l,c,{enumerable:!0,get:h})},n.r=function(l){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},n.t=function(l,c){if(c&1&&(l=n(l)),c&8||c&4&&typeof l=="object"&&l&&l.__esModule)return l;var h=Object.create(null);if(n.r(h),Object.defineProperty(h,"default",{enumerable:!0,value:l}),c&2&&typeof l!="string")for(var d in l)n.d(h,d,(function(f){return l[f]}).bind(null,d));return h},n.n=function(l){var c=l&&l.__esModule?function(){return l.default}:function(){return l};return n.d(c,"a",c),c},n.o=function(l,c){return Object.prototype.hasOwnProperty.call(l,c)},n.p="",n(n.s=42)}([function(t,r,n){n.r(r),n.d(r,"__extends",function(){return c}),n.d(r,"__assign",function(){return h}),n.d(r,"__rest",function(){return d}),n.d(r,"__decorate",function(){return f}),n.d(r,"__param",function(){return m}),n.d(r,"__metadata",function(){return g}),n.d(r,"__awaiter",function(){return y}),n.d(r,"__generator",function(){return _}),n.d(r,"__createBinding",function(){return b}),n.d(r,"__exportStar",function(){return S}),n.d(r,"__values",function(){return E}),n.d(r,"__read",function(){return T}),n.d(r,"__spread",function(){return A}),n.d(r,"__spreadArrays",function(){return P}),n.d(r,"__spreadArray",function(){return O}),n.d(r,"__await",function(){return R}),n.d(r,"__asyncGenerator",function(){return D}),n.d(r,"__asyncDelegator",function(){return L}),n.d(r,"__asyncValues",function(){return N}),n.d(r,"__makeTemplateObject",function(){return U}),n.d(r,"__importStar",function(){return z}),n.d(r,"__importDefault",function(){return G}),n.d(r,"__classPrivateFieldGet",function(){return J}),n.d(r,"__classPrivateFieldSet",function(){return Z});/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var l=function(q,$){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(H,X){H.__proto__=X}||function(H,X){for(var re in X)Object.prototype.hasOwnProperty.call(X,re)&&(H[re]=X[re])},l(q,$)};function c(q,$){if(typeof $!="function"&&$!==null)throw new TypeError("Class extends value "+String($)+" is not a constructor or null");l(q,$);function H(){this.constructor=q}q.prototype=$===null?Object.create($):(H.prototype=$.prototype,new H)}var h=function(){return h=Object.assign||function($){for(var H,X=1,re=arguments.length;X<re;X++){H=arguments[X];for(var ae in H)Object.prototype.hasOwnProperty.call(H,ae)&&($[ae]=H[ae])}return $},h.apply(this,arguments)};function d(q,$){var H={};for(var X in q)Object.prototype.hasOwnProperty.call(q,X)&&$.indexOf(X)<0&&(H[X]=q[X]);if(q!=null&&typeof Object.getOwnPropertySymbols=="function")for(var re=0,X=Object.getOwnPropertySymbols(q);re<X.length;re++)$.indexOf(X[re])<0&&Object.prototype.propertyIsEnumerable.call(q,X[re])&&(H[X[re]]=q[X[re]]);return H}function f(q,$,H,X){var re=arguments.length,ae=re<3?$:X===null?X=Object.getOwnPropertyDescriptor($,H):X,he;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")ae=Reflect.decorate(q,$,H,X);else for(var pe=q.length-1;pe>=0;pe--)(he=q[pe])&&(ae=(re<3?he(ae):re>3?he($,H,ae):he($,H))||ae);return re>3&&ae&&Object.defineProperty($,H,ae),ae}function m(q,$){return function(H,X){$(H,X,q)}}function g(q,$){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(q,$)}function y(q,$,H,X){function re(ae){return ae instanceof H?ae:new H(function(he){he(ae)})}return new(H||(H=Promise))(function(ae,he){function pe(se){try{ee(X.next(se))}catch(Y){he(Y)}}function de(se){try{ee(X.throw(se))}catch(Y){he(Y)}}function ee(se){se.done?ae(se.value):re(se.value).then(pe,de)}ee((X=X.apply(q,$||[])).next())})}function _(q,$){var H={label:0,sent:function(){if(ae[0]&1)throw ae[1];return ae[1]},trys:[],ops:[]},X,re,ae,he;return he={next:pe(0),throw:pe(1),return:pe(2)},typeof Symbol=="function"&&(he[Symbol.iterator]=function(){return this}),he;function pe(ee){return function(se){return de([ee,se])}}function de(ee){if(X)throw new TypeError("Generator is already executing.");for(;H;)try{if(X=1,re&&(ae=ee[0]&2?re.return:ee[0]?re.throw||((ae=re.return)&&ae.call(re),0):re.next)&&!(ae=ae.call(re,ee[1])).done)return ae;switch(re=0,ae&&(ee=[ee[0]&2,ae.value]),ee[0]){case 0:case 1:ae=ee;break;case 4:return H.label++,{value:ee[1],done:!1};case 5:H.label++,re=ee[1],ee=[0];continue;case 7:ee=H.ops.pop(),H.trys.pop();continue;default:if(ae=H.trys,!(ae=ae.length>0&&ae[ae.length-1])&&(ee[0]===6||ee[0]===2)){H=0;continue}if(ee[0]===3&&(!ae||ee[1]>ae[0]&&ee[1]<ae[3])){H.label=ee[1];break}if(ee[0]===6&&H.label<ae[1]){H.label=ae[1],ae=ee;break}if(ae&&H.label<ae[2]){H.label=ae[2],H.ops.push(ee);break}ae[2]&&H.ops.pop(),H.trys.pop();continue}ee=$.call(q,H)}catch(se){ee=[6,se],re=0}finally{X=ae=0}if(ee[0]&5)throw ee[1];return{value:ee[0]?ee[1]:void 0,done:!0}}}var b=Object.create?function(q,$,H,X){X===void 0&&(X=H),Object.defineProperty(q,X,{enumerable:!0,get:function(){return $[H]}})}:function(q,$,H,X){X===void 0&&(X=H),q[X]=$[H]};function S(q,$){for(var H in q)H!=="default"&&!Object.prototype.hasOwnProperty.call($,H)&&b($,q,H)}function E(q){var $=typeof Symbol=="function"&&Symbol.iterator,H=$&&q[$],X=0;if(H)return H.call(q);if(q&&typeof q.length=="number")return{next:function(){return q&&X>=q.length&&(q=void 0),{value:q&&q[X++],done:!q}}};throw new TypeError($?"Object is not iterable.":"Symbol.iterator is not defined.")}function T(q,$){var H=typeof Symbol=="function"&&q[Symbol.iterator];if(!H)return q;var X=H.call(q),re,ae=[],he;try{for(;($===void 0||$-- >0)&&!(re=X.next()).done;)ae.push(re.value)}catch(pe){he={error:pe}}finally{try{re&&!re.done&&(H=X.return)&&H.call(X)}finally{if(he)throw he.error}}return ae}function A(){for(var q=[],$=0;$<arguments.length;$++)q=q.concat(T(arguments[$]));return q}function P(){for(var q=0,$=0,H=arguments.length;$<H;$++)q+=arguments[$].length;for(var X=Array(q),re=0,$=0;$<H;$++)for(var ae=arguments[$],he=0,pe=ae.length;he<pe;he++,re++)X[re]=ae[he];return X}function O(q,$,H){if(H||arguments.length===2)for(var X=0,re=$.length,ae;X<re;X++)(ae||!(X in $))&&(ae||(ae=Array.prototype.slice.call($,0,X)),ae[X]=$[X]);return q.concat(ae||Array.prototype.slice.call($))}function R(q){return this instanceof R?(this.v=q,this):new R(q)}function D(q,$,H){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var X=H.apply(q,$||[]),re,ae=[];return re={},he("next"),he("throw"),he("return"),re[Symbol.asyncIterator]=function(){return this},re;function he(fe){X[fe]&&(re[fe]=function(me){return new Promise(function(De,Le){ae.push([fe,me,De,Le])>1||pe(fe,me)})})}function pe(fe,me){try{de(X[fe](me))}catch(De){Y(ae[0][3],De)}}function de(fe){fe.value instanceof R?Promise.resolve(fe.value.v).then(ee,se):Y(ae[0][2],fe)}function ee(fe){pe("next",fe)}function se(fe){pe("throw",fe)}function Y(fe,me){fe(me),ae.shift(),ae.length&&pe(ae[0][0],ae[0][1])}}function L(q){var $,H;return $={},X("next"),X("throw",function(re){throw re}),X("return"),$[Symbol.iterator]=function(){return this},$;function X(re,ae){$[re]=q[re]?function(he){return(H=!H)?{value:R(q[re](he)),done:re==="return"}:ae?ae(he):he}:ae}}function N(q){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var $=q[Symbol.asyncIterator],H;return $?$.call(q):(q=typeof E=="function"?E(q):q[Symbol.iterator](),H={},X("next"),X("throw"),X("return"),H[Symbol.asyncIterator]=function(){return this},H);function X(ae){H[ae]=q[ae]&&function(he){return new Promise(function(pe,de){he=q[ae](he),re(pe,de,he.done,he.value)})}}function re(ae,he,pe,de){Promise.resolve(de).then(function(ee){ae({value:ee,done:pe})},he)}}function U(q,$){return Object.defineProperty?Object.defineProperty(q,"raw",{value:$}):q.raw=$,q}var F=Object.create?function(q,$){Object.defineProperty(q,"default",{enumerable:!0,value:$})}:function(q,$){q.default=$};function z(q){if(q&&q.__esModule)return q;var $={};if(q!=null)for(var H in q)H!=="default"&&Object.prototype.hasOwnProperty.call(q,H)&&b($,q,H);return F($,q),$}function G(q){return q&&q.__esModule?q:{default:q}}function J(q,$,H,X){if(H==="a"&&!X)throw new TypeError("Private accessor was defined without a getter");if(typeof $=="function"?q!==$||!X:!$.has(q))throw new TypeError("Cannot read private member from an object whose class did not declare it");return H==="m"?X:H==="a"?X.call(q):X?X.value:$.get(q)}function Z(q,$,H,X,re){if(X==="m")throw new TypeError("Private method is not writable");if(X==="a"&&!re)throw new TypeError("Private accessor was defined without a setter");if(typeof $=="function"?q!==$||!re:!$.has(q))throw new TypeError("Cannot write private member to an object whose class did not declare it");return X==="a"?re.call(q,H):re?re.value=H:$.set(q,H),H}},function(t,r,n){(function(l){Object.defineProperty(r,"__esModule",{value:!0}),r.allToUpperCase=r.allToLowerCase=r.encodeBody=r.decodeBody=r.Format=r.promisify=r.trim=r.arrChooseN=r.randomHexString=r.randomString=r.cheapRandStr=r.dataSizeBytes=r.inspectBody=r.inspectError=r.isErrorInfoOrPartialErrorInfo=r.now=r.parseQueryString=r.toQueryString=r.arrPopRandomElement=r.defaultPostHeaders=r.defaultGetHeaders=r.allSame=r.arrEvery=r.arrFilter=r.arrMap=r.safeArrForEach=r.arrForEach=r.forInOwnNonNullProperties=r.valuesArray=r.keysArray=r.arrWithoutValue=r.arrDeleteValue=r.arrIn=r.arrIndexOf=r.arrSubtract=r.arrIntersectOb=r.arrIntersect=r.intersect=r.containsValue=r.inherits=r.prototypicalClone=r.shallowClone=r.isEmptyArg=r.isOnlyPropIn=r.isEmpty=r.isObject=r.ensureArray=r.isArray=r.copy=r.mixin=void 0,r.arrEquals=r.toBase64=r.matchDerivedChannel=r.shallowEquals=r.getGlobalObject=r.getRetryTime=r.getJitterCoefficient=r.getBackoffCoefficient=void 0;var c=n(0),h=c.__importDefault(n(3)),d=c.__importStar(n(8)),f=c.__importDefault(n(4)),m=n(11),g=n(31);function y(xe){return Math.floor(Math.random()*xe.length)}function _(xe){for(var we=[],Ve=1;Ve<arguments.length;Ve++)we[Ve-1]=arguments[Ve];for(var ut=0;ut<we.length;ut++){var lt=we[ut];if(!lt)break;var Ee=Object.prototype.hasOwnProperty;for(var _t in lt)(!Ee||Ee.call(lt,_t))&&(xe[_t]=lt[_t])}return xe}r.mixin=_;function b(xe){return _({},xe)}r.copy=b,r.isArray=Array.isArray||function(xe){return Object.prototype.toString.call(xe)=="[object Array]"};function S(xe){return P(xe)?[]:(0,r.isArray)(xe)?xe:[xe]}r.ensureArray=S;function E(xe){return Object.prototype.toString.call(xe)=="[object Object]"}r.isObject=E;function T(xe){for(var we in xe)return!1;return!0}r.isEmpty=T;function A(xe,we){for(var Ve in xe)if(Ve!==we)return!1;return!0}r.isOnlyPropIn=A;function P(xe){return xe==null}r.isEmptyArg=P;function O(xe){var we=new Object;for(var Ve in xe)we[Ve]=xe[Ve];return we}r.shallowClone=O;function R(xe,we){var Ve=function(){function lt(){}return lt}();Ve.prototype=xe;var ut=new Ve;return we&&_(ut,we),ut}r.prototypicalClone=R;var D=function(xe,we){if(h.default.Config.inherits){h.default.Config.inherits(xe,we);return}xe.super_=we,xe.prototype=R(we.prototype,{constructor:xe})};r.inherits=D;function L(xe,we){for(var Ve in xe)if(xe[Ve]==we)return!0;return!1}r.containsValue=L;function N(xe,we){return(0,r.isArray)(we)?U(xe,we):F(xe,we)}r.intersect=N;function U(xe,we){for(var Ve=[],ut=0;ut<xe.length;ut++){var lt=xe[ut];(0,r.arrIndexOf)(we,lt)!=-1&&Ve.push(lt)}return Ve}r.arrIntersect=U;function F(xe,we){for(var Ve=[],ut=0;ut<xe.length;ut++){var lt=xe[ut];lt in we&&Ve.push(lt)}return Ve}r.arrIntersectOb=F;function z(xe,we){for(var Ve=[],ut=0;ut<xe.length;ut++){var lt=xe[ut];(0,r.arrIndexOf)(we,lt)==-1&&Ve.push(lt)}return Ve}r.arrSubtract=z,r.arrIndexOf=Array.prototype.indexOf?function(xe,we,Ve){return xe.indexOf(we,Ve)}:function(xe,we,Ve){Ve=Ve||0;for(var ut=xe.length;Ve<ut;Ve++)if(xe[Ve]===we)return Ve;return-1};function G(xe,we){return(0,r.arrIndexOf)(xe,we)!==-1}r.arrIn=G;function J(xe,we){var Ve=(0,r.arrIndexOf)(xe,we),ut=Ve!=-1;return ut&&xe.splice(Ve,1),ut}r.arrDeleteValue=J;function Z(xe,we){var Ve=xe.slice();return J(Ve,we),Ve}r.arrWithoutValue=Z;function q(xe,we){var Ve=[];for(var ut in xe)we&&!Object.prototype.hasOwnProperty.call(xe,ut)||Ve.push(ut);return Ve}r.keysArray=q;function $(xe,we){var Ve=[];for(var ut in xe)we&&!Object.prototype.hasOwnProperty.call(xe,ut)||Ve.push(xe[ut]);return Ve}r.valuesArray=$;function H(xe,we){for(var Ve in xe)Object.prototype.hasOwnProperty.call(xe,Ve)&&xe[Ve]&&we(Ve)}r.forInOwnNonNullProperties=H,r.arrForEach=Array.prototype.forEach?function(xe,we){xe.forEach(we)}:function(xe,we){for(var Ve=xe.length,ut=0;ut<Ve;ut++)we(xe[ut],ut,xe)};function X(xe,we){return(0,r.arrForEach)(xe.slice(),we)}r.safeArrForEach=X,r.arrMap=Array.prototype.map?function(xe,we){return xe.map(we)}:function(xe,we){for(var Ve=[],ut=xe.length,lt=0;lt<ut;lt++)Ve.push(we(xe[lt],lt,xe));return Ve},r.arrFilter=Array.prototype.filter?function(xe,we){return xe.filter(we)}:function(xe,we){for(var Ve=[],ut=xe.length,lt=0;lt<ut;lt++)we(xe[lt])&&Ve.push(xe[lt]);return Ve},r.arrEvery=Array.prototype.every?function(xe,we){return xe.every(we)}:function(xe,we){for(var Ve=xe.length,ut=0;ut<Ve;ut++)if(!we(xe[ut],ut,xe))return!1;return!0};function re(xe,we){if(xe.length===0)return!0;var Ve=xe[0][we];return(0,r.arrEvery)(xe,function(ut){return ut[we]===Ve})}r.allSame=re;var ae={json:"application/json",jsonp:"application/javascript",xml:"application/xml",html:"text/html",msgpack:"application/x-msgpack"};function he(xe,we){var Ve=ae[we||Ge.json];return{accept:Ve,"X-Ably-Version":d.default.protocolVersion.toString(),"Ably-Agent":(0,d.getAgentString)(xe)}}r.defaultGetHeaders=he;function pe(xe,we){var Ve,ut=Ve=ae[we||Ge.json];return{accept:ut,"content-type":Ve,"X-Ably-Version":d.default.protocolVersion.toString(),"Ably-Agent":(0,d.getAgentString)(xe)}}r.defaultPostHeaders=pe;function de(xe){return xe.splice(y(xe),1)[0]}r.arrPopRandomElement=de;function ee(xe){var we=[];if(xe)for(var Ve in xe)we.push(encodeURIComponent(Ve)+"="+encodeURIComponent(xe[Ve]));return we.length?"?"+we.join("&"):""}r.toQueryString=ee;function se(xe){for(var we,Ve=/([^?&=]+)=?([^&]*)/g,ut={};we=Ve.exec(xe);)ut[decodeURIComponent(we[1])]=decodeURIComponent(we[2]);return ut}r.parseQueryString=se,r.now=Date.now||function(){return new Date().getTime()};function Y(xe){return typeof xe=="object"&&xe!==null&&(xe.constructor.name=="ErrorInfo"||xe.constructor.name=="PartialErrorInfo")}r.isErrorInfoOrPartialErrorInfo=Y;function fe(xe){var we,Ve;return xe instanceof Error||((we=xe==null?void 0:xe.constructor)===null||we===void 0?void 0:we.name)==="ErrorInfo"||((Ve=xe==null?void 0:xe.constructor)===null||Ve===void 0?void 0:Ve.name)==="PartialErrorInfo"?xe.toString():h.default.Config.inspect(xe)}r.inspectError=fe;function me(xe){return h.default.BufferUtils.isBuffer(xe)?xe.toString():typeof xe=="string"?xe:h.default.Config.inspect(xe)}r.inspectBody=me;function De(xe){if(h.default.BufferUtils.isBuffer(xe))return h.default.BufferUtils.byteLength(xe);if(typeof xe=="string")return h.default.Config.stringByteSize(xe);throw new Error("Expected input of Utils.dataSizeBytes to be a buffer or string, but was: "+typeof xe)}r.dataSizeBytes=De;function Le(){return String(Math.random()).substr(2)}r.cheapRandStr=Le;var Ce=function(xe){if(h.default.Config.getRandomValues&&typeof Uint8Array<"u"){var we=new Uint8Array(xe);return h.default.Config.getRandomValues(we),h.default.BufferUtils.base64Encode(we)}for(var Ve=h.default.BufferUtils.base64CharSet,ut=Math.round(xe*4/3),lt="",Ee=0;Ee<ut;Ee++)lt+=Ve[y(Ve)];return lt};r.randomString=Ce;var Ae=function(xe){if(h.default.Config.getRandomValues&&typeof Uint8Array<"u"){var we=new Uint8Array(xe);return h.default.Config.getRandomValues(we),h.default.BufferUtils.hexEncode(we)}for(var Ve=h.default.BufferUtils.hexCharSet,ut=xe*2,lt="",Ee=0;Ee<ut;Ee++)lt+=Ve[y(Ve)];return lt};r.randomHexString=Ae;function Ue(xe,we){for(var Ve=Math.min(we,xe.length),ut=xe.slice(),lt=[],Ee=0;Ee<Ve;Ee++)lt.push(de(ut));return lt}r.arrChooseN=Ue,r.trim=String.prototype.trim?function(xe){return xe.trim()}:function(xe){return xe.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};function Ne(xe,we,Ve){return new Promise(function(ut,lt){xe[we].apply(xe,c.__spreadArray(c.__spreadArray([],Ve,!1),[function(Ee,_t){Ee?lt(Ee):ut(_t)}],!1))})}r.promisify=Ne;var Ge;(function(xe){xe.msgpack="msgpack",xe.json="json"})(Ge=r.Format||(r.Format={}));function Ct(xe,we){return we=="msgpack"?h.default.Config.msgpack.decode(xe):JSON.parse(String(xe))}r.decodeBody=Ct;function it(xe,we){return we=="msgpack"?h.default.Config.msgpack.encode(xe,!0):JSON.stringify(xe)}r.encodeBody=it;function bt(xe){return xe.map(function(we){return we&&we.toLowerCase()})}r.allToLowerCase=bt;function Kt(xe){return xe.map(function(we){return we&&we.toUpperCase()})}r.allToUpperCase=Kt;function kt(xe){return Math.min((xe+2)/3,2)}r.getBackoffCoefficient=kt;function Pt(){return 1-Math.random()*.2}r.getJitterCoefficient=Pt;function _e(xe,we){return xe*kt(we)*Pt()}r.getRetryTime=_e;function ce(){return l||(typeof window<"u"?window:self)}r.getGlobalObject=ce;function Fe(xe,we){return Object.keys(xe).every(function(Ve){return xe[Ve]===we[Ve]})&&Object.keys(we).every(function(Ve){return we[Ve]===xe[Ve]})}r.shallowEquals=Fe;function et(xe){var we=/^(\[([^?]*)(?:(.*))\])?(.+)$/,Ve=xe.match(we);if(!Ve||!Ve.length||Ve.length<5)throw new f.default("regex match failed",400,40010);if(Ve[2])throw new f.default("cannot use a derived option with a ".concat(Ve[2]," channel"),400,40010);return{qualifierParam:Ve[3]||"",channelName:Ve[4]}}r.matchDerivedChannel=et;function Dt(xe){return h.default.Config.createHmac?Buffer.from(xe,"ascii").toString("base64"):(0,m.stringify)((0,g.parse)(xe))}r.toBase64=Dt;function gt(xe,we){return xe.length===we.length&&(0,r.arrEvery)(xe,function(Ve,ut){return Ve===we[ut]})}r.arrEquals=gt}).call(this,n(13))},function(t,r,n){(function(l){Object.defineProperty(r,"__esModule",{value:!0});var c=n(0),h=c.__importDefault(n(3)),d=l||(typeof window<"u"?window:self),f;(function(b){b[b.None=0]="None",b[b.Error=1]="Error",b[b.Major=2]="Major",b[b.Minor=3]="Minor",b[b.Micro=4]="Micro"})(f||(f={}));function m(b,S){return"".concat(b).padStart(S?3:2,"0")}function g(b){return h.default.Config.logTimestamps?function(S){var E=new Date;b(m(E.getHours())+":"+m(E.getMinutes())+":"+m(E.getSeconds())+"."+m(E.getMilliseconds(),1)+" "+S)}:b}var y=function(){var b,S,E,T;return typeof Window>"u"&&typeof WorkerGlobalScope>"u"||typeof((S=(b=d==null?void 0:d.console)===null||b===void 0?void 0:b.log)===null||S===void 0?void 0:S.apply)=="function"?(E=function(){for(var A=[],P=0;P<arguments.length;P++)A[P]=arguments[P];console.log.apply(console,A)},T=console.warn?function(){for(var A=[],P=0;P<arguments.length;P++)A[P]=arguments[P];console.warn.apply(console,A)}:E):d!=null&&d.console.log?E=T=function(){Function.prototype.apply.call(console.log,console,arguments)}:E=T=function(){},[E,T].map(g)},_=function(){function b(){b.logLevel=b.LOG_DEFAULT}return b.initLogHandlers=function(){var S=y(),E=S[0],T=S[1];this.logHandler=E,this.logErrorHandler=T},b.logLevel=f.Error,b.LOG_NONE=f.None,b.LOG_ERROR=f.Error,b.LOG_MAJOR=f.Major,b.LOG_MINOR=f.Minor,b.LOG_MICRO=f.Micro,b.LOG_DEFAULT=f.Error,b.LOG_DEBUG=f.Micro,b.logAction=function(S,E,T){b.shouldLog(S)&&(S===f.Error?b.logErrorHandler:b.logHandler)("Ably: "+E+": "+T)},b.deprecated=function(S,E){b.deprecatedWithMsg(S,"Please use '"+E+"' instead.")},b.deprecatedWithMsg=function(S,E){b.shouldLog(f.Error)&&b.logErrorHandler("Ably: Deprecation warning - '"+S+"' is deprecated and will be removed from a future version. "+E)},b.shouldLog=function(S){return S<=b.logLevel},b.setLog=function(S,E){S!==void 0&&(b.logLevel=S),E!==void 0&&(b.logHandler=b.logErrorHandler=E)},b}();r.default=_}).call(this,n(13))},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function c(){}return c}();r.default=l},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0}),r.PartialErrorInfo=void 0;var l=n(0),c=l.__importDefault(n(3)),h=l.__importStar(n(1));function d(g){var y="["+g.constructor.name;return g.message&&(y+=": "+g.message),g.statusCode&&(y+="; statusCode="+g.statusCode),g.code&&(y+="; code="+g.code),g.cause&&(y+="; cause="+h.inspectError(g.cause)),g.href&&!(g.message&&g.message.indexOf("help.ably.io")>-1)&&(y+="; see "+g.href+" "),y+="]",y}var f=function(g){l.__extends(y,g);function y(_,b,S,E){var T=g.call(this,_)||this;return typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(T,y.prototype),T.code=b,T.statusCode=S,T.cause=E,T}return y.prototype.toString=function(){return d(this)},y.fromValues=function(_){var b=_,S=b.message,E=b.code,T=b.statusCode;if(typeof S!="string"||typeof E!="number"||typeof T!="number")throw new Error("ErrorInfo.fromValues(): invalid values: "+c.default.Config.inspect(_));var A=Object.assign(new y(S,E,T),_);return A.code&&!A.href&&(A.href="https://help.ably.io/error/"+A.code),A},y}(Error);r.default=f;var m=function(g){l.__extends(y,g);function y(_,b,S,E){var T=g.call(this,_)||this;return typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(T,y.prototype),T.code=b,T.statusCode=S,T.cause=E,T}return y.prototype.toString=function(){return d(this)},y}(Error);r.PartialErrorInfo=m},function(t,r,n){(function(l,c){t.exports=c(n(6))})(this,function(l){return function(){if(typeof ArrayBuffer=="function"){var c=l,h=c.lib,d=h.WordArray,f=d.init,m=d.init=function(g){if(g instanceof ArrayBuffer&&(g=new Uint8Array(g)),(g instanceof Int8Array||typeof Uint8ClampedArray<"u"&&g instanceof Uint8ClampedArray||g instanceof Int16Array||g instanceof Uint16Array||g instanceof Int32Array||g instanceof Uint32Array||g instanceof Float32Array||g instanceof Float64Array)&&(g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength)),g instanceof Uint8Array){for(var y=g.byteLength,_=[],b=0;b<y;b++)_[b>>>2]|=g[b]<<24-b%4*8;f.call(this,_,y)}else f.apply(this,arguments)};m.prototype=d}}(),l.lib.WordArray})},function(t,r,n){(function(l){(function(c,h){t.exports=h()})(this,function(){var c=c||function(h,d){var f;if(typeof window<"u"&&window.crypto&&(f=window.crypto),!f&&typeof window<"u"&&window.msCrypto&&(f=window.msCrypto),!f&&typeof l<"u"&&l.crypto&&(f=l.crypto),!f)try{f=n(44)}catch{}var m=function(){if(f){if(typeof f.getRandomValues=="function")try{return f.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof f.randomBytes=="function")try{return f.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},g=Object.create||function(){function D(){}return function(L){var N;return D.prototype=L,N=new D,D.prototype=null,N}}(),y={},_=y.lib={},b=_.Base=function(){return{extend:function(D){var L=g(this);return D&&L.mixIn(D),(!L.hasOwnProperty("init")||this.init===L.init)&&(L.init=function(){L.$super.init.apply(this,arguments)}),L.init.prototype=L,L.$super=this,L},create:function(){var D=this.extend();return D.init.apply(D,arguments),D},init:function(){},mixIn:function(D){for(var L in D)D.hasOwnProperty(L)&&(this[L]=D[L]);D.hasOwnProperty("toString")&&(this.toString=D.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),S=_.WordArray=b.extend({init:function(D,L){D=this.words=D||[],L!=d?this.sigBytes=L:this.sigBytes=D.length*4},toString:function(D){return(D||T).stringify(this)},concat:function(D){var L=this.words,N=D.words,U=this.sigBytes,F=D.sigBytes;if(this.clamp(),U%4)for(var z=0;z<F;z++){var G=N[z>>>2]>>>24-z%4*8&255;L[U+z>>>2]|=G<<24-(U+z)%4*8}else for(var z=0;z<F;z+=4)L[U+z>>>2]=N[z>>>2];return this.sigBytes+=F,this},clamp:function(){var D=this.words,L=this.sigBytes;D[L>>>2]&=4294967295<<32-L%4*8,D.length=h.ceil(L/4)},clone:function(){var D=b.clone.call(this);return D.words=this.words.slice(0),D},random:function(D){for(var L=[],N=0;N<D;N+=4)L.push(m());return new S.init(L,D)}}),E=y.enc={},T=E.Hex={stringify:function(D){for(var L=D.words,N=D.sigBytes,U=[],F=0;F<N;F++){var z=L[F>>>2]>>>24-F%4*8&255;U.push((z>>>4).toString(16)),U.push((z&15).toString(16))}return U.join("")},parse:function(D){for(var L=D.length,N=[],U=0;U<L;U+=2)N[U>>>3]|=parseInt(D.substr(U,2),16)<<24-U%8*4;return new S.init(N,L/2)}},A=E.Latin1={stringify:function(D){for(var L=D.words,N=D.sigBytes,U=[],F=0;F<N;F++){var z=L[F>>>2]>>>24-F%4*8&255;U.push(String.fromCharCode(z))}return U.join("")},parse:function(D){for(var L=D.length,N=[],U=0;U<L;U++)N[U>>>2]|=(D.charCodeAt(U)&255)<<24-U%4*8;return new S.init(N,L)}},P=E.Utf8={stringify:function(D){try{return decodeURIComponent(escape(A.stringify(D)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(D){return A.parse(unescape(encodeURIComponent(D)))}},O=_.BufferedBlockAlgorithm=b.extend({reset:function(){this._data=new S.init,this._nDataBytes=0},_append:function(D){typeof D=="string"&&(D=P.parse(D)),this._data.concat(D),this._nDataBytes+=D.sigBytes},_process:function(D){var L,N=this._data,U=N.words,F=N.sigBytes,z=this.blockSize,G=z*4,J=F/G;D?J=h.ceil(J):J=h.max((J|0)-this._minBufferSize,0);var Z=J*z,q=h.min(Z*4,F);if(Z){for(var $=0;$<Z;$+=z)this._doProcessBlock(U,$);L=U.splice(0,Z),N.sigBytes-=q}return new S.init(L,q)},clone:function(){var D=b.clone.call(this);return D._data=this._data.clone(),D},_minBufferSize:0});_.Hasher=O.extend({cfg:b.extend(),init:function(D){this.cfg=this.cfg.extend(D),this.reset()},reset:function(){O.reset.call(this),this._doReset()},update:function(D){return this._append(D),this._process(),this},finalize:function(D){D&&this._append(D);var L=this._doFinalize();return L},blockSize:16,_createHelper:function(D){return function(L,N){return new D.init(N).finalize(L)}},_createHmacHelper:function(D){return function(L,N){return new R.HMAC.init(D,N).finalize(L)}}});var R=y.algo={};return y}(Math);return c})}).call(this,n(13))},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=n(0),c=l.__importStar(n(1)),h=l.__importDefault(n(2)),d=l.__importDefault(n(3));function f(y,_,b){try{_.apply(y,b)}catch(S){h.default.logAction(h.default.LOG_ERROR,"EventEmitter.emit()","Unexpected listener exception: "+S+"; stack = "+(S&&S.stack))}}function m(y,_,b){for(var S,E,T,A=0;A<y.length;A++)if(S=y[A],b&&(S=S[b]),c.isArray(S)){for(;(E=c.arrIndexOf(S,_))!==-1;)S.splice(E,1);b&&S.length===0&&delete y[A][b]}else if(c.isObject(S))for(T in S)Object.prototype.hasOwnProperty.call(S,T)&&c.isArray(S[T])&&m([S],_,T)}var g=function(){function y(){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null)}return y.prototype.on=function(){for(var _=this,b=[],S=0;S<arguments.length;S++)b[S]=arguments[S];if(b.length===1){var E=b[0];if(typeof E=="function")this.any.push(E);else throw new Error("EventListener.on(): Invalid arguments: "+d.default.Config.inspect(b))}if(b.length===2){var T=b[0],A=b[1];if(typeof A!="function")throw new Error("EventListener.on(): Invalid arguments: "+d.default.Config.inspect(b));if(c.isEmptyArg(T))this.any.push(A);else if(c.isArray(T))T.forEach(function(O){_.on(O,A)});else{if(typeof T!="string")throw new Error("EventListener.on(): Invalid arguments: "+d.default.Config.inspect(b));var P=this.events[T]||(this.events[T]=[]);P.push(A)}}},y.prototype.off=function(){for(var _,b=this,S=[],E=0;E<arguments.length;E++)S[E]=arguments[E];if(S.length==0||c.isEmptyArg(S[0])&&c.isEmptyArg(S[1])){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null);return}var T=S[0],A=S[1],P=null,O=null;if(S.length===1||!A)typeof T=="function"?P=T:O=T;else{if(typeof A!="function")throw new Error("EventEmitter.off(): invalid arguments:"+d.default.Config.inspect(S));_=[T,A],O=_[0],P=_[1]}if(P&&c.isEmptyArg(O)){m([this.any,this.events,this.anyOnce,this.eventsOnce],P);return}if(c.isArray(O)){O.forEach(function(R){b.off(R,P)});return}if(typeof O!="string")throw new Error("EventEmitter.off(): invalid arguments:"+d.default.Config.inspect(S));P?m([this.events,this.eventsOnce],P,O):(delete this.events[O],delete this.eventsOnce[O])},y.prototype.listeners=function(_){if(_){var b=this.events[_]||[];return this.eventsOnce[_]&&Array.prototype.push.apply(b,this.eventsOnce[_]),b.length?b:null}return this.any.length?this.any:null},y.prototype.emit=function(_){for(var b=[],S=1;S<arguments.length;S++)b[S-1]=arguments[S];var E={event:_},T=[];this.anyOnce.length&&(Array.prototype.push.apply(T,this.anyOnce),this.anyOnce=[]),this.any.length&&Array.prototype.push.apply(T,this.any);var A=this.eventsOnce[_];A&&(Array.prototype.push.apply(T,A),delete this.eventsOnce[_]);var P=this.events[_];P&&Array.prototype.push.apply(T,P),c.arrForEach(T,function(O){f(E,O,b)})},y.prototype.once=function(){for(var _=this,b=[],S=0;S<arguments.length;S++)b[S]=arguments[S];var E=b.length;if((E===0||E===1&&typeof b[0]!="function")&&d.default.Config.Promise){var T=b[0];return new d.default.Config.Promise(function(L){_.once(T,L)})}var A=b[0],P=b[1];if(b.length===1&&typeof A=="function")this.anyOnce.push(A);else if(c.isEmptyArg(A)){if(typeof P!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+d.default.Config.inspect(b));this.anyOnce.push(P)}else if(c.isArray(A)){var O=this,R=function(){var L=Array.prototype.slice.call(arguments);if(c.arrForEach(A,function(N){O.off(N,R)}),typeof P!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+d.default.Config.inspect(b));P.apply(this,L)};c.arrForEach(A,function(L){O.on(L,R)})}else{if(typeof A!="string")throw new Error("EventEmitter.once(): Invalid arguments:"+d.default.Config.inspect(b));var D=this.eventsOnce[A]||(this.eventsOnce[A]=[]);if(P){if(typeof P!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+d.default.Config.inspect(b));D.push(P)}}},y.prototype.whenState=function(_,b,S){for(var E=this,T=[],A=3;A<arguments.length;A++)T[A-3]=arguments[A];var P={event:_};if(typeof _!="string"||typeof b!="string")throw"whenState requires a valid event String argument";if(typeof S!="function"&&d.default.Config.Promise)return new d.default.Config.Promise(function(O){y.prototype.whenState.apply(E,[_,b,O].concat(T))});_===b?f(P,S,T):this.once(_,S)},y}();r.default=g},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0}),r.getDefaults=r.normaliseOptions=r.objectifyOptions=r.getAgentString=r.getHosts=r.getFallbackHosts=r.environmentFallbackHosts=r.getHttpScheme=r.getPort=r.getHost=void 0;var l=n(0),c=l.__importDefault(n(3)),h=l.__importStar(n(1)),d=l.__importDefault(n(2)),f=l.__importDefault(n(4)),m=n(43),g="ably-js/"+m.version,y={ENVIRONMENT:"",REST_HOST:"rest.ably.io",REALTIME_HOST:"realtime.ably.io",FALLBACK_HOSTS:["A.ably-realtime.com","B.ably-realtime.com","C.ably-realtime.com","D.ably-realtime.com","E.ably-realtime.com"],PORT:80,TLS_PORT:443,TIMEOUTS:{disconnectedRetryTimeout:15e3,suspendedRetryTimeout:3e4,httpRequestTimeout:15e3,channelRetryTimeout:15e3,fallbackRetryTimeout:6e5,connectionStateTtl:12e4,realtimeRequestTimeout:1e4,recvTimeout:9e4,preferenceConnectTimeout:6e3,parallelUpgradeDelay:6e3},httpMaxRetryCount:3,maxMessageSize:65536,version:m.version,protocolVersion:2,agent:g,getHost:_,getPort:b,getHttpScheme:S,environmentFallbackHosts:E,getFallbackHosts:T,getHosts:A,checkHost:P,objectifyOptions:L,normaliseOptions:N};function _(F,z,G){return G?z=z==F.restHost&&F.realtimeHost||z||F.realtimeHost:z=z||F.restHost,z}r.getHost=_;function b(F,z){return z||F.tls?F.tlsPort:F.port}r.getPort=b;function S(F){return F.tls?"https://":"http://"}r.getHttpScheme=S;function E(F){return[F+"-a-fallback.ably-realtime.com",F+"-b-fallback.ably-realtime.com",F+"-c-fallback.ably-realtime.com",F+"-d-fallback.ably-realtime.com",F+"-e-fallback.ably-realtime.com"]}r.environmentFallbackHosts=E;function T(F){var z=F.fallbackHosts,G=typeof F.httpMaxRetryCount<"u"?F.httpMaxRetryCount:y.httpMaxRetryCount;return z?h.arrChooseN(z,G):[]}r.getFallbackHosts=T;function A(F){return[F.restHost].concat(T(F))}r.getHosts=A;function P(F){if(typeof F!="string")throw new f.default("host must be a string; was a "+typeof F,4e4,400);if(!F.length)throw new f.default("host must not be zero-length",4e4,400)}function O(F,z,G){return F.realtimeHost?F.realtimeHost:F.restHost?(d.default.logAction(d.default.LOG_MINOR,"Defaults.normaliseOptions",'restHost is set to "'+F.restHost+'" but realtimeHost is not set, so setting realtimeHost to "'+F.restHost+'" too. If this is not what you want, please set realtimeHost explicitly.'),F.restHost):z?y.REALTIME_HOST:G+"-"+y.REALTIME_HOST}function R(F){var z={};for(var G in y.TIMEOUTS)z[G]=F[G]||y.TIMEOUTS[G];return z}function D(F){var z=y.agent;if(F.agents)for(var G in F.agents)z+=" "+G+"/"+F.agents[G];return z}r.getAgentString=D;function L(F){return typeof F=="string"?F.indexOf(":")==-1?{token:F}:{key:F}:F}r.objectifyOptions=L;function N(F){if(F.host&&(d.default.deprecated("host","restHost"),F.restHost=F.host),F.wsHost&&(d.default.deprecated("wsHost","realtimeHost"),F.realtimeHost=F.wsHost),F.queueEvents&&(d.default.deprecated("queueEvents","queueMessages"),F.queueMessages=F.queueEvents),F.fallbackHostsUseDefault){if(F.fallbackHosts){var z="fallbackHosts and fallbackHostsUseDefault cannot both be set";throw d.default.logAction(d.default.LOG_ERROR,"Defaults.normaliseOptions",z),new f.default(z,4e4,400)}if(F.port||F.tlsPort){var z="fallbackHostsUseDefault cannot be set when port or tlsPort are set";throw d.default.logAction(d.default.LOG_ERROR,"Defaults.normaliseOptions",z),new f.default(z,4e4,400)}F.environment?d.default.deprecatedWithMsg("fallbackHostsUseDefault","There is no longer a need to set this when the environment option is also set since the library will now generate the correct fallback hosts using the environment option."):d.default.deprecated("fallbackHostsUseDefault","fallbackHosts: Ably.Defaults.FALLBACK_HOSTS"),F.fallbackHosts=y.FALLBACK_HOSTS}F.recover===!0&&(d.default.deprecated("{recover: true}","{recover: function(lastConnectionDetails, cb) { cb(true); }}"),F.recover=function(de,ee){ee(!0)}),typeof F.recover=="function"&&F.closeOnUnload===!0&&(d.default.logAction(d.default.LOG_ERROR,"Defaults.normaliseOptions","closeOnUnload was true and a session recovery function was set - these are mutually exclusive, so unsetting the latter"),F.recover=void 0),"closeOnUnload"in F||(F.closeOnUnload=!F.recover),F.transports&&h.arrIn(F.transports,"xhr")&&(d.default.deprecated('transports: ["xhr"]','transports: ["xhr_streaming"]'),h.arrDeleteValue(F.transports,"xhr"),F.transports.push("xhr_streaming")),"queueMessages"in F||(F.queueMessages=!0);var G=F.environment&&String(F.environment).toLowerCase()||y.ENVIRONMENT,J=!G||G==="production";!F.fallbackHosts&&!F.restHost&&!F.realtimeHost&&!F.port&&!F.tlsPort&&(F.fallbackHosts=J?y.FALLBACK_HOSTS:E(G));var Z=F.restHost||(J?y.REST_HOST:G+"-"+y.REST_HOST),q=O(F,J,G);h.arrForEach((F.fallbackHosts||[]).concat(Z,q),P),F.port=F.port||y.PORT,F.tlsPort=F.tlsPort||y.TLS_PORT,"tls"in F||(F.tls=!0);var $=R(F);if("useBinaryProtocol"in F?F.useBinaryProtocol=c.default.Config.supportsBinary&&F.useBinaryProtocol:F.useBinaryProtocol=c.default.Config.preferBinary,F.clientId){var H=F.headers=F.headers||{};H["X-Ably-ClientId"]=c.default.BufferUtils.base64Encode(c.default.BufferUtils.utf8Encode(F.clientId))}"idempotentRestPublishing"in F||(F.idempotentRestPublishing=!0),F.promises&&!c.default.Config.Promise&&(d.default.logAction(d.default.LOG_ERROR,"Defaults.normaliseOptions","{promises: true} was specified, but no Promise constructor found; disabling promises"),F.promises=!1);var X=null,re=F.connectivityCheckUrl;if(F.connectivityCheckUrl){var ae=F.connectivityCheckUrl.split("?"),he=ae[0],pe=ae[1];X=pe?h.parseQueryString(pe):{},he.indexOf("://")===-1&&(he="https://"+he),re=he}return l.__assign(l.__assign({},F),{useBinaryProtocol:"useBinaryProtocol"in F?c.default.Config.supportsBinary&&F.useBinaryProtocol:c.default.Config.preferBinary,realtimeHost:q,restHost:Z,maxMessageSize:F.maxMessageSize||y.maxMessageSize,timeouts:$,connectivityCheckParams:X,connectivityCheckUrl:re})}r.normaliseOptions=N,r.default=y;function U(F){return Object.assign(y,F)}r.getDefaults=U},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=n(0),c=l.__importDefault(n(3)),h=l.__importDefault(n(2)),d=l.__importDefault(n(4)),f=l.__importStar(n(1));function m(b){return!b||!b.channelOptions?{channelOptions:b,plugins:{},baseEncodedPreviousPayload:void 0}:b}function g(b){if(b&&b.cipher){if(!c.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var S=c.default.Crypto.getCipher(b.cipher);return{cipher:S.cipherParams,channelCipher:S.cipher}}return b??{}}function y(b){var S=0;return b.name&&(S+=b.name.length),b.clientId&&(S+=b.clientId.length),b.extras&&(S+=JSON.stringify(b.extras).length),b.data&&(S+=f.dataSizeBytes(b.data)),S}var _=function(){function b(){}return b.prototype.toJSON=function(){var S=this.encoding,E=this.data;return E&&c.default.BufferUtils.isBuffer(E)&&(arguments.length>0?(S=S?S+"/base64":"base64",E=c.default.BufferUtils.base64Encode(E)):E=c.default.BufferUtils.toBuffer(E)),{name:this.name,id:this.id,clientId:this.clientId,connectionId:this.connectionId,connectionKey:this.connectionKey,extras:this.extras,encoding:S,data:E}},b.prototype.toString=function(){var S="[Message";return this.name&&(S+="; name="+this.name),this.id&&(S+="; id="+this.id),this.timestamp&&(S+="; timestamp="+this.timestamp),this.clientId&&(S+="; clientId="+this.clientId),this.connectionId&&(S+="; connectionId="+this.connectionId),this.encoding&&(S+="; encoding="+this.encoding),this.extras&&(S+="; extras ="+JSON.stringify(this.extras)),this.data&&(typeof this.data=="string"?S+="; data="+this.data:c.default.BufferUtils.isBuffer(this.data)?S+="; data (buffer)="+c.default.BufferUtils.base64Encode(this.data):S+="; data (json)="+JSON.stringify(this.data)),this.extras&&(S+="; extras="+JSON.stringify(this.extras)),S+="]",S},b.encrypt=function(S,E,T){var A=S.data,P=S.encoding,O=E.channelCipher;P=P?P+"/":"",c.default.BufferUtils.isBuffer(A)||(A=c.default.BufferUtils.utf8Encode(String(A)),P=P+"utf-8/"),O.encrypt(A,function(R,D){if(R){T(R);return}S.data=D,S.encoding=P+"cipher+"+O.algorithm,T(null,S)})},b.encode=function(S,E,T){var A=S.data,P=typeof A=="string"||c.default.BufferUtils.isBuffer(A)||A===null||A===void 0;if(!P)if(f.isObject(A)||f.isArray(A))S.data=JSON.stringify(A),S.encoding=S.encoding?S.encoding+"/json":"json";else throw new d.default("Data type is unsupported",40013,400);E!=null&&E.cipher?b.encrypt(S,E,T):T(null,S)},b.encodeArray=function(S,E,T){for(var A=0,P=0;P<S.length;P++)b.encode(S[P],E,function(O){if(O){T(O);return}A++,A==S.length&&T(null,S)})},b.decode=function(S,E){var T=m(E),A=S.data,P=S.encoding;if(P){var O=P.split("/"),R=void 0,D=O.length,L=S.data,N="";try{for(;(R=D)>0;){var U=O[--D].match(/([-\w]+)(\+([\w-]+))?/);if(!U)break;switch(N=U[1],N){case"base64":L=c.default.BufferUtils.base64Decode(String(L)),R==O.length&&(A=L);continue;case"utf-8":L=c.default.BufferUtils.utf8Decode(L);continue;case"json":L=JSON.parse(L);continue;case"cipher":if(T.channelOptions!=null&&T.channelOptions.cipher&&T.channelOptions.channelCipher){var F=U[3],z=T.channelOptions.channelCipher;if(F!=z.algorithm)throw new Error("Unable to decrypt message with given cipher; incompatible cipher params");L=z.decrypt(L);continue}else throw new Error("Unable to decrypt message; not an encrypted channel");case"vcdiff":if(!T.plugins||!T.plugins.vcdiff)throw new d.default("Missing Vcdiff decoder (https://github.com/ably-forks/vcdiff-decoder)",40019,400);if(typeof Uint8Array>"u")throw new d.default("Delta decoding not supported on this browser (need ArrayBuffer & Uint8Array)",40020,400);try{var G=T.baseEncodedPreviousPayload;typeof G=="string"&&(G=c.default.BufferUtils.utf8Encode(G)),G=c.default.BufferUtils.toBuffer(G),L=c.default.BufferUtils.toBuffer(L),L=c.default.BufferUtils.typedArrayToBuffer(T.plugins.vcdiff.decode(L,G)),A=L}catch(Z){throw new d.default("Vcdiff delta decode failed with "+Z,40018,400)}continue;default:throw new Error("Unknown encoding")}}}catch(Z){var J=Z;throw new d.default("Error processing the "+N+" encoding, decoder returned ‘"+J.message+"’",J.code||40013,400)}finally{S.encoding=R<=0?null:O.slice(0,R).join("/"),S.data=L}}T.baseEncodedPreviousPayload=A},b.fromResponseBody=function(S,E,T){T&&(S=f.decodeBody(S,T));for(var A=0;A<S.length;A++){var P=S[A]=b.fromValues(S[A]);try{b.decode(P,E)}catch(O){h.default.logAction(h.default.LOG_ERROR,"Message.fromResponseBody()",O.toString())}}return S},b.fromValues=function(S){return Object.assign(new b,S)},b.fromValuesArray=function(S){for(var E=S.length,T=new Array(E),A=0;A<E;A++)T[A]=b.fromValues(S[A]);return T},b.fromEncoded=function(S,E){var T=b.fromValues(S),A=g(E??null);try{b.decode(T,A)}catch(P){h.default.logAction(h.default.LOG_ERROR,"Message.fromEncoded()",P.toString())}return T},b.fromEncodedArray=function(S,E){return S.map(function(T){return b.fromEncoded(T,E)})},b.getMessagesSize=function(S){for(var E,T=0,A=0;A<S.length;A++)E=S[A],T+=E.size||(E.size=y(E));return T},b.serialize=f.encodeBody,b}();r.default=_},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=n(0),c=l.__importStar(n(1)),h=l.__importDefault(n(4)),d=l.__importDefault(n(9)),f=l.__importDefault(n(15)),m={HEARTBEAT:0,ACK:1,NACK:2,CONNECT:3,CONNECTED:4,DISCONNECT:5,DISCONNECTED:6,CLOSE:7,CLOSED:8,ERROR:9,ATTACH:10,ATTACHED:11,DETACH:12,DETACHED:13,PRESENCE:14,MESSAGE:15,SYNC:16,AUTH:17,ACTIVATE:18},g=[];Object.keys(m).forEach(function(T){g[m[T]]=T});var y={HAS_PRESENCE:1,HAS_BACKLOG:2,RESUMED:4,TRANSIENT:16,ATTACH_RESUME:32,PRESENCE:65536,PUBLISH:1<<17,SUBSCRIBE:1<<18,PRESENCE_SUBSCRIBE:1<<19},_=Object.keys(y);y.MODE_ALL=y.PRESENCE|y.PUBLISH|y.SUBSCRIBE|y.PRESENCE_SUBSCRIBE;function b(T){var A=[];if(T)for(var P=0;P<T.length;P++)A.push(T[P].toString());return"[ "+A.join(", ")+" ]"}var S="id channel channelSerial connectionId count msgSerial timestamp".split(" "),E=function(){function T(){var A=this;this.hasFlag=function(P){return(A.flags&y[P])>0}}return T.prototype.setFlag=function(A){return this.flags=this.flags|y[A]},T.prototype.getMode=function(){return this.flags&&this.flags&y.MODE_ALL},T.prototype.encodeModesToFlags=function(A){var P=this;A.forEach(function(O){return P.setFlag(O)})},T.prototype.decodeModesFromFlags=function(){var A=this,P=[];return T.channelModes.forEach(function(O){A.hasFlag(O)&&P.push(O)}),P.length>0?P:void 0},T.fromValues=function(A){return Object.assign(new T,A)},T.Action=m,T.channelModes=["PRESENCE","PUBLISH","SUBSCRIBE","PRESENCE_SUBSCRIBE"],T.ActionName=g,T.serialize=c.encodeBody,T.deserialize=function(A,P){var O=c.decodeBody(A,P);return T.fromDeserialized(O)},T.fromDeserialized=function(A){var P=A.error;P&&(A.error=h.default.fromValues(P));var O=A.messages;if(O)for(var R=0;R<O.length;R++)O[R]=d.default.fromValues(O[R]);var D=A.presence;if(D)for(var R=0;R<D.length;R++)D[R]=f.default.fromValues(D[R],!0);return Object.assign(new T,A)},T.stringify=function(A){var P="[ProtocolMessage";A.action!==void 0&&(P+="; action="+T.ActionName[A.action]||!1);for(var O,R=0;R<S.length;R++)O=S[R],A[O]!==void 0&&(P+="; "+O+"="+A[O]);if(A.messages&&(P+="; messages="+b(d.default.fromValuesArray(A.messages))),A.presence&&(P+="; presence="+b(f.default.fromValuesArray(A.presence))),A.error&&(P+="; error="+h.default.fromValues(A.error).toString()),A.auth&&A.auth.accessToken&&(P+="; token="+A.auth.accessToken),A.flags&&(P+="; flags="+_.filter(A.hasFlag).join(",")),A.params){var D="";c.forInOwnNonNullProperties(A.params,function(L){D.length>0&&(D+="; "),D+=L+"="+A.params[L]}),D.length>0&&(P+="; params=["+D+"]")}return P+="]",P},T}();r.default=E},function(t,r,n){(function(l,c){t.exports=c(n(6))})(this,function(l){return function(){var c=l,h=c.lib,d=h.WordArray,f=c.enc;f.Base64={stringify:function(g){var y=g.words,_=g.sigBytes,b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";g.clamp();for(var S=[],E=0;E<_;E+=3)for(var T=y[E>>>2]>>>24-E%4*8&255,A=y[E+1>>>2]>>>24-(E+1)%4*8&255,P=y[E+2>>>2]>>>24-(E+2)%4*8&255,O=T<<16|A<<8|P,R=0;R<4&&E+R*.75<_;R++)S.push(b.charAt(O>>>6*(3-R)&63));var D=b.charAt(64);if(D)for(;S.length%4;)S.push(D);return S.join("")},parse:function(g){var y=g.length,_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",b=this._reverseMap;if(!b){b=this._reverseMap=[];for(var S=0;S<_.length;S++)b[_.charCodeAt(S)]=S}var E=_.charAt(64);if(E){var T=g.indexOf(E);T!==-1&&(y=T)}return m(g,y,b)}};function m(g,y,_){for(var b=[],S=0,E=0;E<y;E++)if(E%4){var T=_[g.charCodeAt(E-1)]<<E%4*2,A=_[g.charCodeAt(E)]>>>6-E%4*2,P=T|A;b[S>>>2]|=P<<24-S%4*8,S++}return d.create(b,S)}}(),l.enc.Base64})},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=n(0),c=l.__importStar(n(1)),h=l.__importDefault(n(10)),d=l.__importDefault(n(26)),f=l.__importDefault(n(2)),m=l.__importDefault(n(8)),g=l.__importDefault(n(20)),y=l.__importDefault(n(17)),_=l.__importDefault(n(4)),b=l.__importDefault(n(21)),S=l.__importDefault(n(3));function E(P){var O=[80015,80017,80030];return P.code?y.default.isTokenErr(P)?!1:c.arrIn(O,P.code)?!0:P.code>=4e4&&P.code<5e4:!1}function T(P){return E(P)?[h.default.fromValues({action:h.default.Action.ERROR,error:P})]:[h.default.fromValues({action:h.default.Action.DISCONNECTED,error:P})]}var A=function(P){l.__extends(O,P);function O(R,D,L){var N=P.call(this,R,D,L,!0)||this;return N.onAuthUpdated=function(U){N.authParams={access_token:U.token}},N.stream="stream"in L?L.stream:!0,N.sendRequest=null,N.recvRequest=null,N.pendingCallback=null,N.pendingItems=null,N}return O.prototype.connect=function(){var R=this;f.default.logAction(f.default.LOG_MINOR,"CometTransport.connect()","starting"),d.default.prototype.connect.call(this);var D=this.params,L=D.options,N=m.default.getHost(L,D.host),U=m.default.getPort(L),F=L.tls?"https://":"http://";this.baseUri=F+N+":"+U+"/comet/";var z=this.baseUri+"connect";f.default.logAction(f.default.LOG_MINOR,"CometTransport.connect()","uri: "+z),this.auth.getAuthParams(function(G,J){if(G){R.disconnect(G);return}if(!R.isDisposed){R.authParams=J;var Z=R.params.getConnectParams(J);"stream"in Z&&(R.stream=Z.stream),f.default.logAction(f.default.LOG_MINOR,"CometTransport.connect()","connectParams:"+c.toQueryString(Z));var q=!1,$=R.recvRequest=R.createRequest(z,null,Z,null,R.stream?b.default.REQ_RECV_STREAM:b.default.REQ_RECV);$.on("data",function(H){R.recvRequest&&(q||(q=!0,R.emit("preconnect")),R.onData(H))}),$.on("complete",function(H){if(R.recvRequest||(H=H||new _.default("Request cancelled",80003,400)),R.recvRequest=null,!q&&!H&&(q=!0,R.emit("preconnect")),R.onActivity(),H){H.code?R.onData(T(H)):R.disconnect(H);return}S.default.Config.nextTick(function(){R.recv()})}),$.exec()}})},O.prototype.requestClose=function(){f.default.logAction(f.default.LOG_MINOR,"CometTransport.requestClose()"),this._requestCloseOrDisconnect(!0)},O.prototype.requestDisconnect=function(){f.default.logAction(f.default.LOG_MINOR,"CometTransport.requestDisconnect()"),this._requestCloseOrDisconnect(!1)},O.prototype._requestCloseOrDisconnect=function(R){var D=this,L=R?this.closeUri:this.disconnectUri;if(L){var N=this.createRequest(L,null,this.authParams,null,b.default.REQ_SEND);N.on("complete",function(U){U&&(f.default.logAction(f.default.LOG_ERROR,"CometTransport.request"+(R?"Close()":"Disconnect()"),"request returned err = "+c.inspectError(U)),D.finish("disconnected",U))}),N.exec()}},O.prototype.dispose=function(){var R=this;f.default.logAction(f.default.LOG_MINOR,"CometTransport.dispose()",""),this.isDisposed||(this.isDisposed=!0,this.recvRequest&&(f.default.logAction(f.default.LOG_MINOR,"CometTransport.dispose()","aborting recv request"),this.recvRequest.abort(),this.recvRequest=null),this.finish("disconnected",g.default.disconnected()),S.default.Config.nextTick(function(){R.emit("disposed")}))},O.prototype.onConnect=function(R){var D;if(!this.isDisposed){var L=(D=R.connectionDetails)===null||D===void 0?void 0:D.connectionKey;d.default.prototype.onConnect.call(this,R);var N=this.baseUri+L;f.default.logAction(f.default.LOG_MICRO,"CometTransport.onConnect()","baseUri = "+N),this.sendUri=N+"/send",this.recvUri=N+"/recv",this.closeUri=N+"/close",this.disconnectUri=N+"/disconnect"}},O.prototype.send=function(R){if(this.sendRequest){this.pendingItems=this.pendingItems||[],this.pendingItems.push(R);return}var D=this.pendingItems||[];D.push(R),this.pendingItems=null,this.sendItems(D)},O.prototype.sendAnyPending=function(){var R=this.pendingItems;R&&(this.pendingItems=null,this.sendItems(R))},O.prototype.sendItems=function(R){var D=this,L=this.sendRequest=this.createRequest(this.sendUri,null,this.authParams,this.encodeRequest(R),b.default.REQ_SEND);L.on("complete",function(N,U){if(N&&f.default.logAction(f.default.LOG_ERROR,"CometTransport.sendItems()","on complete: err = "+c.inspectError(N)),D.sendRequest=null,N){N.code?D.onData(T(N)):D.disconnect(N);return}U&&D.onData(U),D.pendingItems&&S.default.Config.nextTick(function(){D.sendRequest||D.sendAnyPending()})}),L.exec()},O.prototype.recv=function(){var R=this;if(!this.recvRequest&&this.isConnected){var D=this.recvRequest=this.createRequest(this.recvUri,null,this.authParams,null,this.stream?b.default.REQ_RECV_STREAM:b.default.REQ_RECV_POLL);D.on("data",function(L){R.onData(L)}),D.on("complete",function(L){if(R.recvRequest=null,R.onActivity(),L){L.code?R.onData(T(L)):R.disconnect(L);return}S.default.Config.nextTick(function(){R.recv()})}),D.exec()}},O.prototype.onData=function(R){try{var D=this.decodeResponse(R);if(D&&D.length)for(var L=0;L<D.length;L++)this.onProtocolMessage(h.default.fromDeserialized(D[L]))}catch(N){f.default.logAction(f.default.LOG_ERROR,"CometTransport.onData()","Unexpected exception handing channel event: "+N.stack)}},O.prototype.encodeRequest=function(R){return JSON.stringify(R)},O.prototype.decodeResponse=function(R){return typeof R=="string"?JSON.parse(R):R},O}(d.default);r.default=A},function(t,r){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch{typeof window=="object"&&(n=window)}t.exports=n},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=n(0),c=l.__importDefault(n(3)),h=l.__importStar(n(1)),d=l.__importDefault(n(2)),f=l.__importDefault(n(17)),m=l.__importDefault(n(18)),g=n(4);function y(A,P,O,R,D){A.http.supportsAuthHeaders?A.auth.getAuthHeaders(function(L,N){L?R(L):D(h.mixin(N,P),O)}):A.auth.getAuthParams(function(L,N){L?R(L):D(P,h.mixin(N,O))})}function _(A,P){return function(O,R,D,L,N){if(O&&!R){A(O);return}if(!L)try{R=h.decodeBody(R,P)}catch(Z){h.isErrorInfoOrPartialErrorInfo(Z)?A(Z):A(new g.PartialErrorInfo(h.inspectError(Z),null));return}if(!R){A(new g.PartialErrorInfo("unenvelope(): Response body is missing",null));return}var U=R,F=U.statusCode,z=U.response,G=U.headers;if(F===void 0){A(O,R,D,!0,N);return}if(F<200||F>=300){var J=z&&z.error||O;J||(J=new Error("Error in unenveloping "+R),J.statusCode=F),A(J,z,G,!0,F);return}A(O,z,G,!0,F)}}function b(A){var P=[];if(A)for(var O in A)P.push(O+"="+A[O]);return P.join("&")}function S(A,P){return A+(P?"?":"")+b(P)}function E(A,P,O,R){return function(D,L,N,U,F){D?d.default.logAction(d.default.LOG_MICRO,"Resource."+P+"()","Received Error; "+S(O,R)+"; Error: "+h.inspectError(D)):d.default.logAction(d.default.LOG_MICRO,"Resource."+P+"()","Received; "+S(O,R)+"; Headers: "+b(N)+"; StatusCode: "+F+"; Body: "+(c.default.BufferUtils.isBuffer(L)?L.toString():L)),A&&A(D,L,N,U,F)}}var T=function(){function A(){}return A.get=function(P,O,R,D,L,N){A.do(m.default.Get,P,O,null,R,D,L,N)},A.delete=function(P,O,R,D,L,N){A.do(m.default.Delete,P,O,null,R,D,L,N)},A.post=function(P,O,R,D,L,N,U){A.do(m.default.Post,P,O,R,D,L,N,U)},A.patch=function(P,O,R,D,L,N,U){A.do(m.default.Patch,P,O,R,D,L,N,U)},A.put=function(P,O,R,D,L,N,U){A.do(m.default.Put,P,O,R,D,L,N,U)},A.do=function(P,O,R,D,L,N,U,F){d.default.shouldLog(d.default.LOG_MICRO)&&(F=E(F,P,R,N)),U&&(F=F&&_(F,U),(N=N||{}).envelope=U);function z(G,J){var Z;if(d.default.shouldLog(d.default.LOG_MICRO)&&d.default.logAction(d.default.LOG_MICRO,"Resource."+P+"()","Sending; "+S(R,J)),d.default.shouldLog(d.default.LOG_MICRO)){var q=D;if(((Z=G["content-type"])===null||Z===void 0?void 0:Z.indexOf("msgpack"))>0)try{q=c.default.Config.msgpack.decode(D)}catch($){d.default.logAction(d.default.LOG_MICRO,"Resource."+P+"()","Sending MsgPack Decoding Error: "+h.inspectError($))}d.default.logAction(d.default.LOG_MICRO,"Resource."+P+"()","Sending; "+S(R,J)+"; Body: "+q)}O.http.do(P,O,R,G,D,J,function($,H,X,re,ae){if($&&f.default.isTokenErr($)){O.auth.authorize(null,null,function(he){if(he){F(he);return}y(O,G,J,F,z)});return}F($,H,X,re,ae)})}y(O,L,N,F,z)},A}();r.default=T},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=n(0),c=l.__importDefault(n(2)),h=l.__importDefault(n(3)),d=l.__importDefault(n(9)),f=l.__importStar(n(1));function m(y){return g.Actions.indexOf(y)}var g=function(){function y(){}return y.prototype.isSynthesized=function(){return!this.id||!this.connectionId?!0:this.id.substring(this.connectionId.length,0)!==this.connectionId},y.prototype.parseId=function(){if(!this.id)throw new Error("parseId(): Presence message does not contain an id");var _=this.id.split(":");return{connectionId:_[0],msgSerial:parseInt(_[1],10),index:parseInt(_[2],10)}},y.prototype.toJSON=function(){var _=this.data,b=this.encoding;return _&&h.default.BufferUtils.isBuffer(_)&&(arguments.length>0?(b=b?b+"/base64":"base64",_=h.default.BufferUtils.base64Encode(_)):_=h.default.BufferUtils.toBuffer(_)),{id:this.id,clientId:this.clientId,action:m(this.action),data:_,encoding:b,extras:this.extras}},y.prototype.toString=function(){var _="[PresenceMessage";return _+="; action="+this.action,this.id&&(_+="; id="+this.id),this.timestamp&&(_+="; timestamp="+this.timestamp),this.clientId&&(_+="; clientId="+this.clientId),this.connectionId&&(_+="; connectionId="+this.connectionId),this.encoding&&(_+="; encoding="+this.encoding),this.data&&(typeof this.data=="string"?_+="; data="+this.data:h.default.BufferUtils.isBuffer(this.data)?_+="; data (buffer)="+h.default.BufferUtils.base64Encode(this.data):_+="; data (json)="+JSON.stringify(this.data)),this.extras&&(_+="; extras="+JSON.stringify(this.extras)),_+="]",_},y.fromResponseBody=function(_,b,S){var E=[];S&&(_=f.decodeBody(_,S));for(var T=0;T<_.length;T++){var A=E[T]=y.fromValues(_[T],!0);try{y.decode(A,b)}catch(P){c.default.logAction(c.default.LOG_ERROR,"PresenceMessage.fromResponseBody()",P.toString())}}return E},y.fromValues=function(_,b){return b&&(_.action=y.Actions[_.action]),Object.assign(new y,_)},y.fromValuesArray=function(_){for(var b=_.length,S=new Array(b),E=0;E<b;E++)S[E]=y.fromValues(_[E]);return S},y.fromEncoded=function(_,b){var S=y.fromValues(_,!0);try{y.decode(S,b??{})}catch(E){c.default.logAction(c.default.LOG_ERROR,"PresenceMessage.fromEncoded()",E.toString())}return S},y.fromEncodedArray=function(_,b){return _.map(function(S){return y.fromEncoded(S,b)})},y.fromData=function(_){return _ instanceof y?_:y.fromValues({data:_})},y.Actions=["absent","present","enter","leave","update"],y.encode=d.default.encode,y.decode=d.default.decode,y.getMessagesSize=d.default.getMessagesSize,y}();r.default=g},function(t,r,n){(function(l){Object.defineProperty(r,"__esModule",{value:!0});var c=n(0),h=c.__importStar(n(1)),d=c.__importDefault(n(7)),f=c.__importStar(n(4)),m=c.__importDefault(n(2)),g=c.__importDefault(n(8)),y=c.__importDefault(n(21)),_=c.__importDefault(n(3));function b(F,z){return h.arrIn(h.allToLowerCase(h.keysArray(z)),"x-ably-errorcode")}function S(F,z){if(b(F,z))return F.error&&f.default.fromValues(F.error)}var E=function(){},T=0,A={},P=typeof l<"u"&&l.XDomainRequest;function O(){var F=navigator.userAgent.toString().match(/MSIE\s([\d.]+)/);return F&&Number(F[1])}function R(){var F;return P&&(F=O())&&F===10}function D(F,z){return F.getResponseHeader&&F.getResponseHeader(z)}function L(F){return F.getResponseHeader&&(F.getResponseHeader("transfer-encoding")||!F.getResponseHeader("content-length"))}function N(F){for(var z=h.trim(F.getAllResponseHeaders()).split(`\r
`),G={},J=0;J<z.length;J++){var Z=z[J].split(":").map(h.trim);G[Z[0].toLowerCase()]=Z[1]}return G}var U=function(F){c.__extends(z,F);function z(G,J,Z,q,$,H,X){var re=F.call(this)||this;return Z=Z||{},Z.rnd=h.cheapRandStr(),R()&&!Z.envelope&&(Z.envelope="json"),re.uri=G+h.toQueryString(Z),re.headers=J||{},re.body=q,re.method=X?X.toUpperCase():h.isEmptyArg(q)?"GET":"POST",re.requestMode=$,re.timeouts=H,re.timedOut=!1,re.requestComplete=!1,re.id=String(++T),A[re.id]=re,re}return z.createRequest=function(G,J,Z,q,$,H,X){var re=H||g.default.TIMEOUTS;return new z(G,J,h.copy(Z),q,$,re,X)},z.prototype.complete=function(G,J,Z,q,$){this.requestComplete||(this.requestComplete=!0,!G&&J&&this.emit("data",J),this.emit("complete",G,J,Z,q,$),this.dispose())},z.prototype.abort=function(){this.dispose()},z.prototype.exec=function(){var G=this,J=this.headers,Z=this.requestMode==y.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout,q=this.timer=setTimeout(function(){G.timedOut=!0,H.abort()},Z),$=this.method,H=this.xhr=new XMLHttpRequest,X=J.accept,re=this.body,ae="text";if(X?X.indexOf("application/x-msgpack")===0&&(ae="arraybuffer"):J.accept="application/json",re){var he=J["content-type"]||(J["content-type"]="application/json");he.indexOf("application/json")>-1&&typeof re!="string"&&(re=JSON.stringify(re))}H.open($,this.uri,!0),H.responseType=ae,"authorization"in J&&(H.withCredentials=!0);for(var pe in J)H.setRequestHeader(pe,J[pe]);var de=function(Ne,Ge,Ct,it){var bt,Kt=Ge+" (event type: "+Ne.type+")";!((bt=G==null?void 0:G.xhr)===null||bt===void 0)&&bt.statusText&&(Kt+=", current statusText is "+G.xhr.statusText),m.default.logAction(m.default.LOG_ERROR,"Request.on"+Ne.type+"()",Kt),G.complete(new f.PartialErrorInfo(Kt,Ct,it))};H.onerror=function(Ne){de(Ne,"XHR error occurred",null,400)},H.onabort=function(Ne){G.timedOut?de(Ne,"Request aborted due to request timeout expiring",null,408):de(Ne,"Request cancelled",null,400)},H.ontimeout=function(Ne){de(Ne,"Request timed out",null,408)};var ee,se,Y,fe=0,me=!1,De=function(){if(clearTimeout(q),Y=se<400,se==204){G.complete(null,null,null,null,se);return}ee=G.requestMode==y.default.REQ_RECV_STREAM&&Y&&L(H)},Le=function(){var Ne;try{var Ge=D(H,"content-type"),Ct=Ge?Ge.indexOf("application/json")>=0:H.responseType=="text";if(Ct){var it=H.responseType==="arraybuffer"?_.default.BufferUtils.utf8Decode(H.response):String(H.responseText);it.length?Ne=JSON.parse(it):Ne=it,me=!0}else Ne=H.response;Ne.response!==void 0?(se=Ne.statusCode,Y=se<400,J=Ne.headers,Ne=Ne.response):J=N(H)}catch(Kt){G.complete(new f.PartialErrorInfo("Malformed response body from server: "+Kt.message,null,400));return}if(Y||h.isArray(Ne)){G.complete(null,Ne,J,me,se);return}var bt=S(Ne,J);bt||(bt=new f.PartialErrorInfo("Error response received from server: "+se+" body was: "+_.default.Config.inspect(Ne),null,se)),G.complete(bt,Ne,J,me,se)};function Ce(){for(var Ne=H.responseText,Ge=Ne.length-1,Ct,it;fe<Ge&&(Ct=Ne.indexOf(`
`,fe))>-1;)it=Ne.slice(fe,Ct),fe=Ct+1,Ae(it)}var Ae=function(Ne){try{Ne=JSON.parse(Ne)}catch(Ge){G.complete(new f.PartialErrorInfo("Malformed response body from server: "+Ge.message,null,400));return}G.emit("data",Ne)},Ue=function(){Ce(),G.streamComplete=!0,_.default.Config.nextTick(function(){G.complete()})};H.onreadystatechange=function(){var Ne=H.readyState;Ne<3||H.status!==0&&(se===void 0&&(se=H.status,se===1223&&(se=204),De()),Ne==3&&ee?Ce():Ne==4&&(ee?Ue():Le()))},H.send(re)},z.prototype.dispose=function(){var G=this.xhr;if(G){G.onreadystatechange=G.onerror=G.onabort=G.ontimeout=E,this.xhr=null;var J=this.timer;J&&(clearTimeout(J),this.timer=null),this.requestComplete||G.abort()}delete A[this.id]},z}(d.default);r.default=U}).call(this,n(13))},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=n(0),c=l.__importDefault(n(2)),h=l.__importStar(n(1)),d=l.__importDefault(n(23)),f=l.__importDefault(n(4)),m=l.__importDefault(n(45)),g=n(11),y=l.__importDefault(n(18)),_=l.__importDefault(n(25)),b=l.__importDefault(n(3)),S=l.__importDefault(n(14)),E=Math.pow(2,17);function T(){}function A(){return("000000"+Math.floor(Math.random()*1e16)).slice(-16)}function P(Z){return!!Z.connection}function O(Z){return h.isErrorInfoOrPartialErrorInfo(Z)?(Z.code||(Z.statusCode===403?Z.code=40300:(Z.code=40170,Z.statusCode=401)),Z):new f.default(h.inspectError(Z),Z.code||40170,Z.statusCode||401)}var R=function(Z,q){if(b.default.Config.createHmac){var $=b.default.Config.createHmac("SHA256",q);return $.update(Z),$.digest("base64")}return(0,g.stringify)((0,m.default)(Z,q))};function D(Z){if(!Z)return"";typeof Z=="string"&&(Z=JSON.parse(Z));var q=Object.create(null),$=h.keysArray(Z,!0);if(!$)return"";$.sort();for(var H=0;H<$.length;H++)q[$[H]]=Z[$[H]].sort();return JSON.stringify(q)}function L(Z){if(Z.authCallback)c.default.logAction(c.default.LOG_MINOR,"Auth()","using token auth with authCallback");else if(Z.authUrl)c.default.logAction(c.default.LOG_MINOR,"Auth()","using token auth with authUrl");else if(Z.key)c.default.logAction(c.default.LOG_MINOR,"Auth()","using token auth with client-side signing");else if(Z.tokenDetails)c.default.logAction(c.default.LOG_MINOR,"Auth()","using token auth with supplied token only");else{var q="authOptions must include valid authentication parameters";throw c.default.logAction(c.default.LOG_ERROR,"Auth()",q),new Error(q)}}function N(Z){return"useTokenAuth"in Z&&!Z.useTokenAuth}function U(Z){return Z.useTokenAuth||!N(Z)&&(Z.authCallback||Z.authUrl||Z.token||Z.tokenDetails)}function F(Z){return!Z.key&&!Z.authCallback&&!Z.authUrl}var z=0;function G(){return z++}var J=function(){function Z(q,$){if(this.authOptions={},this.client=q,this.tokenParams=$.defaultTokenParams||{},this.currentTokenRequestId=null,this.waitingForTokenRequest=null,U($)){if($.key&&!R){var H="client-side token request signing not supported";throw c.default.logAction(c.default.LOG_ERROR,"Auth()",H),new Error(H)}F($)&&c.default.logAction(c.default.LOG_ERROR,"Auth()","Warning: library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),this._saveTokenOptions($.defaultTokenParams,$),L(this.authOptions)}else{if(!$.key){var H="No authentication options provided; need one of: key, authUrl, or authCallback (or for testing only, token or tokenDetails)";throw c.default.logAction(c.default.LOG_ERROR,"Auth()",H),new f.default(H,40160,401)}c.default.logAction(c.default.LOG_MINOR,"Auth()","anonymous, using basic auth"),this._saveBasicOptions($)}}return Z.prototype.authorize=function(q,$,H){var X=this,re;if(typeof q=="function"&&!H?(H=q,re=q=null):typeof $=="function"&&!H?(H=$,re=null):re=$,!H&&this.client.options.promises)return h.promisify(this,"authorize",arguments);if(re&&re.key&&this.authOptions.key!==re.key)throw new f.default("Unable to update auth options with incompatible key",40102,401);re&&"force"in re&&(c.default.logAction(c.default.LOG_ERROR,"Auth.authorize","Deprecation warning: specifying {force: true} in authOptions is no longer necessary, authorize() now always gets a new token. Please remove this, as in version 1.0 and later, having a non-null authOptions will overwrite stored library authOptions, which may not be what you want"),h.isOnlyPropIn(re,"force")&&(re=null)),this._forceNewToken(q,re,function(ae,he){if(ae){X.client.connection&&ae.statusCode===_.default.Forbidden&&X.client.connection.connectionManager.actOnErrorFromAuthorize(ae),H==null||H(ae);return}P(X.client)?X.client.connection.connectionManager.onAuthUpdated(he,H||T):H==null||H(null,he)})},Z.prototype.authorise=function(q,$,H){c.default.deprecated("Auth.authorise","Auth.authorize"),this.authorize(q,$,H)},Z.prototype._forceNewToken=function(q,$,H){var X=this;this.tokenDetails=null,this._saveTokenOptions(q,$),L(this.authOptions),this._ensureValidAuthCredentials(!0,function(re,ae){delete X.tokenParams.timestamp,delete X.authOptions.queryTime,H(re,ae)})},Z.prototype.requestToken=function(q,$,H){var X=this;if(typeof q=="function"&&!H?(H=q,$=q=null):typeof $=="function"&&!H&&(H=$,$=null),!H&&this.client.options.promises)return h.promisify(this,"requestToken",arguments);$=$||this.authOptions,q=q||h.copy(this.tokenParams);var re=H||T,ae,he=this.client;if($.authCallback)c.default.logAction(c.default.LOG_MINOR,"Auth.requestToken()","using token auth with authCallback"),ae=$.authCallback;else if($.authUrl)c.default.logAction(c.default.LOG_MINOR,"Auth.requestToken()","using token auth with authUrl"),ae=function(fe,me){var De=h.mixin({accept:"application/json, text/plain"},$.authHeaders),Le=$.authMethod&&$.authMethod.toLowerCase()==="post",Ce,Ae=$.authUrl.indexOf("?");Ae>-1&&(Ce=h.parseQueryString($.authUrl.slice(Ae)),$.authUrl=$.authUrl.slice(0,Ae),Le||($.authParams=h.mixin(Ce,$.authParams)));var Ue=h.mixin({},$.authParams||{},fe),Ne=function(it,bt,Kt,kt){var Pt;if(it?c.default.logAction(c.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received Error: "+h.inspectError(it)):(Pt=Kt["content-type"],c.default.logAction(c.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received; content-type: "+Pt+"; body: "+h.inspectBody(bt))),it||kt)return me(it,bt);if(b.default.BufferUtils.isBuffer(bt)&&(bt=bt.toString()),!Pt){me(new f.default("authUrl response is missing a content-type header",40170,401));return}var _e=Pt.indexOf("application/json")>-1,ce=Pt.indexOf("text/plain")>-1||Pt.indexOf("application/jwt")>-1;if(!_e&&!ce){me(new f.default("authUrl responded with unacceptable content-type "+Pt+", should be either text/plain, application/jwt or application/json",40170,401));return}if(_e){if(bt.length>E){me(new f.default("authUrl response exceeded max permitted length",40170,401));return}try{bt=JSON.parse(bt)}catch(Fe){me(new f.default("Unexpected error processing authURL response; err = "+Fe.message,40170,401));return}}me(null,bt,Pt)};if(c.default.logAction(c.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Requesting token from "+$.authUrl+"; Params: "+JSON.stringify(Ue)+"; method: "+(Le?"POST":"GET")),Le){var Ge=De||{};Ge["content-type"]="application/x-www-form-urlencoded";var Ct=h.toQueryString(Ue).slice(1);X.client.http.doUri(y.default.Post,he,$.authUrl,Ge,Ct,Ce,Ne)}else X.client.http.doUri(y.default.Get,he,$.authUrl,De||{},null,Ue,Ne)};else if($.key)c.default.logAction(c.default.LOG_MINOR,"Auth.requestToken()","using token auth with client-side signing"),ae=function(fe,me){X.createTokenRequest(fe,$,me)};else{var pe="Need a new token, but authOptions does not include any way to request one (no authUrl, authCallback, or key)";c.default.logAction(c.default.LOG_ERROR,"Auth()","library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),re(new f.default(pe,40171,403));return}"capability"in q&&(q.capability=D(q.capability));var de=function(fe,me){var De=fe.keyName,Le="/keys/"+De+"/requestToken",Ce=function(Ue){return he.baseUri(Ue)+Le},Ae=h.defaultPostHeaders(X.client.options);$.requestHeaders&&h.mixin(Ae,$.requestHeaders),c.default.logAction(c.default.LOG_MICRO,"Auth.requestToken().requestToken","Sending POST to "+Le+"; Token params: "+JSON.stringify(fe)),X.client.http.do(y.default.Post,he,Ce,Ae,JSON.stringify(fe),null,me)},ee=!1,se=this.client.options.timeouts.realtimeRequestTimeout,Y=setTimeout(function(){ee=!0;var fe="Token request callback timed out after "+se/1e3+" seconds";c.default.logAction(c.default.LOG_ERROR,"Auth.requestToken()",fe),re(new f.default(fe,40170,401))},se);ae(q,function(fe,me,De){if(!ee){if(clearTimeout(Y),fe){c.default.logAction(c.default.LOG_ERROR,"Auth.requestToken()","token request signing call returned error; err = "+h.inspectError(fe)),re(O(fe));return}if(typeof me=="string"){me.length===0?re(new f.default("Token string is empty",40170,401)):me.length>E?re(new f.default("Token string exceeded max permitted length (was "+me.length+" bytes)",40170,401)):me==="undefined"||me==="null"?re(new f.default("Token string was literal null/undefined",40170,401)):me[0]==="{"&&!(De&&De.indexOf("application/jwt")>-1)?re(new f.default("Token was double-encoded; make sure you're not JSON-encoding an already encoded token request or details",40170,401)):re(null,{token:me});return}if(typeof me!="object"){var Le="Expected token request callback to call back with a token string or token request/details object, but got a "+typeof me;c.default.logAction(c.default.LOG_ERROR,"Auth.requestToken()",Le),re(new f.default(Le,40170,401));return}var Ce=JSON.stringify(me).length;if(Ce>E&&!$.suppressMaxLengthCheck){re(new f.default("Token request/details object exceeded max permitted stringified size (was "+Ce+" bytes)",40170,401));return}if("issued"in me){re(null,me);return}if(!("keyName"in me)){var Le="Expected token request callback to call back with a token string, token request object, or token details object";c.default.logAction(c.default.LOG_ERROR,"Auth.requestToken()",Le),re(new f.default(Le,40170,401));return}de(me,function(Ae,Ue,Ne,Ge){if(Ae){c.default.logAction(c.default.LOG_ERROR,"Auth.requestToken()","token request API call returned error; err = "+h.inspectError(Ae)),re(O(Ae));return}Ge||(Ue=JSON.parse(Ue)),c.default.logAction(c.default.LOG_MINOR,"Auth.getToken()","token received"),re(null,Ue)})}})},Z.prototype.createTokenRequest=function(q,$,H){var X=this;if(typeof q=="function"&&!H?(H=q,$=q=null):typeof $=="function"&&!H&&(H=$,$=null),!H&&this.client.options.promises)return h.promisify(this,"createTokenRequest",arguments);$=$||this.authOptions,q=q||h.copy(this.tokenParams);var re=$.key;if(!re){H(new f.default("No key specified",40101,403));return}var ae=re.split(":"),he=ae[0],pe=ae[1];if(!pe){H(new f.default("Invalid key specified",40101,403));return}if(q.clientId===""){H(new f.default("clientId can’t be an empty string",40012,400));return}"capability"in q&&(q.capability=D(q.capability));var de=h.mixin({keyName:he},q),ee=q.clientId||"",se=q.ttl||"",Y=q.capability||"";(function(fe){if(de.timestamp){fe();return}X.getTimestamp($&&$.queryTime,function(me,De){if(me){H(me);return}de.timestamp=De,fe()})})(function(){var fe=de.nonce||(de.nonce=A()),me=de.timestamp,De=de.keyName+`
`+se+`
`+Y+`
`+ee+`
`+me+`
`+fe+`
`;de.mac=de.mac||R(De,pe),c.default.logAction(c.default.LOG_MINOR,"Auth.getTokenRequest()","generated signed request"),H(null,de)})},Z.prototype.getAuthParams=function(q){this.method=="basic"?q(null,{key:this.key}):this._ensureValidAuthCredentials(!1,function($,H){if($){q($);return}if(!H)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");q(null,{access_token:H.token})})},Z.prototype.getAuthHeaders=function(q){this.method=="basic"?q(null,{authorization:"Basic "+this.basicKey}):this._ensureValidAuthCredentials(!1,function($,H){if($){q($);return}if(!H)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");q(null,{authorization:"Bearer "+h.toBase64(H.token)})})},Z.prototype.getTimestamp=function(q,$){!this.isTimeOffsetSet()&&(q||this.authOptions.queryTime)?this.client.time($):$(null,this.getTimestampUsingOffset())},Z.prototype.getTimestampUsingOffset=function(){return h.now()+(this.client.serverTimeOffset||0)},Z.prototype.isTimeOffsetSet=function(){return this.client.serverTimeOffset!==null},Z.prototype._saveBasicOptions=function(q){this.method="basic",this.key=q.key,this.basicKey=h.toBase64(q.key),this.authOptions=q||{},"clientId"in q&&this._userSetClientId(q.clientId)},Z.prototype._saveTokenOptions=function(q,$){this.method="token",q&&(this.tokenParams=q),$&&($.token&&($.tokenDetails=typeof $.token=="string"?{token:$.token}:$.token),$.tokenDetails&&(this.tokenDetails=$.tokenDetails),"clientId"in $&&this._userSetClientId($.clientId),this.authOptions=$)},Z.prototype._ensureValidAuthCredentials=function(q,$){var H=this,X=this.tokenDetails;if(X){if(this._tokenClientIdMismatch(X.clientId)){$(new f.default("Mismatch between clientId in token ("+X.clientId+") and current clientId ("+this.clientId+")",40102,403));return}if(!this.isTimeOffsetSet()||!X.expires||X.expires>=this.getTimestampUsingOffset()){c.default.logAction(c.default.LOG_MINOR,"Auth.getToken()","using cached token; expires = "+X.expires),$(null,X);return}c.default.logAction(c.default.LOG_MINOR,"Auth.getToken()","deleting expired token"),this.tokenDetails=null}if((this.waitingForTokenRequest||(this.waitingForTokenRequest=d.default.create())).push($),!(this.currentTokenRequestId!==null&&!q)){var re=this.currentTokenRequestId=G();this.requestToken(this.tokenParams,this.authOptions,function(ae,he){if(H.currentTokenRequestId>re){c.default.logAction(c.default.LOG_MINOR,"Auth._ensureValidAuthCredentials()","Discarding token request response; overtaken by newer one");return}H.currentTokenRequestId=null;var pe=H.waitingForTokenRequest||T;if(H.waitingForTokenRequest=null,ae){pe(ae);return}pe(null,H.tokenDetails=he)})}},Z.prototype._userSetClientId=function(q){if(typeof q=="string"||q===null){if(q==="*")throw new f.default('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, instantiate the library with {defaultTokenParams: {clientId: "*"}}), or if calling authorize(), pass it in as a tokenParam: authorize({clientId: "*"}, authOptions)',40012,400);var $=this._uncheckedSetClientId(q);if($)throw $}else throw new f.default("clientId must be either a string or null",40012,400)},Z.prototype._uncheckedSetClientId=function(q){if(this._tokenClientIdMismatch(q)){var $="Unexpected clientId mismatch: client has "+this.clientId+", requested "+q,H=new f.default($,40102,401);return c.default.logAction(c.default.LOG_ERROR,"Auth._uncheckedSetClientId()",$),H}else return this.clientId=this.tokenParams.clientId=q,null},Z.prototype._tokenClientIdMismatch=function(q){return!!(this.clientId&&this.clientId!=="*"&&q&&q!=="*"&&this.clientId!==q)},Z.isTokenErr=function(q){return q.code&&q.code>=40140&&q.code<40150},Z.prototype.revokeTokens=function(q,$,H){if(U(this.client.options))throw new f.default("Cannot revoke tokens when using token auth",40162,401);var X=this.client.options.keyName,re;if(typeof $=="function"?(H=$,re={}):re=$??{},H===void 0){if(this.client.options.promises)return h.promisify(this,"revokeTokens",[q,re]);H=T}var ae=H,he=l.__assign({targets:q.map(function(se){return"".concat(se.type,":").concat(se.value)})},re),pe=this.client.options.useBinaryProtocol?h.Format.msgpack:h.Format.json,de=h.defaultPostHeaders(this.client.options,pe);this.client.options.headers&&h.mixin(de,this.client.options.headers);var ee=h.encodeBody(he,pe);S.default.post(this.client,"/keys/".concat(X,"/revokeTokens"),ee,de,{newBatchResponse:"true"},null,function(se,Y,fe,me){if(se){ae(se);return}var De=me?Y:h.decodeBody(Y,pe);ae(null,De)})},Z}();r.default=J},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l;(function(c){c.Get="get",c.Delete="delete",c.Post="post",c.Put="put",c.Patch="patch"})(l||(l={})),r.default=l},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0}),r.HttpPaginatedResponse=r.PaginatedResult=void 0;var l=n(0),c=l.__importStar(n(1)),h=l.__importDefault(n(2)),d=l.__importDefault(n(14));function f(S){var E=S.match(/^\.\/(\w+)\?(.*)$/);return E&&E[2]&&c.parseQueryString(E[2])}function m(S){typeof S=="string"&&(S=S.split(","));for(var E={},T=0;T<S.length;T++){var A=S[T].match(/^\s*<(.+)>;\s*rel="(\w+)"$/);if(A){var P=f(A[1]);P&&(E[A[2]]=P)}}return E}function g(S,E,T){return!(T&&(E||typeof S.code=="number"))}var y=function(){function S(E,T,A,P,O,R){this.rest=E,this.path=T,this.headers=A,this.envelope=P??null,this.bodyHandler=O,this.useHttpPaginatedResponse=R||!1}return S.prototype.get=function(E,T){var A=this;d.default.get(this.rest,this.path,this.headers,E,this.envelope,function(P,O,R,D,L){A.handlePage(P,O,R,D,L,T)})},S.prototype.delete=function(E,T){var A=this;d.default.delete(this.rest,this.path,this.headers,E,this.envelope,function(P,O,R,D,L){A.handlePage(P,O,R,D,L,T)})},S.prototype.post=function(E,T,A){var P=this;d.default.post(this.rest,this.path,T,this.headers,E,this.envelope,function(O,R,D,L,N){A&&P.handlePage(O,R,D,L,N,A)})},S.prototype.put=function(E,T,A){var P=this;d.default.put(this.rest,this.path,T,this.headers,E,this.envelope,function(O,R,D,L,N){A&&P.handlePage(O,R,D,L,N,A)})},S.prototype.patch=function(E,T,A){var P=this;d.default.patch(this.rest,this.path,T,this.headers,E,this.envelope,function(O,R,D,L,N){A&&P.handlePage(O,R,D,L,N,A)})},S.prototype.handlePage=function(E,T,A,P,O,R){if(E&&g(E,T,this.useHttpPaginatedResponse)){h.default.logAction(h.default.LOG_ERROR,"PaginatedResource.handlePage()","Unexpected error getting resource: err = "+c.inspectError(E)),R==null||R(E);return}var D,L,N;try{D=this.bodyHandler(T,A||{},P)}catch(U){R==null||R(E||U);return}A&&(L=A.Link||A.link)&&(N=m(L)),this.useHttpPaginatedResponse?R(null,new b(this,D,A||{},O,N,E)):R(null,new _(this,D,N))},S}(),_=function(){function S(E,T,A){var P=this;this.resource=E,this.items=T;var O=this;A&&("first"in A&&(this.first=function(R){if(!R&&O.resource.rest.options.promises)return c.promisify(O,"first",[]);O.get(A.first,R)}),"current"in A&&(this.current=function(R){if(!R&&O.resource.rest.options.promises)return c.promisify(O,"current",[]);O.get(A.current,R)}),this.next=function(R){if(!R&&O.resource.rest.options.promises)return c.promisify(O,"next",[]);"next"in A?O.get(A.next,R):R(null,null)},this.hasNext=function(){return"next"in A},this.isLast=function(){var R;return!(!((R=P.hasNext)===null||R===void 0)&&R.call(P))})}return S.prototype.get=function(E,T){var A=this.resource;d.default.get(A.rest,A.path,A.headers,E,A.envelope,function(P,O,R,D,L){A.handlePage(P,O,R,D,L,T)})},S}();r.PaginatedResult=_;var b=function(S){l.__extends(E,S);function E(T,A,P,O,R,D){var L=S.call(this,T,A,R)||this;return L.statusCode=O,L.success=O<300&&O>=200,L.headers=P,L.errorCode=D&&D.code,L.errorMessage=D&&D.message,L}return E.prototype.toJSON=function(){return{items:this.items,statusCode:this.statusCode,success:this.success,headers:this.headers,errorCode:this.errorCode,errorMessage:this.errorMessage}},E}(_);r.HttpPaginatedResponse=b,r.default=y},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0}),r.isRetriable=void 0;var l=n(0),c=l.__importDefault(n(4)),h={DISCONNECTED:80003,SUSPENDED:80002,FAILED:8e4,CLOSING:80017,CLOSED:80017,UNKNOWN_CONNECTION_ERR:50002,UNKNOWN_CHANNEL_ERR:50001},d={disconnected:function(){return c.default.fromValues({statusCode:400,code:h.DISCONNECTED,message:"Connection to server temporarily unavailable"})},suspended:function(){return c.default.fromValues({statusCode:400,code:h.SUSPENDED,message:"Connection to server unavailable"})},failed:function(){return c.default.fromValues({statusCode:400,code:h.FAILED,message:"Connection failed or disconnected by server"})},closing:function(){return c.default.fromValues({statusCode:400,code:h.CLOSING,message:"Connection closing"})},closed:function(){return c.default.fromValues({statusCode:400,code:h.CLOSED,message:"Connection closed"})},unknownConnectionErr:function(){return c.default.fromValues({statusCode:500,code:h.UNKNOWN_CONNECTION_ERR,message:"Internal connection error"})},unknownChannelErr:function(){return c.default.fromValues({statusCode:500,code:h.UNKNOWN_CONNECTION_ERR,message:"Internal channel error"})}};function f(m){return!m.statusCode||!m.code||m.statusCode>=500?!0:Object.values(h).includes(m.code)}r.isRetriable=f,r.default=d},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l;(function(c){c[c.REQ_SEND=0]="REQ_SEND",c[c.REQ_RECV=1]="REQ_RECV",c[c.REQ_RECV_POLL=2]="REQ_RECV_POLL",c[c.REQ_RECV_STREAM=3]="REQ_RECV_STREAM"})(l||(l={})),r.default=l},function(t,r,n){(function(l,c){t.exports=c(n(6),n(5),n(58),n(11),n(40),n(32),n(24),n(27),n(28),n(59),n(60))})(this,function(l){return l})},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=n(0),c=l.__importDefault(n(2)),h=function(){function d(f){this.members=f||[]}return d.prototype.call=function(){for(var f=[],m=0;m<arguments.length;m++)f[m]=arguments[m];for(var g=0,y=this.members;g<y.length;g++){var _=y[g];if(_)try{_.apply(void 0,f)}catch(b){c.default.logAction(c.default.LOG_ERROR,"Multicaster multiple callback handler","Unexpected exception: "+b+"; stack = "+b.stack)}}},d.prototype.push=function(){for(var f,m=[],g=0;g<arguments.length;g++)m[g]=arguments[g];(f=this.members).push.apply(f,m)},d.create=function(f){var m=new d(f);return Object.assign(function(){for(var g=[],y=0;y<arguments.length;y++)g[y]=arguments[y];return m.call.apply(m,g)},{push:function(g){return m.push(g)}})},d}();r.default=h},function(t,r,n){(function(l,c){t.exports=c(n(6))})(this,function(l){(function(){var c=l,h=c.lib,d=h.Base,f=c.enc,m=f.Utf8,g=c.algo;g.HMAC=d.extend({init:function(y,_){y=this._hasher=new y.init,typeof _=="string"&&(_=m.parse(_));var b=y.blockSize,S=b*4;_.sigBytes>S&&(_=y.finalize(_)),_.clamp();for(var E=this._oKey=_.clone(),T=this._iKey=_.clone(),A=E.words,P=T.words,O=0;O<b;O++)A[O]^=1549556828,P[O]^=909522486;E.sigBytes=T.sigBytes=S,this.reset()},reset:function(){var y=this._hasher;y.reset(),y.update(this._iKey)},update:function(y){return this._hasher.update(y),this},finalize:function(y){var _=this._hasher,b=_.finalize(y);_.reset();var S=_.finalize(this._oKey.clone().concat(b));return S}})})()})},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0}),r.isSuccessCode=void 0;var l;(function(h){h[h.Success=200]="Success",h[h.NoContent=204]="NoContent",h[h.BadRequest=400]="BadRequest",h[h.Unauthorized=401]="Unauthorized",h[h.Forbidden=403]="Forbidden",h[h.RequestTimeout=408]="RequestTimeout",h[h.InternalServerError=500]="InternalServerError"})(l||(l={}));function c(h){return h>=l.Success&&h<l.BadRequest}r.isSuccessCode=c,r.default=l},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=n(0),c=l.__importDefault(n(10)),h=l.__importStar(n(1)),d=l.__importDefault(n(7)),f=l.__importDefault(n(2)),m=l.__importDefault(n(20)),g=l.__importDefault(n(4)),y=l.__importDefault(n(3)),_=c.default.Action,b=c.default.fromValues({action:_.CLOSE}),S=c.default.fromValues({action:_.DISCONNECT}),E=function(T){l.__extends(A,T);function A(P,O,R,D){var L=T.call(this)||this;return D&&(R.format=void 0,R.heartbeats=!0),L.connectionManager=P,P.registerProposedTransport(L),L.auth=O,L.params=R,L.timeouts=R.options.timeouts,L.format=R.format,L.isConnected=!1,L.isFinished=!1,L.isDisposed=!1,L.maxIdleInterval=null,L.idleTimer=null,L.lastActivity=null,L}return A.prototype.connect=function(){},A.prototype.close=function(){this.isConnected&&this.requestClose(),this.finish("closed",m.default.closed())},A.prototype.disconnect=function(P){this.isConnected&&this.requestDisconnect(),this.finish("disconnected",P||m.default.disconnected())},A.prototype.fail=function(P){this.isConnected&&this.requestDisconnect(),this.finish("failed",P||m.default.failed())},A.prototype.finish=function(P,O){var R;this.isFinished||(this.isFinished=!0,this.isConnected=!1,this.maxIdleInterval=null,clearTimeout((R=this.idleTimer)!==null&&R!==void 0?R:void 0),this.idleTimer=null,this.emit(P,O),this.dispose())},A.prototype.onProtocolMessage=function(P){switch(f.default.shouldLog(f.default.LOG_MICRO)&&f.default.logAction(f.default.LOG_MICRO,"Transport.onProtocolMessage()","received on "+this.shortName+": "+c.default.stringify(P)+"; connectionId = "+this.connectionManager.connectionId),this.onActivity(),P.action){case _.HEARTBEAT:f.default.logAction(f.default.LOG_MICRO,"Transport.onProtocolMessage()",this.shortName+" heartbeat; connectionId = "+this.connectionManager.connectionId),this.emit("heartbeat",P.id);break;case _.CONNECTED:this.onConnect(P),this.emit("connected",P.error,P.connectionId,P.connectionDetails,P);break;case _.CLOSED:this.onClose(P);break;case _.DISCONNECTED:this.onDisconnect(P);break;case _.ACK:this.emit("ack",P.msgSerial,P.count);break;case _.NACK:this.emit("nack",P.msgSerial,P.count,P.error);break;case _.SYNC:this.connectionManager.onChannelMessage(P,this);break;case _.ACTIVATE:break;case _.AUTH:this.auth.authorize(function(O){O&&f.default.logAction(f.default.LOG_ERROR,"Transport.onProtocolMessage()","Ably requested re-authentication, but unable to obtain a new token: "+h.inspectError(O))});break;case _.ERROR:if(f.default.logAction(f.default.LOG_MINOR,"Transport.onProtocolMessage()","received error action; connectionId = "+this.connectionManager.connectionId+"; err = "+y.default.Config.inspect(P.error)+(P.channel?", channel: "+P.channel:"")),P.channel===void 0){this.onFatalError(P);break}this.connectionManager.onChannelMessage(P,this);break;default:this.connectionManager.onChannelMessage(P,this)}},A.prototype.onConnect=function(P){if(this.isConnected=!0,!P.connectionDetails)throw new Error("Transport.onConnect(): Connect message recieved without connectionDetails");var O=P.connectionDetails.maxIdleInterval;O&&(this.maxIdleInterval=O+this.timeouts.realtimeRequestTimeout,this.onActivity())},A.prototype.onDisconnect=function(P){var O=P&&P.error;f.default.logAction(f.default.LOG_MINOR,"Transport.onDisconnect()","err = "+h.inspectError(O)),this.finish("disconnected",O)},A.prototype.onFatalError=function(P){var O=P&&P.error;f.default.logAction(f.default.LOG_MINOR,"Transport.onFatalError()","err = "+h.inspectError(O)),this.finish("failed",O)},A.prototype.onClose=function(P){var O=P&&P.error;f.default.logAction(f.default.LOG_MINOR,"Transport.onClose()","err = "+h.inspectError(O)),this.finish("closed",O)},A.prototype.requestClose=function(){f.default.logAction(f.default.LOG_MINOR,"Transport.requestClose()",""),this.send(b)},A.prototype.requestDisconnect=function(){f.default.logAction(f.default.LOG_MINOR,"Transport.requestDisconnect()",""),this.send(S)},A.prototype.ping=function(P){var O={action:c.default.Action.HEARTBEAT};P&&(O.id=P),this.send(c.default.fromValues(O))},A.prototype.dispose=function(){f.default.logAction(f.default.LOG_MINOR,"Transport.dispose()",""),this.isDisposed=!0,this.off()},A.prototype.onActivity=function(){this.maxIdleInterval&&(this.lastActivity=this.connectionManager.lastActivity=h.now(),this.setIdleTimer(this.maxIdleInterval+100))},A.prototype.setIdleTimer=function(P){var O=this;this.idleTimer||(this.idleTimer=setTimeout(function(){O.onIdleTimerExpire()},P))},A.prototype.onIdleTimerExpire=function(){if(!this.lastActivity||!this.maxIdleInterval)throw new Error("Transport.onIdleTimerExpire(): lastActivity/maxIdleInterval not set");this.idleTimer=null;var P=h.now()-this.lastActivity,O=this.maxIdleInterval-P;if(O<=0){var R="No activity seen from realtime in "+P+"ms; assuming connection has dropped";f.default.logAction(f.default.LOG_ERROR,"Transport.onIdleTimerExpire()",R),this.disconnect(new g.default(R,80003,408))}else this.setIdleTimer(O+100)},A.tryConnect=function(P,O,R,D,L){var N=new P(O,R,D),U,F=function(G){clearTimeout(U),L({event:this.event,error:G})},z=O.options.timeouts.realtimeRequestTimeout;U=setTimeout(function(){N.off(["preconnect","disconnected","failed"]),N.dispose(),F.call({event:"disconnected"},new g.default("Timeout waiting for transport to indicate itself viable",5e4,500))},z),N.on(["failed","disconnected"],F),N.on("preconnect",function(){f.default.logAction(f.default.LOG_MINOR,"Transport.tryConnect()","viable transport "+N),clearTimeout(U),N.off(["failed","disconnected"],F),L(null,N)}),N.connect()},A}(d.default);r.default=E},function(t,r,n){(function(l,c){t.exports=c(n(6),n(40),n(24))})(this,function(l){return function(){var c=l,h=c.lib,d=h.Base,f=h.WordArray,m=c.algo,g=m.MD5,y=m.EvpKDF=d.extend({cfg:d.extend({keySize:128/32,hasher:g,iterations:1}),init:function(_){this.cfg=this.cfg.extend(_)},compute:function(_,b){for(var S,E=this.cfg,T=E.hasher.create(),A=f.create(),P=A.words,O=E.keySize,R=E.iterations;P.length<O;){S&&T.update(S),S=T.update(_).finalize(b),T.reset();for(var D=1;D<R;D++)S=T.finalize(S),T.reset();A.concat(S)}return A.sigBytes=O*4,A}});c.EvpKDF=function(_,b,S){return y.create(S).compute(_,b)}}(),l.EvpKDF})},function(t,r,n){(function(l,c){t.exports=c(n(6),n(27))})(this,function(l){l.lib.Cipher||function(c){var h=l,d=h.lib,f=d.Base,m=d.WordArray,g=d.BufferedBlockAlgorithm,y=h.enc;y.Utf8;var _=y.Base64,b=h.algo,S=b.EvpKDF,E=d.Cipher=g.extend({cfg:f.extend(),createEncryptor:function(J,Z){return this.create(this._ENC_XFORM_MODE,J,Z)},createDecryptor:function(J,Z){return this.create(this._DEC_XFORM_MODE,J,Z)},init:function(J,Z,q){this.cfg=this.cfg.extend(q),this._xformMode=J,this._key=Z,this.reset()},reset:function(){g.reset.call(this),this._doReset()},process:function(J){return this._append(J),this._process()},finalize:function(J){J&&this._append(J);var Z=this._doFinalize();return Z},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function J(Z){return typeof Z=="string"?G:U}return function(Z){return{encrypt:function(q,$,H){return J($).encrypt(Z,q,$,H)},decrypt:function(q,$,H){return J($).decrypt(Z,q,$,H)}}}}()});d.StreamCipher=E.extend({_doFinalize:function(){var J=this._process(!0);return J},blockSize:1});var T=h.mode={},A=d.BlockCipherMode=f.extend({createEncryptor:function(J,Z){return this.Encryptor.create(J,Z)},createDecryptor:function(J,Z){return this.Decryptor.create(J,Z)},init:function(J,Z){this._cipher=J,this._iv=Z}}),P=T.CBC=function(){var J=A.extend();J.Encryptor=J.extend({processBlock:function(q,$){var H=this._cipher,X=H.blockSize;Z.call(this,q,$,X),H.encryptBlock(q,$),this._prevBlock=q.slice($,$+X)}}),J.Decryptor=J.extend({processBlock:function(q,$){var H=this._cipher,X=H.blockSize,re=q.slice($,$+X);H.decryptBlock(q,$),Z.call(this,q,$,X),this._prevBlock=re}});function Z(q,$,H){var X,re=this._iv;re?(X=re,this._iv=c):X=this._prevBlock;for(var ae=0;ae<H;ae++)q[$+ae]^=X[ae]}return J}(),O=h.pad={},R=O.Pkcs7={pad:function(J,Z){for(var q=Z*4,$=q-J.sigBytes%q,H=$<<24|$<<16|$<<8|$,X=[],re=0;re<$;re+=4)X.push(H);var ae=m.create(X,$);J.concat(ae)},unpad:function(J){var Z=J.words[J.sigBytes-1>>>2]&255;J.sigBytes-=Z}};d.BlockCipher=E.extend({cfg:E.cfg.extend({mode:P,padding:R}),reset:function(){var J;E.reset.call(this);var Z=this.cfg,q=Z.iv,$=Z.mode;this._xformMode==this._ENC_XFORM_MODE?J=$.createEncryptor:(J=$.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==J?this._mode.init(this,q&&q.words):(this._mode=J.call($,this,q&&q.words),this._mode.__creator=J)},_doProcessBlock:function(J,Z){this._mode.processBlock(J,Z)},_doFinalize:function(){var J,Z=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(Z.pad(this._data,this.blockSize),J=this._process(!0)):(J=this._process(!0),Z.unpad(J)),J},blockSize:128/32});var D=d.CipherParams=f.extend({init:function(J){this.mixIn(J)},toString:function(J){return(J||this.formatter).stringify(this)}}),L=h.format={},N=L.OpenSSL={stringify:function(J){var Z,q=J.ciphertext,$=J.salt;return $?Z=m.create([1398893684,1701076831]).concat($).concat(q):Z=q,Z.toString(_)},parse:function(J){var Z,q=_.parse(J),$=q.words;return $[0]==1398893684&&$[1]==1701076831&&(Z=m.create($.slice(2,4)),$.splice(0,4),q.sigBytes-=16),D.create({ciphertext:q,salt:Z})}},U=d.SerializableCipher=f.extend({cfg:f.extend({format:N}),encrypt:function(J,Z,q,$){$=this.cfg.extend($);var H=J.createEncryptor(q,$),X=H.finalize(Z),re=H.cfg;return D.create({ciphertext:X,key:q,iv:re.iv,algorithm:J,mode:re.mode,padding:re.padding,blockSize:J.blockSize,formatter:$.format})},decrypt:function(J,Z,q,$){$=this.cfg.extend($),Z=this._parse(Z,$.format);var H=J.createDecryptor(q,$).finalize(Z.ciphertext);return H},_parse:function(J,Z){return typeof J=="string"?Z.parse(J,this):J}}),F=h.kdf={},z=F.OpenSSL={execute:function(J,Z,q,$){$||($=m.random(64/8));var H=S.create({keySize:Z+q}).compute(J,$),X=m.create(H.words.slice(Z),q*4);return H.sigBytes=Z*4,D.create({key:H,iv:X,salt:$})}},G=d.PasswordBasedCipher=U.extend({cfg:U.cfg.extend({kdf:z}),encrypt:function(J,Z,q,$){$=this.cfg.extend($);var H=$.kdf.execute(q,J.keySize,J.ivSize);$.iv=H.iv;var X=U.encrypt.call(this,J,Z,H.key,$);return X.mixIn(H),X},decrypt:function(J,Z,q,$){$=this.cfg.extend($),Z=this._parse(Z,$.format);var H=$.kdf.execute(q,J.keySize,J.ivSize,Z.salt);$.iv=H.iv;var X=U.decrypt.call(this,J,Z,H.key,$);return X}})}()})},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0}),r.Request=r.createRequest=void 0;var l=n(0),c=l.__importStar(n(1)),h=l.__importDefault(n(12)),d=l.__importDefault(n(3)),f=l.__importDefault(n(7)),m=n(4),g=l.__importDefault(n(8)),y=l.__importDefault(n(2)),_=l.__importDefault(n(21)),b=c.getGlobalObject(),S=function(){},E=b._ablyjs_jsonp={};E._=function(L){return E["_"+L]||S};var T=1,A="jsonp";function P(L,N,U,F,z,G,J){return G=G||g.default.TIMEOUTS,new R(void 0,L,N,c.copy(U),F,z,G,J)}r.createRequest=P;var O=function(L){l.__extends(N,L);function N(U,F,z){var G=L.call(this,U,F,z)||this;return G.shortName=A,z.stream=!1,G}return N.isAvailable=function(){return d.default.Config.jsonpSupported&&d.default.Config.allowComet},N.prototype.toString=function(){return"JSONPTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},N.prototype.createRequest=function(U,F,z,G,J,Z,q){return Z=(this===null||this===void 0?void 0:this.timeouts)||Z||g.default.TIMEOUTS,P(U,F,z,G,J,Z,q)},N}(h.default),R=function(L){l.__extends(N,L);function N(U,F,z,G,J,Z,q,$){var H=L.call(this)||this;return U===void 0&&(U=T++),H.id=U,H.uri=F,H.params=G||{},H.params.rnd=c.cheapRandStr(),z&&(z["X-Ably-Version"]&&(H.params.v=z["X-Ably-Version"]),z["X-Ably-Lib"]&&(H.params.lib=z["X-Ably-Lib"])),H.body=J,H.method=$,H.requestMode=Z,H.timeouts=q,H.requestComplete=!1,H}return N.prototype.exec=function(){var U=this,F=this.id,z=this.body,G=this.method,J=this.uri,Z=this.params;Z.callback="_ablyjs_jsonp._("+F+")",Z.envelope="jsonp",z&&(Z.body=z),G&&G!=="get"&&(Z.method=G);var q=this.script=document.createElement("script"),$=J+c.toQueryString(Z);q.src=$,q.src.split("/").slice(-1)[0]!==$.split("/").slice(-1)[0]&&y.default.logAction(y.default.LOG_ERROR,"JSONP Request.exec()","Warning: the browser appears to have truncated the script URI. This will likely result in the request failing due to an unparseable body param"),q.async=!0,q.type="text/javascript",q.charset="UTF-8",q.onerror=function(re){U.complete(new m.PartialErrorInfo("JSONP script error (event: "+d.default.Config.inspect(re)+")",null,400))},E["_"+F]=function(re){if(re.statusCode){var ae=re.response;if(re.statusCode==204)U.complete(null,null,null,re.statusCode);else if(!ae)U.complete(new m.PartialErrorInfo("Invalid server response: no envelope detected",null,500));else if(re.statusCode<400||c.isArray(ae))U.complete(null,ae,re.headers,re.statusCode);else{var he=ae.error||new m.PartialErrorInfo("Error response received from server",null,re.statusCode);U.complete(he)}}else U.complete(null,re)};var H=this.requestMode==_.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout;this.timer=setTimeout(this.abort.bind(this),H);var X=document.getElementsByTagName("head")[0];X.insertBefore(q,X.firstChild)},N.prototype.complete=function(U,F,z,G){if(z=z||{},!this.requestComplete){this.requestComplete=!0;var J=void 0;F&&(J=typeof F=="string"?"text/plain":"application/json",z["content-type"]=J,this.emit("data",F)),this.emit("complete",U,F,z,!0,G),this.dispose()}},N.prototype.abort=function(){this.dispose()},N.prototype.dispose=function(){var U=this.timer;U&&(clearTimeout(U),this.timer=null);var F=this.script;F.parentNode&&F.parentNode.removeChild(F),delete E[this.id],this.emit("disposed")},N}(f.default);r.Request=R;function D(L){return b.JSONPTransport=O,O.isAvailable()&&(L.supportedTransports[A]=O),O}r.default=D},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=n(0),c=l.__importStar(n(1)),h=l.__importDefault(n(2)),d=l.__importDefault(n(8)),f=l.__importDefault(n(17)),m=l.__importDefault(n(46)),g=l.__importDefault(n(19)),y=l.__importDefault(n(33)),_=l.__importDefault(n(4)),b=l.__importDefault(n(49)),S=l.__importDefault(n(18)),E=l.__importDefault(n(3)),T=l.__importDefault(n(9)),A=l.__importDefault(n(15)),P=l.__importDefault(n(14)),O=function(){},R=function(){function L(N){if(!N){var U="no options provided";throw h.default.logAction(h.default.LOG_ERROR,"Rest()",U),new Error(U)}var F=d.default.objectifyOptions(N);F.log&&h.default.setLog(F.log.level,F.log.handler),h.default.logAction(h.default.LOG_MICRO,"Rest()","initialized with clientOptions "+E.default.Config.inspect(N));var z=this.options=d.default.normaliseOptions(F);if(z.key){var G=z.key.match(/^([^:\s]+):([^:.\s]+)$/);if(!G){var U="invalid key parameter";throw h.default.logAction(h.default.LOG_ERROR,"Rest()",U),new _.default(U,40400,404)}z.keyName=G[1],z.keySecret=G[2]}if("clientId"in z)if(typeof z.clientId=="string"||z.clientId===null){if(z.clientId==="*")throw new _.default('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, use {defaultTokenParams: {clientId: "*"}})',40012,400)}else throw new _.default("clientId must be either a string or null",40012,400);h.default.logAction(h.default.LOG_MINOR,"Rest()","started; version = "+d.default.version),this.baseUri=this.authority=function(J){return d.default.getHttpScheme(z)+J+":"+d.default.getPort(z,!1)},this._currentFallback=null,this.serverTimeOffset=null,this.http=new E.default.Http(z),this.auth=new f.default(this,z),this.channels=new D(this),this.push=new m.default(this)}return L.prototype.stats=function(N,U){if(U===void 0)if(typeof N=="function")U=N,N=null;else{if(this.options.promises)return c.promisify(this,"stats",[N]);U=O}var F=c.defaultGetHeaders(this.options),z=this.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,G=this.http.supportsLinkHeaders?void 0:z;this.options.headers&&c.mixin(F,this.options.headers),new g.default(this,"/stats",F,G,function(J,Z,q){for(var $=q?J:JSON.parse(J),H=0;H<$.length;H++)$[H]=b.default.fromValues($[H]);return $}).get(N,U)},L.prototype.time=function(N,U){var F=this;if(U===void 0){if(typeof N=="function")U=N,N=null;else if(this.options.promises)return c.promisify(this,"time",[N])}var z=U||O,G=c.defaultGetHeaders(this.options);this.options.headers&&c.mixin(G,this.options.headers);var J=function(Z){return F.authority(Z)+"/time"};this.http.do(S.default.Get,this,J,G,null,N,function(Z,q,$,H){if(Z){z(Z);return}H||(q=JSON.parse(q));var X=q[0];if(!X){z(new _.default("Internal error (unexpected result type from GET /time)",5e4,500));return}F.serverTimeOffset=X-c.now(),z(null,X)})},L.prototype.request=function(N,U,F,z,G,J){var Z=this.options.useBinaryProtocol,q=Z?E.default.Config.msgpack.encode:JSON.stringify,$=Z?E.default.Config.msgpack.decode:JSON.parse,H=Z?c.Format.msgpack:c.Format.json,X=this.http.supportsLinkHeaders?void 0:H;F=F||{};var re=N.toLowerCase(),ae=re=="get"?c.defaultGetHeaders(this.options,H):c.defaultPostHeaders(this.options,H);if(J===void 0){if(this.options.promises)return c.promisify(this,"request",[N,U,F,z,G]);J=O}typeof z!="string"&&(z=q(z)),this.options.headers&&c.mixin(ae,this.options.headers),G&&c.mixin(ae,G);var he=new g.default(this,U,ae,X,function(pe,de,ee){return c.ensureArray(ee?pe:$(pe))},!0);if(!c.arrIn(E.default.Http.methods,re))throw new _.default("Unsupported method "+re,40500,405);c.arrIn(E.default.Http.methodsWithBody,re)?he[re](F,z,J):he[re](F,J)},L.prototype.batchPublish=function(N,U){if(U===void 0){if(this.options.promises)return c.promisify(this,"batchPublish",[N]);U=O}var F=U,z,G;c.isArray(N)?(z=N,G=!1):(z=[N],G=!0);var J=this.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,Z=c.defaultPostHeaders(this.options,J);this.options.headers&&c.mixin(Z,this.options.headers);var q=c.encodeBody(z,J);P.default.post(this,"/messages",q,Z,{newBatchResponse:"true"},null,function($,H,X,re){if($){F($);return}var ae=re?H:c.decodeBody(H,J);G?F(null,ae[0]):F(null,ae)})},L.prototype.batchPresence=function(N,U){if(U===void 0){if(this.options.promises)return c.promisify(this,"batchPresence",[N]);U=O}var F=U,z=this.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,G=c.defaultPostHeaders(this.options,z);this.options.headers&&c.mixin(G,this.options.headers);var J=N.join(",");P.default.get(this,"/presence",G,{newBatchResponse:"true",channels:J},null,function(Z,q,$,H){if(Z){F(Z);return}var X=H?q:c.decodeBody(q,z);F(null,X)})},L.prototype.setLog=function(N){h.default.setLog(N.level,N.handler)},L.Promise=function(N){return N=d.default.objectifyOptions(N),N.promises=!0,new L(N)},L.Callbacks=L,L.Platform=E.default,L.Message=T.default,L.PresenceMessage=A.default,L}(),D=function(){function L(N){this.rest=N,this.all=Object.create(null)}return L.prototype.get=function(N,U){N=String(N);var F=this.all[N];return F?U&&F.setOptions(U):this.all[N]=F=new y.default(this.rest,N,U),F},L.prototype.release=function(N){delete this.all[String(N)]},L}();r.default=R},function(t,r,n){(function(l,c){t.exports=c(n(6))})(this,function(l){return l.enc.Utf8})},function(t,r,n){(function(l,c){t.exports=c(n(6))})(this,function(l){return function(c){var h=l,d=h.lib,f=d.WordArray,m=d.Hasher,g=h.algo,y=[],_=[];(function(){function E(O){for(var R=c.sqrt(O),D=2;D<=R;D++)if(!(O%D))return!1;return!0}function T(O){return(O-(O|0))*4294967296|0}for(var A=2,P=0;P<64;)E(A)&&(P<8&&(y[P]=T(c.pow(A,1/2))),_[P]=T(c.pow(A,1/3)),P++),A++})();var b=[],S=g.SHA256=m.extend({_doReset:function(){this._hash=new f.init(y.slice(0))},_doProcessBlock:function(E,T){for(var A=this._hash.words,P=A[0],O=A[1],R=A[2],D=A[3],L=A[4],N=A[5],U=A[6],F=A[7],z=0;z<64;z++){if(z<16)b[z]=E[T+z]|0;else{var G=b[z-15],J=(G<<25|G>>>7)^(G<<14|G>>>18)^G>>>3,Z=b[z-2],q=(Z<<15|Z>>>17)^(Z<<13|Z>>>19)^Z>>>10;b[z]=J+b[z-7]+q+b[z-16]}var $=L&N^~L&U,H=P&O^P&R^O&R,X=(P<<30|P>>>2)^(P<<19|P>>>13)^(P<<10|P>>>22),re=(L<<26|L>>>6)^(L<<21|L>>>11)^(L<<7|L>>>25),ae=F+re+$+_[z]+b[z],he=X+H;F=U,U=N,N=L,L=D+ae|0,D=R,R=O,O=P,P=ae+he|0}A[0]=A[0]+P|0,A[1]=A[1]+O|0,A[2]=A[2]+R|0,A[3]=A[3]+D|0,A[4]=A[4]+L|0,A[5]=A[5]+N|0,A[6]=A[6]+U|0,A[7]=A[7]+F|0},_doFinalize:function(){var E=this._data,T=E.words,A=this._nDataBytes*8,P=E.sigBytes*8;return T[P>>>5]|=128<<24-P%32,T[(P+64>>>9<<4)+14]=c.floor(A/4294967296),T[(P+64>>>9<<4)+15]=A,E.sigBytes=T.length*4,this._process(),this._hash},clone:function(){var E=m.clone.call(this);return E._hash=this._hash.clone(),E}});h.SHA256=m._createHelper(S),h.HmacSHA256=m._createHmacHelper(S)}(Math),l.SHA256})},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=n(0),c=l.__importStar(n(1)),h=l.__importDefault(n(7)),d=l.__importDefault(n(2)),f=l.__importDefault(n(34)),m=l.__importDefault(n(9)),g=l.__importDefault(n(4)),y=l.__importDefault(n(19)),_=l.__importDefault(n(14)),b=l.__importDefault(n(3));function S(){}var E=9;function T(O){return c.arrEvery(O,function(R){return!R.id})}function A(O){var R=O||{};if(R.cipher){if(!b.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var D=b.default.Crypto.getCipher(R.cipher);R.cipher=D.cipherParams,R.channelCipher=D.cipher}else"cipher"in R&&(R.cipher=void 0,R.channelCipher=null);return R}var P=function(O){l.__extends(R,O);function R(D,L,N){var U=O.call(this)||this;return d.default.logAction(d.default.LOG_MINOR,"Channel()","started; name = "+L),U.rest=D,U.name=L,U.basePath="/channels/"+encodeURIComponent(L),U.presence=new f.default(U),U.channelOptions=A(N),U}return R.prototype.setOptions=function(D){this.channelOptions=A(D)},R.prototype.history=function(D,L){if(d.default.logAction(d.default.LOG_MICRO,"Channel.history()","channel = "+this.name),L===void 0)if(typeof D=="function")L=D,D=null;else{if(this.rest.options.promises)return c.promisify(this,"history",arguments);L=S}this._history(D,L)},R.prototype._history=function(D,L){var N=this.rest,U=N.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,F=this.rest.http.supportsLinkHeaders?void 0:U,z=c.defaultGetHeaders(N.options,U);N.options.headers&&c.mixin(z,N.options.headers);var G=this.channelOptions;new y.default(N,this.basePath+"/messages",z,F,function(J,Z,q){return m.default.fromResponseBody(J,G,q?void 0:U)}).get(D,L)},R.prototype.publish=function(){var D=this,L=arguments.length,N=arguments[0],U=arguments[1],F=arguments[L-1],z,G;if(typeof F!="function"){if(this.rest.options.promises)return c.promisify(this,"publish",arguments);F=S}if(typeof N=="string"||N===null)z=[m.default.fromValues({name:N,data:U})],G=arguments[2];else if(c.isObject(N))z=[m.default.fromValues(N)],G=arguments[1];else if(c.isArray(N))z=m.default.fromValuesArray(N),G=arguments[1];else throw new g.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);(typeof G!="object"||!G)&&(G={});var J=this.rest,Z=J.options,q=Z.useBinaryProtocol?c.Format.msgpack:c.Format.json,$=J.options.idempotentRestPublishing,H=c.defaultPostHeaders(J.options,q);if(Z.headers&&c.mixin(H,Z.headers),$&&T(z)){var X=c.randomString(E);c.arrForEach(z,function(re,ae){re.id=X+":"+ae.toString()})}m.default.encodeArray(z,this.channelOptions,function(re){if(re){F(re);return}var ae=m.default.getMessagesSize(z),he=Z.maxMessageSize;if(ae>he){F(new g.default("Maximum size of messages that can be published at once exceeded ( was "+ae+" bytes; limit is "+he+" bytes)",40009,400));return}D._publish(m.default.serialize(z,q),H,G,F)})},R.prototype._publish=function(D,L,N,U){_.default.post(this.rest,this.basePath+"/messages",D,L,N,null,U)},R.prototype.status=function(D){if(typeof D!="function"&&this.rest.options.promises)return c.promisify(this,"status",[]);var L=this.rest.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,N=c.defaultPostHeaders(this.rest.options,L);_.default.get(this.rest,this.basePath,N,{},L,D||S)},R}(h.default);r.default=P},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=n(0),c=l.__importStar(n(1)),h=l.__importDefault(n(7)),d=l.__importDefault(n(2)),f=l.__importDefault(n(19)),m=l.__importDefault(n(15));function g(){}var y=function(_){l.__extends(b,_);function b(S){var E=_.call(this)||this;return E.channel=S,E.basePath=S.basePath+"/presence",E}return b.prototype.get=function(S,E){if(d.default.logAction(d.default.LOG_MICRO,"Presence.get()","channel = "+this.channel.name),E===void 0)if(typeof S=="function")E=S,S=null;else{if(this.channel.rest.options.promises)return c.promisify(this,"get",arguments);E=g}var T=this.channel.rest,A=T.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,P=this.channel.rest.http.supportsLinkHeaders?void 0:A,O=c.defaultGetHeaders(T.options,A);T.options.headers&&c.mixin(O,T.options.headers);var R=this.channel.channelOptions;new f.default(T,this.basePath,O,P,function(D,L,N){return m.default.fromResponseBody(D,R,N?void 0:A)}).get(S,E)},b.prototype.history=function(S,E){return d.default.logAction(d.default.LOG_MICRO,"Presence.history()","channel = "+this.channel.name),this._history(S,E)},b.prototype._history=function(S,E){if(E===void 0)if(typeof S=="function")E=S,S=null;else{if(this.channel.rest.options.promises)return c.promisify(this,"_history",[S]);E=g}var T=this.channel.rest,A=T.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,P=this.channel.rest.http.supportsLinkHeaders?void 0:A,O=c.defaultGetHeaders(T.options,A);T.options.headers&&c.mixin(O,T.options.headers);var R=this.channel.channelOptions;new f.default(T,this.basePath+"/history",O,P,function(D,L,N){return m.default.fromResponseBody(D,R,N?void 0:A)}).get(S,E)},b}(h.default);r.default=y},function(t,r,n){(function(l){Object.defineProperty(r,"__esModule",{value:!0}),r.TransportParams=void 0;var c=n(0),h=c.__importDefault(n(10)),d=c.__importStar(n(1)),f=c.__importStar(n(52)),m=c.__importStar(n(8)),g=c.__importDefault(n(3)),y=c.__importDefault(n(7)),_=c.__importDefault(n(36)),b=c.__importDefault(n(2)),S=c.__importDefault(n(37)),E=c.__importStar(n(20)),T=c.__importStar(n(4)),A=c.__importDefault(n(17)),P=c.__importDefault(n(9)),O=c.__importDefault(n(23)),R=c.__importDefault(n(53)),D=c.__importDefault(n(26)),L=c.__importDefault(n(25)),N=function(){var pe;return typeof g.default.WebStorage<"u"&&((pe=g.default.WebStorage)===null||pe===void 0?void 0:pe.localSupported)},U=function(){var pe;return typeof g.default.WebStorage<"u"&&((pe=g.default.WebStorage)===null||pe===void 0?void 0:pe.sessionSupported)},F=h.default.Action,z=function(){},G="ably-transport-preference",J="ably-connection-recovery";function Z(){var pe,de;return U()&&((de=(pe=g.default.WebStorage)===null||pe===void 0?void 0:pe.getSession)===null||de===void 0?void 0:de.call(pe,J))}function q(pe){var de,ee;return U()&&((ee=(de=g.default.WebStorage)===null||de===void 0?void 0:de.setSession)===null||ee===void 0?void 0:ee.call(de,J,pe))}function $(){var pe,de;return U()&&((de=(pe=g.default.WebStorage)===null||pe===void 0?void 0:pe.removeSession)===null||de===void 0?void 0:de.call(pe,J))}function H(pe,de){return d.arrIndexOf(g.default.Defaults.transportPreferenceOrder,pe.shortName)>d.arrIndexOf(g.default.Defaults.transportPreferenceOrder,de.shortName)}function X(pe,de,ee){var se;if(pe.channel!==de.channel||(se=pe.action)!==F.PRESENCE&&se!==F.MESSAGE||se!==de.action)return!1;var Y=se===F.PRESENCE?"presence":"messages",fe=pe[Y].concat(de[Y]),me=P.default.getMessagesSize(fe);return me>ee||!d.allSame(fe,"clientId")||!d.arrEvery(fe,function(De){return!De.id})?!1:(pe[Y]=fe,!0)}function re(pe){try{return JSON.parse(pe)}catch{return null}}var ae=function(){function pe(de,ee,se,Y){this.options=de,this.host=ee,this.mode=se,this.connectionKey=Y,this.format=de.useBinaryProtocol?d.Format.msgpack:d.Format.json}return pe.prototype.getConnectParams=function(de){var ee=de?d.copy(de):{},se=this.options;switch(this.mode){case"upgrade":ee.upgrade=this.connectionKey;break;case"resume":ee.resume=this.connectionKey;break;case"recover":{var Y=re(se.recover);Y&&(ee.recover=Y.connectionKey);break}}return se.clientId!==void 0&&(ee.clientId=se.clientId),se.echoMessages===!1&&(ee.echo="false"),this.format!==void 0&&(ee.format=this.format),this.stream!==void 0&&(ee.stream=this.stream),this.heartbeats!==void 0&&(ee.heartbeats=this.heartbeats),ee.v=m.default.protocolVersion,ee.agent=(0,m.getAgentString)(this.options),se.transportParams!==void 0&&d.mixin(ee,se.transportParams),ee},pe.prototype.toString=function(){var de="[mode="+this.mode;return this.host&&(de+=",host="+this.host),this.connectionKey&&(de+=",connectionKey="+this.connectionKey),this.format&&(de+=",format="+this.format),de+="]",de},pe}();r.TransportParams=ae;var he=function(pe){c.__extends(de,pe);function de(ee,se){var Y=pe.call(this)||this;Y.disconnectedRetryCount=0,de.initTransports(),Y.realtime=ee,Y.options=se;var fe=se.timeouts,me=fe.preferenceConnectTimeout+fe.realtimeRequestTimeout;if(Y.states={initialized:{state:"initialized",terminal:!1,queueEvents:!0,sendEvents:!1,failState:"disconnected"},connecting:{state:"connecting",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:me,failState:"disconnected"},connected:{state:"connected",terminal:!1,queueEvents:!1,sendEvents:!0,failState:"disconnected"},synchronizing:{state:"connected",terminal:!1,queueEvents:!0,sendEvents:!1,forceQueueEvents:!0,failState:"disconnected"},disconnected:{state:"disconnected",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:fe.disconnectedRetryTimeout,failState:"disconnected"},suspended:{state:"suspended",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:fe.suspendedRetryTimeout,failState:"suspended"},closing:{state:"closing",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:fe.realtimeRequestTimeout,failState:"closed"},closed:{state:"closed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"closed"},failed:{state:"failed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"failed"}},Y.state=Y.states.initialized,Y.errorReason=null,Y.queuedMessages=new _.default,Y.msgSerial=0,Y.connectionDetails=void 0,Y.connectionId=void 0,Y.connectionKey=void 0,Y.connectionStateTtl=fe.connectionStateTtl,Y.maxIdleInterval=null,Y.transports=d.intersect(se.transports||m.default.defaultTransports,de.supportedTransports),Y.baseTransport=d.intersect(m.default.baseTransportOrder,Y.transports)[0],Y.upgradeTransports=d.intersect(Y.transports,m.default.upgradeTransports),Y.transportPreference=null,Y.httpHosts=m.default.getHosts(se),Y.activeProtocol=null,Y.proposedTransports=[],Y.pendingTransports=[],Y.host=null,Y.lastAutoReconnectAttempt=null,Y.lastActivity=null,Y.forceFallbackHost=!1,Y.connectCounter=0,b.default.logAction(b.default.LOG_MINOR,"Realtime.ConnectionManager()","started"),b.default.logAction(b.default.LOG_MICRO,"Realtime.ConnectionManager()","requested transports = ["+(se.transports||m.default.defaultTransports)+"]"),b.default.logAction(b.default.LOG_MICRO,"Realtime.ConnectionManager()","available transports = ["+Y.transports+"]"),b.default.logAction(b.default.LOG_MICRO,"Realtime.ConnectionManager()","http hosts = ["+Y.httpHosts+"]"),!Y.transports.length){var De="no requested transports available";throw b.default.logAction(b.default.LOG_ERROR,"realtime.ConnectionManager()",De),new Error(De)}var Le=g.default.Config.addEventListener;return Le&&(U()&&typeof se.recover=="function"&&Le("beforeunload",Y.persistConnection.bind(Y)),se.closeOnUnload===!0&&Le("beforeunload",function(){b.default.logAction(b.default.LOG_MAJOR,"Realtime.ConnectionManager()","beforeunload event has triggered the connection to close as closeOnUnload is true"),Y.requestState({state:"closing"})}),Le("online",function(){Y.state==Y.states.disconnected||Y.state==Y.states.suspended?(b.default.logAction(b.default.LOG_MINOR,"ConnectionManager caught browser ‘online’ event","reattempting connection"),Y.requestState({state:"connecting"})):Y.state==Y.states.connecting&&(Y.pendingTransports.forEach(function(Ce){Ce.off()}),Y.disconnectAllTransports(),Y.startConnect())}),Le("offline",function(){Y.state==Y.states.connected&&(b.default.logAction(b.default.LOG_MINOR,"ConnectionManager caught browser ‘offline’ event","disconnecting active transport"),Y.disconnectAllTransports())})),Y}return de.initTransports=function(){(0,R.default)(de),d.arrForEach(g.default.Transports,function(ee){ee(de)})},de.prototype.createTransportParams=function(ee,se){return new ae(this.options,ee,se,this.connectionKey)},de.prototype.getTransportParams=function(ee){var se=this,Y=function(fe){if(se.connectionKey){fe("resume");return}if(typeof se.options.recover=="string"){fe("recover");return}var me=se.options.recover,De=Z();if(De&&typeof me=="function"){b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Calling clientOptions-provided recover function with last session data"),me(De,function(Le){Le?(se.options.recover=De.recoveryKey,fe("recover")):fe("clean")});return}fe("clean")};Y(function(fe){var me=se.createTransportParams(null,fe);if(fe==="recover"){b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport recovery mode = recover; recoveryKey = "+se.options.recover);var De=re(se.options.recover);De&&(se.msgSerial=De.msgSerial)}else b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport params = "+me.toString());ee(me)})},de.prototype.tryATransport=function(ee,se,Y){var fe=this;b.default.logAction(b.default.LOG_MICRO,"ConnectionManager.tryATransport()","trying "+se),D.default.tryConnect(de.supportedTransports[se],this,this.realtime.auth,ee,function(me,De){var Le=fe.state;if(Le==fe.states.closing||Le==fe.states.closed||Le==fe.states.failed){De&&(b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.tryATransport()","connection "+Le.state+" while we were attempting the transport; closing "+De),De.close()),Y(!0);return}if(me){b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.tryATransport()","transport "+se+" "+me.event+", err: "+me.error.toString()),A.default.isTokenErr(me.error)&&!(fe.errorReason&&A.default.isTokenErr(fe.errorReason))?(fe.errorReason=me.error,fe.realtime.auth._forceNewToken(null,null,function(Ce){if(Ce){fe.actOnErrorFromAuthorize(Ce);return}fe.tryATransport(ee,se,Y)})):me.event==="failed"?(fe.notifyState({state:"failed",error:me.error}),Y(!0)):me.event==="disconnected"&&((0,E.isRetriable)(me.error)?Y(!1):(fe.notifyState({state:fe.states.connecting.failState,error:me.error}),Y(!0)));return}b.default.logAction(b.default.LOG_MICRO,"ConnectionManager.tryATransport()","viable transport "+se+"; setting pending"),fe.setTransportPending(De,ee),Y(null,De)})},de.prototype.setTransportPending=function(ee,se){var Y=this,fe=se.mode;b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.setTransportPending()","transport = "+ee+"; mode = "+fe),d.arrDeleteValue(this.proposedTransports,ee),this.pendingTransports.push(ee);var me=g.default.Defaults.transportPreferenceOrder[g.default.Defaults.transportPreferenceOrder.length-1];ee.once("connected",function(Le,Ce,Ae){fe=="upgrade"&&Y.activeProtocol?ee.shortName!==me&&d.arrIn(Y.getUpgradePossibilities(),me)&&Y.activeProtocol?setTimeout(function(){Y.scheduleTransportActivation(Le,ee,Ce,Ae)},Y.options.timeouts.parallelUpgradeDelay):Y.scheduleTransportActivation(Le,ee,Ce,Ae):(Y.activateTransport(Le,ee,Ce,Ae),g.default.Config.nextTick(function(){Y.connectImpl(se)})),fe==="recover"&&Y.options.recover&&(Y.options.recover=null,Y.unpersistConnection())});var De=this;ee.on(["disconnected","closed","failed"],function(Le){De.deactivateTransport(ee,this.event,Le)}),this.emit("transport.pending",ee)},de.prototype.scheduleTransportActivation=function(ee,se,Y,fe){var me=this,De=this.activeProtocol&&this.activeProtocol.getTransport(),Le=function(){se.disconnect(),d.arrDeleteValue(me.pendingTransports,se)};if(this.state!==this.states.connected&&this.state!==this.states.connecting){b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+se.shortName),Le();return}if(De&&!H(se,De)){b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+se.shortName+" is no better than current active transport "+De.shortName+" - abandoning upgrade"),Le();return}b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Scheduling transport upgrade; transport = "+se);var Ce=null;if(!se.isConnected){b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+se.shortName+"is no longer connected; abandoning upgrade"),Le();return}if(this.state===this.states.connected)b.default.logAction(b.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Currently connected, so temporarily pausing events until the upgrade is complete"),this.state=this.states.synchronizing,Ce=this.activeProtocol;else if(this.state!==this.states.connecting){b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+se.shortName),Le();return}b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Syncing transport; transport = "+se);var Ae=function(){b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Activating transport; transport = "+se),se.send(h.default.fromValues({action:F.ACTIVATE})),me.activateTransport(ee,se,Y,fe),me.state===me.states.synchronizing?(b.default.logAction(b.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, sending queued messages on upgraded transport; transport = "+se),me.state=me.states.connected):b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, but state is now "+me.state.state+", so leaving unchanged"),me.state.sendEvents&&me.sendQueuedMessages()};Ce?Ce.onceIdle(Ae):Ae()},de.prototype.activateTransport=function(ee,se,Y,fe){var me=this;b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.activateTransport()","transport = "+se),ee&&b.default.logAction(b.default.LOG_ERROR,"ConnectionManager.activateTransport()","error = "+ee),Y&&b.default.logAction(b.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionId =  "+Y),fe&&b.default.logAction(b.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionDetails =  "+JSON.stringify(fe)),this.persistTransportPreference(se);var De=this.state,Le=this.states.connected.state;if(b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.activateTransport()","current state = "+De.state),De.state==this.states.closing.state||De.state==this.states.closed.state||De.state==this.states.failed.state)return b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.activateTransport()","Disconnecting transport and abandoning"),se.disconnect(),!1;if(d.arrDeleteValue(this.pendingTransports,se),!se.isConnected)return b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.activateTransport()","Declining to activate transport "+se+" since it appears to no longer be connected"),!1;var Ce=this.activeProtocol;this.activeProtocol=new f.default(se),this.host=se.params.host;var Ae=fe.connectionKey;if(Ae&&this.connectionKey!=Ae&&this.setConnection(Y,fe,!!ee),this.onConnectionDetailsUpdate(fe,se),g.default.Config.nextTick(function(){se.on("connected",function(Ne,Ge,Ct){me.onConnectionDetailsUpdate(Ct,se),me.emit("update",new S.default(Le,Le,null,Ne))})}),De.state===this.states.connected.state?ee&&(this.errorReason=this.realtime.connection.errorReason=ee,this.emit("update",new S.default(Le,Le,null,ee))):(this.notifyState({state:"connected",error:ee}),this.errorReason=this.realtime.connection.errorReason=ee||null),this.emit("transport.active",se),Ce)if(Ce.messageQueue.count()>0&&b.default.logAction(b.default.LOG_ERROR,"ConnectionManager.activateTransport()","Previous active protocol (for transport "+Ce.transport.shortName+", new one is "+se.shortName+") finishing with "+Ce.messageQueue.count()+" messages still pending"),Ce.transport===se){var Ue="Assumption violated: activating a transport that was also the transport for the previous active protocol; transport = "+se.shortName+"; stack = "+new Error().stack;b.default.logAction(b.default.LOG_ERROR,"ConnectionManager.activateTransport()",Ue)}else Ce.finish();return d.safeArrForEach(this.pendingTransports,function(Ne){if(Ne===se){var Ge="Assumption violated: activating a transport that is still marked as a pending transport; transport = "+se.shortName+"; stack = "+new Error().stack;b.default.logAction(b.default.LOG_ERROR,"ConnectionManager.activateTransport()",Ge),d.arrDeleteValue(me.pendingTransports,se)}else Ne.disconnect()}),d.safeArrForEach(this.proposedTransports,function(Ne){Ne===se?(b.default.logAction(b.default.LOG_ERROR,"ConnectionManager.activateTransport()","Assumption violated: activating a transport that is still marked as a proposed transport; transport = "+se.shortName+"; stack = "+new Error().stack),d.arrDeleteValue(me.proposedTransports,se)):Ne.dispose()}),!0},de.prototype.deactivateTransport=function(ee,se,Y){var fe=this.activeProtocol,me=fe&&fe.getTransport()===ee,De=d.arrDeleteValue(this.pendingTransports,ee),Le=d.arrDeleteValue(this.proposedTransports,ee),Ce=this.noTransportsScheduledForActivation();if(b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","transport = "+ee),b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","state = "+se+(me?"; was active":De?"; was pending":Le?"; was proposed":"")+(Ce?"":"; another transport is scheduled for activation")),Y&&Y.message&&b.default.logAction(b.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","reason =  "+Y.message),me&&(b.default.logAction(b.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","Getting, clearing, and requeuing "+this.activeProtocol.messageQueue.count()+" pending messages"),this.queuePendingMessages(fe.getPendingMessages()),g.default.Config.nextTick(function(){fe.clearPendingMessages()}),this.activeProtocol=this.host=null),this.emit("transport.inactive",ee),me&&Ce||me&&se==="failed"||se==="closed"||fe===null&&De&&this.pendingTransports.length===0){if(se==="disconnected"&&Y&&Y.statusCode>500&&this.httpHosts.length>1){this.unpersistTransportPreference(),this.forceFallbackHost=!0,this.notifyState({state:se,error:Y,retryImmediately:!0});return}var Ae=se==="failed"&&A.default.isTokenErr(Y)?"disconnected":se;this.notifyState({state:Ae,error:Y});return}me&&se==="disconnected"&&this.state!==this.states.synchronizing&&(b.default.logAction(b.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","wasActive but another transport is connected and scheduled for activation, so going into the connecting state until it activates"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),this.notifyState({state:"connecting",error:Y}))},de.prototype.noTransportsScheduledForActivation=function(){return d.isEmpty(this.pendingTransports)||this.pendingTransports.every(function(ee){return!ee.isConnected})},de.prototype.setConnection=function(ee,se,Y){var fe=this.connectionId,me=fe&&fe!==ee,De=!fe&&Y;(me||De)&&(b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.setConnection()","Resetting msgSerial"),this.msgSerial=0,this.queuedMessages.resetSendAttempted()),this.connectionId!==ee&&b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.setConnection()","New connectionId; reattaching any attached channels"),this.realtime.connection.id=this.connectionId=ee,this.realtime.connection.key=this.connectionKey=se.connectionKey},de.prototype.clearConnection=function(){this.realtime.connection.id=this.connectionId=void 0,this.realtime.connection.key=this.connectionKey=void 0,this.msgSerial=0,this.unpersistConnection()},de.prototype.createRecoveryKey=function(){return this.connectionKey?JSON.stringify({connectionKey:this.connectionKey,msgSerial:this.msgSerial,channelSerials:this.realtime.channels.channelSerials()}):null},de.prototype.checkConnectionStateFreshness=function(){if(!(!this.lastActivity||!this.connectionId)){var ee=d.now()-this.lastActivity;ee>this.connectionStateTtl+this.maxIdleInterval&&(b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.checkConnectionStateFreshness()","Last known activity from realtime was "+ee+"ms ago; discarding connection state"),this.clearConnection(),this.states.connecting.failState="suspended")}},de.prototype.persistConnection=function(){if(U()){var ee=this.createRecoveryKey();ee&&q({recoveryKey:ee,disconnectedAt:d.now(),location:l.location,clientId:this.realtime.auth.clientId})}},de.prototype.unpersistConnection=function(){$()},de.prototype.getError=function(){return this.errorReason||this.getStateError()},de.prototype.getStateError=function(){var ee,se;return(se=(ee=E.default)[this.state.state])===null||se===void 0?void 0:se.call(ee)},de.prototype.activeState=function(){return this.state.queueEvents||this.state.sendEvents},de.prototype.enactStateChange=function(ee){var se=ee.current==="failed"?b.default.LOG_ERROR:b.default.LOG_MAJOR;b.default.logAction(se,"Connection state",ee.current+(ee.reason?"; reason: "+ee.reason:"")),b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.enactStateChange","setting new state: "+ee.current+"; reason = "+(ee.reason&&ee.reason.message));var Y=this.state=this.states[ee.current];ee.reason&&(this.errorReason=ee.reason,this.realtime.connection.errorReason=ee.reason),(Y.terminal||Y.state==="suspended")&&this.clearConnection(),this.emit("connectionstate",ee)},de.prototype.startTransitionTimer=function(ee){var se=this;b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","transitionState: "+ee.state),this.transitionTimer&&(b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","clearing already-running timer"),clearTimeout(this.transitionTimer)),this.transitionTimer=setTimeout(function(){se.transitionTimer&&(se.transitionTimer=null,b.default.logAction(b.default.LOG_MINOR,"ConnectionManager "+ee.state+" timer expired","requesting new state: "+ee.failState),se.notifyState({state:ee.failState}))},ee.retryDelay)},de.prototype.cancelTransitionTimer=function(){b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.cancelTransitionTimer()",""),this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null)},de.prototype.startSuspendTimer=function(){var ee=this;this.suspendTimer||(this.suspendTimer=setTimeout(function(){ee.suspendTimer&&(ee.suspendTimer=null,b.default.logAction(b.default.LOG_MINOR,"ConnectionManager suspend timer expired","requesting new state: suspended"),ee.states.connecting.failState="suspended",ee.notifyState({state:"suspended"}))},this.connectionStateTtl))},de.prototype.checkSuspendTimer=function(ee){ee!=="disconnected"&&ee!=="suspended"&&ee!=="connecting"&&this.cancelSuspendTimer()},de.prototype.cancelSuspendTimer=function(){this.states.connecting.failState="disconnected",this.suspendTimer&&(clearTimeout(this.suspendTimer),this.suspendTimer=null)},de.prototype.startRetryTimer=function(ee){var se=this;this.retryTimer=setTimeout(function(){b.default.logAction(b.default.LOG_MINOR,"ConnectionManager retry timer expired","retrying"),se.retryTimer=null,se.requestState({state:"connecting"})},ee)},de.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},de.prototype.notifyState=function(ee){var se=this,Y,fe,me=ee.state,De=me==="disconnected"&&(this.state===this.states.connected||this.state===this.states.synchronizing||ee.retryImmediately||this.state===this.states.connecting&&ee.error&&A.default.isTokenErr(ee.error)&&!(this.errorReason&&A.default.isTokenErr(this.errorReason)));if(b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.notifyState()","new state: "+me+(De?"; will retry connection immediately":"")),me!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(ee.state),(me==="suspended"||me==="connected")&&(this.disconnectedRetryCount=0),!this.state.terminal)){var Le=this.states[ee.state],Ce=Le.retryDelay;Le.state==="disconnected"&&(this.disconnectedRetryCount++,Ce=d.getRetryTime(Le.retryDelay,this.disconnectedRetryCount));var Ae=new S.default(this.state.state,Le.state,Ce,ee.error||((fe=(Y=E.default)[Le.state])===null||fe===void 0?void 0:fe.call(Y)));if(De){var Ue=function(){se.state===se.states.disconnected&&(se.lastAutoReconnectAttempt=d.now(),se.requestState({state:"connecting"}))},Ne=this.lastAutoReconnectAttempt&&d.now()-this.lastAutoReconnectAttempt+1;Ne&&Ne<1e3?(b.default.logAction(b.default.LOG_MICRO,"ConnectionManager.notifyState()","Last reconnect attempt was only "+Ne+"ms ago, waiting another "+(1e3-Ne)+"ms before trying again"),setTimeout(Ue,1e3-Ne)):g.default.Config.nextTick(Ue)}else(me==="disconnected"||me==="suspended")&&this.startRetryTimer(Ce);(me==="disconnected"&&!De||me==="suspended"||Le.terminal)&&g.default.Config.nextTick(function(){se.disconnectAllTransports()}),me=="connected"&&!this.activeProtocol&&b.default.logAction(b.default.LOG_ERROR,"ConnectionManager.notifyState()","Broken invariant: attempted to go into connected state, but there is no active protocol"),this.enactStateChange(Ae),this.state.sendEvents?this.sendQueuedMessages():this.state.queueEvents||(this.realtime.channels.propogateConnectionInterruption(me,Ae.reason),this.failQueuedMessages(Ae.reason))}},de.prototype.requestState=function(ee){var se=this,Y,fe,me=ee.state;if(b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.requestState()","requested state: "+me+"; current state: "+this.state.state),me!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(me),!(me=="connecting"&&this.state.state=="connected")&&!(me=="closing"&&this.state.state=="closed"))){var De=this.states[me],Le=new S.default(this.state.state,De.state,null,ee.error||((fe=(Y=E.default)[De.state])===null||fe===void 0?void 0:fe.call(Y)));this.enactStateChange(Le),me=="connecting"&&g.default.Config.nextTick(function(){se.startConnect()}),me=="closing"&&this.closeImpl()}},de.prototype.startConnect=function(){var ee=this;if(this.state!==this.states.connecting){b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.startConnect()","Must be in connecting state to connect, but was "+this.state.state);return}var se=this.realtime.auth,Y=++this.connectCounter,fe=function(){ee.checkConnectionStateFreshness(),ee.getTransportParams(function(De){if(De.mode==="recover"&&De.options.recover){var Le=re(De.options.recover);Le&&ee.realtime.channels.recoverChannels(Le.channelSerials)}Y===ee.connectCounter&&ee.connectImpl(De,Y)})};if(b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.startConnect()","starting connection"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),se.method==="basic")fe();else{var me=function(De){Y===ee.connectCounter&&(De?ee.actOnErrorFromAuthorize(De):fe())};this.errorReason&&A.default.isTokenErr(this.errorReason)?se._forceNewToken(null,null,me):se._ensureValidAuthCredentials(!1,me)}},de.prototype.connectImpl=function(ee,se){var Y=this.state.state;Y!==this.states.connecting.state&&Y!==this.states.connected.state?b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.connectImpl()","Must be in connecting state to connect (or connected to upgrade), but was "+Y):this.pendingTransports.length?b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.connectImpl()","Transports "+this.pendingTransports[0].toString()+" currently pending; taking no action"):Y==this.states.connected.state?this.upgradeIfNeeded(ee):this.transports.length>1&&this.getTransportPreference()?this.connectPreference(ee,se):this.connectBase(ee,se)},de.prototype.connectPreference=function(ee,se){var Y=this,fe=this.getTransportPreference(),me=!1;d.arrIn(this.transports,fe)||(this.unpersistTransportPreference(),this.connectImpl(ee,se)),b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.connectPreference()","Trying to connect with stored transport preference "+fe);var De=setTimeout(function(){me=!0,Y.state.state!==Y.states.connected.state&&(b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.connectPreference()","Shortcircuit connection attempt with "+fe+" failed; clearing preference and trying from scratch"),Y.disconnectAllTransports(),Y.unpersistTransportPreference()),Y.connectImpl(ee,se)},this.options.timeouts.preferenceConnectTimeout);ee.host=this.httpHosts[0],this.tryATransport(ee,fe,function(Le,Ce){clearTimeout(De),me&&Ce?(Ce.off(),Ce.disconnect(),d.arrDeleteValue(Y.pendingTransports,Ce)):!Ce&&!Le&&(Y.unpersistTransportPreference(),Y.connectImpl(ee,se))})},de.prototype.connectBase=function(ee,se){var Y=this,fe=function(Ae){Y.notifyState({state:Y.states.connecting.failState,error:Ae})},me=this.httpHosts.slice(),De=function(Ae,Ue){se===Y.connectCounter&&!Ue&&!Ae&&Ce()};b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.connectBase()","Trying to connect with base transport "+this.baseTransport);var Le=me.shift();if(!Le){fe(new T.default("Unable to connect (no available host)",80003,404));return}ee.host=Le;var Ce=function(){if(!me.length){fe(new T.default("Unable to connect (and no more fallback hosts to try)",80003,404));return}if(!Y.realtime.http.checkConnectivity){fe(new T.PartialErrorInfo("Internal error: Http.checkConnectivity not set",null,500));return}Y.realtime.http.checkConnectivity(function(Ae,Ue){if(se===Y.connectCounter){if(Ae){fe(Ae);return}if(!Ue){fe(new T.default("Unable to connect (network unreachable)",80003,404));return}ee.host=d.arrPopRandomElement(me),Y.tryATransport(ee,Y.baseTransport,De)}})};if(this.forceFallbackHost&&me.length){this.forceFallbackHost=!1,Ce();return}this.tryATransport(ee,this.baseTransport,De)},de.prototype.getUpgradePossibilities=function(){var ee=this.activeProtocol.getTransport().shortName,se=d.arrIndexOf(this.upgradeTransports,ee);return this.upgradeTransports.slice(se+1)},de.prototype.upgradeIfNeeded=function(ee){var se=this,Y=this.getUpgradePossibilities();b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.upgradeIfNeeded()","upgrade possibilities: "+g.default.Config.inspect(Y)),Y.length&&d.arrForEach(Y,function(fe){var me=se.createTransportParams(ee.host,"upgrade");se.tryATransport(me,fe,z)})},de.prototype.closeImpl=function(){b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.closeImpl()","closing connection"),this.cancelSuspendTimer(),this.startTransitionTimer(this.states.closing),d.safeArrForEach(this.pendingTransports,function(ee){b.default.logAction(b.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing pending transport: "+ee),ee&&ee.close()}),d.safeArrForEach(this.proposedTransports,function(ee){b.default.logAction(b.default.LOG_MICRO,"ConnectionManager.closeImpl()","Disposing of proposed transport: "+ee),ee&&ee.dispose()}),this.activeProtocol&&(b.default.logAction(b.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().close()),this.notifyState({state:"closed"})},de.prototype.onAuthUpdated=function(ee,se){var Y=this,fe;switch(this.state.state){case"connected":{if(b.default.logAction(b.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Sending AUTH message on active transport"),(this.pendingTransports.length||this.proposedTransports.length)&&this.state!==this.states.synchronizing){this.disconnectAllTransports(!0);var me=this.activeProtocol.getTransport().params;g.default.Config.nextTick(function(){Y.state.state==="connected"&&Y.upgradeIfNeeded(me)})}var De=(fe=this.activeProtocol)===null||fe===void 0?void 0:fe.getTransport();De&&De.onAuthUpdated&&De.onAuthUpdated(ee);var Le=h.default.fromValues({action:F.AUTH,auth:{accessToken:ee.token}});this.send(Le);var Ce=function(){Y.off(Ae),se(null,ee)},Ae=function(Ne){Ne.current==="failed"&&(Y.off(Ce),Y.off(Ae),se(Ne.reason||Y.getStateError()))};this.once("connectiondetails",Ce),this.on("connectionstate",Ae);break}case"connecting":b.default.logAction(b.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Aborting current connection attempts in order to start again with the new auth details"),this.disconnectAllTransports();default:{b.default.logAction(b.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Connection state is "+this.state.state+"; waiting until either connected or failed");var Ue=function(Ne){switch(Ne.current){case"connected":Y.off(Ue),se(null,ee);break;case"failed":case"closed":case"suspended":Y.off(Ue),se(Ne.reason||Y.getStateError());break}};this.on("connectionstate",Ue),this.state.state==="connecting"?this.startConnect():this.requestState({state:"connecting"})}}},de.prototype.disconnectAllTransports=function(ee){b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.disconnectAllTransports()","Disconnecting all transports"+(ee?" except the active transport":"")),this.connectCounter++,d.safeArrForEach(this.pendingTransports,function(se){b.default.logAction(b.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting pending transport: "+se),se&&se.disconnect()}),this.pendingTransports=[],d.safeArrForEach(this.proposedTransports,function(se){b.default.logAction(b.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disposing of proposed transport: "+se),se&&se.dispose()}),this.proposedTransports=[],this.activeProtocol&&!ee&&(b.default.logAction(b.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().disconnect())},de.prototype.send=function(ee,se,Y){Y=Y||z;var fe=this.state;if(fe.sendEvents){b.default.logAction(b.default.LOG_MICRO,"ConnectionManager.send()","sending event"),this.sendImpl(new f.PendingMessage(ee,Y));return}var me=se&&fe.queueEvents||fe.forceQueueEvents;if(!me){var De="rejecting event, queueEvent was "+se+", state was "+fe.state;b.default.logAction(b.default.LOG_MICRO,"ConnectionManager.send()",De),Y(this.errorReason||new T.default(De,9e4,400));return}b.default.shouldLog(b.default.LOG_MICRO)&&b.default.logAction(b.default.LOG_MICRO,"ConnectionManager.send()","queueing msg; "+h.default.stringify(ee)),this.queue(ee,Y)},de.prototype.sendImpl=function(ee){var se=ee.message;ee.ackRequired&&!ee.sendAttempted&&(se.msgSerial=this.msgSerial++);try{this.activeProtocol.send(ee)}catch(Y){b.default.logAction(b.default.LOG_ERROR,"ConnectionManager.sendImpl()","Unexpected exception in transport.send(): "+Y.stack)}},de.prototype.queue=function(ee,se){b.default.logAction(b.default.LOG_MICRO,"ConnectionManager.queue()","queueing event");var Y=this.queuedMessages.last(),fe=this.options.maxMessageSize;Y&&!Y.sendAttempted&&X(Y.message,ee,fe)?(Y.merged||(Y.callback=O.default.create([Y.callback]),Y.merged=!0),Y.callback.push(se)):this.queuedMessages.push(new f.PendingMessage(ee,se))},de.prototype.sendQueuedMessages=function(){b.default.logAction(b.default.LOG_MICRO,"ConnectionManager.sendQueuedMessages()","sending "+this.queuedMessages.count()+" queued messages");for(var ee;ee=this.queuedMessages.shift();)this.sendImpl(ee)},de.prototype.queuePendingMessages=function(ee){ee&&ee.length&&(b.default.logAction(b.default.LOG_MICRO,"ConnectionManager.queuePendingMessages()","queueing "+ee.length+" pending messages"),this.queuedMessages.prepend(ee))},de.prototype.failQueuedMessages=function(ee){var se=this.queuedMessages.count();se>0&&(b.default.logAction(b.default.LOG_ERROR,"ConnectionManager.failQueuedMessages()","failing "+se+" queued messages, err = "+d.inspectError(ee)),this.queuedMessages.completeAllMessages(ee))},de.prototype.onChannelMessage=function(ee,se){var Y=this.activeProtocol&&se===this.activeProtocol.getTransport(),fe=d.arrIn(this.pendingTransports,se)&&this.state==this.states.synchronizing;Y||fe?this.realtime.channels.onChannelMessage(ee):d.arrIndexOf([F.ACK,F.NACK,F.ERROR],ee.action)>-1?this.realtime.channels.onChannelMessage(ee):b.default.logAction(b.default.LOG_MICRO,"ConnectionManager.onChannelMessage()","received message "+JSON.stringify(ee)+"on defunct transport; discarding")},de.prototype.ping=function(ee,se){var Y=this;if(ee){b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.ping()","transport = "+ee);var fe=function(){ee.off("heartbeat",Le),se(new T.default("Timeout waiting for heartbeat response",5e4,500))},me=d.now(),De=d.cheapRandStr(),Le=function(Ge){if(Ge===De){ee.off("heartbeat",Le),clearTimeout(Ce);var Ct=d.now()-me;se(null,Ct)}},Ce=setTimeout(fe,this.options.timeouts.realtimeRequestTimeout);ee.on("heartbeat",Le),ee.ping(De);return}if(this.state.state!=="connected"){se(new T.default("Unable to ping service; not connected",4e4,400));return}var Ae=!1,Ue=function(Ge,Ct){Y.off("transport.active",Ne),Ae||(Ae=!0,se(Ge,Ct))},Ne=function(){Ae||(Ae=!0,g.default.Config.nextTick(function(){Y.ping(null,se)}))};this.on("transport.active",Ne),this.ping(this.activeProtocol.getTransport(),Ue)},de.prototype.abort=function(ee){this.activeProtocol.getTransport().fail(ee)},de.prototype.registerProposedTransport=function(ee){this.proposedTransports.push(ee)},de.prototype.getTransportPreference=function(){var ee,se;return this.transportPreference||N()&&((se=(ee=g.default.WebStorage)===null||ee===void 0?void 0:ee.get)===null||se===void 0?void 0:se.call(ee,G))},de.prototype.persistTransportPreference=function(ee){var se,Y;d.arrIn(m.default.upgradeTransports,ee.shortName)&&(this.transportPreference=ee.shortName,N()&&((Y=(se=g.default.WebStorage)===null||se===void 0?void 0:se.set)===null||Y===void 0||Y.call(se,G,ee.shortName)))},de.prototype.unpersistTransportPreference=function(){var ee,se;this.transportPreference=null,N()&&((se=(ee=g.default.WebStorage)===null||ee===void 0?void 0:ee.remove)===null||se===void 0||se.call(ee,G))},de.prototype.actOnErrorFromAuthorize=function(ee){if(ee.code===40171)this.notifyState({state:"failed",error:ee});else if(ee.code===40102)this.notifyState({state:"failed",error:ee});else if(ee.statusCode===L.default.Forbidden){var se="Client configured authentication provider returned 403; failing the connection";b.default.logAction(b.default.LOG_ERROR,"ConnectionManager.actOnErrorFromAuthorize()",se),this.notifyState({state:"failed",error:new T.default(se,80019,403,ee)})}else{var se="Client configured authentication provider request failed";b.default.logAction(b.default.LOG_MINOR,"ConnectionManager.actOnErrorFromAuthorize",se),this.notifyState({state:this.state.failState,error:new T.default(se,80019,401,ee)})}},de.prototype.onConnectionDetailsUpdate=function(ee,se){if(ee){this.connectionDetails=ee,ee.maxMessageSize&&(this.options.maxMessageSize=ee.maxMessageSize);var Y=ee.clientId;if(Y){var fe=this.realtime.auth._uncheckedSetClientId(Y);if(fe){b.default.logAction(b.default.LOG_ERROR,"ConnectionManager.onConnectionDetailsUpdate()",fe.message),se.fail(fe);return}}var me=ee.connectionStateTtl;me&&(this.connectionStateTtl=me),this.maxIdleInterval=ee.maxIdleInterval,this.emit("connectiondetails",ee)}},de.supportedTransports={},de}(y.default);r.default=he}).call(this,n(13))},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=n(0),c=l.__importDefault(n(7)),h=l.__importDefault(n(2)),d=function(f){l.__extends(m,f);function m(){var g=f.call(this)||this;return g.messages=[],g}return m.prototype.count=function(){return this.messages.length},m.prototype.push=function(g){this.messages.push(g)},m.prototype.shift=function(){return this.messages.shift()},m.prototype.last=function(){return this.messages[this.messages.length-1]},m.prototype.copyAll=function(){return this.messages.slice()},m.prototype.append=function(g){this.messages.push.apply(this.messages,g)},m.prototype.prepend=function(g){this.messages.unshift.apply(this.messages,g)},m.prototype.completeMessages=function(g,y,_){h.default.logAction(h.default.LOG_MICRO,"MessageQueue.completeMessages()","serial = "+g+"; count = "+y),_=_||null;var b=this.messages;if(b.length===0)throw new Error("MessageQueue.completeMessages(): completeMessages called on any empty MessageQueue");var S=b[0];if(S){var E=S.message.msgSerial,T=g+y;if(T>E)for(var A=b.splice(0,T-E),P=0,O=A;P<O.length;P++){var R=O[P];R.callback(_)}b.length==0&&this.emit("idle")}},m.prototype.completeAllMessages=function(g){this.completeMessages(0,Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,g)},m.prototype.resetSendAttempted=function(){for(var g=0,y=this.messages;g<y.length;g++){var _=y[g];_.sendAttempted=!1}},m.prototype.clear=function(){h.default.logAction(h.default.LOG_MICRO,"MessageQueue.clear()","clearing "+this.messages.length+" messages"),this.messages=[],this.emit("idle")},m}(c.default);r.default=d},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function c(h,d,f,m){this.previous=h,this.current=d,f&&(this.retryIn=f),m&&(this.reason=m)}return c}();r.default=l},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=n(0),c=l.__importDefault(n(10)),h=l.__importDefault(n(7)),d=l.__importStar(n(1)),f=l.__importDefault(n(33)),m=l.__importDefault(n(2)),g=l.__importDefault(n(54)),y=l.__importDefault(n(9)),_=l.__importDefault(n(39)),b=l.__importStar(n(4)),S=l.__importDefault(n(15)),E=l.__importDefault(n(20)),T=c.default.Action,A=function(){};function P(D){if(D&&"params"in D&&!d.isObject(D.params))return new b.default("options.params must be an object",4e4,400);if(D&&"modes"in D){if(!d.isArray(D.modes))return new b.default("options.modes must be an array",4e4,400);for(var L=0;L<D.modes.length;L++){var N=D.modes[L];if(!N||typeof N!="string"||!d.arrIn(c.default.channelModes,String.prototype.toUpperCase.call(N)))return new b.default("Invalid channel mode: "+N,4e4,400)}}}var O=function(D){l.__extends(L,D);function L(N,U,F){var z=D.call(this,N,U,F)||this;return z.retryCount=0,z.history=function(G,J){if(m.default.logAction(m.default.LOG_MICRO,"RealtimeChannel.history()","channel = "+this.name),J===void 0)if(typeof G=="function")J=G,G=null;else{if(this.rest.options.promises)return d.promisify(this,"history",arguments);J=A}if(G&&G.untilAttach){if(this.state!=="attached"){J(new b.default("option untilAttach requires the channel to be attached",4e4,400));return}if(!this.properties.attachSerial){J(new b.default("untilAttach was specified and channel is attached, but attachSerial is not defined",4e4,400));return}delete G.untilAttach,G.from_serial=this.properties.attachSerial}f.default.prototype._history.call(this,G,J)},z.whenState=function(G,J){return h.default.prototype.whenState.call(z,G,z.state,J)},m.default.logAction(m.default.LOG_MINOR,"RealtimeChannel()","started; name = "+U),z.realtime=N,z.presence=new g.default(z),z.connectionManager=N.connection.connectionManager,z.state="initialized",z.subscriptions=new h.default,z.syncChannelSerial=void 0,z.properties={attachSerial:void 0,channelSerial:void 0},z.setOptions(F),z.errorReason=null,z._requestedFlags=null,z._mode=null,z._attachResume=!1,z._decodingContext={channelOptions:z.channelOptions,plugins:N.options.plugins||{},baseEncodedPreviousPayload:void 0},z._lastPayload={messageId:null,protocolMessageChannelSerial:null,decodeFailureRecoveryInProgress:null},z._allChannelChanges=new h.default,z}return L.prototype.invalidStateError=function(){return new b.default("Channel operation failed as channel state is "+this.state,90001,400,this.errorReason||void 0)},L.processListenerArgs=function(N){return N=Array.prototype.slice.call(N),typeof N[0]=="function"&&N.unshift(null),N[N.length-1]==null&&N.pop(),N},L.prototype.setOptions=function(N,U){var F=this.channelOptions;if(!U&&this.rest.options.promises)return d.promisify(this,"setOptions",arguments);var z=U||function(J){J&&m.default.logAction(m.default.LOG_ERROR,"RealtimeChannel.setOptions()","Set options failed: "+J.toString())},G=P(N);if(G){z(G);return}f.default.prototype.setOptions.call(this,N),this._decodingContext&&(this._decodingContext.channelOptions=this.channelOptions),this._shouldReattachToSetOptions(N,F)?(this.attachImpl(),this._allChannelChanges.once(["attached","update","detached","failed"],function(J){switch(this.event){case"update":case"attached":z==null||z(null);return;default:z==null||z(J.reason);return}})):z()},L.prototype._shouldReattachToSetOptions=function(N,U){if(!(this.state==="attached"||this.state==="attaching"))return!1;if(N!=null&&N.params){var F=R(N.params),z=R(U.params);if(Object.keys(F).length!==Object.keys(z).length||!d.shallowEquals(z,F))return!0}return!!(N!=null&&N.modes&&(!U.modes||!d.arrEquals(N.modes,U.modes)))},L.prototype.publish=function(){for(var N=this,U=[],F=0;F<arguments.length;F++)U[F]=arguments[F];var z=U[0],G=U.length,J=U[G-1];if(typeof J!="function"){if(this.realtime.options.promises)return d.promisify(this,"publish",arguments);J=A,++G}if(!this.connectionManager.activeState()){J(this.connectionManager.getError());return}if(G==2)if(d.isObject(z))z=[y.default.fromValues(z)];else if(d.isArray(z))z=y.default.fromValuesArray(z);else throw new b.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);else z=[y.default.fromValues({name:U[0],data:U[1]})];var Z=this.realtime.options.maxMessageSize;y.default.encodeArray(z,this.channelOptions,function(q){if(q){J(q);return}var $=y.default.getMessagesSize(z);if($>Z){J(new b.default("Maximum size of messages that can be published at once exceeded ( was "+$+" bytes; limit is "+Z+" bytes)",40009,400));return}N.__publish(z,J)})},L.prototype.__publish=function(N,U){m.default.logAction(m.default.LOG_MICRO,"RealtimeChannel.publish()","message count = "+N.length);var F=this.state;switch(F){case"failed":case"suspended":U(b.default.fromValues(this.invalidStateError()));break;default:{m.default.logAction(m.default.LOG_MICRO,"RealtimeChannel.publish()","sending message; channel state is "+F);var z=new c.default;z.action=T.MESSAGE,z.channel=this.name,z.messages=N,this.sendMessage(z,U);break}}},L.prototype.onEvent=function(N){m.default.logAction(m.default.LOG_MICRO,"RealtimeChannel.onEvent()","received message");for(var U=this.subscriptions,F=0;F<N.length;F++){var z=N[F];U.emit(z.name,z)}},L.prototype.attach=function(N,U){var F;if(typeof N=="function"?(U=N,F=null):F=N,!U){if(this.realtime.options.promises)return d.promisify(this,"attach",arguments);U=function(z){z&&m.default.logAction(m.default.LOG_MAJOR,"RealtimeChannel.attach()","Channel attach failed: "+z.toString())}}if(F)m.default.deprecated("channel.attach() with flags","channel.setOptions() with channelOptions.params"),this._requestedFlags=F;else if(this.state==="attached"){U(null,null);return}this._attach(!1,null,U)},L.prototype._attach=function(N,U,F){F||(F=function(G){G&&m.default.logAction(m.default.LOG_ERROR,"RealtimeChannel._attach()","Channel attach failed: "+G.toString())});var z=this.connectionManager;if(!z.activeState()){F(z.getError());return}(this.state!=="attaching"||N)&&this.requestState("attaching",U),this.once(function(G){switch(this.event){case"attached":F==null||F(null,G);break;case"detached":case"suspended":case"failed":F==null||F(G.reason||z.getError()||new b.default("Unable to attach; reason unknown; state = "+this.event,9e4,500));break;case"detaching":F==null||F(new b.default("Attach request superseded by a subsequent detach request",9e4,409));break}})},L.prototype.attachImpl=function(){m.default.logAction(m.default.LOG_MICRO,"RealtimeChannel.attachImpl()","sending ATTACH message");var N=c.default.fromValues({action:T.ATTACH,channel:this.name,params:this.channelOptions.params,channelSerial:this.properties.channelSerial});this._requestedFlags?N.encodeModesToFlags(this._requestedFlags):this.channelOptions.modes&&N.encodeModesToFlags(d.allToUpperCase(this.channelOptions.modes)),this._attachResume&&N.setFlag("ATTACH_RESUME"),this._lastPayload.decodeFailureRecoveryInProgress&&(N.channelSerial=this._lastPayload.protocolMessageChannelSerial),this.sendMessage(N,A)},L.prototype.detach=function(N){if(!N){if(this.realtime.options.promises)return d.promisify(this,"detach",arguments);N=A}var U=this.connectionManager;if(!U.activeState()){N(U.getError());return}switch(this.state){case"suspended":this.notifyState("detached"),N();break;case"detached":N();break;case"failed":N(new b.default("Unable to detach; channel state = failed",90001,400));break;default:this.requestState("detaching");case"detaching":this.once(function(F){switch(this.event){case"detached":N();break;case"attached":case"suspended":case"failed":N(F.reason||U.getError()||new b.default("Unable to detach; reason unknown; state = "+this.event,9e4,500));break;case"attaching":N(new b.default("Detach request superseded by a subsequent attach request",9e4,409));break}})}},L.prototype.detachImpl=function(N){m.default.logAction(m.default.LOG_MICRO,"RealtimeChannel.detach()","sending DETACH message");var U=c.default.fromValues({action:T.DETACH,channel:this.name});this.sendMessage(U,N||A)},L.prototype.subscribe=function(){for(var N=[],U=0;U<arguments.length;U++)N[U]=arguments[U];var F=L.processListenerArgs(N),z=F[0],G=F[1],J=F[2];if(!J&&this.realtime.options.promises)return d.promisify(this,"subscribe",[z,G]);if(this.state==="failed"){J==null||J(b.default.fromValues(this.invalidStateError()));return}return z&&typeof z=="object"&&!Array.isArray(z)?this._subscribeFilter(z,G):this.subscriptions.on(z,G),this.attach(J||A)},L.prototype._subscribeFilter=function(N,U){var F=function(z){var G,J,Z,q,$,H,X={name:z.name,refTimeserial:(J=(G=z.extras)===null||G===void 0?void 0:G.ref)===null||J===void 0?void 0:J.timeserial,refType:(q=(Z=z.extras)===null||Z===void 0?void 0:Z.ref)===null||q===void 0?void 0:q.type,isRef:!!(!((H=($=z.extras)===null||$===void 0?void 0:$.ref)===null||H===void 0)&&H.timeserial),clientId:z.clientId};Object.entries(N).find(function(re){var ae=re[0],he=re[1];return he!==void 0?X[ae]!==he:!1})||U(z)};this._addFilteredSubscription(N,U,F),this.subscriptions.on(F)},L.prototype._addFilteredSubscription=function(N,U,F){var z;if(this.filteredSubscriptions||(this.filteredSubscriptions=new Map),this.filteredSubscriptions.has(U)){var G=this.filteredSubscriptions.get(U);G.set(N,((z=G==null?void 0:G.get(N))===null||z===void 0?void 0:z.concat(F))||[F])}else this.filteredSubscriptions.set(U,new Map([[N,[F]]]))},L.prototype._getAndDeleteFilteredSubscriptions=function(N,U){var F=this;if(!this.filteredSubscriptions)return[];if(!U&&N)return Array.from(this.filteredSubscriptions.entries()).map(function(Z){var q,$=Z[0],H=Z[1],X=H.get(N);return H.delete(N),H.size===0&&((q=F.filteredSubscriptions)===null||q===void 0||q.delete($)),X}).reduce(function(Z,q){var $;return q?($=Z).concat.apply($,q):Z},[]);if(!U||!this.filteredSubscriptions.has(U))return[];var z=this.filteredSubscriptions.get(U);if(!N){var G=Array.from(z.values()).reduce(function(Z,q){return Z.concat.apply(Z,q)},[]);return this.filteredSubscriptions.delete(U),G}var J=z.get(N);return z.delete(N),J||[]},L.prototype.unsubscribe=function(){for(var N=this,U,F=[],z=0;z<arguments.length;z++)F[z]=arguments[z];var G=L.processListenerArgs(F),J=G[0],Z=G[1];if(typeof J=="object"&&!Z||!((U=this.filteredSubscriptions)===null||U===void 0)&&U.has(Z)){this._getAndDeleteFilteredSubscriptions(J,Z).forEach(function(q){return N.subscriptions.off(q)});return}this.subscriptions.off(J,Z)},L.prototype.sync=function(){switch(this.state){case"initialized":case"detaching":case"detached":throw new b.PartialErrorInfo("Unable to sync to channel; not attached",4e4)}var N=this.connectionManager;if(!N.activeState())throw N.getError();var U=c.default.fromValues({action:T.SYNC,channel:this.name});this.syncChannelSerial&&(U.channelSerial=this.syncChannelSerial),N.send(U)},L.prototype.sendMessage=function(N,U){this.connectionManager.send(N,this.realtime.options.queueMessages,U)},L.prototype.sendPresence=function(N,U){var F=c.default.fromValues({action:T.PRESENCE,channel:this.name,presence:d.isArray(N)?S.default.fromValuesArray(N):[S.default.fromValues(N)]});this.sendMessage(F,U)},L.prototype.onMessage=function(N){(N.action===T.ATTACHED||N.action===T.MESSAGE||N.action===T.PRESENCE)&&this.setChannelSerial(N.channelSerial);var U,F=!1;switch(N.action){case T.ATTACHED:{this.properties.attachSerial=N.channelSerial,this._mode=N.getMode(),this.params=N.params||{};var z=N.decodeModesFromFlags();this.modes=z&&d.allToLowerCase(z)||void 0;var G=N.hasFlag("RESUMED"),J=N.hasFlag("HAS_PRESENCE"),Z=N.hasFlag("HAS_BACKLOG");if(this.state==="attached"){G||this.presence.onAttached(J);var q=new _.default(this.state,this.state,G,Z,N.error);this._allChannelChanges.emit("update",q),(!G||this.channelOptions.updateOnAttached)&&this.emit("update",q)}else this.state==="detaching"?this.checkPendingState():this.notifyState("attached",N.error,G,J,Z);break}case T.DETACHED:{var $=N.error?b.default.fromValues(N.error):new b.default("Channel detached",90001,404);this.state==="detaching"?this.notifyState("detached",$):this.state==="attaching"?this.notifyState("suspended",$):this.requestState("attaching",$);break}case T.SYNC:if(F=!0,U=this.syncChannelSerial=N.channelSerial,!N.presence)break;case T.PRESENCE:{for(var H=N.presence,X=N.id,re=N.connectionId,ae=N.timestamp,he=this.channelOptions,pe=void 0,de=0;de<H.length;de++)try{pe=H[de],S.default.decode(pe,he),pe.connectionId||(pe.connectionId=re),pe.timestamp||(pe.timestamp=ae),pe.id||(pe.id=X+":"+de)}catch(De){m.default.logAction(m.default.LOG_ERROR,"RealtimeChannel.onMessage()",De.toString())}this.presence.setPresence(H,F,U);break}case T.MESSAGE:{if(this.state!=="attached"){m.default.logAction(m.default.LOG_MAJOR,"RealtimeChannel.onMessage()",'Message "'+N.id+'" skipped as this channel "'+this.name+'" state is not "attached" (state is "'+this.state+'").');return}var ee=N.messages,se=ee[0],Y=ee[ee.length-1],X=N.id,re=N.connectionId,ae=N.timestamp;if(se.extras&&se.extras.delta&&se.extras.delta.from!==this._lastPayload.messageId){var fe='Delta message decode failure - previous message not available for message "'+N.id+'" on this channel "'+this.name+'".';m.default.logAction(m.default.LOG_ERROR,"RealtimeChannel.onMessage()",fe),this._startDecodeFailureRecovery(new b.default(fe,40018,400));break}for(var de=0;de<ee.length;de++){var fe=ee[de];try{y.default.decode(fe,this._decodingContext)}catch(Ne){switch(m.default.logAction(m.default.LOG_ERROR,"RealtimeChannel.onMessage()",Ne.toString()),Ne.code){case 40018:this._startDecodeFailureRecovery(Ne);return;case 40019:case 40021:this.notifyState("failed",Ne);return}}fe.connectionId||(fe.connectionId=re),fe.timestamp||(fe.timestamp=ae),fe.id||(fe.id=X+":"+de)}this._lastPayload.messageId=Y.id,this._lastPayload.protocolMessageChannelSerial=N.channelSerial,this.onEvent(ee);break}case T.ERROR:{var me=N.error;me&&me.code==80016?this.checkPendingState():this.notifyState("failed",b.default.fromValues(me));break}default:m.default.logAction(m.default.LOG_ERROR,"RealtimeChannel.onMessage()","Fatal protocol error: unrecognised action ("+N.action+")"),this.connectionManager.abort(E.default.unknownChannelErr())}},L.prototype._startDecodeFailureRecovery=function(N){var U=this;this._lastPayload.decodeFailureRecoveryInProgress||(m.default.logAction(m.default.LOG_MAJOR,"RealtimeChannel.onMessage()","Starting decode failure recovery process."),this._lastPayload.decodeFailureRecoveryInProgress=!0,this._attach(!0,N,function(){U._lastPayload.decodeFailureRecoveryInProgress=!1}))},L.prototype.onAttached=function(){m.default.logAction(m.default.LOG_MINOR,"RealtimeChannel.onAttached","activating channel; name = "+this.name)},L.prototype.notifyState=function(N,U,F,z,G){if(m.default.logAction(m.default.LOG_MICRO,"RealtimeChannel.notifyState","name = "+this.name+", current state = "+this.state+", notifying state "+N),this.clearStateTimer(),d.arrIn(["detached","suspended","failed"],N)&&(this.properties.channelSerial=null),N!==this.state){this.presence.actOnChannelState(N,z,U),N==="suspended"&&this.connectionManager.state.sendEvents?this.startRetryTimer():this.cancelRetryTimer(),U&&(this.errorReason=U);var J=new _.default(this.state,N,F,G,U),Z=N==="failed"?m.default.LOG_ERROR:m.default.LOG_MAJOR;m.default.logAction(Z,'Channel state for channel "'+this.name+'"',N+(U?"; reason: "+U:"")),N!=="attaching"&&N!=="suspended"&&(this.retryCount=0),N==="attached"&&this.onAttached(),N==="attached"?this._attachResume=!0:(N==="detaching"||N==="failed")&&(this._attachResume=!1),this.state=N,this._allChannelChanges.emit(N,J),this.emit(N,J)}},L.prototype.requestState=function(N,U){m.default.logAction(m.default.LOG_MINOR,"RealtimeChannel.requestState","name = "+this.name+", state = "+N),this.notifyState(N,U),this.checkPendingState()},L.prototype.checkPendingState=function(){var N=this.connectionManager.state;if(!(N.sendEvents||N.forceQueueEvents)){m.default.logAction(m.default.LOG_MINOR,"RealtimeChannel.checkPendingState","sendEvents is false; state is "+this.connectionManager.state.state);return}switch(m.default.logAction(m.default.LOG_MINOR,"RealtimeChannel.checkPendingState","name = "+this.name+", state = "+this.state),this.state){case"attaching":this.startStateTimerIfNotRunning(),this.attachImpl();break;case"detaching":this.startStateTimerIfNotRunning(),this.detachImpl();break;case"attached":this.sync();break}},L.prototype.timeoutPendingState=function(){switch(this.state){case"attaching":{var N=new b.default("Channel attach timed out",90007,408);this.notifyState("suspended",N);break}case"detaching":{var N=new b.default("Channel detach timed out",90007,408);this.notifyState("attached",N);break}default:this.checkPendingState();break}},L.prototype.startStateTimerIfNotRunning=function(){var N=this;this.stateTimer||(this.stateTimer=setTimeout(function(){m.default.logAction(m.default.LOG_MINOR,"RealtimeChannel.startStateTimerIfNotRunning","timer expired"),N.stateTimer=null,N.timeoutPendingState()},this.realtime.options.timeouts.realtimeRequestTimeout))},L.prototype.clearStateTimer=function(){var N=this.stateTimer;N&&(clearTimeout(N),this.stateTimer=null)},L.prototype.startRetryTimer=function(){var N=this;if(!this.retryTimer){this.retryCount++;var U=d.getRetryTime(this.realtime.options.timeouts.channelRetryTimeout,this.retryCount);this.retryTimer=setTimeout(function(){N.state==="suspended"&&N.connectionManager.state.sendEvents&&(N.retryTimer=null,m.default.logAction(m.default.LOG_MINOR,"RealtimeChannel retry timer expired","attempting a new attach"),N.requestState("attaching"))},U)}},L.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},L.prototype.getReleaseErr=function(){var N=this.state;return N==="initialized"||N==="detached"||N==="failed"?null:new b.default("Can only release a channel in a state where there is no possibility of further updates from the server being received (initialized, detached, or failed); was "+N,90001,400)},L.prototype.setChannelSerial=function(N){m.default.logAction(m.default.LOG_MICRO,"RealtimeChannel.setChannelSerial()","Updating channel serial; serial = "+N+"; previous = "+this.properties.channelSerial),N&&(this.properties.channelSerial=N)},L}(f.default);function R(D){var L=D||{};L.agent;var N=l.__rest(L,["agent"]);return N}r.default=O},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function c(h,d,f,m,g){this.previous=h,this.current=d,d==="attached"&&(this.resumed=f,this.hasBacklog=m),g&&(this.reason=g)}return c}();r.default=l},function(t,r,n){(function(l,c){t.exports=c(n(6))})(this,function(l){return function(){var c=l,h=c.lib,d=h.WordArray,f=h.Hasher,m=c.algo,g=[],y=m.SHA1=f.extend({_doReset:function(){this._hash=new d.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(_,b){for(var S=this._hash.words,E=S[0],T=S[1],A=S[2],P=S[3],O=S[4],R=0;R<80;R++){if(R<16)g[R]=_[b+R]|0;else{var D=g[R-3]^g[R-8]^g[R-14]^g[R-16];g[R]=D<<1|D>>>31}var L=(E<<5|E>>>27)+O+g[R];R<20?L+=(T&A|~T&P)+1518500249:R<40?L+=(T^A^P)+1859775393:R<60?L+=(T&A|T&P|A&P)-1894007588:L+=(T^A^P)-899497514,O=P,P=A,A=T<<30|T>>>2,T=E,E=L}S[0]=S[0]+E|0,S[1]=S[1]+T|0,S[2]=S[2]+A|0,S[3]=S[3]+P|0,S[4]=S[4]+O|0},_doFinalize:function(){var _=this._data,b=_.words,S=this._nDataBytes*8,E=_.sigBytes*8;return b[E>>>5]|=128<<24-E%32,b[(E+64>>>9<<4)+14]=Math.floor(S/4294967296),b[(E+64>>>9<<4)+15]=S,_.sigBytes=b.length*4,this._process(),this._hash},clone:function(){var _=f.clone.call(this);return _._hash=this._hash.clone(),_}});c.SHA1=f._createHelper(y),c.HmacSHA1=f._createHmacHelper(y)}(),l.SHA1})},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});function l(R){if(R===void 0)return"undefined";var D,L;if(R instanceof ArrayBuffer?(L="ArrayBuffer",D=new DataView(R)):R instanceof DataView&&(L="DataView",D=R),!D)return JSON.stringify(R);for(var N=[],U=0;U<R.byteLength;U++){if(U>20){N.push("...");break}var F=D.getUint8(U).toString(16);F.length===1&&(F="0"+F),N.push(F)}return"<"+L+" "+N.join(" ")+">"}function c(R,D,L){for(var N=0,U=L.length;N<U;N++){var F=L.charCodeAt(N);if(F<128){R.setUint8(D++,F>>>0&127|0);continue}if(F<2048){R.setUint8(D++,F>>>6&31|192),R.setUint8(D++,F>>>0&63|128);continue}if(F<65536){R.setUint8(D++,F>>>12&15|224),R.setUint8(D++,F>>>6&63|128),R.setUint8(D++,F>>>0&63|128);continue}if(F<1114112){R.setUint8(D++,F>>>18&7|240),R.setUint8(D++,F>>>12&63|128),R.setUint8(D++,F>>>6&63|128),R.setUint8(D++,F>>>0&63|128);continue}throw new Error("bad codepoint "+F)}}function h(R,D,L){for(var N="",U=D,F=D+L;U<F;U++){var z=R.getUint8(U);if(!(z&128)){N+=String.fromCharCode(z);continue}if((z&224)===192){N+=String.fromCharCode((z&15)<<6|R.getUint8(++U)&63);continue}if((z&240)===224){N+=String.fromCharCode((z&15)<<12|(R.getUint8(++U)&63)<<6|(R.getUint8(++U)&63)<<0);continue}if((z&248)===240){N+=String.fromCharCode((z&7)<<18|(R.getUint8(++U)&63)<<12|(R.getUint8(++U)&63)<<6|(R.getUint8(++U)&63)<<0);continue}throw new Error("Invalid byte "+z.toString(16))}return N}function d(R){for(var D=0,L=0,N=R.length;L<N;L++){var U=R.charCodeAt(L);if(U<128){D+=1;continue}if(U<2048){D+=2;continue}if(U<65536){D+=3;continue}if(U<1114112){D+=4;continue}throw new Error("bad codepoint "+U)}return D}function f(R,D){var L=O(R,D);if(L!==0){var N=new ArrayBuffer(L),U=new DataView(N);return P(R,U,0,D),N}}var m=65536*65536,g=1/m;function y(R,D){return D=D||0,R.getInt32(D)*m+R.getUint32(D+4)}function _(R,D){return D=D||0,R.getUint32(D)*m+R.getUint32(D+4)}function b(R,D,L){L<9223372036854776e3?(R.setInt32(D,Math.floor(L*g)),R.setInt32(D+4,L&-1)):(R.setUint32(D,2147483647),R.setUint32(D+4,2147483647))}function S(R,D,L){L<18446744073709552e3?(R.setUint32(D,Math.floor(L*g)),R.setInt32(D+4,L&-1)):(R.setUint32(D,4294967295),R.setUint32(D+4,4294967295))}var E=function(){function R(D,L){var N=this;this.map=function(U){for(var F={},z=0;z<U;z++){var G=N.parse();F[G]=N.parse()}return F},this.bin=function(U){var F=new ArrayBuffer(U);return new Uint8Array(F).set(new Uint8Array(N.view.buffer,N.offset,U),0),N.offset+=U,F},this.buf=this.bin,this.str=function(U){var F=h(N.view,N.offset,U);return N.offset+=U,F},this.array=function(U){for(var F=new Array(U),z=0;z<U;z++)F[z]=N.parse();return F},this.ext=function(U){return N.offset+=U,{type:N.view.getInt8(N.offset),data:N.buf(U)}},this.parse=function(){var U=N.view.getUint8(N.offset),F,z;if(!(U&128))return N.offset++,U;if((U&240)===128)return z=U&15,N.offset++,N.map(z);if((U&240)===144)return z=U&15,N.offset++,N.array(z);if((U&224)===160)return z=U&31,N.offset++,N.str(z);if((U&224)===224)return F=N.view.getInt8(N.offset),N.offset++,F;switch(U){case 192:return N.offset++,null;case 193:N.offset++;return;case 194:return N.offset++,!1;case 195:return N.offset++,!0;case 196:return z=N.view.getUint8(N.offset+1),N.offset+=2,N.bin(z);case 197:return z=N.view.getUint16(N.offset+1),N.offset+=3,N.bin(z);case 198:return z=N.view.getUint32(N.offset+1),N.offset+=5,N.bin(z);case 199:return z=N.view.getUint8(N.offset+1),N.offset+=2,N.ext(z);case 200:return z=N.view.getUint16(N.offset+1),N.offset+=3,N.ext(z);case 201:return z=N.view.getUint32(N.offset+1),N.offset+=5,N.ext(z);case 202:return F=N.view.getFloat32(N.offset+1),N.offset+=5,F;case 203:return F=N.view.getFloat64(N.offset+1),N.offset+=9,F;case 204:return F=N.view.getUint8(N.offset+1),N.offset+=2,F;case 205:return F=N.view.getUint16(N.offset+1),N.offset+=3,F;case 206:return F=N.view.getUint32(N.offset+1),N.offset+=5,F;case 207:return F=_(N.view,N.offset+1),N.offset+=9,F;case 208:return F=N.view.getInt8(N.offset+1),N.offset+=2,F;case 209:return F=N.view.getInt16(N.offset+1),N.offset+=3,F;case 210:return F=N.view.getInt32(N.offset+1),N.offset+=5,F;case 211:return F=y(N.view,N.offset+1),N.offset+=9,F;case 212:return z=1,N.offset++,N.ext(z);case 213:return z=2,N.offset++,N.ext(z);case 214:return z=4,N.offset++,N.ext(z);case 215:return z=8,N.offset++,N.ext(z);case 216:return z=16,N.offset++,N.ext(z);case 217:return z=N.view.getUint8(N.offset+1),N.offset+=2,N.str(z);case 218:return z=N.view.getUint16(N.offset+1),N.offset+=3,N.str(z);case 219:return z=N.view.getUint32(N.offset+1),N.offset+=5,N.str(z);case 220:return z=N.view.getUint16(N.offset+1),N.offset+=3,N.array(z);case 221:return z=N.view.getUint32(N.offset+1),N.offset+=5,N.array(z);case 222:return z=N.view.getUint16(N.offset+1),N.offset+=3,N.map(z);case 223:return z=N.view.getUint32(N.offset+1),N.offset+=5,N.map(z)}throw new Error("Unknown type 0x"+U.toString(16))},this.offset=L||0,this.view=D}return R}();function T(R){var D=new DataView(R),L=new E(D),N=L.parse();if(L.offset!==R.byteLength)throw new Error(R.byteLength-L.offset+" trailing bytes");return N}function A(R,D){return Object.keys(R).filter(function(L){var N=R[L],U=typeof N;return(!D||N!=null)&&(U!=="function"||!!N.toJSON)})}function P(R,D,L,N){var U=typeof R;if(typeof R=="string"){var F=d(R);if(F<32)return D.setUint8(L,F|160),c(D,L+1,R),1+F;if(F<256)return D.setUint8(L,217),D.setUint8(L+1,F),c(D,L+2,R),2+F;if(F<65536)return D.setUint8(L,218),D.setUint16(L+1,F),c(D,L+3,R),3+F;if(F<4294967296)return D.setUint8(L,219),D.setUint32(L+1,F),c(D,L+5,R),5+F}if(ArrayBuffer.isView&&ArrayBuffer.isView(R)&&(R=R.buffer),R instanceof ArrayBuffer){var z=R.byteLength;if(z<256)return D.setUint8(L,196),D.setUint8(L+1,z),new Uint8Array(D.buffer).set(new Uint8Array(R),L+2),2+z;if(z<65536)return D.setUint8(L,197),D.setUint16(L+1,z),new Uint8Array(D.buffer).set(new Uint8Array(R),L+3),3+z;if(z<4294967296)return D.setUint8(L,198),D.setUint32(L+1,z),new Uint8Array(D.buffer).set(new Uint8Array(R),L+5),5+z}if(typeof R=="number"){if(Math.floor(R)!==R)return D.setUint8(L,203),D.setFloat64(L+1,R),9;if(R>=0){if(R<128)return D.setUint8(L,R),1;if(R<256)return D.setUint8(L,204),D.setUint8(L+1,R),2;if(R<65536)return D.setUint8(L,205),D.setUint16(L+1,R),3;if(R<4294967296)return D.setUint8(L,206),D.setUint32(L+1,R),5;if(R<18446744073709552e3)return D.setUint8(L,207),S(D,L+1,R),9;throw new Error("Number too big 0x"+R.toString(16))}if(R>=-32)return D.setInt8(L,R),1;if(R>=-128)return D.setUint8(L,208),D.setInt8(L+1,R),2;if(R>=-32768)return D.setUint8(L,209),D.setInt16(L+1,R),3;if(R>=-2147483648)return D.setUint8(L,210),D.setInt32(L+1,R),5;if(R>=-9223372036854776e3)return D.setUint8(L,211),b(D,L+1,R),9;throw new Error("Number too small -0x"+(-R).toString(16).substr(1))}if(U==="undefined")return N?0:(D.setUint8(L,212),D.setUint8(L+1,0),D.setUint8(L+2,0),3);if(R===null)return N?0:(D.setUint8(L,192),1);if(U==="boolean")return D.setUint8(L,R?195:194),1;if(typeof R.toJSON=="function")return P(R.toJSON(),D,L,N);if(U==="object"){var G,J=0,Z=void 0,q=Array.isArray(R);if(q?G=R.length:(Z=A(R,N),G=Z.length),G<16?(D.setUint8(L,G|(q?144:128)),J=1):G<65536?(D.setUint8(L,q?220:222),D.setUint16(L+1,G),J=3):G<4294967296&&(D.setUint8(L,q?221:223),D.setUint32(L+1,G),J=5),q)for(var $=0;$<G;$++)J+=P(R[$],D,L+J,N);else if(Z)for(var $=0;$<G;$++){var H=Z[$];J+=P(H,D,L+J),J+=P(R[H],D,L+J,N)}return J}if(U==="function")return 0;throw new Error("Unknown type "+U)}function O(R,D){var L=typeof R;if(L==="string"){var N=d(R);if(N<32)return 1+N;if(N<256)return 2+N;if(N<65536)return 3+N;if(N<4294967296)return 5+N}if(ArrayBuffer.isView&&ArrayBuffer.isView(R)&&(R=R.buffer),R instanceof ArrayBuffer){var U=R.byteLength;if(U<256)return 2+U;if(U<65536)return 3+U;if(U<4294967296)return 5+U}if(typeof R=="number"){if(Math.floor(R)!==R)return 9;if(R>=0){if(R<128)return 1;if(R<256)return 2;if(R<65536)return 3;if(R<4294967296)return 5;if(R<18446744073709552e3)return 9;throw new Error("Number too big 0x"+R.toString(16))}if(R>=-32)return 1;if(R>=-128)return 2;if(R>=-32768)return 3;if(R>=-2147483648)return 5;if(R>=-9223372036854776e3)return 9;throw new Error("Number too small -0x"+R.toString(16).substr(1))}if(L==="boolean")return 1;if(R===null)return D?0:1;if(R===void 0)return D?0:3;if(typeof R.toJSON=="function")return O(R.toJSON(),D);if(L==="object"){var F,z=0;if(Array.isArray(R)){F=R.length;for(var G=0;G<F;G++)z+=O(R[G],D)}else{var J=A(R,D);F=J.length;for(var G=0;G<F;G++){var Z=J[G];z+=O(Z)+O(R[Z],D)}}if(F<16)return 1+z;if(F<65536)return 3+z;if(F<4294967296)return 5+z;throw new Error("Array or object too long 0x"+F.toString(16))}if(L==="function")return 0;throw new Error("Unknown type "+L)}r.default={encode:f,decode:T,inspect:l,utf8Write:c,utf8Read:h,utf8ByteCount:d}},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=n(0),c=l.__importDefault(n(30)),h=l.__importDefault(n(50)),d=l.__importDefault(n(3)),f=l.__importDefault(n(4)),m=l.__importDefault(n(55)),g=l.__importDefault(n(57)),y=l.__importDefault(n(62)),_=l.__importDefault(n(64)),b=l.__importDefault(n(68)),S=l.__importDefault(n(2)),E=n(8),T=l.__importDefault(n(65)),A=l.__importDefault(n(66)),P=l.__importDefault(n(41)),O=(0,g.default)(_.default,m.default);d.default.Crypto=O,d.default.BufferUtils=m.default,d.default.Http=y.default,d.default.Config=_.default,d.default.Transports=b.default,d.default.WebStorage=T.default,c.default.Crypto=O,h.default.Crypto=O,S.default.initLogHandlers(),d.default.Defaults=(0,E.getDefaults)(A.default),d.default.Config.agent&&(d.default.Defaults.agent+=" "+d.default.Config.agent),d.default.Config.noUpgrade&&(d.default.Defaults.upgradeTransports=[]),r.default={ErrorInfo:f.default,Rest:c.default,Realtime:h.default,msgpack:P.default}},function(t){t.exports=JSON.parse('{"name":"ably","description":"Realtime client library for Ably, the realtime messaging service","version":"1.2.49","license":"Apache-2.0","bugs":{"url":"https://github.com/ably/ably-js/issues","email":"support@ably.com"},"main":"./build/ably-node.js","typings":"./ably.d.ts","react-native":{"./build/ably-node.js":"./build/ably-reactnative.js"},"browser":{"./build/ably-node.js":"./build/ably-commonjs.js"},"files":["build/**","ably.d.ts","callbacks.d.ts","callbacks.js","promises.d.ts","promises.js","resources/**","src/**","react/**"],"dependencies":{"@ably/msgpack-js":"^0.4.0","got":"^11.8.5","ws":"^8.14.2"},"peerDependencies":{"react":">=16.8.0","react-dom":">=16.8.0"},"peerDependenciesMeta":{"react":{"optional":true},"react-dom":{"optional":true}},"devDependencies":{"@ably/vcdiff-decoder":"1.0.4","@arethetypeswrong/cli":"^0.13.1","@babel/preset-env":"^7.23.6","@testing-library/react":"^13.3.0","@types/crypto-js":"^4.0.1","@types/jmespath":"^0.15.2","@types/node":"^15.0.0","@types/request":"^2.48.7","@types/ws":"^8.2.0","@typescript-eslint/eslint-plugin":"^5.14.0","@typescript-eslint/parser":"^5.14.0","@vitejs/plugin-react":"^1.3.2","async":"ably-forks/async#requirejs","aws-sdk":"^2.1413.0","babel-loader":"^8.3.0","chai":"^4.2.0","copy-webpack-plugin":"^6.4.1","cors":"^2.8.5","crypto-js":"ably-forks/crypto-js#crypto-lite","eslint":"^7.13.0","eslint-plugin-import":"^2.28.0","eslint-plugin-jsdoc":"^40.0.0","eslint-plugin-react":"^7.32.2","eslint-plugin-react-hooks":"^4.6.0","eslint-plugin-security":"^1.4.0","express":"^4.17.1","glob":"~4.4","google-closure-compiler":"^20180610.0.1","grunt":"^1.6.1","grunt-bump":"^0.3.1","grunt-cli":"~1.2.0","grunt-closure-tools":"^1.0.0","grunt-contrib-concat":"~0.5","grunt-shell":"~1.1","grunt-webpack":"^4.0.2","hexy":"~0.2","jmespath":"^0.16.0","jsdom":"^20.0.0","kexec":"ably-forks/node-kexec#update-for-node-12","minimist":"^1.2.5","mocha":"^8.1.3","mocha-junit-reporter":"^2.2.1","null-loader":"^4.0.1","playwright":"^1.39.0","prettier":"^2.5.1","react":">=18.1.0","react-dom":">=18.1.0","requirejs":"~2.1","shelljs":"~0.8","source-map-explorer":"^2.5.2","ts-loader":"^8.2.0","tsconfig-paths-webpack-plugin":"^4.0.1","tslib":"^2.3.1","typedoc":"^0.23.8","typescript":"^4.6.4","vite":"^4.4.9","vitest":"^0.18.0","webpack":"^4.44.2","webpack-cli":"^4.2.0","webpack-node-externals":"^3.0.0"},"engines":{"node":">=5.10.x"},"repository":"ably/ably-js","jspm":{"registry":"npm","directories":{"lib":"build"},"main":"ably"},"scripts":{"start:react":"npx vite serve","grunt":"grunt","test":"grunt test","test:node":"grunt test:node","test:node:skip-build":"grunt mocha","test:webserver":"grunt test:webserver","test:playwright":"node test/support/runPlaywrightTests.js","test:react":"vitest run","concat":"grunt concat","build":"grunt build:all && npm run build:react","build:node":"grunt build:node","build:browser":"grunt build:browser","build:react":"npm run build:react:mjs && npm run build:react:cjs && cp src/platform/react-hooks/res/package.react.json react/package.json","build:react:mjs":"tsc --project src/platform/react-hooks/tsconfig.mjs.json && cp src/platform/react-hooks/res/package.mjs.json react/mjs/package.json","build:react:cjs":"tsc --project src/platform/react-hooks/tsconfig.cjs.json && cp src/platform/react-hooks/res/package.cjs.json react/cjs/package.json","requirejs":"grunt requirejs","lint":"eslint .","lint:fix":"eslint --fix .","check-closure-compiler":"grunt check-closure-compiler","prepare":"npm run build","format":"prettier --write --ignore-path .gitignore --ignore-path .prettierignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js docs/chrome-mv3.md","format:check":"prettier --check --ignore-path .gitignore --ignore-path .prettierignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js","sourcemap":"source-map-explorer build/ably.min.js","sourcemap:noencryption":"source-map-explorer build/ably.noencryption.min.js","docs":"typedoc --entryPoints ably.d.ts --out docs/generated/default --readme docs/landing-pages/default.md && typedoc --entryPoints promises.d.ts --out docs/generated/promises --name \\"ably (Promise-based)\\" --readme docs/landing-pages/promises.md && cp docs/landing-pages/choose-library.html docs/generated/index.html"}}')},function(t,r){},function(t,r,n){(function(l,c){t.exports=c(n(6),n(32),n(24))})(this,function(l){return l.HmacSHA256})},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=n(0),c=l.__importStar(n(1)),h=l.__importDefault(n(47)),d=l.__importDefault(n(14)),f=l.__importDefault(n(19)),m=l.__importDefault(n(4)),g=l.__importDefault(n(48)),y=function(){},_=function(){function T(A){this.rest=A,this.admin=new b(A)}return T}(),b=function(){function T(A){this.rest=A,this.deviceRegistrations=new S(A),this.channelSubscriptions=new E(A)}return T.prototype.publish=function(A,P,O){var R=this.rest,D=R.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,L=c.defaultPostHeaders(R.options,D),N={},U=c.mixin({recipient:A},P);if(typeof O!="function"){if(this.rest.options.promises)return c.promisify(this,"publish",arguments);O=y}R.options.headers&&c.mixin(L,R.options.headers),R.options.pushFullWait&&c.mixin(N,{fullWait:"true"});var F=c.encodeBody(U,D);d.default.post(R,"/push/publish",F,L,N,null,function(z){return O(z)})},T}(),S=function(){function T(A){this.rest=A}return T.prototype.save=function(A,P){var O=this.rest,R=h.default.fromValues(A),D=O.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,L=c.defaultPostHeaders(O.options,D),N={};if(typeof P!="function"){if(this.rest.options.promises)return c.promisify(this,"save",arguments);P=y}O.options.headers&&c.mixin(L,O.options.headers),O.options.pushFullWait&&c.mixin(N,{fullWait:"true"});var U=c.encodeBody(R,D);d.default.put(O,"/push/deviceRegistrations/"+encodeURIComponent(A.id),U,L,N,null,function(F,z,G,J){P(F,F?void 0:h.default.fromResponseBody(z,J?void 0:D))})},T.prototype.get=function(A,P){var O=this.rest,R=O.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,D=c.defaultGetHeaders(O.options,R),L=A.id||A;if(typeof P!="function"){if(this.rest.options.promises)return c.promisify(this,"get",arguments);P=y}if(typeof L!="string"||!L.length){P(new m.default("First argument to DeviceRegistrations#get must be a deviceId string or DeviceDetails",4e4,400));return}O.options.headers&&c.mixin(D,O.options.headers),d.default.get(O,"/push/deviceRegistrations/"+encodeURIComponent(L),D,{},null,function(N,U,F,z){P(N,N?void 0:h.default.fromResponseBody(U,z?void 0:R))})},T.prototype.list=function(A,P){var O=this.rest,R=O.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,D=this.rest.http.supportsLinkHeaders?void 0:R,L=c.defaultGetHeaders(O.options,R);if(typeof P!="function"){if(this.rest.options.promises)return c.promisify(this,"list",arguments);P=y}O.options.headers&&c.mixin(L,O.options.headers),new f.default(O,"/push/deviceRegistrations",L,D,function(N,U,F){return h.default.fromResponseBody(N,F?void 0:R)}).get(A,P)},T.prototype.remove=function(A,P){var O=this.rest,R=O.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,D=c.defaultGetHeaders(O.options,R),L={},N=A.id||A;if(typeof P!="function"){if(this.rest.options.promises)return c.promisify(this,"remove",arguments);P=y}if(typeof N!="string"||!N.length){P(new m.default("First argument to DeviceRegistrations#remove must be a deviceId string or DeviceDetails",4e4,400));return}O.options.headers&&c.mixin(D,O.options.headers),O.options.pushFullWait&&c.mixin(L,{fullWait:"true"}),d.default.delete(O,"/push/deviceRegistrations/"+encodeURIComponent(N),D,L,null,function(U){return P(U)})},T.prototype.removeWhere=function(A,P){var O=this.rest,R=O.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,D=c.defaultGetHeaders(O.options,R);if(typeof P!="function"){if(this.rest.options.promises)return c.promisify(this,"removeWhere",arguments);P=y}O.options.headers&&c.mixin(D,O.options.headers),O.options.pushFullWait&&c.mixin(A,{fullWait:"true"}),d.default.delete(O,"/push/deviceRegistrations",D,A,null,function(L){return P(L)})},T}(),E=function(){function T(A){this.remove=T.prototype.removeWhere,this.rest=A}return T.prototype.save=function(A,P){var O=this.rest,R=g.default.fromValues(A),D=O.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,L=c.defaultPostHeaders(O.options,D),N={};if(typeof P!="function"){if(this.rest.options.promises)return c.promisify(this,"save",arguments);P=y}O.options.headers&&c.mixin(L,O.options.headers),O.options.pushFullWait&&c.mixin(N,{fullWait:"true"});var U=c.encodeBody(R,D);d.default.post(O,"/push/channelSubscriptions",U,L,N,null,function(F,z,G,J){P(F,!F&&g.default.fromResponseBody(z,J?void 0:D))})},T.prototype.list=function(A,P){var O=this.rest,R=O.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,D=this.rest.http.supportsLinkHeaders?void 0:R,L=c.defaultGetHeaders(O.options,R);if(typeof P!="function"){if(this.rest.options.promises)return c.promisify(this,"list",arguments);P=y}O.options.headers&&c.mixin(L,O.options.headers),new f.default(O,"/push/channelSubscriptions",L,D,function(N,U,F){return g.default.fromResponseBody(N,F?void 0:R)}).get(A,P)},T.prototype.removeWhere=function(A,P){var O=this.rest,R=O.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,D=c.defaultGetHeaders(O.options,R);if(typeof P!="function"){if(this.rest.options.promises)return c.promisify(this,"removeWhere",arguments);P=y}O.options.headers&&c.mixin(D,O.options.headers),O.options.pushFullWait&&c.mixin(A,{fullWait:"true"}),d.default.delete(O,"/push/channelSubscriptions",D,A,null,function(L){return P(L)})},T.prototype.listChannels=function(A,P){var O=this.rest,R=O.options.useBinaryProtocol?c.Format.msgpack:c.Format.json,D=this.rest.http.supportsLinkHeaders?void 0:R,L=c.defaultGetHeaders(O.options,R);if(typeof P!="function"){if(this.rest.options.promises)return c.promisify(this,"listChannels",arguments);P=y}O.options.headers&&c.mixin(L,O.options.headers),O.options.pushFullWait&&c.mixin(A,{fullWait:"true"}),new f.default(O,"/push/channels",L,D,function(N,U,F){for(var z=!F&&R?c.decodeBody(N,R):N,G=0;G<z.length;G++)z[G]=String(z[G]);return z}).get(A,P)},T}();r.default=_},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=n(0),c=l.__importStar(n(1)),h=l.__importDefault(n(4)),d;(function(g){g.Phone="phone",g.Tablet="tablet",g.Desktop="desktop",g.TV="tv",g.Watch="watch",g.Car="car",g.Embedded="embedded",g.Other="other"})(d||(d={}));var f;(function(g){g.Android="android",g.IOS="ios",g.Browser="browser"})(f||(f={}));var m=function(){function g(){}return g.prototype.toJSON=function(){var y,_,b;return{id:this.id,deviceSecret:this.deviceSecret,platform:this.platform,formFactor:this.formFactor,clientId:this.clientId,metadata:this.metadata,deviceIdentityToken:this.deviceIdentityToken,push:{recipient:(y=this.push)===null||y===void 0?void 0:y.recipient,state:(_=this.push)===null||_===void 0?void 0:_.state,error:(b=this.push)===null||b===void 0?void 0:b.error}}},g.prototype.toString=function(){var y,_,b,S,E="[DeviceDetails";return this.id&&(E+="; id="+this.id),this.platform&&(E+="; platform="+this.platform),this.formFactor&&(E+="; formFactor="+this.formFactor),this.clientId&&(E+="; clientId="+this.clientId),this.metadata&&(E+="; metadata="+this.metadata),this.deviceIdentityToken&&(E+="; deviceIdentityToken="+JSON.stringify(this.deviceIdentityToken)),!((y=this.push)===null||y===void 0)&&y.recipient&&(E+="; push.recipient="+JSON.stringify(this.push.recipient)),!((_=this.push)===null||_===void 0)&&_.state&&(E+="; push.state="+this.push.state),!((b=this.push)===null||b===void 0)&&b.error&&(E+="; push.error="+JSON.stringify(this.push.error)),!((S=this.push)===null||S===void 0)&&S.metadata&&(E+="; push.metadata="+this.push.metadata),E+="]",E},g.fromResponseBody=function(y,_){return _&&(y=c.decodeBody(y,_)),c.isArray(y)?g.fromValuesArray(y):g.fromValues(y)},g.fromValues=function(y){return y.error=y.error&&h.default.fromValues(y.error),Object.assign(new g,y)},g.fromValuesArray=function(y){for(var _=y.length,b=new Array(_),S=0;S<_;S++)b[S]=g.fromValues(y[S]);return b},g.toRequestBody=c.encodeBody,g}();r.default=m},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=n(0),c=l.__importStar(n(1)),h=function(){function d(){}return d.prototype.toJSON=function(){return{channel:this.channel,deviceId:this.deviceId,clientId:this.clientId}},d.prototype.toString=function(){var f="[PushChannelSubscription";return this.channel&&(f+="; channel="+this.channel),this.deviceId&&(f+="; deviceId="+this.deviceId),this.clientId&&(f+="; clientId="+this.clientId),f+="]",f},d.fromResponseBody=function(f,m){return m&&(f=c.decodeBody(f,m)),c.isArray(f)?d.fromValuesArray(f):d.fromValues(f)},d.fromValues=function(f){return Object.assign(new d,f)},d.fromValuesArray=function(f){for(var m=f.length,g=new Array(m),y=0;y<m;y++)g[y]=d.fromValues(f[y]);return g},d.toRequestBody=c.encodeBody,d}();r.default=h},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=n(0),c=l.__importStar(n(1)),h=function(){function O(R){this.count=R&&R.count||0,this.data=R&&R.data||0,this.uncompressedData=R&&R.uncompressedData||0,this.failed=R&&R.failed||0,this.refused=R&&R.refused||0}return O}(),d=function(O){l.__extends(R,O);function R(D){var L=O.call(this,D)||this;return D&&D.category&&(L.category={},c.forInOwnNonNullProperties(D.category,function(N){L.category[N]=new h(D.category[N])})),L}return R}(h),f=function(){function O(R){this.peak=R&&R.peak||0,this.min=R&&R.min||0,this.mean=R&&R.mean||0,this.opened=R&&R.opened||0,this.refused=R&&R.refused||0}return O}(),m=function(){function O(R){this.succeeded=R&&R.succeeded||0,this.failed=R&&R.failed||0,this.refused=R&&R.refused||0}return O}(),g=function(){function O(R){this.plain=new f(R&&R.plain),this.tls=new f(R&&R.tls),this.all=new f(R&&R.all)}return O}(),y=function(){function O(R){this.messages=new d(R&&R.messages),this.presence=new d(R&&R.presence),this.all=new d(R&&R.all)}return O}(),_=function(){function O(R){this.realtime=new y(R&&R.realtime),this.rest=new y(R&&R.rest),this.webhook=new y(R&&R.webhook),this.sharedQueue=new y(R&&R.sharedQueue),this.externalQueue=new y(R&&R.externalQueue),this.httpEvent=new y(R&&R.httpEvent),this.push=new y(R&&R.push),this.all=new y(R&&R.all)}return O}(),b=function(){function O(R){this.all=new y(R&&R.all),this.inbound=new _(R&&R.inbound),this.outbound=new _(R&&R.outbound)}return O}(),S=function(){function O(R){this.all=new y(R&&R.all),this.producerPaid=new b(R&&R.producerPaid),this.consumerPaid=new b(R&&R.consumerPaid)}return O}(),E=function(){function O(R){this.messages=R&&R.messages||0;var D=R&&R.notifications;this.notifications={invalid:D&&D.invalid||0,attempted:D&&D.attempted||0,successful:D&&D.successful||0,failed:D&&D.failed||0},this.directPublishes=R&&R.directPublishes||0}return O}(),T=function(){function O(R){this.succeeded=R&&R.succeeded||0,this.skipped=R&&R.skipped||0,this.failed=R&&R.failed||0}return O}(),A=function(){function O(R){var D=this;this.delta=void 0,R&&R.delta&&(this.delta={},c.forInOwnNonNullProperties(R.delta,function(L){D.delta[L]=new T(R.delta[L])}))}return O}(),P=function(O){l.__extends(R,O);function R(D){var L=O.call(this,D)||this;return L.persisted=new y(D&&D.persisted),L.connections=new g(D&&D.connections),L.channels=new f(D&&D.channels),L.apiRequests=new m(D&&D.apiRequests),L.tokenRequests=new m(D&&D.tokenRequests),L.xchgProducer=new S(D&&D.xchgProducer),L.xchgConsumer=new S(D&&D.xchgConsumer),L.push=new E(D&&D.pushStats),L.processed=new A(D&&D.processed),L.inProgress=D&&D.inProgress||void 0,L.unit=D&&D.unit||void 0,L.intervalId=D&&D.intervalId||void 0,L}return R.fromValues=function(D){return new R(D)},R}(b);r.default=P},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=n(0),c=l.__importStar(n(1)),h=l.__importDefault(n(30)),d=l.__importDefault(n(7)),f=l.__importDefault(n(2)),m=l.__importDefault(n(51)),g=l.__importDefault(n(38)),y=l.__importDefault(n(8)),_=l.__importDefault(n(4)),b=l.__importDefault(n(10)),S=l.__importDefault(n(35)),E=l.__importDefault(n(3)),T=l.__importDefault(n(9)),A=function(O){l.__extends(R,O);function R(D){var L=O.call(this,D)||this;return f.default.logAction(f.default.LOG_MINOR,"Realtime()",""),L.connection=new m.default(L,L.options),L.channels=new P(L),D.autoConnect!==!1&&L.connect(),L}return R.prototype.connect=function(){f.default.logAction(f.default.LOG_MINOR,"Realtime.connect()",""),this.connection.connect()},R.prototype.close=function(){f.default.logAction(f.default.LOG_MINOR,"Realtime.close()",""),this.connection.close()},R.Promise=function(D){return D=y.default.objectifyOptions(D),D.promises=!0,new R(D)},R.Callbacks=R,R.Utils=c,R.ConnectionManager=S.default,R.Platform=E.default,R.ProtocolMessage=b.default,R.Message=T.default,R}(h.default),P=function(O){l.__extends(R,O);function R(D){var L=O.call(this)||this;return L.realtime=D,L.all=Object.create(null),D.connection.connectionManager.on("transport.active",function(){L.onTransportActive()}),L}return R.prototype.channelSerials=function(){for(var D={},L=0,N=c.keysArray(this.all,!0);L<N.length;L++){var U=N[L],F=this.all[U];F.properties.channelSerial&&(D[U]=F.properties.channelSerial)}return D},R.prototype.recoverChannels=function(D){for(var L=0,N=c.keysArray(D,!0);L<N.length;L++){var U=N[L],F=this.get(U);F.properties.channelSerial=D[U]}},R.prototype.onChannelMessage=function(D){var L=D.channel;if(L===void 0){f.default.logAction(f.default.LOG_ERROR,"Channels.onChannelMessage()","received event unspecified channel, action = "+D.action);return}var N=this.all[L];if(!N){f.default.logAction(f.default.LOG_ERROR,"Channels.onChannelMessage()","received event for non-existent channel: "+L);return}N.onMessage(D)},R.prototype.onTransportActive=function(){for(var D in this.all){var L=this.all[D];L.state==="attaching"||L.state==="detaching"?L.checkPendingState():L.state==="suspended"?L._attach(!1,null):L.state==="attached"&&L.requestState("attaching")}},R.prototype.propogateConnectionInterruption=function(D,L){var N={closing:"detached",closed:"detached",failed:"failed",suspended:"suspended"},U=["attaching","attached","detaching","suspended"],F=N[D];for(var z in this.all){var G=this.all[z];c.arrIn(U,G.state)&&G.notifyState(F,L)}},R.prototype.get=function(D,L){D=String(D);var N=this.all[D];if(!N)N=this.all[D]=new g.default(this.realtime,D,L);else if(L){if(N._shouldReattachToSetOptions(L,N.channelOptions))throw new _.default("Channels.get() cannot be used to set channel options that would cause the channel to reattach. Please, use RealtimeChannel.setOptions() instead.",4e4,400);N.setOptions(L)}return N},R.prototype.getDerived=function(D,L,N){if(L.filter){var U=c.toBase64(L.filter),F=c.matchDerivedChannel(D);D="[filter=".concat(U).concat(F.qualifierParam,"]").concat(F.channelName)}return this.get(D,N)},R.prototype.release=function(D){D=String(D);var L=this.all[D];if(L){var N=L.getReleaseErr();if(N)throw N;delete this.all[D]}},R}(d.default);r.default=A},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=n(0),c=l.__importStar(n(1)),h=l.__importDefault(n(7)),d=l.__importDefault(n(35)),f=l.__importDefault(n(2)),m=l.__importDefault(n(37)),g=l.__importDefault(n(3));function y(){}var _=function(b){l.__extends(S,b);function S(E,T){var A=b.call(this)||this;return A.whenState=function(P,O){return h.default.prototype.whenState.call(A,P,A.state,O,new m.default(void 0,P))},A.ably=E,A.connectionManager=new d.default(E,T),A.state=A.connectionManager.state.state,A.key=void 0,A.id=void 0,A.errorReason=null,A.connectionManager.on("connectionstate",function(P){var O=A.state=P.current;g.default.Config.nextTick(function(){A.emit(O,P)})}),A.connectionManager.on("update",function(P){g.default.Config.nextTick(function(){A.emit("update",P)})}),A}return S.prototype.connect=function(){f.default.logAction(f.default.LOG_MINOR,"Connection.connect()",""),this.connectionManager.requestState({state:"connecting"})},S.prototype.ping=function(E){if(f.default.logAction(f.default.LOG_MINOR,"Connection.ping()",""),!E){if(this.ably.options.promises)return c.promisify(this,"ping",arguments);E=y}this.connectionManager.ping(null,E)},S.prototype.close=function(){f.default.logAction(f.default.LOG_MINOR,"Connection.close()","connectionKey = "+this.key),this.connectionManager.requestState({state:"closing"})},Object.defineProperty(S.prototype,"recoveryKey",{get:function(){return this.createRecoveryKey()},enumerable:!1,configurable:!0}),S.prototype.createRecoveryKey=function(){return this.connectionManager.createRecoveryKey()},S}(h.default);r.default=_},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0}),r.PendingMessage=void 0;var l=n(0),c=l.__importDefault(n(10)),h=l.__importStar(n(1)),d=l.__importDefault(n(7)),f=l.__importDefault(n(2)),m=l.__importDefault(n(36)),g=l.__importDefault(n(4)),y=c.default.Action,_=function(){function S(E,T){this.message=E,this.callback=T,this.merged=!1;var A=E.action;this.sendAttempted=!1,this.ackRequired=A==y.MESSAGE||A==y.PRESENCE}return S}();r.PendingMessage=_;var b=function(S){l.__extends(E,S);function E(T){var A=S.call(this)||this;return A.transport=T,A.messageQueue=new m.default,T.on("ack",function(P,O){A.onAck(P,O)}),T.on("nack",function(P,O,R){A.onNack(P,O,R)}),A}return E.prototype.onAck=function(T,A){f.default.logAction(f.default.LOG_MICRO,"Protocol.onAck()","serial = "+T+"; count = "+A),this.messageQueue.completeMessages(T,A)},E.prototype.onNack=function(T,A,P){f.default.logAction(f.default.LOG_ERROR,"Protocol.onNack()","serial = "+T+"; count = "+A+"; err = "+h.inspectError(P)),P||(P=new g.default("Unable to send message; channel not responding",50001,500)),this.messageQueue.completeMessages(T,A,P)},E.prototype.onceIdle=function(T){var A=this.messageQueue;if(A.count()===0){T();return}A.once("idle",T)},E.prototype.send=function(T){T.ackRequired&&this.messageQueue.push(T),f.default.shouldLog(f.default.LOG_MICRO)&&f.default.logAction(f.default.LOG_MICRO,"Protocol.send()","sending msg; "+c.default.stringify(T.message)),T.sendAttempted=!0,this.transport.send(T.message)},E.prototype.getTransport=function(){return this.transport},E.prototype.getPendingMessages=function(){return this.messageQueue.copyAll()},E.prototype.clearPendingMessages=function(){return this.messageQueue.clear()},E.prototype.finish=function(){var T=this.transport;this.onceIdle(function(){T.disconnect()})},E}(d.default);r.default=b},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=n(0),c=l.__importDefault(n(3)),h=l.__importStar(n(1)),d=l.__importDefault(n(26)),f=l.__importDefault(n(8)),m=l.__importDefault(n(2)),g=l.__importDefault(n(10)),y=l.__importDefault(n(4)),_="web_socket";function b(T){return!!T.on}var S=function(T){l.__extends(A,T);function A(P,O,R){var D=T.call(this,P,O,R)||this;return D.shortName=_,R.heartbeats=c.default.Config.useProtocolHeartbeats,D.wsHost=f.default.getHost(R.options,R.host,!0),D}return A.isAvailable=function(){return!!c.default.Config.WebSocket},A.prototype.createWebSocket=function(P,O){return this.uri=P+h.toQueryString(O),new c.default.Config.WebSocket(this.uri)},A.prototype.toString=function(){return"WebSocketTransport; uri="+this.uri},A.prototype.connect=function(){m.default.logAction(m.default.LOG_MINOR,"WebSocketTransport.connect()","starting"),d.default.prototype.connect.call(this);var P=this,O=this.params,R=O.options,D=R.tls?"wss://":"ws://",L=D+this.wsHost+":"+f.default.getPort(R)+"/";m.default.logAction(m.default.LOG_MINOR,"WebSocketTransport.connect()","uri: "+L),this.auth.getAuthParams(function(N,U){if(!P.isDisposed){var F="";for(var z in U)F+=" "+z+": "+U[z]+";";if(m.default.logAction(m.default.LOG_MINOR,"WebSocketTransport.connect()","authParams:"+F+" err: "+N),N){P.disconnect(N);return}var G=O.getConnectParams(U);try{var J=P.wsConnection=P.createWebSocket(L,G);J.binaryType=c.default.Config.binaryType,J.onopen=function(){P.onWsOpen()},J.onclose=function(Z){P.onWsClose(Z)},J.onmessage=function(Z){P.onWsData(Z.data)},J.onerror=function(Z){P.onWsError(Z)},b(J)&&J.on("ping",function(){P.onActivity()})}catch(Z){m.default.logAction(m.default.LOG_ERROR,"WebSocketTransport.connect()","Unexpected exception creating websocket: err = "+(Z.stack||Z.message)),P.disconnect(Z)}}})},A.prototype.send=function(P){var O=this.wsConnection;if(!O){m.default.logAction(m.default.LOG_ERROR,"WebSocketTransport.send()","No socket connection");return}try{O.send(g.default.serialize(P,this.params.format))}catch(D){var R="Exception from ws connection when trying to send: "+h.inspectError(D);m.default.logAction(m.default.LOG_ERROR,"WebSocketTransport.send()",R),this.finish("disconnected",new y.default(R,5e4,500))}},A.prototype.onWsData=function(P){m.default.logAction(m.default.LOG_MICRO,"WebSocketTransport.onWsData()","data received; length = "+P.length+"; type = "+typeof P);try{this.onProtocolMessage(g.default.deserialize(P,this.format))}catch(O){m.default.logAction(m.default.LOG_ERROR,"WebSocketTransport.onWsData()","Unexpected exception handing channel message: "+O.stack)}},A.prototype.onWsOpen=function(){m.default.logAction(m.default.LOG_MINOR,"WebSocketTransport.onWsOpen()","opened WebSocket"),this.emit("preconnect")},A.prototype.onWsClose=function(P){var O,R;if(typeof P=="object"?(R=P.code,O=P.wasClean||R===1e3):(R=P,O=R==1e3),delete this.wsConnection,O){m.default.logAction(m.default.LOG_MINOR,"WebSocketTransport.onWsClose()","Cleanly closed WebSocket");var D=new y.default("Websocket closed",80003,400);this.finish("disconnected",D)}else{var L="Unclean disconnection of WebSocket ; code = "+R,D=new y.default(L,80003,400);m.default.logAction(m.default.LOG_MINOR,"WebSocketTransport.onWsClose()",L),this.finish("disconnected",D)}this.emit("disposed")},A.prototype.onWsError=function(P){var O=this;m.default.logAction(m.default.LOG_MINOR,"WebSocketTransport.onError()","Error from WebSocket: "+P.message),c.default.Config.nextTick(function(){O.disconnect(Error(P.message))})},A.prototype.dispose=function(){m.default.logAction(m.default.LOG_MINOR,"WebSocketTransport.dispose()",""),this.isDisposed=!0;var P=this.wsConnection;P&&(P.onmessage=function(){},delete this.wsConnection,c.default.Config.nextTick(function(){if(m.default.logAction(m.default.LOG_MICRO,"WebSocketTransport.dispose()","closing websocket"),!P)throw new Error("WebSocketTransport.dispose(): wsConnection is not defined");P.close()}))},A}(d.default);function E(T){return S.isAvailable()&&(T.supportedTransports[_]=S),S}r.default=E},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=n(0),c=l.__importStar(n(1)),h=l.__importDefault(n(34)),d=l.__importDefault(n(7)),f=l.__importDefault(n(2)),m=l.__importDefault(n(15)),g=l.__importStar(n(4)),y=l.__importDefault(n(38)),_=l.__importDefault(n(23)),b=l.__importDefault(n(39)),S=function(){};function E(D){return D.channel.realtime.auth.clientId}function T(D){var L=D.channel.realtime,N=L.auth.clientId;return(!N||N==="*")&&L.connection.state==="connected"}function A(D,L,N){switch(D.state){case"attached":case"suspended":N();break;case"initialized":case"detached":case"detaching":case"attaching":D.attach(function(U){U?L(U):N()});break;default:L(g.default.fromValues(D.invalidStateError()))}}function P(D,L){if(D.isSynthesized()||L.isSynthesized())return D.timestamp>=L.timestamp;var N=D.parseId(),U=L.parseId();return N.msgSerial===U.msgSerial?N.index>U.index:N.msgSerial>U.msgSerial}var O=function(D){l.__extends(L,D);function L(N){var U=D.call(this,N)||this;return U.channel=N,U.syncComplete=!1,U.members=new R(U,function(F){return F.clientId+":"+F.connectionId}),U._myMembers=new R(U,function(F){return F.clientId}),U.subscriptions=new d.default,U.pendingPresence=[],U}return L.prototype.enter=function(N,U){if(T(this))throw new g.default("clientId must be specified to enter a presence channel",40012,400);return this._enterOrUpdateClient(void 0,void 0,N,"enter",U)},L.prototype.update=function(N,U){if(T(this))throw new g.default("clientId must be specified to update presence data",40012,400);return this._enterOrUpdateClient(void 0,void 0,N,"update",U)},L.prototype.enterClient=function(N,U,F){return this._enterOrUpdateClient(void 0,N,U,"enter",F)},L.prototype.updateClient=function(N,U,F){return this._enterOrUpdateClient(void 0,N,U,"update",F)},L.prototype._enterOrUpdateClient=function(N,U,F,z,G){var J=this;if(!G)if(typeof F=="function")G=F,F=null;else{if(this.channel.realtime.options.promises)return c.promisify(this,"_enterOrUpdateClient",[N,U,F,z]);G=S}var Z=this.channel;if(!Z.connectionManager.activeState()){G(Z.connectionManager.getError());return}f.default.logAction(f.default.LOG_MICRO,"RealtimePresence."+z+"Client()","channel = "+Z.name+", id = "+N+", client = "+(U||"(implicit) "+E(this)));var q=m.default.fromData(F);q.action=z,N&&(q.id=N),U&&(q.clientId=U),m.default.encode(q,Z.channelOptions,function($){if($){G($);return}switch(Z.state){case"attached":Z.sendPresence(q,G);break;case"initialized":case"detached":Z.attach();case"attaching":J.pendingPresence.push({presence:q,callback:G});break;default:$=new g.PartialErrorInfo("Unable to "+z+" presence channel while in "+Z.state+" state",90001),$.code=90001,G($)}})},L.prototype.leave=function(N,U){if(T(this))throw new g.default("clientId must have been specified to enter or leave a presence channel",40012,400);return this.leaveClient(void 0,N,U)},L.prototype.leaveClient=function(N,U,F){if(!F)if(typeof U=="function")F=U,U=null;else{if(this.channel.realtime.options.promises)return c.promisify(this,"leaveClient",[N,U]);F=S}var z=this.channel;if(!z.connectionManager.activeState()){F==null||F(z.connectionManager.getError());return}f.default.logAction(f.default.LOG_MICRO,"RealtimePresence.leaveClient()","leaving; channel = "+this.channel.name+", client = "+N);var G=m.default.fromData(U);switch(G.action="leave",N&&(G.clientId=N),z.state){case"attached":z.sendPresence(G,F);break;case"attaching":this.pendingPresence.push({presence:G,callback:F});break;case"initialized":case"failed":{var J=new g.PartialErrorInfo("Unable to leave presence channel (incompatible state)",90001);F==null||F(J);break}default:F==null||F(z.invalidStateError())}},L.prototype.get=function(N,U){var F=this,z=Array.prototype.slice.call(arguments);z.length==1&&typeof z[0]=="function"&&z.unshift(null),N=z[0],U=z[1];var G=!N||("waitForSync"in N?N.waitForSync:!0);if(!U){if(this.channel.realtime.options.promises)return c.promisify(this,"get",z);U=S}function J(Z){U(null,N?Z.list(N):Z.values())}if(this.channel.state==="suspended"){G?U(g.default.fromValues({statusCode:400,code:91005,message:"Presence state is out of sync due to channel being in the SUSPENDED state"})):J(this.members);return}A(this.channel,U,function(){var Z=F.members;G?Z.waitSync(function(){J(Z)}):J(Z)})},L.prototype.history=function(N,U){if(f.default.logAction(f.default.LOG_MICRO,"RealtimePresence.history()","channel = "+this.name),U===void 0)if(typeof N=="function")U=N,N=null;else{if(this.channel.realtime.options.promises)return c.promisify(this,"history",arguments);U=S}N&&N.untilAttach&&(this.channel.state==="attached"?(delete N.untilAttach,N.from_serial=this.channel.properties.attachSerial):U(new g.default("option untilAttach requires the channel to be attached, was: "+this.channel.state,4e4,400))),h.default.prototype._history.call(this,N,U)},L.prototype.setPresence=function(N,U,F){f.default.logAction(f.default.LOG_MICRO,"RealtimePresence.setPresence()","received presence for "+N.length+" participants; syncChannelSerial = "+F);var z,G,J=this.members,Z=this._myMembers,q=[],$=this.channel.connectionManager.connectionId;U&&(this.members.startSync(),F&&(G=F.match(/^[\w-]+:(.*)$/))&&(z=G[1]));for(var H=0;H<N.length;H++){var X=m.default.fromValues(N[H]);switch(X.action){case"leave":J.remove(X)&&q.push(X),X.connectionId===$&&!X.isSynthesized()&&Z.remove(X);break;case"enter":case"present":case"update":J.put(X)&&q.push(X),X.connectionId===$&&Z.put(X);break}}U&&!z&&(J.endSync(),this.channel.syncChannelSerial=null);for(var H=0;H<q.length;H++){var X=q[H];this.subscriptions.emit(X.action,X)}},L.prototype.onAttached=function(N){f.default.logAction(f.default.LOG_MINOR,"RealtimePresence.onAttached()","channel = "+this.channel.name+", hasPresence = "+N),N?this.members.startSync():(this._synthesizeLeaves(this.members.values()),this.members.clear()),this._ensureMyMembersPresent();var U=this.pendingPresence,F=U.length;if(F){this.pendingPresence=[];var z=[],G=_.default.create();f.default.logAction(f.default.LOG_MICRO,"RealtimePresence.onAttached","sending "+F+" queued presence messages");for(var J=0;J<F;J++){var Z=U[J];z.push(Z.presence),G.push(Z.callback)}this.channel.sendPresence(z,G)}},L.prototype.actOnChannelState=function(N,U,F){switch(N){case"attached":this.onAttached(U);break;case"detached":case"failed":this._clearMyMembers(),this.members.clear();case"suspended":this.failPendingPresence(F);break}},L.prototype.failPendingPresence=function(N){if(this.pendingPresence.length){f.default.logAction(f.default.LOG_MINOR,"RealtimeChannel.failPendingPresence","channel; name = "+this.channel.name+", err = "+c.inspectError(N));for(var U=0;U<this.pendingPresence.length;U++)try{this.pendingPresence[U].callback(N)}catch{}this.pendingPresence=[]}},L.prototype._clearMyMembers=function(){this._myMembers.clear()},L.prototype._ensureMyMembersPresent=function(){var N=this,U=this._myMembers,F=function(J){if(J){var Z="Presence auto-re-enter failed: "+J.toString(),q=new g.default(Z,91004,400);f.default.logAction(f.default.LOG_ERROR,"RealtimePresence._ensureMyMembersPresent()",Z);var $=new b.default(N.channel.state,N.channel.state,!0,!1,q);N.channel.emit("update",$)}};for(var z in U.map){var G=U.map[z];f.default.logAction(f.default.LOG_MICRO,"RealtimePresence._ensureMyMembersPresent()",'Auto-reentering clientId "'+G.clientId+'" into the presence set'),this._enterOrUpdateClient(G.id,G.clientId,G.data,"enter",F)}},L.prototype._synthesizeLeaves=function(N){var U=this.subscriptions;c.arrForEach(N,function(F){var z=m.default.fromValues({action:"leave",connectionId:F.connectionId,clientId:F.clientId,data:F.data,encoding:F.encoding,timestamp:c.now()});U.emit("leave",z)})},L.prototype.on=function(){for(var N=[],U=0;U<arguments.length;U++)N[U]=arguments[U];f.default.deprecated("presence.on","presence.subscribe"),this.subscribe.apply(this,N)},L.prototype.off=function(){for(var N=[],U=0;U<arguments.length;U++)N[U]=arguments[U];f.default.deprecated("presence.off","presence.unsubscribe"),this.unsubscribe.apply(this,N)},L.prototype.subscribe=function(){for(var N=[],U=0;U<arguments.length;U++)N[U]=arguments[U];var F=y.default.processListenerArgs(N),z=F[0],G=F[1],J=F[2],Z=this.channel;if(!J){if(this.channel.realtime.options.promises)return c.promisify(this,"subscribe",[z,G]);J=S}if(Z.state==="failed"){J(g.default.fromValues(Z.invalidStateError()));return}this.subscriptions.on(z,G),Z.attach(J)},L.prototype.unsubscribe=function(){for(var N=[],U=0;U<arguments.length;U++)N[U]=arguments[U];var F=y.default.processListenerArgs(N),z=F[0],G=F[1];this.subscriptions.off(z,G)},L}(h.default),R=function(D){l.__extends(L,D);function L(N,U){var F=D.call(this)||this;return F.presence=N,F.map=Object.create(null),F.syncInProgress=!1,F.residualMembers=null,F.memberKey=U,F}return L.prototype.get=function(N){return this.map[N]},L.prototype.getClient=function(N){var U=this.map,F=[];for(var z in U){var G=U[z];G.clientId==N&&G.action!="absent"&&F.push(G)}return F},L.prototype.list=function(N){var U=this.map,F=N&&N.clientId,z=N&&N.connectionId,G=[];for(var J in U){var Z=U[J];Z.action!=="absent"&&(F&&F!=Z.clientId||z&&z!=Z.connectionId||G.push(Z))}return G},L.prototype.put=function(N){(N.action==="enter"||N.action==="update")&&(N=m.default.fromValues(N),N.action="present");var U=this.map,F=this.memberKey(N);this.residualMembers&&delete this.residualMembers[F];var z=U[F];return z&&!P(N,z)?!1:(U[F]=N,!0)},L.prototype.values=function(){var N=this.map,U=[];for(var F in N){var z=N[F];z.action!="absent"&&U.push(z)}return U},L.prototype.remove=function(N){var U=this.map,F=this.memberKey(N),z=U[F];return z&&!P(N,z)?!1:(this.syncInProgress?(N=m.default.fromValues(N),N.action="absent",U[F]=N):delete U[F],!0)},L.prototype.startSync=function(){var N=this.map,U=this.syncInProgress;f.default.logAction(f.default.LOG_MINOR,"PresenceMap.startSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+U),this.syncInProgress||(this.residualMembers=c.copy(N),this.setInProgress(!0))},L.prototype.endSync=function(){var N=this.map,U=this.syncInProgress;if(f.default.logAction(f.default.LOG_MINOR,"PresenceMap.endSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+U),U){for(var F in N){var z=N[F];z.action==="absent"&&delete N[F]}this.presence._synthesizeLeaves(c.valuesArray(this.residualMembers));for(var F in this.residualMembers)delete N[F];this.residualMembers=null,this.setInProgress(!1)}this.emit("sync")},L.prototype.waitSync=function(N){var U=this.syncInProgress;if(f.default.logAction(f.default.LOG_MINOR,"PresenceMap.waitSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+U),!U){N();return}this.once("sync",N)},L.prototype.clear=function(){this.map={},this.setInProgress(!1),this.residualMembers=null},L.prototype.setInProgress=function(N){f.default.logAction(f.default.LOG_MICRO,"PresenceMap.setInProgress()","inProgress = "+N),this.syncInProgress=N,this.presence.syncComplete=!N},L}(d.default);r.default=O},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=n(0),c=n(56),h=n(31),d=n(11),f=l.__importDefault(n(5)),m=l.__importDefault(n(3)),g=function(){function y(){this.base64CharSet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",this.hexCharSet="0123456789abcdef"}return y.prototype.isWordArray=function(_){return _!=null&&_.sigBytes!==void 0},y.prototype.isArrayBuffer=function(_){return _!=null&&_.constructor===ArrayBuffer},y.prototype.isTypedArray=function(_){return!!ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(_)},y.prototype.uint8ViewToBase64=function(_){for(var b="",S=this.base64CharSet,E=_.byteLength,T=E%3,A=E-T,P,O,R,D,L,N=0;N<A;N=N+3)L=_[N]<<16|_[N+1]<<8|_[N+2],P=(L&16515072)>>18,O=(L&258048)>>12,R=(L&4032)>>6,D=L&63,b+=S[P]+S[O]+S[R]+S[D];return T==1?(L=_[A],P=(L&252)>>2,O=(L&3)<<4,b+=S[P]+S[O]+"=="):T==2&&(L=_[A]<<8|_[A+1],P=(L&64512)>>10,O=(L&1008)>>4,R=(L&15)<<2,b+=S[P]+S[O]+S[R]+"="),b},y.prototype.base64ToArrayBuffer=function(_){for(var b=atob==null?void 0:atob(_),S=b.length,E=new Uint8Array(S),T=0;T<S;T++){var A=b.charCodeAt(T);E[T]=A}return E.buffer},y.prototype.isBuffer=function(_){return this.isArrayBuffer(_)||this.isWordArray(_)||this.isTypedArray(_)},y.prototype.toBuffer=function(_){if(!ArrayBuffer)throw new Error("Can't convert to Buffer: browser does not support the necessary types");if(this.isArrayBuffer(_))return new Uint8Array(_);if(this.isTypedArray(_))return new Uint8Array(_.buffer);if(this.isWordArray(_)){for(var b=new ArrayBuffer(_.sigBytes),S=new Uint8Array(b),E=0;E<_.sigBytes;E++)S[E]=_.words[E>>>2]>>>24-E%4*8&255;return S}throw new Error("BufferUtils.toBuffer expected an arraybuffer, typed array, or CryptoJS wordarray")},y.prototype.toArrayBuffer=function(_){return this.isArrayBuffer(_)?_:this.toBuffer(_).buffer},y.prototype.toWordArray=function(_){return this.isTypedArray(_)&&(_=_.buffer),this.isWordArray(_)?_:f.default.create(_)},y.prototype.base64Encode=function(_){return this.isWordArray(_)?(0,d.stringify)(_):this.uint8ViewToBase64(this.toBuffer(_))},y.prototype.base64Decode=function(_){return ArrayBuffer&&m.default.Config.atob?this.base64ToArrayBuffer(_):(0,d.parse)(_)},y.prototype.hexEncode=function(_){return(0,c.stringify)(this.toWordArray(_))},y.prototype.hexDecode=function(_){var b=(0,c.parse)(_);return ArrayBuffer?this.toArrayBuffer(b):b},y.prototype.utf8Encode=function(_){return m.default.Config.TextEncoder?new m.default.Config.TextEncoder().encode(_).buffer:(0,h.parse)(_)},y.prototype.utf8Decode=function(_){if(!this.isBuffer(_))throw new Error("Expected input of utf8decode to be an arraybuffer, typed array, or CryptoJS wordarray");return TextDecoder&&!this.isWordArray(_)?new TextDecoder().decode(_):(_=this.toWordArray(_),(0,h.stringify)(_))},y.prototype.bufferCompare=function(_,b){if(!_)return-1;if(!b)return 1;var S=this.toWordArray(_),E=this.toWordArray(b);S.clamp(),E.clamp();var T=S.sigBytes-E.sigBytes;if(T!=0)return T;for(var A=S.words,P=E.words,O=0;O<A.length;O++)if(T=A[O]-P[O],T!=0)return T;return 0},y.prototype.byteLength=function(_){return this.isArrayBuffer(_)||this.isTypedArray(_)?_.byteLength:this.isWordArray(_)?_.sigBytes:-1},y.prototype.typedArrayToBuffer=function(_){return _.buffer},y}();r.default=new g},function(t,r,n){(function(l,c){t.exports=c(n(6))})(this,function(l){return l.enc.Hex})},function(t,r,n){n.r(r);var l=n(5),c=n.n(l),h=n(11),d=n(22),f=n.n(d),m=n(2),g=n.n(m),y=n(4),_=n.n(y),b=function(S,E){var T="aes",A=256,P="cbc",O=16,R=4,D=4294967296,L=2147483648,N;if(S.getRandomWordArray)N=S.getRandomWordArray;else if(typeof Uint32Array<"u"&&S.getRandomValues){var U=new Uint32Array(R);N=function(H,X){var re=H/4,ae=re==R?U:new Uint32Array(re);S.getRandomValues(ae,function(he){typeof X<"u"&&X(he,E.toWordArray(ae))})}}else N=function(H,X){g.a.logAction(g.a.LOG_MAJOR,"Ably.Crypto.generateRandom()","Warning: the browser you are using does not support secure cryptographically secure randomness generation; falling back to insecure Math.random()");for(var re=H/4,ae=new Array(re),he=0;he<re;he++)ae[he]=Math.floor(Math.random()*D)-L;X(null,c.a.create(ae))};function F(H){return H+O&-O}function z(H){if(H.algorithm==="aes"&&H.mode==="cbc"){if(H.keyLength===128||H.keyLength===256)return;throw new Error("Unsupported key length "+H.keyLength+" for aes-cbc encryption. Encryption key must be 128 or 256 bits (16 or 32 ASCII characters)")}}function G(H){return H.replace("_","/").replace("-","+")}var J=[c.a.create([269488144,269488144,269488144,269488144],16),c.a.create([16777216],1),c.a.create([33685504],2),c.a.create([50529024],3),c.a.create([67372036],4),c.a.create([84215045,83886080],5),c.a.create([101058054,101056512],6),c.a.create([117901063,117901056],7),c.a.create([134744072,134744072],8),c.a.create([151587081,151587081,150994944],9),c.a.create([168430090,168430090,168427520],10),c.a.create([185273099,185273099,185273088],11),c.a.create([202116108,202116108,202116108],12),c.a.create([218959117,218959117,218959117,218103808],13),c.a.create([235802126,235802126,235802126,235798528],14),c.a.create([252645135,252645135,252645135,252645135],15),c.a.create([269488144,269488144,269488144,269488144],16)];function Z(){}function q(){this.algorithm=null,this.keyLength=null,this.mode=null,this.key=null}Z.CipherParams=q,Z.getDefaultParams=function(H){var X;if(typeof H=="function"||typeof H=="string"){if(g.a.deprecated("Crypto.getDefaultParams(key, callback)","Crypto.getDefaultParams({key: key})"),typeof H=="function")Z.generateRandomKey(function(ae){H(null,Z.getDefaultParams({key:ae}))});else if(typeof arguments[1]=="function")arguments[1](null,Z.getDefaultParams({key:H}));else throw new Error("Invalid arguments for Crypto.getDefaultParams");return}if(!H.key)throw new Error("Crypto.getDefaultParams: a key is required");typeof H.key=="string"?X=Object(h.parse)(G(H.key)):X=E.toWordArray(H.key);var re=new q;if(re.key=X,re.algorithm=H.algorithm||T,re.keyLength=X.words.length*(4*8),re.mode=H.mode||P,H.keyLength&&H.keyLength!==re.keyLength)throw new Error("Crypto.getDefaultParams: a keyLength of "+H.keyLength+" was specified, but the key actually has length "+re.keyLength);return z(re),re},Z.generateRandomKey=function(H,X){arguments.length==1&&typeof H=="function"&&(X=H,H=void 0),N((H||A)/8,function(re,ae){X!==void 0&&X(re?_.a.fromValues(re):null,ae)})},Z.getCipher=function(H){var X=H instanceof q?H:Z.getDefaultParams(H);return{cipherParams:X,cipher:new $(X,R,H.iv)}};function $(H,X,re){this.algorithm=H.algorithm+"-"+String(H.keyLength)+"-"+H.mode,this.cjsAlgorithm=H.algorithm.toUpperCase().replace(/-\d+$/,""),this.key=E.toWordArray(H.key),re&&(this.iv=E.toWordArray(re).clone()),this.blockLengthWords=X}return $.prototype.encrypt=function(H,X){g.a.logAction(g.a.LOG_MICRO,"CBCCipher.encrypt()",""),H=E.toWordArray(H);var re=H.sigBytes,ae=F(re),he=this,pe=function(){he.getIv(function(de,ee){if(de){X(de);return}var se=he.encryptCipher.process(H.concat(J[ae-re])),Y=ee.concat(se);X(null,Y)})};this.encryptCipher?pe():this.iv?(this.encryptCipher=f.a.algo[this.cjsAlgorithm].createEncryptor(this.key,{iv:this.iv}),pe()):N(O,function(de,ee){if(de){X(de);return}he.encryptCipher=f.a.algo[he.cjsAlgorithm].createEncryptor(he.key,{iv:ee}),he.iv=ee,pe()})},$.prototype.decrypt=function(H){g.a.logAction(g.a.LOG_MICRO,"CBCCipher.decrypt()",""),H=E.toWordArray(H);var X=this.blockLengthWords,re=H.words,ae=c.a.create(re.slice(0,X)),he=c.a.create(re.slice(X)),pe=f.a.algo[this.cjsAlgorithm].createDecryptor(this.key,{iv:ae}),de=pe.process(he),ee=pe.finalize();return pe.reset(),ee&&ee.sigBytes&&de.concat(ee),de},$.prototype.getIv=function(H){if(this.iv){var X=this.iv;this.iv=null,H(null,X);return}var re=this;N(O,function(ae,he){if(ae){H(ae);return}H(null,re.encryptCipher.process(he))})},Z};r.default=b},function(t,r,n){(function(l,c){t.exports=c(n(6))})(this,function(l){return function(){var c=l,h=c.lib,d=h.WordArray,f=c.enc;f.Utf16=f.Utf16BE={stringify:function(g){for(var y=g.words,_=g.sigBytes,b=[],S=0;S<_;S+=2){var E=y[S>>>2]>>>16-S%4*8&65535;b.push(String.fromCharCode(E))}return b.join("")},parse:function(g){for(var y=g.length,_=[],b=0;b<y;b++)_[b>>>1]|=g.charCodeAt(b)<<16-b%2*16;return d.create(_,y*2)}},f.Utf16LE={stringify:function(g){for(var y=g.words,_=g.sigBytes,b=[],S=0;S<_;S+=2){var E=m(y[S>>>2]>>>16-S%4*8&65535);b.push(String.fromCharCode(E))}return b.join("")},parse:function(g){for(var y=g.length,_=[],b=0;b<y;b++)_[b>>>1]|=m(g.charCodeAt(b)<<16-b%2*16);return d.create(_,y*2)}};function m(g){return g<<8&4278255360|g>>>8&16711935}}(),l.enc.Utf16})},function(t,r,n){(function(l,c){t.exports=c(n(6),n(28))})(this,function(l){return function(c){var h=l,d=h.lib,f=d.CipherParams,m=h.enc,g=m.Hex,y=h.format;y.Hex={stringify:function(_){return _.ciphertext.toString(g)},parse:function(_){var b=g.parse(_);return f.create({ciphertext:b})}}}(),l.format.Hex})},function(t,r,n){(function(l,c){t.exports=c(n(6),n(11),n(61),n(27),n(28))})(this,function(l){return function(){var c=l,h=c.lib,d=h.BlockCipher,f=c.algo,m=[],g=[],y=[],_=[],b=[],S=[],E=[],T=[],A=[],P=[];(function(){for(var D=[],L=0;L<256;L++)L<128?D[L]=L<<1:D[L]=L<<1^283;for(var N=0,U=0,L=0;L<256;L++){var F=U^U<<1^U<<2^U<<3^U<<4;F=F>>>8^F&255^99,m[N]=F,g[F]=N;var z=D[N],G=D[z],J=D[G],Z=D[F]*257^F*16843008;y[N]=Z<<24|Z>>>8,_[N]=Z<<16|Z>>>16,b[N]=Z<<8|Z>>>24,S[N]=Z;var Z=J*16843009^G*65537^z*257^N*16843008;E[F]=Z<<24|Z>>>8,T[F]=Z<<16|Z>>>16,A[F]=Z<<8|Z>>>24,P[F]=Z,N?(N=z^D[D[D[J^z]]],U^=D[D[U]]):N=U=1}})();var O=[0,1,2,4,8,16,32,64,128,27,54],R=f.AES=d.extend({_doReset:function(){var D;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var L=this._keyPriorReset=this._key,N=L.words,U=L.sigBytes/4,F=this._nRounds=U+6,z=(F+1)*4,G=this._keySchedule=[],J=0;J<z;J++)J<U?G[J]=N[J]:(D=G[J-1],J%U?U>6&&J%U==4&&(D=m[D>>>24]<<24|m[D>>>16&255]<<16|m[D>>>8&255]<<8|m[D&255]):(D=D<<8|D>>>24,D=m[D>>>24]<<24|m[D>>>16&255]<<16|m[D>>>8&255]<<8|m[D&255],D^=O[J/U|0]<<24),G[J]=G[J-U]^D);for(var Z=this._invKeySchedule=[],q=0;q<z;q++){var J=z-q;if(q%4)var D=G[J];else var D=G[J-4];q<4||J<=4?Z[q]=D:Z[q]=E[m[D>>>24]]^T[m[D>>>16&255]]^A[m[D>>>8&255]]^P[m[D&255]]}}},encryptBlock:function(D,L){this._doCryptBlock(D,L,this._keySchedule,y,_,b,S,m)},decryptBlock:function(D,L){var N=D[L+1];D[L+1]=D[L+3],D[L+3]=N,this._doCryptBlock(D,L,this._invKeySchedule,E,T,A,P,g);var N=D[L+1];D[L+1]=D[L+3],D[L+3]=N},_doCryptBlock:function(D,L,N,U,F,z,G,J){for(var Z=this._nRounds,q=D[L]^N[0],$=D[L+1]^N[1],H=D[L+2]^N[2],X=D[L+3]^N[3],re=4,ae=1;ae<Z;ae++){var he=U[q>>>24]^F[$>>>16&255]^z[H>>>8&255]^G[X&255]^N[re++],pe=U[$>>>24]^F[H>>>16&255]^z[X>>>8&255]^G[q&255]^N[re++],de=U[H>>>24]^F[X>>>16&255]^z[q>>>8&255]^G[$&255]^N[re++],ee=U[X>>>24]^F[q>>>16&255]^z[$>>>8&255]^G[H&255]^N[re++];q=he,$=pe,H=de,X=ee}var he=(J[q>>>24]<<24|J[$>>>16&255]<<16|J[H>>>8&255]<<8|J[X&255])^N[re++],pe=(J[$>>>24]<<24|J[H>>>16&255]<<16|J[X>>>8&255]<<8|J[q&255])^N[re++],de=(J[H>>>24]<<24|J[X>>>16&255]<<16|J[q>>>8&255]<<8|J[$&255])^N[re++],ee=(J[X>>>24]<<24|J[q>>>16&255]<<16|J[$>>>8&255]<<8|J[H&255])^N[re++];D[L]=he,D[L+1]=pe,D[L+2]=de,D[L+3]=ee},keySize:256/32});c.AES=d._createHelper(R)}(),l.AES})},function(t,r,n){(function(l,c){t.exports=c(n(6))})(this,function(l){return function(c){var h=l,d=h.lib,f=d.WordArray,m=d.Hasher,g=h.algo,y=[];(function(){for(var A=0;A<64;A++)y[A]=c.abs(c.sin(A+1))*4294967296|0})();var _=g.MD5=m.extend({_doReset:function(){this._hash=new f.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(A,P){for(var O=0;O<16;O++){var R=P+O,D=A[R];A[R]=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360}var L=this._hash.words,N=A[P+0],U=A[P+1],F=A[P+2],z=A[P+3],G=A[P+4],J=A[P+5],Z=A[P+6],q=A[P+7],$=A[P+8],H=A[P+9],X=A[P+10],re=A[P+11],ae=A[P+12],he=A[P+13],pe=A[P+14],de=A[P+15],ee=L[0],se=L[1],Y=L[2],fe=L[3];ee=b(ee,se,Y,fe,N,7,y[0]),fe=b(fe,ee,se,Y,U,12,y[1]),Y=b(Y,fe,ee,se,F,17,y[2]),se=b(se,Y,fe,ee,z,22,y[3]),ee=b(ee,se,Y,fe,G,7,y[4]),fe=b(fe,ee,se,Y,J,12,y[5]),Y=b(Y,fe,ee,se,Z,17,y[6]),se=b(se,Y,fe,ee,q,22,y[7]),ee=b(ee,se,Y,fe,$,7,y[8]),fe=b(fe,ee,se,Y,H,12,y[9]),Y=b(Y,fe,ee,se,X,17,y[10]),se=b(se,Y,fe,ee,re,22,y[11]),ee=b(ee,se,Y,fe,ae,7,y[12]),fe=b(fe,ee,se,Y,he,12,y[13]),Y=b(Y,fe,ee,se,pe,17,y[14]),se=b(se,Y,fe,ee,de,22,y[15]),ee=S(ee,se,Y,fe,U,5,y[16]),fe=S(fe,ee,se,Y,Z,9,y[17]),Y=S(Y,fe,ee,se,re,14,y[18]),se=S(se,Y,fe,ee,N,20,y[19]),ee=S(ee,se,Y,fe,J,5,y[20]),fe=S(fe,ee,se,Y,X,9,y[21]),Y=S(Y,fe,ee,se,de,14,y[22]),se=S(se,Y,fe,ee,G,20,y[23]),ee=S(ee,se,Y,fe,H,5,y[24]),fe=S(fe,ee,se,Y,pe,9,y[25]),Y=S(Y,fe,ee,se,z,14,y[26]),se=S(se,Y,fe,ee,$,20,y[27]),ee=S(ee,se,Y,fe,he,5,y[28]),fe=S(fe,ee,se,Y,F,9,y[29]),Y=S(Y,fe,ee,se,q,14,y[30]),se=S(se,Y,fe,ee,ae,20,y[31]),ee=E(ee,se,Y,fe,J,4,y[32]),fe=E(fe,ee,se,Y,$,11,y[33]),Y=E(Y,fe,ee,se,re,16,y[34]),se=E(se,Y,fe,ee,pe,23,y[35]),ee=E(ee,se,Y,fe,U,4,y[36]),fe=E(fe,ee,se,Y,G,11,y[37]),Y=E(Y,fe,ee,se,q,16,y[38]),se=E(se,Y,fe,ee,X,23,y[39]),ee=E(ee,se,Y,fe,he,4,y[40]),fe=E(fe,ee,se,Y,N,11,y[41]),Y=E(Y,fe,ee,se,z,16,y[42]),se=E(se,Y,fe,ee,Z,23,y[43]),ee=E(ee,se,Y,fe,H,4,y[44]),fe=E(fe,ee,se,Y,ae,11,y[45]),Y=E(Y,fe,ee,se,de,16,y[46]),se=E(se,Y,fe,ee,F,23,y[47]),ee=T(ee,se,Y,fe,N,6,y[48]),fe=T(fe,ee,se,Y,q,10,y[49]),Y=T(Y,fe,ee,se,pe,15,y[50]),se=T(se,Y,fe,ee,J,21,y[51]),ee=T(ee,se,Y,fe,ae,6,y[52]),fe=T(fe,ee,se,Y,z,10,y[53]),Y=T(Y,fe,ee,se,X,15,y[54]),se=T(se,Y,fe,ee,U,21,y[55]),ee=T(ee,se,Y,fe,$,6,y[56]),fe=T(fe,ee,se,Y,de,10,y[57]),Y=T(Y,fe,ee,se,Z,15,y[58]),se=T(se,Y,fe,ee,he,21,y[59]),ee=T(ee,se,Y,fe,G,6,y[60]),fe=T(fe,ee,se,Y,re,10,y[61]),Y=T(Y,fe,ee,se,F,15,y[62]),se=T(se,Y,fe,ee,H,21,y[63]),L[0]=L[0]+ee|0,L[1]=L[1]+se|0,L[2]=L[2]+Y|0,L[3]=L[3]+fe|0},_doFinalize:function(){var A=this._data,P=A.words,O=this._nDataBytes*8,R=A.sigBytes*8;P[R>>>5]|=128<<24-R%32;var D=c.floor(O/4294967296),L=O;P[(R+64>>>9<<4)+15]=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360,P[(R+64>>>9<<4)+14]=(L<<8|L>>>24)&16711935|(L<<24|L>>>8)&4278255360,A.sigBytes=(P.length+1)*4,this._process();for(var N=this._hash,U=N.words,F=0;F<4;F++){var z=U[F];U[F]=(z<<8|z>>>24)&16711935|(z<<24|z>>>8)&4278255360}return N},clone:function(){var A=m.clone.call(this);return A._hash=this._hash.clone(),A}});function b(A,P,O,R,D,L,N){var U=A+(P&O|~P&R)+D+N;return(U<<L|U>>>32-L)+P}function S(A,P,O,R,D,L,N){var U=A+(P&R|O&~R)+D+N;return(U<<L|U>>>32-L)+P}function E(A,P,O,R,D,L,N){var U=A+(P^O^R)+D+N;return(U<<L|U>>>32-L)+P}function T(A,P,O,R,D,L,N){var U=A+(O^(P|~R))+D+N;return(U<<L|U>>>32-L)+P}h.MD5=m._createHelper(_),h.HmacMD5=m._createHmacHelper(_)}(Math),l.MD5})},function(t,r,n){var l;Object.defineProperty(r,"__esModule",{value:!0});var c=n(0),h=c.__importDefault(n(3)),d=c.__importStar(n(1)),f=c.__importDefault(n(8)),m=n(4),g=c.__importDefault(n(18)),y=c.__importDefault(n(16)),_=c.__importDefault(n(21)),b=c.__importDefault(n(2)),S=n(29),E=c.__importDefault(n(63)),T=n(25);function A(R){var D=R.statusCode;return D===408&&!R.code||D===400&&!R.code||D>=500&&D<=504}function P(R){var D=R.connection,L=D&&D.connectionManager.host;return L?[L].concat(f.default.getFallbackHosts(R.options)):f.default.getHosts(R.options)}var O=(l=function(){function R(D){this.checksInProgress=null,this.checkConnectivity=void 0,this.supportsAuthHeaders=!1,this.supportsLinkHeaders=!1,this._getHosts=P,this.options=D||{};var L=this.options.connectivityCheckUrl||f.default.connectivityCheckUrl,N=this.options.connectivityCheckParams,U=!this.options.connectivityCheckUrl;h.default.Config.xhrSupported?(this.supportsAuthHeaders=!0,this.Request=function(F,z,G,J,Z,q,$){var H=y.default.createRequest(G,J,Z,q,_.default.REQ_SEND,z&&z.options.timeouts,F);return H.once("complete",$),H.exec(),H},this.options.disableConnectivityCheck?this.checkConnectivity=function(F){F(null,!0)}:this.checkConnectivity=function(F){b.default.logAction(b.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Sending; "+L),this.doUri(g.default.Get,null,L,null,null,N,function(z,G,J,Z,q){var $=!1;U?$=!z&&(G==null?void 0:G.replace(/\n/,""))=="yes":$=!z&&(0,T.isSuccessCode)(q),b.default.logAction(b.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Result: "+$),F(null,$)})}):h.default.Config.jsonpSupported?(this.Request=function(F,z,G,J,Z,q,$){var H=(0,S.createRequest)(G,J,Z,q,_.default.REQ_SEND,z&&z.options.timeouts,F);return H.once("complete",$),h.default.Config.nextTick(function(){H.exec()}),H},this.options.disableConnectivityCheck?this.checkConnectivity=function(F){F(null,!0)}:this.checkConnectivity=function(F){var z=this,G=f.default.jsonpInternetUpUrl;if(this.checksInProgress){this.checksInProgress.push(F);return}this.checksInProgress=[F],b.default.logAction(b.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Sending; "+G);var J=new S.Request("isTheInternetUp",G,null,null,null,_.default.REQ_SEND,f.default.TIMEOUTS);J.once("complete",function(Z,q){var $=!Z&&q;b.default.logAction(b.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Result: "+$);for(var H=0;H<z.checksInProgress.length;H++)z.checksInProgress[H](null,$);z.checksInProgress=null}),h.default.Config.nextTick(function(){J.exec()})}):h.default.Config.fetchSupported?(this.supportsAuthHeaders=!0,this.Request=E.default,this.checkConnectivity=function(F){b.default.logAction(b.default.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Sending; "+L),this.doUri(g.default.Get,null,L,null,null,null,function(z,G){var J=!z&&(G==null?void 0:G.replace(/\n/,""))=="yes";b.default.logAction(b.default.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Result: "+J),F(null,J)})}):this.Request=function(F,z,G,J,Z,q,$){$(new m.PartialErrorInfo("no supported HTTP transports available",null,400),null)}}return R.prototype.do=function(D,L,N,U,F,z,G){var J=this,Z=typeof N=="function"?N:function(X){return L.baseUri(X)+N},q=L._currentFallback;if(q)if(q.validUntil>d.now()){if(!this.Request){G==null||G(new m.PartialErrorInfo("Request invoked before assigned to",null,500));return}this.Request(D,L,Z(q.host),U,z,F,function(X){for(var re=[],ae=1;ae<arguments.length;ae++)re[ae-1]=arguments[ae];if(X&&A(X)){L._currentFallback=null,J.do(D,L,N,U,F,z,G);return}G==null||G.apply(void 0,c.__spreadArray([X],re,!1))});return}else L._currentFallback=null;var $=P(L);if($.length===1){this.doUri(D,L,Z($[0]),U,F,z,G);return}var H=function(X,re){var ae=X.shift();J.doUri(D,L,Z(ae),U,F,z,function(he){for(var pe=[],de=1;de<arguments.length;de++)pe[de-1]=arguments[de];if(he&&A(he)&&X.length){H(X,!0);return}re&&(L._currentFallback={host:ae,validUntil:d.now()+L.options.timeouts.fallbackRetryTimeout}),G==null||G.apply(void 0,c.__spreadArray([he],pe,!1))})};H($)},R.prototype.doUri=function(D,L,N,U,F,z,G){if(!this.Request){G(new m.PartialErrorInfo("Request invoked before assigned to",null,500));return}this.Request(D,L,N,U,z,F,G)},R}(),l.methods=[g.default.Get,g.default.Delete,g.default.Post,g.default.Put,g.default.Patch],l.methodsWithoutBody=[g.default.Get,g.default.Delete],l.methodsWithBody=[g.default.Post,g.default.Put,g.default.Patch],l);r.default=O},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=n(0),c=l.__importStar(n(4)),h=l.__importDefault(n(3)),d=l.__importDefault(n(8)),f=l.__importStar(n(1)),m=n(1);function g(b,S){return!!S.get("x-ably-errorcode")}function y(b,S){if(g(b,S))return b.error&&c.default.fromValues(b.error)}function _(b,S,E,T,A,P,O){var R=new Headers(T||{}),D=b?b.toUpperCase():f.isEmptyArg(P)?"GET":"POST",L=new AbortController,N=setTimeout(function(){L.abort(),O(new c.PartialErrorInfo("Request timed out",null,408))},S?S.options.timeouts.httpRequestTimeout:d.default.TIMEOUTS.httpRequestTimeout),U={method:D,headers:R,body:P};h.default.Config.isWebworker||(U.credentials=R.has("authorization")?"include":"same-origin"),(0,m.getGlobalObject)().fetch(E+"?"+new URLSearchParams(A||{}),U).then(function(F){clearTimeout(N);var z=F.headers.get("Content-Type"),G;z&&z.indexOf("application/x-msgpack")>-1?G=F.arrayBuffer():z&&z.indexOf("application/json")>-1?G=F.json():G=F.text(),G.then(function(J){var Z=!!z&&z.indexOf("application/x-msgpack")===-1;if(F.ok)O(null,J,F.headers,Z,F.status);else{var q=y(J,F.headers)||new c.PartialErrorInfo("Error response received from server: "+F.status+" body was: "+h.default.Config.inspect(J),null,F.status);O(q,J,F.headers,Z,F.status)}})}).catch(function(F){clearTimeout(N),O(F)})}r.default=_},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=n(0),c=l.__importDefault(n(41)),h=l.__importStar(n(1)),d=h.getGlobalObject();typeof Window>"u"&&typeof WorkerGlobalScope>"u"&&console.log("Warning: this distribution of Ably is intended for browsers. On nodejs, please use the 'ably' package on npm");function f(){var _=d.location;return!d.WebSocket||!_||!_.origin||_.origin.indexOf("http")>-1}var m=d.navigator&&d.navigator.userAgent.toString(),g=d.location&&d.location.href,y={agent:"browser",logTimestamps:!0,userAgent:m,currentUrl:g,noUpgrade:m&&!!m.match(/MSIE\s8\.0/),binaryType:"arraybuffer",WebSocket:d.WebSocket,fetchSupported:!!d.fetch,xhrSupported:d.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,jsonpSupported:typeof document<"u",allowComet:f(),streamingSupported:!0,useProtocolHeartbeats:!0,createHmac:null,msgpack:c.default,supportsBinary:!!d.TextDecoder,preferBinary:!1,ArrayBuffer:d.ArrayBuffer,atob:d.atob,nextTick:typeof d.setImmediate<"u"?d.setImmediate.bind(d):function(_){setTimeout(_,0)},addEventListener:d.addEventListener,inspect:JSON.stringify,stringByteSize:function(_){return d.TextDecoder&&new d.TextEncoder().encode(_).length||_.length},TextEncoder:d.TextEncoder,TextDecoder:d.TextDecoder,Promise:d.Promise,getRandomValues:function(_){if(_!==void 0)return function(b,S){_.getRandomValues(b),S&&S(null)}}(d.crypto||msCrypto)};r.default=y},function(t,r,n){(function(l){Object.defineProperty(r,"__esModule",{value:!0});var c=n(0),h=c.__importStar(n(1)),d="ablyjs-storage-test",f=function(){function m(){try{l.sessionStorage.setItem(d,d),l.sessionStorage.removeItem(d),this.sessionSupported=!0}catch{this.sessionSupported=!1}try{l.localStorage.setItem(d,d),l.localStorage.removeItem(d),this.localSupported=!0}catch{this.localSupported=!1}}return m.prototype.get=function(g){return this._get(g,!1)},m.prototype.getSession=function(g){return this._get(g,!0)},m.prototype.remove=function(g){return this._remove(g,!1)},m.prototype.removeSession=function(g){return this._remove(g,!0)},m.prototype.set=function(g,y,_){return this._set(g,y,_,!1)},m.prototype.setSession=function(g,y,_){return this._set(g,y,_,!0)},m.prototype._set=function(g,y,_,b){var S={value:y};return _&&(S.expires=h.now()+_),this.storageInterface(b).setItem(g,JSON.stringify(S))},m.prototype._get=function(g,y){if(y&&!this.sessionSupported)throw new Error("Session Storage not supported");if(!y&&!this.localSupported)throw new Error("Local Storage not supported");var _=this.storageInterface(y).getItem(g);if(!_)return null;var b=JSON.parse(_);return b.expires&&b.expires<h.now()?(this.storageInterface(y).removeItem(g),null):b.value},m.prototype._remove=function(g,y){return this.storageInterface(y).removeItem(g)},m.prototype.storageInterface=function(g){return g?l.sessionStorage:l.localStorage},m}();r.default=new f}).call(this,n(13))},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l=n(0),c=l.__importDefault(n(67)),h={connectivityCheckUrl:"https://internet-up.ably-realtime.com/is-the-internet-up.txt",jsonpInternetUpUrl:"https://internet-up.ably-realtime.com/is-the-internet-up-0-9.js",defaultTransports:[c.default.XhrPolling,c.default.XhrStreaming,c.default.JsonP,c.default.WebSocket],baseTransportOrder:[c.default.XhrPolling,c.default.XhrStreaming,c.default.JsonP,c.default.WebSocket],transportPreferenceOrder:[c.default.JsonP,c.default.XhrPolling,c.default.XhrStreaming,c.default.WebSocket],upgradeTransports:[c.default.XhrStreaming,c.default.WebSocket]};r.default=h},function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0});var l;(function(c){c.WebSocket="web_socket",c.Comet="comet",c.XhrStreaming="xhr_streaming",c.XhrPolling="xhr_polling",c.JsonP="jsonp"})(l||(l={})),r.default=l},function(t,r,n){n.r(r);var l=n(29),c=n.n(l),h=n(1),d=n(3),f=n.n(d),m=n(12),g=n.n(m),y=n(16),_=n.n(y),b=function(A){var P="xhr_polling";function O(R,D,L){L.stream=!1,g.a.call(this,R,D,L),this.shortName=P}return h.inherits(O,g.a),O.isAvailable=function(){return f.a.Config.xhrSupported&&f.a.Config.allowComet},O.prototype.toString=function(){return"XHRPollingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},O.prototype.createRequest=function(R,D,L,N,U){return _.a.createRequest(R,D,L,N,U,this.timeouts)},typeof A<"u"&&O.isAvailable()&&(A.supportedTransports[P]=O),O},S=b,E=function(A){var P="xhr_streaming";function O(R,D,L){g.a.call(this,R,D,L),this.shortName=P}return h.inherits(O,g.a),O.isAvailable=function(){return f.a.Config.xhrSupported&&f.a.Config.streamingSupported&&f.a.Config.allowComet},O.prototype.toString=function(){return"XHRStreamingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},O.prototype.createRequest=function(R,D,L,N,U){return _.a.createRequest(R,D,L,N,U,this.timeouts)},typeof A<"u"&&O.isAvailable()&&(A.supportedTransports[P]=O),O},T=E;r.default=[c.a,S,T]}]).default})})(MX);var Fge=MX.exports;const oV=Qd(Fge);/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const KP=globalThis,PB=KP.ShadowRoot&&(KP.ShadyCSS===void 0||KP.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,RB=Symbol(),lV=new WeakMap;let EX=class{constructor(e,t,r){if(this._$cssResult$=!0,r!==RB)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(PB&&e===void 0){const r=t!==void 0&&t.length===1;r&&(e=lV.get(t)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),r&&lV.set(t,e))}return e}toString(){return this.cssText}};const zge=i=>new EX(typeof i=="string"?i:i+"",void 0,RB),Zn=(i,...e)=>{const t=i.length===1?i[0]:e.reduce((r,n,l)=>r+(c=>{if(c._$cssResult$===!0)return c.cssText;if(typeof c=="number")return c;throw Error("Value passed to 'css' function must be a 'css' function result: "+c+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(n)+i[l+1],i[0]);return new EX(t,i,RB)},Bge=(i,e)=>{if(PB)i.adoptedStyleSheets=e.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet);else for(const t of e){const r=document.createElement("style"),n=KP.litNonce;n!==void 0&&r.setAttribute("nonce",n),r.textContent=t.cssText,i.appendChild(r)}},uV=PB?i=>i:i=>i instanceof CSSStyleSheet?(e=>{let t="";for(const r of e.cssRules)t+=r.cssText;return zge(t)})(i):i;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:Uge,defineProperty:Hge,getOwnPropertyDescriptor:$ge,getOwnPropertyNames:Vge,getOwnPropertySymbols:Wge,getPrototypeOf:jge}=Object,$m=globalThis,cV=$m.trustedTypes,Gge=cV?cV.emptyScript:"",PN=$m.reactiveElementPolyfillSupport,QT=(i,e)=>i,VF={toAttribute(i,e){switch(e){case Boolean:i=i?Gge:null;break;case Object:case Array:i=i==null?i:JSON.stringify(i)}return i},fromAttribute(i,e){let t=i;switch(e){case Boolean:t=i!==null;break;case Number:t=i===null?null:Number(i);break;case Object:case Array:try{t=JSON.parse(i)}catch{t=null}}return t}},TX=(i,e)=>!Uge(i,e),hV={attribute:!0,type:String,converter:VF,reflect:!1,hasChanged:TX};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),$m.litPropertyMetadata??($m.litPropertyMetadata=new WeakMap);let kS=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??(this.l=[])).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=hV){if(t.state&&(t.attribute=!1),this._$Ei(),this.elementProperties.set(e,t),!t.noAccessor){const r=Symbol(),n=this.getPropertyDescriptor(e,r,t);n!==void 0&&Hge(this.prototype,e,n)}}static getPropertyDescriptor(e,t,r){const{get:n,set:l}=$ge(this.prototype,e)??{get(){return this[t]},set(c){this[t]=c}};return{get(){return n==null?void 0:n.call(this)},set(c){const h=n==null?void 0:n.call(this);l.call(this,c),this.requestUpdate(e,h,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??hV}static _$Ei(){if(this.hasOwnProperty(QT("elementProperties")))return;const e=jge(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(QT("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(QT("properties"))){const t=this.properties,r=[...Vge(t),...Wge(t)];for(const n of r)this.createProperty(n,t[n])}const e=this[Symbol.metadata];if(e!==null){const t=litPropertyMetadata.get(e);if(t!==void 0)for(const[r,n]of t)this.elementProperties.set(r,n)}this._$Eh=new Map;for(const[t,r]of this.elementProperties){const n=this._$Eu(t,r);n!==void 0&&this._$Eh.set(n,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const r=new Set(e.flat(1/0).reverse());for(const n of r)t.unshift(uV(n))}else e!==void 0&&t.push(uV(e));return t}static _$Eu(e,t){const r=t.attribute;return r===!1?void 0:typeof r=="string"?r:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var e;this._$ES=new Promise(t=>this.enableUpdating=t),this._$AL=new Map,this._$E_(),this.requestUpdate(),(e=this.constructor.l)==null||e.forEach(t=>t(this))}addController(e){var t;(this._$EO??(this._$EO=new Set)).add(e),this.renderRoot!==void 0&&this.isConnected&&((t=e.hostConnected)==null||t.call(e))}removeController(e){var t;(t=this._$EO)==null||t.delete(e)}_$E_(){const e=new Map,t=this.constructor.elementProperties;for(const r of t.keys())this.hasOwnProperty(r)&&(e.set(r,this[r]),delete this[r]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return Bge(e,this.constructor.elementStyles),e}connectedCallback(){var e;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$EO)==null||e.forEach(t=>{var r;return(r=t.hostConnected)==null?void 0:r.call(t)})}enableUpdating(e){}disconnectedCallback(){var e;(e=this._$EO)==null||e.forEach(t=>{var r;return(r=t.hostDisconnected)==null?void 0:r.call(t)})}attributeChangedCallback(e,t,r){this._$AK(e,r)}_$EC(e,t){var l;const r=this.constructor.elementProperties.get(e),n=this.constructor._$Eu(e,r);if(n!==void 0&&r.reflect===!0){const c=(((l=r.converter)==null?void 0:l.toAttribute)!==void 0?r.converter:VF).toAttribute(t,r.type);this._$Em=e,c==null?this.removeAttribute(n):this.setAttribute(n,c),this._$Em=null}}_$AK(e,t){var l;const r=this.constructor,n=r._$Eh.get(e);if(n!==void 0&&this._$Em!==n){const c=r.getPropertyOptions(n),h=typeof c.converter=="function"?{fromAttribute:c.converter}:((l=c.converter)==null?void 0:l.fromAttribute)!==void 0?c.converter:VF;this._$Em=n,this[n]=h.fromAttribute(t,c.type),this._$Em=null}}requestUpdate(e,t,r){if(e!==void 0){if(r??(r=this.constructor.getPropertyOptions(e)),!(r.hasChanged??TX)(this[e],t))return;this.P(e,t,r)}this.isUpdatePending===!1&&(this._$ES=this._$ET())}P(e,t,r){this._$AL.has(e)||this._$AL.set(e,t),r.reflect===!0&&this._$Em!==e&&(this._$Ej??(this._$Ej=new Set)).add(e)}async _$ET(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var r;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[l,c]of this._$Ep)this[l]=c;this._$Ep=void 0}const n=this.constructor.elementProperties;if(n.size>0)for(const[l,c]of n)c.wrapped!==!0||this._$AL.has(l)||this[l]===void 0||this.P(l,this[l],c)}let e=!1;const t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),(r=this._$EO)==null||r.forEach(n=>{var l;return(l=n.hostUpdate)==null?void 0:l.call(n)}),this.update(t)):this._$EU()}catch(n){throw e=!1,this._$EU(),n}e&&this._$AE(t)}willUpdate(e){}_$AE(e){var t;(t=this._$EO)==null||t.forEach(r=>{var n;return(n=r.hostUpdated)==null?void 0:n.call(r)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EU(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Ej&&(this._$Ej=this._$Ej.forEach(t=>this._$EC(t,this[t]))),this._$EU()}updated(e){}firstUpdated(e){}};kS.elementStyles=[],kS.shadowRootOptions={mode:"open"},kS[QT("elementProperties")]=new Map,kS[QT("finalized")]=new Map,PN==null||PN({ReactiveElement:kS}),($m.reactiveElementVersions??($m.reactiveElementVersions=[])).push("2.0.4");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const eA=globalThis,eI=eA.trustedTypes,dV=eI?eI.createPolicy("lit-html",{createHTML:i=>i}):void 0,IB="$lit$",hp=`lit$${(Math.random()+"").slice(9)}$`,LB="?"+hp,qge=`<${LB}>`,cw=document,KA=()=>cw.createComment(""),QA=i=>i===null||typeof i!="object"&&typeof i!="function",AX=Array.isArray,CX=i=>AX(i)||typeof(i==null?void 0:i[Symbol.iterator])=="function",RN=`[ 	
\f\r]`,rT=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,fV=/-->/g,pV=/>/g,o1=RegExp(`>|${RN}(?:([^\\s"'>=/]+)(${RN}*=${RN}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),mV=/'/g,gV=/"/g,PX=/^(?:script|style|textarea|title)$/i,Xge=i=>(e,...t)=>({_$litType$:i,strings:e,values:t}),Vt=Xge(1),Qm=Symbol.for("lit-noChange"),qa=Symbol.for("lit-nothing"),vV=new WeakMap,D1=cw.createTreeWalker(cw,129);function RX(i,e){if(!Array.isArray(i)||!i.hasOwnProperty("raw"))throw Error("invalid template strings array");return dV!==void 0?dV.createHTML(e):e}const IX=(i,e)=>{const t=i.length-1,r=[];let n,l=e===2?"<svg>":"",c=rT;for(let h=0;h<t;h++){const d=i[h];let f,m,g=-1,y=0;for(;y<d.length&&(c.lastIndex=y,m=c.exec(d),m!==null);)y=c.lastIndex,c===rT?m[1]==="!--"?c=fV:m[1]!==void 0?c=pV:m[2]!==void 0?(PX.test(m[2])&&(n=RegExp("</"+m[2],"g")),c=o1):m[3]!==void 0&&(c=o1):c===o1?m[0]===">"?(c=n??rT,g=-1):m[1]===void 0?g=-2:(g=c.lastIndex-m[2].length,f=m[1],c=m[3]===void 0?o1:m[3]==='"'?gV:mV):c===gV||c===mV?c=o1:c===fV||c===pV?c=rT:(c=o1,n=void 0);const _=c===o1&&i[h+1].startsWith("/>")?" ":"";l+=c===rT?d+qge:g>=0?(r.push(f),d.slice(0,g)+IB+d.slice(g)+hp+_):d+hp+(g===-2?h:_)}return[RX(i,l+(i[t]||"<?>")+(e===2?"</svg>":"")),r]};let WF=class LX{constructor({strings:e,_$litType$:t},r){let n;this.parts=[];let l=0,c=0;const h=e.length-1,d=this.parts,[f,m]=IX(e,t);if(this.el=LX.createElement(f,r),D1.currentNode=this.el.content,t===2){const g=this.el.content.firstChild;g.replaceWith(...g.childNodes)}for(;(n=D1.nextNode())!==null&&d.length<h;){if(n.nodeType===1){if(n.hasAttributes())for(const g of n.getAttributeNames())if(g.endsWith(IB)){const y=m[c++],_=n.getAttribute(g).split(hp),b=/([.?@])?(.*)/.exec(y);d.push({type:1,index:l,name:b[2],strings:_,ctor:b[1]==="."?DX:b[1]==="?"?kX:b[1]==="@"?FX:IC}),n.removeAttribute(g)}else g.startsWith(hp)&&(d.push({type:6,index:l}),n.removeAttribute(g));if(PX.test(n.tagName)){const g=n.textContent.split(hp),y=g.length-1;if(y>0){n.textContent=eI?eI.emptyScript:"";for(let _=0;_<y;_++)n.append(g[_],KA()),D1.nextNode(),d.push({type:2,index:++l});n.append(g[y],KA())}}}else if(n.nodeType===8)if(n.data===LB)d.push({type:2,index:l});else{let g=-1;for(;(g=n.data.indexOf(hp,g+1))!==-1;)d.push({type:7,index:l}),g+=hp.length-1}l++}}static createElement(e,t){const r=cw.createElement("template");return r.innerHTML=e,r}};function hw(i,e,t=i,r){var c,h;if(e===Qm)return e;let n=r!==void 0?(c=t._$Co)==null?void 0:c[r]:t._$Cl;const l=QA(e)?void 0:e._$litDirective$;return(n==null?void 0:n.constructor)!==l&&((h=n==null?void 0:n._$AO)==null||h.call(n,!1),l===void 0?n=void 0:(n=new l(i),n._$AT(i,t,r)),r!==void 0?(t._$Co??(t._$Co=[]))[r]=n:t._$Cl=n),n!==void 0&&(e=hw(i,n._$AS(i,e.values),n,r)),e}let OX=class{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:r}=this._$AD,n=((e==null?void 0:e.creationScope)??cw).importNode(t,!0);D1.currentNode=n;let l=D1.nextNode(),c=0,h=0,d=r[0];for(;d!==void 0;){if(c===d.index){let f;d.type===2?f=new hL(l,l.nextSibling,this,e):d.type===1?f=new d.ctor(l,d.name,d.strings,this,e):d.type===6&&(f=new zX(l,this,e)),this._$AV.push(f),d=r[++h]}c!==(d==null?void 0:d.index)&&(l=D1.nextNode(),c++)}return D1.currentNode=cw,n}p(e){let t=0;for(const r of this._$AV)r!==void 0&&(r.strings!==void 0?(r._$AI(e,r,t),t+=r.strings.length-2):r._$AI(e[t])),t++}},hL=class NX{get _$AU(){var e;return((e=this._$AM)==null?void 0:e._$AU)??this._$Cv}constructor(e,t,r,n){this.type=2,this._$AH=qa,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=r,this.options=n,this._$Cv=(n==null?void 0:n.isConnected)??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return t!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=hw(this,e,t),QA(e)?e===qa||e==null||e===""?(this._$AH!==qa&&this._$AR(),this._$AH=qa):e!==this._$AH&&e!==Qm&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):CX(e)?this.k(e):this._(e)}S(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.S(e))}_(e){this._$AH!==qa&&QA(this._$AH)?this._$AA.nextSibling.data=e:this.T(cw.createTextNode(e)),this._$AH=e}$(e){var l;const{values:t,_$litType$:r}=e,n=typeof r=="number"?this._$AC(e):(r.el===void 0&&(r.el=WF.createElement(RX(r.h,r.h[0]),this.options)),r);if(((l=this._$AH)==null?void 0:l._$AD)===n)this._$AH.p(t);else{const c=new OX(n,this),h=c.u(this.options);c.p(t),this.T(h),this._$AH=c}}_$AC(e){let t=vV.get(e.strings);return t===void 0&&vV.set(e.strings,t=new WF(e)),t}k(e){AX(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let r,n=0;for(const l of e)n===t.length?t.push(r=new NX(this.S(KA()),this.S(KA()),this,this.options)):r=t[n],r._$AI(l),n++;n<t.length&&(this._$AR(r&&r._$AB.nextSibling,n),t.length=n)}_$AR(e=this._$AA.nextSibling,t){var r;for((r=this._$AP)==null?void 0:r.call(this,!1,!0,t);e&&e!==this._$AB;){const n=e.nextSibling;e.remove(),e=n}}setConnected(e){var t;this._$AM===void 0&&(this._$Cv=e,(t=this._$AP)==null||t.call(this,e))}},IC=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,r,n,l){this.type=1,this._$AH=qa,this._$AN=void 0,this.element=e,this.name=t,this._$AM=n,this.options=l,r.length>2||r[0]!==""||r[1]!==""?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=qa}_$AI(e,t=this,r,n){const l=this.strings;let c=!1;if(l===void 0)e=hw(this,e,t,0),c=!QA(e)||e!==this._$AH&&e!==Qm,c&&(this._$AH=e);else{const h=e;let d,f;for(e=l[0],d=0;d<l.length-1;d++)f=hw(this,h[r+d],t,d),f===Qm&&(f=this._$AH[d]),c||(c=!QA(f)||f!==this._$AH[d]),f===qa?e=qa:e!==qa&&(e+=(f??"")+l[d+1]),this._$AH[d]=f}c&&!n&&this.j(e)}j(e){e===qa?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}},DX=class extends IC{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===qa?void 0:e}},kX=class extends IC{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==qa)}},FX=class extends IC{constructor(e,t,r,n,l){super(e,t,r,n,l),this.type=5}_$AI(e,t=this){if((e=hw(this,e,t,0)??qa)===Qm)return;const r=this._$AH,n=e===qa&&r!==qa||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,l=e!==qa&&(r===qa||n);n&&this.element.removeEventListener(this.name,this,r),l&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t;typeof this._$AH=="function"?this._$AH.call(((t=this.options)==null?void 0:t.host)??this.element,e):this._$AH.handleEvent(e)}},zX=class{constructor(e,t,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){hw(this,e)}};const Zge={P:IB,A:hp,C:LB,M:1,L:IX,R:OX,D:CX,V:hw,I:hL,H:IC,N:kX,U:FX,B:DX,F:zX},IN=eA.litHtmlPolyfillSupport;IN==null||IN(WF,hL),(eA.litHtmlVersions??(eA.litHtmlVersions=[])).push("3.1.2");const Jge=(i,e,t)=>{const r=(t==null?void 0:t.renderBefore)??e;let n=r._$litPart$;if(n===void 0){const l=(t==null?void 0:t.renderBefore)??null;r._$litPart$=n=new hL(e.insertBefore(KA(),l),l,void 0,t??{})}return n._$AI(i),n};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */let Bn=class extends kS{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t;const e=super.createRenderRoot();return(t=this.renderOptions).renderBefore??(t.renderBefore=e.firstChild),e}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=Jge(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),(e=this._$Do)==null||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),(e=this._$Do)==null||e.setConnected(!1)}render(){return Qm}};var dG;Bn._$litElement$=!0,Bn.finalized=!0,(dG=globalThis.litElementHydrateSupport)==null||dG.call(globalThis,{LitElement:Bn});const LN=globalThis.litElementPolyfillSupport;LN==null||LN({LitElement:Bn});(globalThis.litElementVersions??(globalThis.litElementVersions=[])).push("4.0.4");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ps=i=>(e,t)=>{t!==void 0?t.addInitializer(()=>{customElements.define(i,e)}):customElements.define(i,e)};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const BX={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},UX=i=>(...e)=>({_$litDirective$:i,values:e});class HX{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,t,r){this._$Ct=e,this._$AM=t,this._$Ci=r}_$AS(e,t){return this.update(e,t)}update(e,t){return this.render(...t)}}/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Hr=UX(class extends HX{constructor(i){var e;if(super(i),i.type!==BX.ATTRIBUTE||i.name!=="class"||((e=i.strings)==null?void 0:e.length)>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(i){return" "+Object.keys(i).filter(e=>i[e]).join(" ")+" "}update(i,[e]){var r,n;if(this.st===void 0){this.st=new Set,i.strings!==void 0&&(this.nt=new Set(i.strings.join(" ").split(/\s/).filter(l=>l!=="")));for(const l in e)e[l]&&!((r=this.nt)!=null&&r.has(l))&&this.st.add(l);return this.render(e)}const t=i.element.classList;for(const l of this.st)l in e||(t.remove(l),this.st.delete(l));for(const l in e){const c=!!e[l];c===this.st.has(l)||(n=this.nt)!=null&&n.has(l)||(c?(t.add(l),this.st.add(l)):(t.remove(l),this.st.delete(l)))}return Qm}});/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{I:Yge}=Zge,yV=()=>document.createComment(""),nT=(i,e,t)=>{var l;const r=i._$AA.parentNode,n=e===void 0?i._$AB:e._$AA;if(t===void 0){const c=r.insertBefore(yV(),n),h=r.insertBefore(yV(),n);t=new Yge(c,h,i,i.options)}else{const c=t._$AB.nextSibling,h=t._$AM,d=h!==i;if(d){let f;(l=t._$AQ)==null||l.call(t,i),t._$AM=i,t._$AP!==void 0&&(f=i._$AU)!==h._$AU&&t._$AP(f)}if(c!==n||d){let f=t._$AA;for(;f!==c;){const m=f.nextSibling;r.insertBefore(f,n),f=m}}}return t},l1=(i,e,t=i)=>(i._$AI(e,t),i),Kge={},Qge=(i,e=Kge)=>i._$AH=e,eve=i=>i._$AH,ON=i=>{var r;(r=i._$AP)==null||r.call(i,!1,!0);let e=i._$AA;const t=i._$AB.nextSibling;for(;e!==t;){const n=e.nextSibling;e.remove(),e=n}};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const _V=(i,e,t)=>{const r=new Map;for(let n=e;n<=t;n++)r.set(i[n],n);return r},dL=UX(class extends HX{constructor(i){if(super(i),i.type!==BX.CHILD)throw Error("repeat() can only be used in text expressions")}dt(i,e,t){let r;t===void 0?t=e:e!==void 0&&(r=e);const n=[],l=[];let c=0;for(const h of i)n[c]=r?r(h,c):c,l[c]=t(h,c),c++;return{values:l,keys:n}}render(i,e,t){return this.dt(i,e,t).values}update(i,[e,t,r]){const n=eve(i),{values:l,keys:c}=this.dt(e,t,r);if(!Array.isArray(n))return this.ut=c,l;const h=this.ut??(this.ut=[]),d=[];let f,m,g=0,y=n.length-1,_=0,b=l.length-1;for(;g<=y&&_<=b;)if(n[g]===null)g++;else if(n[y]===null)y--;else if(h[g]===c[_])d[_]=l1(n[g],l[_]),g++,_++;else if(h[y]===c[b])d[b]=l1(n[y],l[b]),y--,b--;else if(h[g]===c[b])d[b]=l1(n[g],l[b]),nT(i,d[b+1],n[g]),g++,b--;else if(h[y]===c[_])d[_]=l1(n[y],l[_]),nT(i,n[g],n[y]),y--,_++;else if(f===void 0&&(f=_V(c,_,b),m=_V(h,g,y)),f.has(h[g]))if(f.has(h[y])){const S=m.get(c[_]),E=S!==void 0?n[S]:null;if(E===null){const T=nT(i,n[g]);l1(T,l[_]),d[_]=T}else d[_]=l1(E,l[_]),nT(i,n[g],E),n[S]=null;_++}else ON(n[y]),y--;else ON(n[g]),g++;for(;_<=b;){const S=nT(i,d[b+1]);l1(S,l[_]),d[_++]=S}for(;g<=y;){const S=n[g++];S!==null&&ON(S)}return this.ut=c,Qge(i,d),Qm}});class bw extends Error{}class tve extends bw{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}}class ive extends bw{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}}class rve extends bw{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}}class eM extends bw{}class $X extends bw{constructor(e){super(`Invalid unit ${e}`)}}class au extends bw{}class rm extends bw{constructor(){super("Zone is an abstract class")}}const jt="numeric",Yd="short",ku="long",tI={year:jt,month:jt,day:jt},VX={year:jt,month:Yd,day:jt},nve={year:jt,month:Yd,day:jt,weekday:Yd},WX={year:jt,month:ku,day:jt},jX={year:jt,month:ku,day:jt,weekday:ku},GX={hour:jt,minute:jt},qX={hour:jt,minute:jt,second:jt},XX={hour:jt,minute:jt,second:jt,timeZoneName:Yd},ZX={hour:jt,minute:jt,second:jt,timeZoneName:ku},JX={hour:jt,minute:jt,hourCycle:"h23"},YX={hour:jt,minute:jt,second:jt,hourCycle:"h23"},KX={hour:jt,minute:jt,second:jt,hourCycle:"h23",timeZoneName:Yd},QX={hour:jt,minute:jt,second:jt,hourCycle:"h23",timeZoneName:ku},eZ={year:jt,month:jt,day:jt,hour:jt,minute:jt},tZ={year:jt,month:jt,day:jt,hour:jt,minute:jt,second:jt},iZ={year:jt,month:Yd,day:jt,hour:jt,minute:jt},rZ={year:jt,month:Yd,day:jt,hour:jt,minute:jt,second:jt},sve={year:jt,month:Yd,day:jt,weekday:Yd,hour:jt,minute:jt},nZ={year:jt,month:ku,day:jt,hour:jt,minute:jt,timeZoneName:Yd},sZ={year:jt,month:ku,day:jt,hour:jt,minute:jt,second:jt,timeZoneName:Yd},aZ={year:jt,month:ku,day:jt,weekday:ku,hour:jt,minute:jt,timeZoneName:ku},oZ={year:jt,month:ku,day:jt,weekday:ku,hour:jt,minute:jt,second:jt,timeZoneName:ku};class LC{get type(){throw new rm}get name(){throw new rm}get ianaName(){return this.name}get isUniversal(){throw new rm}offsetName(e,t){throw new rm}formatOffset(e,t){throw new rm}offset(e){throw new rm}equals(e){throw new rm}get isValid(){throw new rm}}let NN=null;class fL extends LC{static get instance(){return NN===null&&(NN=new fL),NN}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:t,locale:r}){return gZ(e,t,r)}formatOffset(e,t){return tA(this.offset(e),t)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return e.type==="system"}get isValid(){return!0}}let QP={};function ave(i){return QP[i]||(QP[i]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:i,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),QP[i]}const ove={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function lve(i,e){const t=i.format(e).replace(/\u200E/g,""),r=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(t),[,n,l,c,h,d,f,m]=r;return[c,n,l,h,d,f,m]}function uve(i,e){const t=i.formatToParts(e),r=[];for(let n=0;n<t.length;n++){const{type:l,value:c}=t[n],h=ove[l];l==="era"?r[h]=c:Zi(h)||(r[h]=parseInt(c,10))}return r}let h3={};class Lp extends LC{static create(e){return h3[e]||(h3[e]=new Lp(e)),h3[e]}static resetCache(){h3={},QP={}}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch{return!1}}constructor(e){super(),this.zoneName=e,this.valid=Lp.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:t,locale:r}){return gZ(e,t,r,this.name)}formatOffset(e,t){return tA(this.offset(e),t)}offset(e){const t=new Date(e);if(isNaN(t))return NaN;const r=ave(this.name);let[n,l,c,h,d,f,m]=r.formatToParts?uve(r,t):lve(r,t);h==="BC"&&(n=-Math.abs(n)+1);const y=mL({year:n,month:l,day:c,hour:d===24?0:d,minute:f,second:m,millisecond:0});let _=+t;const b=_%1e3;return _-=b>=0?b:1e3+b,(y-_)/(60*1e3)}equals(e){return e.type==="iana"&&e.name===this.name}get isValid(){return this.valid}}let xV={};function cve(i,e={}){const t=JSON.stringify([i,e]);let r=xV[t];return r||(r=new Intl.ListFormat(i,e),xV[t]=r),r}let jF={};function GF(i,e={}){const t=JSON.stringify([i,e]);let r=jF[t];return r||(r=new Intl.DateTimeFormat(i,e),jF[t]=r),r}let qF={};function hve(i,e={}){const t=JSON.stringify([i,e]);let r=qF[t];return r||(r=new Intl.NumberFormat(i,e),qF[t]=r),r}let XF={};function dve(i,e={}){const{base:t,...r}=e,n=JSON.stringify([i,r]);let l=XF[n];return l||(l=new Intl.RelativeTimeFormat(i,e),XF[n]=l),l}let FT=null;function fve(){return FT||(FT=new Intl.DateTimeFormat().resolvedOptions().locale,FT)}let bV={};function pve(i){let e=bV[i];if(!e){const t=new Intl.Locale(i);e="getWeekInfo"in t?t.getWeekInfo():t.weekInfo,bV[i]=e}return e}function mve(i){const e=i.indexOf("-x-");e!==-1&&(i=i.substring(0,e));const t=i.indexOf("-u-");if(t===-1)return[i];{let r,n;try{r=GF(i).resolvedOptions(),n=i}catch{const d=i.substring(0,t);r=GF(d).resolvedOptions(),n=d}const{numberingSystem:l,calendar:c}=r;return[n,l,c]}}function gve(i,e,t){return(t||e)&&(i.includes("-u-")||(i+="-u"),t&&(i+=`-ca-${t}`),e&&(i+=`-nu-${e}`)),i}function vve(i){const e=[];for(let t=1;t<=12;t++){const r=nr.utc(2009,t,1);e.push(i(r))}return e}function yve(i){const e=[];for(let t=1;t<=7;t++){const r=nr.utc(2016,11,13+t);e.push(i(r))}return e}function d3(i,e,t,r){const n=i.listingMode();return n==="error"?null:n==="en"?t(e):r(e)}function _ve(i){return i.numberingSystem&&i.numberingSystem!=="latn"?!1:i.numberingSystem==="latn"||!i.locale||i.locale.startsWith("en")||new Intl.DateTimeFormat(i.intl).resolvedOptions().numberingSystem==="latn"}class xve{constructor(e,t,r){this.padTo=r.padTo||0,this.floor=r.floor||!1;const{padTo:n,floor:l,...c}=r;if(!t||Object.keys(c).length>0){const h={useGrouping:!1,...r};r.padTo>0&&(h.minimumIntegerDigits=r.padTo),this.inf=hve(e,h)}}format(e){if(this.inf){const t=this.floor?Math.floor(e):e;return this.inf.format(t)}else{const t=this.floor?Math.floor(e):kB(e,3);return Fs(t,this.padTo)}}}class bve{constructor(e,t,r){this.opts=r,this.originalZone=void 0;let n;if(this.opts.timeZone)this.dt=e;else if(e.zone.type==="fixed"){const c=-1*(e.offset/60),h=c>=0?`Etc/GMT+${c}`:`Etc/GMT${c}`;e.offset!==0&&Lp.create(h).valid?(n=h,this.dt=e):(n="UTC",this.dt=e.offset===0?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else e.zone.type==="system"?this.dt=e:e.zone.type==="iana"?(this.dt=e,n=e.zone.name):(n="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);const l={...this.opts};l.timeZone=l.timeZone||n,this.dtf=GF(t,l)}format(){return this.originalZone?this.formatToParts().map(({value:e})=>e).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map(t=>{if(t.type==="timeZoneName"){const r=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...t,value:r}}else return t}):e}resolvedOptions(){return this.dtf.resolvedOptions()}}class wve{constructor(e,t,r){this.opts={style:"long",...r},!t&&pZ()&&(this.rtf=dve(e,r))}format(e,t){return this.rtf?this.rtf.format(e,t):$ve(t,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,t){return this.rtf?this.rtf.formatToParts(e,t):[]}}const Sve={firstDay:1,minimalDays:4,weekend:[6,7]};class bn{static fromOpts(e){return bn.create(e.locale,e.numberingSystem,e.outputCalendar,e.weekSettings,e.defaultToEN)}static create(e,t,r,n,l=!1){const c=e||Es.defaultLocale,h=c||(l?"en-US":fve()),d=t||Es.defaultNumberingSystem,f=r||Es.defaultOutputCalendar,m=ZF(n)||Es.defaultWeekSettings;return new bn(h,d,f,m,c)}static resetCache(){FT=null,jF={},qF={},XF={}}static fromObject({locale:e,numberingSystem:t,outputCalendar:r,weekSettings:n}={}){return bn.create(e,t,r,n)}constructor(e,t,r,n,l){const[c,h,d]=mve(e);this.locale=c,this.numberingSystem=t||h||null,this.outputCalendar=r||d||null,this.weekSettings=n,this.intl=gve(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=l,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=_ve(this)),this.fastNumbersCached}listingMode(){const e=this.isEnglish(),t=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&t?"en":"intl"}clone(e){return!e||Object.getOwnPropertyNames(e).length===0?this:bn.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,ZF(e.weekSettings)||this.weekSettings,e.defaultToEN||!1)}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,t=!1){return d3(this,e,_Z,()=>{const r=t?{month:e,day:"numeric"}:{month:e},n=t?"format":"standalone";return this.monthsCache[n][e]||(this.monthsCache[n][e]=vve(l=>this.extract(l,r,"month"))),this.monthsCache[n][e]})}weekdays(e,t=!1){return d3(this,e,wZ,()=>{const r=t?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},n=t?"format":"standalone";return this.weekdaysCache[n][e]||(this.weekdaysCache[n][e]=yve(l=>this.extract(l,r,"weekday"))),this.weekdaysCache[n][e]})}meridiems(){return d3(this,void 0,()=>SZ,()=>{if(!this.meridiemCache){const e={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[nr.utc(2016,11,13,9),nr.utc(2016,11,13,19)].map(t=>this.extract(t,e,"dayperiod"))}return this.meridiemCache})}eras(e){return d3(this,e,MZ,()=>{const t={era:e};return this.eraCache[e]||(this.eraCache[e]=[nr.utc(-40,1,1),nr.utc(2017,1,1)].map(r=>this.extract(r,t,"era"))),this.eraCache[e]})}extract(e,t,r){const n=this.dtFormatter(e,t),l=n.formatToParts(),c=l.find(h=>h.type.toLowerCase()===r);return c?c.value:null}numberFormatter(e={}){return new xve(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,t={}){return new bve(e,this.intl,t)}relFormatter(e={}){return new wve(this.intl,this.isEnglish(),e)}listFormatter(e={}){return cve(this.intl,e)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:mZ()?pve(this.locale):Sve}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}}let DN=null;class Gl extends LC{static get utcInstance(){return DN===null&&(DN=new Gl(0)),DN}static instance(e){return e===0?Gl.utcInstance:new Gl(e)}static parseSpecifier(e){if(e){const t=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(t)return new Gl(gL(t[1],t[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${tA(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${tA(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,t){return tA(this.fixed,t)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return e.type==="fixed"&&e.fixed===this.fixed}get isValid(){return!0}}class Mve extends LC{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function Am(i,e){if(Zi(i)||i===null)return e;if(i instanceof LC)return i;if(Ave(i)){const t=i.toLowerCase();return t==="default"?e:t==="local"||t==="system"?fL.instance:t==="utc"||t==="gmt"?Gl.utcInstance:Gl.parseSpecifier(t)||Lp.create(i)}else return J1(i)?Gl.instance(i):typeof i=="object"&&"offset"in i&&typeof i.offset=="function"?i:new Mve(i)}let wV=()=>Date.now(),SV="system",MV=null,EV=null,TV=null,AV=60,CV,PV=null;class Es{static get now(){return wV}static set now(e){wV=e}static set defaultZone(e){SV=e}static get defaultZone(){return Am(SV,fL.instance)}static get defaultLocale(){return MV}static set defaultLocale(e){MV=e}static get defaultNumberingSystem(){return EV}static set defaultNumberingSystem(e){EV=e}static get defaultOutputCalendar(){return TV}static set defaultOutputCalendar(e){TV=e}static get defaultWeekSettings(){return PV}static set defaultWeekSettings(e){PV=ZF(e)}static get twoDigitCutoffYear(){return AV}static set twoDigitCutoffYear(e){AV=e%100}static get throwOnInvalid(){return CV}static set throwOnInvalid(e){CV=e}static resetCaches(){bn.resetCache(),Lp.resetCache()}}class Ud{constructor(e,t){this.reason=e,this.explanation=t}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const lZ=[0,31,59,90,120,151,181,212,243,273,304,334],uZ=[0,31,60,91,121,152,182,213,244,274,305,335];function ic(i,e){return new Ud("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${i}, which is invalid`)}function OB(i,e,t){const r=new Date(Date.UTC(i,e-1,t));i<100&&i>=0&&r.setUTCFullYear(r.getUTCFullYear()-1900);const n=r.getUTCDay();return n===0?7:n}function cZ(i,e,t){return t+(OC(i)?uZ:lZ)[e-1]}function hZ(i,e){const t=OC(i)?uZ:lZ,r=t.findIndex(l=>l<e),n=e-t[r];return{month:r+1,day:n}}function NB(i,e){return(i-e+7)%7+1}function iI(i,e=4,t=1){const{year:r,month:n,day:l}=i,c=cZ(r,n,l),h=NB(OB(r,n,l),t);let d=Math.floor((c-h+14-e)/7),f;return d<1?(f=r-1,d=eC(f,e,t)):d>eC(r,e,t)?(f=r+1,d=1):f=r,{weekYear:f,weekNumber:d,weekday:h,...vL(i)}}function RV(i,e=4,t=1){const{weekYear:r,weekNumber:n,weekday:l}=i,c=NB(OB(r,1,e),t),h=yM(r);let d=n*7+l-c-7+e,f;d<1?(f=r-1,d+=yM(f)):d>h?(f=r+1,d-=yM(r)):f=r;const{month:m,day:g}=hZ(f,d);return{year:f,month:m,day:g,...vL(i)}}function kN(i){const{year:e,month:t,day:r}=i,n=cZ(e,t,r);return{year:e,ordinal:n,...vL(i)}}function IV(i){const{year:e,ordinal:t}=i,{month:r,day:n}=hZ(e,t);return{year:e,month:r,day:n,...vL(i)}}function LV(i,e){if(!Zi(i.localWeekday)||!Zi(i.localWeekNumber)||!Zi(i.localWeekYear)){if(!Zi(i.weekday)||!Zi(i.weekNumber)||!Zi(i.weekYear))throw new eM("Cannot mix locale-based week fields with ISO-based week fields");return Zi(i.localWeekday)||(i.weekday=i.localWeekday),Zi(i.localWeekNumber)||(i.weekNumber=i.localWeekNumber),Zi(i.localWeekYear)||(i.weekYear=i.localWeekYear),delete i.localWeekday,delete i.localWeekNumber,delete i.localWeekYear,{minDaysInFirstWeek:e.getMinDaysInFirstWeek(),startOfWeek:e.getStartOfWeek()}}else return{minDaysInFirstWeek:4,startOfWeek:1}}function Eve(i,e=4,t=1){const r=pL(i.weekYear),n=rc(i.weekNumber,1,eC(i.weekYear,e,t)),l=rc(i.weekday,1,7);return r?n?l?!1:ic("weekday",i.weekday):ic("week",i.weekNumber):ic("weekYear",i.weekYear)}function Tve(i){const e=pL(i.year),t=rc(i.ordinal,1,yM(i.year));return e?t?!1:ic("ordinal",i.ordinal):ic("year",i.year)}function dZ(i){const e=pL(i.year),t=rc(i.month,1,12),r=rc(i.day,1,rI(i.year,i.month));return e?t?r?!1:ic("day",i.day):ic("month",i.month):ic("year",i.year)}function fZ(i){const{hour:e,minute:t,second:r,millisecond:n}=i,l=rc(e,0,23)||e===24&&t===0&&r===0&&n===0,c=rc(t,0,59),h=rc(r,0,59),d=rc(n,0,999);return l?c?h?d?!1:ic("millisecond",n):ic("second",r):ic("minute",t):ic("hour",e)}function Zi(i){return typeof i>"u"}function J1(i){return typeof i=="number"}function pL(i){return typeof i=="number"&&i%1===0}function Ave(i){return typeof i=="string"}function Cve(i){return Object.prototype.toString.call(i)==="[object Date]"}function pZ(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function mZ(){try{return typeof Intl<"u"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch{return!1}}function Pve(i){return Array.isArray(i)?i:[i]}function OV(i,e,t){if(i.length!==0)return i.reduce((r,n)=>{const l=[e(n),n];return r&&t(r[0],l[0])===r[0]?r:l},null)[1]}function Rve(i,e){return e.reduce((t,r)=>(t[r]=i[r],t),{})}function ZM(i,e){return Object.prototype.hasOwnProperty.call(i,e)}function ZF(i){if(i==null)return null;if(typeof i!="object")throw new au("Week settings must be an object");if(!rc(i.firstDay,1,7)||!rc(i.minimalDays,1,7)||!Array.isArray(i.weekend)||i.weekend.some(e=>!rc(e,1,7)))throw new au("Invalid week settings");return{firstDay:i.firstDay,minimalDays:i.minimalDays,weekend:Array.from(i.weekend)}}function rc(i,e,t){return pL(i)&&i>=e&&i<=t}function Ive(i,e){return i-e*Math.floor(i/e)}function Fs(i,e=2){const t=i<0;let r;return t?r="-"+(""+-i).padStart(e,"0"):r=(""+i).padStart(e,"0"),r}function xm(i){if(!(Zi(i)||i===null||i===""))return parseInt(i,10)}function u1(i){if(!(Zi(i)||i===null||i===""))return parseFloat(i)}function DB(i){if(!(Zi(i)||i===null||i==="")){const e=parseFloat("0."+i)*1e3;return Math.floor(e)}}function kB(i,e,t=!1){const r=10**e;return(t?Math.trunc:Math.round)(i*r)/r}function OC(i){return i%4===0&&(i%100!==0||i%400===0)}function yM(i){return OC(i)?366:365}function rI(i,e){const t=Ive(e-1,12)+1,r=i+(e-t)/12;return t===2?OC(r)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][t-1]}function mL(i){let e=Date.UTC(i.year,i.month-1,i.day,i.hour,i.minute,i.second,i.millisecond);return i.year<100&&i.year>=0&&(e=new Date(e),e.setUTCFullYear(i.year,i.month-1,i.day)),+e}function NV(i,e,t){return-NB(OB(i,1,e),t)+e-1}function eC(i,e=4,t=1){const r=NV(i,e,t),n=NV(i+1,e,t);return(yM(i)-r+n)/7}function JF(i){return i>99?i:i>Es.twoDigitCutoffYear?1900+i:2e3+i}function gZ(i,e,t,r=null){const n=new Date(i),l={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};r&&(l.timeZone=r);const c={timeZoneName:e,...l},h=new Intl.DateTimeFormat(t,c).formatToParts(n).find(d=>d.type.toLowerCase()==="timezonename");return h?h.value:null}function gL(i,e){let t=parseInt(i,10);Number.isNaN(t)&&(t=0);const r=parseInt(e,10)||0,n=t<0||Object.is(t,-0)?-r:r;return t*60+n}function vZ(i){const e=Number(i);if(typeof i=="boolean"||i===""||Number.isNaN(e))throw new au(`Invalid unit value ${i}`);return e}function nI(i,e){const t={};for(const r in i)if(ZM(i,r)){const n=i[r];if(n==null)continue;t[e(r)]=vZ(n)}return t}function tA(i,e){const t=Math.trunc(Math.abs(i/60)),r=Math.trunc(Math.abs(i%60)),n=i>=0?"+":"-";switch(e){case"short":return`${n}${Fs(t,2)}:${Fs(r,2)}`;case"narrow":return`${n}${t}${r>0?`:${r}`:""}`;case"techie":return`${n}${Fs(t,2)}${Fs(r,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function vL(i){return Rve(i,["hour","minute","second","millisecond"])}const Lve=["January","February","March","April","May","June","July","August","September","October","November","December"],yZ=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Ove=["J","F","M","A","M","J","J","A","S","O","N","D"];function _Z(i){switch(i){case"narrow":return[...Ove];case"short":return[...yZ];case"long":return[...Lve];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const xZ=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],bZ=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],Nve=["M","T","W","T","F","S","S"];function wZ(i){switch(i){case"narrow":return[...Nve];case"short":return[...bZ];case"long":return[...xZ];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const SZ=["AM","PM"],Dve=["Before Christ","Anno Domini"],kve=["BC","AD"],Fve=["B","A"];function MZ(i){switch(i){case"narrow":return[...Fve];case"short":return[...kve];case"long":return[...Dve];default:return null}}function zve(i){return SZ[i.hour<12?0:1]}function Bve(i,e){return wZ(e)[i.weekday-1]}function Uve(i,e){return _Z(e)[i.month-1]}function Hve(i,e){return MZ(e)[i.year<0?0:1]}function $ve(i,e,t="always",r=!1){const n={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},l=["hours","minutes","seconds"].indexOf(i)===-1;if(t==="auto"&&l){const g=i==="days";switch(e){case 1:return g?"tomorrow":`next ${n[i][0]}`;case-1:return g?"yesterday":`last ${n[i][0]}`;case 0:return g?"today":`this ${n[i][0]}`}}const c=Object.is(e,-0)||e<0,h=Math.abs(e),d=h===1,f=n[i],m=r?d?f[1]:f[2]||f[1]:d?n[i][0]:i;return c?`${h} ${m} ago`:`in ${h} ${m}`}function DV(i,e){let t="";for(const r of i)r.literal?t+=r.val:t+=e(r.val);return t}const Vve={D:tI,DD:VX,DDD:WX,DDDD:jX,t:GX,tt:qX,ttt:XX,tttt:ZX,T:JX,TT:YX,TTT:KX,TTTT:QX,f:eZ,ff:iZ,fff:nZ,ffff:aZ,F:tZ,FF:rZ,FFF:sZ,FFFF:oZ};class Mo{static create(e,t={}){return new Mo(e,t)}static parseFormat(e){let t=null,r="",n=!1;const l=[];for(let c=0;c<e.length;c++){const h=e.charAt(c);h==="'"?(r.length>0&&l.push({literal:n||/^\s+$/.test(r),val:r}),t=null,r="",n=!n):n||h===t?r+=h:(r.length>0&&l.push({literal:/^\s+$/.test(r),val:r}),r=h,t=h)}return r.length>0&&l.push({literal:n||/^\s+$/.test(r),val:r}),l}static macroTokenToFormatOpts(e){return Vve[e]}constructor(e,t){this.opts=t,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,t){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,{...this.opts,...t}).format()}dtFormatter(e,t={}){return this.loc.dtFormatter(e,{...this.opts,...t})}formatDateTime(e,t){return this.dtFormatter(e,t).format()}formatDateTimeParts(e,t){return this.dtFormatter(e,t).formatToParts()}formatInterval(e,t){return this.dtFormatter(e.start,t).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,t){return this.dtFormatter(e,t).resolvedOptions()}num(e,t=0){if(this.opts.forceSimple)return Fs(e,t);const r={...this.opts};return t>0&&(r.padTo=t),this.loc.numberFormatter(r).format(e)}formatDateTimeFromString(e,t){const r=this.loc.listingMode()==="en",n=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",l=(_,b)=>this.loc.extract(e,_,b),c=_=>e.isOffsetFixed&&e.offset===0&&_.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,_.format):"",h=()=>r?zve(e):l({hour:"numeric",hourCycle:"h12"},"dayperiod"),d=(_,b)=>r?Uve(e,_):l(b?{month:_}:{month:_,day:"numeric"},"month"),f=(_,b)=>r?Bve(e,_):l(b?{weekday:_}:{weekday:_,month:"long",day:"numeric"},"weekday"),m=_=>{const b=Mo.macroTokenToFormatOpts(_);return b?this.formatWithSystemDefault(e,b):_},g=_=>r?Hve(e,_):l({era:_},"era"),y=_=>{switch(_){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12===0?12:e.hour%12);case"hh":return this.num(e.hour%12===0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return c({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return c({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return c({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return h();case"d":return n?l({day:"numeric"},"day"):this.num(e.day);case"dd":return n?l({day:"2-digit"},"day"):this.num(e.day,2);case"c":return this.num(e.weekday);case"ccc":return f("short",!0);case"cccc":return f("long",!0);case"ccccc":return f("narrow",!0);case"E":return this.num(e.weekday);case"EEE":return f("short",!1);case"EEEE":return f("long",!1);case"EEEEE":return f("narrow",!1);case"L":return n?l({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return n?l({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return d("short",!0);case"LLLL":return d("long",!0);case"LLLLL":return d("narrow",!0);case"M":return n?l({month:"numeric"},"month"):this.num(e.month);case"MM":return n?l({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return d("short",!1);case"MMMM":return d("long",!1);case"MMMMM":return d("narrow",!1);case"y":return n?l({year:"numeric"},"year"):this.num(e.year);case"yy":return n?l({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return n?l({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return n?l({year:"numeric"},"year"):this.num(e.year,6);case"G":return g("short");case"GG":return g("long");case"GGGGG":return g("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"n":return this.num(e.localWeekNumber);case"nn":return this.num(e.localWeekNumber,2);case"ii":return this.num(e.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(e.localWeekYear,4);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return m(_)}};return DV(Mo.parseFormat(t),y)}formatDurationFromString(e,t){const r=d=>{switch(d[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},n=d=>f=>{const m=r(f);return m?this.num(d.get(m),f.length):f},l=Mo.parseFormat(t),c=l.reduce((d,{literal:f,val:m})=>f?d:d.concat(m),[]),h=e.shiftTo(...c.map(r).filter(d=>d));return DV(l,n(h))}}const EZ=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function wE(...i){const e=i.reduce((t,r)=>t+r.source,"");return RegExp(`^${e}$`)}function SE(...i){return e=>i.reduce(([t,r,n],l)=>{const[c,h,d]=l(e,n);return[{...t,...c},h||r,d]},[{},null,1]).slice(0,2)}function ME(i,...e){if(i==null)return[null,null];for(const[t,r]of e){const n=t.exec(i);if(n)return r(n)}return[null,null]}function TZ(...i){return(e,t)=>{const r={};let n;for(n=0;n<i.length;n++)r[i[n]]=xm(e[t+n]);return[r,null,t+n]}}const AZ=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,Wve=`(?:${AZ.source}?(?:\\[(${EZ.source})\\])?)?`,FB=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,CZ=RegExp(`${FB.source}${Wve}`),zB=RegExp(`(?:T${CZ.source})?`),jve=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,Gve=/(\d{4})-?W(\d\d)(?:-?(\d))?/,qve=/(\d{4})-?(\d{3})/,Xve=TZ("weekYear","weekNumber","weekDay"),Zve=TZ("year","ordinal"),Jve=/(\d{4})-(\d\d)-(\d\d)/,PZ=RegExp(`${FB.source} ?(?:${AZ.source}|(${EZ.source}))?`),Yve=RegExp(`(?: ${PZ.source})?`);function _M(i,e,t){const r=i[e];return Zi(r)?t:xm(r)}function Kve(i,e){return[{year:_M(i,e),month:_M(i,e+1,1),day:_M(i,e+2,1)},null,e+3]}function EE(i,e){return[{hours:_M(i,e,0),minutes:_M(i,e+1,0),seconds:_M(i,e+2,0),milliseconds:DB(i[e+3])},null,e+4]}function NC(i,e){const t=!i[e]&&!i[e+1],r=gL(i[e+1],i[e+2]),n=t?null:Gl.instance(r);return[{},n,e+3]}function DC(i,e){const t=i[e]?Lp.create(i[e]):null;return[{},t,e+1]}const Qve=RegExp(`^T?${FB.source}$`),eye=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function tye(i){const[e,t,r,n,l,c,h,d,f]=i,m=e[0]==="-",g=d&&d[0]==="-",y=(_,b=!1)=>_!==void 0&&(b||_&&m)?-_:_;return[{years:y(u1(t)),months:y(u1(r)),weeks:y(u1(n)),days:y(u1(l)),hours:y(u1(c)),minutes:y(u1(h)),seconds:y(u1(d),d==="-0"),milliseconds:y(DB(f),g)}]}const iye={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function BB(i,e,t,r,n,l,c){const h={year:e.length===2?JF(xm(e)):xm(e),month:yZ.indexOf(t)+1,day:xm(r),hour:xm(n),minute:xm(l)};return c&&(h.second=xm(c)),i&&(h.weekday=i.length>3?xZ.indexOf(i)+1:bZ.indexOf(i)+1),h}const rye=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function nye(i){const[,e,t,r,n,l,c,h,d,f,m,g]=i,y=BB(e,n,r,t,l,c,h);let _;return d?_=iye[d]:f?_=0:_=gL(m,g),[y,new Gl(_)]}function sye(i){return i.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const aye=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,oye=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,lye=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function kV(i){const[,e,t,r,n,l,c,h]=i;return[BB(e,n,r,t,l,c,h),Gl.utcInstance]}function uye(i){const[,e,t,r,n,l,c,h]=i;return[BB(e,h,t,r,n,l,c),Gl.utcInstance]}const cye=wE(jve,zB),hye=wE(Gve,zB),dye=wE(qve,zB),fye=wE(CZ),RZ=SE(Kve,EE,NC,DC),pye=SE(Xve,EE,NC,DC),mye=SE(Zve,EE,NC,DC),gye=SE(EE,NC,DC);function vye(i){return ME(i,[cye,RZ],[hye,pye],[dye,mye],[fye,gye])}function yye(i){return ME(sye(i),[rye,nye])}function _ye(i){return ME(i,[aye,kV],[oye,kV],[lye,uye])}function xye(i){return ME(i,[eye,tye])}const bye=SE(EE);function wye(i){return ME(i,[Qve,bye])}const Sye=wE(Jve,Yve),Mye=wE(PZ),Eye=SE(EE,NC,DC);function Tye(i){return ME(i,[Sye,RZ],[Mye,Eye])}const FV="Invalid Duration",IZ={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1e3},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1e3},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},Aye={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1e3},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1e3},...IZ},ju=146097/400,tS=146097/4800,Cye={years:{quarters:4,months:12,weeks:ju/7,days:ju,hours:ju*24,minutes:ju*24*60,seconds:ju*24*60*60,milliseconds:ju*24*60*60*1e3},quarters:{months:3,weeks:ju/28,days:ju/4,hours:ju*24/4,minutes:ju*24*60/4,seconds:ju*24*60*60/4,milliseconds:ju*24*60*60*1e3/4},months:{weeks:tS/7,days:tS,hours:tS*24,minutes:tS*24*60,seconds:tS*24*60*60,milliseconds:tS*24*60*60*1e3},...IZ},k1=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],Pye=k1.slice(0).reverse();function nm(i,e,t=!1){const r={values:t?e.values:{...i.values,...e.values||{}},loc:i.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||i.conversionAccuracy,matrix:e.matrix||i.matrix};return new Xr(r)}function LZ(i,e){let t=e.milliseconds??0;for(const r of Pye.slice(1))e[r]&&(t+=e[r]*i[r].milliseconds);return t}function zV(i,e){const t=LZ(i,e)<0?-1:1;k1.reduceRight((r,n)=>{if(Zi(e[n]))return r;if(r){const l=e[r]*t,c=i[n][r],h=Math.floor(l/c);e[n]+=h*t,e[r]-=h*c*t}return n},null),k1.reduce((r,n)=>{if(Zi(e[n]))return r;if(r){const l=e[r]%1;e[r]-=l,e[n]+=l*i[r][n]}return n},null)}function Rye(i){const e={};for(const[t,r]of Object.entries(i))r!==0&&(e[t]=r);return e}class Xr{constructor(e){const t=e.conversionAccuracy==="longterm"||!1;let r=t?Cye:Aye;e.matrix&&(r=e.matrix),this.values=e.values,this.loc=e.loc||bn.create(),this.conversionAccuracy=t?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=r,this.isLuxonDuration=!0}static fromMillis(e,t){return Xr.fromObject({milliseconds:e},t)}static fromObject(e,t={}){if(e==null||typeof e!="object")throw new au(`Duration.fromObject: argument expected to be an object, got ${e===null?"null":typeof e}`);return new Xr({values:nI(e,Xr.normalizeUnit),loc:bn.fromObject(t),conversionAccuracy:t.conversionAccuracy,matrix:t.matrix})}static fromDurationLike(e){if(J1(e))return Xr.fromMillis(e);if(Xr.isDuration(e))return e;if(typeof e=="object")return Xr.fromObject(e);throw new au(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,t){const[r]=xye(e);return r?Xr.fromObject(r,t):Xr.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,t){const[r]=wye(e);return r?Xr.fromObject(r,t):Xr.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,t=null){if(!e)throw new au("need to specify a reason the Duration is invalid");const r=e instanceof Ud?e:new Ud(e,t);if(Es.throwOnInvalid)throw new rve(r);return new Xr({invalid:r})}static normalizeUnit(e){const t={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e&&e.toLowerCase()];if(!t)throw new $X(e);return t}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,t={}){const r={...t,floor:t.round!==!1&&t.floor!==!1};return this.isValid?Mo.create(this.loc,r).formatDurationFromString(this,e):FV}toHuman(e={}){if(!this.isValid)return FV;const t=k1.map(r=>{const n=this.values[r];return Zi(n)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:r.slice(0,-1)}).format(n)}).filter(r=>r);return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(t)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return this.years!==0&&(e+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(e+=this.months+this.quarters*3+"M"),this.weeks!==0&&(e+=this.weeks+"W"),this.days!==0&&(e+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(e+="T"),this.hours!==0&&(e+=this.hours+"H"),this.minutes!==0&&(e+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(e+=kB(this.seconds+this.milliseconds/1e3,3)+"S"),e==="P"&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;const t=this.toMillis();return t<0||t>=864e5?null:(e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e,includeOffset:!1},nr.fromMillis(t,{zone:"UTC"}).toISOTime(e))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?LZ(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;const t=Xr.fromDurationLike(e),r={};for(const n of k1)(ZM(t.values,n)||ZM(this.values,n))&&(r[n]=t.get(n)+this.get(n));return nm(this,{values:r},!0)}minus(e){if(!this.isValid)return this;const t=Xr.fromDurationLike(e);return this.plus(t.negate())}mapUnits(e){if(!this.isValid)return this;const t={};for(const r of Object.keys(this.values))t[r]=vZ(e(this.values[r],r));return nm(this,{values:t},!0)}get(e){return this[Xr.normalizeUnit(e)]}set(e){if(!this.isValid)return this;const t={...this.values,...nI(e,Xr.normalizeUnit)};return nm(this,{values:t})}reconfigure({locale:e,numberingSystem:t,conversionAccuracy:r,matrix:n}={}){const c={loc:this.loc.clone({locale:e,numberingSystem:t}),matrix:n,conversionAccuracy:r};return nm(this,c)}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;const e=this.toObject();return zV(this.matrix,e),nm(this,{values:e},!0)}rescale(){if(!this.isValid)return this;const e=Rye(this.normalize().shiftToAll().toObject());return nm(this,{values:e},!0)}shiftTo(...e){if(!this.isValid)return this;if(e.length===0)return this;e=e.map(c=>Xr.normalizeUnit(c));const t={},r={},n=this.toObject();let l;for(const c of k1)if(e.indexOf(c)>=0){l=c;let h=0;for(const f in r)h+=this.matrix[f][c]*r[f],r[f]=0;J1(n[c])&&(h+=n[c]);const d=Math.trunc(h);t[c]=d,r[c]=(h*1e3-d*1e3)/1e3}else J1(n[c])&&(r[c]=n[c]);for(const c in r)r[c]!==0&&(t[l]+=c===l?r[c]:r[c]/this.matrix[l][c]);return zV(this.matrix,t),nm(this,{values:t},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const e={};for(const t of Object.keys(this.values))e[t]=this.values[t]===0?0:-this.values[t];return nm(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid||!this.loc.equals(e.loc))return!1;function t(r,n){return r===void 0||r===0?n===void 0||n===0:r===n}for(const r of k1)if(!t(this.values[r],e.values[r]))return!1;return!0}}const iS="Invalid Interval";function Iye(i,e){return!i||!i.isValid?ys.invalid("missing or invalid start"):!e||!e.isValid?ys.invalid("missing or invalid end"):e<i?ys.invalid("end before start",`The end of an interval must be after its start, but you had start=${i.toISO()} and end=${e.toISO()}`):null}class ys{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,t=null){if(!e)throw new au("need to specify a reason the Interval is invalid");const r=e instanceof Ud?e:new Ud(e,t);if(Es.throwOnInvalid)throw new ive(r);return new ys({invalid:r})}static fromDateTimes(e,t){const r=aT(e),n=aT(t),l=Iye(r,n);return l??new ys({start:r,end:n})}static after(e,t){const r=Xr.fromDurationLike(t),n=aT(e);return ys.fromDateTimes(n,n.plus(r))}static before(e,t){const r=Xr.fromDurationLike(t),n=aT(e);return ys.fromDateTimes(n.minus(r),n)}static fromISO(e,t){const[r,n]=(e||"").split("/",2);if(r&&n){let l,c;try{l=nr.fromISO(r,t),c=l.isValid}catch{c=!1}let h,d;try{h=nr.fromISO(n,t),d=h.isValid}catch{d=!1}if(c&&d)return ys.fromDateTimes(l,h);if(c){const f=Xr.fromISO(n,t);if(f.isValid)return ys.after(l,f)}else if(d){const f=Xr.fromISO(r,t);if(f.isValid)return ys.before(h,f)}}return ys.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds",t){if(!this.isValid)return NaN;const r=this.start.startOf(e,t);let n;return t!=null&&t.useLocaleWeeks?n=this.end.reconfigure({locale:r.locale}):n=this.end,n=n.startOf(e,t),Math.floor(n.diff(r,e).get(e))+(n.valueOf()!==this.end.valueOf())}hasSame(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return this.isValid?this.s>e:!1}isBefore(e){return this.isValid?this.e<=e:!1}contains(e){return this.isValid?this.s<=e&&this.e>e:!1}set({start:e,end:t}={}){return this.isValid?ys.fromDateTimes(e||this.s,t||this.e):this}splitAt(...e){if(!this.isValid)return[];const t=e.map(aT).filter(c=>this.contains(c)).sort((c,h)=>c.toMillis()-h.toMillis()),r=[];let{s:n}=this,l=0;for(;n<this.e;){const c=t[l]||this.e,h=+c>+this.e?this.e:c;r.push(ys.fromDateTimes(n,h)),n=h,l+=1}return r}splitBy(e){const t=Xr.fromDurationLike(e);if(!this.isValid||!t.isValid||t.as("milliseconds")===0)return[];let{s:r}=this,n=1,l;const c=[];for(;r<this.e;){const h=this.start.plus(t.mapUnits(d=>d*n));l=+h>+this.e?this.e:h,c.push(ys.fromDateTimes(r,l)),r=l,n+=1}return c}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return this.isValid?+this.e==+e.s:!1}abutsEnd(e){return this.isValid?+e.e==+this.s:!1}engulfs(e){return this.isValid?this.s<=e.s&&this.e>=e.e:!1}equals(e){return!this.isValid||!e.isValid?!1:this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){if(!this.isValid)return this;const t=this.s>e.s?this.s:e.s,r=this.e<e.e?this.e:e.e;return t>=r?null:ys.fromDateTimes(t,r)}union(e){if(!this.isValid)return this;const t=this.s<e.s?this.s:e.s,r=this.e>e.e?this.e:e.e;return ys.fromDateTimes(t,r)}static merge(e){const[t,r]=e.sort((n,l)=>n.s-l.s).reduce(([n,l],c)=>l?l.overlaps(c)||l.abutsStart(c)?[n,l.union(c)]:[n.concat([l]),c]:[n,c],[[],null]);return r&&t.push(r),t}static xor(e){let t=null,r=0;const n=[],l=e.map(d=>[{time:d.s,type:"s"},{time:d.e,type:"e"}]),c=Array.prototype.concat(...l),h=c.sort((d,f)=>d.time-f.time);for(const d of h)r+=d.type==="s"?1:-1,r===1?t=d.time:(t&&+t!=+d.time&&n.push(ys.fromDateTimes(t,d.time)),t=null);return ys.merge(n)}difference(...e){return ys.xor([this].concat(e)).map(t=>this.intersection(t)).filter(t=>t&&!t.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} – ${this.e.toISO()})`:iS}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(e=tI,t={}){return this.isValid?Mo.create(this.s.loc.clone(t),e).formatInterval(this):iS}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:iS}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:iS}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:iS}toFormat(e,{separator:t=" – "}={}){return this.isValid?`${this.s.toFormat(e)}${t}${this.e.toFormat(e)}`:iS}toDuration(e,t){return this.isValid?this.e.diff(this.s,e,t):Xr.invalid(this.invalidReason)}mapEndpoints(e){return ys.fromDateTimes(e(this.s),e(this.e))}}class f3{static hasDST(e=Es.defaultZone){const t=nr.now().setZone(e).set({month:12});return!e.isUniversal&&t.offset!==t.set({month:6}).offset}static isValidIANAZone(e){return Lp.isValidZone(e)}static normalizeZone(e){return Am(e,Es.defaultZone)}static getStartOfWeek({locale:e=null,locObj:t=null}={}){return(t||bn.create(e)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:e=null,locObj:t=null}={}){return(t||bn.create(e)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:e=null,locObj:t=null}={}){return(t||bn.create(e)).getWeekendDays().slice()}static months(e="long",{locale:t=null,numberingSystem:r=null,locObj:n=null,outputCalendar:l="gregory"}={}){return(n||bn.create(t,r,l)).months(e)}static monthsFormat(e="long",{locale:t=null,numberingSystem:r=null,locObj:n=null,outputCalendar:l="gregory"}={}){return(n||bn.create(t,r,l)).months(e,!0)}static weekdays(e="long",{locale:t=null,numberingSystem:r=null,locObj:n=null}={}){return(n||bn.create(t,r,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:t=null,numberingSystem:r=null,locObj:n=null}={}){return(n||bn.create(t,r,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return bn.create(e).meridiems()}static eras(e="short",{locale:t=null}={}){return bn.create(t,null,"gregory").eras(e)}static features(){return{relative:pZ(),localeWeek:mZ()}}}function BV(i,e){const t=n=>n.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),r=t(e)-t(i);return Math.floor(Xr.fromMillis(r).as("days"))}function Lye(i,e,t){const r=[["years",(d,f)=>f.year-d.year],["quarters",(d,f)=>f.quarter-d.quarter+(f.year-d.year)*4],["months",(d,f)=>f.month-d.month+(f.year-d.year)*12],["weeks",(d,f)=>{const m=BV(d,f);return(m-m%7)/7}],["days",BV]],n={},l=i;let c,h;for(const[d,f]of r)t.indexOf(d)>=0&&(c=d,n[d]=f(i,e),h=l.plus(n),h>e?(n[d]--,i=l.plus(n),i>e&&(h=i,n[d]--,i=l.plus(n))):i=h);return[i,n,h,c]}function Oye(i,e,t,r){let[n,l,c,h]=Lye(i,e,t);const d=e-n,f=t.filter(g=>["hours","minutes","seconds","milliseconds"].indexOf(g)>=0);f.length===0&&(c<e&&(c=n.plus({[h]:1})),c!==n&&(l[h]=(l[h]||0)+d/(c-n)));const m=Xr.fromObject(l,r);return f.length>0?Xr.fromMillis(d,r).shiftTo(...f).plus(m):m}const UB={arab:"[٠-٩]",arabext:"[۰-۹]",bali:"[᭐-᭙]",beng:"[০-৯]",deva:"[०-९]",fullwide:"[０-９]",gujr:"[૦-૯]",hanidec:"[〇|一|二|三|四|五|六|七|八|九]",khmr:"[០-៩]",knda:"[೦-೯]",laoo:"[໐-໙]",limb:"[᥆-᥏]",mlym:"[൦-൯]",mong:"[᠐-᠙]",mymr:"[၀-၉]",orya:"[୦-୯]",tamldec:"[௦-௯]",telu:"[౦-౯]",thai:"[๐-๙]",tibt:"[༠-༩]",latn:"\\d"},UV={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},Nye=UB.hanidec.replace(/[\[|\]]/g,"").split("");function Dye(i){let e=parseInt(i,10);if(isNaN(e)){e="";for(let t=0;t<i.length;t++){const r=i.charCodeAt(t);if(i[t].search(UB.hanidec)!==-1)e+=Nye.indexOf(i[t]);else for(const n in UV){const[l,c]=UV[n];r>=l&&r<=c&&(e+=r-l)}}return parseInt(e,10)}else return e}function Td({numberingSystem:i},e=""){return new RegExp(`${UB[i||"latn"]}${e}`)}const kye="missing Intl.DateTimeFormat.formatToParts support";function dn(i,e=t=>t){return{regex:i,deser:([t])=>e(Dye(t))}}const Fye=" ",OZ=`[ ${Fye}]`,NZ=new RegExp(OZ,"g");function zye(i){return i.replace(/\./g,"\\.?").replace(NZ,OZ)}function HV(i){return i.replace(/\./g,"").replace(NZ," ").toLowerCase()}function Ad(i,e){return i===null?null:{regex:RegExp(i.map(zye).join("|")),deser:([t])=>i.findIndex(r=>HV(t)===HV(r))+e}}function $V(i,e){return{regex:i,deser:([,t,r])=>gL(t,r),groups:e}}function p3(i){return{regex:i,deser:([e])=>e}}function Bye(i){return i.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function Uye(i,e){const t=Td(e),r=Td(e,"{2}"),n=Td(e,"{3}"),l=Td(e,"{4}"),c=Td(e,"{6}"),h=Td(e,"{1,2}"),d=Td(e,"{1,3}"),f=Td(e,"{1,6}"),m=Td(e,"{1,9}"),g=Td(e,"{2,4}"),y=Td(e,"{4,6}"),_=E=>({regex:RegExp(Bye(E.val)),deser:([T])=>T,literal:!0}),S=(E=>{if(i.literal)return _(E);switch(E.val){case"G":return Ad(e.eras("short"),0);case"GG":return Ad(e.eras("long"),0);case"y":return dn(f);case"yy":return dn(g,JF);case"yyyy":return dn(l);case"yyyyy":return dn(y);case"yyyyyy":return dn(c);case"M":return dn(h);case"MM":return dn(r);case"MMM":return Ad(e.months("short",!0),1);case"MMMM":return Ad(e.months("long",!0),1);case"L":return dn(h);case"LL":return dn(r);case"LLL":return Ad(e.months("short",!1),1);case"LLLL":return Ad(e.months("long",!1),1);case"d":return dn(h);case"dd":return dn(r);case"o":return dn(d);case"ooo":return dn(n);case"HH":return dn(r);case"H":return dn(h);case"hh":return dn(r);case"h":return dn(h);case"mm":return dn(r);case"m":return dn(h);case"q":return dn(h);case"qq":return dn(r);case"s":return dn(h);case"ss":return dn(r);case"S":return dn(d);case"SSS":return dn(n);case"u":return p3(m);case"uu":return p3(h);case"uuu":return dn(t);case"a":return Ad(e.meridiems(),0);case"kkkk":return dn(l);case"kk":return dn(g,JF);case"W":return dn(h);case"WW":return dn(r);case"E":case"c":return dn(t);case"EEE":return Ad(e.weekdays("short",!1),1);case"EEEE":return Ad(e.weekdays("long",!1),1);case"ccc":return Ad(e.weekdays("short",!0),1);case"cccc":return Ad(e.weekdays("long",!0),1);case"Z":case"ZZ":return $V(new RegExp(`([+-]${h.source})(?::(${r.source}))?`),2);case"ZZZ":return $V(new RegExp(`([+-]${h.source})(${r.source})?`),2);case"z":return p3(/[a-z_+-/]{1,256}?/i);case" ":return p3(/[^\S\n\r]/);default:return _(E)}})(i)||{invalidReason:kye};return S.token=i,S}const Hye={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function $ye(i,e,t){const{type:r,value:n}=i;if(r==="literal"){const d=/^\s+$/.test(n);return{literal:!d,val:d?" ":n}}const l=e[r];let c=r;r==="hour"&&(e.hour12!=null?c=e.hour12?"hour12":"hour24":e.hourCycle!=null?e.hourCycle==="h11"||e.hourCycle==="h12"?c="hour12":c="hour24":c=t.hour12?"hour12":"hour24");let h=Hye[c];if(typeof h=="object"&&(h=h[l]),h)return{literal:!1,val:h}}function Vye(i){return[`^${i.map(t=>t.regex).reduce((t,r)=>`${t}(${r.source})`,"")}$`,i]}function Wye(i,e,t){const r=i.match(e);if(r){const n={};let l=1;for(const c in t)if(ZM(t,c)){const h=t[c],d=h.groups?h.groups+1:1;!h.literal&&h.token&&(n[h.token.val[0]]=h.deser(r.slice(l,l+d))),l+=d}return[r,n]}else return[r,{}]}function jye(i){const e=l=>{switch(l){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let t=null,r;return Zi(i.z)||(t=Lp.create(i.z)),Zi(i.Z)||(t||(t=new Gl(i.Z)),r=i.Z),Zi(i.q)||(i.M=(i.q-1)*3+1),Zi(i.h)||(i.h<12&&i.a===1?i.h+=12:i.h===12&&i.a===0&&(i.h=0)),i.G===0&&i.y&&(i.y=-i.y),Zi(i.u)||(i.S=DB(i.u)),[Object.keys(i).reduce((l,c)=>{const h=e(c);return h&&(l[h]=i[c]),l},{}),t,r]}let FN=null;function Gye(){return FN||(FN=nr.fromMillis(1555555555555)),FN}function qye(i,e){if(i.literal)return i;const t=Mo.macroTokenToFormatOpts(i.val),r=FZ(t,e);return r==null||r.includes(void 0)?i:r}function DZ(i,e){return Array.prototype.concat(...i.map(t=>qye(t,e)))}function kZ(i,e,t){const r=DZ(Mo.parseFormat(t),i),n=r.map(c=>Uye(c,i)),l=n.find(c=>c.invalidReason);if(l)return{input:e,tokens:r,invalidReason:l.invalidReason};{const[c,h]=Vye(n),d=RegExp(c,"i"),[f,m]=Wye(e,d,h),[g,y,_]=m?jye(m):[null,null,void 0];if(ZM(m,"a")&&ZM(m,"H"))throw new eM("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:r,regex:d,rawMatches:f,matches:m,result:g,zone:y,specificOffset:_}}}function Xye(i,e,t){const{result:r,zone:n,specificOffset:l,invalidReason:c}=kZ(i,e,t);return[r,n,l,c]}function FZ(i,e){if(!i)return null;const r=Mo.create(e,i).dtFormatter(Gye()),n=r.formatToParts(),l=r.resolvedOptions();return n.map(c=>$ye(c,i,l))}const zN="Invalid DateTime",VV=864e13;function m3(i){return new Ud("unsupported zone",`the zone "${i.name}" is not supported`)}function BN(i){return i.weekData===null&&(i.weekData=iI(i.c)),i.weekData}function UN(i){return i.localWeekData===null&&(i.localWeekData=iI(i.c,i.loc.getMinDaysInFirstWeek(),i.loc.getStartOfWeek())),i.localWeekData}function c1(i,e){const t={ts:i.ts,zone:i.zone,c:i.c,o:i.o,loc:i.loc,invalid:i.invalid};return new nr({...t,...e,old:t})}function zZ(i,e,t){let r=i-e*60*1e3;const n=t.offset(r);if(e===n)return[r,e];r-=(n-e)*60*1e3;const l=t.offset(r);return n===l?[r,n]:[i-Math.min(n,l)*60*1e3,Math.max(n,l)]}function g3(i,e){i+=e*60*1e3;const t=new Date(i);return{year:t.getUTCFullYear(),month:t.getUTCMonth()+1,day:t.getUTCDate(),hour:t.getUTCHours(),minute:t.getUTCMinutes(),second:t.getUTCSeconds(),millisecond:t.getUTCMilliseconds()}}function eR(i,e,t){return zZ(mL(i),e,t)}function WV(i,e){const t=i.o,r=i.c.year+Math.trunc(e.years),n=i.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,l={...i.c,year:r,month:n,day:Math.min(i.c.day,rI(r,n))+Math.trunc(e.days)+Math.trunc(e.weeks)*7},c=Xr.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),h=mL(l);let[d,f]=zZ(h,t,i.zone);return c!==0&&(d+=c,f=i.zone.offset(d)),{ts:d,o:f}}function sT(i,e,t,r,n,l){const{setZone:c,zone:h}=t;if(i&&Object.keys(i).length!==0||e){const d=e||h,f=nr.fromObject(i,{...t,zone:d,specificOffset:l});return c?f:f.setZone(h)}else return nr.invalid(new Ud("unparsable",`the input "${n}" can't be parsed as ${r}`))}function v3(i,e,t=!0){return i.isValid?Mo.create(bn.create("en-US"),{allowZ:t,forceSimple:!0}).formatDateTimeFromString(i,e):null}function HN(i,e){const t=i.c.year>9999||i.c.year<0;let r="";return t&&i.c.year>=0&&(r+="+"),r+=Fs(i.c.year,t?6:4),e?(r+="-",r+=Fs(i.c.month),r+="-",r+=Fs(i.c.day)):(r+=Fs(i.c.month),r+=Fs(i.c.day)),r}function jV(i,e,t,r,n,l){let c=Fs(i.c.hour);return e?(c+=":",c+=Fs(i.c.minute),(i.c.millisecond!==0||i.c.second!==0||!t)&&(c+=":")):c+=Fs(i.c.minute),(i.c.millisecond!==0||i.c.second!==0||!t)&&(c+=Fs(i.c.second),(i.c.millisecond!==0||!r)&&(c+=".",c+=Fs(i.c.millisecond,3))),n&&(i.isOffsetFixed&&i.offset===0&&!l?c+="Z":i.o<0?(c+="-",c+=Fs(Math.trunc(-i.o/60)),c+=":",c+=Fs(Math.trunc(-i.o%60))):(c+="+",c+=Fs(Math.trunc(i.o/60)),c+=":",c+=Fs(Math.trunc(i.o%60)))),l&&(c+="["+i.zone.ianaName+"]"),c}const BZ={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},Zye={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},Jye={ordinal:1,hour:0,minute:0,second:0,millisecond:0},UZ=["year","month","day","hour","minute","second","millisecond"],Yye=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],Kye=["year","ordinal","hour","minute","second","millisecond"];function Qye(i){const e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[i.toLowerCase()];if(!e)throw new $X(i);return e}function GV(i){switch(i.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return Qye(i)}}function qV(i,e){const t=Am(e.zone,Es.defaultZone),r=bn.fromObject(e),n=Es.now();let l,c;if(Zi(i.year))l=n;else{for(const f of UZ)Zi(i[f])&&(i[f]=BZ[f]);const h=dZ(i)||fZ(i);if(h)return nr.invalid(h);const d=t.offset(n);[l,c]=eR(i,d,t)}return new nr({ts:l,zone:t,loc:r,o:c})}function XV(i,e,t){const r=Zi(t.round)?!0:t.round,n=(c,h)=>(c=kB(c,r||t.calendary?0:2,!0),e.loc.clone(t).relFormatter(t).format(c,h)),l=c=>t.calendary?e.hasSame(i,c)?0:e.startOf(c).diff(i.startOf(c),c).get(c):e.diff(i,c).get(c);if(t.unit)return n(l(t.unit),t.unit);for(const c of t.units){const h=l(c);if(Math.abs(h)>=1)return n(h,c)}return n(i>e?-0:0,t.units[t.units.length-1])}function ZV(i){let e={},t;return i.length>0&&typeof i[i.length-1]=="object"?(e=i[i.length-1],t=Array.from(i).slice(0,i.length-1)):t=Array.from(i),[e,t]}class nr{constructor(e){const t=e.zone||Es.defaultZone;let r=e.invalid||(Number.isNaN(e.ts)?new Ud("invalid input"):null)||(t.isValid?null:m3(t));this.ts=Zi(e.ts)?Es.now():e.ts;let n=null,l=null;if(!r)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(t))[n,l]=[e.old.c,e.old.o];else{const h=t.offset(this.ts);n=g3(this.ts,h),r=Number.isNaN(n.year)?new Ud("invalid input"):null,n=r?null:n,l=r?null:h}this._zone=t,this.loc=e.loc||bn.create(),this.invalid=r,this.weekData=null,this.localWeekData=null,this.c=n,this.o=l,this.isLuxonDateTime=!0}static now(){return new nr({})}static local(){const[e,t]=ZV(arguments),[r,n,l,c,h,d,f]=t;return qV({year:r,month:n,day:l,hour:c,minute:h,second:d,millisecond:f},e)}static utc(){const[e,t]=ZV(arguments),[r,n,l,c,h,d,f]=t;return e.zone=Gl.utcInstance,qV({year:r,month:n,day:l,hour:c,minute:h,second:d,millisecond:f},e)}static fromJSDate(e,t={}){const r=Cve(e)?e.valueOf():NaN;if(Number.isNaN(r))return nr.invalid("invalid input");const n=Am(t.zone,Es.defaultZone);return n.isValid?new nr({ts:r,zone:n,loc:bn.fromObject(t)}):nr.invalid(m3(n))}static fromMillis(e,t={}){if(J1(e))return e<-VV||e>VV?nr.invalid("Timestamp out of range"):new nr({ts:e,zone:Am(t.zone,Es.defaultZone),loc:bn.fromObject(t)});throw new au(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,t={}){if(J1(e))return new nr({ts:e*1e3,zone:Am(t.zone,Es.defaultZone),loc:bn.fromObject(t)});throw new au("fromSeconds requires a numerical input")}static fromObject(e,t={}){e=e||{};const r=Am(t.zone,Es.defaultZone);if(!r.isValid)return nr.invalid(m3(r));const n=bn.fromObject(t),l=nI(e,GV),{minDaysInFirstWeek:c,startOfWeek:h}=LV(l,n),d=Es.now(),f=Zi(t.specificOffset)?r.offset(d):t.specificOffset,m=!Zi(l.ordinal),g=!Zi(l.year),y=!Zi(l.month)||!Zi(l.day),_=g||y,b=l.weekYear||l.weekNumber;if((_||m)&&b)throw new eM("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(y&&m)throw new eM("Can't mix ordinal dates with month/day");const S=b||l.weekday&&!_;let E,T,A=g3(d,f);S?(E=Yye,T=Zye,A=iI(A,c,h)):m?(E=Kye,T=Jye,A=kN(A)):(E=UZ,T=BZ);let P=!1;for(const F of E){const z=l[F];Zi(z)?P?l[F]=T[F]:l[F]=A[F]:P=!0}const O=S?Eve(l,c,h):m?Tve(l):dZ(l),R=O||fZ(l);if(R)return nr.invalid(R);const D=S?RV(l,c,h):m?IV(l):l,[L,N]=eR(D,f,r),U=new nr({ts:L,zone:r,o:N,loc:n});return l.weekday&&_&&e.weekday!==U.weekday?nr.invalid("mismatched weekday",`you can't specify both a weekday of ${l.weekday} and a date of ${U.toISO()}`):U}static fromISO(e,t={}){const[r,n]=vye(e);return sT(r,n,t,"ISO 8601",e)}static fromRFC2822(e,t={}){const[r,n]=yye(e);return sT(r,n,t,"RFC 2822",e)}static fromHTTP(e,t={}){const[r,n]=_ye(e);return sT(r,n,t,"HTTP",t)}static fromFormat(e,t,r={}){if(Zi(e)||Zi(t))throw new au("fromFormat requires an input string and a format");const{locale:n=null,numberingSystem:l=null}=r,c=bn.fromOpts({locale:n,numberingSystem:l,defaultToEN:!0}),[h,d,f,m]=Xye(c,e,t);return m?nr.invalid(m):sT(h,d,r,`format ${t}`,e,f)}static fromString(e,t,r={}){return nr.fromFormat(e,t,r)}static fromSQL(e,t={}){const[r,n]=Tye(e);return sT(r,n,t,"SQL",e)}static invalid(e,t=null){if(!e)throw new au("need to specify a reason the DateTime is invalid");const r=e instanceof Ud?e:new Ud(e,t);if(Es.throwOnInvalid)throw new tve(r);return new nr({invalid:r})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,t={}){const r=FZ(e,bn.fromObject(t));return r?r.map(n=>n?n.val:null).join(""):null}static expandFormat(e,t={}){return DZ(Mo.parseFormat(e),bn.fromObject(t)).map(n=>n.val).join("")}get(e){return this[e]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?BN(this).weekYear:NaN}get weekNumber(){return this.isValid?BN(this).weekNumber:NaN}get weekday(){return this.isValid?BN(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?UN(this).weekday:NaN}get localWeekNumber(){return this.isValid?UN(this).weekNumber:NaN}get localWeekYear(){return this.isValid?UN(this).weekYear:NaN}get ordinal(){return this.isValid?kN(this.c).ordinal:NaN}get monthShort(){return this.isValid?f3.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?f3.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?f3.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?f3.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const e=864e5,t=6e4,r=mL(this.c),n=this.zone.offset(r-e),l=this.zone.offset(r+e),c=this.zone.offset(r-n*t),h=this.zone.offset(r-l*t);if(c===h)return[this];const d=r-c*t,f=r-h*t,m=g3(d,c),g=g3(f,h);return m.hour===g.hour&&m.minute===g.minute&&m.second===g.second&&m.millisecond===g.millisecond?[c1(this,{ts:d}),c1(this,{ts:f})]:[this]}get isInLeapYear(){return OC(this.year)}get daysInMonth(){return rI(this.year,this.month)}get daysInYear(){return this.isValid?yM(this.year):NaN}get weeksInWeekYear(){return this.isValid?eC(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?eC(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(e={}){const{locale:t,numberingSystem:r,calendar:n}=Mo.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:t,numberingSystem:r,outputCalendar:n}}toUTC(e=0,t={}){return this.setZone(Gl.instance(e),t)}toLocal(){return this.setZone(Es.defaultZone)}setZone(e,{keepLocalTime:t=!1,keepCalendarTime:r=!1}={}){if(e=Am(e,Es.defaultZone),e.equals(this.zone))return this;if(e.isValid){let n=this.ts;if(t||r){const l=e.offset(this.ts),c=this.toObject();[n]=eR(c,l,e)}return c1(this,{ts:n,zone:e})}else return nr.invalid(m3(e))}reconfigure({locale:e,numberingSystem:t,outputCalendar:r}={}){const n=this.loc.clone({locale:e,numberingSystem:t,outputCalendar:r});return c1(this,{loc:n})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;const t=nI(e,GV),{minDaysInFirstWeek:r,startOfWeek:n}=LV(t,this.loc),l=!Zi(t.weekYear)||!Zi(t.weekNumber)||!Zi(t.weekday),c=!Zi(t.ordinal),h=!Zi(t.year),d=!Zi(t.month)||!Zi(t.day),f=h||d,m=t.weekYear||t.weekNumber;if((f||c)&&m)throw new eM("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(d&&c)throw new eM("Can't mix ordinal dates with month/day");let g;l?g=RV({...iI(this.c,r,n),...t},r,n):Zi(t.ordinal)?(g={...this.toObject(),...t},Zi(t.day)&&(g.day=Math.min(rI(g.year,g.month),g.day))):g=IV({...kN(this.c),...t});const[y,_]=eR(g,this.o,this.zone);return c1(this,{ts:y,o:_})}plus(e){if(!this.isValid)return this;const t=Xr.fromDurationLike(e);return c1(this,WV(this,t))}minus(e){if(!this.isValid)return this;const t=Xr.fromDurationLike(e).negate();return c1(this,WV(this,t))}startOf(e,{useLocaleWeeks:t=!1}={}){if(!this.isValid)return this;const r={},n=Xr.normalizeUnit(e);switch(n){case"years":r.month=1;case"quarters":case"months":r.day=1;case"weeks":case"days":r.hour=0;case"hours":r.minute=0;case"minutes":r.second=0;case"seconds":r.millisecond=0;break}if(n==="weeks")if(t){const l=this.loc.getStartOfWeek(),{weekday:c}=this;c<l&&(r.weekNumber=this.weekNumber-1),r.weekday=l}else r.weekday=1;if(n==="quarters"){const l=Math.ceil(this.month/3);r.month=(l-1)*3+1}return this.set(r)}endOf(e,t){return this.isValid?this.plus({[e]:1}).startOf(e,t).minus(1):this}toFormat(e,t={}){return this.isValid?Mo.create(this.loc.redefaultToEN(t)).formatDateTimeFromString(this,e):zN}toLocaleString(e=tI,t={}){return this.isValid?Mo.create(this.loc.clone(t),e).formatDateTime(this):zN}toLocaleParts(e={}){return this.isValid?Mo.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:t=!1,suppressMilliseconds:r=!1,includeOffset:n=!0,extendedZone:l=!1}={}){if(!this.isValid)return null;const c=e==="extended";let h=HN(this,c);return h+="T",h+=jV(this,c,t,r,n,l),h}toISODate({format:e="extended"}={}){return this.isValid?HN(this,e==="extended"):null}toISOWeekDate(){return v3(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:t=!1,includeOffset:r=!0,includePrefix:n=!1,extendedZone:l=!1,format:c="extended"}={}){return this.isValid?(n?"T":"")+jV(this,c==="extended",t,e,r,l):null}toRFC2822(){return v3(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return v3(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?HN(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:t=!1,includeOffsetSpace:r=!0}={}){let n="HH:mm:ss.SSS";return(t||e)&&(r&&(n+=" "),t?n+="z":e&&(n+="ZZ")),v3(this,n,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():zN}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};const t={...this.c};return e.includeConfig&&(t.outputCalendar=this.outputCalendar,t.numberingSystem=this.loc.numberingSystem,t.locale=this.loc.locale),t}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,t="milliseconds",r={}){if(!this.isValid||!e.isValid)return Xr.invalid("created by diffing an invalid DateTime");const n={locale:this.locale,numberingSystem:this.numberingSystem,...r},l=Pve(t).map(Xr.normalizeUnit),c=e.valueOf()>this.valueOf(),h=c?this:e,d=c?e:this,f=Oye(h,d,l,n);return c?f.negate():f}diffNow(e="milliseconds",t={}){return this.diff(nr.now(),e,t)}until(e){return this.isValid?ys.fromDateTimes(this,e):this}hasSame(e,t,r){if(!this.isValid)return!1;const n=e.valueOf(),l=this.setZone(e.zone,{keepLocalTime:!0});return l.startOf(t,r)<=n&&n<=l.endOf(t,r)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;const t=e.base||nr.fromObject({},{zone:this.zone}),r=e.padding?this<t?-e.padding:e.padding:0;let n=["years","months","days","hours","minutes","seconds"],l=e.unit;return Array.isArray(e.unit)&&(n=e.unit,l=void 0),XV(t,this.plus(r),{...e,numeric:"always",units:n,unit:l})}toRelativeCalendar(e={}){return this.isValid?XV(e.base||nr.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(nr.isDateTime))throw new au("min requires all arguments be DateTimes");return OV(e,t=>t.valueOf(),Math.min)}static max(...e){if(!e.every(nr.isDateTime))throw new au("max requires all arguments be DateTimes");return OV(e,t=>t.valueOf(),Math.max)}static fromFormatExplain(e,t,r={}){const{locale:n=null,numberingSystem:l=null}=r,c=bn.fromOpts({locale:n,numberingSystem:l,defaultToEN:!0});return kZ(c,e,t)}static fromStringExplain(e,t,r={}){return nr.fromFormatExplain(e,t,r)}static get DATE_SHORT(){return tI}static get DATE_MED(){return VX}static get DATE_MED_WITH_WEEKDAY(){return nve}static get DATE_FULL(){return WX}static get DATE_HUGE(){return jX}static get TIME_SIMPLE(){return GX}static get TIME_WITH_SECONDS(){return qX}static get TIME_WITH_SHORT_OFFSET(){return XX}static get TIME_WITH_LONG_OFFSET(){return ZX}static get TIME_24_SIMPLE(){return JX}static get TIME_24_WITH_SECONDS(){return YX}static get TIME_24_WITH_SHORT_OFFSET(){return KX}static get TIME_24_WITH_LONG_OFFSET(){return QX}static get DATETIME_SHORT(){return eZ}static get DATETIME_SHORT_WITH_SECONDS(){return tZ}static get DATETIME_MED(){return iZ}static get DATETIME_MED_WITH_SECONDS(){return rZ}static get DATETIME_MED_WITH_WEEKDAY(){return sve}static get DATETIME_FULL(){return nZ}static get DATETIME_FULL_WITH_SECONDS(){return sZ}static get DATETIME_HUGE(){return aZ}static get DATETIME_HUGE_WITH_SECONDS(){return oZ}}function aT(i){if(nr.isDateTime(i))return i;if(i&&i.valueOf&&J1(i.valueOf()))return nr.fromJSDate(i);if(i&&typeof i=="object")return nr.fromObject(i);throw new au(`Unknown datetime argument: ${i}, of type ${typeof i}`)}var e0e=Object.create,kC=Object.defineProperty,t0e=Object.defineProperties,HZ=Object.getOwnPropertyDescriptor,i0e=Object.getOwnPropertyDescriptors,r0e=Object.getOwnPropertyNames,sI=Object.getOwnPropertySymbols,n0e=Object.getPrototypeOf,HB=Object.prototype.hasOwnProperty,$Z=Object.prototype.propertyIsEnumerable,JV=(i,e,t)=>e in i?kC(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,ir=(i,e)=>{for(var t in e||(e={}))HB.call(e,t)&&JV(i,t,e[t]);if(sI)for(var t of sI(e))$Z.call(e,t)&&JV(i,t,e[t]);return i},Ia=(i,e)=>t0e(i,i0e(e)),YV=(i,e)=>{var t={};for(var r in i)HB.call(i,r)&&e.indexOf(r)<0&&(t[r]=i[r]);if(i!=null&&sI)for(var r of sI(i))e.indexOf(r)<0&&$Z.call(i,r)&&(t[r]=i[r]);return t},VZ=(i,e)=>()=>(i&&(e=i(i=0)),e),s0e=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),a0e=(i,e)=>{for(var t in e)kC(i,t,{get:e[t],enumerable:!0})},o0e=(i,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of r0e(e))!HB.call(i,n)&&n!==t&&kC(i,n,{get:()=>e[n],enumerable:!(r=HZ(e,n))||r.enumerable});return i},l0e=(i,e,t)=>(t=i!=null?e0e(n0e(i)):{},o0e(e||!i||!i.__esModule?kC(t,"default",{value:i,enumerable:!0}):t,i)),Rs=(i,e,t,r)=>{for(var n=r>1?void 0:r?HZ(e,t):e,l=i.length-1,c;l>=0;l--)(c=i[l])&&(n=(r?c(e,t,n):c(n))||n);return r&&n&&kC(e,t,n),n},Zr=(i,e,t)=>new Promise((r,n)=>{var l=d=>{try{h(t.next(d))}catch(f){n(f)}},c=d=>{try{h(t.throw(d))}catch(f){n(f)}},h=d=>d.done?r(d.value):Promise.resolve(d.value).then(l,c);h((t=t.apply(i,e)).next())}),nt=VZ(()=>{}),WZ={};a0e(WZ,{version:()=>jZ});var jZ,u0e=VZ(()=>{nt(),jZ="6.0.0-lab.3"}),c0e=s0e((i,e)=>{nt(),e.exports={remoteConfig:{apiUrl:"https://dev.nodeapi.superviz.com",conferenceLayerUrl:"https://video-frame.superviz.com/lab/index.html"}}});nt();nt();var GZ=(i=>(i.MEETING_START="meeting.start",i.MEETING_LEAVE="meeting.leave",i.MEETING_PARTICIPANT_AMOUNT_UPDATE="meeting.amount-of-participants-update",i.MEETING_PARTICIPANT_LIST_UPDATE="meeting.participant-list-update",i.MEETING_PARTICIPANT_JOINED="meeting.participant-joined",i.MEETING_PARTICIPANT_LEFT="meeting.participant-left",i.MEETING_JOIN="meeting.join",i.MEETING_PARTICIPANT_PROPERTIES="meeting.participant-properties",i.MEETING_HOST_CHANGE="meeting.host-change",i.MEETING_HOST_AVAILABLE="meeting.host-available",i.MEETING_NO_HOST_AVAILABLE="meeting.no-host-available",i.MEETING_SAME_PARTICIPANT_ERROR="meeting.same-participant-error",i.MEETING_DEVICES_CHANGE="meeting.devices-change",i.MEETING_KICK_PARTICIPANTS="meeting.kick-all-participants",i.MEETING_STATE_UPDATE="meeting.state-update",i.MEETING_CONNECTION_STATUS_CHANGE="meeting.connection-status-change",i.MEETING_WAITING_FOR_HOST="meeting.waiting-for-host",i.MY_PARTICIPANT_UPDATED="my-participant.update",i.MY_PARTICIPANT_LEFT="my-participant.left",i.MY_PARTICIPANT_JOINED="my-participant.joined",i.MEETING_KICK_PARTICIPANT="meeting.kick-participant",i.DESTROY="destroy",i))(GZ||{}),qZ=(i=>(i.FRAME_LOAD="frame.load",i.FRAME_DIMENSIONS_UPDATE="frame.dimensions-update",i.FRAME_PARENT_SIZE_UPDATE="frame.parent-window-size-update",i.FRAME_LOCALE_UPDATE="frame.locales-update",i.FRAME_AVATAR_LIST_UPDATE="frame.avatar-list-update",i.FRAME_COLOR_LIST_UPDATE="frame.color-list-update",i.FRAME_STYLES_UPDATE="frame.styles-update",i.FRAME_CALLBACKS_UPDATE="frame.callbacks-update",i))(qZ||{}),XZ=(i=>(i.TOGGLE_MEETING_CHAT="meeting-controls.toggle-chat",i.TOGGLE_MEETING_SETUP="meeting-controls.toggle-setup",i.TOGGLE_MICROPHONE="meeting-controls.toggle-microphone",i.TOGGLE_CAM="meeting-controls.toggle-cam",i.TOGGLE_SCREENSHARE="meeting-controls.toggle-screenshare",i.TOGGLE_TRANSCRIPT="meeting-controls.toggle-transcript",i.HANG_UP="hang-up",i.CALLBACK_CALLED="callback-called",i))(XZ||{}),ZZ=(i=>(i.REALTIME_PARTICIPANT_LIST_UPDATE="realtime.participant-list-update",i.REALTIME_HOST_CHANGE="realtime.host-change",i.REALTIME_GRID_MODE_CHANGE="realtime.grid-mode-change",i.REALTIME_WAIT_FOR_HOST="realtime.wait-for-host",i.REALTIME_AUTHENTICATION_FAILED="realtime.authentication-failed",i.REALTIME_GO_TO_PARTICIPANT="realtime.go-to-participant",i.REALTIME_GATHER="realtime.gather",i.REALTIME_FOLLOW_PARTICIPANT="realtime.follow-participant",i.REALTIME_LOCAL_FOLLOW_PARTICIPANT="realtime.local-follow-participant",i.REALTIME_SET_AVATAR="realtime.set-avatar",i.REALTIME_DRAWING_CHANGE="realtime.drawing-change",i.REALTIME_TRANSCRIPT_CHANGE="realtime.transcript-change",i.REALTIME_PRIVATE_MODE="realtime.private-mode",i))(ZZ||{}),JZ=(i=>(i[i.MEETING_FAILED=-1]="MEETING_FAILED",i[i.MEETING_DISCONNECTED=0]="MEETING_DISCONNECTED",i[i.MEETING_INITIALIZING=1]="MEETING_INITIALIZING",i[i.MEETING_READY_TO_JOIN=2]="MEETING_READY_TO_JOIN",i[i.MEETING_CONNECTING=3]="MEETING_CONNECTING",i[i.MEETING_CONNECTED=4]="MEETING_CONNECTED",i[i.MEETING_RECONNECT=5]="MEETING_RECONNECT",i[i.FRAME_INITIALIZING=6]="FRAME_INITIALIZING",i[i.FRAME_INITIALIZED=7]="FRAME_INITIALIZED",i[i.FRAME_UNINITIALIZED=8]="FRAME_UNINITIALIZED",i))(JZ||{}),Ru=(i=>(i.JOINED="participant.joined",i.LOCAL_JOINED="participant.local-joined",i.LEFT="participant.left",i.LOCAL_LEFT="participant.local-left",i.LOCAL_UPDATED="participant.updated",i.LIST_UPDATED="participant.list-updated",i.SAME_ACCOUNT_ERROR="participant.same-account-error",i))(Ru||{}),YZ=(i=>(i[i.NOT_AVAILABLE=0]="NOT_AVAILABLE",i[i.GOOD=1]="GOOD",i[i.BAD=2]="BAD",i[i.POOR=3]="POOR",i[i.DISCONNECTED=4]="DISCONNECTED",i[i.RECONNECTING=5]="RECONNECTING",i[i.LOST_CONNECTION=6]="LOST_CONNECTION",i))(YZ||{}),KZ=(i=>(i.NO_CAM="devices.no-cam",i.NO_DEVICES="devices.no-devices",i.DEVICES_BLOCKED="devices.blocked",i.DEVICES_CAM_BLOCKED="devices.cam-blocked",i.DEVICES_INITIALIZATION_ERROR="devices.inititalization-error",i.DEVICES_UNKNOWN_ERROR="devices.unknown-error",i.DEVICES_ALLOWED="devices.allowed",i))(KZ||{}),QZ=(i=>(i.PIN_ACTIVE="pin-mode.active",i.PIN_INACTIVE="pin-mode.inactive",i))(QZ||{}),$B=(i=>(i.MOUNT="mount",i.UNMOUNT="unmount",i))($B||{}),eJ=(i=>(i.START_FOLLOWING_PARTICIPANT="who-is-online.start-following-participant",i.STOP_FOLLOWING_PARTICIPANT="who-is-online.stop-following-participant",i.ENTER_PRIVATE_MODE="who-is-online.enter-private-mode",i.LEAVE_PRIVATE_MODE="who-is-online.leave-private-mode",i.GATHER_ALL="who-is-online.gather-all",i.GO_TO_PARTICIPANT="who-is-online.go-to-participant",i.START_FOLLOW_ME="who-is-online.start-follow-me",i.STOP_FOLLOW_ME="who-is-online.stop-follow-me",i))(eJ||{});nt();var tJ=(i=>(i.HOST="host",i.GUEST="guest",i.AUDIENCE="audience",i))(tJ||{});nt();nt();nt();nt();nt();var yo=(i,e,t,...r)=>Zr(void 0,[i,e,t,...r],function*(n,l,c,h={}){let d=yield fetch(n,{method:l,headers:ir({"Content-Type":"application/json"},h),body:c?JSON.stringify(c):null});if(!d.ok)throw d;try{return yield d.json()}catch{return d.ok}});nt();var eu=class{constructor(e){this.debug=ode(e)}log(e,...t){this.debug(e,...t)}};nt();nt();var yr=class{constructor(e={}){this.subscribe=n=>{this.callbacks.push(n)},this.unsubscribe=n=>{this.callbacks=this.callbacks.filter(l=>l!==n)},this.publish=(...n)=>{!this.callbacks||this.callbacks.forEach(l=>{this.callListener(l,n).catch(c=>{var h;(h=this.logger)==null||h.log("superviz-sdk:observer-helper:publish:error",`
            Failed to execute callback on publish value.
            Callback: ${l.name}
            Event: ${JSON.stringify(n)}
            Error: ${c}
          `)})})},this.reset=()=>{this.callbacks=[]},this.destroy=()=>{delete this.logger,delete this.callbacks},this.callListener=(n,l)=>new Promise((c,h)=>{try{let d=n(...l);c(d)}catch(d){h(d)}});let{logger:t,throttleTime:r}=e;this.logger=t||new eu("@superviz/sdk/observer-helper"),this.throttle=r,this.callbacks=[],this.throttle&&(this.publish=UR(this.publish,this.throttle))}},iJ=class{constructor(){this.observers={},this.subscribe=(e,t)=>{this.logger.log(`subscribed to ${e} event`),this.observers[e]||(this.observers[e]=new yr({logger:this.logger})),this.observers[e].subscribe(t)},this.unsubscribe=(e,t)=>{if(this.logger.log(`unsubscribed from ${e} event`),!!this.observers[e]){if(!t){this.observers[e].destroy(),delete this.observers[e];return}this.observers[e].unsubscribe(t)}},this.publish=(e,t)=>{e in this.observers&&this.observers[e].publish(t)}}};nt();nt();nt();var h0e=class{setConfig(e){this.configuration=e}get(e,t){return this.configuration?dfe.get(this.configuration,e,t):t}},Fi=new h0e,to=class{static createUrl(i,e,t={}){let r=new URL(e,i);return Object.keys(t).forEach(n=>r.searchParams.append(n,t[n])),r.toString()}static validateApiKey(i,e){let t="/user/checkapikey",r=this.createUrl(i,t);return yo(r,"POST",{apiKey:e})}static fetchConfig(i,e){let t="/immersive-config",r=this.createUrl(i,t);return yo(r,"POST",{apiKey:e})}static fetchLimits(i,e){return Zr(this,null,function*(){let t="/user/check_limits",r=this.createUrl(i,t);return(yield yo(r,"GET","",{apikey:e})).usage})}static fetchWaterMark(i,e){return Zr(this,null,function*(){let t="/user/watermark",r=this.createUrl(i,t),{message:n}=yield yo(r,"POST",{apiKey:e});return n})}static createAnnotations(i,e,t){return Zr(this,null,function*(){let r="/annotations",n=this.createUrl(i,r);return yo(n,"POST",ir({},t),{apikey:e})})}static updateComment(i,e,t,r){return Zr(this,null,function*(){let n=`/comments/${t}`,l=this.createUrl(i,n);return yo(l,"PUT",{text:r},{apikey:e})})}static createComment(i,e,t){return Zr(this,null,function*(){let r="/comments",n=this.createUrl(i,r);return yo(n,"POST",ir({},t),{apikey:e})})}static fetchAnnotation(i,e,t){return Zr(this,null,function*(){let r="/annotations",n=this.createUrl(i,r,{roomId:t.roomId,url:t.url});return yo(n,"GET",void 0,{apikey:e})})}static resolveAnnotation(i,e,t){return Zr(this,null,function*(){let r=`/annotations/resolve/${t}`,n=this.createUrl(i,r);return yo(n,"POST",{},{apikey:e})})}static deleteComment(i,e,t){return Zr(this,null,function*(){let r=`/comments/${t}`,n=this.createUrl(i,r);return yo(n,"DELETE",{},{apikey:e})})}static deleteAnnotation(i,e,t){return Zr(this,null,function*(){let r=`/annotations/${t}`,n=this.createUrl(i,r);return yo(n,"DELETE",{},{apikey:e})})}static createOrUpdateParticipant(i){return Zr(this,null,function*(){let e=Fi.get("apiUrl"),t="/participants",r=this.createUrl(e,t);return yo(r,"POST",ir({},i),{apikey:Fi.get("apiKey")})})}static sendActivity(i,e,t,r){return Zr(this,null,function*(){let n="/activity",l=Fi.get("apiUrl"),c=Fi.get("roomId"),h=Fi.get("apiKey"),d=this.createUrl(l,n);return yo(d,"POST",{groupId:e,groupName:t,meetingId:c,product:r,userId:i},{apikey:h})})}static fetchParticipantsByGroup(i){return Zr(this,null,function*(){let e=`/groups/participants/${i}`,t=Fi.get("apiUrl"),r=this.createUrl(t,e,{take:1e4});return yo(r,"GET",void 0,{apikey:Fi.get("apiKey")})})}static createMentions(i){return Zr(this,null,function*(){let e="/mentions",t=Fi.get("apiUrl"),r=this.createUrl(t,e);return yo(r,"POST",i,{apikey:Fi.get("apiKey")})})}};nt();nt();nt();nt();function rJ(){return{set value(i){this.instance=i,setTimeout(()=>Object.freeze(this))},get value(){return this.instance}}}nt();var d0e=class{constructor(e,t,r){this.subscriptions=new Map,this.setValue=n=>{this.state=n,this.subject.next(this.state)},this.subscribe=(n,l)=>{let c=this.subject.subscribe(l);this.subscriptions.set(n,c)},this.state=e,this.showLog=!!r,this.subject=t.pipe(ope(),cpe({bufferSize:1,refCount:!0}))}getValue(){return this.state}unsubscribe(e){var t;(t=this.subscriptions.get(e))==null||t.unsubscribe(),this.subscriptions.delete(e)}destroy(){this.subscriptions.forEach(e=>e.unsubscribe()),this.subscriptions.clear()}expose(){let e=this.subscribe.bind(this),t=this.unsubscribe.bind(this),r=this.getValue.bind(this),n=this.setValue.bind(this);return{get value(){return r()},set value(l){n(l)},subscribe:e,unsubscribe:t}}};function $l(i,e){let t=new Tfe(i);return new d0e(i,t,e)}var $N=rJ(),f0e=class{constructor(){if(this.localParticipant=$l(null,!0),this.participants=$l(new Map),this.group=$l(null),$N.value)throw new Error("CommentsStore is a singleton. There can only be one instance of it.");$N.value=this}destroy(){this.localParticipant.destroy(),$N.value=null}},tC=new f0e,p0e=tC.destroy.bind(tC),m0e=tC.group.expose(),g0e=tC.participants.expose(),v0e=tC.localParticipant.expose();function YF(){return{localParticipant:v0e,participants:g0e,destroy:p0e,group:m0e}}nt();var VN=rJ(),y0e=class{constructor(){if(this.disablePresenceControls=$l(!1),this.disableGoToParticipant=$l(!1),this.disableFollowParticipant=$l(!1),this.disablePrivateMode=$l(!1),this.disableGatherAll=$l(!1),this.disableFollowMe=$l(!1),this.participants=$l([]),this.extras=$l([]),this.joinedPresence=$l(void 0),this.everyoneFollowsMe=$l(!1),this.privateMode=$l(!1),this.following=$l(void 0),VN.value)throw new Error("WhoIsOnlineStore is a singleton. There can only be one instance of it.");VN.value=this}destroy(){this.disablePresenceControls.destroy(),VN.value=null}},mu=new y0e,_0e=mu.destroy.bind(mu),x0e=mu.disablePresenceControls.expose(),b0e=mu.disableGoToParticipant.expose(),w0e=mu.disableFollowParticipant.expose(),S0e=mu.disablePrivateMode.expose(),M0e=mu.disableGatherAll.expose(),E0e=mu.disableFollowMe.expose(),T0e=mu.joinedPresence.expose(),A0e=mu.participants.expose(),C0e=mu.extras.expose(),P0e=mu.everyoneFollowsMe.expose(),R0e=mu.privateMode.expose(),I0e=mu.following.expose();function L0e(){return{disablePresenceControls:x0e,disableGoToParticipant:b0e,disableFollowParticipant:w0e,disablePrivateMode:S0e,disableGatherAll:M0e,disableFollowMe:E0e,participants:A0e,extras:C0e,joinedPresence:T0e,everyoneFollowsMe:P0e,privateMode:R0e,following:I0e,destroy:_0e}}var O0e={"global-store":YF,"who-is-online-store":L0e};function N0e(i,e,t){e.subscribe(this,()=>{t?t(e.value):this[i]=e.value,this.requestUpdate&&this.requestUpdate()}),this.unsubscribeFrom.push(e.unsubscribe)}function VB(i){let e=O0e[i](),t=N0e.bind(this);return new Proxy(e,{get(r,n){return{subscribe(l){t(n,r[n],l)},subject:r[n],get value(){return this.subject.value},publish(l){this.subject.value=l}}}})}var ww=class extends iJ{constructor(){super(...arguments),this.isAttached=!1,this.unsubscribeFrom=[],this.useStore=VB.bind(this),this.attach=e=>{if(Object.values(e).includes(null)||Object.values(e).includes(void 0)){let c=`${this.name} @ attach - params are required`;throw this.logger.log(c),new Error(c)}let{realtime:t,config:r,eventBus:n,ioc:l}=e;if(!t.isDomainWhitelisted){let c=`Component ${this.name} can't be used because this website's domain is not whitelisted. Please add your domain in https://dashboard.superviz.com/developer`;this.logger.log(c);return}if(Fi.setConfig(r),this.realtime=t,this.eventBus=n,this.isAttached=!0,this.ioc=l,this.room=l.createRoom(this.name),!this.realtime.isJoinedRoom){this.logger.log(`${this.name} @ attach - not joined yet`),setTimeout(()=>{this.logger.log(`${this.name} @ attach - retrying`),this.attach(e)},1e3);return}this.logger.log(`${this.name} @ attached`),this.start(),this.publish("mount")},this.detach=()=>{if(!this.isAttached){this.logger.log(`${this.name} @ detach - component is not attached`);return}this.logger.log("detached"),this.publish("unmount"),this.destroy(),this.room.disconnect(),this.unsubscribeFrom.forEach(e=>e(this)),Object.values(this.observers).forEach(e=>{e.reset(),e.destroy()}),this.observers=void 0,this.realtime=void 0,this.isAttached=!1}}};nt();var nJ=(i=>(i.presence3dMatterport="presence",i.presence3dAutodesk="presence",i.presence3dThreejs="presence",i.realtime="presence",i.whoIsOnline="presence",i.formElements="presence",i))(nJ||{});nt();var KF=(i=>(i.LEFT="left",i.RIGHT="right",i))(KF||{}),sJ=(i=>(i.TOP_LEFT="top-left",i.TOP_RIGHT="top-right",i.BOTTOM_LEFT="bottom-left",i.BOTTOM_RIGHT="bottom-right",i))(sJ||{}),aJ=class extends ww{constructor(e,t){var r,n,l;super(),this.sidebarOpen=!1,this.layoutOptions={},this.openThreads=()=>{var d;this.sidebarOpen||((d=this.element)==null||d.setAttribute("open",""),this.sidebarOpen=!0,document.body.dispatchEvent(new CustomEvent("toggle-annotation-sidebar",{detail:{open:this.sidebarOpen},composed:!0,bubbles:!0})))},this.closeThreads=()=>{var d;!this.sidebarOpen||((d=this.element)==null||d.removeAttribute("open"),this.sidebarOpen=!1,document.body.dispatchEvent(new CustomEvent("toggle-annotation-sidebar",{detail:{open:this.sidebarOpen},composed:!0,bubbles:!0})))},this.togglePinActive=()=>{if(this.pinActive){this.disable();return}this.enable()},this.onPinFixed=d=>{this.coordinates=d},this.toggleAnnotationSidebar=()=>{this.element.toggleAttribute("open"),this.sidebarOpen=this.element.hasAttribute("open"),document.body.dispatchEvent(new CustomEvent("prepare-to-create-annotation",{detail:void 0,composed:!0,bubbles:!0})),document.body.dispatchEvent(new CustomEvent("toggle-annotation-sidebar",{detail:{open:this.sidebarOpen},composed:!0,bubbles:!0}))},this.onSelectAnnotation=d=>{this.sidebarOpen||this.toggleAnnotationSidebar()},this.positionFloatingButton=()=>{var d,f;this.button=document.createElement("superviz-comments-button");let m=(d=this.layoutOptions)==null?void 0:d.buttonLocation,g=(f=this.layoutOptions)==null?void 0:f.position;if(!m){document.body.appendChild(this.button),this.button.commentsPosition=g;return}let y="",_=Object.values(sJ),b=!1,S=!_.includes(m.toLocaleLowerCase());if(S){let E=window.document.body.querySelector(`#${m}`);E?(E.appendChild(this.button),y="position: relative"):(b=!0,m="top-left")}if(!S||b){document.body.appendChild(this.button);let[E,T]=m.split("-");y=`${E}: 20px; ${T}: 20px;`}this.button.positionStyles=y,this.button.commentsPosition=g},this.positionComments=()=>{var d;this.element=document.createElement("superviz-comments"),this.element.setAttribute("comments",JSON.stringify([])),this.element.side="left",this.element.offset=this.offset,document.body.appendChild(this.element);let f=(d=this.layoutOptions)==null?void 0:d.position;if(!f)return;let m=f.toUpperCase();!KF[m]||(this.element.side=KF[m])},this.createAnnotation=d=>Zr(this,[d],function*({detail:f}){try{let{text:m,mentions:g}=f,{url:y}=this,_=ir({},this.coordinates),b=yield to.createAnnotations(Fi.get("apiUrl"),Fi.get("apiKey"),{roomId:Fi.get("roomId"),position:JSON.stringify(_),url:y,userId:this.localParticipantId}),S=yield this.createComment(b.uuid,m,g);this.addAnnotation(Ia(ir({},b),{comments:[S]})),this.pinAdapter.removeAnnotationPin("temporary-pin"),document.body.dispatchEvent(new CustomEvent("select-annotation",{detail:{uuid:b.uuid,haltGoToPin:!0,newPin:!0},composed:!0,bubbles:!0}))}catch(m){this.logger.log("error when creating annotation",m)}}),this.deleteAnnotation=d=>Zr(this,[d],function*({detail:f}){try{let{uuid:m}=f;yield to.deleteAnnotation(Fi.get("apiUrl"),Fi.get("apiKey"),m);let g=this.annotations.filter(y=>y.uuid!==m);this.updateAnnotationList(g),this.pinAdapter.removeAnnotationPin(m),this.element.updateAnnotations(this.annotations)}catch(m){this.logger.log("error when deleting annotation",m)}}),this.updateComment=d=>Zr(this,[d],function*({detail:f}){try{let{uuid:m,text:g,mentions:y}=f,_=yield to.updateComment(Fi.get("apiUrl"),Fi.get("apiKey"),m,g);yield to.createMentions({commentsId:_.uuid,participants:y.map(S=>({id:S.userId}))});let b=this.annotations.map(S=>Object.assign({},S,{comments:S.comments.map(E=>E.uuid===m?Object.assign({},E,{text:g,mentions:y}):E)}));this.updateAnnotationList(b)}catch(m){this.logger.log("error when updating comment",m)}}),this.resolveAnnotation=d=>Zr(this,[d],function*({detail:f}){try{let{uuid:m}=f,{resolved:g}=yield to.resolveAnnotation(Fi.get("apiUrl"),Fi.get("apiKey"),m),y=this.annotations.map(_=>_.uuid===m?Object.assign({},_,{resolved:g}):_);if(this.updateAnnotationList(y),g){this.pinAdapter.removeAnnotationPin(m);return}this.pinAdapter.updateAnnotations(this.annotations)}catch(m){this.logger.log("error when resolve annotation",m)}}),this.deleteComment=d=>Zr(this,[d],function*({detail:f}){try{let{uuid:m,annotationId:g}=f;if(!m||!g)return;yield to.deleteComment(Fi.get("apiUrl"),Fi.get("apiKey"),m);let y=this.annotations.find(b=>b.uuid===g);y.comments=y.comments.filter(b=>b.uuid!==m);let _=this.annotations.map(b=>b.uuid===g?y:b);this.element.updateAnnotations(_),this.updateAnnotationList(_)}catch(m){this.logger.log("error when deleting comment",m)}}),this.onAnnotationListUpdate=d=>{let{data:f,clientId:m}=d;this.localParticipantId!==m&&(this.annotations=f,this.element.updateAnnotations(this.annotations),this.pinAdapter.updateAnnotations(this.annotations))},this.name="comments",this.logger=new eu("@superviz/sdk/comments-component"),this.annotations=[],this.layoutOptions={buttonLocation:(r=t==null?void 0:t.buttonLocation)!=null?r:"top-left",position:(n=t==null?void 0:t.position)!=null?n:"left"},this.hideDefaultButton=(l=t==null?void 0:t.hideDefaultButton)!=null?l:!1,this.setStyles(t==null?void 0:t.styles),this.offset=t==null?void 0:t.offset,setTimeout(()=>{var d,f;e.setCommentsMetadata((f=(d=this.layoutOptions)==null?void 0:d.position)!=null?f:"left")}),this.pinAdapter=e;let{group:c,localParticipant:h}=this.useStore("global-store");c.subscribe(),h.subscribe(d=>{this.localParticipantId=d.id})}enable(){this.pinAdapter.setActive(!0),this.pinActive=!0,this.publish("pin-mode.active"),document.body.dispatchEvent(new CustomEvent("toggle-pin-active",{detail:{isActive:!0}}))}disable(){this.pinAdapter.setActive(!1),this.pinActive=!1,this.publish("pin-mode.inactive"),document.body.dispatchEvent(new CustomEvent("toggle-pin-active",{detail:{isActive:!1}}))}get url(){let e=new URL(this.clientUrl);return e.search="",e.toString()}start(){this.clientUrl=window.location.href,this.positionComments(),this.hideDefaultButton||this.positionFloatingButton(),this.fetchAnnotations(),this.waterMarkState(),this.participantsList(),this.addListeners(),this.pinAdapter.setPinsVisibility(!0)}destroy(){var e;this.logger.log("comments component @ destroy"),this.destroyListeners(),(e=this.button)==null||e.remove(),this.element.remove(),this.element=void 0,this.pinAdapter.destroy()}addListeners(){var e;(e=this.button)==null||e.addEventListener("toggle",this.togglePinActive),this.element.addEventListener("close-threads",this.closeThreads),document.body.addEventListener("create-annotation",this.createAnnotation),this.element.addEventListener("resolve-annotation",this.resolveAnnotation),this.element.addEventListener("delete-annotation",this.deleteAnnotation),this.element.addEventListener("create-comment",({detail:t})=>{this.createComment(t.uuid,t.text,t.mentions,!0)}),this.element.addEventListener("update-comment",this.updateComment),this.element.addEventListener("delete-comment",this.deleteComment),document.body.addEventListener("select-annotation",this.onSelectAnnotation),this.realtime.commentsObserver.subscribe(this.onAnnotationListUpdate),this.pinAdapter.onPinFixedObserver.subscribe(this.onPinFixed)}destroyListeners(){var e;(e=this.button)==null||e.removeEventListener("toggle",this.togglePinActive),this.element.removeEventListener("close-threads",this.closeThreads),this.element.removeEventListener("resolve-annotation",this.resolveAnnotation),this.element.removeEventListener("create-comment",({detail:t})=>{this.createComment(t.uuid,t.text,t.mentions,!0)}),this.element.removeEventListener("update-comment",this.updateComment),this.element.removeEventListener("delete-comment",this.deleteComment),document.body.removeEventListener("select-annotation",this.onSelectAnnotation),document.body.removeEventListener("create-annotation",this.createAnnotation),this.realtime.commentsObserver.unsubscribe(this.onAnnotationListUpdate),this.pinAdapter.onPinFixedObserver.unsubscribe(this.onPinFixed)}setStyles(e=""){if(!e)return;let t=document.createElement("style");t.textContent=e,t.id="superviz-comments-styles",document.head.appendChild(t)}createComment(e,t){return Zr(this,arguments,function*(r,n,l=[],c=!1){try{let h=yield to.createComment(Fi.get("apiUrl"),Fi.get("apiKey"),{annotationId:r,userId:this.localParticipantId,text:n});return yield to.createMentions({commentsId:h.uuid,participants:l.map(d=>({id:d.userId,readed:0}))}),h.mentions=l,c&&this.addComment(r,h),h}catch(h){this.logger.log("error when creating comment",h)}})}addAnnotation(e){let t=[e,...this.annotations];this.element.updateAnnotations(t),this.pinAdapter.updateAnnotations(t),this.updateAnnotationList(t)}updateAnnotationList(e){this.annotations=e,this.realtime.updateComments(e)}addComment(e,t){let r=this.annotations.find(l=>l.uuid===e);r.comments.push(t);let n=this.annotations.map(l=>l.uuid===e?r:l);this.updateAnnotationList(n),this.element.updateAnnotations(n)}fetchAnnotations(){return Zr(this,null,function*(){try{let e=yield to.fetchAnnotation(Fi.get("apiUrl"),Fi.get("apiKey"),{roomId:Fi.get("roomId"),url:this.url});this.annotations=e,this.element.updateAnnotations(this.annotations),this.pinAdapter.updateAnnotations(this.annotations)}catch(e){this.logger.log("error when fetching annotations",e)}})}waterMarkState(){return Zr(this,null,function*(){try{let e=yield to.fetchWaterMark(Fi.get("apiUrl"),Fi.get("apiKey"));this.element.waterMarkStatus(e)}catch(e){this.logger.log("error when fetching waterMark",e)}})}participantsList(){return Zr(this,null,function*(){try{let e=(yield to.fetchParticipantsByGroup(this.group.id)).data;this.pinAdapter.participantsList=e,this.element.participantsList=e}catch(e){this.logger.log("error when fetching participantsList",e)}})}};nt();nt();var D0e=(i=>(i.ADD="add",i.SHOW="show",i))(D0e||{}),oJ=class{constructor(i,e){if(this.isPinsVisible=!0,this.selectedPin=null,this.temporaryPinCoordinates=null,this.commentsSide="left",this.setCommentsMetadata=t=>{this.commentsSide=t},this.resetPins=t=>{t&&(t==null?void 0:t.key)!=="Escape"||(this.resetSelectedPin(),this.removeAnnotationPin("temporary-pin"),this.temporaryPinCoordinates=null)},this.animate=()=>{(this.isActive||this.isPinsVisible)&&(this.renderAnnotationsPins(),this.divWrapper=this.renderDivWrapper()),this.temporaryPinCoordinates&&this.renderTemporaryPin(),requestAnimationFrame(this.animate)},this.setMouseDownCoordinates=({x:t,y:r})=>{this.mouseDownCoordinates={x:t,y:r}},this.annotationSelected=({detail:{uuid:t,haltGoToPin:r,newPin:n}})=>{var l,c;if(!t)return;n&&this.pins.get(t).setAttribute("newPin","");let h=JSON.parse((c=(l=this.selectedPin)==null?void 0:l.getAttribute("annotation"))!=null?c:"{}");if(this.resetPins(),(h==null?void 0:h.uuid)===t)return;document.body.dispatchEvent(new CustomEvent("close-temporary-annotation"));let d=this.pins.get(t);!d||(d.setAttribute("active",""),this.selectedPin=d,!r&&this.goToPin(t))},this.onClick=t=>{if(!this.isActive)return;let r=this.canvas.getBoundingClientRect(),{x:n,y:l}=this.mouseDownCoordinates,c=n-r.x,h=l-r.y,d=t.clientX-r.left,f=t.clientY-r.top;if(Math.hypot(d-c,f-h)>10)return;let m=this.canvas.getContext("2d").getTransform().inverse(),g=new DOMPoint(d,f-31).matrixTransform(m);this.onPinFixedObserver.publish({x:g.x,y:g.y,type:"canvas"}),this.resetSelectedPin(),this.temporaryPinCoordinates={x:g.x,y:g.y},this.renderTemporaryPin();let y=document.getElementById("superviz-temporary-pin");this.movedTemporaryPin=!this.movedTemporaryPin,y.setAttribute("movedPosition",String(this.movedTemporaryPin)),!this.selectedPin&&document.body.dispatchEvent(new CustomEvent("unselect-annotation"))},this.onToggleAnnotationSidebar=({detail:t})=>{let{open:r}=t;r||(this.pins.forEach(n=>{n.removeAttribute("active")}),this.pins.has("temporary-pin")&&this.removeAnnotationPin("temporary-pin"))},this.hideTemporaryPin=t=>{var r;let n=t.target,l=n.contains(this.canvas),{x:c,y:h}=t,{left:d,top:f,right:m,bottom:g}=this.canvas.getBoundingClientRect(),y=c>d&&c<m&&h>f&&h<g;this.canvas.contains(n)||(r=this.pins.get("temporary-pin"))!=null&&r.contains(n)||l&&y||(this.removeAnnotationPin("temporary-pin"),this.temporaryPinCoordinates=null)},this.logger=new eu("@superviz/sdk/comments-component/canvas-pin-adapter"),this.canvas=document.getElementById(i),this.isActive=!1,this.pins=new Map,this.goToPinCallback=e==null?void 0:e.onGoToPin,!this.canvas){let t=`Canvas with id ${i} not found`;throw this.logger.log(t),new Error(t)}this.canvasSides=this.canvas.getBoundingClientRect(),document.body.style.position="relative",this.onPinFixedObserver=new yr({logger:this.logger}),this.divWrapper=this.renderDivWrapper(),this.annotations=[],this.renderAnnotationsPins(),this.animateFrame=requestAnimationFrame(this.animate),document.body.addEventListener("select-annotation",this.annotationSelected),document.body.addEventListener("keyup",this.resetPins)}destroy(){this.removeListeners(),this.removeAnnotationsPins(),this.pins=new Map,this.divWrapper.remove(),this.onPinFixedObserver.destroy(),this.onPinFixedObserver=null,this.canvas.style.cursor="default",this.annotations=[],cancelAnimationFrame(this.animateFrame),document.body.removeEventListener("select-annotation",this.annotationSelected),document.body.removeEventListener("keyup",this.resetPins)}setPinsVisibility(i){if(this.isPinsVisible=i,this.isPinsVisible){this.renderAnnotationsPins();return}this.removeAnnotationsPins()}setActive(i){if(this.isActive!==i){if(this.isActive=i,this.isActive){this.originalCanvasCursor=this.canvas.style.cursor,this.canvas.style.cursor='url("https://production.cdn.superviz.com/static/pin-html.png") 0 100, pointer',this.addListeners();return}this.resetPins(),this.removeListeners(),this.canvas.style.cursor=this.originalCanvasCursor}}updateAnnotations(i){this.logger.log("updateAnnotations",i),this.annotations=i,!(!this.isActive&&!this.isPinsVisible)&&(this.removeAnnotationsPins(),this.renderAnnotationsPins())}removeAnnotationPin(i){let e=this.pins.get(i);!e||(e.remove(),this.pins.delete(i),i!=="temporary-pin"&&(this.annotations=this.annotations.filter(t=>t.uuid!==i)))}renderTemporaryPin(){let i=document.getElementById("superviz-temporary-pin");i||(i=document.createElement("superviz-comments-annotation-pin"),i.id="superviz-temporary-pin",i.setAttribute("type","add"),i.setAttribute("showInput",""),i.setAttribute("containerSides",JSON.stringify(this.canvasSides)),i.setAttribute("commentsSide",this.commentsSide),i.setAttribute("position",JSON.stringify(this.temporaryPinCoordinates)),i.setAttribute("annotation",JSON.stringify({})),i.setAttribute("participantsList",JSON.stringify(this.participants)),i.setAttributeNode(document.createAttribute("active")),this.divWrapper.appendChild(i));let{x:e,y:t}=this.temporaryPinCoordinates,r=this.canvas.getContext("2d").getTransform(),n=r.e,l=r.f,c=r.a,h=r.d,d=e*c+n,f=t*h+l;i.setAttribute("position",JSON.stringify({x:d,y:f})),this.pins.set("temporary-pin",i)}addListeners(){this.canvas.addEventListener("click",this.onClick),this.canvas.addEventListener("mousedown",this.setMouseDownCoordinates),document.body.addEventListener("toggle-annotation-sidebar",this.onToggleAnnotationSidebar),document.body.addEventListener("click",this.hideTemporaryPin)}removeListeners(){this.canvas.removeEventListener("click",this.onClick),this.canvas.removeEventListener("mousedown",this.setMouseDownCoordinates),document.body.removeEventListener("toggle-annotation-sidebar",this.onToggleAnnotationSidebar),document.body.addEventListener("click",this.hideTemporaryPin)}resetSelectedPin(){!this.selectedPin||(this.selectedPin.removeAttribute("active"),this.selectedPin=null)}renderDivWrapper(){let i=this.canvas.getBoundingClientRect(),e=this.divWrapper;return e||(e=document.createElement("div"),e.id="superviz-canvas-wrapper",["","static"].includes(this.canvas.parentElement.style.position)&&(this.canvas.parentElement.style.position="relative")),e.style.position="absolute",e.style.top=`${this.canvas.offsetTop}px`,e.style.left=`${this.canvas.offsetLeft}px`,e.style.width=`${i.width}px`,e.style.height=`${i.height}px`,e.style.pointerEvents="none",e.style.overflow="hidden",document.getElementById("superviz-canvas-wrapper")||this.canvas.parentElement.appendChild(e),e}renderAnnotationsPins(){if((!this.annotations.length||this.canvas.style.display==="none")&&!this.pins.get("temporary-pin")){this.removeAnnotationsPins();return}this.annotations.forEach(i=>{if(i.resolved)return;let e=JSON.parse(i.position);if((e==null?void 0:e.type)!=="canvas")return;let{x:t,y:r}=e,n=this.canvas.getContext("2d").getTransform(),l=n.e,c=n.f,h=n.a,d=n.d,f=t*h+l,m=r*d+c;if(this.pins.has(i.uuid)){let y=this.pins.get(i.uuid);if(this.divWrapper.clientWidth>f&&this.divWrapper.clientHeight>m){y.setAttribute("style","opacity: 1"),this.pins.get(i.uuid).setAttribute("position",JSON.stringify({x:f,y:m}));return}y.setAttribute("style","opacity: 0");return}let g=document.createElement("superviz-comments-annotation-pin");g.setAttribute("type","show"),g.setAttribute("participantsList",JSON.stringify(this.participants)),g.setAttribute("annotation",JSON.stringify(i)),g.setAttribute("position",JSON.stringify({x:f,y:m})),g.id=i.uuid,this.divWrapper.appendChild(g),this.pins.set(i.uuid,g)})}removeAnnotationsPins(){this.pins.forEach(i=>{i.remove()}),this.pins.clear()}set participantsList(i){this.participants=i}goToPin(i){let e=this.annotations.find(y=>y.uuid===i);if(!e)return;let t=JSON.parse(e.position);if((t==null?void 0:t.type)!=="canvas")return;let r=this.canvas.getBoundingClientRect(),{width:n,height:l}=r,{x:c,y:h}=t,d=n/2,f=l/2,m=d-c,g=f-h;this.goToPinCallback&&this.goToPinCallback({x:m,y:g})}};nt();var k0e=class{constructor(e,t={}){if(this.isPinsVisible=!0,this.selectedPin=null,this.dataAttribute="data-superviz-id",this.commentsSide="left",this.temporaryPinCoordinates={},this.elementsWithDataId={},this.divWrappers=new Map,this.voidElementsWrappers=new Map,this.VOID_ELEMENTS=["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr","svg","rect","ellipse"],this.animate=()=>{this.voidElementsWrappers&&(this.updatePinsPositions(),this.animateFrame=requestAnimationFrame(this.animate))},this.setCommentsMetadata=l=>{this.commentsSide=l},this.hideTemporaryPin=l=>{var c;let h=l.target,d=this.divWrappers.get(this.temporaryPinCoordinates.elementId);if(!d)return;let f=d.contains(h),m=(c=this.pins.get("temporary-pin"))==null?void 0:c.contains(h);f||m||(this.removeAnnotationPin("temporary-pin"),this.temporaryPinCoordinates={})},this.resetPins=l=>{l&&(l==null?void 0:l.key)!=="Escape"||(this.resetSelectedPin(),this.resetHoveredWrapper(),this.temporaryPinCoordinates.elementId&&(this.removeAnnotationPin("temporary-pin"),this.temporaryPinCoordinates={}))},this.annotationSelected=({detail:{uuid:l,newPin:c}})=>{if(!l)return;c&&this.pins.get(l).setAttribute("newPin","");let h=this.annotations.find(m=>{var g;return m.uuid===((g=this.selectedPin)==null?void 0:g.id)});if(this.resetPins(),(h==null?void 0:h.uuid)===l)return;document.body.dispatchEvent(new CustomEvent("close-temporary-annotation"));let d=this.pins.get(l);if(!d)return;d.setAttribute("active",""),this.selectedPin=d;let f=this.annotations.find(m=>m.uuid===l);this.selectedPin.setAttribute("elementId",JSON.parse(f.position).elementId)},this.onClick=l=>{if(!this.isActive||l.target===this.pins.get("temporary-pin"))return;let c=l.target,h=l.currentTarget;if(c!==h&&this.pins.has(c.id))return;let d=h.getAttribute("data-wrapper-id"),f=h.getBoundingClientRect(),{x:m,y:g}=this.mouseDownCoordinates,y=l.clientX-f.left,_=l.clientY-f.top,b=m-f.x,S=g-f.y;if(Math.hypot(y-b,_-S)>10)return;let{width:E,height:T}=h.getBoundingClientRect(),A=32,P=h.getBoundingClientRect().width/h.offsetWidth||1;y=y*100/E,_=(_-A*P)*100/T,this.onPinFixedObserver.publish({x:y,y:_,type:"html",elementId:d}),this.resetSelectedPin(),this.temporaryPinCoordinates=Ia(ir({},this.temporaryPinCoordinates),{x:y,y:_}),this.renderTemporaryPin(d);let O=this.pins.get("temporary-pin");this.movedTemporaryPin=!this.movedTemporaryPin,O.setAttribute("movedPosition",String(this.movedTemporaryPin)),document.body.dispatchEvent(new CustomEvent("unselect-annotation"))},this.onMouseDown=({x:l,y:c})=>{this.mouseDownCoordinates={x:l,y:c}},this.handleMutationObserverChanges=l=>{l.forEach(c=>{var h;let{target:d,oldValue:f}=c,m=d.getAttribute(this.dataAttribute);if(!m&&!f||m===f)return;let g=this.dataAttributeValueFilters.some(_=>f.match(_));if(!m&&f&&!g){this.removeAnnotationPin("temporary-pin"),this.clearElement(f),((h=this.selectedPin)==null?void 0:h.getAttribute("elementId"))===f&&(document.body.dispatchEvent(new CustomEvent("unselect-annotation")),this.selectedPin=null);return}let y=this.dataAttributeValueFilters.some(_=>m.match(_));(f&&this.elementsWithDataId[f]||y)&&this.clearElement(f),!y&&(this.setElementReadyToPin(d,m),this.renderAnnotationsPins())})},this.onToggleAnnotationSidebar=({detail:l})=>{let{open:c}=l;c||(this.resetSelectedPin(),this.pins.has("temporary-pin")&&(this.removeAnnotationPin("temporary-pin"),this.temporaryPinCoordinates.elementId=void 0))},this.onMouseEnter=l=>{var c;let h=l.target;if(this.hoveredWrapper=h,!((c=h.getAttribute("data-wrapper-type"))!=null&&c.includes("ellipse"))){this.hoveredWrapper.style.setProperty("outline","1px solid rgb(var(--sv-primary))");return}let d=h.querySelector("ellipse");d.setAttribute("stroke","rgb(var(--sv-primary))"),d.setAttribute("stroke-width","1")},this.onMouseLeave=l=>{var c;let h=l.target;if(this.hoveredWrapper=h,!((c=h.getAttribute("data-wrapper-type"))!=null&&c.includes("ellipse"))){this.hoveredWrapper.style.setProperty("outline","");return}let d=h.querySelector("ellipse");d.removeAttribute("stroke"),d.removeAttribute("stroke-width")},this.logger=new eu("@superviz/sdk/comments-component/container-pin-adapter"),this.container=document.getElementById(e),!this.container){let l=`Element with id ${e} not found`;throw this.logger.log(l),new Error(l)}if(typeof t!="object")throw new Error("Second argument of the HTMLPin constructor must be an object");let{dataAttributeName:r,dataAttributeValueFilters:n}=t;if(r==="")throw new Error("dataAttributeName must be a non-empty string");if(r===null)throw new Error("dataAttributeName cannot be null");if(r!==void 0&&typeof r!="string")throw new Error("dataAttributeName must be a non-empty string");this.dataAttribute=r||this.dataAttribute,this.dataAttributeValueFilters=n||[],this.isActive=!1,this.prepareElements(),this.mutationObserver=new MutationObserver(this.handleMutationObserverChanges),this.observeContainer(),this.pins=new Map,this.onPinFixedObserver=new yr({logger:this.logger}),this.annotations=[],document.body.addEventListener("select-annotation",this.annotationSelected),document.body.addEventListener("keyup",this.resetPins),this.voidElementsWrappers.size&&(this.animateFrame=requestAnimationFrame(this.animate))}destroy(){var e;this.logger.log("Destroying HTML Pin Adapter for Comments"),this.removeListeners(),this.removeObservers(),this.divWrappers.forEach(t=>t.remove()),this.divWrappers.clear(),this.pins.forEach(t=>t.remove()),this.pins.clear(),this.divWrappers=void 0,this.pins=void 0,this.elementsWithDataId=void 0,this.logger=void 0,this.onPinFixedObserver.destroy(),this.onPinFixedObserver=void 0,this.container=void 0,this.voidElementsWrappers.clear(),this.voidElementsWrappers=void 0,this.annotations=[],(e=this.svgWrappers)==null||e.remove(),this.svgWrappers=void 0,document.body.removeEventListener("select-annotation",this.annotationSelected),document.body.removeEventListener("toggle-annotation-sidebar",this.onToggleAnnotationSidebar),cancelAnimationFrame(this.animateFrame)}addElementListeners(e){this.divWrappers.get(e).addEventListener("click",this.onClick,!0),this.divWrappers.get(e).addEventListener("mousedown",this.onMouseDown),this.divWrappers.get(e).addEventListener("mouseenter",this.onMouseEnter),this.divWrappers.get(e).addEventListener("mouseleave",this.onMouseLeave)}removeElementListeners(e){this.divWrappers.get(e).removeEventListener("click",this.onClick,!0),this.divWrappers.get(e).removeEventListener("mousedown",this.onMouseDown),this.divWrappers.get(e).removeEventListener("mouseenter",this.onMouseEnter),this.divWrappers.get(e).removeEventListener("mouseleave",this.onMouseLeave)}set participantsList(e){this.participants=e}removeObservers(){this.mutationObserver.disconnect(),this.mutationObserver=void 0}addListeners(){this.divWrappers.forEach((e,t)=>this.addElementListeners(t)),document.body.addEventListener("toggle-annotation-sidebar",this.onToggleAnnotationSidebar),document.body.addEventListener("click",this.hideTemporaryPin)}removeListeners(){this.divWrappers.forEach((e,t)=>this.removeElementListeners(t)),document.body.removeEventListener("keyup",this.resetPins),document.body.removeEventListener("click",this.hideTemporaryPin)}observeContainer(){this.mutationObserver.observe(this.container,{subtree:!0,attributes:!0,attributeFilter:[this.dataAttribute],attributeOldValue:!0})}prepareElements(){this.container.querySelectorAll(`[${this.dataAttribute}]`).forEach(e=>{let t=e.getAttribute(this.dataAttribute);this.dataAttributeValueFilters.some(r=>t.match(r))||this.setElementReadyToPin(e,t)})}addAllCursors(){this.divWrappers.forEach((e,t)=>{this.addCursor(e,t)})}removeAddCursor(){this.divWrappers.forEach((e,t)=>{let r=e,n=e.getAttribute("data-wrapper-type");if(n){let l=n.split("-")[1];r=this.divWrappers.get(t).querySelector(l)}r.style.setProperty("cursor","default"),r.style.setProperty("pointer-events","none")})}setPinsVisibility(e){this.isPinsVisible=e,this.isPinsVisible&&this.renderAnnotationsPins(),this.removeAnnotationsPins()}removeAnnotationPin(e){let t=this.pins.get(e);!t&&e==="temporary-pin"||(t&&(t.remove(),this.pins.delete(e)),e!=="temporary-pin"&&(this.annotations=this.annotations.filter(r=>r.uuid!==e)))}updateAnnotations(e){this.logger.log("updateAnnotations",e),this.annotations=e,this.isPinsVisible&&(this.removeAnnotationsPins(),this.renderAnnotationsPins())}setActive(e){if(this.isActive!==e){if(this.isActive=e,this.isActive){this.addListeners(),this.addAllCursors(),this.prepareElements();return}this.resetPins(),this.removeListeners(),this.removeAddCursor()}}renderTemporaryPin(e){var t,r;(t=this.temporaryPinCoordinates).elementId||(t.elementId=e);let n=this.pins.get("temporary-pin");if(e&&e!==this.temporaryPinCoordinates.elementId&&(this.pins.get("temporary-pin").remove(),this.pins.delete("temporary-pin"),this.temporaryPinCoordinates.elementId=e,n=null),!n){let h=(r=this.elementsWithDataId[e])==null?void 0:r.getBoundingClientRect();n=document.createElement("superviz-comments-annotation-pin"),n.id="superviz-temporary-pin",n.setAttribute("type","add"),n.setAttribute("showInput",""),n.setAttribute("containerSides",JSON.stringify(h)),n.setAttribute("commentsSide",this.commentsSide),n.setAttribute("position",JSON.stringify(this.temporaryPinCoordinates)),n.setAttribute("annotation",JSON.stringify({})),n.setAttribute("participantsList",JSON.stringify(this.participants)),n.setAttribute("keepPositionRatio",""),n.setAttributeNode(document.createAttribute("active")),this.addTemporaryPinToElement(e,n)}let{x:l,y:c}=this.temporaryPinCoordinates;n.setAttribute("position",JSON.stringify({x:l,y:c})),this.pins.set("temporary-pin",n)}renderAnnotationsPins(){if(!this.annotations.length){this.removeAnnotationsPins();return}this.annotations.forEach(e=>{if(e.resolved)return;let{x:t,y:r,elementId:n,type:l}=JSON.parse(e.position);if(l!=="html"||this.pins.has(e.uuid)||!this.elementsWithDataId[n])return;let c=this.divWrappers.get(n);if(!c)return;let h=this.createPin(e,t,r);c.appendChild(h),this.pins.set(e.uuid,h)})}updatePinsPositions(){this.voidElementsWrappers.forEach((e,t)=>{let r=JSON.stringify(e.getBoundingClientRect()),n=this.elementsWithDataId[t].getBoundingClientRect();this.elementsWithDataId[t].tagName.toLowerCase()==="ellipse"&&(n=this.elementsWithDataId[t].viewportElement.getBoundingClientRect()),!Pp.isEqual(JSON.stringify(n),r)&&(e.style.setProperty("top",`${n.top}px`),e.style.setProperty("left",`${n.left}px`),e.style.setProperty("width",`${n.width}px`),e.style.setProperty("height",`${n.height}px`))})}clearElement(e){if(!this.elementsWithDataId[e])return;let t=this.divWrappers.get(e);if(t){let r=t.children,{length:n}=r;for(let l=0;l<n;++l){let c=r.item(l);this.pins.delete(c.id)}t.remove()}this.voidElementsWrappers.delete(e),this.removeElementListeners(e),this.divWrappers.delete(e),this.elementsWithDataId[e]=void 0,this.voidElementsWrappers.size||(cancelAnimationFrame(this.animateFrame),this.animateFrame=void 0)}resetSelectedPin(){!this.selectedPin||(this.selectedPin.removeAttribute("active"),this.selectedPin=null)}resetHoveredWrapper(){!this.hoveredWrapper||this.onMouseLeave({target:this.hoveredWrapper})}removeAnnotationsPins(){this.pins.forEach(e=>{e.remove()}),this.pins.clear()}setElementReadyToPin(e,t){if(!this.elementsWithDataId[t]){if(this.elementsWithDataId[t]=e,!this.divWrappers.get(t)){let r=this.createWrapper(e,t);this.divWrappers.set(t,r)}!this.isActive||!this.isPinsVisible||(this.addCursor(this.divWrappers.get(t),t),this.addElementListeners(t))}}handleSvgElement(e,t){let r=e.viewportElement;if(r===void 0)return;if(e.tagName.toLowerCase()==="svg"){let _=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");return _.setAttribute("height","100%"),_.setAttribute("width","100%"),_.style.setProperty("overflow","visible"),_.appendChild(t),e.appendChild(_),e.style.setProperty("overflow","visible"),t}let n=e.tagName.toLowerCase(),l=n==="ellipse",c=n==="rect";if(!l&&!c)return;let h=document.createElementNS("http://www.w3.org/2000/svg","svg"),d=document.createElementNS("http://www.w3.org/2000/svg",n),f,m,g,y;if(c){let _=e;_.getAttribute("x"),_.getAttribute("y"),f=_.getAttribute("width"),m=_.getAttribute("height"),g=_.getAttribute("rx"),y=_.getAttribute("ry"),d.setAttribute("fill","transparent"),d.setAttribute("stroke","transparent"),d.setAttribute("x","0"),d.setAttribute("y","0"),d.setAttribute("rx",g),d.setAttribute("ry",y)}if(l){let _=e.getAttribute("cx"),b=e.getAttribute("cy");g=e.getAttribute("rx"),y=e.getAttribute("ry");let{width:S,height:E}=r.getBoundingClientRect();f=`${S}px`,m=`${E}px`,d.setAttribute("fill","transparent"),d.setAttribute("stroke","transparent"),d.setAttribute("cx",_),d.setAttribute("cy",b),d.setAttribute("rx",g),d.setAttribute("ry",y)}return d.setAttribute("height",m),d.setAttribute("width",f),h.setAttribute("height",m),h.setAttribute("width",f),h.appendChild(d),t.appendChild(h),e.style.setProperty("overflow","visible"),t.setAttribute("data-wrapper-type",`svg-${n}`),t}addTemporaryPinToElement(e,t){if(!this.elementsWithDataId[e])return;let r=this.divWrappers.get(e);!r||r.appendChild(t)}createPin(e,t,r){let n=document.createElement("superviz-comments-annotation-pin");return n.setAttribute("type","show"),n.setAttribute("annotation",JSON.stringify(e)),n.setAttribute("position",JSON.stringify({x:t,y:r})),n.setAttribute("keepPositionRatio",""),n.setAttribute("participantsList",JSON.stringify(this.participants)),n.id=e.uuid,n}addCursor(e,t){let r=e,n=e.getAttribute("data-wrapper-type");if(n){let l=n.split("-")[1];r=this.divWrappers.get(t).querySelector(l)}r.style.setProperty("cursor",'url("https://production.cdn.superviz.com/static/pin-html.png") 0 100, pointer'),r.style.setProperty("pointer-events","auto")}createWrapper(e,t){var r;let n=`superviz-id-${t}`;if(this.divWrappers.get(t))return;let l=e.getBoundingClientRect(),c=document.createElement("div");c.setAttribute("data-wrapper-id",t),c.id=n,c.style.position="absolute",c.style.pointerEvents="none",c.style.transform="translateX(0) translateY(0) scale(1)",c.style.cursor="default",c.style.top="0",c.style.left="0",c.style.width="100%",c.style.height="100%",c.style.pointerEvents="none";let h=window.getComputedStyle(e).getPropertyValue("border-radius");if(c.style.borderRadius=h,!this.VOID_ELEMENTS.includes(this.elementsWithDataId[t].tagName.toLowerCase()))return this.elementsWithDataId[t].appendChild(c),this.setPositionNotStatic(this.elementsWithDataId[t]),c;c=(r=this.handleSvgElement(e,c))!=null?r:c,c.style.position="fixed",c.style.top=`${l.top}px`,c.style.left=`${l.left}px`,c.style.width=`${l.width}px`,c.style.height=`${l.height}px`;let d=this.elementsWithDataId[t].parentElement;return(!d||e.viewportElement)&&(d=document.body),this.setPositionNotStatic(d),d.appendChild(c),this.voidElementsWrappers.set(t,c),this.animateFrame||(this.animateFrame=requestAnimationFrame(this.animate)),c}setPositionNotStatic(e){let{position:t}=window.getComputedStyle(e);t==="static"&&e.style.setProperty("position","relative")}};nt();nt();var F0e=class{constructor(){this.browser=qf.getParser(navigator.userAgent)}get clientStats(){return this.browser.getResult()}get isFirefox(){return this.browser.isBrowser(qf.BROWSER_MAP.firefox)}get isSafari(){return this.browser.isBrowser(qf.BROWSER_MAP.safari)}get isChrome(){return this.browser.isBrowser(qf.BROWSER_MAP.chrome)}get isIE(){return this.browser.isBrowser(qf.BROWSER_MAP.ie)}get isEdge(){return this.browser.isBrowser(qf.BROWSER_MAP.edge)}get isMobileDevice(){return(this.browser.is(qf.PLATFORMS_MAP.mobile)||this.browser.is(qf.PLATFORMS_MAP.tablet))&&!navigator.userAgent.match(/iPad/i)}get isTabletDevice(){return this.browser.is(qf.PLATFORMS_MAP.tablet)}get isAndroid(){return this.isMobileDevice&&!!navigator.userAgent.match(/Android/i)}get isIpad(){return!!navigator.userAgent.match(/iPad/i)}get isIphone(){return this.isMobileDevice&&!!navigator.userAgent.match(/iPhone/i)}get isAppleMobileDevice(){return this.isIpad||this.isIphone}};nt();var z0e=class{constructor(){this.updateMeetingConnectionStatus=e=>{this.oldConnectionStatus=this.connectionStatus,this.connectionStatus=e,this.connectionStatusObserver.publish(e),this.logger.log("CONNECTION STATUS CHANGE",e)},this.onUpdateBrowserOnlineStatus=e=>{let{type:t}=e;if(t==="online"){this.updateMeetingConnectionStatus(1);return}this.updateMeetingConnectionStatus(4)},this.logger=new eu("@superviz/sdk/connection-service"),this.connectionStatus=0,this.connectionStatusObserver=new yr({logger:this.logger})}addListeners(){window.addEventListener("online",this.onUpdateBrowserOnlineStatus),window.addEventListener("offline",this.onUpdateBrowserOnlineStatus)}removeListeners(){window.removeEventListener("online",this.onUpdateBrowserOnlineStatus),window.removeEventListener("offline",this.onUpdateBrowserOnlineStatus)}};nt();nt();var B0e=class{build(e,t,r,n={},l={}){let c=document.querySelector(`#${e}`),h=new URL(t);if(this.wrapperId||this.element)throw new Error("Tried to initialize two frames with the same FrameBricklayer instance");this.element=document.createElement("iframe"),Object.entries(n).forEach(([d,f])=>{h.searchParams.set(d,f)}),Object.entries(l).forEach(([d,f])=>{this.element.setAttribute(d,f)}),this.element.src=h.toString(),this.element.id=r,c.appendChild(this.element),this.wrapperId=e}destroy(){if(!this.wrapperId)throw new Error("Tried to destroy a frame before it was initialized");let e=document.querySelector(`#${this.wrapperId}`);e&&e.querySelector(`#${this.element.id}`)&&e.removeChild(this.element),this.wrapperId=null,this.element=null}};nt();var U0e=class{constructor(e){this.observers={},this.sourceBlockList=["vue-devtools-proxy","vue-devtools-backend"],this.originBlockList=["https://sketchfab.com"],this.publish=(h,d={})=>{this.logger.log("MessageBridge","Posting message to frame",h,d),this.contentWindow.postMessage({type:h,data:d},this.allowedOrigins)},this.listen=(h,d)=>{this.observers[h]||(this.observers[h]=new yr({logger:this.logger})),this.observers[h].subscribe(d)},this.onReceiveMessage=h=>{let{type:d,data:f,source:m}=h.data;if(this.sourceBlockList.includes(m)||this.originBlockList.includes(h.origin))return;let g=!!d,y=!this.domains.length||this.domains.includes(h.origin),_=this.observers.hasOwnProperty(d);if(this.logger.log("MessageBridge",`Message received -
        TYPE: ${h.type}
        ORIGIN: ${h.origin}
        DATA: ${JSON.stringify(h.data)} `),!g||!y||!_){this.logger.log("MessageBridge","Message discarded");return}this.observers[d].publish(f)};let{contentWindow:t,domains:r=[],allowedOrigins:n="*",sourceBlockList:l=[],logger:c}=e;if(this.logger=c,this.domains=r,this.allowedOrigins=n,this.sourceBlockList.push(...l),typeof window>"u")throw new Error("MessageBridge: window is undefined");this.contentWindow=t,window.addEventListener("message",this.onReceiveMessage)}destroy(){Object.entries(this.observers).forEach(([e,t])=>{t.reset(),delete this.observers[e]}),window.removeEventListener("message",this.onReceiveMessage),delete this.logger,delete this.allowedOrigins,delete this.contentWindow,delete this.domains,delete this.observers,delete this.sourceBlockList}};nt();var lJ=(i=>(i.RIGHT="right",i.CENTER="center",i.LEFT="left",i))(lJ||{}),uJ=(i=>(i.GRID="grid",i.LIST="list",i))(uJ||{}),cJ=(i=>(i.RIGHT="right",i.LEFT="left",i.TOP="top",i.BOTTOM="bottom",i))(cJ||{}),KV="sv-video-frame",H0e=class{constructor(i){this.logger=new eu("@superviz/sdk/video-conference-manager"),this.frameStateObserver=new yr({logger:this.logger}),this.frameSizeObserver=new yr({logger:this.logger}),this.waitingForHostObserver=new yr({logger:this.logger}),this.realtimeEventsObserver=new yr({logger:this.logger}),this.sameAccountErrorObserver=new yr({logger:this.logger}),this.devicesObserver=new yr({logger:this.logger}),this.meetingStateObserver=new yr({logger:this.logger}),this.meetingConnectionObserver=new yr({logger:this.logger}),this.participantJoinedObserver=new yr({logger:this.logger}),this.participantLeftObserver=new yr({logger:this.logger}),this.participantListObserver=new yr({logger:this.logger}),this.frameState=0,this.layoutModalsAndCamerasConfig=($,H)=>{let X=$,re=H,ae=["left","right","bottom","top"].includes(re),he=["left","right","center"].includes(X);return ae||(re="right"),he||(X="right"),this.browserService.isMobileDevice?(re="bottom",{layoutPosition:X,camerasPosition:re}):(X==="left"&&re==="right"&&(X="right"),X==="right"&&re==="left"&&(X="left"),{layoutPosition:X,camerasPosition:re})},this.onFrameLoad=()=>{this.messageBridge=new U0e({logger:this.logger,contentWindow:this.bricklayer.element.contentWindow}),this.addMessagesListeners(),this.updateFrameState(2),this.updateFrameLocale(),this.updateMeetingAvatars(),this.onWindowResize(),this.setCustomColors(),this.setCallbacks()},this.setFrameOffset=$=>{let H=$??{};["top","bottom","left","right"].forEach(X=>{Object.keys(H).includes(X)||(H[X]=0)}),this.frameOffset=H},this.setCustomColors=()=>{this.customColors&&this.messageBridge.publish("frame.color-list-update",this.customColors),this.styles&&this.messageBridge.publish("frame.styles-update",this.styles)},this.setCallbacks=()=>{if(!this.callbacks)return;let $={onToggleMicrophone:!!this.callbacks.onToggleMicrophone,onToggleCam:!!this.callbacks.onToggleCam,onToggleTranscript:!!this.callbacks.onToggleTranscript,onToggleChat:!!this.callbacks.onToggleChat,onToggleScreenShare:!!this.callbacks.onToggleScreenShare,onClickHangup:!!this.callbacks.onClickHangup,onToggleMeetingSetup:!!this.callbacks.onToggleMeetingSetup};this.messageBridge.listen("callback-called",H=>{var X,re;(re=(X=this.callbacks)[H])==null||re.call(X)}),this.messageBridge.publish("frame.callbacks-update",JSON.stringify($))},this.setFrameStyle=$=>{let H=document.createElement("style"),{bottom:X,left:re,right:ae,top:he}=this.frameOffset;if(H.innerHTML=`
      :root {
        --superviz-offset-top: ${he}px;
        --superviz-offset-right: ${ae}px;
        --superviz-offset-left: ${re}px;
        --superviz-offset-bottom: ${X}px;
      }     
    `,document.head.appendChild(H),this.browserService.isMobileDevice){this.bricklayer.element.classList.add("sv-video-frame--bottom");return}this.bricklayer.element.classList.add(`sv-video-frame--${$}`)},this.onFrameDimensionsUpdate=({width:$,height:H})=>{let X=document.getElementById(KV),{bottom:re,right:ae,left:he,top:pe}=this.frameOffset,de=this.isWaterMarkEnabled?40:0,ee=`${$}px`,se=`${H+de}px`;($>=window.innerWidth||this.isHorizontalCameraEnabled)&&(ee=`calc(100% - ${ae}px - ${he}px)`),H>=window.innerHeight&&(se=`calc(100% - ${pe}px - ${re}px)`),X.style.width=ee,X.style.height=se,this.frameSizeObserver.publish({width:X.offsetWidth,height:X.offsetHeight})},this.onWindowResize=()=>{let{top:$,bottom:H,right:X,left:re}=this.frameOffset,{innerHeight:ae,innerWidth:he}=window,pe=ae-$-H,de=he-X-re;!this.messageBridge||this.messageBridge.publish("frame.parent-window-size-update",{height:pe,width:de})},this.updateFrameLocale=()=>{var $,H;if(!this.frameLocale||!(($=this.frameLocale)!=null&&$.language)&&((H=this.frameLocale)!=null&&H.locales))return;let{language:X,locales:re}=this.frameLocale,ae=re.map(pe=>pe==null?void 0:pe.language),he=["en",...ae];if(X&&!he.includes(X))throw new Error("The default language is not available in the language listing.");this.messageBridge.publish("frame.locales-update",this.frameLocale)},this.updateMeetingAvatars=()=>{this.messageBridge.publish("frame.avatar-list-update",this.meetingAvatars)},this.onParticipantJoined=$=>{this.participantJoinedObserver.publish($)},this.onParticipantLeft=$=>{this.participantLeftObserver.publish($)},this.onMeetingHostChange=$=>{this.realtimeEventsObserver.publish({event:"realtime.host-change",data:$})},this.onMeetingKickParticipant=$=>{this.realtimeEventsObserver.publish({event:"meeting.kick-participant",data:$})},this.onFollowParticipantDidChange=$=>{this.realtimeEventsObserver.publish({event:"realtime.follow-participant",data:$})},this.onGoToDidChange=$=>{this.realtimeEventsObserver.publish({event:"realtime.go-to-participant",data:$})},this.onGather=()=>{this.realtimeEventsObserver.publish({event:"realtime.gather",data:!0})},this.onGridModeChange=$=>{this.realtimeEventsObserver.publish({event:"realtime.grid-mode-change",data:$})},this.onDrawingChange=$=>{this.realtimeEventsObserver.publish({event:"realtime.drawing-change",data:$})},this.onTranscriptChange=$=>{this.realtimeEventsObserver.publish({event:"realtime.transcript-change",data:$})},this.onSameAccountError=$=>{this.sameAccountErrorObserver.publish($)},this.onDevicesChange=$=>{this.devicesObserver.publish($)},this.meetingStateUpdate=$=>{this.meetingStateObserver.publish($)},this.onConnectionStatusChange=$=>{this.meetingConnectionObserver.publish($)},this.onWaitingForHostDidChange=$=>{this.waitingForHostObserver.publish($)},this.onParticipantListUpdate=$=>{this.participantListObserver.publish($)};var e,t,r,n;let{language:l,canUseCams:c,canUseChat:h,canUseScreenshare:d,canUseDefaultAvatars:f,canUseFollow:m,canUseGoTo:g,canUseGather:y,canShowAudienceList:_,canUseDefaultToolbar:b,canUseTranscription:S,browserService:E,offset:T,locales:A,avatars:P,customColors:O,styles:R,waterMark:D,layoutPosition:L,camerasPosition:N,skipMeetingSettings:U,devices:F,layoutMode:z,collaborationMode:G,callbacks:J}=i;this.browserService=E;let Z=this.layoutModalsAndCamerasConfig(L,N),q=document.createElement("div");this.frameConfig={apiKey:Fi.get("apiKey"),apiUrl:Fi.get("apiUrl"),ablyKey:Fi.get("ablyKey"),debug:Fi.get("debug"),roomId:Fi.get("roomId"),limits:Fi.get("limits"),collaborationMode:G,canUseFollow:m,canUseGoTo:g,canUseCams:c,canUseChat:h,canUseGather:y,canUseScreenshare:d,canUseDefaultAvatars:f,canUseTranscription:S,canShowAudienceList:_,camerasPosition:(e=Z.camerasPosition)!=null?e:"right",canUseDefaultToolbar:b,devices:{audioInput:(t=F==null?void 0:F.audioInput)!=null?t:!0,audioOutput:(r=F==null?void 0:F.audioOutput)!=null?r:!0,videoInput:(n=F==null?void 0:F.videoInput)!=null?n:!0},waterMark:D,layoutMode:z,skipMeetingSettings:U,layoutPosition:Z.layoutPosition},this.customColors=O,this.callbacks=J,this.styles=R,q.classList.add("sv_video_wrapper"),q.id="sv-video-wrapper",document.body.appendChild(q),this.updateFrameState(1),this.bricklayer=new B0e,this.bricklayer.build(q.id,Fi.get("conferenceLayerUrl"),KV,void 0,{allow:"camera *;microphone *; display-capture *;"}),this.setFrameOffset(T),this.setFrameStyle(Z.camerasPosition),this.bricklayer.element.addEventListener("load",this.onFrameLoad),this.frameLocale={language:l,locales:A},this.meetingAvatars=P,window.addEventListener("resize",this.onWindowResize),window.addEventListener("orientationchange",this.onWindowResize)}get isWaterMarkEnabled(){return this.browserService.isMobileDevice?!1:this.frameConfig.waterMark}get isHorizontalCameraEnabled(){return this.browserService.isMobileDevice?!1:["top","bottom"].includes(this.frameConfig.camerasPosition)}addMessagesListeners(){this.messageBridge.listen("meeting.waiting-for-host",this.onWaitingForHostDidChange),this.messageBridge.listen("meeting.participant-joined",this.onParticipantJoined),this.messageBridge.listen("meeting.participant-list-update",this.onParticipantListUpdate),this.messageBridge.listen("meeting.participant-left",this.onParticipantLeft),this.messageBridge.listen("meeting.host-change",this.onMeetingHostChange),this.messageBridge.listen("meeting.kick-participant",this.onMeetingKickParticipant),this.messageBridge.listen("meeting.same-participant-error",this.onSameAccountError),this.messageBridge.listen("meeting.state-update",this.meetingStateUpdate),this.messageBridge.listen("meeting.connection-status-change",this.onConnectionStatusChange),this.messageBridge.listen("meeting.devices-change",this.onDevicesChange),this.messageBridge.listen("realtime.grid-mode-change",this.onGridModeChange),this.messageBridge.listen("realtime.drawing-change",this.onDrawingChange),this.messageBridge.listen("realtime.transcript-change",this.onTranscriptChange),this.messageBridge.listen("frame.dimensions-update",this.onFrameDimensionsUpdate),this.messageBridge.listen("realtime.follow-participant",this.onFollowParticipantDidChange),this.messageBridge.listen("realtime.go-to-participant",this.onGoToDidChange),this.messageBridge.listen("realtime.gather",this.onGather)}updateFrameState(i){i!==this.frameState&&(this.frameState=i,this.frameStateObserver.publish(this.frameState));let e={1:6,2:7,0:8};this.meetingStateUpdate(e[i])}start(i){this.messageBridge.publish("meeting.start",Ia(ir({},i),{config:this.frameConfig}))}leave(){this.messageBridge.publish("meeting.leave"),this.destroy()}destroy(){var i,e,t,r,n,l,c,h,d,f;(i=this.messageBridge)==null||i.destroy(),(e=this.bricklayer)==null||e.destroy(),(t=this.frameSizeObserver)==null||t.destroy(),(r=this.realtimeEventsObserver)==null||r.destroy(),(n=this.sameAccountErrorObserver)==null||n.destroy(),(l=this.devicesObserver)==null||l.destroy(),(c=this.meetingStateObserver)==null||c.destroy(),(h=this.meetingConnectionObserver)==null||h.destroy(),(d=this.participantJoinedObserver)==null||d.destroy(),(f=this.participantLeftObserver)==null||f.destroy(),this.bricklayer=null,this.frameState=null,window.removeEventListener("resize",this.onWindowResize),window.removeEventListener("orientationchange",this.onWindowResize)}publishMessageToFrame(i,e){!this.messageBridge||this.messageBridge.publish(i,e)}},$0e=1e3*60,oT=null,V0e=class extends ww{constructor(i){var e,t;super(),this.participantToFrameList=[],this.participantsOnMeeting=[],this.kickParticipantsOnHostLeave=!1,this.startVideo=()=>{var l,c,h,d,f,m,g,y,_,b,S,E,T,A,P,O,R,D,L,N,U,F,z,G,J,Z,q,$,H,X,re,ae,he,pe,de,ee,se;this.videoConfig={language:(l=this.params)==null?void 0:l.language,canUseTranscription:((c=this.params)==null?void 0:c.transcriptOff)===!1,canShowAudienceList:(d=(h=this.params)==null?void 0:h.showAudienceList)!=null?d:!0,canUseChat:!((f=this.params)!=null&&f.chatOff),canUseCams:!((m=this.params)!=null&&m.camsOff),canUseScreenshare:!((g=this.params)!=null&&g.screenshareOff),canUseDefaultAvatars:!!((y=this.params)!=null&&y.defaultAvatars)&&!((b=(_=this.localParticipant)==null?void 0:_.avatar)!=null&&b.model3DUrl),canUseGather:!!((S=this.params)!=null&&S.enableGather),canUseFollow:!!((E=this.params)!=null&&E.enableFollow),canUseGoTo:!!((T=this.params)!=null&&T.enableGoTo),canUseDefaultToolbar:(P=(A=this.params)==null?void 0:A.defaultToolbar)!=null?P:!0,camerasPosition:(R=(O=this.params)==null?void 0:O.collaborationMode)==null?void 0:R.position,devices:(D=this.params)==null?void 0:D.devices,skipMeetingSettings:(L=this.params)==null?void 0:L.skipMeetingSettings,browserService:this.browserService,offset:(N=this.params)==null?void 0:N.offset,locales:(F=(U=this.params)==null?void 0:U.locales)!=null?F:[],avatars:(G=(z=this.params)==null?void 0:z.avatars)!=null?G:[],customColors:Fi.get("colors"),waterMark:Fi.get("waterMark"),styles:(J=this.params)==null?void 0:J.styles,collaborationMode:($=(q=(Z=this.params)==null?void 0:Z.collaborationMode)==null?void 0:q.enabled)!=null?$:!0,layoutPosition:((X=(H=this.params)==null?void 0:H.collaborationMode)==null?void 0:X.enabled)===!1?"center":(he=(ae=(re=this.params)==null?void 0:re.collaborationMode)==null?void 0:ae.modalPosition)!=null?he:"center",layoutMode:(ee=(de=(pe=this.params)==null?void 0:pe.collaborationMode)==null?void 0:de.initialView)!=null?ee:"list",callbacks:(se=this.params)==null?void 0:se.callbacks},this.logger.log("video conference @ start video",this.videoConfig),this.videoManager=new H0e(this.videoConfig),this.subscribeToVideoEvents()},this.subscribeToVideoEvents=()=>{this.logger.log("video conference @ subscribe to video events"),this.videoManager.meetingConnectionObserver.subscribe(this.connectionService.updateMeetingConnectionStatus),this.videoManager.participantListObserver.subscribe(this.onParticipantListUpdate),this.videoManager.waitingForHostObserver.subscribe(this.onWaitingForHost),this.videoManager.frameSizeObserver.subscribe(this.onFrameSizeDidChange),this.videoManager.meetingStateObserver.subscribe(this.onMeetingStateChange),this.videoManager.frameStateObserver.subscribe(this.onFrameStateChange),this.videoManager.realtimeEventsObserver.subscribe(this.onRealtimeEventFromFrame),this.videoManager.participantJoinedObserver.subscribe(this.onParticipantJoined),this.videoManager.participantLeftObserver.subscribe(this.onParticipantLeft),this.videoManager.sameAccountErrorObserver.subscribe(this.onSameAccountError),this.videoManager.devicesObserver.subscribe(this.onDevicesChange)},this.unsubscribeFromVideoEvents=()=>{this.logger.log("video conference @ unsubscribe from video events"),this.videoManager.meetingConnectionObserver.unsubscribe(this.connectionService.updateMeetingConnectionStatus),this.videoManager.participantListObserver.unsubscribe(this.onParticipantListUpdate),this.videoManager.waitingForHostObserver.unsubscribe(this.onWaitingForHost),this.videoManager.frameSizeObserver.unsubscribe(this.onFrameSizeDidChange),this.videoManager.meetingStateObserver.unsubscribe(this.onMeetingStateChange),this.videoManager.frameStateObserver.unsubscribe(this.onFrameStateChange),this.videoManager.realtimeEventsObserver.unsubscribe(this.onRealtimeEventFromFrame),this.videoManager.participantJoinedObserver.unsubscribe(this.onParticipantJoined),this.videoManager.participantLeftObserver.unsubscribe(this.onParticipantLeft),this.videoManager.sameAccountErrorObserver.unsubscribe(this.onSameAccountError),this.videoManager.devicesObserver.unsubscribe(this.onDevicesChange)},this.suscribeToRealtimeEvents=()=>{this.logger.log("video conference @ subscribe to realtime events"),this.realtime.kickAllParticipantsObserver.subscribe(this.onKickAllParticipantsDidChange),this.realtime.kickParticipantObserver.subscribe(this.onKickLocalParticipant),this.realtime.participantJoinedObserver.subscribe(this.onParticipantJoinedOnRealtime),this.realtime.participantLeaveObserver.subscribe(this.onParticipantLeftOnRealtime),this.realtime.roomInfoUpdatedObserver.subscribe(this.onRoomInfoUpdated),this.realtime.participantsObserver.subscribe(this.onRealtimeParticipantsDidChange)},this.unsubscribeFromRealtimeEvents=()=>{this.logger.log("video conference @ unsubscribe from realtime events"),this.realtime.kickAllParticipantsObserver.unsubscribe(this.onKickAllParticipantsDidChange),this.realtime.participantJoinedObserver.unsubscribe(this.onParticipantJoinedOnRealtime),this.realtime.participantLeaveObserver.unsubscribe(this.onParticipantLeftOnRealtime),this.realtime.roomInfoUpdatedObserver.unsubscribe(this.onRoomInfoUpdated),this.realtime.participantsObserver.unsubscribe(this.onRealtimeParticipantsDidChange)},this.createParticipantFromAblyPresence=l=>{var c;return{id:l.clientId,color:this.realtime.getSlotColor((c=l.data)==null?void 0:c.slotIndex).color,avatar:l.data.avatar,type:l.data.type,name:l.data.name,isHost:this.realtime.hostClientId===l.clientId}},this.onFrameSizeDidChange=l=>{this.publish("frame.dimensions-update",l)},this.onWaitingForHost=l=>{this.publish("meeting.waiting-for-host",l)},this.onConnectionStatusChange=l=>{this.logger.log("video conference @ on connection status change",l);let c=[2,4,3,6];c.includes(l)&&this.realtime.freezeSync(!0),c.includes(this.connectionService.oldConnectionStatus)&&!c.includes(l)&&this.realtime.freezeSync(!1),this.publish("meeting.connection-status-change",l)},this.onMeetingStateChange=l=>{this.logger.log("video conference @ on meeting state change",l),this.publish("meeting.state-update",l)},this.onSameAccountError=l=>{this.publish("meeting.same-participant-error",l),this.detach()},this.onDevicesChange=l=>{this.publish("meeting.devices-change",l)},this.onFrameStateChange=l=>{this.logger.log("video conference @ on frame state change",l),l===2&&(this.params.userType!=="guest"&&(this.localParticipant=Object.assign(this.localParticipant,{type:this.params.userType}),this.realtime.updateMyProperties(ir({},this.localParticipant))),this.videoManager.start({group:this.group,participant:this.localParticipant,roomId:Fi.get("roomId")}),this.publish("meeting.start"))},this.onRealtimeEventFromFrame=({event:l,data:c})=>{this.logger.log("video conference @ on realtime event from frame",l,c),{"realtime.host-change":h=>this.realtime.setHost(h),"realtime.gather":h=>this.realtime.setGather(h),"realtime.grid-mode-change":h=>this.realtime.setGridMode(h),"realtime.drawing-change":h=>{this.realtime.setDrawing(h)},"realtime.follow-participant":h=>{this.realtime.setFollowParticipant(h)},"meeting.kick-participant":h=>{this.realtime.setKickParticipant(h)},"realtime.transcript-change":h=>{this.realtime.setTranscript(h)},"realtime.go-to-participant":h=>{this.eventBus.publish("realtime.go-to-participant",h)}}[l](c),this.publish(l,c)},this.onParticipantJoined=l=>{var c;if(this.logger.log("video conference @ on participant joined",l),this.localParticipant=l,this.publish("meeting.participant-joined",l),this.publish("my-participant.joined",l),this.kickParticipantsOnHostLeave=!((c=this.params)!=null&&c.allowGuests),this.videoConfig.canUseDefaultAvatars){this.realtime.updateMyProperties({avatar:l.avatar,name:l.name,type:l.type});return}this.realtime.updateMyProperties({name:l.name,type:l.type})},this.onParticipantLeft=l=>{this.logger.log("video conference @ on participant left",this.localParticipant),this.publish("my-participant.left",this.localParticipant),this.detach()},this.onParticipantListUpdate=l=>{this.logger.log("video conference @ on participant list update",l);let c=l.map(h=>{var d;let f=this.realtime.getParticipants[h.id];return{id:h.id,color:(d=h.color)!=null?d:this.realtime.getSlotColor(f.data.slotIndex).color,avatar:h.avatar,name:h.name,type:h.type,isHost:h.isHost}});Pp.isEqual(this.participantsOnMeeting,c)||(this.publish("meeting.participant-list-update",c),this.participantsOnMeeting.length!==c.length&&this.publish("meeting.amount-of-participants-update",c.length),this.participantsOnMeeting=c)},this.onKickAllParticipantsDidChange=l=>{this.logger.log("video conference @ on kick all participants did change",l),this.publish("meeting.kick-all-participants",l),this.detach()},this.onKickLocalParticipant=()=>{this.logger.log("video conference @ on kick local participant"),this.publish("meeting.kick-participant",this.localParticipant),this.detach()},this.onRoomInfoUpdated=l=>{this.logger.log("video conference @ on room info updated",l);let{isGridModeEnable:c,followParticipantId:h,gather:d,drawing:f,transcript:m,hostClientId:g}=l;this.videoManager.publishMessageToFrame("realtime.host-change",g),this.onHostParticipantDidChange(g),this.videoManager.publishMessageToFrame("realtime.grid-mode-change",c),this.videoManager.publishMessageToFrame("realtime.drawing-change",f),this.videoManager.publishMessageToFrame("realtime.follow-participant",h),this.videoManager.publishMessageToFrame("realtime.transcript-change",m),this.realtime.hostClientId===this.localParticipant.id&&d&&this.realtime.setGather(!1)},this.onRealtimeParticipantsDidChange=l=>{this.logger.log("video conference @ on participants did change",l);let c=Object.values(l).map(h=>({timestamp:h.timestamp,connectionId:h.connectionId,participantId:h.clientId,color:this.realtime.getSlotColor(h.data.slotIndex).name,name:h.data.name,isHost:this.realtime.hostClientId===h.clientId,avatar:h.data.avatar,type:h.data.type}));Pp.isEqual(this.participantToFrameList,c)||this.videoManager.publishMessageToFrame("realtime.participant-list-update",c),this.participantToFrameList=c,this.validateIfInTheRoomHasHost(l)},this.onHostParticipantDidChange=l=>{this.logger.log("video conference @ on host participant did change",l),this.videoManager.publishMessageToFrame("realtime.host-change",l);let c=this.participantsOnMeeting.find(h=>h.id===l);this.publish("meeting.host-change",c)},this.onHostAvailabilityChange=l=>{if(this.logger.log("launcher service @ onHostAvailabilityChange"),l){this.publish("meeting.host-available");return}this.publish("meeting.no-host-available")},this.onParticipantJoinedOnRealtime=l=>{this.logger.log("video conference @ on participant joined on realtime",l),this.publish("meeting.participant-joined",this.createParticipantFromAblyPresence(l))},this.onParticipantLeftOnRealtime=l=>{this.logger.log("video conference @ on participant left on realtime",l),this.publish("meeting.participant-left",this.createParticipantFromAblyPresence(l))},this.validateIfInTheRoomHasHost=l=>{let c=Object.values(l).filter(f=>f.data.type==="host"),h=c.some(f=>f.clientId===this.realtime.hostClientId);if(!c.length&&this.kickParticipantsOnHostLeave&&this.localParticipant.type!=="host"&&!oT&&(this.logger.log("video conference @ validate if in the room has host - init kick all participants timeout"),oT=setTimeout(()=>{this.logger.log("video conference @ validate if in the room has host - kick all participants"),this.onKickLocalParticipant()},$0e)),c.length&&oT&&(this.logger.log("video conference @ validade if in the room has host - clear kick all participants timeout"),clearTimeout(oT),oT=null),this.onHostAvailabilityChange(!!c.length),!c.length||h)return;let d=c.reduce((f,m)=>(this.logger.log("video conference @ validade if in the room has host - reducing participants",{previus:f,current:m}),!f||m.clientId===this.realtime.hostClientId||m.timestamp>f.timestamp?m:f),null);d.clientId===this.realtime.hostClientId||d.clientId!==this.localParticipant.id||(this.logger.log("video conference @ validade if in the room has host - set host",d),this.realtime.setHost(d.clientId))},this.params=Ia(ir({},i),{userType:(t=(e=i==null?void 0:i.participantType)!=null?e:i==null?void 0:i.userType)!=null?t:"guest"}),this.name="videoConference";let{localParticipant:r,group:n}=this.useStore("global-store");r.subscribe(),n.subscribe(),this.logger=new eu("@superviz/sdk/videoConference"),this.browserService=new F0e,this.connectionService=new z0e,this.connectionService.addListeners(),this.connectionService.connectionStatusObserver.subscribe(this.onConnectionStatusChange)}toggleMeetingSetup(){return this.videoManager.publishMessageToFrame("meeting-controls.toggle-setup")}toggleMicrophone(){return this.videoManager.publishMessageToFrame("meeting-controls.toggle-microphone")}toggleCam(){this.videoManager.publishMessageToFrame("meeting-controls.toggle-cam")}toggleScreenShare(){return this.videoManager.publishMessageToFrame("meeting-controls.toggle-screenshare")}toggleChat(){return this.videoManager.publishMessageToFrame("meeting-controls.toggle-chat")}toggleTranscript(){return this.videoManager.publishMessageToFrame("meeting-controls.toggle-transcript")}hangUp(){this.videoManager.publishMessageToFrame("hang-up")}start(){this.logger.log("video conference @ start"),this.suscribeToRealtimeEvents(),this.startVideo()}destroy(){this.logger.log("video conference @ destroy");let{data:i}=this.realtime.participant,e=i.activeComponents.filter(t=>t!=="videoConference");this.realtime.updateMyProperties({activeComponents:e,type:"guest"}),this.kickParticipantsOnHostLeave=!1,this.publish("destroy"),this.unsubscribeFromRealtimeEvents(),this.unsubscribeFromVideoEvents(),this.videoManager.leave(),this.connectionService.removeListeners()}};nt();nt();var W0e=class extends ww{constructor(i,e){var t;if(super(),this.transformation={translate:{x:0,y:0},scale:1},this.subscribeToRealtimeEvents=()=>{this.logger.log("presence-mouse component @ subscribe to realtime events"),this.room.presence.on(bs.JOINED_ROOM,this.onPresenceJoinedRoom),this.room.presence.on(bs.LEAVE,this.onPresenceLeftRoom),this.room.presence.on(bs.UPDATE,this.onPresenceUpdate)},this.unsubscribeFromRealtimeEvents=()=>{this.logger.log("presence-mouse component @ unsubscribe from realtime events"),this.room.presence.off(bs.JOINED_ROOM),this.room.presence.off(bs.LEAVE),this.room.presence.off(bs.UPDATE)},this.setParticipantPrivate=n=>{this.isPrivate=n,this.room.presence.update({visible:!n})},this.onPresenceJoinedRoom=n=>{n.id===this.localParticipant.id&&this.room.presence.update(this.localParticipant)},this.onPresenceLeftRoom=n=>{this.removePresenceMouseParticipant(n.id)},this.onPresenceUpdate=n=>{if(this.following&&this.presences.get(this.following)&&this.goToMouse(this.following),n.id===this.localParticipant.id)return;let l=n.data;if(this.following&&l.id!==this.following&&this.presences.has(l.id)){this.removePresenceMouseParticipant(l.id);return}this.presences.set(l.id,l)},this.animate=()=>{this.renderDivWrapper(),this.updateParticipantsMouses(),requestAnimationFrame(this.animate)},this.goToMouse=n=>{let l=this.presences.get(n);if(!l)return;let c=this.canvas.getBoundingClientRect(),{width:h,height:d}=c,{x:f,y:m}=l,g=h/2,y=d/2,_=g-f,b=y-m;this.goToMouseCallback&&this.goToMouseCallback({x:_,y:b})},this.onMyParticipantMouseMove=Pp.throttle(n=>{let l=this.canvas.getContext("2d"),c=this.canvas.getBoundingClientRect(),h=n.x-c.left,d=n.y-c.top,f=(l==null?void 0:l.getTransform()).inverse(),m=new DOMPoint(h,d).matrixTransform(f),g={x:(m.x-this.transformation.translate.x)/this.transformation.scale,y:(m.y-this.transformation.translate.y)/this.transformation.scale};this.room.presence.update(Ia(ir(ir({},this.localParticipant),g),{visible:!this.isPrivate}))},30),this.onMyParticipantMouseOut=n=>{let{x:l,y:c,width:h,height:d}=this.canvas.getBoundingClientRect();n.x>0&&n.y>0&&n.x<l+h&&n.y<c+d||this.room.presence.update({visible:!1})},this.updateParticipantsMouses=()=>{this.presences.forEach(n=>{if(!(n!=null&&n.visible)||this.following&&this.following!==n.id){this.removePresenceMouseParticipant(n.id);return}this.renderPresenceMouses(n)})},this.renderPresenceMouses=n=>{let l=document.getElementById(`mouse-${n.id}`);l||(l=this.createMouseElement(n));let c=document.getElementById(`mouse-${n.id}`),h=document.getElementById(`mouse-${n.id}`);if(!c||!h)return;let d=c.getElementsByClassName("mouse-user-name")[0],f=h.getElementsByClassName("pointer-mouse")[0];f&&(f.style.backgroundImage=`url(https://production.cdn.superviz.com/static/pointers-v2/${n.slot.index}.svg)`),d&&(d.style.color=n.slot.textColor,d.style.backgroundColor=n.slot.color,d.innerHTML=n.name);let{x:m,y:g}=n,y=this.canvas.getContext("2d"),_=y==null?void 0:y.getTransform(),b=_==null?void 0:_.e,S=_==null?void 0:_.f,E=this.transformation.translate.x+(m+b)*this.transformation.scale,T=this.transformation.translate.y+(g+S)*this.transformation.scale,A=this.divWrapper.clientWidth>E&&this.divWrapper.clientHeight>T&&n.visible;l.style.opacity=A?"1":"0",l.style.left=`${E}px`,l.style.top=`${T}px`},this.followMouse=n=>{this.following=n,this.goToMouse(n)},this.name="presence",this.logger=new eu("@superviz/sdk/presence"),this.canvas=document.getElementById(i),this.presences=new Map,!this.canvas){let n=`Canvas with id ${i} not found`;throw this.logger.log(n),new Error(n)}this.divWrapper=this.renderDivWrapper(),this.animateFrame=requestAnimationFrame(this.animate),this.goToMouseCallback=(t=e==null?void 0:e.callbacks)==null?void 0:t.onGoToPresence;let{localParticipant:r}=this.useStore("global-store");r.subscribe()}start(){this.logger.log("presence-mouse component @ start"),this.canvas.addEventListener("mousemove",this.onMyParticipantMouseMove),this.canvas.addEventListener("mouseout",this.onMyParticipantMouseOut),this.eventBus.subscribe("realtime.go-to-participant",this.goToMouse),this.eventBus.subscribe("realtime.local-follow-participant",this.followMouse),this.eventBus.subscribe("realtime.private-mode",this.setParticipantPrivate),this.subscribeToRealtimeEvents()}destroy(){this.logger.log("presence-mouse component @ destroy"),this.eventBus.unsubscribe("realtime.go-to-participant",this.goToMouse),this.eventBus.unsubscribe("realtime.local-follow-participant",this.followMouse),this.eventBus.unsubscribe("realtime.private-mode",this.setParticipantPrivate),this.unsubscribeFromRealtimeEvents(),cancelAnimationFrame(this.animateFrame),this.canvas.removeEventListener("mousemove",this.onMyParticipantMouseMove),this.canvas.removeEventListener("mouseout",this.onMyParticipantMouseOut),this.divWrapper.remove()}renderDivWrapper(){let i=this.canvas.getBoundingClientRect(),e=document.getElementById("superviz-presence-mouse-wrapper");return e||(e=document.createElement("div"),e.id="superviz-presence-mouse-wrapper",this.canvas.parentElement.style.position="relative",this.canvas.parentElement.appendChild(e)),e.style.position="fixed",e.style.top=`${i.top}px`,e.style.left=`${i.left}px`,e.style.width=`${i.width}px`,e.style.height=`${i.height}px`,e.style.pointerEvents="none",e.style.overflow="hidden",e.style.zIndex="2",e}removePresenceMouseParticipant(i){let e=document.getElementById(`mouse-${i}`);e&&(e.remove(),this.presences.delete(i))}createMouseElement(i){let e=document.createElement("div");e.setAttribute("id",`mouse-${i.id}`),e.setAttribute("class","mouse-follower");let t=document.createElement("div");t.setAttribute("class","pointer-mouse");let r=document.createElement("div");return r.setAttribute("class","mouse-user-name"),r.innerHTML=i.name,e.appendChild(t),e.appendChild(r),e.style.left="0px",e.style.top="0px",this.divWrapper.appendChild(e),e}transform(i){this.transformation=i}};nt();nt();var QF=(i=>(i.AREA="area",i.BASE="base",i.BR="br",i.COL="col",i.EMBED="embed",i.HR="hr",i.IMG="img",i.INPUT="input",i.LINK="link",i.META="meta",i.PARAM="param",i.SOURCE="source",i.TRACK="track",i.WBR="wbr",i))(QF||{}),e4=(i=>(i.RECT="rect",i.ELLIPSE="ellipse",i.SVG="svg",i))(e4||{}),j0e=class extends ww{constructor(i,e){var t;if(super(),this.presences=new Map,this.mouses=new Map,this.transformation={translate:{x:0,y:0},scale:1},this.onMyParticipantMouseMove=n=>{if(this.isPrivate)return;let l=n.currentTarget,{left:c,top:h}=l.getBoundingClientRect(),d=(n.x-c-this.transformation.translate.x)/this.transformation.scale,f=(n.y-h-this.transformation.translate.y)/this.transformation.scale;this.room.presence.update(Ia(ir({},this.localParticipant),{x:d,y:f,visible:!0}))},this.onMyParticipantMouseLeave=n=>{let{left:l,top:c,right:h,bottom:d}=this.container.getBoundingClientRect(),f=n.x>l&&n.y>c&&n.x<h&&n.y<d,m=n.x>0&&n.y>0&&n.x<window.innerWidth&&n.y<window.innerHeight;f&&m||this.room.presence.update({visible:!1})},this.goToMouse=n=>{let l=this.mouses.get(n);if(l){if(this.goToPresenceCallback){let c=this.mouses.get(n),h=Number(c.style.left.replace("px","")),d=Number(c.style.top.replace("px",""));this.goToPresenceCallback({x:h,y:d});return}l.scrollIntoView({block:"center",inline:"center",behavior:"smooth"})}},this.followMouse=n=>{this.userBeingFollowedId=n,this.goToMouse(n)},this.setParticipantPrivate=n=>{this.isPrivate=n,this.room.presence.update({visible:!n})},this.onPresenceJoinedRoom=n=>{n.id===this.localParticipant.id&&this.room.presence.update(this.localParticipant)},this.onPresenceLeftRoom=n=>{this.removePresenceMouseParticipant(n.id)},this.onPresenceUpdate=n=>{if(n.id===this.localParticipant.id)return;let l=n.data;if(this.userBeingFollowedId&&l.id!==this.userBeingFollowedId&&this.presences.has(l.id)){this.removePresenceMouseParticipant(l.id);return}this.presences.set(l.id,l),this.animate(),this.updateParticipantsMouses()},this.animate=()=>{QF[this.containerTagname]&&this.updateVoidElementWrapper(),e4[this.containerTagname]&&this.updateSVGElementWrapper(),this.animationFrame=requestAnimationFrame(this.animate)},this.updateParticipantsMouses=n=>{this.presences.forEach(l=>{if(l.id!==this.localParticipant.id){if(!(l!=null&&l.visible)){this.removePresenceMouseParticipant(l.id);return}this.renderPresenceMouses(l)}}),!n&&this.presences.has(this.userBeingFollowedId)&&this.goToMouse(this.userBeingFollowedId)},this.renderPresenceMouses=n=>{if(n.id===this.localParticipant.id)return;let l=document.getElementById(`mouse-${n.id}`);if(l||(l=this.createMouseElement(n)),!l)return;let c=l.getElementsByClassName("mouse-user-name")[0],h=l.getElementsByClassName("pointer-mouse")[0];h&&(h.style.backgroundImage=`url(https://production.cdn.superviz.com/static/pointers-v2/${n.slot.index}.svg)`),c&&(c.style.color=n.slot.textColor,c.style.backgroundColor=n.slot.color,c.innerHTML=n.name);let{x:d,y:f}=n,{translate:{x:m,y:g},scale:y}=this.transformation;l.style.left=`${m+d*y}px`,l.style.top=`${g+f*y}px`},this.renderVoidElementWrapper=()=>{let n=document.createElement("div"),l=this.container,{width:c,height:h,left:d,top:f}=this.container.getBoundingClientRect();l.offsetLeft-d,l.offsetTop-f,n.style.position="absolute",n.style.width=`${c}px`,n.style.height=`${h}px`,n.style.top=`${f}px`,n.style.left=`${d}px`,n.style.overflow="visible",n.style.pointerEvents="none",this.container.parentElement.appendChild(n),this.wrapper=n},this.renderSVGElementWrapper=()=>{let n=this.containerTagname.toLowerCase();if(n==="svg"){this.createSVGWrapper();return}if(n==="rect"){this.createRectWrapper();return}n==="ellipse"&&this.createEllipseWrapper()},this.container=document.getElementById(i),this.logger=new eu("@superviz/sdk/presence"),!this.container){let n=`Element with id ${i} not found`;throw this.logger.log(n),new Error(n)}this.name="presence";let{localParticipant:r}=this.useStore("global-store");r.subscribe(),this.containerTagname=this.container.tagName.toUpperCase(),this.goToPresenceCallback=(t=e==null?void 0:e.callbacks)==null?void 0:t.onGoToPresence}start(){this.logger.log("presence-mouse component @ start"),this.renderWrapper(),this.addListeners(),this.subscribeToRealtimeEvents(),this.eventBus.subscribe("realtime.private-mode",this.setParticipantPrivate),this.animationFrame=requestAnimationFrame(this.animate),this.eventBus.subscribe("realtime.go-to-participant",this.goToMouse),this.eventBus.subscribe("realtime.local-follow-participant",this.followMouse)}destroy(){cancelAnimationFrame(this.animationFrame),this.logger.log("presence-mouse component @ destroy"),this.removeListeners(),this.wrapper.remove(),this.presences.clear(),this.presences=void 0,this.container=void 0,this.wrapper=void 0,this.unsubscribeFromRealtimeEvents(),this.eventBus.unsubscribe("realtime.private-mode",this.setParticipantPrivate),this.eventBus.unsubscribe("realtime.go-to-participant",this.goToMouse),this.eventBus.unsubscribe("realtime.local-follow-participant",this.followMouse),this.logger=void 0}subscribeToRealtimeEvents(){this.logger.log("presence-mouse component @ subscribe to realtime events"),this.room.presence.on(bs.JOINED_ROOM,this.onPresenceJoinedRoom),this.room.presence.on(bs.LEAVE,this.onPresenceLeftRoom),this.room.presence.on(bs.UPDATE,this.onPresenceUpdate)}unsubscribeFromRealtimeEvents(){this.logger.log("presence-mouse component @ unsubscribe from realtime events"),this.room.presence.off(bs.JOINED_ROOM),this.room.presence.off(bs.LEAVE),this.room.presence.off(bs.UPDATE)}addListeners(){this.pointerMoveObserver=AF(this.container,"pointermove").pipe(dpe(30)).subscribe(this.onMyParticipantMouseMove),this.container.addEventListener("pointerleave",this.onMyParticipantMouseLeave)}removeListeners(){var i;(i=this.pointerMoveObserver)==null||i.unsubscribe(),this.container.removeEventListener("pointerleave",this.onMyParticipantMouseLeave)}setPositionNotStatic(){let{position:i}=window.getComputedStyle(this.container);i==="static"&&this.container.style.setProperty("position","relative")}createMouseElement(i){if(!this.wrapper)return;let e=document.createElement("div");e.setAttribute("id",`mouse-${i.id}`),e.setAttribute("class","mouse-follower");let t=document.createElement("div");t.setAttribute("class","pointer-mouse");let r=document.createElement("div");return r.setAttribute("class","mouse-user-name"),r.innerHTML=i.name,e.appendChild(t),e.appendChild(r),e.style.left="0px",e.style.top="0px",this.wrapper.appendChild(e),this.mouses.set(i.id,e),e}updateSVGPosition(){let i=this.container.parentElement.getBoundingClientRect(),e=this.container.getBoundingClientRect(),t=e.left-i.left,r=e.top-i.top,{width:n,height:l}=this.container.getBoundingClientRect();this.wrapper.style.setProperty("width",`${n}px`),this.wrapper.style.setProperty("height",`${l}px`),this.wrapper.style.setProperty("top",`${r}px`),this.wrapper.style.setProperty("left",`${t}px`)}createSVGWrapper(){let i=document.createElement("div"),e=this.container.parentElement.getBoundingClientRect(),t=this.container.getBoundingClientRect(),r=t.left-e.left,n=t.top-e.top,{width:l,height:c}=this.container.getBoundingClientRect();i.style.position="fixed",i.style.width=`${l}px`,i.style.height=`${c}px`,i.style.top=`${n}px`,i.style.left=`${r}px`,i.style.overflow="visible",i.style.pointerEvents="none",i.id="superviz-svg-wrapper",this.container.parentElement.appendChild(i),this.wrapper=i}createRectWrapper(){let i=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=document.createElementNS("http://www.w3.org/2000/svg","rect"),t=document.createElement("div"),r=this.container.getAttribute("width"),n=this.container.getAttribute("height"),l=this.container.getAttribute("rx"),c=this.container.getAttribute("ry");e.setAttribute("fill","transparent"),e.setAttribute("stroke","transparent"),e.setAttribute("x","0"),e.setAttribute("y","0"),e.setAttribute("rx",l),e.setAttribute("ry",c),e.setAttribute("height",n),e.setAttribute("width",r),i.setAttribute("height",n),i.setAttribute("width",r),i.appendChild(e),t.appendChild(i);let h=this.container.getBoundingClientRect();t.style.position="fixed",t.style.top=`${h.top}px`,t.style.left=`${h.left}px`,t.style.width=`${h.width}px`,t.style.height=`${h.height}px`,t.style.overflow="visible",t.style.pointerEvents="none",t.id="superviz-rect-wrapper";let d=this.container.viewportElement;for(;d.viewportElement;)d=d.viewportElement;d.parentElement.appendChild(t),this.wrapper=t}createEllipseWrapper(){let i=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=document.createElementNS("http://www.w3.org/2000/svg","ellipse"),t=document.createElement("div"),r=this.container.getAttribute("cx"),n=this.container.getAttribute("cy"),l=this.container.getAttribute("rx"),c=this.container.getAttribute("ry"),h=Number(r)-Number(l),d=Number(n)-Number(c),f=String(2*Number(r)),m=String(2*Number(n));e.setAttribute("fill","transparent"),e.setAttribute("stroke","transparent"),e.setAttribute("x","0"),e.setAttribute("y","0"),e.setAttribute("rx",l),e.setAttribute("ry",c),e.setAttribute("cx",`${Number(r)-h}`),e.setAttribute("cy",`${Number(n)-d}`),e.setAttribute("height",m),e.setAttribute("width",f),i.setAttribute("height",m),i.setAttribute("width",f),i.appendChild(e),t.appendChild(i);let g=this.container.getBoundingClientRect();t.style.position="fixed",t.style.top=`${g.top}px`,t.style.left=`${g.left}px`,t.style.width=`${g.width}px`,t.style.height=`${g.height}px`,t.style.overflow="visible",t.style.pointerEvents="none",t.id="superviz-ellipse-wrapper";let y=this.container.viewportElement;for(;y.viewportElement;)y=y.viewportElement;y.parentElement.appendChild(t),this.wrapper=t}transform(i){this.transformation=i,this.updateParticipantsMouses(!0)}updateVoidElementWrapper(){let i=this.container.getBoundingClientRect(),e=this.wrapper.getBoundingClientRect(),t=this.container;if(Pp.isEqual(i,e))return;let r=t.offsetLeft,n=t.offsetTop;this.wrapper.style.setProperty("width",`${i.width}px`),this.wrapper.style.setProperty("height",`${i.height}px`),this.wrapper.style.setProperty("top",`${n}px`),this.wrapper.style.setProperty("left",`${r}px`),this.wrapper.id="superviz-void-wrapper"}updateSVGElementWrapper(){let{left:i,top:e,width:t,height:r}=this.container.getBoundingClientRect(),{left:n,top:l,width:c,height:h}=this.wrapper.getBoundingClientRect();if(!(i===n&&e===l&&t===c&&r===h)){if(this.containerTagname.toLowerCase()==="svg"){this.updateSVGPosition();return}this.wrapper.style.setProperty("width",`${t}px`),this.wrapper.style.setProperty("height",`${r}px`),this.wrapper.style.setProperty("top",`${e}px`),this.wrapper.style.setProperty("left",`${i}px`)}}renderWrapper(){if(!this.wrapper){if(QF[this.containerTagname]){this.renderVoidElementWrapper();return}if(e4[this.containerTagname]){this.renderSVGElementWrapper();return}this.renderElementWrapper()}}removePresenceMouseParticipant(i){let e=document.getElementById(`mouse-${i}`);e&&(e.remove(),this.presences.delete(i),this.mouses.delete(i))}renderElementWrapper(){let i=document.createElement("div");i.style.position="absolute",i.style.width="100%",i.style.height="100%",i.style.top="0",i.style.left="0",i.style.overflow="visible",i.style.pointerEvents="none",this.setPositionNotStatic(),this.container.appendChild(i),this.wrapper=i}},hJ=class{constructor(i,e){let t=document.getElementById(i);if(!t)throw new Error(`[Superviz] Container with id ${i} not found`);return t.tagName.toLowerCase()==="canvas"?new W0e(i,e):new j0e(i,e)}transform(i){}};nt();nt();var dJ=(i=>(i.STARTED="STARTED",i.STOPPED="STOPPED",i))(dJ||{}),fJ=(i=>(i.REALTIME_STATE_CHANGED="realtime-component.state-changed",i))(fJ||{}),G0e=class extends ww{constructor(){super(),this.callbacksToSubscribeWhenJoined=[],this.state="STOPPED",this.publish=UR((t,r)=>{if(Object.values($B).includes(t)){this.publishEventToClient(t,r);return}if(this.state!=="STARTED"){let n=`Realtime component is not started yet. You can't publish event ${t} before start`;this.logger.log(n);return}this.room.emit("message",{name:t,payload:r})},30),this.subscribe=(t,r)=>{if(this.state!=="STARTED"){this.callbacksToSubscribeWhenJoined.push({event:t,callback:r});return}this.observers[t]||(this.observers[t]=new yr),this.observers[t].subscribe(r)},this.unsubscribe=(t,r)=>{!this.observers[t]||this.observers[t].unsubscribe(r)},this.fetchHistory=t=>Zr(this,null,function*(){return this.state!=="STARTED"?(this.logger.log("Realtime component is not started yet. You can't retrieve history before start"),null):yield new Promise((r,n)=>{let l=c=>{var h;(h=c.events)!=null&&h.length||r(null);let d=c.events.reduce((f,m)=>(f[m.data.name]||(f[m.data.name]=[]),f[m.data.name].push({data:m.data.payload,name:m.data.name,participantId:m.presence.id,timestamp:m.timestamp}),f),{});t&&!d[t]&&n(new Error(`Event ${t} not found in the history`)),t&&r(d[t]),r(d)};this.room.history(l)})}),this.publishEventToClient=(t,r)=>{this.logger.log("pubsub service @ publishEventToClient",{event:t,data:r}),this.observers[t]&&this.observers[t].publish(r)},this.name="realtime",this.logger=new eu("@superviz/sdk/realtime-component");let{localParticipant:e}=this.useStore("global-store");e.subscribe()}destroy(){this.logger.log("destroyed"),this.changeState("STOPPED"),this.room.disconnect()}start(){this.logger.log("started"),this.subscribeToRealtimeEvents()}changeState(e){this.logger.log("realtime component @ changeState - state changed",e),this.state=e,this.publishEventToClient("realtime-component.state-changed",this.state)}subscribeToRealtimeEvents(){this.room.presence.on(bs.JOINED_ROOM,e=>{e.id===this.localParticipant.id&&(this.changeState("STARTED"),this.callbacksToSubscribeWhenJoined.forEach(({event:t,callback:r})=>{this.subscribe(t,r)}),this.logger.log("joined room"),this.changeState("STARTED"))}),this.room.on("message",e=>{this.logger.log("message received",e),this.publishEventToClient(e.data.name,{data:e.data.payload,participantId:e.presence.id,name:e.data.name,timestamp:e.timestamp})})}};nt();nt();var pJ=(i=>(i.TOP_LEFT="top-left",i.TOP_RIGHT="top-right",i.BOTTOM_LEFT="bottom-left",i.BOTTOM_RIGHT="bottom-right",i))(pJ||{}),mJ=class extends ww{constructor(i){var e;super(),this.onParticipantListUpdate=f=>{let m=this.filterParticipants(Object.values(f)).map(y=>this.getParticipant(y)),g=this.setParticipants(m);this.setExtras(g)},this.goToMousePointer=({detail:{id:f}})=>{f!==this.localParticipantId&&(this.eventBus.publish("realtime.go-to-participant",f),this.publish("who-is-online.go-to-participant",f))},this.followMousePointer=({detail:f})=>{this.eventBus.publish("realtime.local-follow-participant",f.id),this.following&&this.publish("who-is-online.start-following-participant",this.following),this.following||this.publish("who-is-online.stop-following-participant"),f.source==="extras"&&this.highlightParticipantBeingFollowed(),this.updateParticipantsControls(f.id)},this.setPrivate=({detail:{isPrivate:f,id:m}})=>{let{privateMode:g}=this.useStore("who-is-online-store");g.publish(f),this.eventBus.publish("realtime.private-mode",f),this.realtime.setPrivateWIOParticipant(m,f),f&&this.publish("who-is-online.enter-private-mode"),f||this.publish("who-is-online.leave-private-mode")},this.setFollow=f=>{var m;if(f.clientId===this.localParticipantId)return;let g=(m=f.data)!=null&&m.id?f.data:void 0,{following:y}=this.useStore("who-is-online-store");y.publish(g),this.followMousePointer({detail:{id:g==null?void 0:g.id}})},this.follow=({detail:f})=>{let{everyoneFollowsMe:m}=this.useStore("who-is-online-store");m.publish(!!(f!=null&&f.id)),this.realtime.setFollowWIOParticipant(ir({},f)),this.following&&this.publish("who-is-online.start-follow-me",this.following),this.following||this.publish("who-is-online.stop-follow-me"),this.updateParticipantsControls(f==null?void 0:f.id)},this.stopFollowing=(f,m)=>{var g;if(f.clientId!==((g=this.following)==null?void 0:g.id))return;let{following:y}=this.useStore("who-is-online-store");y.publish(void 0),this.eventBus.publish("realtime.local-follow-participant",void 0),!m&&this.publish("who-is-online.stop-following-participant")},this.gather=f=>{this.realtime.setGatherWIOParticipant(ir({},f.detail)),this.publish("who-is-online.gather-all",f.detail.id)},this.setParticipants=f=>{let{participants:m}=this.useStore("who-is-online-store"),g=f.findIndex(({id:b})=>b===this.localParticipantId),y=f.splice(g,1),_=f.splice(0,3);return m.publish([...y,..._]),f},this.setExtras=f=>{let{extras:m}=this.useStore("who-is-online-store");m.publish(f)},this.name="whoIsOnline",this.logger=new eu("@superviz/sdk/who-is-online-component");let{disablePresenceControls:t,disableGoToParticipant:r,disableFollowParticipant:n,disablePrivateMode:l,disableGatherAll:c,disableFollowMe:h,following:d}=this.useStore("who-is-online-store");if(d.subscribe(),typeof i!="object"){this.position=i??"top-right";return}typeof i=="object"&&(this.position=(e=i.position)!=null?e:"top-right",this.setStyles(i.styles),t.publish(i.disablePresenceControls),r.publish(i.disableGoToParticipant),n.publish(i.disableFollowParticipant),l.publish(i.disablePrivateMode),c.publish(i.disableGatherAll),h.publish(i.disableFollowMe))}start(){let{localParticipant:i}=this.useStore("global-store");i.subscribe(e=>{this.localParticipantId=e.id}),this.subscribeToRealtimeEvents(),this.positionWhoIsOnline(),this.addListeners(),this.realtime.enterWIOChannel(i.value)}destroy(){this.unsubscribeToRealtimeEvents(),this.realtime.leaveWIOChannel(),this.removeListeners(),this.element.remove(),this.element=null}addListeners(){this.element.addEventListener("realtime.local-follow-participant",this.followMousePointer),this.element.addEventListener("realtime.go-to-participant",this.goToMousePointer),this.element.addEventListener("realtime.private-mode",this.setPrivate),this.element.addEventListener("realtime.follow-participant",this.follow),this.element.addEventListener("realtime.gather",this.gather)}removeListeners(){this.element.removeEventListener("realtime.local-follow-participant",this.followMousePointer),this.element.removeEventListener("realtime.go-to-participant",this.goToMousePointer),this.element.removeEventListener("realtime.private-mode",this.setPrivate),this.element.removeEventListener("realtime.follow-participant",this.follow),this.element.removeEventListener("realtime.gather",this.gather),this.room.presence.off(bs.UPDATE)}subscribeToRealtimeEvents(){this.realtime.participantsObserver.subscribe(this.onParticipantListUpdate),this.realtime.participantLeaveObserver.subscribe(this.stopFollowing),this.realtime.privateModeWIOObserver.subscribe(this.onParticipantListUpdate),this.realtime.followWIOObserver.subscribe(this.setFollow),this.realtime.gatherWIOObserver.subscribe(this.goToMousePointer)}unsubscribeToRealtimeEvents(){this.realtime.participantsObserver.unsubscribe(this.onParticipantListUpdate),this.realtime.participantLeaveObserver.unsubscribe(this.stopFollowing),this.realtime.privateModeWIOObserver.unsubscribe(this.onParticipantListUpdate),this.realtime.followWIOObserver.unsubscribe(this.setFollow),this.realtime.gatherWIOObserver.unsubscribe(this.goToMousePointer)}setStyles(i=""){if(!i)return;let e=document.createElement("style");e.textContent=i,e.id="superviz-who-is-online-styles",document.head.appendChild(e)}positionWhoIsOnline(){if(this.element=document.createElement("superviz-who-is-online"),Object.values(pJ).includes(this.position.toLowerCase())){document.body.appendChild(this.element);let[e,t]=this.position.split("-");this.element.position=`${e}: 20px; ${t}: 40px;`;return}let i=document.getElementById(this.position);if(!i){this.element.position="top: 20px; right: 40px;",document.body.appendChild(this.element);return}i.appendChild(this.element),this.element.position="position: relative;"}filterParticipants(i){return i.filter(({data:{activeComponents:e,id:t,isPrivate:r}})=>{if(r&&this.localParticipantId!==t)return this.stopFollowing(t,!0),!1;let n=t===this.localParticipantId;if(n){let l=e==null?void 0:e.some(h=>h.includes("presence")),{joinedPresence:c}=this.useStore("who-is-online-store");c.publish(l)}return(e==null?void 0:e.includes("whoIsOnline"))||n})}getParticipant(i){var e;let{avatar:t,activeComponents:r,participantId:n,name:l}=i.data,c=i.clientId===this.localParticipantId,{slotIndex:h}=i.data,{color:d}=this.realtime.getSlotColor(h),f=this.shouldDisableDropdown({activeComponents:r,participantId:n}),m=!f,g=this.getTooltipData({isLocalParticipant:c,name:l,presenceEnabled:m}),y=this.getAvatar({avatar:t,color:d,name:l,slotIndex:h}),_=(e=this.getControls({participantId:n,presenceEnabled:m}))!=null?e:[];return{id:n,name:l,avatar:y,disableDropdown:f,tooltip:g,controls:_,activeComponents:r,isLocalParticipant:c}}shouldDisableDropdown({activeComponents:i,participantId:e}){let{joinedPresence:{value:t},disablePresenceControls:{value:r},disableFollowMe:{value:n},disableFollowParticipant:{value:l},disableGoToParticipant:{value:c},disableGatherAll:{value:h},disablePrivateMode:{value:d}}=this.useStore("who-is-online-store");return t===!1||r===!0||e===this.localParticipantId&&n&&d&&h||e!==this.localParticipantId&&l&&c?!0:!(i!=null&&i.some(f=>f.toLowerCase().includes("presence")))}getTooltipData({isLocalParticipant:i,name:e,presenceEnabled:t}){let r={name:e};return i&&(r.name+=" (You)"),t&&!i&&(r.info="Click to follow"),r}getAvatar({avatar:i,color:e,name:t,slotIndex:r}){var n,l;let c=i==null?void 0:i.imageUrl,h=(l=(n=t==null?void 0:t.at(0))==null?void 0:n.toUpperCase())!=null?l:"A";return{imageUrl:c,firstLetter:h,color:e,slotIndex:r}}getControls({participantId:i,presenceEnabled:e}){let{disablePresenceControls:t}=this.useStore("who-is-online-store");if(!(t.value||!e))return i===this.localParticipantId?this.getLocalParticipantControls():this.getOtherParticipantsControls(i)}getOtherParticipantsControls(i){var e;let{disableGoToParticipant:t,disableFollowParticipant:r,following:n}=this.useStore("who-is-online-store"),l=[];if(t.value||l.push({label:"go to",icon:"place"}),!r.value){let c=((e=n.value)==null?void 0:e.id)===i,h=c?"unfollow":"follow",d=c?"send-off":"send";l.push({label:h,icon:d})}return l}getLocalParticipantControls(){let{disableFollowMe:{value:i},disableGatherAll:{value:e},disablePrivateMode:{value:t},everyoneFollowsMe:{value:r},privateMode:{value:n}}=this.useStore("who-is-online-store"),l=[];if(e||l.push({label:"gather all",icon:"gather"}),!i){let c=r?"send-off":"send",h=r?"stop followers":"everyone follows me";l.push({label:h,icon:c})}if(!t){let c=n?"eye_inative":"eye",h=n?"leave private mode":"private mode";l.push({label:h,icon:c})}return l}updateParticipantsControls(i){let{participants:e}=this.useStore("who-is-online-store");e.publish(e.value.map(t=>{var r;if(i&&t.id!==i)return t;let{id:n}=t,l=!this.shouldDisableDropdown({activeComponents:t.activeComponents,participantId:n}),c=(r=this.getControls({participantId:n,presenceEnabled:l}))!=null?r:[];return Ia(ir({},t),{controls:c})}))}highlightParticipantBeingFollowed(){let{extras:i,participants:e,following:{value:t}}=this.useStore("who-is-online-store"),r=e.value[0],n=i.value.findIndex(h=>h.id===t.id),l=i.value.splice(n,1)[0];e.value.unshift(r),e.value[1]=l;let c=e.value.pop();i.value.push(c),i.publish(i.value),e.publish(e.value)}};nt();nt();var q0e=class extends ww{constructor(e={}){super(),this.fields={},this.fieldsOriginalOutline={},this.focusList={},this.enabledOutlineFields={},this.enabledRealtimeSyncFields={},this.flags={},this.allowedTagNames=["input","textarea"],this.allowedInputTypes=["text","email","date","color","datetime-local","month","number","password","range","search","tel","time","url","week","checkbox","radio"],this.throwError={onInvalidFieldsProp:l=>{throw new Error(`"Fields" property must be either a string or an array of strings. Received type: ${l}`)},onFieldNotFound:l=>{throw new Error(`You must pass the id of an existing element. Element with id ${l} not found`)},onInvalidTagName:l=>{throw new Error(`You can't register an element with tag ${l}. Only the tags "${this.allowedTagNames.join(", ")}" are allowed`)},onInvalidInputType:l=>{throw new Error(`You can't register an input element of type ${l}. Only the types "${this.allowedInputTypes.join(", ")}" are allowed`)},onDeregisterInvalidField:l=>{throw new Error(`You can't deregister field of id ${l}. No field was registered with id ${l} `)}},this.sync=l=>{var c;let h=this.fields[l],d=this.hasCheckedProperty(h),f={value:d?h.checked:h.value,color:this.localParticipant.slot.color,fieldId:l,showOutline:this.canUpdateColor(l),syncContent:this.canSyncContent(l),attribute:d?"checked":"value"};(c=this.room)==null||c.emit("field.input"+l,f)},this.handleInput=l=>{var c,h;let d=l.target;(c=this.room)==null||c.emit("field.keyboard-interaction"+d.id,{fieldId:d.id,color:this.localParticipant.slot.color});let f=this.canSyncContent(d.id);if(!f)return;let m={value:d.value,color:this.localParticipant.slot.color,fieldId:d.id,showOutline:this.canUpdateColor(d.id),syncContent:f,attribute:"value"};(h=this.room)==null||h.emit("field.input"+d.id,m)},this.handleChange=l=>{var c;let h=l.target;if(!this.canSyncContent(h.id))return;let d={fieldId:h.id,value:h.checked,color:this.localParticipant.slot.color,showOutline:this.canUpdateColor(h.id),syncContent:this.canSyncContent(h.id),attribute:"checked"};(c=this.room)==null||c.emit("field.input"+h.id,d)},this.handleFocus=l=>{var c;let h=l.target,d={color:this.localParticipant.slot.color,fieldId:h.id};(c=this.room)==null||c.emit("field.focus"+h.id,d)},this.handleBlur=l=>{var c;let h=l.target,d={fieldId:h.id};(c=this.room)==null||c.emit("field.blur"+h.id,d)},this.removeFieldColor=({presence:l,data:{fieldId:c}})=>{var h,d;((h=this.focusList[c])==null?void 0:h.id)!==l.id||!this.fields[c]||(this.fields[c].style.outline=(d=this.fieldsOriginalOutline[c])!=null?d:"",delete this.fieldsOriginalOutline[c],delete this.focusList[c])},this.updateFieldColor=({presence:l,data:{color:c,fieldId:h},timestamp:d})=>{var f;let m=(f=this.focusList[h])!=null?f:{},g=!m.id,y=l.id===this.localParticipant.id;if(g&&y){this.focusList[h]={id:l.id,color:c,firstInteraction:d,lastInteraction:d};return}if(m.id===l.id){this.focusList[h].lastInteraction=d;return}let _=d-m.lastInteraction>=3e3,b=d-m.firstInteraction>=1e4;if(!(_||b||g))return;this.focusList[h]={id:l.id,color:c,firstInteraction:d,lastInteraction:d};let S=y?this.fieldsOriginalOutline[h]:`1px solid ${c}`;this.fields[h].style.outline=S},this.updateFieldContent=l=>{var c=l,{presence:h,data:{value:d,fieldId:f,color:m,showOutline:g,syncContent:y,attribute:_},timestamp:b}=c,S=YV(c,["presence","data","timestamp"]);h.id!==this.localParticipant.id&&(this.publish(`field.input-${f}`,{value:d,fieldId:f,attribute:_,userId:h.id,userName:h.name,timestamp:b}),y&&this.canSyncContent(f)&&(this.fields[f][_]=d),g&&this.canUpdateColor(f)&&this.updateFieldColor(ir({presence:h,data:{color:m,fieldId:f},timestamp:b},S)))},this.publishTypedEvent=({presence:l,data:{fieldId:c,color:h}})=>{l.id!==this.localParticipant.id&&this.publish(`field.keyboard-interaction-${c}`,{fieldId:c,userId:l.id,userName:l.name,color:h})},this.name="formElements",this.logger=new eu("@superviz/sdk/presence-input-component");let t=e,{fields:r}=t,n=YV(t,["fields"]);if(this.flags=n??{},typeof r=="string"){this.validateField(r),this.fields[r]=null;return}if(Array.isArray(r)){r.forEach(l=>{this.validateField(l),this.fields[l]=null});return}r!==void 0&&this.throwError.onInvalidFieldsProp(typeof r)}enableOutline(e){let t=this.fields[e];!t||(this.enabledOutlineFields[e]=!0,this.fieldsOriginalOutline[e]=t.style.outline,t.addEventListener("focus",this.handleFocus),t.addEventListener("blur",this.handleBlur),this.room.on("field.focus"+e,this.updateFieldColor),this.room.on("field.blur"+e,this.removeFieldColor))}disableOutline(e){var t,r;let n=this.fields[e];!n||(this.enabledOutlineFields[e]=!1,n.style.outline=(t=this.fieldsOriginalOutline[e])!=null?t:"",n.removeEventListener("focus",this.handleFocus),n.removeEventListener("blur",this.handleBlur),this.room.off("field.focus"+e,this.updateFieldColor),this.room.off("field.blur"+e,this.removeFieldColor),(r=this.room)==null||r.emit("field.blur"+e,{fieldId:e}))}enableRealtimeSync(e){this.enabledRealtimeSyncFields[e]=!0}disableRealtimeSync(e){this.enabledRealtimeSyncFields[e]=!1}registerField(e){this.validateField(e);let t=document.getElementById(e);this.fields[e]=t,this.addListenersToField(t),this.addRealtimeListenersToField(e),this.fieldsOriginalOutline[e]=t.style.outline}deregisterField(e){var t;this.fields[e]||this.throwError.onDeregisterInvalidField(e),this.removeListenersFromField(this.fields[e]),this.removeRealtimeListenersFromField(e),this.fields[e].style.outline=this.fieldsOriginalOutline[e],this.fields[e]=void 0,delete this.enabledOutlineFields[e],delete this.enabledRealtimeSyncFields[e],delete this.fieldsOriginalOutline[e],delete this.focusList[e],(t=this.room)==null||t.emit("field.blur"+e,{fieldId:e})}start(){let{localParticipant:e}=this.useStore("global-store");e.subscribe(),Object.entries(this.fields).forEach(([t])=>{this.registerField(t)})}destroy(){this.restoreOutlines(),this.deregisterAllFields(),this.fieldsOriginalOutline=void 0,this.focusList=void 0}addListenersToField(e){this.hasCheckedProperty(e)?e.addEventListener("change",this.handleChange):e.addEventListener("input",this.handleInput),!this.flags.disableOutline&&(e.addEventListener("focus",this.handleFocus),e.addEventListener("blur",this.handleBlur))}addRealtimeListenersToField(e){!this.room||(this.room.on("field.input"+e,this.updateFieldContent),this.room.on("field.keyboard-interaction"+e,this.publishTypedEvent),!this.flags.disableOutline&&(this.room.on("field.focus"+e,this.updateFieldColor),this.room.on("field.blur"+e,this.removeFieldColor)))}removeListenersFromField(e){this.hasCheckedProperty(e)?e.removeEventListener("change",this.handleChange):e.removeEventListener("input",this.handleInput),!this.flags.disableOutline&&(e.removeEventListener("focus",this.handleFocus),e.removeEventListener("blur",this.handleBlur))}removeRealtimeListenersFromField(e){!this.room||(this.room.off("field.input"+e,this.updateFieldContent),this.room.off("field.keyboard-interaction"+e,this.publishTypedEvent),!this.flags.disableOutline&&(this.room.off("field.focus"+e,this.updateFieldColor),this.room.off("field.blur"+e,this.removeFieldColor)))}deregisterAllFields(){Object.keys(this.fields).forEach(e=>{this.deregisterField(e)}),this.fields=void 0}validateField(e){this.validateFieldId(e);let t=document.getElementById(e);this.validateFieldTagName(t),this.validateFieldType(t)}validateFieldTagName(e){let t=e.tagName.toLowerCase();this.allowedTagNames.includes(t)||(this.logger.log("invalid element tagname"),this.throwError.onInvalidTagName(t))}validateFieldType(e){if(e.tagName.toLowerCase()!=="input")return;let t=e.getAttribute("type"),r=this.allowedInputTypes.includes(t);t&&!r&&(this.logger.log("invalid input type"),this.throwError.onInvalidInputType(t))}validateFieldId(e){document.getElementById(e)||this.throwError.onFieldNotFound(e)}restoreOutlines(){Object.entries(this.fields).forEach(([e])=>{this.fields[e].style.outline=this.fieldsOriginalOutline[e]})}hasCheckedProperty(e){let t=e.tagName.toLowerCase(),r=e.getAttribute("type");return t==="input"&&(r==="radio"||r==="checkbox")}canUpdateColor(e){return!this.flags.disableOutline&&this.enabledOutlineFields[e]!==!1||this.enabledOutlineFields[e]}canSyncContent(e){return!this.flags.disableRealtimeSync&&this.enabledRealtimeSyncFields[e]!==!1||this.enabledRealtimeSyncFields[e]}};nt();nt();var gJ=(i=>(i.svPrimary="sv-primary",i.svPrimary900="sv-primary-900",i.svPrimary200="sv-primary-200",i.svSecondary="sv-secondary",i.svGray="sv-gray",i.svSuccess="sv-success",i.svDanger="sv-danger",i.svBlack="sv-black",i.svWhite="sv-white",i.svGray100="sv-gray-100",i.svGray200="sv-gray-200",i.svGray300="sv-gray-300",i.svGray400="sv-gray-400",i.svGray500="sv-gray-500",i.svGray600="sv-gray-600",i.svGray700="sv-gray-700",i.svGray800="sv-gray-800",i))(gJ||{});nt();nt();function X0e(i,e){return Zr(this,null,function*(){try{return(yield to.validateApiKey(i,e))===!0}catch(t){if(t.status===404)return!1;throw new Error("Unable to validate API key")}})}var Z0e=X0e;nt();var vJ=class{static getRemoteConfig(){return Zr(this,arguments,function*(i="prod"){let{version:e}=yield Promise.resolve().then(()=>(u0e(),WZ));if(i==="local"){let{remoteConfig:n}=yield Promise.resolve().then(()=>l0e(c0e()));return n}let t={version:e,environment:i},r=this.createUrl(t);return yo(r,"GET",null)})}static createUrl({version:i,environment:e}){return`${this.REMOTE_CONFIG_BASE_URL}/${i}?env=${e}`}};vJ.REMOTE_CONFIG_BASE_URL="https://remote-config.superviz.com/sdk";nt();nt();var QV=class{constructor(){this.observers=new Map,this.subscribe=(e,t)=>{this.logger.log("event bus service @ subscribe",{event:e,callback:t}),this.observers.has(e)||this.observers.set(e,new yr),this.observers.get(e).subscribe(t)},this.unsubscribe=(e,t)=>{this.logger.log("event bus service @ unsubscribe",{event:e,callback:t}),this.observers.has(e)&&(this.observers.get(e).reset(),this.observers.delete(e))},this.publish=(e,t)=>{this.logger.log("event bus service @ publish",{event:e,data:t}),this.observers.has(e)&&this.observers.get(e).publish(t)},this.destroy=()=>{this.logger.log("event bus service @ destroy"),this.observers.forEach(e=>{e.reset(),e.destroy()}),this.observers.clear()},this.logger=new eu("@superviz/sdk/event-bus"),this.logger.log("event bus created")}};nt();var J0e=class{constructor(e){this.stateSubject=new RC,this.client=new Dge(Fi.get("apiKey"),Fi.get("environment"),{id:e.id,name:e.name}),this.subscribeToDefaultEvents()}destroy(){this.client.destroy(),this.client.connection.off()}onStateChange(e){this.stateSubject.subscribe(e)}subscribeToDefaultEvents(){this.client.connection.on(e=>{this.state=e,this.stateSubject.next(e)})}createRoom(e){let t=Fi.get("roomId");return this.client.connect(`${t}:${e}`)}};nt();var Y0e=class{static checkComponentLimit(e){var t,r;let n=(t=nJ[e])!=null?t:e,l=Fi.get("limits");return(r=l==null?void 0:l[n])!=null?r:!1}};nt();nt();nt();var WB=(i=>(i[i.turquoise=0]="turquoise",i[i.orange=1]="orange",i[i.blue=2]="blue",i[i.pink=3]="pink",i[i.purple=4]="purple",i[i.green=5]="green",i[i.red=6]="red",i[i.bluedark=7]="bluedark",i[i.pinklight=8]="pinklight",i[i.purplelight=9]="purplelight",i[i.greenlight=10]="greenlight",i[i.orangelight=11]="orangelight",i[i.bluelight=12]="bluelight",i[i.redlight=13]="redlight",i[i.brown=14]="brown",i[i.yellow=15]="yellow",i[i.gray=16]="gray",i))(WB||{}),jB=[1,3,4,6,7,14,16],GB=(i=>(i[i["#31E0B0"]=0]="#31E0B0",i[i["#FF5E10"]=1]="#FF5E10",i[i["#00ABF7"]=2]="#00ABF7",i[i["#FF00BB"]=3]="#FF00BB",i[i["#9C29FF"]=4]="#9C29FF",i[i["#6FDD00"]=5]="#6FDD00",i[i["#E30000"]=6]="#E30000",i[i["#304AFF"]=7]="#304AFF",i[i["#FF89C4"]=8]="#FF89C4",i[i["#D597FF"]=9]="#D597FF",i[i["#C6EC5C"]=10]="#C6EC5C",i[i["#FFA115"]=11]="#FFA115",i[i["#75DEFE"]=12]="#75DEFE",i[i["#FAA291"]=13]="#FAA291",i[i["#BB813F"]=14]="#BB813F",i[i["#FFEF33"]=15]="#FFEF33",i[i["#878291"]=16]="#878291",i))(GB||{});nt();var yJ=(i=>(i[i.DISCONNECTED=0]="DISCONNECTED",i[i.INITIALIZING=1]="INITIALIZING",i[i.READY_TO_JOIN=2]="READY_TO_JOIN",i[i.CONNECTING=3]="CONNECTING",i[i.CONNECTED=4]="CONNECTED",i[i.JOINED=5]="JOINED",i[i.FAILED=-1]="FAILED",i[i.RETRYING=-2]="RETRYING",i))(yJ||{});nt();var K0e=class{constructor(){this.participantObservers=[],this.participants3DObservers=[],this.logger=new eu("@superviz/sdk/realtime-service"),this.participantsObserver=new yr({logger:this.logger}),this.participantJoinedObserver=new yr({logger:this.logger}),this.participantLeaveObserver=new yr({logger:this.logger}),this.reconnectObserver=new yr({logger:this.logger}),this.sameAccountObserver=new yr({logger:this.logger}),this.roomInfoUpdatedObserver=new yr({logger:this.logger}),this.roomListUpdatedObserver=new yr({logger:this.logger}),this.realtimeStateObserver=new yr({logger:this.logger}),this.kickAllParticipantsObserver=new yr({logger:this.logger}),this.kickParticipantObserver=new yr({logger:this.logger}),this.authenticationObserver=new yr({logger:this.logger}),this.commentsObserver=new yr({logger:this.logger}),this.presenceMouseObserver=new yr({logger:this.logger}),this.privateModeWIOObserver=new yr({logger:this.logger}),this.followWIOObserver=new yr({logger:this.logger}),this.gatherWIOObserver=new yr({logger:this.logger}),this.presence3dObserver=new yr({logger:this.logger}),this.presence3dLeaveObserver=new yr({logger:this.logger}),this.presence3dJoinedObserver=new yr({logger:this.logger})}subscribeToParticipantUpdate(e,t){this.participantObservers[e]||(this.participantObservers[e]=new yr({logger:this.logger})),this.participantObservers[e].subscribe(t)}unsubscribeFromParticipantUpdate(e,t){this.participantObservers[e]&&this.participantObservers[e].unsubscribe(t)}subscribeToParticipant3DUpdate(e,t){this.participants3DObservers[e]||(this.participants3DObservers[e]=new yr({logger:this.logger})),this.participants3DObservers[e].subscribe(t)}unsubscribeFromParticipant3DUpdate(e,t){this.participants3DObservers[e]&&this.participants3DObservers[e].unsubscribe(t)}getSlotColor(e){let t=e??16;return{color:GB[t],name:WB[t]}}},eW=6e4,Q0e=1e3,e_e=class extends K0e{constructor(i,e){super(),this.participants={},this.participantsOn3d={},this.hostParticipantId=null,this.myParticipant=null,this.commentsChannel=null,this.supervizChannel=null,this.clientSyncChannel=null,this.broadcastChannel=null,this.presenceWIOChannel=null,this.presence3DChannel=null,this.isReconnecting=!1,this.isJoinedRoom=!1,this.isJoinedPresence3D=!1,this.currentReconnectAttempt=0,this.localRoomProperties=null,this.enableSync=!0,this.isSyncFrozen=!1,this.left=!1,this.domainWhitelisted=!0,this.state=0,this.setHost=t=>{this.updateRoomProperties({hostClientId:t})},this.setKickParticipant=t=>{if(!t)return;let r=this.participants[t];this.updateRoomProperties({kickParticipant:r})},this.freezeSync=t=>{var r,n;if(this.isSyncFrozen=t,t){this.supervizChannel.detach(),this.clientSyncChannel.detach(),(r=this.broadcastChannel)==null||r.detach(),this.supervizChannel.unsubscribe(),this.clientSyncChannel.unsubscribe(),(n=this.broadcastChannel)==null||n.unsubscribe();return}this.join()},this.setParticipantData=t=>{this.myParticipant.data=Object.assign({},this.myParticipant.data,t),this.updateMyProperties(this.myParticipant.data),this.updatePresence3D(this.myParticipant.data)},this.updateLocalRoomState=t=>Zr(this,null,function*(){this.localRoomProperties=Object.assign({},this.localRoomProperties,t),this.roomInfoUpdatedObserver.publish(this.localRoomProperties),this.updateParticipants(),t.kickParticipant&&t.kickParticipant.clientId===this.myParticipant.clientId&&(this.updateRoomProperties({kickParticipant:null}),this.kickParticipantObserver.publish(this.myParticipant.clientId))}),this.updateMyProperties=(t={})=>{let r=t;this.isMessageTooBig(r)||this.left||!this.enableSync||this.isSyncFrozen||(r.avatar===void 0&&delete r.avatar,this.myParticipant.data=ir(ir({},this.myParticipant.data),r),this.isJoinedRoom&&(this.supervizChannel.presence.update(this.myParticipant.data),this.logger.log("REALTIME","updating my properties",this.myParticipant.data)))},this.updateRoomProperties=t=>{if(this.isMessageTooBig(t)||this.isSyncFrozen||this.left)return;let r=ir(ir({},this.localRoomProperties),t);this.supervizChannel.publish("update",r)},this.updateParticipants=()=>{let t={};this.supervizChannel.presence.get((r,n)=>{n.forEach(l=>{t[l.clientId]=ir({},l)}),this.participants=t,this.participantsObserver.publish(this.participants)})},this.initializeRoomProperties=()=>{let t={isGridModeEnable:!1,hostClientId:null,followParticipantId:null,gather:!1,drawing:null,transcript:"transcript.stop",kickParticipant:null};this.updateParticipants(),this.updateRoomProperties(t)},this.onParticipantJoin=t=>{this.updateParticipants(),this.participantJoinedObserver.publish(t),this.updateMyProperties()},this.syncBroadcast=UR(()=>{let t=btoa(this.ablyKey),r=`https://rest.ably.io/channels/${this.roomId.toLowerCase()}/presence`;fetch(r,{headers:{Authorization:`Basic ${t}`}}).then(n=>n.json()).then(n=>{this.broadcastChannel.publish("update",n)})},1e3),this.isMessageTooBig=(t,r=eW)=>{let n=JSON.stringify(t);return new TextEncoder().encode(n).length>r?(this.logger.log("Message too long, the message limit size is 60kb."),!0):!1},this.onCommentsChannelUpdate=t=>{this.logger.log("REALTIME","Comments channel update",t),this.commentsObserver.publish(t)},this.updateComments=t=>{this.commentsChannel.publish("update",t)},this.enterWIOChannel=t=>{this.presenceWIOChannel||(this.presenceWIOChannel=this.client.channels.get(`${this.roomId.toLowerCase()}-wio`)),this.presenceWIOChannel.attach(),this.presenceWIOChannel.subscribe("private",this.onSetPrivate),this.presenceWIOChannel.subscribe("follow",this.onSetFollow),this.presenceWIOChannel.subscribe("gather",this.onSetGather)},this.leaveWIOChannel=()=>{!this.presenceWIOChannel||(this.presenceWIOChannel.unsubscribe(),this.presenceWIOChannel.detach(),this.presenceWIOChannel=null)},this.onSetPrivate=({data:{id:t,isPrivate:r}})=>{this.participants[t].data.isPrivate=r,this.privateModeWIOObserver.publish(this.participants)},this.onSetFollow=t=>{this.followWIOObserver.publish(t)},this.onSetGather=({data:t})=>{this.gatherWIOObserver.publish({detail:{id:t.id}})},this.setPrivateWIOParticipant=(t,r)=>{this.presenceWIOChannel.publish("private",{id:t,isPrivate:r})},this.setFollowWIOParticipant=t=>{this.presenceWIOChannel.publish("follow",ir({},t))},this.setGatherWIOParticipant=t=>{this.presenceWIOChannel.publish("gather",ir({},t))},this.leavePresence3DChannel=()=>{!this.presence3DChannel||(this.presence3DChannel.presence.leave(),this.presence3DChannel=null)},this.updatePresence3D=UR(t=>{var r,n,l;if(!t||!t.id)return;let c=Object.assign({},(n=(r=this.participantsOn3d[t.id])==null?void 0:r.data)!=null?n:{},t);this.participantsOn3d[t.id]=Ia(ir({},this.participants[c.id]),{data:ir(ir({},c),(l=this.participants[c.id])==null?void 0:l.data)}),this.presence3DChannel&&this.presence3DChannel.presence.update(c)},Q0e),this.onPresence3DChannelEnter=t=>{var r;t.clientId===this.myParticipant.clientId&&(this.isJoinedPresence3D=!0);let n=this.getParticipantSlot(t.clientId);this.presence3dJoinedObserver.publish(Ia(ir({},t),{data:Ia(ir(ir({},t.data),(r=this.participants[t.clientId])==null?void 0:r.data),{slotIndex:n,color:this.getSlotColor(n).color})}))},this.onPresence3DChannelLeave=t=>{delete this.participantsOn3d[t.clientId],this.presence3dLeaveObserver.publish(t)},this.publish3DUpdate=t=>{var r;let n=this.getParticipantSlot(t.clientId),l=Ia(ir({},t),{data:Ia(ir(ir({},t.data),(r=this.participants[t.clientId])==null?void 0:r.data),{slotIndex:n,color:this.getSlotColor(n).color})});this.participantsOn3d[t.clientId]=l,this.participants3DObservers[t.clientId]&&this.participants3DObservers[t.clientId].publish(l),this.presence3dObserver.publish(this.participantsOn3d)},this.ablyKey=e,this.apiUrl=i,this.onAblyPresenceEnter=this.onAblyPresenceEnter.bind(this),this.onAblyPresenceUpdate=this.onAblyPresenceUpdate.bind(this),this.onAblyPresenceLeave=this.onAblyPresenceLeave.bind(this),this.onAblyRoomUpdate=this.onAblyRoomUpdate.bind(this),this.onAblyChannelStateChange=this.onAblyChannelStateChange.bind(this),this.onAblyConnectionStateChange=this.onAblyConnectionStateChange.bind(this),this.onReceiveBroadcastSync=this.onReceiveBroadcastSync.bind(this),this.getParticipantSlot=this.getParticipantSlot.bind(this),this.auth=this.auth.bind(this)}get roomProperties(){return this.localRoomProperties}get hostClientId(){var i;return(i=this.roomProperties)==null?void 0:i.hostClientId}get isLocalParticipantHost(){return this.hostClientId===this.localParticipantId}get isDomainWhitelisted(){return this.domainWhitelisted}get getParticipants(){return this.participants}get participant(){return this.myParticipant}get localParticipantId(){var i,e;return(e=(i=this.myParticipant.data)==null?void 0:i.participantId)!=null?e:null}get isBroadcast(){return Object.values(this.participants).some(i=>i.data.type==="audience")}start({participant:i,roomId:e,apiKey:t}){this.myParticipant={data:Ia(ir({},i),{participantId:i.id}),timestamp:null,action:null,clientId:i.id,connectionId:null,encoding:null,id:null,extras:null},this.enableSync=i.type!=="audience",this.roomId=`superviz:${e.toLowerCase()}-${t}`,this.apiKey=t,this.client||this.buildClient()}auth(i,e){if(!this.domainWhitelisted)return;let t=new oV.Rest({key:this.ablyKey}),{origin:r}=window.location;t.auth.requestToken(i,{authUrl:`${this.apiUrl}/realtime/auth`,key:this.ablyKey,authParams:{domain:r,apiKey:this.apiKey}},(n,l)=>{var c;n&&this.authenticationObserver.publish("realtime.authentication-failed"),(c=n==null?void 0:n.message)!=null&&c.includes("this domain don't have permission")&&(this.domainWhitelisted=!1),e(n,l)})}join(i){let e=i?Object.assign({},i,{participantId:i.id}):this.myParticipant.data;this.logger.log("REALTIME",`Entering room. Room ID: ${this.roomId}`),this.updateMyProperties(e),this.clientSyncChannel=this.client.channels.get(`${this.roomId}:client-sync`),this.broadcastChannel=this.client.channels.get(`${this.roomId}:broadcast`),this.enableSync||this.broadcastChannel.subscribe("update",this.onReceiveBroadcastSync),this.supervizChannel=this.client.channels.get(this.roomId),this.supervizChannel.on(this.onAblyChannelStateChange),this.supervizChannel.subscribe("update",this.onAblyRoomUpdate),this.commentsChannel=this.client.channels.get(`${this.roomId}:comments`),this.commentsChannel.subscribe("update",this.onCommentsChannelUpdate),this.supervizChannel.presence.subscribe("enter",this.onAblyPresenceEnter),this.enableSync&&this.supervizChannel.presence.subscribe("update",this.onAblyPresenceUpdate),this.supervizChannel.presence.subscribe("leave",this.onAblyPresenceLeave),this.supervizChannel.presence.enter(this.myParticipant.data)}leave(){this.logger.log("REALTIME","Disconnecting from ably servers"),this.supervizChannel.presence.leave(),this.client.close(),this.isJoinedRoom=!1,this.isReconnecting=!1,this.roomId=null,this.participants={},this.hostParticipantId=null,this.myParticipant=null,this.supervizChannel=null,this.clientSyncChannel=null,this.client=null,this.left=!0}setGridMode(i){let e=this.localRoomProperties;this.updateRoomProperties(Object.assign({},e,{isGridModeEnable:i}))}setDrawing(i){let e=this.localRoomProperties;this.updateRoomProperties(Object.assign({},e,{drawing:i}))}setTranscript(i){let e=this.localRoomProperties;this.updateRoomProperties(Object.assign({},e,{transcript:i}))}setFollowParticipant(i){this.updateRoomProperties({followParticipantId:i})}setGather(i){this.updateRoomProperties({gather:i})}getParticipantSlot(i){var e,t;if(i){let r=i.toString();if(this.participants&&this.participants[r])return(t=(e=this.participants[i])==null?void 0:e.data)==null?void 0:t.slotIndex}return 16}onAblyPresenceEnter(i){if(i.clientId===this.myParticipant.data.participantId&&this.isJoinedRoom){this.sameAccountObserver.publish(!0);return}i.clientId===this.myParticipant.data.participantId?this.onJoinRoom(i):this.onParticipantJoin(i)}onAblyPresenceUpdate(i){if(!this.isJoinedRoom)return;let{clientId:e}=i,t=Object.assign({},i,{participantId:i.clientId});this.publishParticipantUpdate(t),this.participants&&this.participants[e]&&this.hostParticipantId===this.localParticipantId&&this.isBroadcast&&this.syncBroadcast()}onAblyPresenceLeave(i){this.onParticipantLeave(i)}onReceiveBroadcastSync(i){i.data.forEach(e=>{var t;let r=e.clientId;this.participants[r]=e,(t=e.data)!=null&&t.isAudience||(this.participants[r].data=JSON.parse(this.participants[r].data),this.publishParticipantUpdate(this.participants[r]))})}onAblyRoomUpdate(i){this.logger.log("REALTIME","Room update received",i.data),this.updateLocalRoomState(i.data)}buildClient(){this.client&&this.throw("Tried to call buildClient@Ably is already initialized");let i={key:this.ablyKey,disconnectedRetryTimeout:5e3,suspendedRetryTimeout:5e3,clientId:this.myParticipant.data.participantId,authCallback:this.auth};this.client=new oV.Realtime(i),this.client.connection.on(this.onAblyConnectionStateChange)}publishParticipantUpdate(i){this.participants[i.clientId]=i,this.participantsObserver.publish(this.participants),this.participantObservers[i.clientId]&&this.participantObservers[i.clientId].publish(i)}forceReconnect(){if(this.logger.log("REALTIME",`RECONNECT: Starting force realtime reconnect | Current attempt: ${this.currentReconnectAttempt}`),this.roomId||this.throw("Tried to reconnect without roomId set"),this.state===2){this.logger.log("REALTIME","Rejoining room since client already connected to ably servers."),this.join();return}this.logger.log("REALTIME","RECONNECT: Restarting ably server since participant lost connection."),this.buildClient(),this.updateMyProperties(this.myParticipant.data)}throw(i){throw this.logger.log(i),new Error(i)}publishStateUpdate(i){this.state!==i&&(this.state=i,this.logger.log("REALTIME",`Realtime state did change. New state: ${yJ[this.state]}`),this.realtimeStateObserver.publish(this.state))}fetchRoomProperties(){return Zr(this,null,function*(){let i=yield new Promise((e,t)=>{this.supervizChannel.history((r,n)=>{r&&t(r);let l=n.items[0];e(l||null)})});return(i==null?void 0:i.timestamp)<Date.now()-1e3*60*60?null:(i==null?void 0:i.data)||null})}onStateChange(){var i,e,t;let r=(i=this.supervizChannelState)==null?void 0:i.current,n=(e=this.connectionState)==null?void 0:e.current,l=n==="connected",c=["initialized","connecting"].includes(n),h=["closed","closing"].includes(n)||["detaching","detached"].includes(r),d={0:h,1:c,2:!r&&l,3:r==="attaching",4:r==="attached"&&l,[-1]:r==="failed"||n==="failed",[-2]:n==="suspended"||r==="suspended"},f=Object.entries(d).find(([g,y])=>y&&g)[0],m=Number(f);if(this.domainWhitelisted){if(m===2&&(this.currentReconnectAttempt=0),l&&this.isReconnecting&&this.onJoinRoom(this.participant),(m===-2||m===-1)&&this.forceReconnect(),(t=this.connectionState)!=null&&t.retryIn){this.currentReconnectAttempt++,this.isReconnecting=!0,this.publishStateUpdate(-2),this.reconnectObserver.publish(this.currentReconnectAttempt);return}this.publishStateUpdate(m)}}onAblyConnectionStateChange(i){this.connectionState=i,this.onStateChange()}onAblyChannelStateChange(i){this.supervizChannelState=i,this.onStateChange()}onJoinRoom(i){return Zr(this,null,function*(){this.isJoinedRoom=!0,this.localRoomProperties=yield this.fetchRoomProperties(),this.updateParticipants(),this.myParticipant=i,this.localRoomProperties?(this.updateParticipants(),this.localRoomProperties=yield this.fetchRoomProperties(),this.updateLocalRoomState(this.localRoomProperties)):this.initializeRoomProperties(),this.isReconnecting=!1,this.publishStateUpdate(4),this.participantJoinedObserver.publish(i),this.logger.log("REALTIME","Joined realtime room")})}onParticipantLeave(i){this.state!==2&&(i.data.participantId===this.localRoomProperties.followParticipantId&&this.setFollowParticipant(),this.participantLeaveObserver.publish(i),this.updateParticipants())}spliceArrayBySize(i,e=eW){let t=c=>{let h=JSON.stringify(c);return new TextEncoder().encode(h).length},r=0,n=[],l=[];for(let c=0;c<i.length;c++){let h=t(i[c]);r+h<=e?(l.push(i[c]),r+=h):(n.push(l),l=[i[c]],r=h)}return l.length>0&&n.push(l),{data:n[0],lengthToBeSplitted:n[0].length}}enterPresence3DChannel(i){if(!this.isJoinedRoom){this.logger.log("REALTIME","Cannot enter presence 3D channel because the participant is not in the room"),setTimeout(()=>{this.enterPresence3DChannel(i)},1e3);return}this.presence3DChannel||(this.presence3DChannel=this.client.channels.get(`${this.roomId.toLowerCase()}-presence-3d`),this.presence3DChannel.attach(),this.presence3DChannel.presence.subscribe("enter",this.onPresence3DChannelEnter),this.presence3DChannel.presence.subscribe("leave",this.onPresence3DChannelLeave),this.presence3DChannel.presence.subscribe("update",this.publish3DUpdate)),this.presence3DChannel.presence.enter(i)}};nt();nt();var t_e=class{constructor(i,e){this.onPresenceUpdate=t=>Zr(this,null,function*(){var r,n,l,c;if(!t.data.slot||!((r=this.participant)!=null&&r.slot))return;if(t.id===this.participant.id){this.participant=t.data,this.slotIndex=t.data.slot.index;return}let h=t.data.slot.timestamp<((l=(n=this.participant)==null?void 0:n.slot)==null?void 0:l.timestamp);if(((c=t.data.slot)==null?void 0:c.index)===this.slotIndex&&h){let d=yield this.assignSlot();this.room.presence.update({slot:d})}}),this.room=i,this.participant=e,this.room.presence.on(bs.UPDATE,this.onPresenceUpdate)}assignSlot(){return Zr(this,null,function*(){try{let i=Math.floor(Math.random()*16);if(yield new Promise((t,r)=>{this.room.presence.get(n=>{if((!n||!n.length)&&t(!1),n.length>=16){r(new Error("[SuperViz] - No more slots available"));return}n.forEach(l=>{var c,h;l.id!==this.participant.id&&((h=(c=l.data)==null?void 0:c.slot)==null?void 0:h.index)===i&&t(!0)}),t(!1)})}))return yield this.assignSlot();let e={index:i,color:GB[i],textColor:jB.includes(i)?"#fff":"#000",colorName:WB[i],timestamp:Date.now()};return this.slotIndex=i,this.participant=Ia(ir({},this.participant),{slot:e}),e}catch{return null}})}};nt();var i_e=class extends iJ{constructor({participant:i,group:e}){super(),this.isDestroyed=!1,this.activeComponents=[],this.componentsToAttachAfterJoin=[],this.activeComponentsInstances=[],this.eventBus=new QV,this.addComponent=l=>{if(this.canAddComponent(l)){if(!this.realtime.isJoinedRoom){this.logger.log("launcher service @ addComponent - not joined yet"),this.componentsToAttachAfterJoin.push(l);return}l.attach({ioc:this.ioc,realtime:this.realtime,config:Fi.configuration,eventBus:this.eventBus,useStore:VB}),this.activeComponents.push(l.name),this.activeComponentsInstances.push(l),this.realtime.updateMyProperties({activeComponents:this.activeComponents}),to.sendActivity(this.participant.value.id,this.group.value.id,this.group.value.name,l.name)}},this.attachComponentsAfterJoin=()=>{this.logger.log("launcher service @ attachComponentsAfterJoin"),this.componentsToAttachAfterJoin.forEach(l=>{this.logger.log("launcher service @ attachComponentsAfterJoin - attaching component",l.name),this.addComponent(l)}),this.componentsToAttachAfterJoin=[]},this.removeComponent=l=>{if(!this.activeComponents.includes(l.name)){let c=`Component ${l.name} is not initialized yet.`;this.logger.log(c);return}l.detach(),this.activeComponentsInstances=this.activeComponentsInstances.filter(c=>c.name!==l.name),this.activeComponents.splice(this.activeComponents.indexOf(l.name),1),this.realtime.updateMyProperties({activeComponents:this.activeComponents})},this.destroy=()=>{this.logger.log("launcher service @ destroy"),this.activeComponentsInstances.forEach(l=>{this.logger.log("launcher service @ destroy - removing component",l.name),this.removeComponent(l)}),this.activeComponents=[],this.activeComponentsInstances=[],this.participant=void 0,YF().destroy(),this.eventBus.destroy(),this.eventBus=void 0,this.LauncherRealtimeRoom.presence.off(bs.JOINED_ROOM),this.LauncherRealtimeRoom.presence.off(bs.LEAVE),this.LauncherRealtimeRoom.presence.off(bs.UPDATE),this.ioc.destroy(),this.realtime.authenticationObserver.unsubscribe(this.onAuthentication),this.realtime.sameAccountObserver.unsubscribe(this.onSameAccount),this.realtime.participantJoinedObserver.unsubscribe(this.onParticipantJoined),this.realtime.participantsObserver.unsubscribe(this.onParticipantListUpdate),this.realtime.leave(),this.realtime=void 0,this.isDestroyed=!0,window.SUPERVIZ=void 0},this.canAddComponent=l=>{let c=Y0e.checkComponentLimit(l.name),h=this.activeComponents.includes(l.name),d=[{isValid:!this.isDestroyed,message:"Component can not be added because the superviz room is destroyed. Initialize a new room to add and use components."},{isValid:!h,message:`Component ${l.name} is already active. Please remove it first`},{isValid:c,message:`You reached the limit usage of ${l.name}`}];for(let f=0;f<d.length;f++){let{isValid:m,message:g}=d[f];if(!m)return this.logger.log(g),!1}return!0},this.startAbly=()=>{this.logger.log("launcher service @ startAbly"),this.realtime.start({participant:this.participant.value,apiKey:Fi.get("apiKey"),roomId:Fi.get("roomId")}),this.realtime.join(),this.subscribeToAblyEvents()},this.subscribeToAblyEvents=()=>{this.realtime.authenticationObserver.subscribe(this.onAuthentication),this.realtime.sameAccountObserver.subscribe(this.onSameAccount),this.realtime.participantJoinedObserver.subscribe(this.onParticipantJoined),this.realtime.participantsObserver.subscribe(this.onParticipantListUpdate)},this.onAuthentication=l=>{l==="realtime.authentication-failed"&&this.destroy()},this.onParticipantListUpdate=l=>{this.logger.log("launcher service @ onParticipantListUpdate",l);let c=Object.values(l).map(h=>{var d,f,m,g,y,_;return{id:h.data.id,name:(d=h.data)==null?void 0:d.name,type:(f=h.data)==null?void 0:f.type,avatar:(m=h.data)==null?void 0:m.avatar,avatarConfig:(g=h.data)==null?void 0:g.avatarConfig,isHost:this.realtime.hostClientId===h.clientId,color:this.realtime.getSlotColor((y=h.data)==null?void 0:y.slotIndex).color,activeComponents:(_=h.data)==null?void 0:_.activeComponents}}).find(h=>{var d;return(h==null?void 0:h.id)===((d=this.participant.value)==null?void 0:d.id)});c&&!Pp.isEqual(this.participant.value,c)&&(this.LauncherRealtimeRoom.presence.update(c),this.activeComponentsInstances=this.activeComponentsInstances.filter(h=>c.activeComponents?this.activeComponents.includes(h.name):!0))},this.onParticipantJoined=l=>{l.clientId===this.participant.value.id&&(this.logger.log("launcher service @ onParticipantJoined - local participant joined"),this.attachComponentsAfterJoin())},this.onSameAccount=()=>{this.publish("participant.same-account-error"),this.destroy()},this.startIOC=()=>{this.logger.log("launcher service @ startIOC"),this.LauncherRealtimeRoom.presence.get(l=>{l.forEach(c=>{this.participants.value.set(c.id,c.data)})}),this.LauncherRealtimeRoom.presence.on(bs.JOINED_ROOM,this.onParticipantJoinedIOC),this.LauncherRealtimeRoom.presence.on(bs.LEAVE,this.onParticipantLeaveIOC),this.LauncherRealtimeRoom.presence.on(bs.UPDATE,this.onParticipantUpdatedIOC)},this.onParticipantJoinedIOC=l=>Zr(this,null,function*(){if(l.id!==this.participant.value.id)return;let c=yield new t_e(this.LauncherRealtimeRoom,this.participant.value).assignSlot();this.participant.value=Ia(ir({},this.participant.value),{slot:c}),this.LauncherRealtimeRoom.presence.update(this.participant.value),this.logger.log("launcher service @ onParticipantJoined - local participant joined"),this.publish("participant.local-joined",this.participant.value),this.publish("participant.joined",this.participant.value)}),this.onParticipantLeaveIOC=l=>{this.participants.value.delete(l.id),l.id===this.participant.value.id&&(this.logger.log("launcher service @ onParticipantLeave - local participant left"),this.publish("participant.local-left",l.data)),this.logger.log("launcher service @ onParticipantLeave - participant left",l.data),this.publish("participant.left",l.data)},this.onParticipantUpdatedIOC=l=>{var c,h,d,f;l.id===this.participant.value.id&&!Pp.isEqual(this.participant.value,l.data)&&(this.participant.value=l.data,this.publish("participant.updated",l.data),this.logger.log("Publishing ParticipantEvent.UPDATED",l.data),((h=(c=l.data)==null?void 0:c.slot)==null?void 0:h.index)!==void 0&&((f=(d=l.data)==null?void 0:d.slot)==null?void 0:f.index)!==this.realtime.participant.data.slotIndex&&this.realtime.updateMyProperties({slotIndex:l.data.slot.index})),this.participants.value.has(l.id)||this.publish("participant.joined",l.data),this.participants.value.set(l.id,l.data);let m=Array.from(this.participants.value.values());this.logger.log("Publishing ParticipantEvent.LIST_UPDATED",this.participants.value),this.publish("participant.list-updated",m)};let{localParticipant:t,participants:r,group:n}=YF();this.participant=t,this.participants=r,this.group=n,this.participant.value=Ia(ir({},i),{type:"guest"}),this.group.value=e,this.logger=new eu("@superviz/sdk/launcher"),this.realtime=new e_e(Fi.get("apiUrl"),Fi.get("ablyKey")),this.ioc=new J0e(this.participant.value),this.LauncherRealtimeRoom=this.ioc.createRoom("launcher"),this.eventBus=new QV,this.logger.log("launcher created"),this.startAbly(),this.startIOC()}},r_e=i=>{if(window.SUPERVIZ)return{destroy:window.SUPERVIZ.destroy,subscribe:window.SUPERVIZ.subscribe,unsubscribe:window.SUPERVIZ.unsubscribe,addComponent:window.SUPERVIZ.addComponent,removeComponent:window.SUPERVIZ.removeComponent};let e=new i_e(i);return window.SUPERVIZ=e,{destroy:e.destroy,subscribe:e.subscribe,unsubscribe:e.unsubscribe,addComponent:e.addComponent,removeComponent:e.removeComponent}},n_e=({group:i,participant:e,roomId:t,customColors:r})=>{if(r&&s_e(r),!i||!i.name||!i.id)throw new Error("Group fields is required");if(!e||!e.id||!e.name)throw new Error("Participant name and id is required");if(!t)throw new Error("Room id is required")},s_e=i=>{Object.entries(i).forEach(([e,t])=>{if(!Object.values(gJ).includes(e))throw new Error(`Color ${e} is not a valid color variable name. Please check the documentation for more information.`);if(!/^(\d{1,3}\s){2}\d{1,3}$/.test(t))throw new Error(`Color ${e} is not a valid color variable value. Please check the documentation for more information.`)})},a_e=i=>{!i||Object.entries(i).forEach(([e,t])=>{let r=t.replace(/\s/g,", ");document.documentElement.style.setProperty(`--${e}`,r)})},o_e=(i,e)=>Zr(void 0,null,function*(){var t,r;if(!(i&&i.trim()))throw new Error("API key is required");if(!e)throw new Error("Options is required");n_e(e),e.debug?SF.debug.enable("*"):SF.debug.disable();let{apiUrl:n,conferenceLayerUrl:l}=yield vJ.getRemoteConfig(e.environment);if(!(yield Z0e(n,i)))throw new Error("Failed to validate API key");let[c,h,d]=yield Promise.all([to.fetchConfig(n,i),to.fetchLimits(n,i),to.fetchWaterMark(n,i)]).catch(()=>{throw new Error("Failed to load configuration from server")});if(!c||!c.ablyKey)throw new Error("Failed to load configuration from server");let{ablyKey:f}=c,{participant:m,roomId:g,customColors:y}=e;return Fi.setConfig({apiUrl:n,ablyKey:f,apiKey:i,conferenceLayerUrl:l,environment:(t=e.environment)!=null?t:"prod",roomId:g,debug:e.debug,limits:h,waterMark:d,colors:e.customColors}),a_e(e.customColors),to.createOrUpdateParticipant({name:m.name,participantId:m.id,avatar:(r=m.avatar)==null?void 0:r.imageUrl}),r_e(e)}),_J=o_e;nt();nt();var y3=class extends Bn{render(){return Vt` <div>Hello from SuperViz, ${this.name}</div> `}};y3.properties={name:{type:String}},y3.styles=Zn`
    div {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: black;
      color: white;
    }
  `,y3=Rs([Ps("superviz-hello-world")],y3);nt();nt();nt();nt();var l_e=Zn`
  * {
    --sv-primary: 98, 16, 204;
    --sv-primary-900: 56, 7, 136;
    --sv-primary-200: 193, 161, 234;
    --sv-secondary: 193, 251, 223;
    --sv-gray: 126, 122, 136;
    --sv-success: 12, 185, 71;
    --sv-danger: 229, 65, 30;
    --sv-black: 19, 18, 21;
    --sv-white: 255, 255, 255;
    --sv-gray-100: 250, 250, 252;
    --sv-gray-200: 233, 229, 239;
    --sv-gray-300: 201, 196, 209;
    --sv-gray-400: 174, 169, 184;
    --sv-gray-500: 126, 122, 136;
    --sv-gray-600: 87, 83, 95;
    --sv-gray-700: 57, 54, 62;
    --sv-gray-800: 38, 36, 42;
  }

  .sv-gray-200 {
    color: rgb(var(--sv-gray-200));
  }

  .sv-gray-400 {
    color: rgb(var(--sv-gray-400));
  }

  .sv-gray-500 {
    color: rgb(var(--sv-gray-500));
  }

  .sv-gray-600 {
    color: rgb(var(--sv-gray-600));
  }

  .sv-gray-700 {
    color: rgb(var(--sv-gray-700));
  }
`;nt();var u_e=Zn`
  .text {
    font-family: Roboto;
    font-size: 12px;
    font-style: normal;
    font-weight: 400;
    line-height: 20px;
  }

  .text-bold {
    font-weight: 700;
  }

  .text-big {
    font-size: 14px;
  }

  .text-small {
    font-size: 10px;
  }
`;nt();var c_e=Zn`
  .sv-hr {
    width: 100%;
    height: 1px;
    background: rgb(var(--sv-gray-200));
    padding: 0px;
    margin: 0px;
    position: relative;
  }
`;nt();var h_e=Zn`
  .icon-button {
    display: flex;
    justify-content: center;
    align-items: center;
    background: rgba(0, 0, 0, 0);
    border: 0px;
    width: 32px;
    height: 32px;
  }

  .icon-button > superviz-icon {
    display: flex !important;
  }

  .icon-button--xsmall {
    width: 18px;
    height: 18px;
  }

  .icon-button--small {
    width: 24px;
    height: 24px;
  }

  .icon-button--medium {
    width: 32px;
    height: 32px;
  }

  .icon-button--large {
    width: 40px;
    height: 40px;
  }

  .icon-button--clickable {
    cursor: pointer;
    border-radius: 100%;
  }

  .icon-button--clickable:hover:not(.icon-button--no-hover) {
    background: rgb(var(--sv-gray-300));
    transition: 0.25s background-color ease-in;
  }
  
  .icon-button--clickable:focus:not(.icon-button--no-hover) {
    transition: 0.25s background-color ease-in;
    background: rgb(var(--sv-gray-300));
  }
`,Is=i=>{var e;class t extends i{constructor(){super(...arguments),this.unsubscribeFrom=[],this.useStore=VB.bind(this)}connectedCallback(){setTimeout(()=>{var n,l;let c=document.getElementById("superviz-style"),h=this.createCustomColors(),d=document.createElement("style");d.innerHTML=(c==null?void 0:c.innerHTML)||"",(n=this.shadowRoot)==null||n.appendChild(d),h&&((l=this.shadowRoot)==null||l.appendChild(h))}),super.connectedCallback()}disconnectedCallback(){super.disconnectedCallback(),this.unsubscribeFrom.forEach(n=>n(this))}createCustomColors(){if(!Fi.get("colors"))return;let n=document.createElement("style"),l=Object.entries(Fi.get("colors")).map(([c,h])=>`--${c}: ${h} !important;`).join(" ");return n.innerHTML=`
      * {
        ${l}
      }
    `,n}emitEvent(n,l,c={composed:!0,bubbles:!0}){let h=new CustomEvent(n,ir({detail:l},c));this.dispatchEvent(h)}}return t.styles=[l_e,u_e,c_e,h_e,(e=i.styles)!=null?e:[]],t};nt();var xJ=(i=>(i[i.xs=14]="xs",i[i.sm=18]="sm",i[i.md=24]="md",i[i.lg=36]="lg",i[i.xl=44]="xl",i))(xJ||{}),bJ=Is(Bn),d_e=[bJ.styles],_3=class extends bJ{constructor(){super(),this.name="",this.size="md"}get iconSize(){return xJ[this.size]}render(){var e;return this.color||(this.color="black"),Vt`
      <i
        class="sv-icon sv-icon-${this.name}_${(e=this.suffix)!=null?e:this.size} ${this.color}"
        style="font-size: ${this.iconSize}px"
      ></i>
    `}};_3.properties={name:{type:String},size:{type:String},color:{type:String},suffix:{type:String}},_3.styles=[d_e,Zn`
      div {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: black;
        color: white;
      }

      i,
      i.black {
        color: rgba(var(--sv-gray-600));
      }

      i.white {
        color: white;
      }
    `],_3=Rs([Ps("superviz-icon")],_3);nt();nt();function gu(i){let e=document.getElementById(`superviz-${i}-styles`);if(!e)return;let t=new CSSStyleSheet;t.replaceSync(e.textContent),this.shadowRoot.adoptedStyleSheets=[...this.shadowRoot.adoptedStyleSheets,t]}nt();var f_e=Zn`
  .dropdown {
    position: relative;
    z-index: 100;
  }

  .dropdown-content {
    display: flex;
  }

  .select-clicked {
    border: 2px #26489a solid;
  }

  .dropdown-list {
    position: relative;
    z-index: 101;
  }

  .header {
    display: grid;
    grid-template-rows: 1fr 1px;
    align-items: center;
    padding: 0 10px;
    min-height: 42px;
    font-size: 16px;
    color: rgb(var(--sv-gray-600));
  }

  .menu {
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
    opacity: 0;
    display: none;
    background: #fff;
    padding: 0;
    z-index: 1;
    transition: 0.2s;
    border-radius: 3px;
  }

  .items {
    list-style: none;
    padding: 0;
    color: #9fa5b5;
    margin: 0;
  }

  .text.username {
    font-size: 14px;
    text-align: left;

    display: inline-block;
    vertical-align: middle;
    line-height: normal;
    padding: 8px 0;
  }

  .items li {
    color: rgb(var(--sv-gray-600));
    text-transform: uppercase;
    padding: 0 10px;
    cursor: pointer;
    min-width: 103px;
    min-height: 32px;
    display: flex;
    align-items: center;
    justify-content: flex-start;
    gap: 5px;
    height: 42px;
  }

  .sv-icon {
    width: 40px;
    height: 40px;
    background-color: red;
  }

  .active {
    background: rgb(var(--sv-gray-200));
  }

  .items li:hover {
    background: rgb(var(--sv-gray-200));
  }

  .menu-open {
    display: block;
    opacity: 1;
    position: fixed;
  }

  .sv-hr {
    width: 100%;
    height: 1px;
    background: rgb(var(--sv-gray-300));
    padding: 0px;
    margin: 0px;
    justify-self: flex-end;
  }

  .option-label {
    white-space: nowrap;
    line-height: 1;
  }

  .who-is-online__controls__item__icon {
    line-height: 1;
  }

  .who-is-online__controls__item {
    align-items: center;
  }

  @media (max-width: 780px) {
    .menu--top-left,
    .menu--top-center,
    .menu--top-right {
      bottom: 36px;
    }
  }
`,wJ=Is(Bn),p_e=[wJ.styles,f_e],x3=class extends wJ{constructor(){super(),this.menu=void 0,this.onClickOutDropdown=e=>{if(e.stopPropagation(),!this.open)return;let t=e.composedPath(),r=this.shadowRoot.querySelector(".dropdown-content"),n=this.shadowRoot.querySelector(".dropdown-list"),l=this.shadowRoot.querySelector('slot[name="dropdown"]').assignedElements()[0],c=t.includes(r),h=t.includes(n),d=t.includes(l);c||h||d||this.close()},this.close=()=>{this.open=!1,this.emitEvent("close",{bubbles:!1,composed:!1})},this.callbackSelected=({label:e})=>{this.open=!1,this.emitEvent("selected",Ia(ir({},this.returnData),{label:e}),{bubbles:!1,composed:!0})},this.adjustPosition=()=>{if(!this.open){cancelAnimationFrame(this.animationFrame);return}this.setHorizontalPosition(),this.setPositionVertical(),this.animationFrame=requestAnimationFrame(this.adjustPosition)},this.tooltip=()=>{if(!this.canShowTooltip)return"";let e=this.lastParticipant?"tooltip-top":"tooltip-bottom";return Vt` <superviz-tooltip
      tooltipData=${JSON.stringify(this.tooltipData)}
      ?shiftTooltipLeft=${this.shiftTooltipLeft}
      tooltipVerticalPosition=${e}
      classesPrefix="${this.tooltipPrefix}__tooltip"
      parentComponent=${this.parentComponent}
    ></superviz-tooltip>`},this.showTooltip=!1,this.returnData={}}firstUpdated(e){super.firstUpdated(e),this.updateComplete.then(()=>{this.menu=this.shadowRoot.querySelector(".menu"),gu.call(this,[this.parentComponent])})}disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener("click",this.onClickOutDropdown);let e=this.shadowRoot.querySelector(".dropdown");e==null||e.removeEventListener("mouseenter",()=>{this.showTooltip=!0}),e==null||e.removeEventListener("mouseleave",()=>{this.showTooltip=!1})}updated(e){if(e.has("open")){if(this.emitEvent("toggle-dropdown-state",{open:this.open,font:this.name},{bubbles:!1,composed:!1}),this.open){document.addEventListener("click",this.onClickOutDropdown),this.animationFrame=requestAnimationFrame(this.adjustPosition);return}document.removeEventListener("click",this.onClickOutDropdown)}}setHorizontalPosition(){let e=this.shadowRoot.querySelector('slot[name="dropdown"]'),{left:t,right:r,width:n}=e.parentElement.getBoundingClientRect(),{width:l}=this.menu.getBoundingClientRect(),c=t-(l-n)/2<0,h=r+(l-n)/2>window.innerWidth;if(this.shiftTooltipLeft){this.menu.style.left=`${t+8}px`,this.menu.style.right="",this.menu.style.transform="translate(0, 0)";return}if(!c&&!h){this.menu.style.left=`${t}px`,this.menu.style.right="",this.menu.style.transform=`translate(calc(-50% + ${n/2}px), 0)`;return}if(!c){this.menu.style.left="",this.menu.style.right=`${window.innerWidth-r}px`,this.menu.style.transform="translate(0, 0)";return}h||(this.menu.style.right="",this.menu.style.left=`${r-n}px`,this.menu.style.transform="translate(0, 0)")}setPositionVertical(){let e=this.shadowRoot.querySelector('slot[name="dropdown"]'),{top:t,bottom:r}=e.parentElement.getBoundingClientRect(),{height:n}=this.menu.getBoundingClientRect(),l=this.shiftTooltipLeft?-2:8;if(!(r+n+l>window.innerHeight)){this.menu.style.bottom="",this.menu.style.top=`${r+l}px`;return}this.menu.style.top="auto",this.menu.style.bottom=`${window.innerHeight-t+l}px`}get renderHeader(){return this.name?Vt` <div class="header ${this.getClass("header")}">
      <span class="text username ${this.getClass("title")}">${this.name}</span>
      <span class="sv-hr ${this.getClass("divisor")}"></span>
    </div>`:Vt``}toggle(){this.disabled||(this.open=!this.open,this.emitEvent("open",{open:this.open}))}getIcon(e){if(e)return Vt`
      <span class=${this.getClass("item__icon")}>
        <superviz-icon name="${e}" size="sm"></superviz-icon>
      </span>
    `}getLabel(e){return Vt`<span class="option-label ${this.getClass("item__label")}">${e}</span>`}get listOptions(){return this.options.map(({label:e,icon:t,active:r})=>{let n={text:!0,[this.getClass("item")]:!0,"text-bold":!0,active:r};return Vt`<li @click=${()=>this.callbackSelected({label:e})} class=${Hr(n)}>
        ${this.getIcon(t)} ${this.getLabel(e)}
      </li>`})}getClass(e){return`${this.classesPrefix}__${e}`}render(){let e={menu:!0,"menu-open":this.open,"menu-left":this.align==="left","menu-right":this.align==="right","who-is-online-dropdown":this.name};return Vt`
      <div class="dropdown">
        <div class="dropdown-content" @click=${this.toggle}>
          <slot name="dropdown"></slot>
        </div>
        ${this.tooltip()}
      </div>
      <div class="dropdown-list">
        <div class=${Hr(e)}>
          ${this.renderHeader}
          <ul class="${this.getClass("items")} items">
            ${this.listOptions}
          </ul>
        </div>
      </div>
    `}};x3.styles=p_e,x3.properties={open:{type:Boolean},disabled:{type:Boolean},align:{type:String},options:{type:Array},icons:{type:Array},name:{type:String},tooltipData:{type:Object},showTooltip:{type:Boolean},dropdown:{type:Object},canShowTooltip:{type:Boolean},drodpdownSizes:{type:Object},shiftTooltipLeft:{type:Boolean},lastParticipant:{type:Boolean},classesPrefix:{type:String},parentComponent:{type:String},tooltipPrefix:{type:String},returnData:{type:Object}},x3=Rs([Ps("superviz-dropdown")],x3);nt();nt();var m_e=Zn`
  .superviz-who-is-online__tooltip {
    --host-height: 0px;
    --host-width: 0px;
    --vertical-offset: 12px;

    background-color: rgb(var(--sv-gray-600));
    padding: 10px;
    display: flex;
    flex-direction: column;
    gap: 8px;
    align-items: center;
    position: fixed;
    opacity: 0;
    border-radius: 2px;
    cursor: default;
    visibility: hidden;
    transition: opacity 0.2s ease-in-out display 0s;
    z-index: 100;
    overflow-x: clip;
  }

  .superviz-who-is-online__tooltip-arrow {
    width: 13px;
    height: 13px;
    position: absolute;
    background-color: rgb(var(--sv-gray-600));
    transform: rotate(45deg);
    border-top-left-radius: 1px;
    border-bottom-right-radius: 1px;
  }

  .show-tooltip {
    opacity: 1;
    visibility: visible;
  }

  .tooltip-name,
  .tooltip-action {
    margin: 0;
    font-family: roboto;
    white-space: nowrap;
    text-align: center;
    line-height: 1.2;
  }

  .tooltip-name {
    color: white;
    font-size: 14px;
  }

  .tooltip-action {
    color: rgb(var(--sv-gray-400));
    font-size: 12px;
  }

  .tooltip-top {
    bottom: calc(var(--host-height) + var(--vertical-offset));
  }

  .tooltip-bottom {
    bottom: auto;
  }

  .tooltip-center {
    right: auto;
  }

  .tooltip-bottom .superviz-who-is-online__tooltip-arrow {
    top: -6.5px;
  }

  .tooltip-top .superviz-who-is-online__tooltip-arrow {
    bottom: -6.5px;
  }

  .tooltip-center .superviz-who-is-online__tooltip-arrow {
    left: 0;
    margin-left: 50%;
    translate: -50% 0;
  }

  .tooltip-left .superviz-who-is-online__tooltip-arrow {
    translate: 50% 0;
    border-radius: 0;
    right: 0;
  }

  .tooltip-right .superviz-who-is-online__tooltip-arrow {
    translate: -50% 0;
    border-radius: 0;
    left: 0;
  }

  .shift-left {
    --vertical-offset: 2px;
  }
`;nt();var SJ=Is(Bn),g_e=[SJ.styles,m_e],b3=class extends SJ{constructor(){super(),this.positionFixedTooltip=()=>{var e,t,r,n,l;if(!this.canAnimate||!this.parentElement){this.hide();return}this.adjustTooltipPosition();let{bottom:c,left:h,width:d,right:f,top:m}=this.parentElement.getBoundingClientRect(),{width:g}=this.tooltip.getBoundingClientRect(),y="auto",_="auto",b="auto",S="auto",E="",T=window.innerWidth>780,A=T?14:12;this.tooltipHorizontalPosition.includes("right")&&(b=`${h+d/2}px`),this.tooltipHorizontalPosition.includes("left")&&(S=`${window.innerWidth-(f-d/2)}px`),this.tooltipHorizontalPosition.includes("center")&&(b=`${h}px`,E=`translateX(-${(g-d)/2}px)`),this.tooltipVerticalPosition.includes("bottom")&&(y=`${c+A}px`,A=-10),this.tooltipVerticalPosition.includes("top")&&(_=`${window.innerHeight-(m-A)}px`,A=10),this.shiftTooltipLeft&&(E=`translate(-${(g-(T?18:10)-42)/2}px, ${A}px)`),(e=this.tooltip)==null||e.style.setProperty("top",y),(t=this.tooltip)==null||t.style.setProperty("left",b),(r=this.tooltip)==null||r.style.setProperty("right",S),(n=this.tooltip)==null||n.style.setProperty("bottom",_),(l=this.tooltip)==null||l.style.setProperty("transform",E),this.animationFrame=window.requestAnimationFrame(this.positionFixedTooltip)},this.hide=()=>{this.canAnimate=!1,this.showTooltip=!1,window.cancelAnimationFrame(this.animationFrame)},this.show=()=>{this.canAnimate=!0,this.showTooltip=!0,this.positionFixedTooltip()},this.adjustTooltipVerticalPosition=()=>{let{bottom:e,top:t,width:r}=this.tooltip.getBoundingClientRect(),n=window.innerHeight;if(this.tooltipVerticalPosition.includes("top")&&t<0){this.tooltipVerticalPosition=this.tooltipVerticalPosition.replace("top","bottom");return}this.tooltipVerticalPosition.includes("bottom")&&e>n&&(this.tooltipVerticalPosition=this.tooltipVerticalPosition.replace("bottom","top"))},this.adjustTooltipHorizontalPosition=()=>{let{left:e,right:t,width:r}=this.tooltip.getBoundingClientRect(),n=window.innerWidth,{left:l,width:c,right:h}=this.parentElement.getBoundingClientRect(),d=l+c/2-r/2>0,f=r/2+h-c/2<n;if(d&&f){this.tooltipHorizontalPosition=this.tooltipHorizontalPosition.replace(/left|right/,"center");return}if(e<0){this.tooltipHorizontalPosition=this.tooltipHorizontalPosition.replace("center","right");return}t>n&&(this.tooltipHorizontalPosition=this.tooltipHorizontalPosition.replace("center","left"))},this.adjustTooltipPosition=()=>{if(!this.parentElement){this.hide();return}this.tooltip||(this.tooltip=this.shadowRoot.querySelector(".superviz-who-is-online__tooltip")),this.adjustTooltipVerticalPosition(),this.adjustTooltipHorizontalPosition()},this.tooltipVerticalPosition="tooltip-bottom",this.tooltipHorizontalPosition="tooltip-center",this.showTooltip=!1,this.parentSizes={height:0,width:0}}firstUpdated(e){let{parentElement:t}=this;t==null||t.addEventListener("mouseenter",this.show),t==null||t.addEventListener("mouseleave",this.hide),this.adjustTooltipPosition(),gu.call(this,this.parentComponent)}disconnectedCallback(){super.disconnectedCallback();let{parentElement:e}=this;e==null||e.removeEventListener("mouseenter",this.show),e==null||e.removeEventListener("mouseleave",this.hide)}updated(e){if(e.has("showTooltip")&&this.showTooltip){let{parentElement:t}=this;if(!t)return;let{height:r,width:n}=t.getBoundingClientRect();(this.parentSizes.height!==r||this.parentSizes.width!==n)&&(this.parentSizes={height:r,width:n})}}getClass(e){return e?`${this.classesPrefix}__${e}`:this.classesPrefix}renderTooltip(){var e,t,r,n,l;let c=this.tooltipVerticalPosition,h=this.tooltipHorizontalPosition,d={"superviz-who-is-online__tooltip":!0,[this.getClass("")]:!0,[c]:!0,[h]:!0,"tooltip-extras":this.tooltipOnLeft,"show-tooltip":this.showTooltip,"shift-left":this.shiftTooltipLeft};return Vt`<div
      class=${Hr(d)}
      style="--host-height: ${(e=this.parentSizes)==null?void 0:e.height}px; --host-width: ${(t=this.parentSizes)==null?void 0:t.width}px;"
    >
      <p class="tooltip-name ${this.getClass("title")}">${(r=this.tooltipData)==null?void 0:r.name}</p>
      ${(n=this.tooltipData)!=null&&n.info?Vt`<p class="tooltip-action ${this.getClass("action")}">${(l=this.tooltipData)==null?void 0:l.info}</p>`:""}
      <div class="superviz-who-is-online__tooltip-arrow ${this.getClass("")}"></div>
    </div>`}render(){return Vt`${this.renderTooltip()}`}};b3.styles=g_e,b3.properties={tooltipData:{type:Object},tooltipOnLeft:{type:Boolean},showTooltip:{type:Boolean},tooltip:{type:Object},tooltipVerticalPosition:{type:String},tooltipHorizontalPosition:{type:String},parentSizes:{type:Object},shiftTooltipLeft:{type:Boolean},classesPrefix:{type:String},parentComponent:{type:String}},b3=Rs([Ps("superviz-tooltip")],b3);nt();nt();nt();var MJ=Zn`
  .modal--overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(var(--sv-gray-400), 0.8);

    z-index: 999;
  }

  .modal--container {
    display: flex;
    align-items: center;
    justify-content: center;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: transparent;

    z-index: 1000;
  }

  .modal--container > .modal {
    background: #fff;
    min-width: 370px;
    min-height: 150px;
    border-radius: 6px;
  }

  .modal--container > .modal > .modal--header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 16px;
    background: rgb(var(--sv-gray-200));
    border-radius: 6px 6px 0 0;
  }

  .modal--container > .modal > .modal--header > .text {
    display: flex;
    align-items: center;
  }

  .modal--container > .modal > .modal--header > .close {
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    color: rgb(var(--sv-gray-600));
    cursor: pointer;
  }

  .modal--container > .modal > .modal--body {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 24px 24px 0 24px;
  }

  .modal--container > .modal > .modal--body > .modal--body-content {
    padding: 8px 0;
    text-align: center;
  }

  .modal--container > .modal > .modal--footer {
    padding: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 24px;
    padding: 24px;
  }

  .btn {
    width: 150px;
    height: 40px;
    text-transform: uppercase;
  }

  .btn--confirm {
    background: rgb(var(--sv-primary));
    border-radius: 4px;
    border: 1px solid rgb(var(--sv-primary));
    color: #fff;
    cursor: pointer;
  }

  .btn--cancel {
    background: transparent;
    border-radius: 4px;
    border: 1px solid rgb(var(--sv-gray-400));
    color: rgb(var(--sv-gray-400));
    cursor: pointer;
  }
`,EJ=Is(Bn),v_e=[EJ.styles,MJ],WN=class extends EJ{constructor(){super(...arguments),this.getContainer=()=>window.document.querySelector("superviz-modal-container"),this.createContainer=e=>{this.modal=document.createElement("superviz-modal-container"),this.modal.setOptions(e)},this.createModal=({detail:e})=>{this.createContainer(e),window.document.body.appendChild(this.modal)},this.destroyModal=()=>{var e;this.modal=void 0,(e=this.getContainer())==null||e.remove()}}firstUpdated(){window.document.body.addEventListener("superviz-modal--open",this.createModal),window.document.body.addEventListener("superviz-modal--close",this.destroyModal)}disconnectedCallback(){this.destroyModal(),window.document.body.removeEventListener("superviz-modal--open",this.createModal),window.document.body.removeEventListener("superviz-modal--close",this.destroyModal)}};WN.styles=v_e,WN=Rs([Ps("superviz-modal")],WN);nt();var TJ=Is(Bn),y_e=[TJ.styles,MJ],jN=class extends TJ{constructor(){super(...arguments),this.closeModal=()=>{window.document.body.dispatchEvent(new CustomEvent("superviz-modal--close",{bubbles:!0,composed:!0}))},this.confirmModal=()=>{window.document.body.dispatchEvent(new CustomEvent("superviz-modal--confirm",{bubbles:!0,composed:!0}))}}setOptions(i){this.options=i}render(){let i=()=>Vt`
        <div class="modal--header">
          <span class="text text-bold sv-gray-600">${this.options.title}</span>
          <div class="close" @click=${this.closeModal}>
            <superviz-icon name="close" size="md"></superviz-icon>
          </div>
        </div>
      `,e=()=>Vt`
        <div class="modal--body">
          <div class="modal--body-content">${this.options.body}</div>
        </div>
      `,t=()=>{if(this.options.footer)return Vt` <div class="modal--footer">${this.options.footer}</div> `;let r=this.options.confirmLabel||"OK",n=this.options.cancelLabel||"Cancel";return this.options.confirm&&this.options.cancel?Vt`
          <div class="modal--footer">
            <button class="text text-bold btn btn--cancel" @click=${this.closeModal}>
              ${n}
            </button>
            <button class="text text-bold btn btn--confirm" @click=${this.confirmModal}>
              ${r}
            </button>
          </div>
        `:Vt`
        <div class="modal--footer">
          <button class="text text-bold btn btn--confirm" @click=${this.confirmModal}>
            ${r}
          </button>
        </div>
      `};return Vt`
      <div class="modal--overlay"></div>
      <div class="modal--container">
        <div class="modal">${i()} ${e()} ${t()}</div>
      </div>
    `}};jN.styles=y_e,jN=Rs([Ps("superviz-modal-container")],jN);nt();nt();nt();nt();var __e=Zn`
  .superviz-comments {
    --offset-left: 10px;
    --offset-right: 10px;
    --offset-top: 10px;
    --offset-bottom: 10px;

    display: flex;
    flex-direction: column;
    width: 320px;
    position: fixed;
    color: rgb(var(--sv-gray-700));
    background: rgb(var(--sv-white));
    top: 0px;
    bottom: 0;
    box-shadow: -2px 0 4px 0 rgba(0, 0, 0, 0.1);
    z-index: 100;
    overflow: hidden;
    transition: right 0.3s ease-out;
  }

  .header {
    width: 100%;
  }

  .content {
    flex: 1;
    overflow-y: auto;
    overflow-x: hidden;
  }

  .toggle {
    display: flex;
    position: fixed;
    width: 100px;
    color: rgb(var(--sv-gray-700));
    background: rgb(var(--sv-white));
    top: 0;
    right: 0;
    bottom: 0;
  }

  .threads-on-left-side {
    left: var(--offset-left);
    top: var(--offset-top);
    bottom: var(--offset-bottom);
    border-radius: 8px;
  }

  .threads-on-right-side {
    right: var(--offset-right);
    top: var(--offset-top);
    bottom: var(--offset-bottom);
    border-radius: 8px;
  }

  #superviz-comments.threads-on-right-side.hide-at-right {
    right: -330px;
  }

  #superviz-comments.threads-on-left-side.hide-at-left {
    left: -330px;
  }

  .hide-at-right,
  .hide-at-left {
    animation: keep-opacity 0.3s ease-out;
    opacity: 0;
    visibility: hidden;
  }

  @keyframes keep-opacity {
    0%,
    99% {
      visibility: visible;
      opacity: 1;
    }

    100% {
      visibility: hidden;
      opacity: 0;
    }
  }
`;nt();var x_e=Zn`
  .comments__topbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: rgb(var(--sv-gray-200));
    height: 50px;
  }

  .comments__topbar__title {
    margin: 0 16px;
    color: rgb(var(--sv-gray-600));
  }

  .comments__topbar__close-threads {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    transition: 0.15s;
    border-radius: 50%;
    width: 32px;
    height: 32px;
    box-sizing: border-box;
    margin-right: 8px;
    padding-right: 2px;
  }

  .comments__topbar__close-threads:hover {
    background: rgb(var(--sv-gray-300));
  }
`;nt();var b_e=Zn`
  .reply {
    padding-left: 24px !important;
  }

  .comments__comment-item {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    justify-content: center;
    padding: 8px;
    gap: 4px;
  }

  .comments__comment-item__header {
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    width: 100%;
    align-items: center;
    color: rgb(var(--sv-gray-500));
  }

  .comments__comment-item__actions {
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .comments__comment-item__actions superviz-dropdown,
  .comments__comment-item__icons {
    width: 25px;
    height: 25px;
    border-radius: 50%;
  }

  .comments__comment-item__metadata {
    display: flex;
    width: 100%;
    gap: 8px;
    align-items: center;
  }

  .comments__comment-item__avatar-container {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    overflow: hidden;
    background-color: rgb(var(--sv-gray-300));
    border: 1px solid rgb(var(--sv-gray-500));
    color: #fff;

    display: flex;
    align-items: center;
    justify-content: center;
  }

  .comments__comment-item__avatar-image {
    width: 100%;
    height: 100%;
    object-fit: contain;
    border-radius: 50%;
  }

  .comments__comment-item__content {
    width: 100%;
    word-wrap: break-word;
  }

  .line-clamp {
    display: -webkit-box;
    -webkit-line-clamp: 4;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .comments__comment-item__content__body {
    color: rgb(var(--sv-gray-700));
    position: relative;
    display: grid;
    grid-template-rows: 0px auto;
  }

  .comments__comment-item__content__body.editing-annotation {
    grid-template-rows: auto 0px;
  }

  .hidden {
    display: none;
  }

  .mentioned {
    display: inline-block;
  }

  .annotation-content {
    transition: opacity 0ms;
    opacity: 1;
    overflow: hidden;
  }

  .editing {
    transition: opacity 400ms;
    overflow: hidden;
    opacity: 0;
    pointer-events: none;
  }

  .comments__input--editable {
    transform: translateY(0);
    opacity: 1;
    overflow: hidden;
  }

  .hide-edit-input {
    transition: opacity 500ms, transform 0 linear 300ms;
    opacity: 0;
    pointer-events: none;
    width: 100%;
  }
`;nt();var w_e=Zn`
  .comments {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 288px;
  }

  .hidden {
    display: none;
  }
`;nt();var S_e=Zn`
  .comments__input {
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    background: rgb(var(--sv-white));
    border-radius: 4px;
    border: 1px solid rgb(var(--sv-gray-300));
    position: relative;
    min-height: 40px;
    box-sizing: border-box;
  }

  .comments__input:focus-within {
    border: 1px solid rgb(var(--sv-gray-500));
  }

  .comments__input__textarea {
    border: 0px;
    text-align: left;
    border-radius: 4px;
    outline: none;
    font-size: 14px;
    color: rgb(var(--sv-gray-700));
    font-family: Roboto;
    white-space: pre-wrap;
    word-wrap: break-word;
    resize: none;
    line-height: 1.15rem;
    max-height: 5rem;
    appearance: none;
    height: 40px;
    width: 100%;
    box-sizing: border-box;

    padding-top: 7px;
    border-top: 8px solid transparent;
    border-bottom: 8px solid transparent;
    border-right: 11px solid transparent;
    border-left: 11px solid transparent;
  }

  .fixed-width {
    width: 288px;
  }

  .comments__input__textarea:invalid {
    border-top: 15px solid transparent;
  }

  .comments__input__textarea::placeholder {
    color: rgb(var(--sv-gray-400));
    font-size: 14px;
    line-height: 14px;
  }

  .comments__input__options {
    display: flex;
    justify-content: space-between;
    box-sizing: border-box;
    overflow: hidden;
    height: 0;
    transition: 0.25s;
    border-radius: 0 0 4px 4px;
  }

  .active-textarea {
    height: 40px;
    padding: 4px 8px;
  }

  .sv-hr {
    border: none;
    width: 100%;
    opacity: 0;
    transition: 0.25s opacity linear, 0.25s visibility;
    visibility: hidden;
    height: 0;
    position: absolute;
  }

  .comments__input__divisor {
    border-top: 1px solid rgb(var(--sv-gray-300));
    opacity: 1;
    position: relative;
    visibility: visible;
  }

  .comment-actions {
    position: absolute;
    left: 8px;
    bottom: 3px;
    opacity: 0;
    transition: 0.25s opacity linear, 0.25s visibility;
    visibility: hidden;
  }

  .active-textarea > .comment-actions {
    opacity: 1;
    visibility: visible;
  }

  .mention:hover {
    background-color: rgb(var(--sv-gray-200));
  }

  .comments__input__button {
    display: flex;
    justify-content: center;
    align-items: center;
    border-radius: 100%;
    width: 32px;
    height: 32px;
    border: 0px;
  }

  .comments__input__send-button {
    background: rgb(var(--sv-primary));
    color: rgba(var(--sv-white), 1);
  }

  .align-send-btn > superviz-icon {
    cursor: pointer;
  }

  .comments__input__button:disabled {
    background: rgb(var(--sv-gray-200));
    color: rgb(var(--sv-gray-600));
  }

  .comment-input-options {
    display: flex;
    gap: 4px;
    position: absolute;
    right: 8px;
    bottom: 4px;
  }

  .comments__input__textarea:focus,
  .comments__input__textarea.active-textarea {
    border-radius: 4px 4px 0 0;
  }

  .comments__input__textarea:focus::placeholder {
    color: transparent;
  }
`;nt();var M_e=Zn`
  .comments__thread:hover:not(.comments__thread--selected) {
    background-color: rgba(var(--sv-gray-200), 0.3);
  }

  .avatars-comments {
    display: flex;
    position: absolute;
    bottom: 8px;
    padding: 0 8px;
    opacity: 1;
    transition: opacity 0.3s linear;
  }

  .avatars-comments.invisible {
    opacity: 0;
  }

  .avatar-container {
    position: relative;
    display: flex;
    align-items: center;
    width: 100%;
  }

  .avatar {
    width: 18px;
    height: 18px;
    border-radius: 50%;
    overflow: hidden;
    background-color: rgb(var(--sv-gray-300));
    border: 1px solid rgb(var(--sv-gray-500));
    color: #fff;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .avatar img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    border-radius: 50%;
  }

  .avatar:not(:first-child) {
    margin-left: -6px;
  }

  .comments__thread--selected div:last-child {
    margin-inline: 8px;
  }

  .comments-container {
    display: flex;
    overflow: hidden;
    flex-direction: column;
  }

  .comments-container-wrapper {
    display: grid;
    grid-template-rows: 0fr;
    opacity: 0;
    overflow: hidden;
    transition: grid-template-rows 0.3s linear, opacity 0.3s linear;
  }

  .comments-container-wrapper.show {
    grid-template-rows: 1fr;
    opacity: 1;
  }

  .comments--expand {
    display: flex;
  }

  .comment-avatar--expand {
    display: block;
  }

  .hidden {
    overflow: hidden;
    opacity: 0;
  }

  .comments__thread {
    grid-row: 1 / span 2;
    padding: 8px;
    position: relative;
    cursor: pointer;
    transition: padding-bottom 0.3s linear, opacity 0.3s linear;
  }

  .extra-space-bottom {
    padding-bottom: 35px;
  }

  .comments__thread--selected {
    background-color: rgba(var(--sv-gray-200), 0.5);
    padding-bottom: 16px;
  }

  .hide-input {
    display: none;
  }

  .wrapper {
    margin-inline: 0;
    display: grid;
    grid-template-rows: 0fr;
    opacity: 0;
    width: 100%;
    transition: grid-template-rows 0.3s linear, opacity 0.3s linear;
  }

  .show-wrapper {
    grid-template-rows: 1fr;
    opacity: 1;
  }

  .comments__complete-annotation {
    position: relative;
    width: 100%;
  }

  .comments__hide-complete-annotation {
    min-height: 0;
    opacity: 0;
    animation: hide-annotation 10s linear;
  }

  @keyframes hide-annotation {
    0%,
    95% {
      min-height: 43px;
      opacity: 1;
    }

    100% {
      opacity: 0;
      min-height: 0;
    }
  }

  .comments__resolved-annotation-message {
    position: absolute;
    width: 100%;
    top: 0;
  }
`;nt();var E_e=Zn`
  .comments__annotation-resolved {
    background: rgba(var(--sv-gray-200), 0.5);
    height: 26px;
    padding: 8px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    border-bottom: 1px solid rgb(var(--sv-gray-200));
  }
`;nt();var T_e=Zn`
  .preload {
    animation-duration: 0s !important;
  }

  .comments__annotation-pin,
  .comments__annotation-pin__avatar {
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    pointer-events: auto;
    z-index: 10;
    transform-origin: bottom left;
  }

  .comments__annotation-pin:hover {
    transform: scale(1.2);
    animation: growing-spring 0.3s linear;
  }

  .comments__annotation-pin:not(:hover) {
    animation: shrinking-spring 0.3s linear;
  }

  .comments__annotation-pin--add {
    transform: scale(1) !important;
    animation: none !important;
  }

  .comments__annotation-pin {
    position: absolute;

    width: 32px;
    height: 32px;

    background-color: rgb(var(--sv-white));
    border-radius: 50%;
    border-bottom-left-radius: 2px;

    border: 2px solid rgb(var(--sv-white));
    box-shadow: 0px 2px 6px 0px rgba(0, 0, 0, 0.35);
    transition: border-color 0.2s ease-in-out opacity 0.2s ease-in-out;
    padding: 2px;
    box-sizing: border-box;
    cursor: pointer;
  }

  .comments__annotation-pin:hover,
  .comments__annotation-pin:focus,
  .comments__annotation-pin--active {
    border-color: rgb(var(--sv-primary));
  }

  .comments__cursor-pointer,
  .comments__cursor-pointer .comments__annotation-pin__avatar {
    pointer-events: none;
  }

  .comments__annotation-pin__avatar {
    width: 100%;
    height: 100%;

    background-color: rgb(var(--sv-gray-400));
    border-radius: 50%;

    color: rgb(var(--sv-white));
  }

  .comments__annotation-pin__avatar img {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    object-fit: contain;
  }

  .comments__annotation-pin__avatar--add {
    color: rgb(var(--sv-gray-700));
    background-color: rgb(var(--sv-white));
  }

  .floating-input {
    position: absolute;
    top: -2px;
    opacity: 0;
  }

  .left .floating-input {
    right: auto;
    left: 0;
    transform: translateX(calc(-100% - 7px));
    opacity: 1;
  }

  .right .floating-input {
    left: auto;
    right: 0;
    transform: translateX(calc(100% + 7px));
    opacity: 1;
  }

  .comments__annotation-pin-wrapper {
    transform-origin: center;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    position: absolute;
  }

  .comments__annotation-pin-wrapper--new {
    animation: bounce 0.5s linear !important;
  }

  .comments__annotation-pin-wrapper--new .comments__annotation-pin__avatar {
    transform-origin: center;
    animation: avatar-bounce 0.5s linear !important;
  }

  @keyframes avatar-bounce {
    0%,
    40% {
      transform: scale(1);
    }

    48% {
      transform: scale(0.8);
    }

    55%,
    92% {
      transform: scale(1);
    }

    96% {
      transform: scale(0.9);
    }

    100% {
      transform: scale(1);
    }
  }
  @keyframes bounce {
    0% {
      transform: scale(1);
    }

    20% {
      transform: scale(1.3);
    }

    40%,
    55% {
      transform: scale(1);
    }

    75% {
      transform: scale(1.15);
    }

    92%,
    100% {
      transform: scale(1);
    }
  }

  @keyframes growing-spring {
    0% {
      transform: scale(1);
    }

    25% {
      transform: scale(1.3);
    }

    50% {
      transform: scale(1.2);
    }

    75% {
      transform: scale(1.25);
    }

    100% {
      transform: scale(1.2);
    }
  }

  @keyframes shrinking-spring {
    0% {
      transform: scale(1.2);
    }

    33% {
      transform: scale(1);
    }

    66% {
      transform: scale(1.1);
    }

    100% {
      transform: scale(1);
    }
  }
`;nt();var A_e=Zn`
  .comments__filter-container {
    display: flex;
    width: 100%;
    justify-content: flex-start;
    align-items: center;
  }

  .comments__filter {
    white-space: nowrap;
    padding: 12px;
    cursor: pointer;
    color: rgb(var(--sv-gray-500));
  }

  .content {
    display: flex;
    justify-content: space-between;
    flex-direction: row;
    align-items: center;
    gap: 6px;
  }

  .comments__filter__toggle-button {
    display: flex;
    flex-direction: row;
    gap: 4px;
  }

  .comments__filter__icon {
    margin-top: -2px;
  }
`;nt();var C_e=Zn`
  .comments__floating-button {
    position: fixed;
    border-radius: 50%;
    width: 38px;
    height: 38px;
    display: flex;
    align-items: center;
    gap: 4px;
    border: none;
    background-color: rgba(var(--sv-white));
    box-shadow: 2px 2px 15px 0px rgba(0, 0, 0, 0.2);
    color: rgb(var(--sv-gray-600));
    cursor: pointer;
    overflow: hidden;
    padding-left: 10px;
    z-index: 99;
    transition: width 300ms linear, border-radius 300ms linear;
  }

  .comments__floating-button:hover,
  .comments__floating-button.is-active {
    background-color: rgb(var(--sv-gray-400));
    color: rgba(var(--sv-white));
  }

  .comments-floating-button-hovered {
    transition: width 300ms linear 300ms, border-radius 300ms linear 300ms;
  }

  .comments__floating-button__text {
    text-align: left;
    overflow: hidden;
    position: relative;
    margin: 0;
    line-height: 1;
    right: 0px;
  }

  .not-hovered {
    animation-duration: 0s !important;
    transition-duration: 0s !important;
  }

  .hide-button {
    display: none !important;
  }

  .is-inactive:hover {
    width: 110px;
    border-radius: 30px;
  }

  .is-active:hover {
    width: 92px;
    border-radius: 30px;
    animation: decrease-width 600ms linear;
  }

  .textInactive.cancel {
    position: absolute;
    bottom: -30px;
    animation: drop-cancel-text 600ms linear;
    right: auto;
  }

  .textInactive.comment {
    position: absolute;
    top: 0;
    animation: drop-comment-text 600ms linear;
  }

  .textActive.comment {
    position: absolute;
    top: -30px;
    animation: rise-comment-text 600ms linear;
    right: auto;
  }

  .textActive.cancel {
    position: absolute;
    bottom: 0;
    animation: rise-cancel-text 600ms linear;
  }

  .comments__floating-button .comments__floating-button-text-box {
    width: 0;
  }

  .comments__floating-button.is-inactive:hover .comments__floating-button-text-box {
    width: 61.45px;
  }

  .comments__floating-button.is-active:hover .comments__floating-button-text-box {
    width: 43.0833px;
  }

  .comments__floating-button-text-box {
    position: relative;
    height: 14px;
    overflow-x: clip;
    transition: width 300ms linear;
  }

  .comments__floating-button__icon {
    position: relative;
  }

  .cross {
    position: absolute;
    top: 9px;
    left: 5.3px;
    transform: translateY(-50%);
    transform-origin: center;
    transition: transform 300ms linear 300ms;
  }

  rect {
    fill: rgba(var(--sv-gray-600));
  }

  .comments__floating-button:hover rect,
  .is-active rect {
    fill: rgba(var(--sv-white));
  }

  .cross-bar-1 {
    transform-origin: center;
    transform: rotate(0deg);
  }

  .cross-bar-2 {
    transform-origin: center;
    transform: rotate(90deg);
  }

  .is-active .cross {
    transform: translateY(-50%) rotate(45deg);
  }

  @keyframes rise-cancel-text {
    0%,
    50% {
      opacity: 0;
      bottom: -35px;
    }

    75% {
      opacity: 0;
    }

    100% {
      opacity: 1;
      bottom: 0px;
    }
  }

  @keyframes rise-comment-text {
    0% {
      opacity: 1;
      top: 0px;
    }

    35% {
      opacity: 0;
    }

    50%,
    100% {
      opacity: 0;
      top: -35px;
    }
  }

  @keyframes drop-cancel-text {
    0% {
      opacity: 1;
      bottom: 0px;
    }

    35% {
      opacity: 0;
    }

    50%,
    100% {
      opacity: 0;
      bottom: -30px;
    }
  }

  @keyframes drop-comment-text {
    0%,
    50% {
      opacity: 0;
      top: -30px;
    }

    75% {
      opacity: 0;
    }

    100% {
      opacity: 1;
      top: 0px;
    }
  }
`;nt();var P_e=Zn`
.footer {
  bottom: 5px;
  position: absolute;
  right: 5px;
  font-family: Roboto,sans-serif;
  font-size: 10px;
  line-height: 15px;
  letter-spacing: normal;
}

.link {
  text-decoration: none;
  color: rgb(var(--sv-gray-500));
}

.powered-by {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  width: 140px;
  &--vertical {
    justify-content: flex-end;
  }
  &--horizontal {
    justify-content: center;
  }
}
`;nt();var R_e=Zn`
  #mention-list {
    position: absolute;
    z-index: 1;
    max-height: 200px;
    overflow-y: auto;
    overflow-x: hidden;
    background-color: white;
    display: none;
    width: 216px;
    text-align: -webkit-center;
    border-radius: 2px;
    box-shadow: 2px 2px 8px 0px rgba(0, 0, 0, 0.30);
    padding-top: 4px;
    padding-bottom: 4px;
    /* Stiling scroll WebKit (Firefox) */
    scrollbar-width: 6px; /* Firefox */
    scrollbar-color: #888; /* Firefox */
    /* Style scroll WebKit (Chrome, Safari, Edge) */
    &::-webkit-scrollbar {
      width: 6px;
    }
    &::-webkit-scrollbar-thumb {
      background-color: #888;
    }
  }

  .mention-item {
    cursor: pointer;
    align-items: center;
    display: flex;
    height: 48px;
    width: 208px;
    margin-left: 4px;
    margin-right: 4px;
  }

  .mention-item:hover {
    background: rgb(var(--sv-gray-200));
  }

  .avatar {
    width: 32px;
    height: 32px;
    object-fit: contain;
    border-radius: 32%;
    margin-right: 14px;
    margin-left: 12px;
  }

  .default-avatar {
    width: 32px;
    height: 32px;
    margin-right: 14px;
    margin-left: 12px;
    border-radius: 50%;
    overflow: hidden;
    background-color: rgb(var(--sv-gray-300));
    border: 1px solid rgb(var(--sv-gray-500));
    color: #fff;

    display: flex;
    align-items: center;
    justify-content: center;
  }

  .avatar-type {
    font-family: Roboto;
    font-size: 14px;
    font-style: normal;
    font-weight: 400;
    line-height: 20px;
    color: rgb(var(--sv-gray-600));
  }
`;nt();var GN;function AJ(i){let e=i.querySelector("#superviz-comments");if(e&&!GN){let t={childList:!0,attributes:!0,characterData:!0,subtree:!0};GN=new MutationObserver(r=>{r.forEach(n=>{!n.removedNodes.length||n.removedNodes.forEach(l=>{l.id==="poweredby-footer"&&I_e(i)})})}),GN.observe(e,t)}}function I_e(i){let e=document.createElement("div");e.id="poweredby-footer",e.className="footer";let t=document.createElement("div");t.className="powered-by powered-by--horizontal";let r=document.createElement("a");r.href="https://superviz.com/",r.target="_blank",r.className="link";let n=document.createElement("div");n.textContent="Powered by";let l=document.createElement("img");l.width=48,l.height=8.86,l.src="https://production.cdn.superviz.com/static/superviz-gray-logo.svg",t.appendChild(r),r.appendChild(n),n.appendChild(l),e.appendChild(t);let c=i.getElementById("superviz-comments");c&&c.appendChild(e),AJ(i)}var CJ=Is(Bn),L_e=[CJ.styles,__e,P_e],w3=class extends CJ{constructor(){super(),this.annotations=[],this.annotationFilter="All comments",this.waterMarkState=!1,this.participantsList=[],this.side="left"}firstUpdated(i){super.firstUpdated(i),this.updateComplete.then(()=>{gu.call(this,["comments"])})}updated(i){super.updated(i),this.updateComplete.then(()=>{this.waterMarkState&&AJ(this.shadowRoot),i.has("offset")&&this.applyOffset()})}participantsListed(i){this.participantsList=i}updateAnnotations(i){this.annotations=i}close(){this.emitEvent("close-threads",{})}waterMarkStatus(i){this.waterMarkState=i}setFilter({detail:i}){let{filter:{label:e}}=i;this.annotationFilter=e}getOffset(i){return i==null||i<0?"10px":`${i}px`}applyOffset(){let i=this.shadowRoot.querySelector(".superviz-comments");if(!i)return;let{left:e,right:t,top:r,bottom:n}=this.offset;i.style.setProperty("--offset-top",this.getOffset(r)),i.style.setProperty("--offset-bottom",this.getOffset(n)),i.style.setProperty("--offset-right",this.getOffset(t)),i.style.setProperty("--offset-left",this.getOffset(e))}get poweredBy(){return this.waterMarkState?Vt` <div id="poweredby-footer" class="footer">
      <div class="powered-by powered-by--horizontal">
        <a href="https://superviz.com/" target="_blank" class="link">
          <div class="">
            Powered by
            <img
              width="48px"
              height="8.86px"
              src="https://production.cdn.superviz.com/static/superviz-gray-logo.svg"
            />
          </div>
        </a>
      </div>
    </div>`:Vt``}render(){let i={"superviz-comments":!0,"threads-on-left-side":this.side==="left","threads-on-right-side":this.side==="right","hide-at-right":this.side==="right"&&!this.open,"hide-at-left":this.side==="left"&&!this.open};return Vt`
      <div id="superviz-comments" class=${Hr(i)}>
        <div class="header">
          <superviz-comments-topbar
            @close-threads=${this.close}
            side=${this.side.split(":")[0]}
          ></superviz-comments-topbar>
        </div>
        <superviz-comments-annotation-filter
          filter=${this.annotationFilter}
          @select=${this.setFilter}
        >
        </superviz-comments-annotation-filter>
        <superviz-comments-content
          annotations=${JSON.stringify(this.annotations)}
          annotationFilter=${this.annotationFilter}
          participantsList=${JSON.stringify(this.participantsList)}
          class="content"
        ></superviz-comments-content>
        ${this.poweredBy}
      </div>
    `}};w3.styles=L_e,w3.properties={open:{type:Boolean},annotations:{type:Object},annotationFilter:{type:String},waterMarkState:{type:Boolean},side:{type:String},participantsList:{type:Object},offset:{type:Object}},w3=Rs([Ps("superviz-comments")],w3);nt();nt();var O_e=Is(Bn),N_e=[O_e.styles,x_e],S3=class extends Is(Bn){firstUpdated(i){super.firstUpdated(i),this.updateComplete.then(()=>{gu.call(this,["comments"])})}close(){this.dispatchEvent(new CustomEvent("close-threads"))}render(){return Vt`
      <div class="comments__topbar">
        <span class="text text-bold comments__topbar__title">COMMENTS</span>
        <span @click=${this.close} class="comments__topbar__close-threads">
          <superviz-icon name=${this.side}></superviz-icon>
        </span>
      </div>
    `}};S3.styles=N_e,S3.properties={side:{type:String}},S3=Rs([Ps("superviz-comments-topbar")],S3);nt();var PJ=Is(Bn),D_e=[PJ.styles,w_e],M3=class extends PJ{constructor(){super(),this.unselectAnnotation=()=>{this.selectedAnnotation=null},this.unselectAnnotationEsc=i=>{i&&(i==null?void 0:i.key)!=="Escape"||(this.selectedAnnotation=null)},this.selectAnnotation=({detail:i})=>{let{uuid:e}=i;if(this.selectedAnnotation===e){this.selectedAnnotation=null;return}this.selectedAnnotation=e},this.checkLastAnnotation=i=>{var e,t;let r=this.annotations.filter(l=>l.resolved),n=this.annotations.filter(l=>!l.resolved);return this.annotationFilter==="All comments"?i===((e=r[r.length-1])==null?void 0:e.uuid):i===((t=n[n.length-1])==null?void 0:t.uuid)},this.annotations=[],this.participantsList=[]}updated(i){super.updated(i),this.updateComplete.then(()=>{let e=this.shadowRoot.querySelector(`[uuid='${this.selectedAnnotation}']`);if(!e)return;let t=this.lastCommentId===this.selectedAnnotation,r=t?0:-150,n=e.getClientRects()[0];!n||(this.scrollBy(0,n.y+r),t&&setTimeout(()=>{this.scrollBy(0,n.y+r)},200))})}connectedCallback(){super.connectedCallback(),window.document.body.addEventListener("select-annotation",this.selectAnnotation),window.document.body.addEventListener("keyup",this.unselectAnnotationEsc),window.document.body.addEventListener("unselect-annotation",this.unselectAnnotation)}disconnectedCallback(){super.disconnectedCallback(),window.document.body.removeEventListener("select-annotation",this.selectAnnotation),window.document.body.removeEventListener("keyup",this.unselectAnnotationEsc),window.document.body.removeEventListener("unselect-annotation",this.unselectAnnotation)}render(){return Vt` ${dL(this.annotations.filter(i=>{var e;return(e=i.comments)==null?void 0:e.length}),i=>i.uuid,i=>Vt`
        <superviz-comments-annotation-item
          annotation=${JSON.stringify(i)}
          selected="${this.selectedAnnotation}"
          annotationFilter=${this.annotationFilter}
          uuid=${i.uuid}
          isLastComment=${this.checkLastAnnotation(i.uuid)}
          participantsList=${JSON.stringify(this.participantsList)}
        >
        </superviz-comments-annotation-item>
      `)}`}};M3.styles=D_e,M3.properties={annotations:{type:Object},selectedAnnotation:{type:String},annotationFilter:{type:String},participantsList:{type:Object}},M3=Rs([Ps("superviz-comments-content")],M3);nt();var RJ=Is(Bn),k_e=[RJ.styles,b_e],E3=class extends RJ{constructor(){super(),this.unselectAnnotationEsc=i=>{i.key==="Escape"&&(this.isSelected=!1)},this.unselectAnnotation=()=>{this.isSelected=!1},this.selectAnnotation=({detail:i})=>{let{uuid:e}=i;if(this.isSelected){this.isSelected=!1;return}this.isSelected=e===this.annotationId},this.updateComment=({detail:i})=>{let{text:e,mentions:t}=i;this.text=e,this.closeEditMode(),this.emitEvent("update-comment",{uuid:this.uuid,mentions:t,text:e})},this.resolveAnnotation=i=>{i.stopPropagation(),this.emitEvent("resolve-annotation",{type:"resolve-annotation",resolved:!this.resolved},{composed:!1,bubbles:!1})},this.confirmDelete=()=>{if(this.deleteCommentModalOpen=!1,this.primaryComment)return this.emitEvent("delete-annotation",{uuid:this.annotationId});this.emitEvent("delete-comment",{annotationId:this.annotationId,uuid:this.uuid})},this.closeEditMode=()=>{this.mode="readonly",this.emitEvent("edit-comment",{editing:!1})},this.resolved=!1}firstUpdated(i){super.firstUpdated(i),this.updateComplete.then(()=>{gu.call(this,["comments"])}),document.body.addEventListener("select-annotation",this.selectAnnotation)}connectedCallback(){super.connectedCallback(),window.document.body.addEventListener("select-annotation",this.selectAnnotation),window.document.body.addEventListener("keyup",this.unselectAnnotationEsc),window.document.body.addEventListener("unselect-annotation",this.unselectAnnotation)}disconnectedCallback(){super.disconnectedCallback(),window.document.body.removeEventListener("select-annotation",this.selectAnnotation),window.document.body.removeEventListener("keyup",this.unselectAnnotationEsc),window.document.body.removeEventListener("unselect-annotation",this.unselectAnnotation)}getAvatar(){var i;return this.avatar?Vt` <div class=${this.getClasses("avatar-container")}>
        <img src=${this.avatar} class=${this.getClasses("avatar-image")} />
      </div>`:Vt`<div class=${this.getClasses("avatar-container")}>
      <p class="text text-bold ${this.getClasses("avatar-letter")}">
        ${((i=this.username[0])==null?void 0:i.toUpperCase())||"A"}
      </p>
    </div>`}getClasses(i){return`comments__comment-item__${i} ${this.class}__${i}`}render(){let i=this.annotationFilter==="All comments"?"resolve":"undo",e=m=>nr.fromISO(m).toFormat("yyyy-dd-MM"),t=this.resolvable?"comments__comment-item__resolve":"hidden",r=[{label:"EDIT"},{label:"DELETE"}],n=({detail:{label:m}})=>{m==="EDIT"&&(this.mode="editable",this.emitEvent("edit-comment",{editing:!0})),m==="DELETE"&&(this.deleteCommentModalOpen=!0)},l=()=>{let m={"comments__comment-item--editable":!0,"hide-edit-input":this.mode!=="editable"};return Vt`
        <superviz-comments-comment-input
          class="${Hr(m)}"
          editable
          mode=${this.mode}
          @click=${g=>g.stopPropagation()}
          text=${this.text}
          eventType="update-comment"
          participantsList=${JSON.stringify(this.participantsList)}
          mentions=${JSON.stringify(this.mentions)}
          @update-comment=${this.updateComment}
          @close-edit-mode=${this.closeEditMode}
        ></superviz-comments-comment-input>
      `},c=()=>{let m={text:!0,"text-big":!0,"sv-gray-700":!0,"annotation-content":!0,[this.getClasses("content")]:!0,editing:this.mode==="editable","line-clamp":!this.isSelected&&this.text.length>120};return Vt` <p id="comment-text" class="${Hr(m)}">${this.text}</p> `},h=()=>{this.deleteCommentModalOpen=!1},d={[this.class]:!0,"comments__comment-item":!0,reply:!this.primaryComment},f={"comments__comment-item__content__body":!0,"editing-annotation":this.mode==="editable"};return Vt`
      <div class=${Hr(d)}>
        <div class=${this.getClasses("header")}>
          <div class=${this.getClasses("metadata")}>
            ${this.getAvatar()}
            <span class="text text-big text-bold sv-gray-700 ${this.getClasses("username")}">
              ${this.username}
            </span>
            <span class="text text-small sv-gray-500 ${this.getClasses("date")}">
              ${e(this.createdAt)}
            </span>
          </div>
          <div class=${this.getClasses("actions")}>
            <button
              @click=${this.resolveAnnotation}
              class="${this.getClasses("icons")} ${this.getClasses("resolve-icon")} icon-button icon-button--clickable icon-button--xsmall ${t}"
            >
              <!-- TODO: Add undo icon in sm format -->
              <superviz-icon name=${i} size="sm"></superviz-icon>
            </button>
            <superviz-dropdown
              options=${JSON.stringify(r)}
              position="bottom-left"
              @selected=${n}
              @click=${m=>{m.stopPropagation()}}
              classesPrefix="comments__dropdown"
              parentComponent="comments"
            >
              <button
                slot="dropdown"
                class="${this.getClasses("icons")} ${this.getClasses("options-icon")} icon-button icon-button--clickable icon-button--small"
              >
                <superviz-icon name="more" size="sm"></superviz-icon>
              </button>
            </superviz-dropdown>
          </div>
        </div>

        <div class="comments__comment-item__content">
          <div class="${Hr(f)}">${l()} ${c()}</div>
        </div>
      </div>
      <superviz-comments-delete-comments-modal
        ?open=${this.deleteCommentModalOpen}
        @close=${h}
        @confirm=${this.confirmDelete}
      >
      </superviz-comments-delete-comments-modal>
    `}};E3.styles=k_e,E3.properties={uuid:{type:String},annotationId:{type:String},avatar:{type:String},username:{type:String},text:{type:String},resolved:{type:Boolean},resolvable:{type:Boolean},createdAt:{type:String},mode:{type:String},deleteCommentModalOpen:{type:Boolean},primaryComment:{type:Boolean},isSelected:{type:Boolean},annotationFilter:{type:String},participantsList:{type:Object},mentions:{type:Array},class:{type:String}},E3=Rs([Ps("superviz-comments-comment-item")],E3);nt();nt();var F_e=class{constructor(){this.keys=["@"],this.input=null,this.mentions=[]}setInput(e){this.event=e,this.input=e.target,this.key=e.data}getMentions(e,t=[]){return t.length>0&&(this.mentions=t),this.mentions.filter(r=>((n,l)=>l.includes(n.name))(r,e))}setMentions(e){this.mentions=e}addMention(e){this.mentions.some(t=>t.userId===e.userId)||this.mentions.push(e)}clearMentions(){this.mentions=[]}getSelectionPosition(){var e;let t=this.getSelectionStart(),r=this.getLastKeyBeforeCaret(t);return{start:((e=r==null?void 0:r.keyIndex)!=null?e:-1)+1,end:t}}getSelectionStart(){var e;return(e=this.input)==null?void 0:e.selectionStart}setCaretPosition(e){this.input.selectionEnd=e}getValue(){var e;return(e=this.input)==null?void 0:e.value}setValue(e){this.input.value=e}getLastKeyBeforeCaret(e){let[t]=this.keys.map(r=>({key:r,keyIndex:this.getValue().lastIndexOf(r,e-1)})).sort((r,n)=>n.keyIndex-r.keyIndex);return t}searchMention(e,t){return t!==-1?this.getValue().substring(t+1,e):null}isDeletion(){return this.event.inputType==="deleteContentBackward"||this.event.inputType==="deleteContentForward"||this.event.inputType==="deleteWordBackward"}insertMention(e,t,r){if(this.isDeletion())return;let{id:n,name:l}=r,c=`${this.getValue().slice(0,e)+l} ${this.getValue().slice(t,this.getValue().length)}`;this.setValue(c),this.input.focus(),this.addMention({userId:n,name:l}),this.setCaretPosition(e+l.length+1)}};nt();var t4={SHOW:"show",HIDE:"hide"},z_e={action:t4.HIDE,mentions:[],findDigitParticipant:!1},B_e=(i,e,t)=>{var r,n;let l=[];if(l=t==null?void 0:t.filter(h=>h==null?void 0:h.email),i.length>0&&(l=l.filter(h=>(h==null?void 0:h.name.toLowerCase().search(i.toLowerCase()))!==-1),i===((n=(r=l[0])==null?void 0:r.name)==null?void 0:n.toLowerCase()))){let h=tW(l,e);return{action:t4.HIDE,mentions:h,findDigitParticipant:!0}}if(!((l==null?void 0:l.length)>0))return z_e;let c=tW(l,e);return{action:t4.SHOW,mentions:c,findDigitParticipant:!1}},tW=(i,e)=>i.map(t=>({id:t.id,name:t.name,avatar:t.avatar,email:t.email,position:e})),U_e={matchParticipant:(i,e,t)=>B_e(i,e,t)},IJ=Is(Bn),H_e=[IJ.styles,S_e],T3=class extends IJ{constructor(){super(),this.pinCoordinates=null,this.autoCompleteHandler=new F_e,this.addAtSymbolInCaretPosition=()=>{let i=this.shadowRoot.querySelector(".comments__input__textarea"),e=new InputEvent("input",{bubbles:!0,cancelable:!0});Object.defineProperty(e,"data",{value:"@",writable:!0}),i.dispatchEvent(e)},this.getCommentInput=()=>this.shadowRoot.querySelector(".comments__input__textarea"),this.userMentionedByTextInput=i=>{this.mentionList=[];let e={detail:ir({},i[0])};this.insertMention(e)},this.buttonAtSymbol=()=>{var i;let e=this.autoCompleteHandler.getSelectionStart(),t=this.autoCompleteHandler.getValue();this.autoCompleteHandler.setValue(`${t.slice(0,e)}@${t.slice(e,t.length)}`),e+=1;let r=this.autoCompleteHandler.getLastKeyBeforeCaret(e),n=(i=r==null?void 0:r.keyIndex)!=null?i:-1,l=this.autoCompleteHandler.searchMention(e,n),c={start:n+1,end:e};return{searchText:l,position:c}},this.focusInput=()=>{this.getCommentInput().focus()},this.handleInput=i=>{var e,t;if(((e=this.commentInput)==null?void 0:e.value.length)===0?this.btnActive=!1:this.btnActive=!0,i.data===null)return;this.autoCompleteHandler.setInput(i);let r=this.autoCompleteHandler.getSelectionStart(),n=this.autoCompleteHandler.getLastKeyBeforeCaret(r),l=(t=n==null?void 0:n.keyIndex)!=null?t:-1,c=this.autoCompleteHandler.searchMention(r,l),h=this.autoCompleteHandler.getSelectionPosition(),d=i.data==="@"&&l===-1,f=i.data==="@"&&r-1!==l;if(d||f){let _=this.buttonAtSymbol();c=_.searchText,h=_.position}if(c===null){this.mentionList=[];return}let{action:m,mentions:g,findDigitParticipant:y}=U_e.matchParticipant(c,h,this.participantsList);if(y){this.userMentionedByTextInput(g);return}m==="show"&&(this.mentionList=g),m==="hide"&&(this.mentionList=[])},this.insertMention=i=>{let{id:e,name:t,avatar:r,email:n,position:l}=i.detail;this.autoCompleteHandler.insertMention(l.start,l.end,{id:e,name:t,avatar:r,email:n}),this.mentionList=[],this.updateHeight()},this.sendEnter=i=>{var e;if(i.key!=="Escape"&&i.stopImmediatePropagation(),i.key==="Enter"&&!i.shiftKey&&i.preventDefault(),i.key!=="Enter"||i.shiftKey||((e=this.mentionList)==null?void 0:e.length)>0)return;let t=this.commentInput,r=t.value.trim();if(!r)return;let n=this.autoCompleteHandler.getMentions(r);this.emitEvent(this.eventType,{text:r,mentions:n,position:this.pinCoordinates},{composed:!1,bubbles:!1}),t.value="",this.sendBtn.disabled=!0,this.updateHeight()},this.closeEditMode=()=>{this.emitEvent("close-edit-mode",{},{composed:!1,bubbles:!1}),this.hideInput=!0},this.onTextareaFocus=()=>{let i=this.optionsContainer,e=this.horizontalRule,t=this.commentInput;i.classList.add("active-textarea"),e.classList.add("comments__input__divisor"),t.classList.add("active-textarea")},this.onTextareaLoseFocus=i=>{var e,t;let r=(t=(e=i.explicitOriginalTarget)==null?void 0:e.parentNode)==null?void 0:t.host;if(this.closeButton.contains(r)||this.closeButton.contains(i.explicitOriginalTarget)||this.closeButton.contains(i.relatedTarget)){this.cancelComment();return}if(!this.shadowRoot.contains(i.target))return;let n=this.optionsContainer,l=this.horizontalRule,c=this.commentInput;c.value.length||(n.classList.remove("active-textarea"),l.classList.remove("comments__input__divisor"),c.classList.remove("active-textarea"))},this.cancelComment=()=>{document.body.dispatchEvent(new KeyboardEvent("keyup",{key:"Escape"}))},this.commentInputEditableOptions=()=>{var i;if(this.editable)return Vt`
      <button
        id="close"
        @click=${this.closeEditMode}
        class="icon-button icon-button--medium icon-button--clickable comments__input__button comments__input__close-button"
      >
        <superviz-icon name="close" size="sm"></superviz-icon>
      </button>
      <button
        id="confirm"
        class="icon-button icon-button--medium icon-button--clickable icon-button--no-hover comments__input__button comments__input__send-button"
        disabled
        @click=${this.send}
      >
        <superviz-icon
          color=${(i=this.sendBtn)!=null&&i.disabled||!this.sendBtn?"black":"white"}
          name="check"
          size="sm"
        ></superviz-icon>
      </button>
    `},this.commentInputOptions=()=>{var i;if(!this.editable)return Vt`
      <button
        class="icon-button icon-button--medium icon-button--clickable comments__input__button comments__input__close-button align-send-btn"
        @click=${this.cancelComment}
      >
        <superviz-icon name="close" size="sm"></superviz-icon>
      </button>
      <button
        class="comments__input__button comments__input__send-button align-send-btn"
        disabled
        @click=${this.send}
      >
        <superviz-icon
          color=${(i=this.sendBtn)!=null&&i.disabled||!this.sendBtn?"black":"white"}
          name="line-arrow-right"
          size="sm"
        ></superviz-icon>
      </button>
    `},this.btnActive=!1,this.text="",this.mentionList=[],this.mentions=[],this.mode="readonly"}get commentInput(){return this.shadowRoot.querySelector(".comments__input__textarea")}get sendBtn(){return this.shadowRoot.querySelector(".comments__input__send-button")}get optionsContainer(){return this.shadowRoot.querySelector(".comments__input__options")}get horizontalRule(){return this.shadowRoot.querySelector(".sv-hr")}get closeButton(){return this.shadowRoot.querySelector(".comments__input__close-button")}connectedCallback(){super.connectedCallback(),["create-annotation","create-comment"].includes(this.eventType)&&this.addEventListener("keyup",this.sendEnter)}disconnectedCallback(){if(super.disconnectedCallback(),!["create-annotation","create-comment"].includes(this.eventType))return;let i=this.getCommentInput();this.removeEventListener("keyup",this.sendEnter),i.removeEventListener("keydown",this.sendEnter),i.removeEventListener("click",this.focusInput),i.addEventListener("input",this.handleInput)}firstUpdated(i){this.updateComplete.then(()=>{this.emitEvent("comment-input-ready",{},{composed:!1,bubbles:!1});let e=this.getCommentInput();if(e&&(e.addEventListener("input",this.handleInput),e.addEventListener("click",this.focusInput),e.addEventListener("keydown",this.sendEnter)),this.text.length>0){let t=this.participantsList.map(({id:r,name:n})=>({userId:r,name:n}));this.mentions=this.autoCompleteHandler.getMentions(this.text,t),this.autoCompleteHandler.setMentions(this.mentions)}this.editable&&this.focusInput(),gu.call(this,["comments"])})}updated(i){if(i.has("mode")&&this.mode==="editable"&&(this.focusInput(),this.updateHeight(),this.sendBtn.disabled=!1,this.btnActive=!0),i.has("text")&&this.text.length>0){let e=this.commentInput;e.value=this.text,this.updateHeight()}i.has("btnActive")&&(this.sendBtn.disabled=!this.btnActive)}updateHeight(){let i=this.commentInput;i.style.height="40px";let e=i.scrollHeight+14;e===47&&(e=40),i.style.height=`${e}px`,this.sendBtn.disabled=!(i.value.length>0)}send(i){var e;if(i.preventDefault(),((e=this.mentionList)==null?void 0:e.length)>0)return;let t=this.commentInput,r=t.value,n=this.autoCompleteHandler.getMentions(r);this.emitEvent(this.eventType,{text:r,mentions:n,position:this.pinCoordinates},{composed:!1,bubbles:!1}),t.value="",this.sendBtn.disabled=!0,this.updateHeight()}render(){var i;let e={comments__input__textarea:!0,"fixed-width":this.eventType==="create-annotation"},t={comments__input:!0,"comments__input--editable":this.editable,"hide-input":this.hideInput};return Vt`
      <div class="${Hr(t)}">
        <textarea
          id="comments__input__textarea"
          class=${Hr(e)}
          placeholder=${(i=this.placeholder)!=null?i:"Add comment..."}
          @input=${this.updateHeight}
          @focus=${this.onTextareaFocus}
          @blur=${this.onTextareaLoseFocus}
          spellcheck="false"
        ></textarea>
        <superviz-comments-mention-list
          .participants=${this.mentionList}
          @participant-selected=${this.insertMention}
        ></superviz-comments-mention-list>
        <div class="sv-hr"></div>
        <div class="comments__input__options">
          <button class="icon-button icon-button--medium icon-button--clickable">
            <superviz-icon
              name="mention"
              @click=${this.addAtSymbolInCaretPosition}
              size="sm"
            ></superviz-icon>
          </button>
          <div class="comment-input-options">
            ${this.commentInputOptions()} ${this.commentInputEditableOptions()}
          </div>
        </div>
      </div>
    `}};T3.styles=H_e,T3.properties={eventType:{type:String},text:{type:String},btnActive:{type:Boolean},editable:{type:Boolean},placeholder:{type:String},mentions:{type:Array},mentionList:{type:Object},participantsList:{type:Object},hideInput:{type:Boolean},mode:{type:String}},T3=Rs([Ps("superviz-comments-comment-input")],T3);nt();var LJ=Is(Bn),$_e=[LJ.styles,T_e],A3=class extends LJ{constructor(){super(),this.focusInput=()=>{var i,e;this.inputElement||(this.inputElement=(e=(i=this.shadowRoot)==null?void 0:i.querySelector("superviz-comments-comment-input"))==null?void 0:e.shadowRoot.querySelector("textarea")),this.inputElement.focus()},this.setInputSide=()=>{let i=this.commentsSide==="right"?320:0,e=this.annotationSides.right+293,t=this.containerSides.right-i;if(e<t){this.horizontalSide="right";return}i=this.commentsSide==="left"?320:0;let r=this.annotationSides.left-293,n=this.containerSides.left+i;if(r>n){this.horizontalSide="left";return}this.horizontalSide=n-r>e-t?"right":"left"},this.createComment=({detail:i})=>{this.annotationSent=!0,document.body.dispatchEvent(new CustomEvent("create-annotation",{detail:Ia(ir({},i),{position:Ia(ir({},this.originalPosition),{type:"canvas"})})})),this.annotation=null},this.cancelTemporaryAnnotation=()=>{this.annotation=null},this.cancelTemporaryAnnotationEsc=i=>{this.annotation=null},this.avatar=()=>{if(this.type==="add"&&!this.showInput)return Vt`<div
        class="comments__annotation-pin__avatar comments__annotation-pin__avatar--add"
      >
        <superviz-icon name="add"></superviz-icon>
      </div>`;let i=this.userAvatar;return i?Vt`<div class="comments__annotation-pin__avatar">
        <img src=${i} />
      </div>`:Vt`<div class="comments__annotation-pin__avatar">
      <p class="text text-bold text-big">${this.userInitial}</p>
    </div>`},this.input=()=>{if(!(!this.showInput||this.annotationSent))return Vt`<div class="floating-input">
      <superviz-comments-comment-input
        @create-annotation=${this.createComment}
        eventType="create-annotation"
        @comment-input-ready=${this.focusInput}
        participantsList=${JSON.stringify(this.participantsList)}
      >
      </superviz-comments-comment-input>
    </div>`},this.position={x:0,y:0},setTimeout(()=>{this.firstLoad=!1},800)}updated(i){super.updated(i),!(!i.has("movedPosition")||!this.annotationSides)&&(this.annotationSides=this.pinAnnotation.getBoundingClientRect(),this.setInputSide(),this.inputElement&&this.focusInput())}firstUpdated(i){var e;super.firstUpdated(i),gu.call(this,["comments"]),this.showInput&&(this.originalPosition=ir({},this.position),this.pinAnnotation=(e=this.shadowRoot)==null?void 0:e.querySelector(".comments__annotation-pin"),this.annotationSides=this.pinAnnotation.getBoundingClientRect(),this.setInputSide())}connectedCallback(){if(super.connectedCallback(),this.type!=="add")return;let{localParticipant:i}=this.useStore("global-store");i.subscribe(e=>{var t;this.localAvatar=(t=e==null?void 0:e.avatar)==null?void 0:t.imageUrl,this.localName=e==null?void 0:e.name}),window.document.body.addEventListener("close-temporary-annotation",this.cancelTemporaryAnnotation),window.document.body.addEventListener("keyup",e=>{e.key==="Escape"&&this.cancelTemporaryAnnotationEsc(e)})}disconnectedCallback(){super.disconnectedCallback(),this.type==="add"&&(window.document.body.removeEventListener("close-temporary-annotation",this.cancelTemporaryAnnotation),window.document.body.removeEventListener("keyup",i=>{i.key==="Escape"&&this.cancelTemporaryAnnotationEsc(i)}))}get userAvatar(){var i,e,t,r;return((r=(t=(e=(i=this.annotation)==null?void 0:i.comments)==null?void 0:e.at(0))==null?void 0:t.participant)==null?void 0:r.avatar)||this.localAvatar}get userInitial(){var i,e,t,r,n;return(((n=(r=(t=(e=(i=this.annotation)==null?void 0:i.comments)==null?void 0:e.at(0))==null?void 0:t.participant)==null?void 0:r.name)!=null?n:this.localName)||"Anonymous")[0].toUpperCase()}emitClick(){var i;document.body.dispatchEvent(new CustomEvent("select-annotation",{detail:{uuid:(i=this.annotation)==null?void 0:i.uuid}}))}render(){let i={"comments__annotation-pin":!0,preload:this.firstLoad===void 0,"comments__annotation-pin--active":this.active,"comments__cursor-pointer":this.type==="add"&&!this.showInput,"comments__annotation-pin--add":this.type==="add"&&this.showInput,[this.horizontalSide]:!0},e={"comments__annotation-pin-wrapper":!0,"comments__annotation-pin-wrapper--new":this.newPin},t=this.keepPositionRatio?"%":"px",r=`top: ${this.position.y}${t}; left: ${this.position.x}${t};`;return this.type==="add"?Vt`
        <div class=${Hr(i)} style=${r}>${this.avatar()} ${this.input()}</div>
      `:Vt`<div class=${Hr(e)} style=${r}>
      <div @click=${this.emitClick} class=${Hr(i)}>${this.avatar()}</div>
    </div> `}};A3.styles=$_e,A3.properties={type:{type:String},annotation:{type:Object},position:{type:Object},active:{type:Boolean},showInput:{type:Boolean},containerSides:{type:Object},horizontalSide:{type:String},commentsSide:{type:String},movedPosition:{type:String},pinAnnotation:{type:Object},localAvatar:{type:String},annotationSent:{type:Boolean},localName:{type:String},keepPositionRatio:{type:Boolean},participantsList:{type:Object},firstLoad:{type:Boolean},newPin:{type:Boolean}},A3=Rs([Ps("superviz-comments-annotation-pin")],A3);nt();var OJ=Is(Bn),V_e=[OJ.styles,M_e],C3=class extends OJ{constructor(){super(...arguments),this.selectAnnotation=i=>{let{uuid:e}=this.annotation;document.body.dispatchEvent(new CustomEvent("select-annotation",{detail:{uuid:e}}))},this.resolveAnnotation=({detail:i})=>{let{uuid:e}=this.annotation,{resolved:t,type:r}=i,n=r==="resolve-annotation"&&this.annotationFilter==="All comments";this.resolved=t,this.emitEvent("resolve-annotation",{uuid:e,resolved:t}),n&&(this.shouldShowUndoResolved=!0)},this.hideUndoResolved=()=>{this.shouldShowUndoResolved=!1},this.generateExpandedCommentsTemplate=(i,e)=>{var t,r,n,l;return e===0?Vt``:Vt`
      <superviz-comments-comment-item
        uuid=${i.uuid}
        avatar=${(l=(n=(r=(t=this.annotation)==null?void 0:t.comments)==null?void 0:r.at(e))==null?void 0:n.participant)==null?void 0:l.avatar}
        username=${i.participant.name||"Anonymous"}
        text=${i.text}
        createdAt=${i.createdAt}
        annotationId=${this.annotation.uuid}
        participantsList=${JSON.stringify(this.participantsList)}
        mentions=${JSON.stringify(i.mentions)}
        class="comments__replies"
      ></superviz-comments-comment-item>
    `},this.updateEditMode=({detail:{editing:i}})=>{this.hideInput=i}}firstUpdated(i){super.firstUpdated(i),this.updateComplete.then(()=>{this.resolved=this.annotation.resolved,gu.call(this,["comments"])})}get filterIsAll(){return this.annotationFilter==="All comments"}get filterIsResolved(){return this.annotationFilter==="Resolved comments"}get shouldHideAnnotation(){return{hidden:this.resolved&&this.filterIsAll||!this.resolved&&this.filterIsResolved}}get replies(){return[...this.annotation.comments].splice(1).length}get repliesSize(){return this.replies>=5?5:this.replies}get replyText(){return this.replies!==1?"replies":"reply"}get isSelected(){return this.selected===this.annotation.uuid}get annotationClasses(){return{comments__thread:!0,"comments__thread--selected":this.isSelected,"extra-space-bottom":this.replies}}get mainAnnotationClasses(){return{"comments__main-annotation":!0,"comments__main-annotation--selected":this.isSelected}}get hrClasses(){return{"sv-hr":!0,hidden:this.isLastAnnotation}}get avatarCommentsClasses(){return{"avatars-comments":!0,"comment-avatar--expand":!this.expandComments&&this.replies>1,invisible:!(!this.expandComments&&this.replies>=1)}}get containerWrapperClasses(){return{"comments-container-wrapper":!0,show:this.isSelected&&this.expandComments}}get commentsClasses(){return{"comments-container":!0,"comment-item--expand":this.isSelected&&this.expandComments,show:this.isSelected&&this.expandComments}}updated(i){if(i.has("selected")){let e=this.selected===this.annotation.uuid;this.expandComments=e}}createComment({detail:i}){let{text:e,mentions:t}=i;this.emitEvent("create-comment",{uuid:this.annotation.uuid,mentions:t,text:e})}generateAvatarCommentsTemplate(){var i,e,t,r,n,l;let c=[];for(let h=1;h<=this.repliesSize;h++)(e=(i=this.annotation.comments[h])==null?void 0:i.participant)!=null&&e.avatar?c.push(Vt`
          <div class="avatar">
            <img src=${(r=(t=this.annotation.comments[h])==null?void 0:t.participant)==null?void 0:r.avatar} />
          </div>
        `):c.push(Vt`
          <div class="avatar">
            <p class="text text-bold">
              ${((l=(n=this.annotation.comments[h])==null?void 0:n.participant.name[0])==null?void 0:l.toUpperCase())||"A"}
            </p>
          </div>
        `);return Vt`
      ${c}
      <div class="text text-big sv-gray-500">${this.replies} ${this.replyText}</div>
    `}annotationResolvedTemplate(){return this.shouldShowUndoResolved?Vt`
      <superviz-comments-annotation-resolved
        @undo-resolve=${this.resolveAnnotation}
        @hide=${this.hideUndoResolved}
        class=${Hr({hidden:this.filterIsResolved,"comments__resolved-annotation-message":!0})}
      >
      </superviz-comments-annotation-resolved>
    `:Vt``}get inputClasses(){return{"hide-input":this.hideInput}}get wrapperClasses(){return{wrapper:!0,"show-wrapper":!this.resolved&&this.filterIsAll||this.resolved&&this.filterIsResolved}}render(){var i,e,t,r,n,l,c,h,d,f,m;let g={"comments__complete-annotation":!0,"comments__hide-complete-annotation":this.shouldShowUndoResolved};return Vt`
      <div class="${Hr(g)}">
        ${this.annotationResolvedTemplate()}

        <div class=${Hr(this.wrapperClasses)}>
          <div class=${Hr(this.shouldHideAnnotation)}>
            <div class=${Hr(this.annotationClasses)} @click=${this.selectAnnotation}>
              <div class=${Hr(this.mainAnnotationClasses)}>
                <superviz-comments-comment-item
                  uuid=${(i=this.annotation.comments)==null?void 0:i[0].uuid}
                  annotationId=${this.annotation.uuid}
                  username=${((t=(e=this.annotation.comments)==null?void 0:e[0].participant)==null?void 0:t.name)||"Anonymous"}
                  text=${(r=this.annotation.comments)==null?void 0:r[0].text}
                  createdAt=${(n=this.annotation.comments)==null?void 0:n[0].createdAt}
                  participantsList=${JSON.stringify(this.participantsList)}
                  primaryComment
                  avatar=${(d=(h=(c=(l=this.annotation)==null?void 0:l.comments)==null?void 0:c.at(0))==null?void 0:h.participant)==null?void 0:d.avatar}
                  resolvable
                  ?resolved=${this.resolved}
                  annotationFilter=${this.annotationFilter}
                  @resolve-annotation=${this.resolveAnnotation}
                  mentions=${JSON.stringify((f=this.annotation.comments)==null?void 0:f[0].mentions)}
                  class="comments__annotation"
                  @edit-comment=${this.updateEditMode}
                ></superviz-comments-comment-item>
              </div>

              <div class=${Hr(this.containerWrapperClasses)}>
                <div class=${Hr(this.commentsClasses)}>
                  ${(m=this.annotation.comments)==null?void 0:m.map(this.generateExpandedCommentsTemplate)}
                  <span class=${Hr(this.inputClasses)}>
                    <superviz-comments-comment-input
                      @create-comment=${this.createComment}
                      eventType="create-comment"
                      @click=${y=>y.stopPropagation()}
                      placeholder="Reply"
                      participantsList=${JSON.stringify(this.participantsList)}
                    ></superviz-comments-comment-input>
                  </span>
                </div>
              </div>
              <div class=${Hr(this.avatarCommentsClasses)}>
                <div class="avatar-container">${this.generateAvatarCommentsTemplate()}</div>
              </div>
            </div>
            <div class=${Hr(this.hrClasses)}></div>
          </div>
        </div>
      </div>
    `}};C3.styles=V_e,C3.properties={annotation:{type:Object},expandComments:{type:Boolean},selected:{type:String,reflect:!0},resolved:{type:Boolean},shouldShowUndoResolved:{type:Boolean},isLastAnnotation:{type:Boolean},annotationFilter:{type:String},participantsList:{type:Object},hideInput:{type:Boolean}},C3=Rs([Ps("superviz-comments-annotation-item")],C3);nt();var NJ=Is(Bn),W_e=[NJ.styles],P3=class extends NJ{constructor(){super(...arguments),this.emitEventOpenModal=()=>{window.document.body.dispatchEvent(new CustomEvent("superviz-modal--open",{detail:{title:"DELETE COMMENT",body:Vt`<span class="text text-big sv-gray-600"
            >Are you sure you want to delete this comment? <br />
            This action cannot be undone</span
          >`,confirmLabel:"DELETE",confirm:!0,cancel:!0},bubbles:!0,composed:!0}))},this.toggle=()=>{this.open=!this.open}}firstUpdated(){window.document.body.addEventListener("superviz-modal--close",()=>{!this.open||this.emitEvent("close",{},{bubbles:!1,composed:!1})}),window.document.body.addEventListener("superviz-modal--confirm",()=>{!this.open||(this.emitEvent("confirm",{},{bubbles:!1,composed:!1}),this.emitEventCloseModal())})}updated(i){i.has("open")&&(this.open&&setTimeout(()=>this.emitEventOpenModal()),this.open||setTimeout(()=>this.emitEventCloseModal()))}emitEventCloseModal(){!this.open||(window.document.body.dispatchEvent(new CustomEvent("superviz-modal--close",{detail:{open:!0},bubbles:!0,composed:!0})),this.emitEvent("close",{},{bubbles:!1,composed:!1}))}render(){let i=()=>{if(this.useSlot)return Vt`<slot name="modal-handler" @click=${this.toggle}></slot>`},e=()=>{if(this.open)return Vt` <superviz-modal></superviz-modal> `};return Vt` ${i()} ${e()} `}};P3.styles=W_e,P3.properties={open:{type:Boolean},useSlot:{type:Boolean}},P3=Rs([Ps("superviz-comments-delete-comments-modal")],P3);nt();var DJ=Is(Bn),j_e=[DJ.styles,E_e],G_e=10*1e3,R3=class extends DJ{constructor(){super(),this.setTimer=()=>{clearTimeout(this.timeout),this.isCanceled=!1,this.timeout=setTimeout(()=>{this.isCanceled||(this.timeToHide=0,this.isCanceled=!1,this.hide())},this.timeToHide)},this.timeToHide=G_e,this.isCanceled=!1}firstUpdated(e){super.firstUpdated(e),this.updateComplete.then(()=>{gu.call(this,["comments"]),this.setTimer()})}hide(){this.emitEvent("hide",{},{bubbles:!1,composed:!1})}undone(){this.isCanceled=!0,this.hide(),this.emitEvent("undo-resolve",{type:"undo-resolve",resolved:!1},{bubbles:!1,composed:!1}),clearTimeout(this.timeout)}render(){return this.timeToHide===0?Vt``:this.isCanceled?Vt``:Vt`
      <div class="comments__annotation-resolved">
        <span class="text text-big sv-gray-700 comments__annotation-resolved__text"
          >You resolved this comment</span
        >
        <button
          id="undone"
          @click=${this.undone}
          class="icon-button icon-button--clickable icon-button--medium comments__annotation-resolved__unresolve_button"
        >
          <superviz-icon name="undo" size="md"></superviz-icon>
        </button>
      </div>
    `}};R3.styles=j_e,R3.properties={timeToHide:{type:Number},isCanceled:{type:Boolean}},R3=Rs([Ps("superviz-comments-annotation-resolved")],R3);nt();var kJ=Is(Bn),q_e=[kJ.styles,A_e],lT=[{label:"All comments"},{label:"Resolved comments"}],I3=class extends kJ{constructor(){super(),this.selectClick=()=>{this.caret=this.caret==="down"?"up":"down"},this.dropdownOptionsHandler=({detail:i})=>{this.emitEvent("select",{filter:i}),this.selectClick()},this.caret="down"}firstUpdated(i){super.firstUpdated(i),this.updateComplete.then(()=>{gu.call(this,["comments"])})}render(){let i=this.filter==="All comments"?lT[0].label:lT[1].label;lT[0].active=this.filter==="All comments",lT[1].active=this.filter==="Resolved comments";let e={text:!0,"text-bold":!0,"select-content":!0,"comments__filter__selected-label":!0,"sv-gray-500":this.caret==="down","sv-gray-700":this.caret==="up"};return Vt`
      <div class="comments__filter-container">
        <div class="comments__filter">
          <superviz-dropdown
            options=${JSON.stringify(lT)}
            position="bottom-left"
            right-offset="100px"
            @click=${this.selectClick}
            @selected=${this.dropdownOptionsHandler}
            @close=${this.selectClick}
            classesPrefix="comments__dropdown"
            parentComponent="comments"
          >
            <div class="comments__filter__toggle-button" slot="dropdown">
              <span class=${Hr(e)}>${i}</span>
              <div class="comments__filter__icon">
                <superviz-icon name=${this.caret} size="xs"></superviz-icon>
              </div>
            </div>
          </superviz-dropdown>
        </div>
      </div>
    `}};I3.styles=q_e,I3.properties={filter:{type:String},caret:{type:String}},I3=Rs([Ps("superviz-comments-annotation-filter")],I3);nt();var FJ=Is(Bn),X_e=[FJ.styles,C_e],L3=class extends FJ{constructor(){super(),this.onTogglePinActive=({detail:{isActive:e}})=>{this.isActive=e},this.isHidden=!0,this.positionStyles="top: 20px; left: 20px;",this.shouldHide=!1,this.commentsPosition="left"}firstUpdated(e){super.firstUpdated(e),this.updateComplete.then(()=>{gu.call(this,["comments"])}),this.mouseHovering=!1;let t=this.shadowRoot.querySelector(".comments__floating-button");t.addEventListener("mouseenter",()=>{setTimeout(()=>t.classList.add("comments-floating-button-hovered"),300),this.mouseHovering=!0}),t.addEventListener("mouseleave",()=>{t.classList.remove("comments-floating-button-hovered"),this.mouseHovering=!1})}toggle(){this.emitEvent("toggle",{})}connectedCallback(){super.connectedCallback(),window.document.body.addEventListener("toggle-annotation-sidebar",()=>{this.isHidden=!this.isHidden}),window.document.body.addEventListener("toggle-pin-active",this.onTogglePinActive)}disconnectedCallback(){super.disconnectedCallback(),window.document.body.removeEventListener("toggle-annotation-sidebar",()=>{this.isHidden=!this.isHidden}),window.document.body.removeEventListener("toggle-pin-active",this.onTogglePinActive)}updated(e){super.updated(e),this.updateComplete.then(()=>{let t=this.shadowRoot.querySelector(".comments__floating-button");!t||t.setAttribute("style",this.positionStyles)})}calculateIfShouldHide(){var e;let t=(e=document.getElementsByTagName("superviz-comments")[0])==null?void 0:e.shadowRoot.querySelector(".superviz-comments"),r=this.shadowRoot.querySelector(".comments__floating-button");if(!t||!r)return;let{left:n,right:l,top:c,bottom:h}=t.getBoundingClientRect(),{left:d,right:f,top:m,bottom:g}=r.getBoundingClientRect(),y=h>m&&g>c,_=c<g&&m<h,b=l>d&&f>n,S=n<f&&d<l;this.shouldHide=(_||y)&&(b||S)}render(){this.calculateIfShouldHide();let e={"comments__floating-button":!0,"hide-button":!this.isHidden&&this.shouldHide,"is-active":this.isActive,"is-inactive":!this.isActive},t={"comments__floating-button-text-box":!0,"comments__floating-button-text-box--hovered":this.mouseHovering},r={text:!0,"text-big":!0,"text-bold":!0,"not-hovered":!this.mouseHovering,"comments__floating-button__text":!0,textActive:this.isActive,textInactive:!this.isActive};return Vt` <button @click=${this.toggle} class="${Hr(e)}">
      <div class="comments__floating-button__icon">
        <superviz-icon
          size="sm"
          name="comment"
          color=${this.mouseHovering||this.isActive?"white":"black"}
        ></superviz-icon>
        <svg class="cross" width="8px" height="8px" viewBox="0 0 8 8">
          <rect class="cross-bar-1" x="0" y="3" width="8px" height="2px" />
          <rect class="cross-bar-2" x="0" y="3" width="8px" height="2px" />
        </svg>
      </div>
      <div class=${Hr(t)}>
        <p class="${Hr(r)} comment">Comment</p>
        <p class="${Hr(r)} cancel">Cancel</p>
      </div>
    </button>`}};L3.styles=X_e,L3.properties={positionStyles:{type:String},isHidden:{type:Boolean},commentsPosition:{type:String},isActive:{type:Boolean},mouseHovering:{type:Boolean}},L3=Rs([Ps("superviz-comments-button")],L3);nt();var zJ=Is(Bn),Z_e=[zJ.styles,R_e],O3=class extends zJ{constructor(){super(),this.showMentionList=()=>{var i;let e=(i=this.shadowRoot)==null?void 0:i.getElementById("mention-list");e==null||e.style.setProperty("display","block"),e==null||e.style.setProperty("margin-top","1px"),e.addEventListener("wheel",this.stopHandleZoom)},this.hideMentionList=()=>{var i;let e=(i=this.shadowRoot)==null?void 0:i.getElementById("mention-list");e.removeEventListener("wheel",this.stopHandleZoom),e==null||e.style.setProperty("display","none")},this.selectParticipant=i=>{this.emitEvent("participant-selected",i,{bubbles:!1,composed:!1}),this.hideMentionList()},this.stopHandleZoom=i=>{var e;let t=(e=this.shadowRoot)==null?void 0:e.getElementById("mention-list");t.scrollTop+=i.deltaY,i.preventDefault()},this.participants=[]}updated(i){if(i.has("participants")&&this.participants.length>0){this.showMentionList();return}this.hideMentionList()}getAvatar(i){var e;return i.avatar?Vt`<img class="avatar" src=${i.avatar} />`:Vt`<div class="default-avatar">
      <p class="text text-bold">${((e=i.name[0])==null?void 0:e.toUpperCase())||"A"}</p>
    </div>`}render(){let i=e=>Vt`
      <div class="mention-item" @click=${()=>this.selectParticipant(e)}>
          ${this.getAvatar(e)}
        <div class="avatar-type">${e.name}</div>
      </div>
    `;return Vt`
      <div id="mention-list">
        ${dL(this.participants,e=>e.id,e=>Vt`
          ${i(e)}
        `)}
      </div>
    `}};O3.styles=Z_e,O3.properties={participants:{type:Object}},O3=Rs([Ps("superviz-comments-mention-list")],O3);nt();nt();nt();nt();var J_e=Zn`
  .who-is-online__participant-list {
    display: flex;
    align-items: center;
    gap: 4px;
    position: relative;
  }

  .who-is-online {
    display: flex;
    flex-direction: column;
    position: fixed;
    z-index: 99;
  }

  .who-is-online__presence-control-message__text {
    margin: 0;
  }

  .who-is-online__participant {
    border-radius: 50%;
    box-sizing: border-box;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    user-select: none;
    cursor: pointer;
    transition: opacity 0.3s ease-in-out;
    border: 2px solid #878291;
    border-radius: 50%;
    max-width: 40px;
    flex: 1 0 40px;
  }

  .followed {
    border-style: dashed !important;
    animation: rotate 15s linear infinite;
  }

  .followed .who-is-online__participant__avatar {
    animation: nullifyRotate 15s linear infinite;
  }

  .private {
    opacity: 0.3;
  }

  @keyframes rotate {
    100% {
      transform: rotate(1turn);
    }
  }

  @keyframes nullifyRotate {
    100% {
      transform: rotate(-1turn);
    }
  }

  .who-is-online__participant.disable-dropdown {
    cursor: default;
  }

  .who-is-online__participant__avatar {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Open Sans';
    font-size: 14px;
    line-height: 14px;
    line-height: 14px;
    font-weight: bold;
    color: #26242a;
    object-fit: contain;
  }

  .superviz-who-is-online__excess {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: Roboto;
    font-size: 14px;
    line-height: 16px;
    text-align: center;
    font-weight: bold;
    cursor: pointer;
    color: #aea9b8;
  }

  .excess_participants:hover,
  .excess_participants--open {
    background-color: #aea9b8 !important;
  }

  .excess_participants:hover > div,
  .excess_participants--open > div {
    color: #fff !important;
  }

  @media (max-width: 780px) {
    .who-is-online__participant {
      width: 32px;
      height: 32px;
    }

    .who-is-online__participant {
      flex: 1 0 32px;
      max-width: 32px;
    }

    .who-is-online__participant__avatar {
      width: 24px;
      height: 24px;
    }

    .who-is-online__participant-list {
      gap: 8px;
    }

    .superviz-who-is-online__excess {
      width: 24px;
      height: 24px;
      font-size: 12px;
      line-height: 12px;
    }
  }
`;nt();var Y_e=Zn`
  .dropdown {
    position: relative;
  }

  .who-is-online__extra-participant {
    display: flex;
    user-select: none;
    align-items: center;
    justify-items: start;
    gap: 4px;
    width: 100%;
    padding: 10px;
    border-radius: 2px;
    position: relative;
    cursor: pointer;
  }

  .who-is-online__extra-participant.disable-dropdown {
    cursor: default;
  }

  .who-is-online__extra-participant:hover,
  .who-is-online__extra-participant--selected {
    background-color: rgb(var(--sv-gray-200));
  }

  .who-is-online__participant {
    border-radius: 50%;
    box-sizing: border-box;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    border: 2px solid #878291;
    border-radius: 50%;
    max-width: 40px;
    flex: 1 0 40px;
  }

  .who-is-online__participant__avatar {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Open Sans';
    font-size: 14px;
    line-height: 14px;
    font-weight: bold;
    color: #26242a;
    object-fit: contain;
  }

  .dropdown-list {
    position: relative;
    display: flex;
    flex-direction: column;
    z-index: 100;
  }

  .dropdown-list > div {
    padding: 4px;
    width: 216px;
    box-sizing: border-box;
  }

  .who-is-online__extras-dropdown {
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
    opacity: 0;
    display: none;
    background: #fff;
    padding: 0;
    z-index: 1;
    transition: 0.2s;
    border-radius: 3px;
    max-height: 240px;
    overflow: auto;
  }

  .who-is-online__extras-dropdown superviz-dropdown:hover {
    z-index: 999;
    position: relative;
  }

  .who-is-online__extras__arrow-icon {
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .menu--bottom {
    top: 4px;
    min-width: 103px;
    position: absolute;
    right: 0;
  }

  .menu--top {
    bottom: 44px;
    min-width: 103px;
    position: absolute;
    right: 0px;
  }

  .menu-open {
    display: block;
    opacity: 1;
  }

  .superviz-who-is-online-dropdown__tooltip {
    background-color: rgb(var(--sv-gray-600));
    padding: 8px;
    display: flex;
    flex-direction: column;
    gap: 8px;
    align-items: center;
    position: absolute;
    top: 52px;
    left: 50%;
    transform: translateX(-50%);
    border-radius: 2px;
    opacity: 0;
    cursor: default;
    display: none;
    transition: opacity 0.2s ease-in-out display 0s;
  }

  .superviz-who-is-online-dropdown__tooltip-arrow {
    width: 13px;
    height: 13px;
    position: absolute;
    top: 0px;
    left: 50%;
    transform: rotate(45deg) translateX(-50%);
    background-color: rgb(var(--sv-gray-600));
    border-top-left-radius: 3px;
  }

  .dropdown-content:hover + .superviz-who-is-online-dropdown__tooltip {
    opacity: 1;
    display: block;
  }

  .tooltip-content {
    margin: 0;
    font-family: roboto;
    white-space: nowrap;
    text-align: center;
    color: white;
    font-size: 14px;
  }

  .who-is-online__extras__username {
    font-size: 14px;
    line-height: 20px;
    font-family: 'Open sans';
    color: rgb(var(--sv-gray-600));
  }

  .icon {
    flex: 1;
    justify-content: flex-end;
    display: flex;
  }

  .hide-icon {
    display: none;
  }

  @media (max-width: 780px) {
    .sv-icon,
    .who-is-online__participant {
      width: 32px;
      height: 32px;
    }

    .who-is-online__participant {
      flex: 1 0 32px;
      max-width: 32px;
    }

    .who-is-online__participant__avatar {
      width: 24px;
      height: 24px;
    }

    .dropdown-list > div {
      width: 192px;
    }

    .menu--top {
      bottom: 36px;
    }

    .superviz-who-is-online-dropdown__tooltip {
      top: 44px;
    }
  }
`;nt();var K_e=Zn`
  .who-is-online__controls-messages {
    position: absolute;
    right: 0;
    display: flex;
    flex-direction: column;
    gap: 5px;
    margin-top: 4px;
  }

  .who-is-online__presence-control-message {
    box-sizing: border-box;
    font-size: 12px;
    padding: 8px 10px;
    font-family: 'Roboto';
    border-radius: 6px;
    background-color: #fff;
    color: rgb(var(--sv-gray-700));
    border: 2px solid #e0e0e0;
    white-space: nowrap;
  }

  .who-is-online__pcm__text {
    margin: 0;
  }

  .who-is-online__presence-control-message span {
    margin-left: 3px;
    text-decoration: underline;
    cursor: pointer;
  }

  .left-side {
    left: 0;
  }

  .right-side {
    right: 0;
  }

  .left-side .who-is-online__presence-control-message {
    align-self: flex-start;
  }

  .right-side .who-is-online__presence-control-message {
    align-self: flex-end;
  }

  .bottom-side {
    bottom: auto;
    top: calc(100% + 5px);
  }

  .top-side {
    top: auto;
    bottom: calc(100% + 5px);
  }
`,BJ=Is(Bn),Q_e=[BJ.styles,J_e],N3=class extends BJ{constructor(){super(),this.onClickOutDropdown=({detail:l})=>{this.open=l.open},this.toggleShowTooltip=()=>{this.showTooltip=!this.showTooltip},this.dropdownOptionsHandler=({detail:{label:l,participantId:c,source:h}})=>{switch(l){case"go to":this.handleGoTo(c);break;case"follow":this.handleLocalFollow(c,h);break;case"unfollow":this.handleLocalUnfollow();break;case"private mode":this.handlePrivate(c);break;case"leave private mode":this.handleCancelPrivate(c);break;case"everyone follows me":this.handleFollow(c,h);break;case"stop followers":this.handleStopFollow();break;case"gather all":this.handleGatherAll(c);break}},this.position="top: 20px; right: 40px;",this.showTooltip=!0,this.open=!1;let{localParticipant:i}=this.useStore("global-store"),{participants:e,following:t,extras:r}=this.useStore("who-is-online-store");e.subscribe(),t.subscribe(),r.subscribe(l=>{this.amountOfExtras=l.length}),i.subscribe(l=>{var c,h;let d=(c=l.activeComponents)==null?void 0:c.some(f=>f.toLowerCase().includes("presence"));this.localParticipantData={id:l.id,joinedPresence:(h=l.activeComponents)==null?void 0:h.some(f=>f.toLowerCase().includes("presence"))},this.disableDropdown=!d});let{disablePresenceControls:n}=this.useStore("who-is-online-store");n.subscribe()}firstUpdated(i){super.firstUpdated(i),gu.call(this,"who-is-online")}toggleOpen(){this.open=!this.open}dropdownPosition(i){if(this.participants.length===1)return"bottom-center";if(i===0)return"bottom-right";let e=this.participants.length>4,t=i+1===this.participants.length;return e||!t?"bottom-center":"bottom-left"}renderExtras(){var i;if(!this.amountOfExtras)return;let e={"who-is-online__participant":!0,excess_participants:!0,"excess_participants--open":this.open};return Vt`
      <superviz-who-is-online-dropdown
        @selected=${this.dropdownOptionsHandler}
        @clickout=${this.onClickOutDropdown}
        ?disableDropdown=${this.disableDropdown}
        ?showSeeMoreTooltip=${this.showTooltip}
        @toggle=${this.toggleOpen}
        @toggle-dropdown-state=${this.toggleShowTooltip}
        ?localParticipantJoinedPresence=${(i=this.localParticipantData)==null?void 0:i.joinedPresence}
        classesPrefix="who-is-online__controls"
        parentComponent="who-is-online"
        tooltipPrefix="who-is-online"
      >
        <div class=${Hr(e)} slot="dropdown">
          <div class="superviz-who-is-online__excess who-is-online__extras">
            +${this.amountOfExtras}
          </div>
        </div>
      </superviz-who-is-online-dropdown>
    `}getAvatar({color:i,imageUrl:e,firstLetter:t,slotIndex:r}){if(e)return Vt` <img
        class="who-is-online__participant__avatar"
        style="background-color: ${i}"
        src=${e}
      />`;let n=jB.includes(r)?"#FFFFFF":"#26242A";return Vt`<div
      class="who-is-online__participant__avatar"
      style="background-color: ${i}; color: ${n}"
    >
      ${t}
    </div>`}cancelPrivate(){this.isPrivate=void 0,this.emitEvent("realtime.private-mode",{id:this.localParticipantData.id})}renderParticipants(){return this.participants.length?Vt`
      ${dL(this.participants,i=>i.id,(i,e)=>{var t;let{avatar:r,id:n,name:l,tooltip:c,controls:h,disableDropdown:d,isLocalParticipant:f}=i,m=this.dropdownPosition(e),g=((t=this.following)==null?void 0:t.id)===n,y={"who-is-online__participant":!0,"disable-dropdown":d,followed:g||this.everyoneFollowsMe&&f,private:f&&this.isPrivate};return Vt`
            <superviz-dropdown
              options=${JSON.stringify(h)}
              returnData=${JSON.stringify({participantId:n,source:"participants"})}
              position=${m}
              name=${l}
              tooltipData=${JSON.stringify(c)}
              classesPrefix="who-is-online__controls"
              parentComponent="who-is-online"
              tooltipPrefix="who-is-online"
              ?disabled=${d}
              ?canShowTooltip=${this.showTooltip}
              @selected=${this.dropdownOptionsHandler}
              @toggle-dropdown-state=${this.toggleShowTooltip}
            >
              <div
                slot="dropdown"
                class=${Hr(y)}
                style="border-color: ${r.color}"
              >
                ${this.getAvatar(r)}
              </div>
            </superviz-dropdown>
          `})}
    `:Vt``}handleGoTo(i){this.emitEvent("realtime.go-to-participant",{id:i})}handleLocalFollow(i,e){let{following:t}=this.useStore("who-is-online-store"),r=this.useStore("who-is-online-store")[e].value,{id:n,name:l,avatar:{color:c}}=r.find(({id:h})=>h===i);this.everyoneFollowsMe&&this.handleStopFollow(),t.publish({name:l,id:n,color:c}),this.emitEvent("realtime.local-follow-participant",{id:n,source:e})}handleLocalUnfollow(){let{following:i}=this.useStore("who-is-online-store");i.publish(void 0),this.emitEvent("realtime.local-follow-participant",{id:void 0})}handlePrivate(i){this.everyoneFollowsMe&&this.handleStopFollow(),this.emitEvent("realtime.private-mode",{id:i,isPrivate:!0}),this.isPrivate=!0}handleCancelPrivate(i){this.emitEvent("realtime.private-mode",{id:i,isPrivate:!1}),this.isPrivate=!1}handleFollow(i,e){this.isPrivate&&this.cancelPrivate();let t=this.useStore("who-is-online-store")[e].value,{id:r,name:n,avatar:{color:l,slotIndex:c}}=t.find(({id:d})=>d===i);this.everyoneFollowsMe=!0;let{following:h}=this.useStore("who-is-online-store");h.publish(void 0),this.emitEvent("realtime.follow-participant",{id:r,name:n,color:l,slotIndex:c})}handleStopFollow(){this.everyoneFollowsMe=!1,this.emitEvent("realtime.follow-participant",void 0)}handleGatherAll(i){this.isPrivate&&this.cancelPrivate(),this.emitEvent("realtime.gather",{id:i})}updated(i){super.updated(i),this.updateComplete.then(()=>{let e=this.shadowRoot.querySelector(".who-is-online");if(!e)return;let t=this.position.includes("left")?"flex-start":"flex-end",r=`${this.position} align-items: ${t};`;e.setAttribute("style",r)})}render(){return Vt`<div class="who-is-online who-is-online">
      <div class="who-is-online__participant-list">
        ${this.renderParticipants()} ${this.renderExtras()}
      </div>
      <superviz-who-is-online-messages
        ?everyoneFollowsMe=${this.everyoneFollowsMe}
        ?isPrivate=${this.isPrivate}
        @stop-following=${this.handleLocalUnfollow}
        @cancel-private=${this.cancelPrivate}
        @stop-everyone-follows-me=${this.handleStopFollow}
      ></superviz-who-is-online-messages>
    </div> `}};N3.styles=Q_e,N3.properties={position:{type:String},open:{type:Boolean},localParticipantColor:{type:String},isPrivate:{type:Boolean},everyoneFollowsMe:{type:Boolean},showTooltip:{type:Boolean}},N3=Rs([Ps("superviz-who-is-online")],N3);nt();nt();nt();var UJ=Is(Bn),exe=[UJ.styles,K_e],D3=class extends UJ{constructor(){super(),this.repositionMessages=()=>{let{following:t,everyoneFollowsMe:r,isPrivate:n}=this;if(t||r||n){this.repositionInVerticalDirection(),this.repositionInHorizontalDirection(),this.animationFrame=window.requestAnimationFrame(this.repositionMessages);return}window.cancelAnimationFrame(this.animationFrame)};let{localParticipant:i}=this.useStore("global-store");i.subscribe(t=>{this.participantColor=t.color});let{following:e}=this.useStore("who-is-online-store");e.subscribe()}firstUpdated(i){super.firstUpdated(i),gu.call(this,"who-is-online")}updated(i){super.updated(i),["following","everyoneFollowsMe","isPrivate"].some(e=>i.has(e))&&this.repositionMessages()}repositionInVerticalDirection(){let i=window.innerHeight/2,{top:e}=this.parentElement.getBoundingClientRect();if(e<i){this.verticalSide="bottom-side";return}this.verticalSide="top-side"}repositionInHorizontalDirection(){let i=window.innerWidth/2,{left:e}=this.parentElement.getBoundingClientRect();if(e<i){this.horizontalSide="left-side";return}this.horizontalSide="right-side"}stopFollowing(){this.emitEvent("stop-following",{})}cancelPrivate(){this.emitEvent("cancel-private",{})}stopEveryoneFollowsMe(){this.emitEvent("stop-everyone-follows-me",{})}followingMessage(){if(!this.following)return"";let{name:i,color:e}=this.following;return Vt`<div
      class="who-is-online__following-message who-is-online__presence-control-message who-is-online__pcm"
      style="border-color: ${e}"
    >
      <p class="who-is-online__presence-control-message__text who-is-online__pcm__text">
        Following: ${i}
        <span
          class="who-is-online__presence-control-message__cancel-action-button who-is-online__pcm__cancel-action-button"
          @click=${this.stopFollowing}
          >Stop</span
        >
      </p>
    </div>`}everyoneFollowsMeMessage(){return this.everyoneFollowsMe?Vt`<div
      class="who-is-online__follow-me-message who-is-online__presence-control-message who-is-online__pcm"
      style="border-color: ${this.participantColor}"
    >
      <p class="who-is-online__presence-control-message__text who-is-online__pcm__text">
        Everyone is following you
        <span
          class="who-is-online__presence-control-message__cancel-action-button who-is-online__pcm__cancel-action-button"
          @click=${this.stopEveryoneFollowsMe}
          >Stop</span
        >
      </p>
    </div>`:""}privateMessage(){return this.isPrivate?Vt`<div
      class="who-is-online__private-mode-message who-is-online__presence-control-message who-is-online__pcm"
      style="border-color: ${this.participantColor}"
    >
      <p class="who-is-online__presence-control-message__text who-is-online__pcm__text">
        You are in Private Mode
        <span
          class="who-is-online__presence-control-message__cancel-action-button who-is-online__pcm__cancel-action-button"
          @click=${this.cancelPrivate}
          >Cancel</span
        >
      </p>
    </div>`:""}render(){let i={"who-is-online__controls-messages":!0,[this.verticalSide]:!0,[this.horizontalSide]:!0};return Vt` <div class=${Hr(i)}>
      ${this.followingMessage()} ${this.everyoneFollowsMeMessage()} ${this.privateMessage()}
    </div>`}};D3.styles=exe,D3.properties={everyoneFollowsMe:{type:Boolean},isPrivate:{type:Boolean},verticalSide:{type:String},horizontalSide:{type:String}},D3=Rs([Ps("superviz-who-is-online-messages")],D3);nt();var HJ=Is(Bn),txe=[HJ.styles,Y_e],k3=class extends HJ{constructor(){super(),this.onClickOutDropdown=t=>{if(t.stopPropagation(),!this.open)return;let r=t.composedPath(),n=this.shadowRoot.querySelector(".dropdown-content"),l=this.shadowRoot.querySelector(".dropdown-list"),c=this.shadowRoot.querySelector('slot[name="dropdown"]').assignedElements()[0],h=r.includes(n),d=r.includes(l),f=r.includes(c);h||d||f||this.close()},this.close=()=>{this.open=!1,this.selected="",this.emitEvent("clickout",{bubbles:!1,composed:!1})},this.selectParticipant=(t,r)=>()=>{r||(this.selected=t)},this.toggleShowTooltip=({detail:{open:t}})=>{this.showParticipantTooltip=!this.showParticipantTooltip,t||(this.selected="")},this.tooltip=()=>this.showSeeMoreTooltip?Vt`<superviz-tooltip
      tooltipData=${JSON.stringify({name:"See more"})}
      classesPrefix="who-is-online__tooltip"
      parentComponent="who-is-online"
    ></superviz-tooltip>`:"",this.repositionDropdown=()=>{if(!this.open){window.cancelAnimationFrame(this.animationFrame);return}this.repositionInVerticalDirection(),this.repositionInHorizontalDirection(),this.animationFrame=window.requestAnimationFrame(this.repositionDropdown)},this.repositionInVerticalDirection=()=>{let{bottom:t,top:r,height:n}=this.parentElement.getBoundingClientRect(),l=window.innerHeight/2;if(r+n/2>l){this.dropdownList.style.setProperty("bottom",`${window.innerHeight-r+8}px`),this.dropdownList.style.setProperty("top","");return}this.dropdownList.style.setProperty("top",`${t+8}px`),this.dropdownList.style.setProperty("bottom","")},this.repositionInHorizontalDirection=()=>{let{right:t,left:r}=this.parentElement.getBoundingClientRect();this.dropdownList.style.setProperty("right",`${window.innerWidth-t}px`),this.dropdownList.style.setProperty("left",`${r}px`)},this.selected="",this.showParticipantTooltip=!0;let{extras:e}=this.useStore("who-is-online-store");e.subscribe(t=>{this.participants=t})}firstUpdated(e){this.shadowRoot.querySelector(".who-is-online__extras-dropdown").scrollTop=0,gu.call(this,"who-is-online"),this.dropdownList=this.shadowRoot.querySelector(".dropdown-list"),this.dropdownList.style.position="fixed"}updated(e){if(e.has("open")){if(this.emitEvent("toggle-dropdown-state",{open:this.open,font:"toggle"}),this.open){document.addEventListener("click",this.onClickOutDropdown);return}document.removeEventListener("click",this.onClickOutDropdown)}}getAvatar({color:e,imageUrl:t,firstLetter:r,slotIndex:n}){if(t)return Vt` <img
        class="who-is-online__participant__avatar"
        style="background-color: ${e}"
        src=${t}
      />`;let l=jB.includes(n)?"#FFFFFF":"#26242A";return Vt`<div
      class="who-is-online__participant__avatar"
      style="background-color: ${e}; color: ${l}"
    >
      ${r}
    </div>`}renderParticipants(){if(!this.participants)return;let e=this.participants.length-1;return dL(this.participants,t=>t.id,(t,r)=>{let{disableDropdown:n,id:l,avatar:c,controls:h,tooltip:d,name:f}=t,m={"who-is-online__extra-participant":!0,"who-is-online__extra-participant--selected":this.selected===l,"disable-dropdown":n},g={"who-is-online__extras__arrow-icon":!0,"hide-icon":n},y=r===e;return Vt`
        <superviz-dropdown
          options=${JSON.stringify(h)}
          returnData=${JSON.stringify({participantId:l,source:"extras"})}
          tooltipData=${JSON.stringify(d)}
          position="bottom-right"
          classesPrefix="who-is-online__controls"
          parentComponent="who-is-online"
          tooltipPrefix="who-is-online"
          ?disabled=${n}
          ?canShowTooltip=${this.showParticipantTooltip}
          ?shiftTooltipLeft=${!0}
          ?lastParticipant=${y}
          @toggle-dropdown-state=${this.toggleShowTooltip}
          @selected=${this.close}
        >
        <div 
          class=${Hr(m)} 
          @click=${this.selectParticipant(l,n)} slot="dropdown">
            <div class="who-is-online__participant" style="border-color: 
            ${c.color}">
              ${this.getAvatar(c)}
            </div>
            <span class="who-is-online__extras__username">${f}</span>
            <superviz-icon 
              class=${Hr(g)} 
              name="right" 
              color="var(--sv-gray-600)"
              size="sm"
            >
          </superviz-icon>
          </div>
        </div>
      </superviz-dropdown>
      `})}toggle(){this.open=!this.open,this.open&&(this.selected="",this.repositionDropdown())}get menuClasses(){return{"who-is-online__extras-dropdown":!0,"menu--bottom":this.position==="bottom-side","menu--top":this.position==="top-side","menu-open":this.open}}render(){return Vt`
      <div class="dropdown">
        <div class="dropdown-content" @click=${this.toggle}>
          <slot name="dropdown"></slot>
        </div>
        ${this.tooltip()}
      </div>
      <div class="dropdown-list">
        <div class=${Hr(this.menuClasses)}>${this.renderParticipants()}</div>
      </div>
    `}};k3.styles=txe,k3.properties={open:{type:Boolean},align:{type:String},position:{type:String},selected:{type:String},disableDropdown:{type:Boolean},showSeeMoreTooltip:{type:Boolean},showParticipantTooltip:{type:Boolean},localParticipantJoinedPresence:{type:Boolean},dropdownList:{type:Object}},k3=Rs([Ps("superviz-who-is-online-dropdown")],k3);nt();nt();function ixe(i){if(typeof document<"u"){let e=document.createElement("style");e.id="superviz-style";let t=document.createTextNode(i);e.appendChild(t),document.head.appendChild(e)}}var rxe=`@import"https://unpkg.com/@superviz/sv-icons@0.8.13/css/style.css";@import"https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;500;700&family=Roboto:wght@400;500;700&display=swap";:root{--sv-primary: 98, 16, 204}html,body{width:100%;height:100%;overflow:hidden}#sv-video-wrapper iframe{position:fixed;border:none;margin:0;padding:0;overflow:hidden;z-index:1000}#sv-video-wrapper iframe.sv-video-frame--right{top:var(--superviz-offset-top);right:var(--superviz-offset-right)}#sv-video-wrapper iframe.sv-video-frame--left{top:var(--superviz-offset-top);left:var(--superviz-offset-left)}#sv-video-wrapper iframe.sv-video-frame--bottom{bottom:var(--superviz-offset-bottom);right:var(--superviz-offset-right);width:100%}#sv-video-wrapper iframe.sv-video-frame--top{top:var(--superviz-offset-top);right:var(--superviz-offset-right);width:100%}#sv-video-wrapper iframe.sv-video-frame--no-overlay{display:none}.pointer-mouse{display:flex;height:17px;width:17px;background-image:url(https://production.cdn.superviz.com/static/pointers/0.svg)}.mouse-user-name{display:block;position:absolute;border-radius:30px;padding:2px 8px;font-weight:700;font-size:14px;font-family:Roboto,sans-serif;line-height:22px;margin-left:10px;margin-top:-6px;background:yellow;white-space:nowrap}.mouse-follower{position:absolute;display:block;z-index:2;transition:all .15s linear,opacity 100s ease-in}
`;ixe(rxe);nt();nt();window&&(window.SuperVizRoom={init:_J,CommentEvent:QZ,MeetingEvent:GZ,DeviceEvent:KZ,RealtimeEvent:ZZ,MeetingState:JZ,MeetingConnectionStatus:YZ,MeetingControlsEvent:XZ,ParticipantEvent:Ru,FrameEvent:qZ,LayoutMode:uJ,VideoConference:V0e,MousePointers:hJ,Realtime:G0e,Comments:aJ,CanvasPin:oJ,HTMLPin:k0e,WhoIsOnline:mJ,FormElements:q0e,ParticipantType:tJ,LayoutPosition:lJ,CamerasPosition:cJ,RealtimeComponentState:dJ,RealtimeComponentEvent:fJ,ComponentLifeCycleEvent:$B,WhoIsOnlineEvent:eJ});var nxe=_J,sxe={},axe=Object.create,$J=Object.defineProperty,oxe=Object.getOwnPropertyDescriptor,lxe=Object.getOwnPropertyNames,uxe=Object.getPrototypeOf,cxe=Object.prototype.hasOwnProperty,hxe=Math.pow,Ba=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),dxe=(i,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of lxe(e))!cxe.call(i,n)&&n!==t&&$J(i,n,{get:()=>e[n],enumerable:!(r=oxe(e,n))||r.enumerable});return i},qB=(i,e,t)=>(t=i!=null?axe(uxe(i)):{},dxe(e||!i||!i.__esModule?$J(t,"default",{value:i,enumerable:!0}):t,i)),xo=(i,e,t)=>new Promise((r,n)=>{var l=d=>{try{h(t.next(d))}catch(f){n(f)}},c=d=>{try{h(t.throw(d))}catch(f){n(f)}},h=d=>d.done?r(d.value):Promise.resolve(d.value).then(l,c);h((t=t.apply(i,e)).next())}),fxe=Ba((i,e)=>{(function(){var t,r="4.17.21",n=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",c="Expected a function",h="Invalid `variable` option passed into `_.template`",d="__lodash_hash_undefined__",f=500,m="__lodash_placeholder__",g=1,y=2,_=4,b=1,S=2,E=1,T=2,A=4,P=8,O=16,R=32,D=64,L=128,N=256,U=512,F=30,z="...",G=800,J=16,Z=1,q=2,$=3,H=1/0,X=9007199254740991,re=17976931348623157e292,ae=NaN,he=4294967295,pe=he-1,de=he>>>1,ee=[["ary",L],["bind",E],["bindKey",T],["curry",P],["curryRight",O],["flip",U],["partial",R],["partialRight",D],["rearg",N]],se="[object Arguments]",Y="[object Array]",fe="[object AsyncFunction]",me="[object Boolean]",De="[object Date]",Le="[object DOMException]",Ce="[object Error]",Ae="[object Function]",Ue="[object GeneratorFunction]",Ne="[object Map]",Ge="[object Number]",Ct="[object Null]",it="[object Object]",bt="[object Promise]",Kt="[object Proxy]",kt="[object RegExp]",Pt="[object Set]",_e="[object String]",ce="[object Symbol]",Fe="[object Undefined]",et="[object WeakMap]",Dt="[object WeakSet]",gt="[object ArrayBuffer]",xe="[object DataView]",we="[object Float32Array]",Ve="[object Float64Array]",ut="[object Int8Array]",lt="[object Int16Array]",Ee="[object Int32Array]",_t="[object Uint8Array]",wt="[object Uint8ClampedArray]",Xt="[object Uint16Array]",Ft="[object Uint32Array]",gi=/\b__p \+= '';/g,Rt=/\b(__p \+=) '' \+/g,ci=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ji=/&(?:amp|lt|gt|quot|#39);/g,Ji=/[&<>"']/g,ws=RegExp(ji.source),Jn=RegExp(Ji.source),ao=/<%-([\s\S]+?)%>/g,oo=/<%([\s\S]+?)%>/g,lo=/<%=([\s\S]+?)%>/g,uo=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,vu=/^\w*$/,yu=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ls=/[\\^$.*+?()[\]{}|]/g,_u=RegExp(Ls.source),ye=/^\s+/,je=/\s/,tt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,qe=/\{\n\/\* \[wrapped with (.+)\] \*/,st=/,? & /,si=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ci=/[()=,{}\[\]\/\s]/,yi=/\\(\\)?/g,Xi=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,xr=/\w*$/,Yi=/^[-+]0x[0-9a-f]+$/i,Ki=/^0b[01]+$/i,tn=/^\[object .+?Constructor\]$/,Us=/^0o[0-7]+$/i,co=/^(?:0|[1-9]\d*)$/,Po=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Q=/($^)/,le=/['\n\r\u2028\u2029\\]/g,oe="\\ud800-\\udfff",ve="\\u0300-\\u036f",ke="\\ufe20-\\ufe2f",Oe="\\u20d0-\\u20ff",Je=ve+ke+Oe,mt="\\u2700-\\u27bf",vt="a-z\\xdf-\\xf6\\xf8-\\xff",ct="\\xac\\xb1\\xd7\\xf7",It="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Ht="\\u2000-\\u206f",qi=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ui="A-Z\\xc0-\\xd6\\xd8-\\xde",Ai="\\ufe0e\\ufe0f",Pr=ct+It+Ht+qi,Rr="['’]",Kr="["+oe+"]",or="["+Pr+"]",ui="["+Je+"]",pn="\\d+",_r="["+mt+"]",br="["+vt+"]",jr="[^"+oe+Pr+pn+mt+vt+Ui+"]",Gr="\\ud83c[\\udffb-\\udfff]",Ss="(?:"+ui+"|"+Gr+")",fn="[^"+oe+"]",Qr="(?:\\ud83c[\\udde6-\\uddff]){2}",Yn="[\\ud800-\\udbff][\\udc00-\\udfff]",Vr="["+Ui+"]",xu="\\u200d",Os="(?:"+br+"|"+jr+")",Lf="(?:"+Vr+"|"+jr+")",Hs="(?:"+Rr+"(?:d|ll|m|re|s|t|ve))?",ho="(?:"+Rr+"(?:D|LL|M|RE|S|T|VE))?",Ro=Ss+"?",Io="["+Ai+"]?",Of="(?:"+xu+"(?:"+[fn,Qr,Yn].join("|")+")"+Io+Ro+")*",Nf="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",og="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",uc=Io+Ro+Of,lg="(?:"+[_r,Qr,Yn].join("|")+")"+uc,ug="(?:"+[fn+ui+"?",ui,Qr,Yn,Kr].join("|")+")",cg=RegExp(Rr,"g"),hg=RegExp(ui,"g"),Lo=RegExp(Gr+"(?="+Gr+")|"+ug+uc,"g"),dg=RegExp([Vr+"?"+br+"+"+Hs+"(?="+[or,Vr,"$"].join("|")+")",Lf+"+"+ho+"(?="+[or,Vr+Os,"$"].join("|")+")",Vr+"?"+Os+"+"+Hs,Vr+"+"+ho,og,Nf,pn,lg].join("|"),"g"),fg=RegExp("["+xu+oe+Je+Ai+"]"),pg=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,mg=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],gg=-1,yt={};yt[we]=yt[Ve]=yt[ut]=yt[lt]=yt[Ee]=yt[_t]=yt[wt]=yt[Xt]=yt[Ft]=!0,yt[se]=yt[Y]=yt[gt]=yt[me]=yt[xe]=yt[De]=yt[Ce]=yt[Ae]=yt[Ne]=yt[Ge]=yt[it]=yt[kt]=yt[Pt]=yt[_e]=yt[et]=!1;var pt={};pt[se]=pt[Y]=pt[gt]=pt[xe]=pt[me]=pt[De]=pt[we]=pt[Ve]=pt[ut]=pt[lt]=pt[Ee]=pt[Ne]=pt[Ge]=pt[it]=pt[kt]=pt[Pt]=pt[_e]=pt[ce]=pt[_t]=pt[wt]=pt[Xt]=pt[Ft]=!0,pt[Ce]=pt[Ae]=pt[et]=!1;var vg={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},yg={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},_g={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},xg={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},bg=parseFloat,wg=parseInt,cc=typeof global=="object"&&global&&global.Object===Object&&global,Sg=typeof self=="object"&&self&&self.Object===Object&&self,Gt=cc||Sg||Function("return this")(),Oo=typeof i=="object"&&i&&!i.nodeType&&i,rn=Oo&&typeof e=="object"&&e&&!e.nodeType&&e,hc=rn&&rn.exports===Oo,No=hc&&cc.process,Pi=function(){try{var V=rn&&rn.require&&rn.require("util").types;return V||No&&No.binding&&No.binding("util")}catch{}}(),dc=Pi&&Pi.isArrayBuffer,fc=Pi&&Pi.isDate,pc=Pi&&Pi.isMap,mc=Pi&&Pi.isRegExp,gc=Pi&&Pi.isSet,vc=Pi&&Pi.isTypedArray;function _i(V,te,K){switch(K.length){case 0:return V.call(te);case 1:return V.call(te,K[0]);case 2:return V.call(te,K[0],K[1]);case 3:return V.call(te,K[0],K[1],K[2])}return V.apply(te,K)}function Mg(V,te,K,be){for(var ze=-1,rt=V==null?0:V.length;++ze<rt;){var Bt=V[ze];te(be,Bt,K(Bt),V)}return be}function Ri(V,te){for(var K=-1,be=V==null?0:V.length;++K<be&&te(V[K],K,V)!==!1;);return V}function Eg(V,te){for(var K=V==null?0:V.length;K--&&te(V[K],K,V)!==!1;);return V}function yc(V,te){for(var K=-1,be=V==null?0:V.length;++K<be;)if(!te(V[K],K,V))return!1;return!0}function Ir(V,te){for(var K=-1,be=V==null?0:V.length,ze=0,rt=[];++K<be;){var Bt=V[K];te(Bt,K,V)&&(rt[ze++]=Bt)}return rt}function $s(V,te){var K=V==null?0:V.length;return!!K&&En(V,te,0)>-1}function Do(V,te,K){for(var be=-1,ze=V==null?0:V.length;++be<ze;)if(K(te,V[be]))return!0;return!1}function xt(V,te){for(var K=-1,be=V==null?0:V.length,ze=Array(be);++K<be;)ze[K]=te(V[K],K,V);return ze}function Lr(V,te){for(var K=-1,be=te.length,ze=V.length;++K<be;)V[ze+K]=te[K];return V}function ko(V,te,K,be){var ze=-1,rt=V==null?0:V.length;for(be&&rt&&(K=V[++ze]);++ze<rt;)K=te(K,V[ze],ze,V);return K}function Tg(V,te,K,be){var ze=V==null?0:V.length;for(be&&ze&&(K=V[--ze]);ze--;)K=te(K,V[ze],ze,V);return K}function Fo(V,te){for(var K=-1,be=V==null?0:V.length;++K<be;)if(te(V[K],K,V))return!0;return!1}var Ag=zo("length");function Cg(V){return V.split("")}function Pg(V){return V.match(si)||[]}function _c(V,te,K){var be;return K(V,function(ze,rt,Bt){if(te(ze,rt,Bt))return be=rt,!1}),be}function Vs(V,te,K,be){for(var ze=V.length,rt=K+(be?1:-1);be?rt--:++rt<ze;)if(te(V[rt],rt,V))return rt;return-1}function En(V,te,K){return te===te?Hg(V,te,K):Vs(V,xc,K)}function Rg(V,te,K,be){for(var ze=K-1,rt=V.length;++ze<rt;)if(be(V[ze],te))return ze;return-1}function xc(V){return V!==V}function bc(V,te){var K=V==null?0:V.length;return K?Uo(V,te)/K:ae}function zo(V){return function(te){return te==null?t:te[V]}}function Bo(V){return function(te){return V==null?t:V[te]}}function wc(V,te,K,be,ze){return ze(V,function(rt,Bt,dt){K=be?(be=!1,rt):te(K,rt,Bt,dt)}),K}function Ig(V,te){var K=V.length;for(V.sort(te);K--;)V[K]=V[K].value;return V}function Uo(V,te){for(var K,be=-1,ze=V.length;++be<ze;){var rt=te(V[be]);rt!==t&&(K=K===t?rt:K+rt)}return K}function Ho(V,te){for(var K=-1,be=Array(V);++K<V;)be[K]=te(K);return be}function Lg(V,te){return xt(te,function(K){return[K,V[K]]})}function Sc(V){return V&&V.slice(0,Ac(V)+1).replace(ye,"")}function xi(V){return function(te){return V(te)}}function $o(V,te){return xt(te,function(K){return V[K]})}function Kn(V,te){return V.has(te)}function Mc(V,te){for(var K=-1,be=V.length;++K<be&&En(te,V[K],0)>-1;);return K}function Ec(V,te){for(var K=V.length;K--&&En(te,V[K],0)>-1;);return K}function Og(V,te){for(var K=V.length,be=0;K--;)V[K]===te&&++be;return be}var Ng=Bo(vg),Dg=Bo(yg);function kg(V){return"\\"+xg[V]}function Fg(V,te){return V==null?t:V[te]}function Tn(V){return fg.test(V)}function zg(V){return pg.test(V)}function Bg(V){for(var te,K=[];!(te=V.next()).done;)K.push(te.value);return K}function Vo(V){var te=-1,K=Array(V.size);return V.forEach(function(be,ze){K[++te]=[ze,be]}),K}function Tc(V,te){return function(K){return V(te(K))}}function Or(V,te){for(var K=-1,be=V.length,ze=0,rt=[];++K<be;){var Bt=V[K];(Bt===te||Bt===m)&&(V[K]=m,rt[ze++]=K)}return rt}function Ws(V){var te=-1,K=Array(V.size);return V.forEach(function(be){K[++te]=be}),K}function Ug(V){var te=-1,K=Array(V.size);return V.forEach(function(be){K[++te]=[be,be]}),K}function Hg(V,te,K){for(var be=K-1,ze=V.length;++be<ze;)if(V[be]===te)return be;return-1}function $g(V,te,K){for(var be=K+1;be--;)if(V[be]===te)return be;return be}function An(V){return Tn(V)?Wg(V):Ag(V)}function Hi(V){return Tn(V)?jg(V):Cg(V)}function Ac(V){for(var te=V.length;te--&&je.test(V.charAt(te)););return te}var Vg=Bo(_g);function Wg(V){for(var te=Lo.lastIndex=0;Lo.test(V);)++te;return te}function jg(V){return V.match(Lo)||[]}function Gg(V){return V.match(dg)||[]}var qg=function V(te){te=te==null?Gt:qr.defaults(Gt.Object(),te,qr.pick(Gt,mg));var K=te.Array,be=te.Date,ze=te.Error,rt=te.Function,Bt=te.Math,dt=te.Object,Wo=te.RegExp,Xg=te.String,Ii=te.TypeError,js=K.prototype,Zg=rt.prototype,Cn=dt.prototype,Gs=te["__core-js_shared__"],qs=Zg.toString,ot=Cn.hasOwnProperty,Jg=0,Cc=function(){var a=/[^.]+$/.exec(Gs&&Gs.keys&&Gs.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}(),Xs=Cn.toString,Yg=qs.call(dt),Kg=Gt._,Qg=Wo("^"+qs.call(ot).replace(Ls,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Zs=hc?te.Buffer:t,Nr=te.Symbol,Js=te.Uint8Array,Pc=Zs?Zs.allocUnsafe:t,Ys=Tc(dt.getPrototypeOf,dt),Rc=dt.create,Ic=Cn.propertyIsEnumerable,Ks=js.splice,Lc=Nr?Nr.isConcatSpreadable:t,Qn=Nr?Nr.iterator:t,nn=Nr?Nr.toStringTag:t,Qs=function(){try{var a=un(dt,"defineProperty");return a({},"",{}),a}catch{}}(),ev=te.clearTimeout!==Gt.clearTimeout&&te.clearTimeout,tv=be&&be.now!==Gt.Date.now&&be.now,iv=te.setTimeout!==Gt.setTimeout&&te.setTimeout,ea=Bt.ceil,ta=Bt.floor,jo=dt.getOwnPropertySymbols,rv=Zs?Zs.isBuffer:t,Oc=te.isFinite,nv=js.join,sv=Tc(dt.keys,dt),Ut=Bt.max,ei=Bt.min,av=be.now,ov=te.parseInt,Nc=Bt.random,lv=js.reverse,Go=un(te,"DataView"),es=un(te,"Map"),qo=un(te,"Promise"),Pn=un(te,"Set"),ts=un(te,"WeakMap"),is=un(dt,"create"),ia=ts&&new ts,Rn={},uv=cn(Go),cv=cn(es),hv=cn(qo),dv=cn(Pn),fv=cn(ts),ra=Nr?Nr.prototype:t,rs=ra?ra.valueOf:t,Dc=ra?ra.toString:t;function C(a){if(Tt(a)&&!Be(a)&&!(a instanceof Ye)){if(a instanceof Li)return a;if(ot.call(a,"__wrapped__"))return kh(a)}return new Li(a)}var In=function(){function a(){}return function(u){if(!St(u))return{};if(Rc)return Rc(u);a.prototype=u;var p=new a;return a.prototype=t,p}}();function na(){}function Li(a,u){this.__wrapped__=a,this.__actions__=[],this.__chain__=!!u,this.__index__=0,this.__values__=t}C.templateSettings={escape:ao,evaluate:oo,interpolate:lo,variable:"",imports:{_:C}},C.prototype=na.prototype,C.prototype.constructor=C,Li.prototype=In(na.prototype),Li.prototype.constructor=Li;function Ye(a){this.__wrapped__=a,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=he,this.__views__=[]}function pv(){var a=new Ye(this.__wrapped__);return a.__actions__=hi(this.__actions__),a.__dir__=this.__dir__,a.__filtered__=this.__filtered__,a.__iteratees__=hi(this.__iteratees__),a.__takeCount__=this.__takeCount__,a.__views__=hi(this.__views__),a}function mv(){if(this.__filtered__){var a=new Ye(this);a.__dir__=-1,a.__filtered__=!0}else a=this.clone(),a.__dir__*=-1;return a}function gv(){var a=this.__wrapped__.value(),u=this.__dir__,p=Be(a),x=u<0,M=p?a.length:0,I=Cy(0,M,this.__views__),k=I.start,B=I.end,W=B-k,ie=x?B:k-1,ne=this.__iteratees__,ue=ne.length,ge=0,Me=ei(W,this.__takeCount__);if(!p||!x&&M==W&&Me==W)return sh(a,this.__actions__);var Re=[];e:for(;W--&&ge<Me;){ie+=u;for(var $e=-1,Ie=a[ie];++$e<ue;){var Xe=ne[$e],Ke=Xe.iteratee,Si=Xe.type,li=Ke(Ie);if(Si==q)Ie=li;else if(!li){if(Si==Z)continue e;break e}}Re[ge++]=Ie}return Re}Ye.prototype=In(na.prototype),Ye.prototype.constructor=Ye;function sn(a){var u=-1,p=a==null?0:a.length;for(this.clear();++u<p;){var x=a[u];this.set(x[0],x[1])}}function vv(){this.__data__=is?is(null):{},this.size=0}function yv(a){var u=this.has(a)&&delete this.__data__[a];return this.size-=u?1:0,u}function _v(a){var u=this.__data__;if(is){var p=u[a];return p===d?t:p}return ot.call(u,a)?u[a]:t}function xv(a){var u=this.__data__;return is?u[a]!==t:ot.call(u,a)}function bv(a,u){var p=this.__data__;return this.size+=this.has(a)?0:1,p[a]=is&&u===t?d:u,this}sn.prototype.clear=vv,sn.prototype.delete=yv,sn.prototype.get=_v,sn.prototype.has=xv,sn.prototype.set=bv;function ur(a){var u=-1,p=a==null?0:a.length;for(this.clear();++u<p;){var x=a[u];this.set(x[0],x[1])}}function wv(){this.__data__=[],this.size=0}function Sv(a){var u=this.__data__,p=sa(u,a);if(p<0)return!1;var x=u.length-1;return p==x?u.pop():Ks.call(u,p,1),--this.size,!0}function Mv(a){var u=this.__data__,p=sa(u,a);return p<0?t:u[p][1]}function Ev(a){return sa(this.__data__,a)>-1}function Tv(a,u){var p=this.__data__,x=sa(p,a);return x<0?(++this.size,p.push([a,u])):p[x][1]=u,this}ur.prototype.clear=wv,ur.prototype.delete=Sv,ur.prototype.get=Mv,ur.prototype.has=Ev,ur.prototype.set=Tv;function cr(a){var u=-1,p=a==null?0:a.length;for(this.clear();++u<p;){var x=a[u];this.set(x[0],x[1])}}function Av(){this.size=0,this.__data__={hash:new sn,map:new(es||ur),string:new sn}}function Cv(a){var u=va(this,a).delete(a);return this.size-=u?1:0,u}function Pv(a){return va(this,a).get(a)}function Rv(a){return va(this,a).has(a)}function Iv(a,u){var p=va(this,a),x=p.size;return p.set(a,u),this.size+=p.size==x?0:1,this}cr.prototype.clear=Av,cr.prototype.delete=Cv,cr.prototype.get=Pv,cr.prototype.has=Rv,cr.prototype.set=Iv;function an(a){var u=-1,p=a==null?0:a.length;for(this.__data__=new cr;++u<p;)this.add(a[u])}function Lv(a){return this.__data__.set(a,d),this}function Ov(a){return this.__data__.has(a)}an.prototype.add=an.prototype.push=Lv,an.prototype.has=Ov;function $i(a){var u=this.__data__=new ur(a);this.size=u.size}function Nv(){this.__data__=new ur,this.size=0}function Dv(a){var u=this.__data__,p=u.delete(a);return this.size=u.size,p}function kv(a){return this.__data__.get(a)}function Fv(a){return this.__data__.has(a)}function zv(a,u){var p=this.__data__;if(p instanceof ur){var x=p.__data__;if(!es||x.length<n-1)return x.push([a,u]),this.size=++p.size,this;p=this.__data__=new cr(x)}return p.set(a,u),this.size=p.size,this}$i.prototype.clear=Nv,$i.prototype.delete=Dv,$i.prototype.get=kv,$i.prototype.has=Fv,$i.prototype.set=zv;function kc(a,u){var p=Be(a),x=!p&&hn(a),M=!p&&!x&&Br(a),I=!p&&!x&&!M&&Dn(a),k=p||x||M||I,B=k?Ho(a.length,Xg):[],W=B.length;for(var ie in a)(u||ot.call(a,ie))&&!(k&&(ie=="length"||M&&(ie=="offset"||ie=="parent")||I&&(ie=="buffer"||ie=="byteLength"||ie=="byteOffset")||pr(ie,W)))&&B.push(ie);return B}function Fc(a){var u=a.length;return u?a[nl(0,u-1)]:t}function Bv(a,u){return ya(hi(a),on(u,0,a.length))}function Uv(a){return ya(hi(a))}function Xo(a,u,p){(p!==t&&!Vi(a[u],p)||p===t&&!(u in a))&&hr(a,u,p)}function ns(a,u,p){var x=a[u];(!(ot.call(a,u)&&Vi(x,p))||p===t&&!(u in a))&&hr(a,u,p)}function sa(a,u){for(var p=a.length;p--;)if(Vi(a[p][0],u))return p;return-1}function Hv(a,u,p,x){return Dr(a,function(M,I,k){u(x,M,p(M),k)}),x}function zc(a,u){return a&&er(u,Wt(u),a)}function $v(a,u){return a&&er(u,fi(u),a)}function hr(a,u,p){u=="__proto__"&&Qs?Qs(a,u,{configurable:!0,enumerable:!0,value:p,writable:!0}):a[u]=p}function Zo(a,u){for(var p=-1,x=u.length,M=K(x),I=a==null;++p<x;)M[p]=I?t:Pl(a,u[p]);return M}function on(a,u,p){return a===a&&(p!==t&&(a=a<=p?a:p),u!==t&&(a=a>=u?a:u)),a}function Oi(a,u,p,x,M,I){var k,B=u&g,W=u&y,ie=u&_;if(p&&(k=M?p(a,x,M,I):p(a)),k!==t)return k;if(!St(a))return a;var ne=Be(a);if(ne){if(k=Ry(a),!B)return hi(a,k)}else{var ue=ti(a),ge=ue==Ae||ue==Ue;if(Br(a))return lh(a,B);if(ue==it||ue==se||ge&&!M){if(k=W||ge?{}:Ah(a),!B)return W?_y(a,$v(k,a)):yy(a,zc(k,a))}else{if(!pt[ue])return M?a:{};k=Iy(a,ue,B)}}I||(I=new $i);var Me=I.get(a);if(Me)return Me;I.set(a,k),id(a)?a.forEach(function(Ie){k.add(Oi(Ie,u,p,Ie,a,I))}):ed(a)&&a.forEach(function(Ie,Xe){k.set(Xe,Oi(Ie,u,p,Xe,a,I))});var Re=ie?W?ml:pl:W?fi:Wt,$e=ne?t:Re(a);return Ri($e||a,function(Ie,Xe){$e&&(Xe=Ie,Ie=a[Xe]),ns(k,Xe,Oi(Ie,u,p,Xe,a,I))}),k}function Vv(a){var u=Wt(a);return function(p){return Bc(p,a,u)}}function Bc(a,u,p){var x=p.length;if(a==null)return!x;for(a=dt(a);x--;){var M=p[x],I=u[M],k=a[M];if(k===t&&!(M in a)||!I(k))return!1}return!0}function Uc(a,u,p){if(typeof a!="function")throw new Ii(c);return hs(function(){a.apply(t,p)},u)}function ss(a,u,p,x){var M=-1,I=$s,k=!0,B=a.length,W=[],ie=u.length;if(!B)return W;p&&(u=xt(u,xi(p))),x?(I=Do,k=!1):u.length>=n&&(I=Kn,k=!1,u=new an(u));e:for(;++M<B;){var ne=a[M],ue=p==null?ne:p(ne);if(ne=x||ne!==0?ne:0,k&&ue===ue){for(var ge=ie;ge--;)if(u[ge]===ue)continue e;W.push(ne)}else I(u,ue,x)||W.push(ne)}return W}var Dr=fh(Qi),Hc=fh(Yo,!0);function Wv(a,u){var p=!0;return Dr(a,function(x,M,I){return p=!!u(x,M,I),p}),p}function aa(a,u,p){for(var x=-1,M=a.length;++x<M;){var I=a[x],k=u(I);if(k!=null&&(B===t?k===k&&!wi(k):p(k,B)))var B=k,W=I}return W}function jv(a,u,p,x){var M=a.length;for(p=He(p),p<0&&(p=-p>M?0:M+p),x=x===t||x>M?M:He(x),x<0&&(x+=M),x=p>x?0:nd(x);p<x;)a[p++]=u;return a}function $c(a,u){var p=[];return Dr(a,function(x,M,I){u(x,M,I)&&p.push(x)}),p}function Zt(a,u,p,x,M){var I=-1,k=a.length;for(p||(p=Oy),M||(M=[]);++I<k;){var B=a[I];u>0&&p(B)?u>1?Zt(B,u-1,p,x,M):Lr(M,B):x||(M[M.length]=B)}return M}var Jo=ph(),Vc=ph(!0);function Qi(a,u){return a&&Jo(a,u,Wt)}function Yo(a,u){return a&&Vc(a,u,Wt)}function oa(a,u){return Ir(u,function(p){return mr(a[p])})}function ln(a,u){u=Fr(u,a);for(var p=0,x=u.length;a!=null&&p<x;)a=a[tr(u[p++])];return p&&p==x?a:t}function Wc(a,u,p){var x=u(a);return Be(a)?x:Lr(x,p(a))}function ai(a){return a==null?a===t?Fe:Ct:nn&&nn in dt(a)?Ay(a):Uy(a)}function Ko(a,u){return a>u}function Gv(a,u){return a!=null&&ot.call(a,u)}function qv(a,u){return a!=null&&u in dt(a)}function Xv(a,u,p){return a>=ei(u,p)&&a<Ut(u,p)}function Qo(a,u,p){for(var x=p?Do:$s,M=a[0].length,I=a.length,k=I,B=K(I),W=1/0,ie=[];k--;){var ne=a[k];k&&u&&(ne=xt(ne,xi(u))),W=ei(ne.length,W),B[k]=!p&&(u||M>=120&&ne.length>=120)?new an(k&&ne):t}ne=a[0];var ue=-1,ge=B[0];e:for(;++ue<M&&ie.length<W;){var Me=ne[ue],Re=u?u(Me):Me;if(Me=p||Me!==0?Me:0,!(ge?Kn(ge,Re):x(ie,Re,p))){for(k=I;--k;){var $e=B[k];if(!($e?Kn($e,Re):x(a[k],Re,p)))continue e}ge&&ge.push(Re),ie.push(Me)}}return ie}function Zv(a,u,p,x){return Qi(a,function(M,I,k){u(x,p(M),I,k)}),x}function as(a,u,p){u=Fr(u,a),a=Ih(a,u);var x=a==null?a:a[tr(Di(u))];return x==null?t:_i(x,a,p)}function jc(a){return Tt(a)&&ai(a)==se}function Jv(a){return Tt(a)&&ai(a)==gt}function Yv(a){return Tt(a)&&ai(a)==De}function os(a,u,p,x,M){return a===u?!0:a==null||u==null||!Tt(a)&&!Tt(u)?a!==a&&u!==u:Kv(a,u,p,x,os,M)}function Kv(a,u,p,x,M,I){var k=Be(a),B=Be(u),W=k?Y:ti(a),ie=B?Y:ti(u);W=W==se?it:W,ie=ie==se?it:ie;var ne=W==it,ue=ie==it,ge=W==ie;if(ge&&Br(a)){if(!Br(u))return!1;k=!0,ne=!1}if(ge&&!ne)return I||(I=new $i),k||Dn(a)?Mh(a,u,p,x,M,I):Ey(a,u,W,p,x,M,I);if(!(p&b)){var Me=ne&&ot.call(a,"__wrapped__"),Re=ue&&ot.call(u,"__wrapped__");if(Me||Re){var $e=Me?a.value():a,Ie=Re?u.value():u;return I||(I=new $i),M($e,Ie,p,x,I)}}return ge?(I||(I=new $i),Ty(a,u,p,x,M,I)):!1}function Qv(a){return Tt(a)&&ti(a)==Ne}function el(a,u,p,x){var M=p.length,I=M,k=!x;if(a==null)return!I;for(a=dt(a);M--;){var B=p[M];if(k&&B[2]?B[1]!==a[B[0]]:!(B[0]in a))return!1}for(;++M<I;){B=p[M];var W=B[0],ie=a[W],ne=B[1];if(k&&B[2]){if(ie===t&&!(W in a))return!1}else{var ue=new $i;if(x)var ge=x(ie,ne,W,a,u,ue);if(!(ge===t?os(ne,ie,b|S,x,ue):ge))return!1}}return!0}function Gc(a){if(!St(a)||Dy(a))return!1;var u=mr(a)?Qg:tn;return u.test(cn(a))}function ey(a){return Tt(a)&&ai(a)==kt}function ty(a){return Tt(a)&&ti(a)==Pt}function iy(a){return Tt(a)&&Ma(a.length)&&!!yt[ai(a)]}function qc(a){return typeof a=="function"?a:a==null?pi:typeof a=="object"?Be(a)?Jc(a[0],a[1]):Zc(a):md(a)}function tl(a){if(!cs(a))return sv(a);var u=[];for(var p in dt(a))ot.call(a,p)&&p!="constructor"&&u.push(p);return u}function ry(a){if(!St(a))return By(a);var u=cs(a),p=[];for(var x in a)x=="constructor"&&(u||!ot.call(a,x))||p.push(x);return p}function il(a,u){return a<u}function Xc(a,u){var p=-1,x=di(a)?K(a.length):[];return Dr(a,function(M,I,k){x[++p]=u(M,I,k)}),x}function Zc(a){var u=vl(a);return u.length==1&&u[0][2]?Ph(u[0][0],u[0][1]):function(p){return p===a||el(p,a,u)}}function Jc(a,u){return _l(a)&&Ch(u)?Ph(tr(a),u):function(p){var x=Pl(p,a);return x===t&&x===u?Rl(p,a):os(u,x,b|S)}}function la(a,u,p,x,M){a!==u&&Jo(u,function(I,k){if(M||(M=new $i),St(I))ny(a,u,k,p,la,x,M);else{var B=x?x(bl(a,k),I,k+"",a,u,M):t;B===t&&(B=I),Xo(a,k,B)}},fi)}function ny(a,u,p,x,M,I,k){var B=bl(a,p),W=bl(u,p),ie=k.get(W);if(ie){Xo(a,p,ie);return}var ne=I?I(B,W,p+"",a,u,k):t,ue=ne===t;if(ue){var ge=Be(W),Me=!ge&&Br(W),Re=!ge&&!Me&&Dn(W);ne=W,ge||Me||Re?Be(B)?ne=B:Lt(B)?ne=hi(B):Me?(ue=!1,ne=lh(W,!0)):Re?(ue=!1,ne=uh(W,!0)):ne=[]:ds(W)||hn(W)?(ne=B,hn(B)?ne=sd(B):(!St(B)||mr(B))&&(ne=Ah(W))):ue=!1}ue&&(k.set(W,ne),M(ne,W,x,I,k),k.delete(W)),Xo(a,p,ne)}function Yc(a,u){var p=a.length;if(p)return u+=u<0?p:0,pr(u,p)?a[u]:t}function Kc(a,u,p){u.length?u=xt(u,function(I){return Be(I)?function(k){return ln(k,I.length===1?I[0]:I)}:I}):u=[pi];var x=-1;u=xt(u,xi(Pe()));var M=Xc(a,function(I,k,B){var W=xt(u,function(ie){return ie(I)});return{criteria:W,index:++x,value:I}});return Ig(M,function(I,k){return vy(I,k,p)})}function sy(a,u){return Qc(a,u,function(p,x){return Rl(a,x)})}function Qc(a,u,p){for(var x=-1,M=u.length,I={};++x<M;){var k=u[x],B=ln(a,k);p(B,k)&&ls(I,Fr(k,a),B)}return I}function ay(a){return function(u){return ln(u,a)}}function rl(a,u,p,x){var M=x?Rg:En,I=-1,k=u.length,B=a;for(a===u&&(u=hi(u)),p&&(B=xt(a,xi(p)));++I<k;)for(var W=0,ie=u[I],ne=p?p(ie):ie;(W=M(B,ne,W,x))>-1;)B!==a&&Ks.call(B,W,1),Ks.call(a,W,1);return a}function eh(a,u){for(var p=a?u.length:0,x=p-1;p--;){var M=u[p];if(p==x||M!==I){var I=M;pr(M)?Ks.call(a,M,1):ol(a,M)}}return a}function nl(a,u){return a+ta(Nc()*(u-a+1))}function oy(a,u,p,x){for(var M=-1,I=Ut(ea((u-a)/(p||1)),0),k=K(I);I--;)k[x?I:++M]=a,a+=p;return k}function sl(a,u){var p="";if(!a||u<1||u>X)return p;do u%2&&(p+=a),u=ta(u/2),u&&(a+=a);while(u);return p}function We(a,u){return wl(Rh(a,u,pi),a+"")}function ly(a){return Fc(kn(a))}function uy(a,u){var p=kn(a);return ya(p,on(u,0,p.length))}function ls(a,u,p,x){if(!St(a))return a;u=Fr(u,a);for(var M=-1,I=u.length,k=I-1,B=a;B!=null&&++M<I;){var W=tr(u[M]),ie=p;if(W==="__proto__"||W==="constructor"||W==="prototype")return a;if(M!=k){var ne=B[W];ie=x?x(ne,W,B):t,ie===t&&(ie=St(ne)?ne:pr(u[M+1])?[]:{})}ns(B,W,ie),B=B[W]}return a}var th=ia?function(a,u){return ia.set(a,u),a}:pi,cy=Qs?function(a,u){return Qs(a,"toString",{configurable:!0,enumerable:!1,value:Ll(u),writable:!0})}:pi;function hy(a){return ya(kn(a))}function Ni(a,u,p){var x=-1,M=a.length;u<0&&(u=-u>M?0:M+u),p=p>M?M:p,p<0&&(p+=M),M=u>p?0:p-u>>>0,u>>>=0;for(var I=K(M);++x<M;)I[x]=a[x+u];return I}function dy(a,u){var p;return Dr(a,function(x,M,I){return p=u(x,M,I),!p}),!!p}function ua(a,u,p){var x=0,M=a==null?x:a.length;if(typeof u=="number"&&u===u&&M<=de){for(;x<M;){var I=x+M>>>1,k=a[I];k!==null&&!wi(k)&&(p?k<=u:k<u)?x=I+1:M=I}return M}return al(a,u,pi,p)}function al(a,u,p,x){var M=0,I=a==null?0:a.length;if(I===0)return 0;u=p(u);for(var k=u!==u,B=u===null,W=wi(u),ie=u===t;M<I;){var ne=ta((M+I)/2),ue=p(a[ne]),ge=ue!==t,Me=ue===null,Re=ue===ue,$e=wi(ue);if(k)var Ie=x||Re;else ie?Ie=Re&&(x||ge):B?Ie=Re&&ge&&(x||!Me):W?Ie=Re&&ge&&!Me&&(x||!$e):Me||$e?Ie=!1:Ie=x?ue<=u:ue<u;Ie?M=ne+1:I=ne}return ei(I,pe)}function ih(a,u){for(var p=-1,x=a.length,M=0,I=[];++p<x;){var k=a[p],B=u?u(k):k;if(!p||!Vi(B,W)){var W=B;I[M++]=k===0?0:k}}return I}function rh(a){return typeof a=="number"?a:wi(a)?ae:+a}function bi(a){if(typeof a=="string")return a;if(Be(a))return xt(a,bi)+"";if(wi(a))return Dc?Dc.call(a):"";var u=a+"";return u=="0"&&1/a==-H?"-0":u}function kr(a,u,p){var x=-1,M=$s,I=a.length,k=!0,B=[],W=B;if(p)k=!1,M=Do;else if(I>=n){var ie=u?null:Sy(a);if(ie)return Ws(ie);k=!1,M=Kn,W=new an}else W=u?[]:B;e:for(;++x<I;){var ne=a[x],ue=u?u(ne):ne;if(ne=p||ne!==0?ne:0,k&&ue===ue){for(var ge=W.length;ge--;)if(W[ge]===ue)continue e;u&&W.push(ue),B.push(ne)}else M(W,ue,p)||(W!==B&&W.push(ue),B.push(ne))}return B}function ol(a,u){return u=Fr(u,a),a=Ih(a,u),a==null||delete a[tr(Di(u))]}function nh(a,u,p,x){return ls(a,u,p(ln(a,u)),x)}function ca(a,u,p,x){for(var M=a.length,I=x?M:-1;(x?I--:++I<M)&&u(a[I],I,a););return p?Ni(a,x?0:I,x?I+1:M):Ni(a,x?I+1:0,x?M:I)}function sh(a,u){var p=a;return p instanceof Ye&&(p=p.value()),ko(u,function(x,M){return M.func.apply(M.thisArg,Lr([x],M.args))},p)}function ll(a,u,p){var x=a.length;if(x<2)return x?kr(a[0]):[];for(var M=-1,I=K(x);++M<x;)for(var k=a[M],B=-1;++B<x;)B!=M&&(I[M]=ss(I[M]||k,a[B],u,p));return kr(Zt(I,1),u,p)}function ah(a,u,p){for(var x=-1,M=a.length,I=u.length,k={};++x<M;){var B=x<I?u[x]:t;p(k,a[x],B)}return k}function ul(a){return Lt(a)?a:[]}function cl(a){return typeof a=="function"?a:pi}function Fr(a,u){return Be(a)?a:_l(a,u)?[a]:Dh(at(a))}var fy=We;function zr(a,u,p){var x=a.length;return p=p===t?x:p,!u&&p>=x?a:Ni(a,u,p)}var oh=ev||function(a){return Gt.clearTimeout(a)};function lh(a,u){if(u)return a.slice();var p=a.length,x=Pc?Pc(p):new a.constructor(p);return a.copy(x),x}function hl(a){var u=new a.constructor(a.byteLength);return new Js(u).set(new Js(a)),u}function py(a,u){var p=u?hl(a.buffer):a.buffer;return new a.constructor(p,a.byteOffset,a.byteLength)}function my(a){var u=new a.constructor(a.source,xr.exec(a));return u.lastIndex=a.lastIndex,u}function gy(a){return rs?dt(rs.call(a)):{}}function uh(a,u){var p=u?hl(a.buffer):a.buffer;return new a.constructor(p,a.byteOffset,a.length)}function ch(a,u){if(a!==u){var p=a!==t,x=a===null,M=a===a,I=wi(a),k=u!==t,B=u===null,W=u===u,ie=wi(u);if(!B&&!ie&&!I&&a>u||I&&k&&W&&!B&&!ie||x&&k&&W||!p&&W||!M)return 1;if(!x&&!I&&!ie&&a<u||ie&&p&&M&&!x&&!I||B&&p&&M||!k&&M||!W)return-1}return 0}function vy(a,u,p){for(var x=-1,M=a.criteria,I=u.criteria,k=M.length,B=p.length;++x<k;){var W=ch(M[x],I[x]);if(W){if(x>=B)return W;var ie=p[x];return W*(ie=="desc"?-1:1)}}return a.index-u.index}function hh(a,u,p,x){for(var M=-1,I=a.length,k=p.length,B=-1,W=u.length,ie=Ut(I-k,0),ne=K(W+ie),ue=!x;++B<W;)ne[B]=u[B];for(;++M<k;)(ue||M<I)&&(ne[p[M]]=a[M]);for(;ie--;)ne[B++]=a[M++];return ne}function dh(a,u,p,x){for(var M=-1,I=a.length,k=-1,B=p.length,W=-1,ie=u.length,ne=Ut(I-B,0),ue=K(ne+ie),ge=!x;++M<ne;)ue[M]=a[M];for(var Me=M;++W<ie;)ue[Me+W]=u[W];for(;++k<B;)(ge||M<I)&&(ue[Me+p[k]]=a[M++]);return ue}function hi(a,u){var p=-1,x=a.length;for(u||(u=K(x));++p<x;)u[p]=a[p];return u}function er(a,u,p,x){var M=!p;p||(p={});for(var I=-1,k=u.length;++I<k;){var B=u[I],W=x?x(p[B],a[B],B,p,a):t;W===t&&(W=a[B]),M?hr(p,B,W):ns(p,B,W)}return p}function yy(a,u){return er(a,yl(a),u)}function _y(a,u){return er(a,Eh(a),u)}function ha(a,u){return function(p,x){var M=Be(p)?Mg:Hv,I=u?u():{};return M(p,a,Pe(x,2),I)}}function Ln(a){return We(function(u,p){var x=-1,M=p.length,I=M>1?p[M-1]:t,k=M>2?p[2]:t;for(I=a.length>3&&typeof I=="function"?(M--,I):t,k&&oi(p[0],p[1],k)&&(I=M<3?t:I,M=1),u=dt(u);++x<M;){var B=p[x];B&&a(u,B,x,I)}return u})}function fh(a,u){return function(p,x){if(p==null)return p;if(!di(p))return a(p,x);for(var M=p.length,I=u?M:-1,k=dt(p);(u?I--:++I<M)&&x(k[I],I,k)!==!1;);return p}}function ph(a){return function(u,p,x){for(var M=-1,I=dt(u),k=x(u),B=k.length;B--;){var W=k[a?B:++M];if(p(I[W],W,I)===!1)break}return u}}function xy(a,u,p){var x=u&E,M=us(a);function I(){var k=this&&this!==Gt&&this instanceof I?M:a;return k.apply(x?p:this,arguments)}return I}function mh(a){return function(u){u=at(u);var p=Tn(u)?Hi(u):t,x=p?p[0]:u.charAt(0),M=p?zr(p,1).join(""):u.slice(1);return x[a]()+M}}function On(a){return function(u){return ko(fd(dd(u).replace(cg,"")),a,"")}}function us(a){return function(){var u=arguments;switch(u.length){case 0:return new a;case 1:return new a(u[0]);case 2:return new a(u[0],u[1]);case 3:return new a(u[0],u[1],u[2]);case 4:return new a(u[0],u[1],u[2],u[3]);case 5:return new a(u[0],u[1],u[2],u[3],u[4]);case 6:return new a(u[0],u[1],u[2],u[3],u[4],u[5]);case 7:return new a(u[0],u[1],u[2],u[3],u[4],u[5],u[6])}var p=In(a.prototype),x=a.apply(p,u);return St(x)?x:p}}function by(a,u,p){var x=us(a);function M(){for(var I=arguments.length,k=K(I),B=I,W=Nn(M);B--;)k[B]=arguments[B];var ie=I<3&&k[0]!==W&&k[I-1]!==W?[]:Or(k,W);if(I-=ie.length,I<p)return xh(a,u,da,M.placeholder,t,k,ie,t,t,p-I);var ne=this&&this!==Gt&&this instanceof M?x:a;return _i(ne,this,k)}return M}function gh(a){return function(u,p,x){var M=dt(u);if(!di(u)){var I=Pe(p,3);u=Wt(u),p=function(B){return I(M[B],B,M)}}var k=a(u,p,x);return k>-1?M[I?u[k]:k]:t}}function vh(a){return fr(function(u){var p=u.length,x=p,M=Li.prototype.thru;for(a&&u.reverse();x--;){var I=u[x];if(typeof I!="function")throw new Ii(c);if(M&&!k&&ga(I)=="wrapper")var k=new Li([],!0)}for(x=k?x:p;++x<p;){I=u[x];var B=ga(I),W=B=="wrapper"?gl(I):t;W&&xl(W[0])&&W[1]==(L|P|R|N)&&!W[4].length&&W[9]==1?k=k[ga(W[0])].apply(k,W[3]):k=I.length==1&&xl(I)?k[B]():k.thru(I)}return function(){var ie=arguments,ne=ie[0];if(k&&ie.length==1&&Be(ne))return k.plant(ne).value();for(var ue=0,ge=p?u[ue].apply(this,ie):ne;++ue<p;)ge=u[ue].call(this,ge);return ge}})}function da(a,u,p,x,M,I,k,B,W,ie){var ne=u&L,ue=u&E,ge=u&T,Me=u&(P|O),Re=u&U,$e=ge?t:us(a);function Ie(){for(var Xe=arguments.length,Ke=K(Xe),Si=Xe;Si--;)Ke[Si]=arguments[Si];if(Me)var li=Nn(Ie),Mi=Og(Ke,li);if(x&&(Ke=hh(Ke,x,M,Me)),I&&(Ke=dh(Ke,I,k,Me)),Xe-=Mi,Me&&Xe<ie){var Ot=Or(Ke,li);return xh(a,u,da,Ie.placeholder,p,Ke,Ot,B,W,ie-Xe)}var Wi=ue?p:this,vr=ge?Wi[a]:a;return Xe=Ke.length,B?Ke=Hy(Ke,B):Re&&Xe>1&&Ke.reverse(),ne&&W<Xe&&(Ke.length=W),this&&this!==Gt&&this instanceof Ie&&(vr=$e||us(vr)),vr.apply(Wi,Ke)}return Ie}function yh(a,u){return function(p,x){return Zv(p,a,u(x),{})}}function fa(a,u){return function(p,x){var M;if(p===t&&x===t)return u;if(p!==t&&(M=p),x!==t){if(M===t)return x;typeof p=="string"||typeof x=="string"?(p=bi(p),x=bi(x)):(p=rh(p),x=rh(x)),M=a(p,x)}return M}}function dl(a){return fr(function(u){return u=xt(u,xi(Pe())),We(function(p){var x=this;return a(u,function(M){return _i(M,x,p)})})})}function pa(a,u){u=u===t?" ":bi(u);var p=u.length;if(p<2)return p?sl(u,a):u;var x=sl(u,ea(a/An(u)));return Tn(u)?zr(Hi(x),0,a).join(""):x.slice(0,a)}function wy(a,u,p,x){var M=u&E,I=us(a);function k(){for(var B=-1,W=arguments.length,ie=-1,ne=x.length,ue=K(ne+W),ge=this&&this!==Gt&&this instanceof k?I:a;++ie<ne;)ue[ie]=x[ie];for(;W--;)ue[ie++]=arguments[++B];return _i(ge,M?p:this,ue)}return k}function _h(a){return function(u,p,x){return x&&typeof x!="number"&&oi(u,p,x)&&(p=x=t),u=gr(u),p===t?(p=u,u=0):p=gr(p),x=x===t?u<p?1:-1:gr(x),oy(u,p,x,a)}}function ma(a){return function(u,p){return typeof u=="string"&&typeof p=="string"||(u=ki(u),p=ki(p)),a(u,p)}}function xh(a,u,p,x,M,I,k,B,W,ie){var ne=u&P,ue=ne?k:t,ge=ne?t:k,Me=ne?I:t,Re=ne?t:I;u|=ne?R:D,u&=~(ne?D:R),u&A||(u&=~(E|T));var $e=[a,u,M,Me,ue,Re,ge,B,W,ie],Ie=p.apply(t,$e);return xl(a)&&Lh(Ie,$e),Ie.placeholder=x,Oh(Ie,a,u)}function fl(a){var u=Bt[a];return function(p,x){if(p=ki(p),x=x==null?0:ei(He(x),292),x&&Oc(p)){var M=(at(p)+"e").split("e"),I=u(M[0]+"e"+(+M[1]+x));return M=(at(I)+"e").split("e"),+(M[0]+"e"+(+M[1]-x))}return u(p)}}var Sy=Pn&&1/Ws(new Pn([,-0]))[1]==H?function(a){return new Pn(a)}:Dl;function bh(a){return function(u){var p=ti(u);return p==Ne?Vo(u):p==Pt?Ug(u):Lg(u,a(u))}}function dr(a,u,p,x,M,I,k,B){var W=u&T;if(!W&&typeof a!="function")throw new Ii(c);var ie=x?x.length:0;if(ie||(u&=~(R|D),x=M=t),k=k===t?k:Ut(He(k),0),B=B===t?B:He(B),ie-=M?M.length:0,u&D){var ne=x,ue=M;x=M=t}var ge=W?t:gl(a),Me=[a,u,p,x,M,ne,ue,I,k,B];if(ge&&zy(Me,ge),a=Me[0],u=Me[1],p=Me[2],x=Me[3],M=Me[4],B=Me[9]=Me[9]===t?W?0:a.length:Ut(Me[9]-ie,0),!B&&u&(P|O)&&(u&=~(P|O)),!u||u==E)var Re=xy(a,u,p);else u==P||u==O?Re=by(a,u,B):(u==R||u==(E|R))&&!M.length?Re=wy(a,u,p,x):Re=da.apply(t,Me);var $e=ge?th:Lh;return Oh($e(Re,Me),a,u)}function wh(a,u,p,x){return a===t||Vi(a,Cn[p])&&!ot.call(x,p)?u:a}function Sh(a,u,p,x,M,I){return St(a)&&St(u)&&(I.set(u,a),la(a,u,t,Sh,I),I.delete(u)),a}function My(a){return ds(a)?t:a}function Mh(a,u,p,x,M,I){var k=p&b,B=a.length,W=u.length;if(B!=W&&!(k&&W>B))return!1;var ie=I.get(a),ne=I.get(u);if(ie&&ne)return ie==u&&ne==a;var ue=-1,ge=!0,Me=p&S?new an:t;for(I.set(a,u),I.set(u,a);++ue<B;){var Re=a[ue],$e=u[ue];if(x)var Ie=k?x($e,Re,ue,u,a,I):x(Re,$e,ue,a,u,I);if(Ie!==t){if(Ie)continue;ge=!1;break}if(Me){if(!Fo(u,function(Xe,Ke){if(!Kn(Me,Ke)&&(Re===Xe||M(Re,Xe,p,x,I)))return Me.push(Ke)})){ge=!1;break}}else if(!(Re===$e||M(Re,$e,p,x,I))){ge=!1;break}}return I.delete(a),I.delete(u),ge}function Ey(a,u,p,x,M,I,k){switch(p){case xe:if(a.byteLength!=u.byteLength||a.byteOffset!=u.byteOffset)return!1;a=a.buffer,u=u.buffer;case gt:return!(a.byteLength!=u.byteLength||!I(new Js(a),new Js(u)));case me:case De:case Ge:return Vi(+a,+u);case Ce:return a.name==u.name&&a.message==u.message;case kt:case _e:return a==u+"";case Ne:var B=Vo;case Pt:var W=x&b;if(B||(B=Ws),a.size!=u.size&&!W)return!1;var ie=k.get(a);if(ie)return ie==u;x|=S,k.set(a,u);var ne=Mh(B(a),B(u),x,M,I,k);return k.delete(a),ne;case ce:if(rs)return rs.call(a)==rs.call(u)}return!1}function Ty(a,u,p,x,M,I){var k=p&b,B=pl(a),W=B.length,ie=pl(u),ne=ie.length;if(W!=ne&&!k)return!1;for(var ue=W;ue--;){var ge=B[ue];if(!(k?ge in u:ot.call(u,ge)))return!1}var Me=I.get(a),Re=I.get(u);if(Me&&Re)return Me==u&&Re==a;var $e=!0;I.set(a,u),I.set(u,a);for(var Ie=k;++ue<W;){ge=B[ue];var Xe=a[ge],Ke=u[ge];if(x)var Si=k?x(Ke,Xe,ge,u,a,I):x(Xe,Ke,ge,a,u,I);if(!(Si===t?Xe===Ke||M(Xe,Ke,p,x,I):Si)){$e=!1;break}Ie||(Ie=ge=="constructor")}if($e&&!Ie){var li=a.constructor,Mi=u.constructor;li!=Mi&&"constructor"in a&&"constructor"in u&&!(typeof li=="function"&&li instanceof li&&typeof Mi=="function"&&Mi instanceof Mi)&&($e=!1)}return I.delete(a),I.delete(u),$e}function fr(a){return wl(Rh(a,t,Bh),a+"")}function pl(a){return Wc(a,Wt,yl)}function ml(a){return Wc(a,fi,Eh)}var gl=ia?function(a){return ia.get(a)}:Dl;function ga(a){for(var u=a.name+"",p=Rn[u],x=ot.call(Rn,u)?p.length:0;x--;){var M=p[x],I=M.func;if(I==null||I==a)return M.name}return u}function Nn(a){var u=ot.call(C,"placeholder")?C:a;return u.placeholder}function Pe(){var a=C.iteratee||Ol;return a=a===Ol?qc:a,arguments.length?a(arguments[0],arguments[1]):a}function va(a,u){var p=a.__data__;return Ny(u)?p[typeof u=="string"?"string":"hash"]:p.map}function vl(a){for(var u=Wt(a),p=u.length;p--;){var x=u[p],M=a[x];u[p]=[x,M,Ch(M)]}return u}function un(a,u){var p=Fg(a,u);return Gc(p)?p:t}function Ay(a){var u=ot.call(a,nn),p=a[nn];try{a[nn]=t;var x=!0}catch{}var M=Xs.call(a);return x&&(u?a[nn]=p:delete a[nn]),M}var yl=jo?function(a){return a==null?[]:(a=dt(a),Ir(jo(a),function(u){return Ic.call(a,u)}))}:kl,Eh=jo?function(a){for(var u=[];a;)Lr(u,yl(a)),a=Ys(a);return u}:kl,ti=ai;(Go&&ti(new Go(new ArrayBuffer(1)))!=xe||es&&ti(new es)!=Ne||qo&&ti(qo.resolve())!=bt||Pn&&ti(new Pn)!=Pt||ts&&ti(new ts)!=et)&&(ti=function(a){var u=ai(a),p=u==it?a.constructor:t,x=p?cn(p):"";if(x)switch(x){case uv:return xe;case cv:return Ne;case hv:return bt;case dv:return Pt;case fv:return et}return u});function Cy(a,u,p){for(var x=-1,M=p.length;++x<M;){var I=p[x],k=I.size;switch(I.type){case"drop":a+=k;break;case"dropRight":u-=k;break;case"take":u=ei(u,a+k);break;case"takeRight":a=Ut(a,u-k);break}}return{start:a,end:u}}function Py(a){var u=a.match(qe);return u?u[1].split(st):[]}function Th(a,u,p){u=Fr(u,a);for(var x=-1,M=u.length,I=!1;++x<M;){var k=tr(u[x]);if(!(I=a!=null&&p(a,k)))break;a=a[k]}return I||++x!=M?I:(M=a==null?0:a.length,!!M&&Ma(M)&&pr(k,M)&&(Be(a)||hn(a)))}function Ry(a){var u=a.length,p=new a.constructor(u);return u&&typeof a[0]=="string"&&ot.call(a,"index")&&(p.index=a.index,p.input=a.input),p}function Ah(a){return typeof a.constructor=="function"&&!cs(a)?In(Ys(a)):{}}function Iy(a,u,p){var x=a.constructor;switch(u){case gt:return hl(a);case me:case De:return new x(+a);case xe:return py(a,p);case we:case Ve:case ut:case lt:case Ee:case _t:case wt:case Xt:case Ft:return uh(a,p);case Ne:return new x;case Ge:case _e:return new x(a);case kt:return my(a);case Pt:return new x;case ce:return gy(a)}}function Ly(a,u){var p=u.length;if(!p)return a;var x=p-1;return u[x]=(p>1?"& ":"")+u[x],u=u.join(p>2?", ":" "),a.replace(tt,`{
/* [wrapped with `+u+`] */
`)}function Oy(a){return Be(a)||hn(a)||!!(Lc&&a&&a[Lc])}function pr(a,u){var p=typeof a;return u=u??X,!!u&&(p=="number"||p!="symbol"&&co.test(a))&&a>-1&&a%1==0&&a<u}function oi(a,u,p){if(!St(p))return!1;var x=typeof u;return(x=="number"?di(p)&&pr(u,p.length):x=="string"&&u in p)?Vi(p[u],a):!1}function _l(a,u){if(Be(a))return!1;var p=typeof a;return p=="number"||p=="symbol"||p=="boolean"||a==null||wi(a)?!0:vu.test(a)||!uo.test(a)||u!=null&&a in dt(u)}function Ny(a){var u=typeof a;return u=="string"||u=="number"||u=="symbol"||u=="boolean"?a!=="__proto__":a===null}function xl(a){var u=ga(a),p=C[u];if(typeof p!="function"||!(u in Ye.prototype))return!1;if(a===p)return!0;var x=gl(p);return!!x&&a===x[0]}function Dy(a){return!!Cc&&Cc in a}var ky=Gs?mr:Fl;function cs(a){var u=a&&a.constructor,p=typeof u=="function"&&u.prototype||Cn;return a===p}function Ch(a){return a===a&&!St(a)}function Ph(a,u){return function(p){return p==null?!1:p[a]===u&&(u!==t||a in dt(p))}}function Fy(a){var u=wa(a,function(x){return p.size===f&&p.clear(),x}),p=u.cache;return u}function zy(a,u){var p=a[1],x=u[1],M=p|x,I=M<(E|T|L),k=x==L&&p==P||x==L&&p==N&&a[7].length<=u[8]||x==(L|N)&&u[7].length<=u[8]&&p==P;if(!(I||k))return a;x&E&&(a[2]=u[2],M|=p&E?0:A);var B=u[3];if(B){var W=a[3];a[3]=W?hh(W,B,u[4]):B,a[4]=W?Or(a[3],m):u[4]}return B=u[5],B&&(W=a[5],a[5]=W?dh(W,B,u[6]):B,a[6]=W?Or(a[5],m):u[6]),B=u[7],B&&(a[7]=B),x&L&&(a[8]=a[8]==null?u[8]:ei(a[8],u[8])),a[9]==null&&(a[9]=u[9]),a[0]=u[0],a[1]=M,a}function By(a){var u=[];if(a!=null)for(var p in dt(a))u.push(p);return u}function Uy(a){return Xs.call(a)}function Rh(a,u,p){return u=Ut(u===t?a.length-1:u,0),function(){for(var x=arguments,M=-1,I=Ut(x.length-u,0),k=K(I);++M<I;)k[M]=x[u+M];M=-1;for(var B=K(u+1);++M<u;)B[M]=x[M];return B[u]=p(k),_i(a,this,B)}}function Ih(a,u){return u.length<2?a:ln(a,Ni(u,0,-1))}function Hy(a,u){for(var p=a.length,x=ei(u.length,p),M=hi(a);x--;){var I=u[x];a[x]=pr(I,p)?M[I]:t}return a}function bl(a,u){if(!(u==="constructor"&&typeof a[u]=="function")&&u!="__proto__")return a[u]}var Lh=Nh(th),hs=iv||function(a,u){return Gt.setTimeout(a,u)},wl=Nh(cy);function Oh(a,u,p){var x=u+"";return wl(a,Ly(x,$y(Py(x),p)))}function Nh(a){var u=0,p=0;return function(){var x=av(),M=J-(x-p);if(p=x,M>0){if(++u>=G)return arguments[0]}else u=0;return a.apply(t,arguments)}}function ya(a,u){var p=-1,x=a.length,M=x-1;for(u=u===t?x:u;++p<u;){var I=nl(p,M),k=a[I];a[I]=a[p],a[p]=k}return a.length=u,a}var Dh=Fy(function(a){var u=[];return a.charCodeAt(0)===46&&u.push(""),a.replace(yu,function(p,x,M,I){u.push(M?I.replace(yi,"$1"):x||p)}),u});function tr(a){if(typeof a=="string"||wi(a))return a;var u=a+"";return u=="0"&&1/a==-H?"-0":u}function cn(a){if(a!=null){try{return qs.call(a)}catch{}try{return a+""}catch{}}return""}function $y(a,u){return Ri(ee,function(p){var x="_."+p[0];u&p[1]&&!$s(a,x)&&a.push(x)}),a.sort()}function kh(a){if(a instanceof Ye)return a.clone();var u=new Li(a.__wrapped__,a.__chain__);return u.__actions__=hi(a.__actions__),u.__index__=a.__index__,u.__values__=a.__values__,u}function Vy(a,u,p){(p?oi(a,u,p):u===t)?u=1:u=Ut(He(u),0);var x=a==null?0:a.length;if(!x||u<1)return[];for(var M=0,I=0,k=K(ea(x/u));M<x;)k[I++]=Ni(a,M,M+=u);return k}function Wy(a){for(var u=-1,p=a==null?0:a.length,x=0,M=[];++u<p;){var I=a[u];I&&(M[x++]=I)}return M}function jy(){var a=arguments.length;if(!a)return[];for(var u=K(a-1),p=arguments[0],x=a;x--;)u[x-1]=arguments[x];return Lr(Be(p)?hi(p):[p],Zt(u,1))}var Gy=We(function(a,u){return Lt(a)?ss(a,Zt(u,1,Lt,!0)):[]}),qy=We(function(a,u){var p=Di(u);return Lt(p)&&(p=t),Lt(a)?ss(a,Zt(u,1,Lt,!0),Pe(p,2)):[]}),Xy=We(function(a,u){var p=Di(u);return Lt(p)&&(p=t),Lt(a)?ss(a,Zt(u,1,Lt,!0),t,p):[]});function Zy(a,u,p){var x=a==null?0:a.length;return x?(u=p||u===t?1:He(u),Ni(a,u<0?0:u,x)):[]}function Jy(a,u,p){var x=a==null?0:a.length;return x?(u=p||u===t?1:He(u),u=x-u,Ni(a,0,u<0?0:u)):[]}function Yy(a,u){return a&&a.length?ca(a,Pe(u,3),!0,!0):[]}function Ky(a,u){return a&&a.length?ca(a,Pe(u,3),!0):[]}function Qy(a,u,p,x){var M=a==null?0:a.length;return M?(p&&typeof p!="number"&&oi(a,u,p)&&(p=0,x=M),jv(a,u,p,x)):[]}function Fh(a,u,p){var x=a==null?0:a.length;if(!x)return-1;var M=p==null?0:He(p);return M<0&&(M=Ut(x+M,0)),Vs(a,Pe(u,3),M)}function zh(a,u,p){var x=a==null?0:a.length;if(!x)return-1;var M=x-1;return p!==t&&(M=He(p),M=p<0?Ut(x+M,0):ei(M,x-1)),Vs(a,Pe(u,3),M,!0)}function Bh(a){var u=a==null?0:a.length;return u?Zt(a,1):[]}function e0(a){var u=a==null?0:a.length;return u?Zt(a,H):[]}function t0(a,u){var p=a==null?0:a.length;return p?(u=u===t?1:He(u),Zt(a,u)):[]}function i0(a){for(var u=-1,p=a==null?0:a.length,x={};++u<p;){var M=a[u];x[M[0]]=M[1]}return x}function Uh(a){return a&&a.length?a[0]:t}function r0(a,u,p){var x=a==null?0:a.length;if(!x)return-1;var M=p==null?0:He(p);return M<0&&(M=Ut(x+M,0)),En(a,u,M)}function n0(a){var u=a==null?0:a.length;return u?Ni(a,0,-1):[]}var s0=We(function(a){var u=xt(a,ul);return u.length&&u[0]===a[0]?Qo(u):[]}),a0=We(function(a){var u=Di(a),p=xt(a,ul);return u===Di(p)?u=t:p.pop(),p.length&&p[0]===a[0]?Qo(p,Pe(u,2)):[]}),o0=We(function(a){var u=Di(a),p=xt(a,ul);return u=typeof u=="function"?u:t,u&&p.pop(),p.length&&p[0]===a[0]?Qo(p,t,u):[]});function l0(a,u){return a==null?"":nv.call(a,u)}function Di(a){var u=a==null?0:a.length;return u?a[u-1]:t}function u0(a,u,p){var x=a==null?0:a.length;if(!x)return-1;var M=x;return p!==t&&(M=He(p),M=M<0?Ut(x+M,0):ei(M,x-1)),u===u?$g(a,u,M):Vs(a,xc,M,!0)}function c0(a,u){return a&&a.length?Yc(a,He(u)):t}var h0=We(Hh);function Hh(a,u){return a&&a.length&&u&&u.length?rl(a,u):a}function d0(a,u,p){return a&&a.length&&u&&u.length?rl(a,u,Pe(p,2)):a}function f0(a,u,p){return a&&a.length&&u&&u.length?rl(a,u,t,p):a}var p0=fr(function(a,u){var p=a==null?0:a.length,x=Zo(a,u);return eh(a,xt(u,function(M){return pr(M,p)?+M:M}).sort(ch)),x});function m0(a,u){var p=[];if(!(a&&a.length))return p;var x=-1,M=[],I=a.length;for(u=Pe(u,3);++x<I;){var k=a[x];u(k,x,a)&&(p.push(k),M.push(x))}return eh(a,M),p}function Sl(a){return a==null?a:lv.call(a)}function g0(a,u,p){var x=a==null?0:a.length;return x?(p&&typeof p!="number"&&oi(a,u,p)?(u=0,p=x):(u=u==null?0:He(u),p=p===t?x:He(p)),Ni(a,u,p)):[]}function v0(a,u){return ua(a,u)}function y0(a,u,p){return al(a,u,Pe(p,2))}function _0(a,u){var p=a==null?0:a.length;if(p){var x=ua(a,u);if(x<p&&Vi(a[x],u))return x}return-1}function x0(a,u){return ua(a,u,!0)}function b0(a,u,p){return al(a,u,Pe(p,2),!0)}function w0(a,u){var p=a==null?0:a.length;if(p){var x=ua(a,u,!0)-1;if(Vi(a[x],u))return x}return-1}function S0(a){return a&&a.length?ih(a):[]}function M0(a,u){return a&&a.length?ih(a,Pe(u,2)):[]}function E0(a){var u=a==null?0:a.length;return u?Ni(a,1,u):[]}function T0(a,u,p){return a&&a.length?(u=p||u===t?1:He(u),Ni(a,0,u<0?0:u)):[]}function A0(a,u,p){var x=a==null?0:a.length;return x?(u=p||u===t?1:He(u),u=x-u,Ni(a,u<0?0:u,x)):[]}function C0(a,u){return a&&a.length?ca(a,Pe(u,3),!1,!0):[]}function P0(a,u){return a&&a.length?ca(a,Pe(u,3)):[]}var R0=We(function(a){return kr(Zt(a,1,Lt,!0))}),I0=We(function(a){var u=Di(a);return Lt(u)&&(u=t),kr(Zt(a,1,Lt,!0),Pe(u,2))}),L0=We(function(a){var u=Di(a);return u=typeof u=="function"?u:t,kr(Zt(a,1,Lt,!0),t,u)});function O0(a){return a&&a.length?kr(a):[]}function N0(a,u){return a&&a.length?kr(a,Pe(u,2)):[]}function D0(a,u){return u=typeof u=="function"?u:t,a&&a.length?kr(a,t,u):[]}function Ml(a){if(!(a&&a.length))return[];var u=0;return a=Ir(a,function(p){if(Lt(p))return u=Ut(p.length,u),!0}),Ho(u,function(p){return xt(a,zo(p))})}function $h(a,u){if(!(a&&a.length))return[];var p=Ml(a);return u==null?p:xt(p,function(x){return _i(u,t,x)})}var k0=We(function(a,u){return Lt(a)?ss(a,u):[]}),F0=We(function(a){return ll(Ir(a,Lt))}),z0=We(function(a){var u=Di(a);return Lt(u)&&(u=t),ll(Ir(a,Lt),Pe(u,2))}),B0=We(function(a){var u=Di(a);return u=typeof u=="function"?u:t,ll(Ir(a,Lt),t,u)}),U0=We(Ml);function H0(a,u){return ah(a||[],u||[],ns)}function $0(a,u){return ah(a||[],u||[],ls)}var V0=We(function(a){var u=a.length,p=u>1?a[u-1]:t;return p=typeof p=="function"?(a.pop(),p):t,$h(a,p)});function Vh(a){var u=C(a);return u.__chain__=!0,u}function W0(a,u){return u(a),a}function _a(a,u){return u(a)}var j0=fr(function(a){var u=a.length,p=u?a[0]:0,x=this.__wrapped__,M=function(I){return Zo(I,a)};return u>1||this.__actions__.length||!(x instanceof Ye)||!pr(p)?this.thru(M):(x=x.slice(p,+p+(u?1:0)),x.__actions__.push({func:_a,args:[M],thisArg:t}),new Li(x,this.__chain__).thru(function(I){return u&&!I.length&&I.push(t),I}))});function G0(){return Vh(this)}function q0(){return new Li(this.value(),this.__chain__)}function X0(){this.__values__===t&&(this.__values__=rd(this.value()));var a=this.__index__>=this.__values__.length,u=a?t:this.__values__[this.__index__++];return{done:a,value:u}}function Z0(){return this}function J0(a){for(var u,p=this;p instanceof na;){var x=kh(p);x.__index__=0,x.__values__=t,u?M.__wrapped__=x:u=x;var M=x;p=p.__wrapped__}return M.__wrapped__=a,u}function Y0(){var a=this.__wrapped__;if(a instanceof Ye){var u=a;return this.__actions__.length&&(u=new Ye(this)),u=u.reverse(),u.__actions__.push({func:_a,args:[Sl],thisArg:t}),new Li(u,this.__chain__)}return this.thru(Sl)}function K0(){return sh(this.__wrapped__,this.__actions__)}var Q0=ha(function(a,u,p){ot.call(a,p)?++a[p]:hr(a,p,1)});function e_(a,u,p){var x=Be(a)?yc:Wv;return p&&oi(a,u,p)&&(u=t),x(a,Pe(u,3))}function t_(a,u){var p=Be(a)?Ir:$c;return p(a,Pe(u,3))}var i_=gh(Fh),r_=gh(zh);function n_(a,u){return Zt(xa(a,u),1)}function s_(a,u){return Zt(xa(a,u),H)}function a_(a,u,p){return p=p===t?1:He(p),Zt(xa(a,u),p)}function Wh(a,u){var p=Be(a)?Ri:Dr;return p(a,Pe(u,3))}function jh(a,u){var p=Be(a)?Eg:Hc;return p(a,Pe(u,3))}var o_=ha(function(a,u,p){ot.call(a,p)?a[p].push(u):hr(a,p,[u])});function l_(a,u,p,x){a=di(a)?a:kn(a),p=p&&!x?He(p):0;var M=a.length;return p<0&&(p=Ut(M+p,0)),Ea(a)?p<=M&&a.indexOf(u,p)>-1:!!M&&En(a,u,p)>-1}var u_=We(function(a,u,p){var x=-1,M=typeof u=="function",I=di(a)?K(a.length):[];return Dr(a,function(k){I[++x]=M?_i(u,k,p):as(k,u,p)}),I}),c_=ha(function(a,u,p){hr(a,p,u)});function xa(a,u){var p=Be(a)?xt:Xc;return p(a,Pe(u,3))}function h_(a,u,p,x){return a==null?[]:(Be(u)||(u=u==null?[]:[u]),p=x?t:p,Be(p)||(p=p==null?[]:[p]),Kc(a,u,p))}var d_=ha(function(a,u,p){a[p?0:1].push(u)},function(){return[[],[]]});function f_(a,u,p){var x=Be(a)?ko:wc,M=arguments.length<3;return x(a,Pe(u,4),p,M,Dr)}function p_(a,u,p){var x=Be(a)?Tg:wc,M=arguments.length<3;return x(a,Pe(u,4),p,M,Hc)}function m_(a,u){var p=Be(a)?Ir:$c;return p(a,Sa(Pe(u,3)))}function g_(a){var u=Be(a)?Fc:ly;return u(a)}function v_(a,u,p){(p?oi(a,u,p):u===t)?u=1:u=He(u);var x=Be(a)?Bv:uy;return x(a,u)}function y_(a){var u=Be(a)?Uv:hy;return u(a)}function __(a){if(a==null)return 0;if(di(a))return Ea(a)?An(a):a.length;var u=ti(a);return u==Ne||u==Pt?a.size:tl(a).length}function x_(a,u,p){var x=Be(a)?Fo:dy;return p&&oi(a,u,p)&&(u=t),x(a,Pe(u,3))}var b_=We(function(a,u){if(a==null)return[];var p=u.length;return p>1&&oi(a,u[0],u[1])?u=[]:p>2&&oi(u[0],u[1],u[2])&&(u=[u[0]]),Kc(a,Zt(u,1),[])}),ba=tv||function(){return Gt.Date.now()};function w_(a,u){if(typeof u!="function")throw new Ii(c);return a=He(a),function(){if(--a<1)return u.apply(this,arguments)}}function Gh(a,u,p){return u=p?t:u,u=a&&u==null?a.length:u,dr(a,L,t,t,t,t,u)}function qh(a,u){var p;if(typeof u!="function")throw new Ii(c);return a=He(a),function(){return--a>0&&(p=u.apply(this,arguments)),a<=1&&(u=t),p}}var El=We(function(a,u,p){var x=E;if(p.length){var M=Or(p,Nn(El));x|=R}return dr(a,x,u,p,M)}),Xh=We(function(a,u,p){var x=E|T;if(p.length){var M=Or(p,Nn(Xh));x|=R}return dr(u,x,a,p,M)});function Zh(a,u,p){u=p?t:u;var x=dr(a,P,t,t,t,t,t,u);return x.placeholder=Zh.placeholder,x}function Jh(a,u,p){u=p?t:u;var x=dr(a,O,t,t,t,t,t,u);return x.placeholder=Jh.placeholder,x}function Yh(a,u,p){var x,M,I,k,B,W,ie=0,ne=!1,ue=!1,ge=!0;if(typeof a!="function")throw new Ii(c);u=ki(u)||0,St(p)&&(ne=!!p.leading,ue="maxWait"in p,I=ue?Ut(ki(p.maxWait)||0,u):I,ge="trailing"in p?!!p.trailing:ge);function Me(Ot){var Wi=x,vr=M;return x=M=t,ie=Ot,k=a.apply(vr,Wi),k}function Re(Ot){return ie=Ot,B=hs(Xe,u),ne?Me(Ot):k}function $e(Ot){var Wi=Ot-W,vr=Ot-ie,gd=u-Wi;return ue?ei(gd,I-vr):gd}function Ie(Ot){var Wi=Ot-W,vr=Ot-ie;return W===t||Wi>=u||Wi<0||ue&&vr>=I}function Xe(){var Ot=ba();if(Ie(Ot))return Ke(Ot);B=hs(Xe,$e(Ot))}function Ke(Ot){return B=t,ge&&x?Me(Ot):(x=M=t,k)}function Si(){B!==t&&oh(B),ie=0,x=W=M=B=t}function li(){return B===t?k:Ke(ba())}function Mi(){var Ot=ba(),Wi=Ie(Ot);if(x=arguments,M=this,W=Ot,Wi){if(B===t)return Re(W);if(ue)return oh(B),B=hs(Xe,u),Me(W)}return B===t&&(B=hs(Xe,u)),k}return Mi.cancel=Si,Mi.flush=li,Mi}var S_=We(function(a,u){return Uc(a,1,u)}),M_=We(function(a,u,p){return Uc(a,ki(u)||0,p)});function E_(a){return dr(a,U)}function wa(a,u){if(typeof a!="function"||u!=null&&typeof u!="function")throw new Ii(c);var p=function(){var x=arguments,M=u?u.apply(this,x):x[0],I=p.cache;if(I.has(M))return I.get(M);var k=a.apply(this,x);return p.cache=I.set(M,k)||I,k};return p.cache=new(wa.Cache||cr),p}wa.Cache=cr;function Sa(a){if(typeof a!="function")throw new Ii(c);return function(){var u=arguments;switch(u.length){case 0:return!a.call(this);case 1:return!a.call(this,u[0]);case 2:return!a.call(this,u[0],u[1]);case 3:return!a.call(this,u[0],u[1],u[2])}return!a.apply(this,u)}}function T_(a){return qh(2,a)}var A_=fy(function(a,u){u=u.length==1&&Be(u[0])?xt(u[0],xi(Pe())):xt(Zt(u,1),xi(Pe()));var p=u.length;return We(function(x){for(var M=-1,I=ei(x.length,p);++M<I;)x[M]=u[M].call(this,x[M]);return _i(a,this,x)})}),Tl=We(function(a,u){var p=Or(u,Nn(Tl));return dr(a,R,t,u,p)}),Kh=We(function(a,u){var p=Or(u,Nn(Kh));return dr(a,D,t,u,p)}),C_=fr(function(a,u){return dr(a,N,t,t,t,u)});function P_(a,u){if(typeof a!="function")throw new Ii(c);return u=u===t?u:He(u),We(a,u)}function R_(a,u){if(typeof a!="function")throw new Ii(c);return u=u==null?0:Ut(He(u),0),We(function(p){var x=p[u],M=zr(p,0,u);return x&&Lr(M,x),_i(a,this,M)})}function I_(a,u,p){var x=!0,M=!0;if(typeof a!="function")throw new Ii(c);return St(p)&&(x="leading"in p?!!p.leading:x,M="trailing"in p?!!p.trailing:M),Yh(a,u,{leading:x,maxWait:u,trailing:M})}function L_(a){return Gh(a,1)}function O_(a,u){return Tl(cl(u),a)}function N_(){if(!arguments.length)return[];var a=arguments[0];return Be(a)?a:[a]}function D_(a){return Oi(a,_)}function k_(a,u){return u=typeof u=="function"?u:t,Oi(a,_,u)}function F_(a){return Oi(a,g|_)}function z_(a,u){return u=typeof u=="function"?u:t,Oi(a,g|_,u)}function B_(a,u){return u==null||Bc(a,u,Wt(u))}function Vi(a,u){return a===u||a!==a&&u!==u}var U_=ma(Ko),H_=ma(function(a,u){return a>=u}),hn=jc(function(){return arguments}())?jc:function(a){return Tt(a)&&ot.call(a,"callee")&&!Ic.call(a,"callee")},Be=K.isArray,$_=dc?xi(dc):Jv;function di(a){return a!=null&&Ma(a.length)&&!mr(a)}function Lt(a){return Tt(a)&&di(a)}function V_(a){return a===!0||a===!1||Tt(a)&&ai(a)==me}var Br=rv||Fl,W_=fc?xi(fc):Yv;function j_(a){return Tt(a)&&a.nodeType===1&&!ds(a)}function G_(a){if(a==null)return!0;if(di(a)&&(Be(a)||typeof a=="string"||typeof a.splice=="function"||Br(a)||Dn(a)||hn(a)))return!a.length;var u=ti(a);if(u==Ne||u==Pt)return!a.size;if(cs(a))return!tl(a).length;for(var p in a)if(ot.call(a,p))return!1;return!0}function q_(a,u){return os(a,u)}function X_(a,u,p){p=typeof p=="function"?p:t;var x=p?p(a,u):t;return x===t?os(a,u,t,p):!!x}function Al(a){if(!Tt(a))return!1;var u=ai(a);return u==Ce||u==Le||typeof a.message=="string"&&typeof a.name=="string"&&!ds(a)}function Z_(a){return typeof a=="number"&&Oc(a)}function mr(a){if(!St(a))return!1;var u=ai(a);return u==Ae||u==Ue||u==fe||u==Kt}function Qh(a){return typeof a=="number"&&a==He(a)}function Ma(a){return typeof a=="number"&&a>-1&&a%1==0&&a<=X}function St(a){var u=typeof a;return a!=null&&(u=="object"||u=="function")}function Tt(a){return a!=null&&typeof a=="object"}var ed=pc?xi(pc):Qv;function J_(a,u){return a===u||el(a,u,vl(u))}function Y_(a,u,p){return p=typeof p=="function"?p:t,el(a,u,vl(u),p)}function K_(a){return td(a)&&a!=+a}function Q_(a){if(ky(a))throw new ze(l);return Gc(a)}function ex(a){return a===null}function tx(a){return a==null}function td(a){return typeof a=="number"||Tt(a)&&ai(a)==Ge}function ds(a){if(!Tt(a)||ai(a)!=it)return!1;var u=Ys(a);if(u===null)return!0;var p=ot.call(u,"constructor")&&u.constructor;return typeof p=="function"&&p instanceof p&&qs.call(p)==Yg}var Cl=mc?xi(mc):ey;function ix(a){return Qh(a)&&a>=-X&&a<=X}var id=gc?xi(gc):ty;function Ea(a){return typeof a=="string"||!Be(a)&&Tt(a)&&ai(a)==_e}function wi(a){return typeof a=="symbol"||Tt(a)&&ai(a)==ce}var Dn=vc?xi(vc):iy;function rx(a){return a===t}function nx(a){return Tt(a)&&ti(a)==et}function sx(a){return Tt(a)&&ai(a)==Dt}var ax=ma(il),ox=ma(function(a,u){return a<=u});function rd(a){if(!a)return[];if(di(a))return Ea(a)?Hi(a):hi(a);if(Qn&&a[Qn])return Bg(a[Qn]());var u=ti(a),p=u==Ne?Vo:u==Pt?Ws:kn;return p(a)}function gr(a){if(!a)return a===0?a:0;if(a=ki(a),a===H||a===-H){var u=a<0?-1:1;return u*re}return a===a?a:0}function He(a){var u=gr(a),p=u%1;return u===u?p?u-p:u:0}function nd(a){return a?on(He(a),0,he):0}function ki(a){if(typeof a=="number")return a;if(wi(a))return ae;if(St(a)){var u=typeof a.valueOf=="function"?a.valueOf():a;a=St(u)?u+"":u}if(typeof a!="string")return a===0?a:+a;a=Sc(a);var p=Ki.test(a);return p||Us.test(a)?wg(a.slice(2),p?2:8):Yi.test(a)?ae:+a}function sd(a){return er(a,fi(a))}function lx(a){return a?on(He(a),-X,X):a===0?a:0}function at(a){return a==null?"":bi(a)}var ux=Ln(function(a,u){if(cs(u)||di(u)){er(u,Wt(u),a);return}for(var p in u)ot.call(u,p)&&ns(a,p,u[p])}),ad=Ln(function(a,u){er(u,fi(u),a)}),Ta=Ln(function(a,u,p,x){er(u,fi(u),a,x)}),cx=Ln(function(a,u,p,x){er(u,Wt(u),a,x)}),hx=fr(Zo);function dx(a,u){var p=In(a);return u==null?p:zc(p,u)}var fx=We(function(a,u){a=dt(a);var p=-1,x=u.length,M=x>2?u[2]:t;for(M&&oi(u[0],u[1],M)&&(x=1);++p<x;)for(var I=u[p],k=fi(I),B=-1,W=k.length;++B<W;){var ie=k[B],ne=a[ie];(ne===t||Vi(ne,Cn[ie])&&!ot.call(a,ie))&&(a[ie]=I[ie])}return a}),px=We(function(a){return a.push(t,Sh),_i(od,t,a)});function mx(a,u){return _c(a,Pe(u,3),Qi)}function gx(a,u){return _c(a,Pe(u,3),Yo)}function vx(a,u){return a==null?a:Jo(a,Pe(u,3),fi)}function yx(a,u){return a==null?a:Vc(a,Pe(u,3),fi)}function _x(a,u){return a&&Qi(a,Pe(u,3))}function xx(a,u){return a&&Yo(a,Pe(u,3))}function bx(a){return a==null?[]:oa(a,Wt(a))}function wx(a){return a==null?[]:oa(a,fi(a))}function Pl(a,u,p){var x=a==null?t:ln(a,u);return x===t?p:x}function Sx(a,u){return a!=null&&Th(a,u,Gv)}function Rl(a,u){return a!=null&&Th(a,u,qv)}var Mx=yh(function(a,u,p){u!=null&&typeof u.toString!="function"&&(u=Xs.call(u)),a[u]=p},Ll(pi)),Ex=yh(function(a,u,p){u!=null&&typeof u.toString!="function"&&(u=Xs.call(u)),ot.call(a,u)?a[u].push(p):a[u]=[p]},Pe),Tx=We(as);function Wt(a){return di(a)?kc(a):tl(a)}function fi(a){return di(a)?kc(a,!0):ry(a)}function Ax(a,u){var p={};return u=Pe(u,3),Qi(a,function(x,M,I){hr(p,u(x,M,I),x)}),p}function Cx(a,u){var p={};return u=Pe(u,3),Qi(a,function(x,M,I){hr(p,M,u(x,M,I))}),p}var Px=Ln(function(a,u,p){la(a,u,p)}),od=Ln(function(a,u,p,x){la(a,u,p,x)}),Rx=fr(function(a,u){var p={};if(a==null)return p;var x=!1;u=xt(u,function(I){return I=Fr(I,a),x||(x=I.length>1),I}),er(a,ml(a),p),x&&(p=Oi(p,g|y|_,My));for(var M=u.length;M--;)ol(p,u[M]);return p});function Ix(a,u){return ld(a,Sa(Pe(u)))}var Lx=fr(function(a,u){return a==null?{}:sy(a,u)});function ld(a,u){if(a==null)return{};var p=xt(ml(a),function(x){return[x]});return u=Pe(u),Qc(a,p,function(x,M){return u(x,M[0])})}function Ox(a,u,p){u=Fr(u,a);var x=-1,M=u.length;for(M||(M=1,a=t);++x<M;){var I=a==null?t:a[tr(u[x])];I===t&&(x=M,I=p),a=mr(I)?I.call(a):I}return a}function Nx(a,u,p){return a==null?a:ls(a,u,p)}function Dx(a,u,p,x){return x=typeof x=="function"?x:t,a==null?a:ls(a,u,p,x)}var ud=bh(Wt),cd=bh(fi);function kx(a,u,p){var x=Be(a),M=x||Br(a)||Dn(a);if(u=Pe(u,4),p==null){var I=a&&a.constructor;M?p=x?new I:[]:St(a)?p=mr(I)?In(Ys(a)):{}:p={}}return(M?Ri:Qi)(a,function(k,B,W){return u(p,k,B,W)}),p}function Fx(a,u){return a==null?!0:ol(a,u)}function zx(a,u,p){return a==null?a:nh(a,u,cl(p))}function Bx(a,u,p,x){return x=typeof x=="function"?x:t,a==null?a:nh(a,u,cl(p),x)}function kn(a){return a==null?[]:$o(a,Wt(a))}function Ux(a){return a==null?[]:$o(a,fi(a))}function Hx(a,u,p){return p===t&&(p=u,u=t),p!==t&&(p=ki(p),p=p===p?p:0),u!==t&&(u=ki(u),u=u===u?u:0),on(ki(a),u,p)}function $x(a,u,p){return u=gr(u),p===t?(p=u,u=0):p=gr(p),a=ki(a),Xv(a,u,p)}function Vx(a,u,p){if(p&&typeof p!="boolean"&&oi(a,u,p)&&(u=p=t),p===t&&(typeof u=="boolean"?(p=u,u=t):typeof a=="boolean"&&(p=a,a=t)),a===t&&u===t?(a=0,u=1):(a=gr(a),u===t?(u=a,a=0):u=gr(u)),a>u){var x=a;a=u,u=x}if(p||a%1||u%1){var M=Nc();return ei(a+M*(u-a+bg("1e-"+((M+"").length-1))),u)}return nl(a,u)}var Wx=On(function(a,u,p){return u=u.toLowerCase(),a+(p?hd(u):u)});function hd(a){return Il(at(a).toLowerCase())}function dd(a){return a=at(a),a&&a.replace(Po,Ng).replace(hg,"")}function jx(a,u,p){a=at(a),u=bi(u);var x=a.length;p=p===t?x:on(He(p),0,x);var M=p;return p-=u.length,p>=0&&a.slice(p,M)==u}function Gx(a){return a=at(a),a&&Jn.test(a)?a.replace(Ji,Dg):a}function qx(a){return a=at(a),a&&_u.test(a)?a.replace(Ls,"\\$&"):a}var Xx=On(function(a,u,p){return a+(p?"-":"")+u.toLowerCase()}),Zx=On(function(a,u,p){return a+(p?" ":"")+u.toLowerCase()}),Jx=mh("toLowerCase");function Yx(a,u,p){a=at(a),u=He(u);var x=u?An(a):0;if(!u||x>=u)return a;var M=(u-x)/2;return pa(ta(M),p)+a+pa(ea(M),p)}function Kx(a,u,p){a=at(a),u=He(u);var x=u?An(a):0;return u&&x<u?a+pa(u-x,p):a}function Qx(a,u,p){a=at(a),u=He(u);var x=u?An(a):0;return u&&x<u?pa(u-x,p)+a:a}function eb(a,u,p){return p||u==null?u=0:u&&(u=+u),ov(at(a).replace(ye,""),u||0)}function tb(a,u,p){return(p?oi(a,u,p):u===t)?u=1:u=He(u),sl(at(a),u)}function ib(){var a=arguments,u=at(a[0]);return a.length<3?u:u.replace(a[1],a[2])}var rb=On(function(a,u,p){return a+(p?"_":"")+u.toLowerCase()});function nb(a,u,p){return p&&typeof p!="number"&&oi(a,u,p)&&(u=p=t),p=p===t?he:p>>>0,p?(a=at(a),a&&(typeof u=="string"||u!=null&&!Cl(u))&&(u=bi(u),!u&&Tn(a))?zr(Hi(a),0,p):a.split(u,p)):[]}var sb=On(function(a,u,p){return a+(p?" ":"")+Il(u)});function ab(a,u,p){return a=at(a),p=p==null?0:on(He(p),0,a.length),u=bi(u),a.slice(p,p+u.length)==u}function ob(a,u,p){var x=C.templateSettings;p&&oi(a,u,p)&&(u=t),a=at(a),u=Ta({},u,x,wh);var M=Ta({},u.imports,x.imports,wh),I=Wt(M),k=$o(M,I),B,W,ie=0,ne=u.interpolate||Q,ue="__p += '",ge=Wo((u.escape||Q).source+"|"+ne.source+"|"+(ne===lo?Xi:Q).source+"|"+(u.evaluate||Q).source+"|$","g"),Me="//# sourceURL="+(ot.call(u,"sourceURL")?(u.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++gg+"]")+`
`;a.replace(ge,function(Ie,Xe,Ke,Si,li,Mi){return Ke||(Ke=Si),ue+=a.slice(ie,Mi).replace(le,kg),Xe&&(B=!0,ue+=`' +
__e(`+Xe+`) +
'`),li&&(W=!0,ue+=`';
`+li+`;
__p += '`),Ke&&(ue+=`' +
((__t = (`+Ke+`)) == null ? '' : __t) +
'`),ie=Mi+Ie.length,Ie}),ue+=`';
`;var Re=ot.call(u,"variable")&&u.variable;if(!Re)ue=`with (obj) {
`+ue+`
}
`;else if(Ci.test(Re))throw new ze(h);ue=(W?ue.replace(gi,""):ue).replace(Rt,"$1").replace(ci,"$1;"),ue="function("+(Re||"obj")+`) {
`+(Re?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(B?", __e = _.escape":"")+(W?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ue+`return __p
}`;var $e=pd(function(){return rt(I,Me+"return "+ue).apply(t,k)});if($e.source=ue,Al($e))throw $e;return $e}function lb(a){return at(a).toLowerCase()}function ub(a){return at(a).toUpperCase()}function cb(a,u,p){if(a=at(a),a&&(p||u===t))return Sc(a);if(!a||!(u=bi(u)))return a;var x=Hi(a),M=Hi(u),I=Mc(x,M),k=Ec(x,M)+1;return zr(x,I,k).join("")}function hb(a,u,p){if(a=at(a),a&&(p||u===t))return a.slice(0,Ac(a)+1);if(!a||!(u=bi(u)))return a;var x=Hi(a),M=Ec(x,Hi(u))+1;return zr(x,0,M).join("")}function db(a,u,p){if(a=at(a),a&&(p||u===t))return a.replace(ye,"");if(!a||!(u=bi(u)))return a;var x=Hi(a),M=Mc(x,Hi(u));return zr(x,M).join("")}function fb(a,u){var p=F,x=z;if(St(u)){var M="separator"in u?u.separator:M;p="length"in u?He(u.length):p,x="omission"in u?bi(u.omission):x}a=at(a);var I=a.length;if(Tn(a)){var k=Hi(a);I=k.length}if(p>=I)return a;var B=p-An(x);if(B<1)return x;var W=k?zr(k,0,B).join(""):a.slice(0,B);if(M===t)return W+x;if(k&&(B+=W.length-B),Cl(M)){if(a.slice(B).search(M)){var ie,ne=W;for(M.global||(M=Wo(M.source,at(xr.exec(M))+"g")),M.lastIndex=0;ie=M.exec(ne);)var ue=ie.index;W=W.slice(0,ue===t?B:ue)}}else if(a.indexOf(bi(M),B)!=B){var ge=W.lastIndexOf(M);ge>-1&&(W=W.slice(0,ge))}return W+x}function pb(a){return a=at(a),a&&ws.test(a)?a.replace(ji,Vg):a}var mb=On(function(a,u,p){return a+(p?" ":"")+u.toUpperCase()}),Il=mh("toUpperCase");function fd(a,u,p){return a=at(a),u=p?t:u,u===t?zg(a)?Gg(a):Pg(a):a.match(u)||[]}var pd=We(function(a,u){try{return _i(a,t,u)}catch(p){return Al(p)?p:new ze(p)}}),gb=fr(function(a,u){return Ri(u,function(p){p=tr(p),hr(a,p,El(a[p],a))}),a});function vb(a){var u=a==null?0:a.length,p=Pe();return a=u?xt(a,function(x){if(typeof x[1]!="function")throw new Ii(c);return[p(x[0]),x[1]]}):[],We(function(x){for(var M=-1;++M<u;){var I=a[M];if(_i(I[0],this,x))return _i(I[1],this,x)}})}function yb(a){return Vv(Oi(a,g))}function Ll(a){return function(){return a}}function _b(a,u){return a==null||a!==a?u:a}var xb=vh(),bb=vh(!0);function pi(a){return a}function Ol(a){return qc(typeof a=="function"?a:Oi(a,g))}function wb(a){return Zc(Oi(a,g))}function Sb(a,u){return Jc(a,Oi(u,g))}var Mb=We(function(a,u){return function(p){return as(p,a,u)}}),Eb=We(function(a,u){return function(p){return as(a,p,u)}});function Nl(a,u,p){var x=Wt(u),M=oa(u,x);p==null&&!(St(u)&&(M.length||!x.length))&&(p=u,u=a,a=this,M=oa(u,Wt(u)));var I=!(St(p)&&"chain"in p)||!!p.chain,k=mr(a);return Ri(M,function(B){var W=u[B];a[B]=W,k&&(a.prototype[B]=function(){var ie=this.__chain__;if(I||ie){var ne=a(this.__wrapped__),ue=ne.__actions__=hi(this.__actions__);return ue.push({func:W,args:arguments,thisArg:a}),ne.__chain__=ie,ne}return W.apply(a,Lr([this.value()],arguments))})}),a}function Tb(){return Gt._===this&&(Gt._=Kg),this}function Dl(){}function Ab(a){return a=He(a),We(function(u){return Yc(u,a)})}var Cb=dl(xt),Pb=dl(yc),Rb=dl(Fo);function md(a){return _l(a)?zo(tr(a)):ay(a)}function Ib(a){return function(u){return a==null?t:ln(a,u)}}var Lb=_h(),Ob=_h(!0);function kl(){return[]}function Fl(){return!1}function Nb(){return{}}function Db(){return""}function kb(){return!0}function Fb(a,u){if(a=He(a),a<1||a>X)return[];var p=he,x=ei(a,he);u=Pe(u),a-=he;for(var M=Ho(x,u);++p<a;)u(p);return M}function zb(a){return Be(a)?xt(a,tr):wi(a)?[a]:hi(Dh(at(a)))}function Bb(a){var u=++Jg;return at(a)+u}var Ub=fa(function(a,u){return a+u},0),Hb=fl("ceil"),$b=fa(function(a,u){return a/u},1),Vb=fl("floor");function Wb(a){return a&&a.length?aa(a,pi,Ko):t}function jb(a,u){return a&&a.length?aa(a,Pe(u,2),Ko):t}function Gb(a){return bc(a,pi)}function qb(a,u){return bc(a,Pe(u,2))}function Xb(a){return a&&a.length?aa(a,pi,il):t}function Zb(a,u){return a&&a.length?aa(a,Pe(u,2),il):t}var Jb=fa(function(a,u){return a*u},1),Yb=fl("round"),Kb=fa(function(a,u){return a-u},0);function Qb(a){return a&&a.length?Uo(a,pi):0}function e1(a,u){return a&&a.length?Uo(a,Pe(u,2)):0}return C.after=w_,C.ary=Gh,C.assign=ux,C.assignIn=ad,C.assignInWith=Ta,C.assignWith=cx,C.at=hx,C.before=qh,C.bind=El,C.bindAll=gb,C.bindKey=Xh,C.castArray=N_,C.chain=Vh,C.chunk=Vy,C.compact=Wy,C.concat=jy,C.cond=vb,C.conforms=yb,C.constant=Ll,C.countBy=Q0,C.create=dx,C.curry=Zh,C.curryRight=Jh,C.debounce=Yh,C.defaults=fx,C.defaultsDeep=px,C.defer=S_,C.delay=M_,C.difference=Gy,C.differenceBy=qy,C.differenceWith=Xy,C.drop=Zy,C.dropRight=Jy,C.dropRightWhile=Yy,C.dropWhile=Ky,C.fill=Qy,C.filter=t_,C.flatMap=n_,C.flatMapDeep=s_,C.flatMapDepth=a_,C.flatten=Bh,C.flattenDeep=e0,C.flattenDepth=t0,C.flip=E_,C.flow=xb,C.flowRight=bb,C.fromPairs=i0,C.functions=bx,C.functionsIn=wx,C.groupBy=o_,C.initial=n0,C.intersection=s0,C.intersectionBy=a0,C.intersectionWith=o0,C.invert=Mx,C.invertBy=Ex,C.invokeMap=u_,C.iteratee=Ol,C.keyBy=c_,C.keys=Wt,C.keysIn=fi,C.map=xa,C.mapKeys=Ax,C.mapValues=Cx,C.matches=wb,C.matchesProperty=Sb,C.memoize=wa,C.merge=Px,C.mergeWith=od,C.method=Mb,C.methodOf=Eb,C.mixin=Nl,C.negate=Sa,C.nthArg=Ab,C.omit=Rx,C.omitBy=Ix,C.once=T_,C.orderBy=h_,C.over=Cb,C.overArgs=A_,C.overEvery=Pb,C.overSome=Rb,C.partial=Tl,C.partialRight=Kh,C.partition=d_,C.pick=Lx,C.pickBy=ld,C.property=md,C.propertyOf=Ib,C.pull=h0,C.pullAll=Hh,C.pullAllBy=d0,C.pullAllWith=f0,C.pullAt=p0,C.range=Lb,C.rangeRight=Ob,C.rearg=C_,C.reject=m_,C.remove=m0,C.rest=P_,C.reverse=Sl,C.sampleSize=v_,C.set=Nx,C.setWith=Dx,C.shuffle=y_,C.slice=g0,C.sortBy=b_,C.sortedUniq=S0,C.sortedUniqBy=M0,C.split=nb,C.spread=R_,C.tail=E0,C.take=T0,C.takeRight=A0,C.takeRightWhile=C0,C.takeWhile=P0,C.tap=W0,C.throttle=I_,C.thru=_a,C.toArray=rd,C.toPairs=ud,C.toPairsIn=cd,C.toPath=zb,C.toPlainObject=sd,C.transform=kx,C.unary=L_,C.union=R0,C.unionBy=I0,C.unionWith=L0,C.uniq=O0,C.uniqBy=N0,C.uniqWith=D0,C.unset=Fx,C.unzip=Ml,C.unzipWith=$h,C.update=zx,C.updateWith=Bx,C.values=kn,C.valuesIn=Ux,C.without=k0,C.words=fd,C.wrap=O_,C.xor=F0,C.xorBy=z0,C.xorWith=B0,C.zip=U0,C.zipObject=H0,C.zipObjectDeep=$0,C.zipWith=V0,C.entries=ud,C.entriesIn=cd,C.extend=ad,C.extendWith=Ta,Nl(C,C),C.add=Ub,C.attempt=pd,C.camelCase=Wx,C.capitalize=hd,C.ceil=Hb,C.clamp=Hx,C.clone=D_,C.cloneDeep=F_,C.cloneDeepWith=z_,C.cloneWith=k_,C.conformsTo=B_,C.deburr=dd,C.defaultTo=_b,C.divide=$b,C.endsWith=jx,C.eq=Vi,C.escape=Gx,C.escapeRegExp=qx,C.every=e_,C.find=i_,C.findIndex=Fh,C.findKey=mx,C.findLast=r_,C.findLastIndex=zh,C.findLastKey=gx,C.floor=Vb,C.forEach=Wh,C.forEachRight=jh,C.forIn=vx,C.forInRight=yx,C.forOwn=_x,C.forOwnRight=xx,C.get=Pl,C.gt=U_,C.gte=H_,C.has=Sx,C.hasIn=Rl,C.head=Uh,C.identity=pi,C.includes=l_,C.indexOf=r0,C.inRange=$x,C.invoke=Tx,C.isArguments=hn,C.isArray=Be,C.isArrayBuffer=$_,C.isArrayLike=di,C.isArrayLikeObject=Lt,C.isBoolean=V_,C.isBuffer=Br,C.isDate=W_,C.isElement=j_,C.isEmpty=G_,C.isEqual=q_,C.isEqualWith=X_,C.isError=Al,C.isFinite=Z_,C.isFunction=mr,C.isInteger=Qh,C.isLength=Ma,C.isMap=ed,C.isMatch=J_,C.isMatchWith=Y_,C.isNaN=K_,C.isNative=Q_,C.isNil=tx,C.isNull=ex,C.isNumber=td,C.isObject=St,C.isObjectLike=Tt,C.isPlainObject=ds,C.isRegExp=Cl,C.isSafeInteger=ix,C.isSet=id,C.isString=Ea,C.isSymbol=wi,C.isTypedArray=Dn,C.isUndefined=rx,C.isWeakMap=nx,C.isWeakSet=sx,C.join=l0,C.kebabCase=Xx,C.last=Di,C.lastIndexOf=u0,C.lowerCase=Zx,C.lowerFirst=Jx,C.lt=ax,C.lte=ox,C.max=Wb,C.maxBy=jb,C.mean=Gb,C.meanBy=qb,C.min=Xb,C.minBy=Zb,C.stubArray=kl,C.stubFalse=Fl,C.stubObject=Nb,C.stubString=Db,C.stubTrue=kb,C.multiply=Jb,C.nth=c0,C.noConflict=Tb,C.noop=Dl,C.now=ba,C.pad=Yx,C.padEnd=Kx,C.padStart=Qx,C.parseInt=eb,C.random=Vx,C.reduce=f_,C.reduceRight=p_,C.repeat=tb,C.replace=ib,C.result=Ox,C.round=Yb,C.runInContext=V,C.sample=g_,C.size=__,C.snakeCase=rb,C.some=x_,C.sortedIndex=v0,C.sortedIndexBy=y0,C.sortedIndexOf=_0,C.sortedLastIndex=x0,C.sortedLastIndexBy=b0,C.sortedLastIndexOf=w0,C.startCase=sb,C.startsWith=ab,C.subtract=Kb,C.sum=Qb,C.sumBy=e1,C.template=ob,C.times=Fb,C.toFinite=gr,C.toInteger=He,C.toLength=nd,C.toLower=lb,C.toNumber=ki,C.toSafeInteger=lx,C.toString=at,C.toUpper=ub,C.trim=cb,C.trimEnd=hb,C.trimStart=db,C.truncate=fb,C.unescape=pb,C.uniqueId=Bb,C.upperCase=mb,C.upperFirst=Il,C.each=Wh,C.eachRight=jh,C.first=Uh,Nl(C,function(){var a={};return Qi(C,function(u,p){ot.call(C.prototype,p)||(a[p]=u)}),a}(),{chain:!1}),C.VERSION=r,Ri(["bind","bindKey","curry","curryRight","partial","partialRight"],function(a){C[a].placeholder=C}),Ri(["drop","take"],function(a,u){Ye.prototype[a]=function(p){p=p===t?1:Ut(He(p),0);var x=this.__filtered__&&!u?new Ye(this):this.clone();return x.__filtered__?x.__takeCount__=ei(p,x.__takeCount__):x.__views__.push({size:ei(p,he),type:a+(x.__dir__<0?"Right":"")}),x},Ye.prototype[a+"Right"]=function(p){return this.reverse()[a](p).reverse()}}),Ri(["filter","map","takeWhile"],function(a,u){var p=u+1,x=p==Z||p==$;Ye.prototype[a]=function(M){var I=this.clone();return I.__iteratees__.push({iteratee:Pe(M,3),type:p}),I.__filtered__=I.__filtered__||x,I}}),Ri(["head","last"],function(a,u){var p="take"+(u?"Right":"");Ye.prototype[a]=function(){return this[p](1).value()[0]}}),Ri(["initial","tail"],function(a,u){var p="drop"+(u?"":"Right");Ye.prototype[a]=function(){return this.__filtered__?new Ye(this):this[p](1)}}),Ye.prototype.compact=function(){return this.filter(pi)},Ye.prototype.find=function(a){return this.filter(a).head()},Ye.prototype.findLast=function(a){return this.reverse().find(a)},Ye.prototype.invokeMap=We(function(a,u){return typeof a=="function"?new Ye(this):this.map(function(p){return as(p,a,u)})}),Ye.prototype.reject=function(a){return this.filter(Sa(Pe(a)))},Ye.prototype.slice=function(a,u){a=He(a);var p=this;return p.__filtered__&&(a>0||u<0)?new Ye(p):(a<0?p=p.takeRight(-a):a&&(p=p.drop(a)),u!==t&&(u=He(u),p=u<0?p.dropRight(-u):p.take(u-a)),p)},Ye.prototype.takeRightWhile=function(a){return this.reverse().takeWhile(a).reverse()},Ye.prototype.toArray=function(){return this.take(he)},Qi(Ye.prototype,function(a,u){var p=/^(?:filter|find|map|reject)|While$/.test(u),x=/^(?:head|last)$/.test(u),M=C[x?"take"+(u=="last"?"Right":""):u],I=x||/^find/.test(u);!M||(C.prototype[u]=function(){var k=this.__wrapped__,B=x?[1]:arguments,W=k instanceof Ye,ie=B[0],ne=W||Be(k),ue=function(Xe){var Ke=M.apply(C,Lr([Xe],B));return x&&ge?Ke[0]:Ke};ne&&p&&typeof ie=="function"&&ie.length!=1&&(W=ne=!1);var ge=this.__chain__,Me=!!this.__actions__.length,Re=I&&!ge,$e=W&&!Me;if(!I&&ne){k=$e?k:new Ye(this);var Ie=a.apply(k,B);return Ie.__actions__.push({func:_a,args:[ue],thisArg:t}),new Li(Ie,ge)}return Re&&$e?a.apply(this,B):(Ie=this.thru(ue),Re?x?Ie.value()[0]:Ie.value():Ie)})}),Ri(["pop","push","shift","sort","splice","unshift"],function(a){var u=js[a],p=/^(?:push|sort|unshift)$/.test(a)?"tap":"thru",x=/^(?:pop|shift)$/.test(a);C.prototype[a]=function(){var M=arguments;if(x&&!this.__chain__){var I=this.value();return u.apply(Be(I)?I:[],M)}return this[p](function(k){return u.apply(Be(k)?k:[],M)})}}),Qi(Ye.prototype,function(a,u){var p=C[u];if(p){var x=p.name+"";ot.call(Rn,x)||(Rn[x]=[]),Rn[x].push({name:u,func:p})}}),Rn[da(t,T).name]=[{name:"wrapper",func:t}],Ye.prototype.clone=pv,Ye.prototype.reverse=mv,Ye.prototype.value=gv,C.prototype.at=j0,C.prototype.chain=G0,C.prototype.commit=q0,C.prototype.next=X0,C.prototype.plant=J0,C.prototype.reverse=Y0,C.prototype.toJSON=C.prototype.valueOf=C.prototype.value=K0,C.prototype.first=C.prototype.head,Qn&&(C.prototype[Qn]=Z0),C},qr=qg();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(Gt._=qr,define(function(){return qr})):rn?((rn.exports=qr)._=qr,Oo._=qr):Gt._=qr}).call(i)}),pxe=Ba((i,e)=>{var t=1e3,r=t*60,n=r*60,l=n*24,c=l*7,h=l*365.25;e.exports=function(y,_){_=_||{};var b=typeof y;if(b==="string"&&y.length>0)return d(y);if(b==="number"&&isFinite(y))return _.long?m(y):f(y);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(y))};function d(y){if(y=String(y),!(y.length>100)){var _=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(y);if(_){var b=parseFloat(_[1]),S=(_[2]||"ms").toLowerCase();switch(S){case"years":case"year":case"yrs":case"yr":case"y":return b*h;case"weeks":case"week":case"w":return b*c;case"days":case"day":case"d":return b*l;case"hours":case"hour":case"hrs":case"hr":case"h":return b*n;case"minutes":case"minute":case"mins":case"min":case"m":return b*r;case"seconds":case"second":case"secs":case"sec":case"s":return b*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return b;default:return}}}}function f(y){var _=Math.abs(y);return _>=l?Math.round(y/l)+"d":_>=n?Math.round(y/n)+"h":_>=r?Math.round(y/r)+"m":_>=t?Math.round(y/t)+"s":y+"ms"}function m(y){var _=Math.abs(y);return _>=l?g(y,_,l,"day"):_>=n?g(y,_,n,"hour"):_>=r?g(y,_,r,"minute"):_>=t?g(y,_,t,"second"):y+" ms"}function g(y,_,b,S){var E=_>=b*1.5;return Math.round(y/b)+" "+S+(E?"s":"")}}),mxe=Ba((i,e)=>{function t(r){l.debug=l,l.default=l,l.coerce=g,l.disable=d,l.enable=h,l.enabled=f,l.humanize=pxe(),l.destroy=y,Object.keys(r).forEach(_=>{l[_]=r[_]}),l.names=[],l.skips=[],l.formatters={};function n(_){let b=0;for(let S=0;S<_.length;S++)b=(b<<5)-b+_.charCodeAt(S),b|=0;return l.colors[Math.abs(b)%l.colors.length]}l.selectColor=n;function l(_){let b,S=null,E,T;function A(...P){if(!A.enabled)return;let O=A,R=Number(new Date),D=R-(b||R);O.diff=D,O.prev=b,O.curr=R,b=R,P[0]=l.coerce(P[0]),typeof P[0]!="string"&&P.unshift("%O");let L=0;P[0]=P[0].replace(/%([a-zA-Z%])/g,(N,U)=>{if(N==="%%")return"%";L++;let F=l.formatters[U];if(typeof F=="function"){let z=P[L];N=F.call(O,z),P.splice(L,1),L--}return N}),l.formatArgs.call(O,P),(O.log||l.log).apply(O,P)}return A.namespace=_,A.useColors=l.useColors(),A.color=l.selectColor(_),A.extend=c,A.destroy=l.destroy,Object.defineProperty(A,"enabled",{enumerable:!0,configurable:!1,get:()=>S!==null?S:(E!==l.namespaces&&(E=l.namespaces,T=l.enabled(_)),T),set:P=>{S=P}}),typeof l.init=="function"&&l.init(A),A}function c(_,b){let S=l(this.namespace+(typeof b>"u"?":":b)+_);return S.log=this.log,S}function h(_){l.save(_),l.namespaces=_,l.names=[],l.skips=[];let b,S=(typeof _=="string"?_:"").split(/[\s,]+/),E=S.length;for(b=0;b<E;b++)!S[b]||(_=S[b].replace(/\*/g,".*?"),_[0]==="-"?l.skips.push(new RegExp("^"+_.slice(1)+"$")):l.names.push(new RegExp("^"+_+"$")))}function d(){let _=[...l.names.map(m),...l.skips.map(m).map(b=>"-"+b)].join(",");return l.enable(""),_}function f(_){if(_[_.length-1]==="*")return!0;let b,S;for(b=0,S=l.skips.length;b<S;b++)if(l.skips[b].test(_))return!1;for(b=0,S=l.names.length;b<S;b++)if(l.names[b].test(_))return!0;return!1}function m(_){return _.toString().substring(2,_.toString().length-2).replace(/\.\*\?$/,"*")}function g(_){return _ instanceof Error?_.stack||_.message:_}function y(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return l.enable(l.load()),l}e.exports=t}),gxe=Ba((i,e)=>{i.formatArgs=r,i.save=n,i.load=l,i.useColors=t,i.storage=c(),i.destroy=(()=>{let d=!1;return()=>{d||(d=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),i.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function t(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(d){if(d[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+d[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;let f="color: "+this.color;d.splice(1,0,f,"color: inherit");let m=0,g=0;d[0].replace(/%[a-zA-Z%]/g,y=>{y!=="%%"&&(m++,y==="%c"&&(g=m))}),d.splice(g,0,f)}i.log=console.debug||console.log||(()=>{});function n(d){try{d?i.storage.setItem("debug",d):i.storage.removeItem("debug")}catch{}}function l(){let d;try{d=i.storage.getItem("debug")}catch{}return!d&&typeof process<"u"&&"env"in process&&(d=sxe.DEBUG),d}function c(){try{return localStorage}catch{}}e.exports=mxe()(i);var{formatters:h}=e.exports;h.j=function(d){try{return JSON.stringify(d)}catch(f){return"[UnexpectedJSONParseError]: "+f.message}}}),XB=Ba((i,e)=>{function t(r){var n=typeof r;return r!=null&&(n=="object"||n=="function")}e.exports=t}),vxe=Ba((i,e)=>{var t=typeof global=="object"&&global&&global.Object===Object&&global;e.exports=t}),VJ=Ba((i,e)=>{var t=vxe(),r=typeof self=="object"&&self&&self.Object===Object&&self,n=t||r||Function("return this")();e.exports=n}),yxe=Ba((i,e)=>{var t=VJ(),r=function(){return t.Date.now()};e.exports=r}),_xe=Ba((i,e)=>{var t=/\s/;function r(n){for(var l=n.length;l--&&t.test(n.charAt(l)););return l}e.exports=r}),xxe=Ba((i,e)=>{var t=_xe(),r=/^\s+/;function n(l){return l&&l.slice(0,t(l)+1).replace(r,"")}e.exports=n}),WJ=Ba((i,e)=>{var t=VJ(),r=t.Symbol;e.exports=r}),bxe=Ba((i,e)=>{var t=WJ(),r=Object.prototype,n=r.hasOwnProperty,l=r.toString,c=t?t.toStringTag:void 0;function h(d){var f=n.call(d,c),m=d[c];try{d[c]=void 0;var g=!0}catch{}var y=l.call(d);return g&&(f?d[c]=m:delete d[c]),y}e.exports=h}),wxe=Ba((i,e)=>{var t=Object.prototype,r=t.toString;function n(l){return r.call(l)}e.exports=n}),Sxe=Ba((i,e)=>{var t=WJ(),r=bxe(),n=wxe(),l="[object Null]",c="[object Undefined]",h=t?t.toStringTag:void 0;function d(f){return f==null?f===void 0?c:l:h&&h in Object(f)?r(f):n(f)}e.exports=d}),Mxe=Ba((i,e)=>{function t(r){return r!=null&&typeof r=="object"}e.exports=t}),Exe=Ba((i,e)=>{var t=Sxe(),r=Mxe(),n="[object Symbol]";function l(c){return typeof c=="symbol"||r(c)&&t(c)==n}e.exports=l}),Txe=Ba((i,e)=>{var t=xxe(),r=XB(),n=Exe(),l=NaN,c=/^[-+]0x[0-9a-f]+$/i,h=/^0b[01]+$/i,d=/^0o[0-7]+$/i,f=parseInt;function m(g){if(typeof g=="number")return g;if(n(g))return l;if(r(g)){var y=typeof g.valueOf=="function"?g.valueOf():g;g=r(y)?y+"":y}if(typeof g!="string")return g===0?g:+g;g=t(g);var _=h.test(g);return _||d.test(g)?f(g.slice(2),_?2:8):c.test(g)?l:+g}e.exports=m}),Axe=Ba((i,e)=>{var t=XB(),r=yxe(),n=Txe(),l="Expected a function",c=Math.max,h=Math.min;function d(f,m,g){var y,_,b,S,E,T,A=0,P=!1,O=!1,R=!0;if(typeof f!="function")throw new TypeError(l);m=n(m)||0,t(g)&&(P=!!g.leading,O="maxWait"in g,b=O?c(n(g.maxWait)||0,m):b,R="trailing"in g?!!g.trailing:R);function D(q){var $=y,H=_;return y=_=void 0,A=q,S=f.apply(H,$),S}function L(q){return A=q,E=setTimeout(F,m),P?D(q):S}function N(q){var $=q-T,H=q-A,X=m-$;return O?h(X,b-H):X}function U(q){var $=q-T,H=q-A;return T===void 0||$>=m||$<0||O&&H>=b}function F(){var q=r();if(U(q))return z(q);E=setTimeout(F,N(q))}function z(q){return E=void 0,R&&y?D(q):(y=_=void 0,S)}function G(){E!==void 0&&clearTimeout(E),A=0,y=T=_=E=void 0}function J(){return E===void 0?S:z(r())}function Z(){var q=r(),$=U(q);if(y=arguments,_=this,T=q,$){if(E===void 0)return L(T);if(O)return clearTimeout(E),E=setTimeout(F,m),D(T)}return E===void 0&&(E=setTimeout(F,m)),S}return Z.cancel=G,Z.flush=J,Z}e.exports=d}),Cxe=Ba((i,e)=>{var t=Axe(),r=XB(),n="Expected a function";function l(c,h,d){var f=!0,m=!0;if(typeof c!="function")throw new TypeError(n);return r(d)&&(f="leading"in d?!!d.leading:f,m="trailing"in d?!!d.trailing:m),t(c,h,{leading:f,maxWait:h,trailing:m})}e.exports=l}),Pxe=qB(fxe()),jJ="146",GJ=300,Rxe=301,iW=1e3,tM=1001,rW=1002,aI=1003,Ixe=1006,Lxe=1008,Oxe=1009,Nxe=1023,Dxe=3e3,lp="srgb",F1="srgb-linear",qJ=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;let r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;let r=this._listeners[e];if(r!==void 0){let n=r.indexOf(t);n!==-1&&r.splice(n,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let t=this._listeners[e.type];if(t!==void 0){e.target=this;let r=t.slice(0);for(let n=0,l=r.length;n<l;n++)r[n].call(this,e);e.target=null}}},mo=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];function ZB(){let i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(mo[i&255]+mo[i>>8&255]+mo[i>>16&255]+mo[i>>24&255]+"-"+mo[e&255]+mo[e>>8&255]+"-"+mo[e>>16&15|64]+mo[e>>24&255]+"-"+mo[t&63|128]+mo[t>>8&255]+"-"+mo[t>>16&255]+mo[t>>24&255]+mo[r&255]+mo[r>>8&255]+mo[r>>16&255]+mo[r>>24&255]).toLowerCase()}function Iu(i,e,t){return Math.max(e,Math.min(t,i))}function kxe(i,e){return(i%e+e)%e}function qN(i,e,t){return(1-t)*i+t*e}var sc=class{constructor(e=0,t=0){sc.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,r=this.y,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6],this.y=n[1]*t+n[4]*r+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let r=Math.cos(t),n=Math.sin(t),l=this.x-e.x,c=this.y-e.y;return this.x=l*r-c*n+e.x,this.y=l*n+c*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},mp=class{constructor(){mp.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,r,n,l,c,h,d,f){let m=this.elements;return m[0]=e,m[1]=n,m[2]=h,m[3]=t,m[4]=l,m[5]=d,m[6]=r,m[7]=c,m[8]=f,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,n=t.elements,l=this.elements,c=r[0],h=r[3],d=r[6],f=r[1],m=r[4],g=r[7],y=r[2],_=r[5],b=r[8],S=n[0],E=n[3],T=n[6],A=n[1],P=n[4],O=n[7],R=n[2],D=n[5],L=n[8];return l[0]=c*S+h*A+d*R,l[3]=c*E+h*P+d*D,l[6]=c*T+h*O+d*L,l[1]=f*S+m*A+g*R,l[4]=f*E+m*P+g*D,l[7]=f*T+m*O+g*L,l[2]=y*S+_*A+b*R,l[5]=y*E+_*P+b*D,l[8]=y*T+_*O+b*L,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[1],n=e[2],l=e[3],c=e[4],h=e[5],d=e[6],f=e[7],m=e[8];return t*c*m-t*h*f-r*l*m+r*h*d+n*l*f-n*c*d}invert(){let e=this.elements,t=e[0],r=e[1],n=e[2],l=e[3],c=e[4],h=e[5],d=e[6],f=e[7],m=e[8],g=m*c-h*f,y=h*d-m*l,_=f*l-c*d,b=t*g+r*y+n*_;if(b===0)return this.set(0,0,0,0,0,0,0,0,0);let S=1/b;return e[0]=g*S,e[1]=(n*f-m*r)*S,e[2]=(h*r-n*c)*S,e[3]=y*S,e[4]=(m*t-n*d)*S,e[5]=(n*l-h*t)*S,e[6]=_*S,e[7]=(r*d-f*t)*S,e[8]=(c*t-r*l)*S,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,n,l,c,h){let d=Math.cos(l),f=Math.sin(l);return this.set(r*d,r*f,-r*(d*c+f*h)+c+e,-n*f,n*d,-n*(-f*c+d*h)+h+t,0,0,1),this}scale(e,t){let r=this.elements;return r[0]*=e,r[3]*=e,r[6]*=e,r[1]*=t,r[4]*=t,r[7]*=t,this}rotate(e){let t=Math.cos(e),r=Math.sin(e),n=this.elements,l=n[0],c=n[3],h=n[6],d=n[1],f=n[4],m=n[7];return n[0]=t*l+r*d,n[3]=t*c+r*f,n[6]=t*h+r*m,n[1]=-r*l+t*d,n[4]=-r*c+t*f,n[7]=-r*h+t*m,this}translate(e,t){let r=this.elements;return r[0]+=e*r[2],r[3]+=e*r[5],r[6]+=e*r[8],r[1]+=t*r[2],r[4]+=t*r[5],r[7]+=t*r[8],this}equals(e){let t=this.elements,r=e.elements;for(let n=0;n<9;n++)if(t[n]!==r[n])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){let r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}};function nW(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function Y1(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function tR(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}var XN={[lp]:{[F1]:Y1},[F1]:{[lp]:tR}},Cd={legacyMode:!0,get workingColorSpace(){return F1},set workingColorSpace(i){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(i,e,t){if(this.legacyMode||e===t||!e||!t)return i;if(XN[e]&&XN[e][t]!==void 0){let r=XN[e][t];return i.r=r(i.r),i.g=r(i.g),i.b=r(i.b),i}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(i,e){return this.convert(i,this.workingColorSpace,e)},toWorkingColorSpace:function(i,e){return this.convert(i,e,this.workingColorSpace)}},XJ={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Pa={r:0,g:0,b:0},Pd={h:0,s:0,l:0},F3={h:0,s:0,l:0};function ZN(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}function z3(i,e){return e.r=i.r,e.g=i.g,e.b=i.b,e}var jl=class{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,t===void 0&&r===void 0?this.set(e):this.setRGB(e,t,r)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=lp){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Cd.toWorkingColorSpace(this,t),this}setRGB(e,t,r,n=F1){return this.r=e,this.g=t,this.b=r,Cd.toWorkingColorSpace(this,n),this}setHSL(e,t,r,n=F1){if(e=kxe(e,1),t=Iu(t,0,1),r=Iu(r,0,1),t===0)this.r=this.g=this.b=r;else{let l=r<=.5?r*(1+t):r+t-r*t,c=2*r-l;this.r=ZN(c,l,e+1/3),this.g=ZN(c,l,e),this.b=ZN(c,l,e-1/3)}return Cd.toWorkingColorSpace(this,n),this}setStyle(e,t=lp){function r(l){l!==void 0&&parseFloat(l)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let l,c=n[1],h=n[2];switch(c){case"rgb":case"rgba":if(l=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return this.r=Math.min(255,parseInt(l[1],10))/255,this.g=Math.min(255,parseInt(l[2],10))/255,this.b=Math.min(255,parseInt(l[3],10))/255,Cd.toWorkingColorSpace(this,t),r(l[4]),this;if(l=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return this.r=Math.min(100,parseInt(l[1],10))/100,this.g=Math.min(100,parseInt(l[2],10))/100,this.b=Math.min(100,parseInt(l[3],10))/100,Cd.toWorkingColorSpace(this,t),r(l[4]),this;break;case"hsl":case"hsla":if(l=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h)){let d=parseFloat(l[1])/360,f=parseFloat(l[2])/100,m=parseFloat(l[3])/100;return r(l[4]),this.setHSL(d,f,m,t)}break}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){let l=n[1],c=l.length;if(c===3)return this.r=parseInt(l.charAt(0)+l.charAt(0),16)/255,this.g=parseInt(l.charAt(1)+l.charAt(1),16)/255,this.b=parseInt(l.charAt(2)+l.charAt(2),16)/255,Cd.toWorkingColorSpace(this,t),this;if(c===6)return this.r=parseInt(l.charAt(0)+l.charAt(1),16)/255,this.g=parseInt(l.charAt(2)+l.charAt(3),16)/255,this.b=parseInt(l.charAt(4)+l.charAt(5),16)/255,Cd.toWorkingColorSpace(this,t),this}return e&&e.length>0?this.setColorName(e,t):this}setColorName(e,t=lp){let r=XJ[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Y1(e.r),this.g=Y1(e.g),this.b=Y1(e.b),this}copyLinearToSRGB(e){return this.r=tR(e.r),this.g=tR(e.g),this.b=tR(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=lp){return Cd.fromWorkingColorSpace(z3(this,Pa),e),Iu(Pa.r*255,0,255)<<16^Iu(Pa.g*255,0,255)<<8^Iu(Pa.b*255,0,255)<<0}getHexString(e=lp){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=F1){Cd.fromWorkingColorSpace(z3(this,Pa),t);let r=Pa.r,n=Pa.g,l=Pa.b,c=Math.max(r,n,l),h=Math.min(r,n,l),d,f,m=(h+c)/2;if(h===c)d=0,f=0;else{let g=c-h;switch(f=m<=.5?g/(c+h):g/(2-c-h),c){case r:d=(n-l)/g+(n<l?6:0);break;case n:d=(l-r)/g+2;break;case l:d=(r-n)/g+4;break}d/=6}return e.h=d,e.s=f,e.l=m,e}getRGB(e,t=F1){return Cd.fromWorkingColorSpace(z3(this,Pa),t),e.r=Pa.r,e.g=Pa.g,e.b=Pa.b,e}getStyle(e=lp){return Cd.fromWorkingColorSpace(z3(this,Pa),e),e!==lp?`color(${e} ${Pa.r} ${Pa.g} ${Pa.b})`:`rgb(${Pa.r*255|0},${Pa.g*255|0},${Pa.b*255|0})`}offsetHSL(e,t,r){return this.getHSL(Pd),Pd.h+=e,Pd.s+=t,Pd.l+=r,this.setHSL(Pd.h,Pd.s,Pd.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(Pd),e.getHSL(F3);let r=qN(Pd.h,F3.h,t),n=qN(Pd.s,F3.s,t),l=qN(Pd.l,F3.l,t);return this.setHSL(r,n,l),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};jl.NAMES=XJ;var rS,Fxe=class{static getDataURL(i){if(/^data:/i.test(i.src)||typeof HTMLCanvasElement>"u")return i.src;let e;if(i instanceof HTMLCanvasElement)e=i;else{rS===void 0&&(rS=nW("canvas")),rS.width=i.width,rS.height=i.height;let t=rS.getContext("2d");i instanceof ImageData?t.putImageData(i,0,0):t.drawImage(i,0,0,i.width,i.height),e=rS}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",i),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(i){if(typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap){let e=nW("canvas");e.width=i.width,e.height=i.height;let t=e.getContext("2d");t.drawImage(i,0,0,i.width,i.height);let r=t.getImageData(0,0,i.width,i.height),n=r.data;for(let l=0;l<n.length;l++)n[l]=Y1(n[l]/255)*255;return t.putImageData(r,0,0),e}else if(i.data){let e=i.data.slice(0);for(let t=0;t<e.length;t++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[t]=Math.floor(Y1(e[t]/255)*255):e[t]=Y1(e[t]);return{data:e,width:i.width,height:i.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),i}},zxe=class{constructor(e=null){this.isSource=!0,this.uuid=ZB(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let r={uuid:this.uuid,url:""},n=this.data;if(n!==null){let l;if(Array.isArray(n)){l=[];for(let c=0,h=n.length;c<h;c++)n[c].isDataTexture?l.push(JN(n[c].image)):l.push(JN(n[c]))}else l=JN(n);r.url=l}return t||(e.images[this.uuid]=r),r}};function JN(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?Fxe.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var Bxe=0,eg=class extends qJ{constructor(i=eg.DEFAULT_IMAGE,e=eg.DEFAULT_MAPPING,t=tM,r=tM,n=Ixe,l=Lxe,c=Nxe,h=Oxe,d=1,f=Dxe){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Bxe++}),this.uuid=ZB(),this.name="",this.source=new zxe(i),this.mipmaps=[],this.mapping=e,this.wrapS=t,this.wrapT=r,this.magFilter=n,this.minFilter=l,this.anisotropy=d,this.format=c,this.internalFormat=null,this.type=h,this.offset=new sc(0,0),this.repeat=new sc(1,1),this.center=new sc(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new mp,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=f,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(i){this.source.data=i}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(i){return this.name=i.name,this.source=i.source,this.mipmaps=i.mipmaps.slice(0),this.mapping=i.mapping,this.wrapS=i.wrapS,this.wrapT=i.wrapT,this.magFilter=i.magFilter,this.minFilter=i.minFilter,this.anisotropy=i.anisotropy,this.format=i.format,this.internalFormat=i.internalFormat,this.type=i.type,this.offset.copy(i.offset),this.repeat.copy(i.repeat),this.center.copy(i.center),this.rotation=i.rotation,this.matrixAutoUpdate=i.matrixAutoUpdate,this.matrix.copy(i.matrix),this.generateMipmaps=i.generateMipmaps,this.premultiplyAlpha=i.premultiplyAlpha,this.flipY=i.flipY,this.unpackAlignment=i.unpackAlignment,this.encoding=i.encoding,this.userData=JSON.parse(JSON.stringify(i.userData)),this.needsUpdate=!0,this}toJSON(i){let e=i===void 0||typeof i=="string";if(!e&&i.textures[this.uuid]!==void 0)return i.textures[this.uuid];let t={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(i).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return JSON.stringify(this.userData)!=="{}"&&(t.userData=this.userData),e||(i.textures[this.uuid]=t),t}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(i){if(this.mapping!==GJ)return i;if(i.applyMatrix3(this.matrix),i.x<0||i.x>1)switch(this.wrapS){case iW:i.x=i.x-Math.floor(i.x);break;case tM:i.x=i.x<0?0:1;break;case rW:Math.abs(Math.floor(i.x)%2)===1?i.x=Math.ceil(i.x)-i.x:i.x=i.x-Math.floor(i.x);break}if(i.y<0||i.y>1)switch(this.wrapT){case iW:i.y=i.y-Math.floor(i.y);break;case tM:i.y=i.y<0?0:1;break;case rW:Math.abs(Math.floor(i.y)%2)===1?i.y=Math.ceil(i.y)-i.y:i.y=i.y-Math.floor(i.y);break}return this.flipY&&(i.y=1-i.y),i}set needsUpdate(i){i===!0&&(this.version++,this.source.needsUpdate=!0)}};eg.DEFAULT_IMAGE=null;eg.DEFAULT_MAPPING=GJ;var Uxe=class extends eg{constructor(e=null,t=1,r=1,n=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:n},this.magFilter=aI,this.minFilter=aI,this.wrapR=tM,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},Hxe=class extends eg{constructor(i=null,e=1,t=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:i,width:e,height:t,depth:r},this.magFilter=aI,this.minFilter=aI,this.wrapR=tM,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},TE=class{constructor(i=0,e=0,t=0,r=1){this.isQuaternion=!0,this._x=i,this._y=e,this._z=t,this._w=r}static slerpFlat(i,e,t,r,n,l,c){let h=t[r+0],d=t[r+1],f=t[r+2],m=t[r+3],g=n[l+0],y=n[l+1],_=n[l+2],b=n[l+3];if(c===0){i[e+0]=h,i[e+1]=d,i[e+2]=f,i[e+3]=m;return}if(c===1){i[e+0]=g,i[e+1]=y,i[e+2]=_,i[e+3]=b;return}if(m!==b||h!==g||d!==y||f!==_){let S=1-c,E=h*g+d*y+f*_+m*b,T=E>=0?1:-1,A=1-E*E;if(A>Number.EPSILON){let O=Math.sqrt(A),R=Math.atan2(O,E*T);S=Math.sin(S*R)/O,c=Math.sin(c*R)/O}let P=c*T;if(h=h*S+g*P,d=d*S+y*P,f=f*S+_*P,m=m*S+b*P,S===1-c){let O=1/Math.sqrt(h*h+d*d+f*f+m*m);h*=O,d*=O,f*=O,m*=O}}i[e]=h,i[e+1]=d,i[e+2]=f,i[e+3]=m}static multiplyQuaternionsFlat(i,e,t,r,n,l){let c=t[r],h=t[r+1],d=t[r+2],f=t[r+3],m=n[l],g=n[l+1],y=n[l+2],_=n[l+3];return i[e]=c*_+f*m+h*y-d*g,i[e+1]=h*_+f*g+d*m-c*y,i[e+2]=d*_+f*y+c*g-h*m,i[e+3]=f*_-c*m-h*g-d*y,i}get x(){return this._x}set x(i){this._x=i,this._onChangeCallback()}get y(){return this._y}set y(i){this._y=i,this._onChangeCallback()}get z(){return this._z}set z(i){this._z=i,this._onChangeCallback()}get w(){return this._w}set w(i){this._w=i,this._onChangeCallback()}set(i,e,t,r){return this._x=i,this._y=e,this._z=t,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(i){return this._x=i.x,this._y=i.y,this._z=i.z,this._w=i.w,this._onChangeCallback(),this}setFromEuler(i,e){let t=i._x,r=i._y,n=i._z,l=i._order,c=Math.cos,h=Math.sin,d=c(t/2),f=c(r/2),m=c(n/2),g=h(t/2),y=h(r/2),_=h(n/2);switch(l){case"XYZ":this._x=g*f*m+d*y*_,this._y=d*y*m-g*f*_,this._z=d*f*_+g*y*m,this._w=d*f*m-g*y*_;break;case"YXZ":this._x=g*f*m+d*y*_,this._y=d*y*m-g*f*_,this._z=d*f*_-g*y*m,this._w=d*f*m+g*y*_;break;case"ZXY":this._x=g*f*m-d*y*_,this._y=d*y*m+g*f*_,this._z=d*f*_+g*y*m,this._w=d*f*m-g*y*_;break;case"ZYX":this._x=g*f*m-d*y*_,this._y=d*y*m+g*f*_,this._z=d*f*_-g*y*m,this._w=d*f*m+g*y*_;break;case"YZX":this._x=g*f*m+d*y*_,this._y=d*y*m+g*f*_,this._z=d*f*_-g*y*m,this._w=d*f*m-g*y*_;break;case"XZY":this._x=g*f*m-d*y*_,this._y=d*y*m-g*f*_,this._z=d*f*_+g*y*m,this._w=d*f*m+g*y*_;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+l)}return e!==!1&&this._onChangeCallback(),this}setFromAxisAngle(i,e){let t=e/2,r=Math.sin(t);return this._x=i.x*r,this._y=i.y*r,this._z=i.z*r,this._w=Math.cos(t),this._onChangeCallback(),this}setFromRotationMatrix(i){let e=i.elements,t=e[0],r=e[4],n=e[8],l=e[1],c=e[5],h=e[9],d=e[2],f=e[6],m=e[10],g=t+c+m;if(g>0){let y=.5/Math.sqrt(g+1);this._w=.25/y,this._x=(f-h)*y,this._y=(n-d)*y,this._z=(l-r)*y}else if(t>c&&t>m){let y=2*Math.sqrt(1+t-c-m);this._w=(f-h)/y,this._x=.25*y,this._y=(r+l)/y,this._z=(n+d)/y}else if(c>m){let y=2*Math.sqrt(1+c-t-m);this._w=(n-d)/y,this._x=(r+l)/y,this._y=.25*y,this._z=(h+f)/y}else{let y=2*Math.sqrt(1+m-t-c);this._w=(l-r)/y,this._x=(n+d)/y,this._y=(h+f)/y,this._z=.25*y}return this._onChangeCallback(),this}setFromUnitVectors(i,e){let t=i.dot(e)+1;return t<Number.EPSILON?(t=0,Math.abs(i.x)>Math.abs(i.z)?(this._x=-i.y,this._y=i.x,this._z=0,this._w=t):(this._x=0,this._y=-i.z,this._z=i.y,this._w=t)):(this._x=i.y*e.z-i.z*e.y,this._y=i.z*e.x-i.x*e.z,this._z=i.x*e.y-i.y*e.x,this._w=t),this.normalize()}angleTo(i){return 2*Math.acos(Math.abs(Iu(this.dot(i),-1,1)))}rotateTowards(i,e){let t=this.angleTo(i);if(t===0)return this;let r=Math.min(1,e/t);return this.slerp(i,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(i){return this._x*i._x+this._y*i._y+this._z*i._z+this._w*i._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let i=this.length();return i===0?(this._x=0,this._y=0,this._z=0,this._w=1):(i=1/i,this._x=this._x*i,this._y=this._y*i,this._z=this._z*i,this._w=this._w*i),this._onChangeCallback(),this}multiply(i){return this.multiplyQuaternions(this,i)}premultiply(i){return this.multiplyQuaternions(i,this)}multiplyQuaternions(i,e){let t=i._x,r=i._y,n=i._z,l=i._w,c=e._x,h=e._y,d=e._z,f=e._w;return this._x=t*f+l*c+r*d-n*h,this._y=r*f+l*h+n*c-t*d,this._z=n*f+l*d+t*h-r*c,this._w=l*f-t*c-r*h-n*d,this._onChangeCallback(),this}slerp(i,e){if(e===0)return this;if(e===1)return this.copy(i);let t=this._x,r=this._y,n=this._z,l=this._w,c=l*i._w+t*i._x+r*i._y+n*i._z;if(c<0?(this._w=-i._w,this._x=-i._x,this._y=-i._y,this._z=-i._z,c=-c):this.copy(i),c>=1)return this._w=l,this._x=t,this._y=r,this._z=n,this;let h=1-c*c;if(h<=Number.EPSILON){let y=1-e;return this._w=y*l+e*this._w,this._x=y*t+e*this._x,this._y=y*r+e*this._y,this._z=y*n+e*this._z,this.normalize(),this._onChangeCallback(),this}let d=Math.sqrt(h),f=Math.atan2(d,c),m=Math.sin((1-e)*f)/d,g=Math.sin(e*f)/d;return this._w=l*m+this._w*g,this._x=t*m+this._x*g,this._y=r*m+this._y*g,this._z=n*m+this._z*g,this._onChangeCallback(),this}slerpQuaternions(i,e,t){return this.copy(i).slerp(e,t)}random(){let i=Math.random(),e=Math.sqrt(1-i),t=Math.sqrt(i),r=2*Math.PI*Math.random(),n=2*Math.PI*Math.random();return this.set(e*Math.cos(r),t*Math.sin(n),t*Math.cos(n),e*Math.sin(r))}equals(i){return i._x===this._x&&i._y===this._y&&i._z===this._z&&i._w===this._w}fromArray(i,e=0){return this._x=i[e],this._y=i[e+1],this._z=i[e+2],this._w=i[e+3],this._onChangeCallback(),this}toArray(i=[],e=0){return i[e]=this._x,i[e+1]=this._y,i[e+2]=this._z,i[e+3]=this._w,i}fromBufferAttribute(i,e){return this._x=i.getX(e),this._y=i.getY(e),this._z=i.getZ(e),this._w=i.getW(e),this}_onChange(i){return this._onChangeCallback=i,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},Mt=class{constructor(e=0,t=0,r=0){Mt.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(sW.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(sW.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,r=this.y,n=this.z,l=e.elements;return this.x=l[0]*t+l[3]*r+l[6]*n,this.y=l[1]*t+l[4]*r+l[7]*n,this.z=l[2]*t+l[5]*r+l[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,r=this.y,n=this.z,l=e.elements,c=1/(l[3]*t+l[7]*r+l[11]*n+l[15]);return this.x=(l[0]*t+l[4]*r+l[8]*n+l[12])*c,this.y=(l[1]*t+l[5]*r+l[9]*n+l[13])*c,this.z=(l[2]*t+l[6]*r+l[10]*n+l[14])*c,this}applyQuaternion(e){let t=this.x,r=this.y,n=this.z,l=e.x,c=e.y,h=e.z,d=e.w,f=d*t+c*n-h*r,m=d*r+h*t-l*n,g=d*n+l*r-c*t,y=-l*t-c*r-h*n;return this.x=f*d+y*-l+m*-h-g*-c,this.y=m*d+y*-c+g*-l-f*-h,this.z=g*d+y*-h+f*-c-m*-l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,r=this.y,n=this.z,l=e.elements;return this.x=l[0]*t+l[4]*r+l[8]*n,this.y=l[1]*t+l[5]*r+l[9]*n,this.z=l[2]*t+l[6]*r+l[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let r=e.x,n=e.y,l=e.z,c=t.x,h=t.y,d=t.z;return this.x=n*d-l*h,this.y=l*c-r*d,this.z=r*h-n*c,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return YN.copy(this).projectOnVector(e),this.sub(YN)}reflect(e){return this.sub(YN.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let r=this.dot(e)/t;return Math.acos(Iu(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){let n=Math.sin(t)*e;return this.x=n*Math.sin(r),this.y=Math.cos(t)*e,this.z=n*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=n,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,r=Math.sqrt(1-hxe(e,2));return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},YN=new Mt,sW=new TE,yL=class{constructor(e=new Mt(1/0,1/0,1/0),t=new Mt(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,r=1/0,n=1/0,l=-1/0,c=-1/0,h=-1/0;for(let d=0,f=e.length;d<f;d+=3){let m=e[d],g=e[d+1],y=e[d+2];m<t&&(t=m),g<r&&(r=g),y<n&&(n=y),m>l&&(l=m),g>c&&(c=g),y>h&&(h=y)}return this.min.set(t,r,n),this.max.set(l,c,h),this}setFromBufferAttribute(e){let t=1/0,r=1/0,n=1/0,l=-1/0,c=-1/0,h=-1/0;for(let d=0,f=e.count;d<f;d++){let m=e.getX(d),g=e.getY(d),y=e.getZ(d);m<t&&(t=m),g<r&&(r=g),y<n&&(n=y),m>l&&(l=m),g>c&&(c=g),y>h&&(h=y)}return this.min.set(t,r,n),this.max.set(l,c,h),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=h1.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let r=e.geometry;if(r!==void 0)if(t&&r.attributes!=null&&r.attributes.position!==void 0){let l=r.attributes.position;for(let c=0,h=l.count;c<h;c++)h1.fromBufferAttribute(l,c).applyMatrix4(e.matrixWorld),this.expandByPoint(h1)}else r.boundingBox===null&&r.computeBoundingBox(),KN.copy(r.boundingBox),KN.applyMatrix4(e.matrixWorld),this.union(KN);let n=e.children;for(let l=0,c=n.length;l<c;l++)this.expandByObject(n[l],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,h1),h1.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(uT),B3.subVectors(this.max,uT),nS.subVectors(e.a,uT),sS.subVectors(e.b,uT),aS.subVectors(e.c,uT),sm.subVectors(sS,nS),am.subVectors(aS,sS),d1.subVectors(nS,aS);let t=[0,-sm.z,sm.y,0,-am.z,am.y,0,-d1.z,d1.y,sm.z,0,-sm.x,am.z,0,-am.x,d1.z,0,-d1.x,-sm.y,sm.x,0,-am.y,am.x,0,-d1.y,d1.x,0];return!QN(t,nS,sS,aS,B3)||(t=[1,0,0,0,1,0,0,0,1],!QN(t,nS,sS,aS,B3))?!1:(U3.crossVectors(sm,am),t=[U3.x,U3.y,U3.z],QN(t,nS,sS,aS,B3))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return h1.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(h1).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Xf[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Xf[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Xf[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Xf[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Xf[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Xf[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Xf[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Xf[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Xf),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},Xf=[new Mt,new Mt,new Mt,new Mt,new Mt,new Mt,new Mt,new Mt],h1=new Mt,KN=new yL,nS=new Mt,sS=new Mt,aS=new Mt,sm=new Mt,am=new Mt,d1=new Mt,uT=new Mt,B3=new Mt,U3=new Mt,f1=new Mt;function QN(i,e,t,r,n){for(let l=0,c=i.length-3;l<=c;l+=3){f1.fromArray(i,l);let h=n.x*Math.abs(f1.x)+n.y*Math.abs(f1.y)+n.z*Math.abs(f1.z),d=e.dot(f1),f=t.dot(f1),m=r.dot(f1);if(Math.max(-Math.max(d,f,m),Math.min(d,f,m))>h)return!1}return!0}var $xe=new yL,cT=new Mt,eD=new Mt,ZJ=class{constructor(e=new Mt,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let r=this.center;t!==void 0?r.copy(t):$xe.setFromPoints(e).getCenter(r);let n=0;for(let l=0,c=e.length;l<c;l++)n=Math.max(n,r.distanceToSquared(e[l]));return this.radius=Math.sqrt(n),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;cT.subVectors(e,this.center);let t=cT.lengthSq();if(t>this.radius*this.radius){let r=Math.sqrt(t),n=(r-this.radius)*.5;this.center.addScaledVector(cT,n/r),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(eD.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(cT.copy(e.center).add(eD)),this.expandByPoint(cT.copy(e.center).sub(eD))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}},Zf=new Mt,tD=new Mt,H3=new Mt,om=new Mt,iD=new Mt,$3=new Mt,rD=new Mt,Vxe=class{constructor(i=new Mt,e=new Mt(0,0,-1)){this.origin=i,this.direction=e}set(i,e){return this.origin.copy(i),this.direction.copy(e),this}copy(i){return this.origin.copy(i.origin),this.direction.copy(i.direction),this}at(i,e){return e.copy(this.direction).multiplyScalar(i).add(this.origin)}lookAt(i){return this.direction.copy(i).sub(this.origin).normalize(),this}recast(i){return this.origin.copy(this.at(i,Zf)),this}closestPointToPoint(i,e){e.subVectors(i,this.origin);let t=e.dot(this.direction);return t<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(t).add(this.origin)}distanceToPoint(i){return Math.sqrt(this.distanceSqToPoint(i))}distanceSqToPoint(i){let e=Zf.subVectors(i,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(i):(Zf.copy(this.direction).multiplyScalar(e).add(this.origin),Zf.distanceToSquared(i))}distanceSqToSegment(i,e,t,r){tD.copy(i).add(e).multiplyScalar(.5),H3.copy(e).sub(i).normalize(),om.copy(this.origin).sub(tD);let n=i.distanceTo(e)*.5,l=-this.direction.dot(H3),c=om.dot(this.direction),h=-om.dot(H3),d=om.lengthSq(),f=Math.abs(1-l*l),m,g,y,_;if(f>0)if(m=l*h-c,g=l*c-h,_=n*f,m>=0)if(g>=-_)if(g<=_){let b=1/f;m*=b,g*=b,y=m*(m+l*g+2*c)+g*(l*m+g+2*h)+d}else g=n,m=Math.max(0,-(l*g+c)),y=-m*m+g*(g+2*h)+d;else g=-n,m=Math.max(0,-(l*g+c)),y=-m*m+g*(g+2*h)+d;else g<=-_?(m=Math.max(0,-(-l*n+c)),g=m>0?-n:Math.min(Math.max(-n,-h),n),y=-m*m+g*(g+2*h)+d):g<=_?(m=0,g=Math.min(Math.max(-n,-h),n),y=g*(g+2*h)+d):(m=Math.max(0,-(l*n+c)),g=m>0?n:Math.min(Math.max(-n,-h),n),y=-m*m+g*(g+2*h)+d);else g=l>0?-n:n,m=Math.max(0,-(l*g+c)),y=-m*m+g*(g+2*h)+d;return t&&t.copy(this.direction).multiplyScalar(m).add(this.origin),r&&r.copy(H3).multiplyScalar(g).add(tD),y}intersectSphere(i,e){Zf.subVectors(i.center,this.origin);let t=Zf.dot(this.direction),r=Zf.dot(Zf)-t*t,n=i.radius*i.radius;if(r>n)return null;let l=Math.sqrt(n-r),c=t-l,h=t+l;return c<0&&h<0?null:c<0?this.at(h,e):this.at(c,e)}intersectsSphere(i){return this.distanceSqToPoint(i.center)<=i.radius*i.radius}distanceToPlane(i){let e=i.normal.dot(this.direction);if(e===0)return i.distanceToPoint(this.origin)===0?0:null;let t=-(this.origin.dot(i.normal)+i.constant)/e;return t>=0?t:null}intersectPlane(i,e){let t=this.distanceToPlane(i);return t===null?null:this.at(t,e)}intersectsPlane(i){let e=i.distanceToPoint(this.origin);return e===0||i.normal.dot(this.direction)*e<0}intersectBox(i,e){let t,r,n,l,c,h,d=1/this.direction.x,f=1/this.direction.y,m=1/this.direction.z,g=this.origin;return d>=0?(t=(i.min.x-g.x)*d,r=(i.max.x-g.x)*d):(t=(i.max.x-g.x)*d,r=(i.min.x-g.x)*d),f>=0?(n=(i.min.y-g.y)*f,l=(i.max.y-g.y)*f):(n=(i.max.y-g.y)*f,l=(i.min.y-g.y)*f),t>l||n>r||((n>t||isNaN(t))&&(t=n),(l<r||isNaN(r))&&(r=l),m>=0?(c=(i.min.z-g.z)*m,h=(i.max.z-g.z)*m):(c=(i.max.z-g.z)*m,h=(i.min.z-g.z)*m),t>h||c>r)||((c>t||t!==t)&&(t=c),(h<r||r!==r)&&(r=h),r<0)?null:this.at(t>=0?t:r,e)}intersectsBox(i){return this.intersectBox(i,Zf)!==null}intersectTriangle(i,e,t,r,n){iD.subVectors(e,i),$3.subVectors(t,i),rD.crossVectors(iD,$3);let l=this.direction.dot(rD),c;if(l>0){if(r)return null;c=1}else if(l<0)c=-1,l=-l;else return null;om.subVectors(this.origin,i);let h=c*this.direction.dot($3.crossVectors(om,$3));if(h<0)return null;let d=c*this.direction.dot(iD.cross(om));if(d<0||h+d>l)return null;let f=-c*om.dot(rD);return f<0?null:this.at(f/l,n)}applyMatrix4(i){return this.origin.applyMatrix4(i),this.direction.transformDirection(i),this}equals(i){return i.origin.equals(this.origin)&&i.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},Fu=class{constructor(){Fu.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,r,n,l,c,h,d,f,m,g,y,_,b,S,E){let T=this.elements;return T[0]=e,T[4]=t,T[8]=r,T[12]=n,T[1]=l,T[5]=c,T[9]=h,T[13]=d,T[2]=f,T[6]=m,T[10]=g,T[14]=y,T[3]=_,T[7]=b,T[11]=S,T[15]=E,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Fu().fromArray(this.elements)}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){let t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,r=e.elements,n=1/oS.setFromMatrixColumn(e,0).length(),l=1/oS.setFromMatrixColumn(e,1).length(),c=1/oS.setFromMatrixColumn(e,2).length();return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=0,t[4]=r[4]*l,t[5]=r[5]*l,t[6]=r[6]*l,t[7]=0,t[8]=r[8]*c,t[9]=r[9]*c,t[10]=r[10]*c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,r=e.x,n=e.y,l=e.z,c=Math.cos(r),h=Math.sin(r),d=Math.cos(n),f=Math.sin(n),m=Math.cos(l),g=Math.sin(l);if(e.order==="XYZ"){let y=c*m,_=c*g,b=h*m,S=h*g;t[0]=d*m,t[4]=-d*g,t[8]=f,t[1]=_+b*f,t[5]=y-S*f,t[9]=-h*d,t[2]=S-y*f,t[6]=b+_*f,t[10]=c*d}else if(e.order==="YXZ"){let y=d*m,_=d*g,b=f*m,S=f*g;t[0]=y+S*h,t[4]=b*h-_,t[8]=c*f,t[1]=c*g,t[5]=c*m,t[9]=-h,t[2]=_*h-b,t[6]=S+y*h,t[10]=c*d}else if(e.order==="ZXY"){let y=d*m,_=d*g,b=f*m,S=f*g;t[0]=y-S*h,t[4]=-c*g,t[8]=b+_*h,t[1]=_+b*h,t[5]=c*m,t[9]=S-y*h,t[2]=-c*f,t[6]=h,t[10]=c*d}else if(e.order==="ZYX"){let y=c*m,_=c*g,b=h*m,S=h*g;t[0]=d*m,t[4]=b*f-_,t[8]=y*f+S,t[1]=d*g,t[5]=S*f+y,t[9]=_*f-b,t[2]=-f,t[6]=h*d,t[10]=c*d}else if(e.order==="YZX"){let y=c*d,_=c*f,b=h*d,S=h*f;t[0]=d*m,t[4]=S-y*g,t[8]=b*g+_,t[1]=g,t[5]=c*m,t[9]=-h*m,t[2]=-f*m,t[6]=_*g+b,t[10]=y-S*g}else if(e.order==="XZY"){let y=c*d,_=c*f,b=h*d,S=h*f;t[0]=d*m,t[4]=-g,t[8]=f*m,t[1]=y*g+S,t[5]=c*m,t[9]=_*g-b,t[2]=b*g-_,t[6]=h*m,t[10]=S*g+y}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Wxe,e,jxe)}lookAt(e,t,r){let n=this.elements;return Eu.subVectors(e,t),Eu.lengthSq()===0&&(Eu.z=1),Eu.normalize(),lm.crossVectors(r,Eu),lm.lengthSq()===0&&(Math.abs(r.z)===1?Eu.x+=1e-4:Eu.z+=1e-4,Eu.normalize(),lm.crossVectors(r,Eu)),lm.normalize(),V3.crossVectors(Eu,lm),n[0]=lm.x,n[4]=V3.x,n[8]=Eu.x,n[1]=lm.y,n[5]=V3.y,n[9]=Eu.y,n[2]=lm.z,n[6]=V3.z,n[10]=Eu.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,n=t.elements,l=this.elements,c=r[0],h=r[4],d=r[8],f=r[12],m=r[1],g=r[5],y=r[9],_=r[13],b=r[2],S=r[6],E=r[10],T=r[14],A=r[3],P=r[7],O=r[11],R=r[15],D=n[0],L=n[4],N=n[8],U=n[12],F=n[1],z=n[5],G=n[9],J=n[13],Z=n[2],q=n[6],$=n[10],H=n[14],X=n[3],re=n[7],ae=n[11],he=n[15];return l[0]=c*D+h*F+d*Z+f*X,l[4]=c*L+h*z+d*q+f*re,l[8]=c*N+h*G+d*$+f*ae,l[12]=c*U+h*J+d*H+f*he,l[1]=m*D+g*F+y*Z+_*X,l[5]=m*L+g*z+y*q+_*re,l[9]=m*N+g*G+y*$+_*ae,l[13]=m*U+g*J+y*H+_*he,l[2]=b*D+S*F+E*Z+T*X,l[6]=b*L+S*z+E*q+T*re,l[10]=b*N+S*G+E*$+T*ae,l[14]=b*U+S*J+E*H+T*he,l[3]=A*D+P*F+O*Z+R*X,l[7]=A*L+P*z+O*q+R*re,l[11]=A*N+P*G+O*$+R*ae,l[15]=A*U+P*J+O*H+R*he,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[4],n=e[8],l=e[12],c=e[1],h=e[5],d=e[9],f=e[13],m=e[2],g=e[6],y=e[10],_=e[14],b=e[3],S=e[7],E=e[11],T=e[15];return b*(+l*d*g-n*f*g-l*h*y+r*f*y+n*h*_-r*d*_)+S*(+t*d*_-t*f*y+l*c*y-n*c*_+n*f*m-l*d*m)+E*(+t*f*g-t*h*_-l*c*g+r*c*_+l*h*m-r*f*m)+T*(-n*h*m-t*d*g+t*h*y+n*c*g-r*c*y+r*d*m)}transpose(){let e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){let n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=r),this}invert(){let e=this.elements,t=e[0],r=e[1],n=e[2],l=e[3],c=e[4],h=e[5],d=e[6],f=e[7],m=e[8],g=e[9],y=e[10],_=e[11],b=e[12],S=e[13],E=e[14],T=e[15],A=g*E*f-S*y*f+S*d*_-h*E*_-g*d*T+h*y*T,P=b*y*f-m*E*f-b*d*_+c*E*_+m*d*T-c*y*T,O=m*S*f-b*g*f+b*h*_-c*S*_-m*h*T+c*g*T,R=b*g*d-m*S*d-b*h*y+c*S*y+m*h*E-c*g*E,D=t*A+r*P+n*O+l*R;if(D===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let L=1/D;return e[0]=A*L,e[1]=(S*y*l-g*E*l-S*n*_+r*E*_+g*n*T-r*y*T)*L,e[2]=(h*E*l-S*d*l+S*n*f-r*E*f-h*n*T+r*d*T)*L,e[3]=(g*d*l-h*y*l-g*n*f+r*y*f+h*n*_-r*d*_)*L,e[4]=P*L,e[5]=(m*E*l-b*y*l+b*n*_-t*E*_-m*n*T+t*y*T)*L,e[6]=(b*d*l-c*E*l-b*n*f+t*E*f+c*n*T-t*d*T)*L,e[7]=(c*y*l-m*d*l+m*n*f-t*y*f-c*n*_+t*d*_)*L,e[8]=O*L,e[9]=(b*g*l-m*S*l-b*r*_+t*S*_+m*r*T-t*g*T)*L,e[10]=(c*S*l-b*h*l+b*r*f-t*S*f-c*r*T+t*h*T)*L,e[11]=(m*h*l-c*g*l-m*r*f+t*g*f+c*r*_-t*h*_)*L,e[12]=R*L,e[13]=(m*S*n-b*g*n+b*r*y-t*S*y-m*r*E+t*g*E)*L,e[14]=(b*h*n-c*S*n-b*r*d+t*S*d+c*r*E-t*h*E)*L,e[15]=(c*g*n-m*h*n+m*r*d-t*g*d-c*r*y+t*h*y)*L,this}scale(e){let t=this.elements,r=e.x,n=e.y,l=e.z;return t[0]*=r,t[4]*=n,t[8]*=l,t[1]*=r,t[5]*=n,t[9]*=l,t[2]*=r,t[6]*=n,t[10]*=l,t[3]*=r,t[7]*=n,t[11]*=l,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,n))}makeTranslation(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let r=Math.cos(t),n=Math.sin(t),l=1-r,c=e.x,h=e.y,d=e.z,f=l*c,m=l*h;return this.set(f*c+r,f*h-n*d,f*d+n*h,0,f*h+n*d,m*h+r,m*d-n*c,0,f*d-n*h,m*d+n*c,l*d*d+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,n,l,c){return this.set(1,r,l,0,e,1,c,0,t,n,1,0,0,0,0,1),this}compose(e,t,r){let n=this.elements,l=t._x,c=t._y,h=t._z,d=t._w,f=l+l,m=c+c,g=h+h,y=l*f,_=l*m,b=l*g,S=c*m,E=c*g,T=h*g,A=d*f,P=d*m,O=d*g,R=r.x,D=r.y,L=r.z;return n[0]=(1-(S+T))*R,n[1]=(_+O)*R,n[2]=(b-P)*R,n[3]=0,n[4]=(_-O)*D,n[5]=(1-(y+T))*D,n[6]=(E+A)*D,n[7]=0,n[8]=(b+P)*L,n[9]=(E-A)*L,n[10]=(1-(y+S))*L,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,t,r){let n=this.elements,l=oS.set(n[0],n[1],n[2]).length(),c=oS.set(n[4],n[5],n[6]).length(),h=oS.set(n[8],n[9],n[10]).length();this.determinant()<0&&(l=-l),e.x=n[12],e.y=n[13],e.z=n[14],Rd.copy(this);let d=1/l,f=1/c,m=1/h;return Rd.elements[0]*=d,Rd.elements[1]*=d,Rd.elements[2]*=d,Rd.elements[4]*=f,Rd.elements[5]*=f,Rd.elements[6]*=f,Rd.elements[8]*=m,Rd.elements[9]*=m,Rd.elements[10]*=m,t.setFromRotationMatrix(Rd),r.x=l,r.y=c,r.z=h,this}makePerspective(e,t,r,n,l,c){let h=this.elements,d=2*l/(t-e),f=2*l/(r-n),m=(t+e)/(t-e),g=(r+n)/(r-n),y=-(c+l)/(c-l),_=-2*c*l/(c-l);return h[0]=d,h[4]=0,h[8]=m,h[12]=0,h[1]=0,h[5]=f,h[9]=g,h[13]=0,h[2]=0,h[6]=0,h[10]=y,h[14]=_,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this}makeOrthographic(e,t,r,n,l,c){let h=this.elements,d=1/(t-e),f=1/(r-n),m=1/(c-l),g=(t+e)*d,y=(r+n)*f,_=(c+l)*m;return h[0]=2*d,h[4]=0,h[8]=0,h[12]=-g,h[1]=0,h[5]=2*f,h[9]=0,h[13]=-y,h[2]=0,h[6]=0,h[10]=-2*m,h[14]=-_,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this}equals(e){let t=this.elements,r=e.elements;for(let n=0;n<16;n++)if(t[n]!==r[n])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){let r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}},oS=new Mt,Rd=new Fu,Wxe=new Mt(0,0,0),jxe=new Mt(1,1,1),lm=new Mt,V3=new Mt,Eu=new Mt,aW=new Fu,oW=new TE,_L=class{constructor(e=0,t=0,r=0,n=_L.DefaultOrder){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=n}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,n=this._order){return this._x=e,this._y=t,this._z=r,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){let n=e.elements,l=n[0],c=n[4],h=n[8],d=n[1],f=n[5],m=n[9],g=n[2],y=n[6],_=n[10];switch(t){case"XYZ":this._y=Math.asin(Iu(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-m,_),this._z=Math.atan2(-c,l)):(this._x=Math.atan2(y,f),this._z=0);break;case"YXZ":this._x=Math.asin(-Iu(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(h,_),this._z=Math.atan2(d,f)):(this._y=Math.atan2(-g,l),this._z=0);break;case"ZXY":this._x=Math.asin(Iu(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(-g,_),this._z=Math.atan2(-c,f)):(this._y=0,this._z=Math.atan2(d,l));break;case"ZYX":this._y=Math.asin(-Iu(g,-1,1)),Math.abs(g)<.9999999?(this._x=Math.atan2(y,_),this._z=Math.atan2(d,l)):(this._x=0,this._z=Math.atan2(-c,f));break;case"YZX":this._z=Math.asin(Iu(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(-m,f),this._y=Math.atan2(-g,l)):(this._x=0,this._y=Math.atan2(h,_));break;case"XZY":this._z=Math.asin(-Iu(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(y,f),this._y=Math.atan2(h,l)):(this._x=Math.atan2(-m,_),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return aW.makeRotationFromQuaternion(e),this.setFromRotationMatrix(aW,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return oW.setFromEuler(this),this.setFromQuaternion(oW,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}};_L.DefaultOrder="XYZ";_L.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];var Gxe=class{constructor(){this.mask=1}set(i){this.mask=(1<<i|0)>>>0}enable(i){this.mask|=1<<i|0}enableAll(){this.mask=-1}toggle(i){this.mask^=1<<i|0}disable(i){this.mask&=~(1<<i|0)}disableAll(){this.mask=0}test(i){return(this.mask&i.mask)!==0}isEnabled(i){return(this.mask&(1<<i|0))!==0}},qxe=0,lW=new Mt,lS=new TE,Jf=new Fu,W3=new Mt,hT=new Mt,Xxe=new Mt,Zxe=new TE,uW=new Mt(1,0,0),cW=new Mt(0,1,0),hW=new Mt(0,0,1),Jxe={type:"added"},dW={type:"removed"},Vm=class extends qJ{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:qxe++}),this.uuid=ZB(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Vm.DefaultUp.clone();let e=new Mt,t=new _L,r=new TE,n=new Mt(1,1,1);function l(){r.setFromEuler(t,!1)}function c(){t.setFromQuaternion(r,void 0,!1)}t._onChange(l),r._onChange(c),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new Fu},normalMatrix:{value:new mp}}),this.matrix=new Fu,this.matrixWorld=new Fu,this.matrixAutoUpdate=Vm.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Vm.DefaultMatrixWorldAutoUpdate,this.layers=new Gxe,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return lS.setFromAxisAngle(e,t),this.quaternion.multiply(lS),this}rotateOnWorldAxis(e,t){return lS.setFromAxisAngle(e,t),this.quaternion.premultiply(lS),this}rotateX(e){return this.rotateOnAxis(uW,e)}rotateY(e){return this.rotateOnAxis(cW,e)}rotateZ(e){return this.rotateOnAxis(hW,e)}translateOnAxis(e,t){return lW.copy(e).applyQuaternion(this.quaternion),this.position.add(lW.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(uW,e)}translateY(e){return this.translateOnAxis(cW,e)}translateZ(e){return this.translateOnAxis(hW,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(Jf.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?W3.copy(e):W3.set(e,t,r);let n=this.parent;this.updateWorldMatrix(!0,!1),hT.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Jf.lookAt(hT,W3,this.up):Jf.lookAt(W3,hT,this.up),this.quaternion.setFromRotationMatrix(Jf),n&&(Jf.extractRotation(n.matrixWorld),lS.setFromRotationMatrix(Jf),this.quaternion.premultiply(lS.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Jxe)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}let t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(dW)),this}removeFromParent(){let e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){let t=this.children[e];t.parent=null,t.dispatchEvent(dW)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),Jf.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Jf.multiply(e.parent.matrixWorld)),e.applyMatrix4(Jf),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,n=this.children.length;r<n;r++){let l=this.children[r].getObjectByProperty(e,t);if(l!==void 0)return l}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(hT,e,Xxe),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(hT,Zxe,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);let t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);let t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverseVisible(e)}traverseAncestors(e){let t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);let t=this.children;for(let r=0,n=t.length;r<n;r++){let l=t[r];(l.matrixWorldAutoUpdate===!0||e===!0)&&l.updateMatrixWorld(e)}}updateWorldMatrix(e,t){let r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){let n=this.children;for(let l=0,c=n.length;l<c;l++){let h=n[l];h.matrixWorldAutoUpdate===!0&&h.updateWorldMatrix(!1,!0)}}}toJSON(e){let t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});let n={};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.castShadow===!0&&(n.castShadow=!0),this.receiveShadow===!0&&(n.receiveShadow=!0),this.visible===!1&&(n.visible=!1),this.frustumCulled===!1&&(n.frustumCulled=!1),this.renderOrder!==0&&(n.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(n.instanceColor=this.instanceColor.toJSON()));function l(h,d){return h[d.uuid]===void 0&&(h[d.uuid]=d.toJSON(e)),d.uuid}if(this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(n.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=l(e.geometries,this.geometry);let h=this.geometry.parameters;if(h!==void 0&&h.shapes!==void 0){let d=h.shapes;if(Array.isArray(d))for(let f=0,m=d.length;f<m;f++){let g=d[f];l(e.shapes,g)}else l(e.shapes,d)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(l(e.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let h=[];for(let d=0,f=this.material.length;d<f;d++)h.push(l(e.materials,this.material[d]));n.material=h}else n.material=l(e.materials,this.material);if(this.children.length>0){n.children=[];for(let h=0;h<this.children.length;h++)n.children.push(this.children[h].toJSON(e).object)}if(this.animations.length>0){n.animations=[];for(let h=0;h<this.animations.length;h++){let d=this.animations[h];n.animations.push(l(e.animations,d))}}if(t){let h=c(e.geometries),d=c(e.materials),f=c(e.textures),m=c(e.images),g=c(e.shapes),y=c(e.skeletons),_=c(e.animations),b=c(e.nodes);h.length>0&&(r.geometries=h),d.length>0&&(r.materials=d),f.length>0&&(r.textures=f),m.length>0&&(r.images=m),g.length>0&&(r.shapes=g),y.length>0&&(r.skeletons=y),_.length>0&&(r.animations=_),b.length>0&&(r.nodes=b)}return r.object=n,r;function c(h){let d=[];for(let f in h){let m=h[f];delete m.metadata,d.push(m)}return d}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){let n=e.children[r];this.add(n.clone())}return this}};Vm.DefaultUp=new Mt(0,1,0);Vm.DefaultMatrixAutoUpdate=!0;Vm.DefaultMatrixWorldAutoUpdate=!0;new Mt;new Mt;new Mt;new Mt;new Mt;new Mt;new Mt;new Mt;new Mt;new Mt;new Mt;new sc;new Fu;new Vm;new Mt;new yL;new yL;new Mt;new Fu;new Vxe;new ZJ;new Mt;new Mt;new Mt;new Mt;new Mt;new Mt;new Mt;new Mt;new Mt;new sc;new sc;new sc;new Mt;new Mt;function Yxe(i){let e={};for(let t in i){e[t]={};for(let r in i[t]){let n=i[t][r];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?e[t][r]=n.clone():Array.isArray(n)?e[t][r]=n.slice():e[t][r]=n}}return e}function tu(i){let e={};for(let t=0;t<i.length;t++){let r=Yxe(i[t]);for(let n in r)e[n]=r[n]}return e}var Kxe=class extends Vm{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Fu,this.projectionMatrix=new Fu,this.projectionMatrixInverse=new Fu}copy(i,e){return super.copy(i,e),this.matrixWorldInverse.copy(i.matrixWorldInverse),this.projectionMatrix.copy(i.projectionMatrix),this.projectionMatrixInverse.copy(i.projectionMatrixInverse),this}getWorldDirection(i){this.updateWorldMatrix(!0,!1);let e=this.matrixWorld.elements;return i.set(-e[8],-e[9],-e[10]).normalize()}updateMatrixWorld(i){super.updateMatrixWorld(i),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(i,e){super.updateWorldMatrix(i,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},Qxe=class extends eg{constructor(e,t,r,n,l,c,h,d,f,m){e=e!==void 0?e:[],t=t!==void 0?t:Rxe,super(e,t,r,n,l,c,h,d,f,m),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}};new Mt;new Mt;new mp;new ZJ;new Mt;var ebe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,tbe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,ibe=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,rbe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,nbe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,sbe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,abe="vec3 transformed = vec3( position );",obe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,lbe=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,ube=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,cbe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,hbe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,dbe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,fbe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,pbe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,mbe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,gbe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,vbe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,ybe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,_be=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,xbe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,bbe=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,wbe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Sbe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,Mbe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Ebe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Tbe="gl_FragColor = linearToOutputTexel( gl_FragColor );",Abe=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,Cbe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Pbe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Rbe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Ibe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Lbe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Obe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Nbe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Dbe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,kbe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Fbe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,zbe=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,Bbe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,Ube=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,Hbe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert
#define Material_LightProbeLOD( material )	(0)`,$be=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Vbe=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,Wbe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,jbe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,Gbe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,qbe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,Xbe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,Zbe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Jbe=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Ybe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Kbe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,Qbe=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,e1e=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,t1e=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,i1e=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,r1e=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,n1e=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,s1e=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,a1e=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,o1e=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,l1e=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,u1e=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,c1e=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,h1e=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,d1e=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,f1e=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,p1e=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,m1e=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,g1e=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,v1e=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,y1e=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,_1e=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,x1e=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,b1e=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,w1e=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,S1e=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,M1e=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,E1e=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,T1e=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,A1e=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,C1e=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,P1e=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,R1e=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,I1e=`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,L1e=`#if NUM_SPOT_LIGHT_COORDS > 0
  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,O1e=`#if defined( USE_SHADOWMAP ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_COORDS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,N1e=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,D1e=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,k1e=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,F1e=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,z1e=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,B1e=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,U1e=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,H1e=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,$1e=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,V1e=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,W1e=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,j1e=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,G1e=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,q1e=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,X1e=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,Z1e=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,J1e=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,Y1e=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,K1e=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Q1e=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	gl_FragColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		gl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );
	#endif
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,ewe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,twe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,iwe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,rwe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,nwe=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,swe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,awe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,owe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,lwe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,uwe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,cwe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,hwe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,dwe=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,fwe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,pwe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,mwe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,gwe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,vwe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ywe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,_we=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,xwe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,bwe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,wwe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Swe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Mwe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Ewe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Twe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Awe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Cwe=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Pwe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Rwe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Iwe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Sr={alphamap_fragment:ebe,alphamap_pars_fragment:tbe,alphatest_fragment:ibe,alphatest_pars_fragment:rbe,aomap_fragment:nbe,aomap_pars_fragment:sbe,begin_vertex:abe,beginnormal_vertex:obe,bsdfs:lbe,iridescence_fragment:ube,bumpmap_pars_fragment:cbe,clipping_planes_fragment:hbe,clipping_planes_pars_fragment:dbe,clipping_planes_pars_vertex:fbe,clipping_planes_vertex:pbe,color_fragment:mbe,color_pars_fragment:gbe,color_pars_vertex:vbe,color_vertex:ybe,common:_be,cube_uv_reflection_fragment:xbe,defaultnormal_vertex:bbe,displacementmap_pars_vertex:wbe,displacementmap_vertex:Sbe,emissivemap_fragment:Mbe,emissivemap_pars_fragment:Ebe,encodings_fragment:Tbe,encodings_pars_fragment:Abe,envmap_fragment:Cbe,envmap_common_pars_fragment:Pbe,envmap_pars_fragment:Rbe,envmap_pars_vertex:Ibe,envmap_physical_pars_fragment:Vbe,envmap_vertex:Lbe,fog_vertex:Obe,fog_pars_vertex:Nbe,fog_fragment:Dbe,fog_pars_fragment:kbe,gradientmap_pars_fragment:Fbe,lightmap_fragment:zbe,lightmap_pars_fragment:Bbe,lights_lambert_fragment:Ube,lights_lambert_pars_fragment:Hbe,lights_pars_begin:$be,lights_toon_fragment:Wbe,lights_toon_pars_fragment:jbe,lights_phong_fragment:Gbe,lights_phong_pars_fragment:qbe,lights_physical_fragment:Xbe,lights_physical_pars_fragment:Zbe,lights_fragment_begin:Jbe,lights_fragment_maps:Ybe,lights_fragment_end:Kbe,logdepthbuf_fragment:Qbe,logdepthbuf_pars_fragment:e1e,logdepthbuf_pars_vertex:t1e,logdepthbuf_vertex:i1e,map_fragment:r1e,map_pars_fragment:n1e,map_particle_fragment:s1e,map_particle_pars_fragment:a1e,metalnessmap_fragment:o1e,metalnessmap_pars_fragment:l1e,morphcolor_vertex:u1e,morphnormal_vertex:c1e,morphtarget_pars_vertex:h1e,morphtarget_vertex:d1e,normal_fragment_begin:f1e,normal_fragment_maps:p1e,normal_pars_fragment:m1e,normal_pars_vertex:g1e,normal_vertex:v1e,normalmap_pars_fragment:y1e,clearcoat_normal_fragment_begin:_1e,clearcoat_normal_fragment_maps:x1e,clearcoat_pars_fragment:b1e,iridescence_pars_fragment:w1e,output_fragment:S1e,packing:M1e,premultiplied_alpha_fragment:E1e,project_vertex:T1e,dithering_fragment:A1e,dithering_pars_fragment:C1e,roughnessmap_fragment:P1e,roughnessmap_pars_fragment:R1e,shadowmap_pars_fragment:I1e,shadowmap_pars_vertex:L1e,shadowmap_vertex:O1e,shadowmask_pars_fragment:N1e,skinbase_vertex:D1e,skinning_pars_vertex:k1e,skinning_vertex:F1e,skinnormal_vertex:z1e,specularmap_fragment:B1e,specularmap_pars_fragment:U1e,tonemapping_fragment:H1e,tonemapping_pars_fragment:$1e,transmission_fragment:V1e,transmission_pars_fragment:W1e,uv_pars_fragment:j1e,uv_pars_vertex:G1e,uv_vertex:q1e,uv2_pars_fragment:X1e,uv2_pars_vertex:Z1e,uv2_vertex:J1e,worldpos_vertex:Y1e,background_vert:K1e,background_frag:Q1e,backgroundCube_vert:ewe,backgroundCube_frag:twe,cube_vert:iwe,cube_frag:rwe,depth_vert:nwe,depth_frag:swe,distanceRGBA_vert:awe,distanceRGBA_frag:owe,equirect_vert:lwe,equirect_frag:uwe,linedashed_vert:cwe,linedashed_frag:hwe,meshbasic_vert:dwe,meshbasic_frag:fwe,meshlambert_vert:pwe,meshlambert_frag:mwe,meshmatcap_vert:gwe,meshmatcap_frag:vwe,meshnormal_vert:ywe,meshnormal_frag:_we,meshphong_vert:xwe,meshphong_frag:bwe,meshphysical_vert:wwe,meshphysical_frag:Swe,meshtoon_vert:Mwe,meshtoon_frag:Ewe,points_vert:Twe,points_frag:Awe,shadow_vert:Cwe,shadow_frag:Pwe,sprite_vert:Rwe,sprite_frag:Iwe},Jt={common:{diffuse:{value:new jl(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new mp},uv2Transform:{value:new mp},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new sc(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new jl(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new jl(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new mp}},sprite:{diffuse:{value:new jl(16777215)},opacity:{value:1},center:{value:new sc(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new mp}}},fW={basic:{uniforms:tu([Jt.common,Jt.specularmap,Jt.envmap,Jt.aomap,Jt.lightmap,Jt.fog]),vertexShader:Sr.meshbasic_vert,fragmentShader:Sr.meshbasic_frag},lambert:{uniforms:tu([Jt.common,Jt.specularmap,Jt.envmap,Jt.aomap,Jt.lightmap,Jt.emissivemap,Jt.bumpmap,Jt.normalmap,Jt.displacementmap,Jt.fog,Jt.lights,{emissive:{value:new jl(0)}}]),vertexShader:Sr.meshlambert_vert,fragmentShader:Sr.meshlambert_frag},phong:{uniforms:tu([Jt.common,Jt.specularmap,Jt.envmap,Jt.aomap,Jt.lightmap,Jt.emissivemap,Jt.bumpmap,Jt.normalmap,Jt.displacementmap,Jt.fog,Jt.lights,{emissive:{value:new jl(0)},specular:{value:new jl(1118481)},shininess:{value:30}}]),vertexShader:Sr.meshphong_vert,fragmentShader:Sr.meshphong_frag},standard:{uniforms:tu([Jt.common,Jt.envmap,Jt.aomap,Jt.lightmap,Jt.emissivemap,Jt.bumpmap,Jt.normalmap,Jt.displacementmap,Jt.roughnessmap,Jt.metalnessmap,Jt.fog,Jt.lights,{emissive:{value:new jl(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Sr.meshphysical_vert,fragmentShader:Sr.meshphysical_frag},toon:{uniforms:tu([Jt.common,Jt.aomap,Jt.lightmap,Jt.emissivemap,Jt.bumpmap,Jt.normalmap,Jt.displacementmap,Jt.gradientmap,Jt.fog,Jt.lights,{emissive:{value:new jl(0)}}]),vertexShader:Sr.meshtoon_vert,fragmentShader:Sr.meshtoon_frag},matcap:{uniforms:tu([Jt.common,Jt.bumpmap,Jt.normalmap,Jt.displacementmap,Jt.fog,{matcap:{value:null}}]),vertexShader:Sr.meshmatcap_vert,fragmentShader:Sr.meshmatcap_frag},points:{uniforms:tu([Jt.points,Jt.fog]),vertexShader:Sr.points_vert,fragmentShader:Sr.points_frag},dashed:{uniforms:tu([Jt.common,Jt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Sr.linedashed_vert,fragmentShader:Sr.linedashed_frag},depth:{uniforms:tu([Jt.common,Jt.displacementmap]),vertexShader:Sr.depth_vert,fragmentShader:Sr.depth_frag},normal:{uniforms:tu([Jt.common,Jt.bumpmap,Jt.normalmap,Jt.displacementmap,{opacity:{value:1}}]),vertexShader:Sr.meshnormal_vert,fragmentShader:Sr.meshnormal_frag},sprite:{uniforms:tu([Jt.sprite,Jt.fog]),vertexShader:Sr.sprite_vert,fragmentShader:Sr.sprite_frag},background:{uniforms:{uvTransform:{value:new mp},t2D:{value:null}},vertexShader:Sr.background_vert,fragmentShader:Sr.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0}},vertexShader:Sr.backgroundCube_vert,fragmentShader:Sr.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Sr.cube_vert,fragmentShader:Sr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Sr.equirect_vert,fragmentShader:Sr.equirect_frag},distanceRGBA:{uniforms:tu([Jt.common,Jt.displacementmap,{referencePosition:{value:new Mt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Sr.distanceRGBA_vert,fragmentShader:Sr.distanceRGBA_frag},shadow:{uniforms:tu([Jt.lights,Jt.fog,{color:{value:new jl(0)},opacity:{value:1}}]),vertexShader:Sr.shadow_vert,fragmentShader:Sr.shadow_frag}};fW.physical={uniforms:tu([fW.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new sc(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new jl(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new sc},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new jl(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new jl(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Sr.meshphysical_vert,fragmentShader:Sr.meshphysical_frag};var Lwe=class extends Kxe{constructor(i=-1,e=1,t=1,r=-1,n=.1,l=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=i,this.right=e,this.top=t,this.bottom=r,this.near=n,this.far=l,this.updateProjectionMatrix()}copy(i,e){return super.copy(i,e),this.left=i.left,this.right=i.right,this.top=i.top,this.bottom=i.bottom,this.near=i.near,this.far=i.far,this.zoom=i.zoom,this.view=i.view===null?null:Object.assign({},i.view),this}setViewOffset(i,e,t,r,n,l){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=i,this.view.fullHeight=e,this.view.offsetX=t,this.view.offsetY=r,this.view.width=n,this.view.height=l,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let i=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),t=(this.right+this.left)/2,r=(this.top+this.bottom)/2,n=t-i,l=t+i,c=r+e,h=r-e;if(this.view!==null&&this.view.enabled){let d=(this.right-this.left)/this.view.fullWidth/this.zoom,f=(this.top-this.bottom)/this.view.fullHeight/this.zoom;n+=d*this.view.offsetX,l=n+d*this.view.width,c-=f*this.view.offsetY,h=c-f*this.view.height}this.projectionMatrix.makeOrthographic(n,l,c,h,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(i){let e=super.toJSON(i);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,this.view!==null&&(e.object.view=Object.assign({},this.view)),e}};new Lwe;new jl;var M1=(1+Math.sqrt(5))/2,uS=1/M1;new Mt(1,1,1),new Mt(-1,1,1),new Mt(1,1,-1),new Mt(-1,1,-1),new Mt(0,M1,uS),new Mt(0,M1,-uS),new Mt(uS,0,M1),new Mt(-uS,0,M1),new Mt(M1,uS,0),new Mt(-M1,uS,0);new eg;new Uxe;new Hxe;new Qxe;var JJ="\\[\\]\\.:\\/",JB="[^"+JJ+"]",Owe="[^"+JJ.replace("\\.","")+"]";/((?:WC+[\/:])*)/.source.replace("WC",JB);/(WCOD+)?/.source.replace("WCOD",Owe);/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",JB);/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",JB);typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:jJ}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=jJ);var FS=(i=>(i[i.x=0]="x",i[i.y=0]="y",i[i.z=0]="z",i))(FS||{}),Nwe=qB(gxe()),YB=class{constructor(e){this.debug=(0,Nwe.default)(e)}log(e,...t){this.debug(e,...t)}},Dwe=function(){this.onInit=function(){this.THREE=this.context.three,this.curVector=new this.THREE.Vector3(0,0,0),this.destVector=new this.THREE.Vector3(0,0,0),this.curQuaternion=new this.THREE.Quaternion(0,0,0,0),this.destQuaternion=new this.THREE.Quaternion(0,0,0,0),this.vectorToSet=null,this.quatToSet=null,this.vectorCounter=0,this.quatCounter=0,this.speed=1.25},this.onTick=function(i){if(this.vectorToSet){if(this.vectorToSet.equals(this.destVector)&&this.vectorCounter>120)return;this.vectorCounter++,this.curVector.lerp(this.destVector,i/1e3*this.speed),this.vectorToSet.set(this.curVector.x,this.curVector.y,this.curVector.z)}if(this.quatToSet){if(this.quatToSet.equals(this.destQuaternion)&&this.quatCounter>120)return;this.quatCounter++,this.curQuaternion.slerp(this.destQuaternion,i/1e3*this.speed),this.quatToSet.set(this.curQuaternion.x,this.curQuaternion.y,this.curQuaternion.z,this.curQuaternion.w)}},this.animateVector=function(i,e){this.vectorCounter=0,this.destVector=e,this.vectorToSet=i},this.animateQuaternion=function(i,e){this.quatCounter=0,this.destQuaternion=e,this.quatToSet=i},this.onEvent=function(){},this.onInputsUpdated=function(){},this.onDestroy=function(){}},kwe=()=>new Dwe,oI=(i=>(i[i["#31E0B0"]=0]="#31E0B0",i[i["#FF5E10"]=1]="#FF5E10",i[i["#00ABF7"]=2]="#00ABF7",i[i["#FF00BB"]=3]="#FF00BB",i[i["#9C29FF"]=4]="#9C29FF",i[i["#6FDD00"]=5]="#6FDD00",i[i["#E30000"]=6]="#E30000",i[i["#304AFF"]=7]="#304AFF",i[i["#FF89C4"]=8]="#FF89C4",i[i["#D597FF"]=9]="#D597FF",i[i["#C6EC5C"]=10]="#C6EC5C",i[i["#FFA115"]=11]="#FFA115",i[i["#75DEFE"]=12]="#75DEFE",i[i["#FAA291"]=13]="#FAA291",i[i["#BB813F"]=14]="#BB813F",i[i["#F4CE00"]=15]="#F4CE00",i[i["#878291"]=16]="#878291",i))(oI||{}),Fwe=["#000000","#FFFFFF","#000000","#FFFFFF","#FFFFFF","#000000","#FFFFFF","#FFFFFF","#000000","#000000","#000000","#000000","#000000","#000000","#FFFFFF","#000000","#FFFFFF"],zwe=function(){this.onInit=function(){this.THREE=this.context.three},this.onTick=function(i){},this.onEvent=function(){},this.onInputsUpdated=function(){},this.onDestroy=function(){},this.createName=(i,e,t,r)=>xo(this,null,function*(){let n=i,l=r,c=oI[t],h=Fwe[t],d=new FontFace("OpenSans-SemiBold","url(https://superviz2homologmediaserver.s3.amazonaws.com/static/fonts/OpenSans-SemiBold.woff)");yield d.load(),document.fonts.add(d);let f=this.createText(e,h,c);f.position.set(0,l,0),n.add(f)}),this.createText=(i,e,t)=>{let r=document.createElement("canvas"),n=r.getContext("2d"),l=100,c=10*l,h=.03,d=n.measureText(i).width*l*1.12;r.width=d,r.height=c,n.font=`${c}px OpenSans-SemiBold`,n.textBaseline="middle",n.fillStyle=e,n.fillText(i,0,c/2);let f=new this.THREE.Texture(r);f.needsUpdate=!0;let m=new this.THREE.SpriteMaterial({map:f,useScreenCoordinates:!1,opacity:1,alphaTest:.5,depthTest:!0,transparent:!0}),g=new this.THREE.Sprite(m);g.raycast=()=>null;let y=new this.THREE.Object3D;y.textHeight=h,y.textWidth=d/c*y.textHeight,g.scale.set(d/c*h,h,1);let _=document.createElement("canvas");_.width=d+10,_.height=c+10;let b=_.getContext("2d"),S=this.addAlpha(t.split("#")[1],.99);b.fillStyle=`#${S}`,b.beginPath(),b.roundRect(-15,0,_.width,_.height*.9,_.width),b.fill();let E=new this.THREE.Texture(_);E.needsUpdate=!0;let T=new this.THREE.SpriteMaterial({opacity:.99,transparent:!1,useScreenCoordinates:!1,alphaTest:.1,color:new this.THREE.Color(t),map:E}),A=new this.THREE.Sprite(T);return A.scale.set(1.18,1.25,1.1),g.add(A),y.add(g),y},this.addAlpha=(i,e)=>{let t=Math.round(Math.min(Math.max(e||1,0),1)*255);return i+t.toString(16).toUpperCase()}},Bwe=()=>new zwe,Uwe=function(){this.inputs={origin:{x:0,y:0,z:0}},this.onInit=function(){this.THREE=this.context.three,this.destPos=new this.THREE.Vector3(0,0,0),this.curPos=new this.THREE.Vector3(0,0,0),this.startPos=new this.THREE.Vector3(0,0,0),this.counter=0,this.index=-1,this.lastIndex=-1,this.lastDestPos=new this.THREE.Vector3(1e3,1e3,1e3),this.lastStartPos=new this.THREE.Vector3(1e3,1e3,1e3),this.speed=.95,this.tempStartPos=new this.THREE.Vector3(0,0,0),this.quat=new this.THREE.Quaternion(0,0,0,0)},this.onTick=function(i){if(this.createdMaterial&&!(this.counter>60&&this.lastDestPos.equals(this.destPos)&&this.lastStartPos.distanceTo(this.startPos)<.2)){if(this.counter++,this.lastIndex!==this.index){let e=oI[this.index];this.material&&(this.material.color.set(e),this.lastIndex=this.index)}this.curPos.lerp(this.destPos,i/1e3*this.speed),this.lastDestPos.x=this.destPos.x,this.lastDestPos.y=this.destPos.y,this.lastDestPos.z=this.destPos.z,this.lastStartPos.x=this.startPos.x,this.lastStartPos.y=this.startPos.y,this.lastStartPos.z=this.startPos.z,this._updateMesh(this.startPos,this.curPos),this.outputs.objectRoot.visible=this.isOn&&this.shouldRenderAvatars}},this.onDestroy=function(){this.material&&this.material.dispose()},this.createMaterial=i=>{this.createdMaterial=!0;let e=this.createTextureCanvas(),t=new this.THREE.Texture(e);t.needsUpdate=!0;let r=0;i!==-1&&(r=i);let n=oI[r];this.material=new this.THREE.MeshBasicMaterial({map:t,blending:this.THREE.AdditiveBlending,color:n,side:this.THREE.DoubleSide,depthWrite:!0,transparent:!0})},this._updateMesh=(i,e)=>{this.tempStartPos.copy(this.inputs.origin),this.tempStartPos.applyQuaternion(this.quat),this.tempStartPos.add(i);let t=new this.THREE.LineCurve3(this.tempStartPos,e);this.outputs.objectRoot&&this.outputs.objectRoot.geometry&&this.outputs.objectRoot.geometry.dispose();let r=new this.THREE.TubeGeometry(t,1,.003,4,!1);this.material&&(this.outputs.objectRoot=new this.THREE.Mesh(r,this.material))},this._doUpdateGeometry=(i,e,t,r,n={x:0,y:0,z:0},l={x:0,y:0,z:0})=>{this.index=t,this.createdMaterial||this.createMaterial(t),this.destPos.x=l.x,this.destPos.y=l.y,this.destPos.z=l.z,this.startPos.x=n.x,this.startPos.y=n.y,this.startPos.z=n.z,this.quat.set(r.x,r.y,r.z,r.w),this.counter=0,this.isOn=i,this.shouldRenderAvatars=e},this.updateGeometry=(i,e,t,r,n,l)=>{this._doUpdateGeometry(t,r,n,l,i,e)},this.createTextureCanvas=()=>{let i=document.createElement("canvas"),e=i.getContext("2d");i.width=1,i.height=64;let t=e.createLinearGradient(0,0,i.width,i.height);return t.addColorStop(0,"rgba(  0,  0,  0,0.1)"),t.addColorStop(.1,"rgba(160,160,160,0.3)"),t.addColorStop(.5,"rgba(255,255,255,0.5)"),t.addColorStop(.9,"rgba(160,160,160,0.3)"),t.addColorStop(1,"rgba(  0,  0,  0,0.1)"),e.fillStyle=t,e.fillRect(0,0,i.width,i.height),i},this.onEvent=function(i,e){},this.onInputsUpdated=function(i){}},Hwe=()=>new Uwe,$we=500,Vwe={model3DUrl:"https://production.storage.superviz.com/readyplayerme/1.glb",imageUrl:"https://production.cdn.superviz.com/static/default-avatars/1.png"},Wwe=class{constructor(e,t){this.participants=[],this.isAttached=!1,this.localSlot=-1,this.currentCirclePosition=FS,this.currentLocalPosition=FS,this.currentLocalRotation=FS,this.currentLocalLaserDest=FS,this.circlePositions=[],this.avatars={},this.lasers={},this.laserUpdateIntervals={},this.positionInfos={},this.tempQuaternion=new TE(0,0,0,0),this.isSweeping=!1,this.unsubscribeFrom=[],this.attach=m=>{if(Object.values(m).includes(null)||Object.values(m).includes(void 0)){let S=`${this.name} @ attach - params are required`;throw this.logger.log(S),new Error(S)}let{realtime:g,eventBus:y,useStore:_}=m,{localParticipant:b}=_.call(this,"global-store");b.subscribe(),this.realtime=g,this.isAttached=!0,this.eventBus=y,this.logger.log("attached"),this.start()},this.detach=()=>{if(!this.isAttached){this.logger.log(`${this.name} @ detach - component is not attached}`);return}this.logger.log("detached"),this.destroy(),this.unsubscribeFrom.forEach(m=>m(this)),this.realtime=void 0,this.localParticipant=void 0,this.isAttached=!1},this.destroy=()=>{this.unsubscribeToRealtimeEvents(),this.unsubscribeToEventBusEvents(),this.realtime.leavePresence3DChannel(),this.isAttached=!1,this.ambientLight.stop(),this.directionalLight.stop(),this.participants.forEach(m=>{this.removeParticipant(m,!0)}),Object.keys(this.laserUpdateIntervals).forEach(m=>{clearInterval(this.laserUpdateIntervals[m])}),this.participants=[],this.laserUpdateIntervals={},this.avatars={},this.lasers={},this.realtime=void 0},this.start=m=>{if(m||this.realtime.enterPresence3DChannel(this.localParticipant),!this.realtime.isJoinedRoom||!this.realtime.isJoinedPresence3D){this.logger.log("matterport component @ start - not joined yet"),setTimeout(()=>{this.logger.log("matterport component @ start - retrying"),this.start(!0)},1e3);return}this.subscribeToRealtimeEvents(),this.subscribeToEventBusEvents(),this.createParticipantList()},this.subscribeToRealtimeEvents=()=>{this.logger.log("matterport component @ subscribeToRealtimeEvents"),this.realtime.presence3dObserver.subscribe(this.onParticipantsUpdated),this.realtime.presence3dJoinedObserver.subscribe(this.onParticipantJoined),this.realtime.presence3dLeaveObserver.subscribe(this.onParticipantLeave),this.realtime.roomInfoUpdatedObserver.subscribe(this.onRoomInfoUpdate)},this.unsubscribeToRealtimeEvents=()=>{this.logger.log("matterport component @ unsubscribeToRealtimeEvents"),this.realtime.presence3dJoinedObserver.unsubscribe(this.onParticipantJoined),this.realtime.presence3dLeaveObserver.unsubscribe(this.onParticipantLeave),this.realtime.presence3dObserver.unsubscribe(this.onParticipantsUpdated),this.realtime.roomInfoUpdatedObserver.unsubscribe(this.onRoomInfoUpdate)},this.subscribeToEventBusEvents=()=>{this.logger.log("matterport component @ subscribeToEventBusEvents"),this.eventBus.subscribe("realtime.go-to-participant",this.goTo),this.eventBus.subscribe("realtime.local-follow-participant",this.localFollow),this.eventBus.subscribe("realtime.follow-participant",this.follow),this.eventBus.subscribe("realtime.private-mode",this.setPrivate)},this.unsubscribeToEventBusEvents=()=>{this.logger.log("matterport component @ unsubscribeToEventBusEvents"),this.eventBus.unsubscribe("realtime.go-to-participant",this.goTo),this.eventBus.unsubscribe("realtime.local-follow-participant",this.localFollow),this.eventBus.unsubscribe("realtime.private-mode",this.setPrivate),this.eventBus.unsubscribe("realtime.follow-participant",this.follow)},this.onParticipantJoined=m=>{if(!m.data)return;this.logger.log("matterport component @ onParticipantJoined",m);let{id:g,name:y,avatar:_,avatarConfig:b,type:S}=m.data;if(g===this.localParticipantId){this.onLocalParticipantJoined(m.data);return}this.addParticipant({id:g,name:y,avatar:_,avatarConfig:b,type:S})},this.onLocalParticipantJoined=m=>{var g,y,_,b;this.config.avatarConfig&&this.realtime.setParticipantData({avatarConfig:this.config.avatarConfig}),(g=m.avatar)!=null&&g.model3DUrl&&this.realtime.setParticipantData({avatar:{model3DUrl:m.avatar.model3DUrl,imageUrl:(y=m.avatar)==null?void 0:y.imageUrl}}),(_=m.avatar)!=null&&_.model3DUrl||this.realtime.setParticipantData({avatar:{model3DUrl:Vwe.model3DUrl,imageUrl:(b=m.avatar)==null?void 0:b.imageUrl}})},this.onParticipantLeave=m=>{this.logger.log("matterport component @ onParticipantLeave",m);let g=this.participants.find(y=>y.id===m.clientId);!g||this.removeParticipant(g,!0)},this.onParticipantUpdated=m=>{var g,y;this.logger.log("matterport component @ onParticipantUpdated",m);let{id:_,name:b,avatar:S,avatarConfig:E,position:T,rotation:A,type:P}=(g=m.data)!=null?g:m;this.updateParticipant({position:T,rotation:A,id:_,name:b,avatar:S,avatarConfig:E,type:P}),(this.localFollowParticipantId||this.followParticipantId)&&this.moveToAnotherParticipant((y=this.localFollowParticipantId)!=null?y:this.followParticipantId)},this.updateParticipant=m=>xo(this,null,function*(){var g,y;if(!this.participants||this.participants.length===0||!m||!m.id||m.id===this.localParticipantId)return;let _=this.participants.find(b=>b.id===m.id);if(!_){this.addParticipant(m);return}if(((g=_.avatar)==null?void 0:g.model3DUrl)!==((y=m.avatar)==null?void 0:y.model3DUrl)||!(0,Pxe.isEqual)(_.avatarConfig,m.avatarConfig)||_.name!==m.name){this.removeParticipant(m,!1);let b=this.createParticipantOn3D(m);this.participants.push(b),this.config.isAvatarsEnabled&&(yield this.createAvatar(b)),this.config.isLaserEnabled&&this.createLaser(b),this.config.isNameEnabled&&this.createName(b,this.avatars[m.id])}else{let b=this.participants.findIndex(S=>S.id===m.id);b!==-1&&(this.participants[b]=m)}this.logger.log("matterport component @ updateParticipant",{participant:m,participants:this.participants})}),this.onRoomInfoUpdate=m=>{this.logger.log("matterport component @ onRoomInfoUpdate",m);let{gather:g,hostClientId:y,followParticipantId:_}=m;this.followParticipantId=_,g&&this.moveToAnotherParticipant(y),this.realtime.hostClientId===this.localParticipant.id&&g&&this.realtime.setGather(!1)},this.createParticipantList=()=>{let m=this.realtime.getParticipants;Object.values(m).forEach(g=>{let{data:y}=g;this.addParticipant(y)}),this.logger.log("matterport component @ createParticipantList",this.participants)},this.createParticipantOn3D=({id:m,name:g,avatar:y,avatarConfig:_,type:b})=>{let S={id:m,name:g,avatar:y,isAudience:b==="audience",avatarConfig:m===this.localParticipantId?this.config.avatarConfig:_,position:{x:0,y:0,z:0},rotation:{x:0,y:0}};return this.logger.log("matterport component @ createParticipantOn3D",S),S},this.removeParticipant=(m,g)=>{this.logger.log("matterport component @ removeParticipant",{participant:m,unsubscribe:g}),this.participants=this.participants.filter(y=>y.id!==m.id),this.destroyAvatar(m),this.destroyLaser(m),g&&this.realtime.unsubscribeFromParticipant3DUpdate(m.id,this.onParticipantUpdated)},this.addParticipant=m=>xo(this,null,function*(){if(!m||!m.id||m.type==="audience")return;let g=this.createParticipantOn3D(m);if(this.participants.find(y=>y.id===g.id)){this.logger.log("matterport component @ addParticipant - participant already exists"),this.onParticipantUpdated(m);return}this.participants.push(g),this.logger.log("matterport component @ addParticipant",{participant:m,participantOn3D:g,participants:this.participants}),this.realtime.subscribeToParticipant3DUpdate(g.id,this.onParticipantUpdated),this.localParticipantId!==g.id&&(this.config.isAvatarsEnabled&&(yield this.createAvatar(g)),this.config.isLaserEnabled&&this.createLaser(g),this.config.isNameEnabled&&this.createName(g,this.avatars[m.id]))}),this.goTo=m=>{this.logger.log("matterport component @ goTo",m),this.moveToAnotherParticipant(m)},this.gather=()=>{this.logger.log("matterport component @ gather"),this.realtime.setGather(!0)},this.setPrivate=m=>{this.logger.log("matterport component @ private mode",m),this.realtime.updatePresence3D({id:this.localParticipantId,isPrivate:m})},this.localFollow=m=>{this.localFollowParticipantId=m},this.moveToAnotherParticipant=m=>{if(!this.positionInfos[m]||!this.isAttached||m===this.localParticipantId)return;let{mode:g}=this.positionInfos[m];if(g==="mode.inside"){let{sweep:y}=this.positionInfos[m];if(y){let _=this.positionInfos[m].rotation||{x:0,y:0};this.moveToSweep(y,_)}}if(g==="mode.dollhouse"||g==="mode.floorplan"){let y=this.matterportSdk.Mode.TransitionType.FLY,{position:_,rotation:b,floor:S}=this.positionInfos[m];this.matterportSdk.Mode.moveTo(g,{position:_,rotation:b,transition:y,zoom:25}).then(E=>{this.currentLocalMode=E}),g==="mode.floorplan"&&this.currentLocalFloorId!==S&&(S===-1?this.matterportSdk.Floor.showAll():this.matterportSdk.Floor.moveTo(S).then(()=>{this.currentLocalFloorId=S}))}},this._onLocalSweepChangeObserver=m=>{!this.realtime||(this.currentSweepId=m.id,this.realtime.updatePresence3D({id:this.localParticipantId,sweep:this.currentSweepId}))},this._onLocalFloorChangeObserver=m=>{!this.realtime||(m.id!==""&&(this.currentLocalFloorId=parseFloat(m.id)),m.name==="all"&&(this.currentLocalFloorId=-1),this.realtime.updatePresence3D({id:this.localParticipantId,floor:this.currentLocalFloorId}))},this._onLocalModeChangeObserver=m=>{!this.realtime||(this.currentLocalMode=m,this.realtime.updatePresence3D({id:this.localParticipantId,mode:this.currentLocalMode}))},this._onLocalCameraMoveObserver=({position:m,rotation:g,sweep:y})=>{!this.realtime||(this.currentLocalPosition=this.adjustMyPositionToCircle(m),this.currentLocalRotation=g,this.currentSweepId=y,this.realtime&&this.realtime.updatePresence3D({id:this.localParticipantId,position:this.currentLocalPosition,rotation:this.currentLocalRotation,laser:this.currentLocalLaserDest,sweep:this.currentSweepId,mode:this.currentLocalMode,floor:this.currentLocalFloorId}))},this._onLocalMouseMoveObserver=m=>{!this.realtime||(this.currentLocalLaserDest=m.position,this.realtime.updatePresence3D({id:this.localParticipantId,position:this.currentLocalPosition,rotation:this.currentLocalRotation,laser:this.currentLocalLaserDest,mode:this.currentLocalMode,sweep:this.currentSweepId}))},this.addInputComponent=()=>xo(this,null,function*(){let[m]=yield this.matterportSdk.Scene.createObjects(1),g=m.addNode();this.mpInputComponent=g.addComponent("mp.input",{eventsEnabled:!1,userNavigationEnabled:!0}),g.start()}),this.addSceneLight=()=>xo(this,null,function*(){this.directionalLight=yield this.createDirectionLight(),this.ambientLight=yield this.createAmbientLight()}),this.createDirectionLight=()=>xo(this,null,function*(){let[m]=yield this.matterportSdk.Scene.createObjects(1),g=m.addNode(),y={enabled:!0,color:{r:1,g:1,b:1},intensity:1,position:{x:.2,y:1,z:0},target:{x:.5,y:0,z:0},debug:!1},_=g.addComponent("mp.directionalLight",y);return this.THREE=_.context.three,g.start(),g}),this.createAmbientLight=()=>xo(this,null,function*(){let[m]=yield this.matterportSdk.Scene.createObjects(1),g=m.addNode(),y={enabled:!0,color:{r:1,g:1,b:1},intensity:1};return g.addComponent("mp.ambientLight",y),g.start(),g}),this.adjustMyPositionToCircle=m=>{var g;if(!this.realtime||(this.localSlot=this.realtime.getParticipantSlot(this.localParticipantId),!this.THREE||this.localSlot===-1))return m;let y=new this.THREE.Vector3(m==null?void 0:m.x,m==null?void 0:m.y,m==null?void 0:m.z);return this.circlePositions[this.localSlot]?((g=this.currentCirclePosition)!=null&&g.isVector3||(this.currentCirclePosition=new this.THREE.Vector3(this.circlePositions[this.localSlot].x,m.y,this.circlePositions[this.localSlot].z)),this.currentCirclePosition.set(this.circlePositions[this.localSlot].x,m.y,this.circlePositions[this.localSlot].z),y.add(this.currentCirclePosition.multiplyScalar(.13)),{x:y.x,y:m.y,z:y.z}):m},this.onParticipantsUpdated=m=>{!this.isAttached||(this.logger.log("matterport component @ onParticipantsUpdated",m),Object.values(m).forEach(g=>{if(g.clientId===this.localParticipantId)return;let y=g.clientId,{position:_,rotation:b,sweep:S,floor:E,mode:T,isPrivate:A}=g.data;if(this.positionInfos[y]={position:_,rotation:b,mode:T,sweep:S,floor:E},A&&this.avatars[y]&&this.removeParticipant(g.data,!0),!A&&!this.avatars[y]&&this.addParticipant(g.data),this.avatars[y]){let P=this.avatars[y],O=this.lasers[y],R=g.data.laser;_&&b&&this.updateAvatar(P,_,b),O&&(this.laserUpdateIntervals[y]&&clearInterval(this.laserUpdateIntervals[y]),this.laserUpdateIntervals[y]=setInterval(()=>{this.updateLaser(y,P,O,R)},30))}}))};var r,n,l,c,h,d,f;this.name="presence3dMatterport",this.logger=new YB("@superviz/sdk/matterport-component"),this.logger.log("matterport component @ constructor",{matterportSdk:e,options:t}),this.config={isAvatarsEnabled:(r=t==null?void 0:t.isAvatarsEnabled)!=null?r:!0,isLaserEnabled:(n=t==null?void 0:t.isLaserEnabled)!=null?n:!0,isNameEnabled:(l=t==null?void 0:t.isNameEnabled)!=null?l:!0,avatarConfig:{height:((c=t==null?void 0:t.avatarConfig)==null?void 0:c.height)||.25,scale:((h=t==null?void 0:t.avatarConfig)==null?void 0:h.scale)||.55,laserOrigin:(f=(d=t==null?void 0:t.avatarConfig)==null?void 0:d.laserOrigin)!=null?f:{x:0,y:-.2,z:.07}}},this.logger.log("matterport component @ constructor - config",this.config),this.matterportSdk=e,this.matterportSdk.Scene.register("lerper",kwe),this.matterportSdk.Scene.register("name",Bwe),this.matterportSdk.Scene.register("laser",Hwe),this.addInputComponent(),this.addSceneLight(),this.createCircleOfPositions(),this.subscribeToMatterportEvents()}get localParticipantId(){var e;return(e=this.localParticipant)==null?void 0:e.id}follow(e){this.logger.log("matterport component @ follow"),this.realtime.setFollowParticipant(e)}destroyAvatar(e){return xo(this,null,function*(){this.logger.log("matterport component @ destroyAvatar",e),this.avatars[e.id]&&(this.avatars[e.id].stop(),delete this.avatars[e.id])})}destroyLaser(e){return xo(this,null,function*(){this.logger.log("matterport component @ destroyLaser",e),this.lasers[e.id]&&(this.lasers[e.id].stop(),delete this.lasers[e.id])})}createAvatar(e){return xo(this,null,function*(){var t,r,n,l;if(this.logger.log("matterport component @ createAvatar",e),!this.isAttached)return;let c=((t=e==null?void 0:e.avatarConfig)==null?void 0:t.scale)||.55,h=((r=e==null?void 0:e.avatarConfig)==null?void 0:r.height)||.25,[d]=yield this.matterportSdk.Scene.createObjects(1),f=d.addNode(),m=FS;f.obj3D.rotation.set(m.x,m.y,m.z),f.obj3D.name="avatar",f.obj3D.userData={uuid:e.id,name:e.name,height:h};let g=(l=(n=e.avatar)==null?void 0:n.model3DUrl)!=null?l:"https://production.storage.superviz.com/readyplayerme/1.glb",y={x:c,y:c,z:c};return f.lerper=f.addComponent("lerper"),f.avatarName=f.addComponent("name"),this.avatars[e.id]=f,new Promise(_=>{f.addComponent("mp.gltfLoader",{url:g,localScale:y,onLoaded:()=>{this.matterportSdk.Camera.getPose().then(b=>{this._onLocalCameraMoveObserver({position:b.position,rotation:b.rotation,sweep:b.sweep}),_(f)})}}),f.start()})})}createName(e,t){return xo(this,null,function*(){var r,n;if(this.logger.log("createName",e,t),!t)return;let l=Number(this.THREE.REVISION),c=(n=(r=e.avatar)==null?void 0:r.model3DUrl)!=null?n:"https://production.storage.superviz.com/readyplayerme/1.glb",h=c==null?void 0:c.includes("readyplayerme"),d=t.avatarName,f=this.realtime.getParticipantSlot(e.id),m=new this.THREE.Box3().setFromObject(t.obj3D),g=new Mt(0,0,0);m.getSize(g);let y;l<=146?y=m.min.y-t.position.y+g.y*1.1:(y=g.y*1.2,h&&(y=g.y*4.1)),d.createName(t.obj3D,e.name,f,y)})}createLaser(e){return xo(this,null,function*(){var t;if(this.logger.log("matterport component @ createLaser",e),!this.isAttached)return;let r=new Mt(0,-.2,.07);(t=e.avatarConfig)!=null&&t.laserOrigin&&(r=new Mt(e.avatarConfig.laserOrigin.x,e.avatarConfig.laserOrigin.y,e.avatarConfig.laserOrigin.z));let[n]=yield this.matterportSdk.Scene.createObjects(1),l=n.addNode();l.laserPointer=l.addComponent("laser",{origin:r}),l.start(),l.obj3D.userData={uuid:e.id},this.lasers[e.id]=l})}subscribeToMatterportEvents(){this.matterportSdk.Camera.pose.subscribe(this._onLocalCameraMoveObserver),this.matterportSdk.Pointer.intersection.subscribe(this._onLocalMouseMoveObserver),this.matterportSdk.Floor.current.subscribe(this._onLocalFloorChangeObserver),this.matterportSdk.Mode.current.subscribe(this._onLocalModeChangeObserver),this.matterportSdk.Sweep.current.subscribe(this._onLocalSweepChangeObserver)}createCircleOfPositions(){let e=4.8,t=0;for(let r=0;r<16;r++){t=r*(360/16);let n=t*(Math.PI/180),l=e*Math.cos(n),c=0,h=e*Math.sin(n);if(r!==0){let d={x:l,y:c,z:h};r%2===0?this.circlePositions.push(d):this.circlePositions.unshift(d)}}}moveToSweep(e,t){this.isSweeping||!this.isAttached||(this.mpInputComponent&&(this.mpInputComponent.inputs.userNavigationEnabled=!1),this.isSweeping=!0,this.matterportSdk.Sweep.moveTo(e,{transitionTime:$we,transition:this.matterportSdk.Sweep.Transition.FLY,rotation:t||this.currentLocalRotation}).finally(()=>{this.isSweeping=!1,this.mpInputComponent&&(this.mpInputComponent.inputs.userNavigationEnabled=!0)}))}updateAvatar(e,t,r){var n,l,c;if(!this.isAttached)return;let h=new this.THREE.Vector3(1,0,0),d=new this.THREE.Vector3(0,1,0),f=new this.THREE.Quaternion().setFromAxisAngle(h,this.THREE.MathUtils.degToRad(-r.x)),m=new this.THREE.Quaternion().setFromAxisAngle(d,this.THREE.MathUtils.degToRad(r==null?void 0:r.y)+Math.PI),{lerper:g}=e;g.animateQuaternion(e.obj3D.quaternion,m.multiply(f));let y=parseFloat((c=(l=(n=e==null?void 0:e.obj3D)==null?void 0:n.userData)==null?void 0:l.height)!=null?c:0)-.62,_=new this.THREE.Vector3(this.currentCirclePosition.x,0,this.currentCirclePosition.z),b=new this.THREE.Vector3(t==null?void 0:t.x,0,t==null?void 0:t.z).sub(_);b.y=t.y+y,g.animateVector(e.obj3D.position,b)}updateLaser(e,t,r,n){if(!t||!r||!n||!this.isAttached)return;let l=r.laserPointer,{x:c,y:h,z:d}=t.obj3D.position,f={x:c,y:h+.35,z:d};if(t.obj3D.getWorldQuaternion(this.tempQuaternion),l){let m=this.realtime.getParticipantSlot(e);l.updateGeometry(f,n,!0,!0,m,this.tempQuaternion)}}},jwe=qB(Cxe()),Gwe=class{constructor(e={}){this.subscribe=n=>{this.callbacks.push(n)},this.unsubscribe=n=>{this.callbacks=this.callbacks.filter(l=>l!==n)},this.publish=(...n)=>{!this.callbacks||this.callbacks.forEach(l=>{this.callListener(l,n).catch(c=>{this.logger.log("superviz-sdk:observer-helper:publish:error",`
            Failed to execute callback on publish value.
            Callback: ${l}
            Event: ${JSON.stringify(n)}
            Error: ${c}
          `)})})},this.reset=()=>{this.callbacks=[]},this.destroy=()=>{delete this.logger,delete this.callbacks},this.callListener=(n,l)=>new Promise((c,h)=>{try{let d=n(...l);c(d)}catch(d){h(d)}});let{logger:t,throttleTime:r}=e;this.logger=t??new YB("@superviz/sdk/observer-helper"),this.throttle=r,this.callbacks=[],this.throttle&&(this.publish=(0,jwe.default)(this.publish,this.throttle))}},YJ,qwe=class{constructor(){this.eventType="INTERACTION.CLICK"}onEvent(){YJ.onClick()}},Xwe=class{constructor(e,t){this.isPinsVisible=!0,this.divWrapperReplacementInterval=null,this.isSweeping=!1,this.commentsSide="left",this.selectedPin=null,this.setCommentsMetadata=r=>{this.commentsSide=r},this.hideTemporaryPin=r=>{var n;let l=r.target;this.showcaseDiv.contains(l)||(n=this.pins.get("temporary-pin"))!=null&&n.contains(l)||this.removeAnnotationPin("temporary-pin")},this.resetPins=r=>{r&&(r==null?void 0:r.key)!=="Escape"||(this.resetSelectedPin(),this.removeAnnotationPin("temporary-pin"),this.temporaryPinCoordinates=null)},this.annotationSelected=({detail:r})=>{var n,l;let{uuid:c,haltGoToPin:h,newPin:d}=r;if(!c)return;d&&this.pins.get(c).setAttribute("newPin","");let f=JSON.parse((l=(n=this.selectedPin)==null?void 0:n.getAttribute("annotation"))!=null?l:"{}");if(this.resetPins(),(f==null?void 0:f.uuid)===c)return;document.body.dispatchEvent(new CustomEvent("close-temporary-annotation"));let m=this.pins.get(c);if(!m)return;m.setAttribute("active",""),this.selectedPin=m;let g=this.annotations.find(y=>y.uuid===c);if(g){let y=JSON.parse(g.position);if(y&&!h){let _=y.camera;this.moveToSweep(_.sweep,_.rotation)}}},this.onClick=()=>{if(!this.isActive)return;let r={x:this.intersection.position.x,y:this.intersection.position.y,z:this.intersection.position.z,type:"matterport"},n={position:r,camera:this.cameraPose};this.resetSelectedPin(),this.onPinFixedObserver.publish(n),this.createTemporaryPin(r)},this.onToggleAnnotationSidebar=({detail:r})=>{let{open:n}=r;n||(this.pins.forEach(l=>{l.removeAttribute("active")}),this.pins.has("temporary-pin")&&this.removeAnnotationPin("temporary-pin"))},YJ=this,this.showcaseDiv=t,this.matterportSdk=e,this.logger=new YB("@superviz/sdk/comments-component/matterport-adapter"),this.isActive=!1,this.pins=new Map,this.divWrapper=this.createDivWrapper(),this.matterportSdk.Asset.registerTexture("pointer","https://production.cdn.superviz.com/static/pin-add.png"),this.createInputListener(),document.body.addEventListener("select-annotation",this.annotationSelected),document.body.addEventListener("toggle-annotation-sidebar",this.onToggleAnnotationSidebar),document.body.style.position="relative",this.onPinFixedObserver=new Gwe,this.annotations=[],this.renderAnnotationsPins(),this.matterportSdk.Camera.pose.subscribe(r=>{this.cameraPose=r,(this.isActive||this.isPinsVisible)&&this.renderAnnotationsPins()}),this.showcaseSides=this.showcaseDiv.getBoundingClientRect()}destroy(){this.removeAnnotationsPins(),this.removeListeners()}setActive(e){if(this.isActive=e,this.isActive){this.addListeners(),this.matterportSdk.Pointer.editTexture("pointer");return}this.matterportSdk.Pointer.resetTexture()}setPinsVisibility(e){if(this.isPinsVisible=e,this.isPinsVisible){this.renderAnnotationsPins();return}this.removeAnnotationsPins()}updateAnnotations(e){this.logger.log("updateAnnotations",e),this.annotations=e,!(!this.isActive&&!this.isPinsVisible)&&this.renderAnnotationsPins()}removeAnnotationPin(e){let t=this.pins.get(e);!t||(t.remove(),this.pins.delete(e),this.annotations=this.annotations.filter(r=>r.uuid!==e))}createTemporaryPin(e){let t=document.getElementById("superviz-temporary-pin");this.temporaryPinCoordinates=e,t||(t=document.createElement("superviz-comments-annotation-pin"),t.id="superviz-temporary-pin",t.setAttribute("type","add"),t.setAttribute("showInput",""),t.setAttribute("containerSides",JSON.stringify(this.showcaseSides)),t.setAttribute("commentsSide",this.commentsSide),t.setAttribute("participantsList",JSON.stringify(this.participants)),t.setAttribute("position",JSON.stringify(this.temporaryPinCoordinates)),t.setAttribute("annotation",JSON.stringify({})),t.setAttributeNode(document.createAttribute("active")));let r=this.showcaseDiv,{width:n,height:l}=r.getBoundingClientRect(),c=this.position3DToScreen(e,n,l,0,-32),h={x:c.left,y:c.top,type:e.type};t.setAttribute("position",JSON.stringify(h)),this.divWrapper.appendChild(t),this.pins.set("temporary-pin",t)}addListeners(){this.intersectionObserver=this.matterportSdk.Pointer.intersection.subscribe(e=>{this.intersection=e}),this.inputComponent.inputs.eventsEnabled=!0,this.inputComponent.inputs.userNavigationEnabled=!1,document.body.addEventListener("keyup",this.resetPins),document.body.addEventListener("click",this.hideTemporaryPin)}removeListeners(){var e;document.body.removeEventListener("select-annotation",this.annotationSelected),document.body.removeEventListener("toggle-annotation-sidebar",this.onToggleAnnotationSidebar),(e=this.intersectionObserver)==null||e.cancel(),this.inputComponent.inputs.eventsEnabled=!1,this.inputComponent.inputs.userNavigationEnabled=!0,document.body.removeEventListener("keyup",this.resetPins),document.body.removeEventListener("click",this.hideTemporaryPin)}renderAnnotationsPins(){return xo(this,null,function*(){this.annotations.forEach(t=>xo(this,null,function*(){let r=JSON.parse(t.position).position;if((r==null?void 0:r.type)!=="matterport"||t.resolved)return;this.pins.has(t.uuid)||this.createPin(t,r);let{width:n,height:l}=this.showcaseDiv.getBoundingClientRect(),c=this.position3DToScreen(r,n,l,0,-32),h=yield this.checkIsVisible(c,r),d=this.pins.get(t.uuid);h?(d.setAttribute("style","opacity: 1"),this.pins.get(t.uuid).setAttribute("position",JSON.stringify({x:c.left,y:c.top}))):d.setAttribute("style","opacity: 0")}));let e=this.pins.get("temporary-pin");if(e){let{width:t,height:r}=this.showcaseDiv.getBoundingClientRect(),n=this.position3DToScreen(this.temporaryPinCoordinates,t,r,0,-32);(yield this.checkIsVisible(n,this.temporaryPinCoordinates))?(e.setAttribute("style","opacity: 1"),e.setAttribute("position",JSON.stringify({x:n.left,y:n.top}))):e.setAttribute("style","opacity: 0")}})}createPin(e,t){let{width:r,height:n}=this.showcaseDiv.getBoundingClientRect(),l=this.position3DToScreen(t,r,n,0,-32),c=document.createElement("superviz-comments-annotation-pin");this.divWrapper.appendChild(c),c.setAttribute("type","show"),c.setAttribute("annotation",JSON.stringify(e)),c.setAttribute("position",JSON.stringify({x:l.left,y:l.top})),c.setAttribute("participantsList",JSON.stringify(this.participants)),this.pins.set(e.uuid,c)}removeAnnotationsPins(){this.pins.forEach(e=>{e.remove()}),this.pins.clear()}set participantsList(e){this.participants=e}resetSelectedPin(){!this.selectedPin||(this.selectedPin.removeAttribute("active"),this.selectedPin=null)}moveToSweep(e,t){this.isSweeping||(this.isSweeping=!0,this.matterportSdk.Sweep.moveTo(e,{transitionTime:500,transition:this.matterportSdk.Sweep.Transition.FLY,rotation:t}).finally(()=>{this.isSweeping=!1}))}createDivWrapper(){let e=this.showcaseDiv.getBoundingClientRect(),t=document.createElement("div");return this.showcaseDiv.parentElement.style.position="relative",t.style.position="fixed",t.style.top=`${e.top}px`,t.style.left=`${e.left}px`,t.style.width=`${e.width}px`,t.style.height=`${e.height}px`,t.style.pointerEvents="none",t.style.overflow="hidden",this.divWrapperReplacementInterval||(this.divWrapperReplacementInterval=setInterval(()=>{let r=this.showcaseDiv.getBoundingClientRect();t.style.top=`${r.top}px`,t.style.left=`${r.left}px`,t.style.width=`${r.width}px`,t.style.height=`${r.height}px`},1)),this.showcaseDiv.parentElement.appendChild(t),t}createInputListener(){return xo(this,null,function*(){let[e]=yield this.matterportSdk.Scene.createObjects(1),t=e.addNode();this.inputComponent=t.addComponent("mp.input",{eventsEnabled:!1,userNavigationEnabled:!0}),t.start(),this.inputComponent.spyOnEvent(new qwe)})}position3DToScreen(e,t,r,n,l){let c={w:t,h:r},h=this.matterportSdk.Conversion.worldToScreen(e,this.cameraPose,c);return{top:Math.abs(h.y)+l,left:Math.abs(h.x)+n}}checkIsVisible(e,t){return xo(this,null,function*(){let r=new Mt(t.x,t.y,t.z),n=yield this.matterportSdk.Renderer.getWorldPositionData({x:e.left,y:e.top});return!n||!n.position?!1:new Mt(n.position.x,n.position.y,n.position.z).distanceTo(r)<3})}};window.Presence3D=Wwe;window.MatterportPin=Xwe;/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 *//**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var Zwe={},Jwe=Object.create,KB=Object.defineProperty,Ywe=Object.defineProperties,Kwe=Object.getOwnPropertyDescriptor,Qwe=Object.getOwnPropertyDescriptors,eSe=Object.getOwnPropertyNames,pW=Object.getOwnPropertySymbols,tSe=Object.getPrototypeOf,KJ=Object.prototype.hasOwnProperty,iSe=Object.prototype.propertyIsEnumerable,QJ=Math.pow,mW=(i,e,t)=>e in i?KB(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,iR=(i,e)=>{for(var t in e||(e={}))KJ.call(e,t)&&mW(i,t,e[t]);if(pW)for(var t of pW(e))iSe.call(e,t)&&mW(i,t,e[t]);return i},rSe=(i,e)=>Ywe(i,Qwe(e)),Ua=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),nSe=(i,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of eSe(e))!KJ.call(i,n)&&n!==t&&KB(i,n,{get:()=>e[n],enumerable:!(r=Kwe(e,n))||r.enumerable});return i},QB=(i,e,t)=>(t=i!=null?Jwe(tSe(i)):{},nSe(e||!i||!i.__esModule?KB(t,"default",{value:i,enumerable:!0}):t,i)),Wa=(i,e,t)=>new Promise((r,n)=>{var l=d=>{try{h(t.next(d))}catch(f){n(f)}},c=d=>{try{h(t.throw(d))}catch(f){n(f)}},h=d=>d.done?r(d.value):Promise.resolve(d.value).then(l,c);h((t=t.apply(i,e)).next())}),sSe=Ua((i,e)=>{(function(){var t,r="4.17.21",n=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",c="Expected a function",h="Invalid `variable` option passed into `_.template`",d="__lodash_hash_undefined__",f=500,m="__lodash_placeholder__",g=1,y=2,_=4,b=1,S=2,E=1,T=2,A=4,P=8,O=16,R=32,D=64,L=128,N=256,U=512,F=30,z="...",G=800,J=16,Z=1,q=2,$=3,H=1/0,X=9007199254740991,re=17976931348623157e292,ae=NaN,he=4294967295,pe=he-1,de=he>>>1,ee=[["ary",L],["bind",E],["bindKey",T],["curry",P],["curryRight",O],["flip",U],["partial",R],["partialRight",D],["rearg",N]],se="[object Arguments]",Y="[object Array]",fe="[object AsyncFunction]",me="[object Boolean]",De="[object Date]",Le="[object DOMException]",Ce="[object Error]",Ae="[object Function]",Ue="[object GeneratorFunction]",Ne="[object Map]",Ge="[object Number]",Ct="[object Null]",it="[object Object]",bt="[object Promise]",Kt="[object Proxy]",kt="[object RegExp]",Pt="[object Set]",_e="[object String]",ce="[object Symbol]",Fe="[object Undefined]",et="[object WeakMap]",Dt="[object WeakSet]",gt="[object ArrayBuffer]",xe="[object DataView]",we="[object Float32Array]",Ve="[object Float64Array]",ut="[object Int8Array]",lt="[object Int16Array]",Ee="[object Int32Array]",_t="[object Uint8Array]",wt="[object Uint8ClampedArray]",Xt="[object Uint16Array]",Ft="[object Uint32Array]",gi=/\b__p \+= '';/g,Rt=/\b(__p \+=) '' \+/g,ci=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ji=/&(?:amp|lt|gt|quot|#39);/g,Ji=/[&<>"']/g,ws=RegExp(ji.source),Jn=RegExp(Ji.source),ao=/<%-([\s\S]+?)%>/g,oo=/<%([\s\S]+?)%>/g,lo=/<%=([\s\S]+?)%>/g,uo=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,vu=/^\w*$/,yu=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ls=/[\\^$.*+?()[\]{}|]/g,_u=RegExp(Ls.source),ye=/^\s+/,je=/\s/,tt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,qe=/\{\n\/\* \[wrapped with (.+)\] \*/,st=/,? & /,si=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ci=/[()=,{}\[\]\/\s]/,yi=/\\(\\)?/g,Xi=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,xr=/\w*$/,Yi=/^[-+]0x[0-9a-f]+$/i,Ki=/^0b[01]+$/i,tn=/^\[object .+?Constructor\]$/,Us=/^0o[0-7]+$/i,co=/^(?:0|[1-9]\d*)$/,Po=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Q=/($^)/,le=/['\n\r\u2028\u2029\\]/g,oe="\\ud800-\\udfff",ve="\\u0300-\\u036f",ke="\\ufe20-\\ufe2f",Oe="\\u20d0-\\u20ff",Je=ve+ke+Oe,mt="\\u2700-\\u27bf",vt="a-z\\xdf-\\xf6\\xf8-\\xff",ct="\\xac\\xb1\\xd7\\xf7",It="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Ht="\\u2000-\\u206f",qi=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ui="A-Z\\xc0-\\xd6\\xd8-\\xde",Ai="\\ufe0e\\ufe0f",Pr=ct+It+Ht+qi,Rr="['’]",Kr="["+oe+"]",or="["+Pr+"]",ui="["+Je+"]",pn="\\d+",_r="["+mt+"]",br="["+vt+"]",jr="[^"+oe+Pr+pn+mt+vt+Ui+"]",Gr="\\ud83c[\\udffb-\\udfff]",Ss="(?:"+ui+"|"+Gr+")",fn="[^"+oe+"]",Qr="(?:\\ud83c[\\udde6-\\uddff]){2}",Yn="[\\ud800-\\udbff][\\udc00-\\udfff]",Vr="["+Ui+"]",xu="\\u200d",Os="(?:"+br+"|"+jr+")",Lf="(?:"+Vr+"|"+jr+")",Hs="(?:"+Rr+"(?:d|ll|m|re|s|t|ve))?",ho="(?:"+Rr+"(?:D|LL|M|RE|S|T|VE))?",Ro=Ss+"?",Io="["+Ai+"]?",Of="(?:"+xu+"(?:"+[fn,Qr,Yn].join("|")+")"+Io+Ro+")*",Nf="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",og="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",uc=Io+Ro+Of,lg="(?:"+[_r,Qr,Yn].join("|")+")"+uc,ug="(?:"+[fn+ui+"?",ui,Qr,Yn,Kr].join("|")+")",cg=RegExp(Rr,"g"),hg=RegExp(ui,"g"),Lo=RegExp(Gr+"(?="+Gr+")|"+ug+uc,"g"),dg=RegExp([Vr+"?"+br+"+"+Hs+"(?="+[or,Vr,"$"].join("|")+")",Lf+"+"+ho+"(?="+[or,Vr+Os,"$"].join("|")+")",Vr+"?"+Os+"+"+Hs,Vr+"+"+ho,og,Nf,pn,lg].join("|"),"g"),fg=RegExp("["+xu+oe+Je+Ai+"]"),pg=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,mg=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],gg=-1,yt={};yt[we]=yt[Ve]=yt[ut]=yt[lt]=yt[Ee]=yt[_t]=yt[wt]=yt[Xt]=yt[Ft]=!0,yt[se]=yt[Y]=yt[gt]=yt[me]=yt[xe]=yt[De]=yt[Ce]=yt[Ae]=yt[Ne]=yt[Ge]=yt[it]=yt[kt]=yt[Pt]=yt[_e]=yt[et]=!1;var pt={};pt[se]=pt[Y]=pt[gt]=pt[xe]=pt[me]=pt[De]=pt[we]=pt[Ve]=pt[ut]=pt[lt]=pt[Ee]=pt[Ne]=pt[Ge]=pt[it]=pt[kt]=pt[Pt]=pt[_e]=pt[ce]=pt[_t]=pt[wt]=pt[Xt]=pt[Ft]=!0,pt[Ce]=pt[Ae]=pt[et]=!1;var vg={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},yg={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},_g={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},xg={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},bg=parseFloat,wg=parseInt,cc=typeof global=="object"&&global&&global.Object===Object&&global,Sg=typeof self=="object"&&self&&self.Object===Object&&self,Gt=cc||Sg||Function("return this")(),Oo=typeof i=="object"&&i&&!i.nodeType&&i,rn=Oo&&typeof e=="object"&&e&&!e.nodeType&&e,hc=rn&&rn.exports===Oo,No=hc&&cc.process,Pi=function(){try{var V=rn&&rn.require&&rn.require("util").types;return V||No&&No.binding&&No.binding("util")}catch{}}(),dc=Pi&&Pi.isArrayBuffer,fc=Pi&&Pi.isDate,pc=Pi&&Pi.isMap,mc=Pi&&Pi.isRegExp,gc=Pi&&Pi.isSet,vc=Pi&&Pi.isTypedArray;function _i(V,te,K){switch(K.length){case 0:return V.call(te);case 1:return V.call(te,K[0]);case 2:return V.call(te,K[0],K[1]);case 3:return V.call(te,K[0],K[1],K[2])}return V.apply(te,K)}function Mg(V,te,K,be){for(var ze=-1,rt=V==null?0:V.length;++ze<rt;){var Bt=V[ze];te(be,Bt,K(Bt),V)}return be}function Ri(V,te){for(var K=-1,be=V==null?0:V.length;++K<be&&te(V[K],K,V)!==!1;);return V}function Eg(V,te){for(var K=V==null?0:V.length;K--&&te(V[K],K,V)!==!1;);return V}function yc(V,te){for(var K=-1,be=V==null?0:V.length;++K<be;)if(!te(V[K],K,V))return!1;return!0}function Ir(V,te){for(var K=-1,be=V==null?0:V.length,ze=0,rt=[];++K<be;){var Bt=V[K];te(Bt,K,V)&&(rt[ze++]=Bt)}return rt}function $s(V,te){var K=V==null?0:V.length;return!!K&&En(V,te,0)>-1}function Do(V,te,K){for(var be=-1,ze=V==null?0:V.length;++be<ze;)if(K(te,V[be]))return!0;return!1}function xt(V,te){for(var K=-1,be=V==null?0:V.length,ze=Array(be);++K<be;)ze[K]=te(V[K],K,V);return ze}function Lr(V,te){for(var K=-1,be=te.length,ze=V.length;++K<be;)V[ze+K]=te[K];return V}function ko(V,te,K,be){var ze=-1,rt=V==null?0:V.length;for(be&&rt&&(K=V[++ze]);++ze<rt;)K=te(K,V[ze],ze,V);return K}function Tg(V,te,K,be){var ze=V==null?0:V.length;for(be&&ze&&(K=V[--ze]);ze--;)K=te(K,V[ze],ze,V);return K}function Fo(V,te){for(var K=-1,be=V==null?0:V.length;++K<be;)if(te(V[K],K,V))return!0;return!1}var Ag=zo("length");function Cg(V){return V.split("")}function Pg(V){return V.match(si)||[]}function _c(V,te,K){var be;return K(V,function(ze,rt,Bt){if(te(ze,rt,Bt))return be=rt,!1}),be}function Vs(V,te,K,be){for(var ze=V.length,rt=K+(be?1:-1);be?rt--:++rt<ze;)if(te(V[rt],rt,V))return rt;return-1}function En(V,te,K){return te===te?Hg(V,te,K):Vs(V,xc,K)}function Rg(V,te,K,be){for(var ze=K-1,rt=V.length;++ze<rt;)if(be(V[ze],te))return ze;return-1}function xc(V){return V!==V}function bc(V,te){var K=V==null?0:V.length;return K?Uo(V,te)/K:ae}function zo(V){return function(te){return te==null?t:te[V]}}function Bo(V){return function(te){return V==null?t:V[te]}}function wc(V,te,K,be,ze){return ze(V,function(rt,Bt,dt){K=be?(be=!1,rt):te(K,rt,Bt,dt)}),K}function Ig(V,te){var K=V.length;for(V.sort(te);K--;)V[K]=V[K].value;return V}function Uo(V,te){for(var K,be=-1,ze=V.length;++be<ze;){var rt=te(V[be]);rt!==t&&(K=K===t?rt:K+rt)}return K}function Ho(V,te){for(var K=-1,be=Array(V);++K<V;)be[K]=te(K);return be}function Lg(V,te){return xt(te,function(K){return[K,V[K]]})}function Sc(V){return V&&V.slice(0,Ac(V)+1).replace(ye,"")}function xi(V){return function(te){return V(te)}}function $o(V,te){return xt(te,function(K){return V[K]})}function Kn(V,te){return V.has(te)}function Mc(V,te){for(var K=-1,be=V.length;++K<be&&En(te,V[K],0)>-1;);return K}function Ec(V,te){for(var K=V.length;K--&&En(te,V[K],0)>-1;);return K}function Og(V,te){for(var K=V.length,be=0;K--;)V[K]===te&&++be;return be}var Ng=Bo(vg),Dg=Bo(yg);function kg(V){return"\\"+xg[V]}function Fg(V,te){return V==null?t:V[te]}function Tn(V){return fg.test(V)}function zg(V){return pg.test(V)}function Bg(V){for(var te,K=[];!(te=V.next()).done;)K.push(te.value);return K}function Vo(V){var te=-1,K=Array(V.size);return V.forEach(function(be,ze){K[++te]=[ze,be]}),K}function Tc(V,te){return function(K){return V(te(K))}}function Or(V,te){for(var K=-1,be=V.length,ze=0,rt=[];++K<be;){var Bt=V[K];(Bt===te||Bt===m)&&(V[K]=m,rt[ze++]=K)}return rt}function Ws(V){var te=-1,K=Array(V.size);return V.forEach(function(be){K[++te]=be}),K}function Ug(V){var te=-1,K=Array(V.size);return V.forEach(function(be){K[++te]=[be,be]}),K}function Hg(V,te,K){for(var be=K-1,ze=V.length;++be<ze;)if(V[be]===te)return be;return-1}function $g(V,te,K){for(var be=K+1;be--;)if(V[be]===te)return be;return be}function An(V){return Tn(V)?Wg(V):Ag(V)}function Hi(V){return Tn(V)?jg(V):Cg(V)}function Ac(V){for(var te=V.length;te--&&je.test(V.charAt(te)););return te}var Vg=Bo(_g);function Wg(V){for(var te=Lo.lastIndex=0;Lo.test(V);)++te;return te}function jg(V){return V.match(Lo)||[]}function Gg(V){return V.match(dg)||[]}var qg=function V(te){te=te==null?Gt:qr.defaults(Gt.Object(),te,qr.pick(Gt,mg));var K=te.Array,be=te.Date,ze=te.Error,rt=te.Function,Bt=te.Math,dt=te.Object,Wo=te.RegExp,Xg=te.String,Ii=te.TypeError,js=K.prototype,Zg=rt.prototype,Cn=dt.prototype,Gs=te["__core-js_shared__"],qs=Zg.toString,ot=Cn.hasOwnProperty,Jg=0,Cc=function(){var a=/[^.]+$/.exec(Gs&&Gs.keys&&Gs.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}(),Xs=Cn.toString,Yg=qs.call(dt),Kg=Gt._,Qg=Wo("^"+qs.call(ot).replace(Ls,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Zs=hc?te.Buffer:t,Nr=te.Symbol,Js=te.Uint8Array,Pc=Zs?Zs.allocUnsafe:t,Ys=Tc(dt.getPrototypeOf,dt),Rc=dt.create,Ic=Cn.propertyIsEnumerable,Ks=js.splice,Lc=Nr?Nr.isConcatSpreadable:t,Qn=Nr?Nr.iterator:t,nn=Nr?Nr.toStringTag:t,Qs=function(){try{var a=un(dt,"defineProperty");return a({},"",{}),a}catch{}}(),ev=te.clearTimeout!==Gt.clearTimeout&&te.clearTimeout,tv=be&&be.now!==Gt.Date.now&&be.now,iv=te.setTimeout!==Gt.setTimeout&&te.setTimeout,ea=Bt.ceil,ta=Bt.floor,jo=dt.getOwnPropertySymbols,rv=Zs?Zs.isBuffer:t,Oc=te.isFinite,nv=js.join,sv=Tc(dt.keys,dt),Ut=Bt.max,ei=Bt.min,av=be.now,ov=te.parseInt,Nc=Bt.random,lv=js.reverse,Go=un(te,"DataView"),es=un(te,"Map"),qo=un(te,"Promise"),Pn=un(te,"Set"),ts=un(te,"WeakMap"),is=un(dt,"create"),ia=ts&&new ts,Rn={},uv=cn(Go),cv=cn(es),hv=cn(qo),dv=cn(Pn),fv=cn(ts),ra=Nr?Nr.prototype:t,rs=ra?ra.valueOf:t,Dc=ra?ra.toString:t;function C(a){if(Tt(a)&&!Be(a)&&!(a instanceof Ye)){if(a instanceof Li)return a;if(ot.call(a,"__wrapped__"))return kh(a)}return new Li(a)}var In=function(){function a(){}return function(u){if(!St(u))return{};if(Rc)return Rc(u);a.prototype=u;var p=new a;return a.prototype=t,p}}();function na(){}function Li(a,u){this.__wrapped__=a,this.__actions__=[],this.__chain__=!!u,this.__index__=0,this.__values__=t}C.templateSettings={escape:ao,evaluate:oo,interpolate:lo,variable:"",imports:{_:C}},C.prototype=na.prototype,C.prototype.constructor=C,Li.prototype=In(na.prototype),Li.prototype.constructor=Li;function Ye(a){this.__wrapped__=a,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=he,this.__views__=[]}function pv(){var a=new Ye(this.__wrapped__);return a.__actions__=hi(this.__actions__),a.__dir__=this.__dir__,a.__filtered__=this.__filtered__,a.__iteratees__=hi(this.__iteratees__),a.__takeCount__=this.__takeCount__,a.__views__=hi(this.__views__),a}function mv(){if(this.__filtered__){var a=new Ye(this);a.__dir__=-1,a.__filtered__=!0}else a=this.clone(),a.__dir__*=-1;return a}function gv(){var a=this.__wrapped__.value(),u=this.__dir__,p=Be(a),x=u<0,M=p?a.length:0,I=Cy(0,M,this.__views__),k=I.start,B=I.end,W=B-k,ie=x?B:k-1,ne=this.__iteratees__,ue=ne.length,ge=0,Me=ei(W,this.__takeCount__);if(!p||!x&&M==W&&Me==W)return sh(a,this.__actions__);var Re=[];e:for(;W--&&ge<Me;){ie+=u;for(var $e=-1,Ie=a[ie];++$e<ue;){var Xe=ne[$e],Ke=Xe.iteratee,Si=Xe.type,li=Ke(Ie);if(Si==q)Ie=li;else if(!li){if(Si==Z)continue e;break e}}Re[ge++]=Ie}return Re}Ye.prototype=In(na.prototype),Ye.prototype.constructor=Ye;function sn(a){var u=-1,p=a==null?0:a.length;for(this.clear();++u<p;){var x=a[u];this.set(x[0],x[1])}}function vv(){this.__data__=is?is(null):{},this.size=0}function yv(a){var u=this.has(a)&&delete this.__data__[a];return this.size-=u?1:0,u}function _v(a){var u=this.__data__;if(is){var p=u[a];return p===d?t:p}return ot.call(u,a)?u[a]:t}function xv(a){var u=this.__data__;return is?u[a]!==t:ot.call(u,a)}function bv(a,u){var p=this.__data__;return this.size+=this.has(a)?0:1,p[a]=is&&u===t?d:u,this}sn.prototype.clear=vv,sn.prototype.delete=yv,sn.prototype.get=_v,sn.prototype.has=xv,sn.prototype.set=bv;function ur(a){var u=-1,p=a==null?0:a.length;for(this.clear();++u<p;){var x=a[u];this.set(x[0],x[1])}}function wv(){this.__data__=[],this.size=0}function Sv(a){var u=this.__data__,p=sa(u,a);if(p<0)return!1;var x=u.length-1;return p==x?u.pop():Ks.call(u,p,1),--this.size,!0}function Mv(a){var u=this.__data__,p=sa(u,a);return p<0?t:u[p][1]}function Ev(a){return sa(this.__data__,a)>-1}function Tv(a,u){var p=this.__data__,x=sa(p,a);return x<0?(++this.size,p.push([a,u])):p[x][1]=u,this}ur.prototype.clear=wv,ur.prototype.delete=Sv,ur.prototype.get=Mv,ur.prototype.has=Ev,ur.prototype.set=Tv;function cr(a){var u=-1,p=a==null?0:a.length;for(this.clear();++u<p;){var x=a[u];this.set(x[0],x[1])}}function Av(){this.size=0,this.__data__={hash:new sn,map:new(es||ur),string:new sn}}function Cv(a){var u=va(this,a).delete(a);return this.size-=u?1:0,u}function Pv(a){return va(this,a).get(a)}function Rv(a){return va(this,a).has(a)}function Iv(a,u){var p=va(this,a),x=p.size;return p.set(a,u),this.size+=p.size==x?0:1,this}cr.prototype.clear=Av,cr.prototype.delete=Cv,cr.prototype.get=Pv,cr.prototype.has=Rv,cr.prototype.set=Iv;function an(a){var u=-1,p=a==null?0:a.length;for(this.__data__=new cr;++u<p;)this.add(a[u])}function Lv(a){return this.__data__.set(a,d),this}function Ov(a){return this.__data__.has(a)}an.prototype.add=an.prototype.push=Lv,an.prototype.has=Ov;function $i(a){var u=this.__data__=new ur(a);this.size=u.size}function Nv(){this.__data__=new ur,this.size=0}function Dv(a){var u=this.__data__,p=u.delete(a);return this.size=u.size,p}function kv(a){return this.__data__.get(a)}function Fv(a){return this.__data__.has(a)}function zv(a,u){var p=this.__data__;if(p instanceof ur){var x=p.__data__;if(!es||x.length<n-1)return x.push([a,u]),this.size=++p.size,this;p=this.__data__=new cr(x)}return p.set(a,u),this.size=p.size,this}$i.prototype.clear=Nv,$i.prototype.delete=Dv,$i.prototype.get=kv,$i.prototype.has=Fv,$i.prototype.set=zv;function kc(a,u){var p=Be(a),x=!p&&hn(a),M=!p&&!x&&Br(a),I=!p&&!x&&!M&&Dn(a),k=p||x||M||I,B=k?Ho(a.length,Xg):[],W=B.length;for(var ie in a)(u||ot.call(a,ie))&&!(k&&(ie=="length"||M&&(ie=="offset"||ie=="parent")||I&&(ie=="buffer"||ie=="byteLength"||ie=="byteOffset")||pr(ie,W)))&&B.push(ie);return B}function Fc(a){var u=a.length;return u?a[nl(0,u-1)]:t}function Bv(a,u){return ya(hi(a),on(u,0,a.length))}function Uv(a){return ya(hi(a))}function Xo(a,u,p){(p!==t&&!Vi(a[u],p)||p===t&&!(u in a))&&hr(a,u,p)}function ns(a,u,p){var x=a[u];(!(ot.call(a,u)&&Vi(x,p))||p===t&&!(u in a))&&hr(a,u,p)}function sa(a,u){for(var p=a.length;p--;)if(Vi(a[p][0],u))return p;return-1}function Hv(a,u,p,x){return Dr(a,function(M,I,k){u(x,M,p(M),k)}),x}function zc(a,u){return a&&er(u,Wt(u),a)}function $v(a,u){return a&&er(u,fi(u),a)}function hr(a,u,p){u=="__proto__"&&Qs?Qs(a,u,{configurable:!0,enumerable:!0,value:p,writable:!0}):a[u]=p}function Zo(a,u){for(var p=-1,x=u.length,M=K(x),I=a==null;++p<x;)M[p]=I?t:Pl(a,u[p]);return M}function on(a,u,p){return a===a&&(p!==t&&(a=a<=p?a:p),u!==t&&(a=a>=u?a:u)),a}function Oi(a,u,p,x,M,I){var k,B=u&g,W=u&y,ie=u&_;if(p&&(k=M?p(a,x,M,I):p(a)),k!==t)return k;if(!St(a))return a;var ne=Be(a);if(ne){if(k=Ry(a),!B)return hi(a,k)}else{var ue=ti(a),ge=ue==Ae||ue==Ue;if(Br(a))return lh(a,B);if(ue==it||ue==se||ge&&!M){if(k=W||ge?{}:Ah(a),!B)return W?_y(a,$v(k,a)):yy(a,zc(k,a))}else{if(!pt[ue])return M?a:{};k=Iy(a,ue,B)}}I||(I=new $i);var Me=I.get(a);if(Me)return Me;I.set(a,k),id(a)?a.forEach(function(Ie){k.add(Oi(Ie,u,p,Ie,a,I))}):ed(a)&&a.forEach(function(Ie,Xe){k.set(Xe,Oi(Ie,u,p,Xe,a,I))});var Re=ie?W?ml:pl:W?fi:Wt,$e=ne?t:Re(a);return Ri($e||a,function(Ie,Xe){$e&&(Xe=Ie,Ie=a[Xe]),ns(k,Xe,Oi(Ie,u,p,Xe,a,I))}),k}function Vv(a){var u=Wt(a);return function(p){return Bc(p,a,u)}}function Bc(a,u,p){var x=p.length;if(a==null)return!x;for(a=dt(a);x--;){var M=p[x],I=u[M],k=a[M];if(k===t&&!(M in a)||!I(k))return!1}return!0}function Uc(a,u,p){if(typeof a!="function")throw new Ii(c);return hs(function(){a.apply(t,p)},u)}function ss(a,u,p,x){var M=-1,I=$s,k=!0,B=a.length,W=[],ie=u.length;if(!B)return W;p&&(u=xt(u,xi(p))),x?(I=Do,k=!1):u.length>=n&&(I=Kn,k=!1,u=new an(u));e:for(;++M<B;){var ne=a[M],ue=p==null?ne:p(ne);if(ne=x||ne!==0?ne:0,k&&ue===ue){for(var ge=ie;ge--;)if(u[ge]===ue)continue e;W.push(ne)}else I(u,ue,x)||W.push(ne)}return W}var Dr=fh(Qi),Hc=fh(Yo,!0);function Wv(a,u){var p=!0;return Dr(a,function(x,M,I){return p=!!u(x,M,I),p}),p}function aa(a,u,p){for(var x=-1,M=a.length;++x<M;){var I=a[x],k=u(I);if(k!=null&&(B===t?k===k&&!wi(k):p(k,B)))var B=k,W=I}return W}function jv(a,u,p,x){var M=a.length;for(p=He(p),p<0&&(p=-p>M?0:M+p),x=x===t||x>M?M:He(x),x<0&&(x+=M),x=p>x?0:nd(x);p<x;)a[p++]=u;return a}function $c(a,u){var p=[];return Dr(a,function(x,M,I){u(x,M,I)&&p.push(x)}),p}function Zt(a,u,p,x,M){var I=-1,k=a.length;for(p||(p=Oy),M||(M=[]);++I<k;){var B=a[I];u>0&&p(B)?u>1?Zt(B,u-1,p,x,M):Lr(M,B):x||(M[M.length]=B)}return M}var Jo=ph(),Vc=ph(!0);function Qi(a,u){return a&&Jo(a,u,Wt)}function Yo(a,u){return a&&Vc(a,u,Wt)}function oa(a,u){return Ir(u,function(p){return mr(a[p])})}function ln(a,u){u=Fr(u,a);for(var p=0,x=u.length;a!=null&&p<x;)a=a[tr(u[p++])];return p&&p==x?a:t}function Wc(a,u,p){var x=u(a);return Be(a)?x:Lr(x,p(a))}function ai(a){return a==null?a===t?Fe:Ct:nn&&nn in dt(a)?Ay(a):Uy(a)}function Ko(a,u){return a>u}function Gv(a,u){return a!=null&&ot.call(a,u)}function qv(a,u){return a!=null&&u in dt(a)}function Xv(a,u,p){return a>=ei(u,p)&&a<Ut(u,p)}function Qo(a,u,p){for(var x=p?Do:$s,M=a[0].length,I=a.length,k=I,B=K(I),W=1/0,ie=[];k--;){var ne=a[k];k&&u&&(ne=xt(ne,xi(u))),W=ei(ne.length,W),B[k]=!p&&(u||M>=120&&ne.length>=120)?new an(k&&ne):t}ne=a[0];var ue=-1,ge=B[0];e:for(;++ue<M&&ie.length<W;){var Me=ne[ue],Re=u?u(Me):Me;if(Me=p||Me!==0?Me:0,!(ge?Kn(ge,Re):x(ie,Re,p))){for(k=I;--k;){var $e=B[k];if(!($e?Kn($e,Re):x(a[k],Re,p)))continue e}ge&&ge.push(Re),ie.push(Me)}}return ie}function Zv(a,u,p,x){return Qi(a,function(M,I,k){u(x,p(M),I,k)}),x}function as(a,u,p){u=Fr(u,a),a=Ih(a,u);var x=a==null?a:a[tr(Di(u))];return x==null?t:_i(x,a,p)}function jc(a){return Tt(a)&&ai(a)==se}function Jv(a){return Tt(a)&&ai(a)==gt}function Yv(a){return Tt(a)&&ai(a)==De}function os(a,u,p,x,M){return a===u?!0:a==null||u==null||!Tt(a)&&!Tt(u)?a!==a&&u!==u:Kv(a,u,p,x,os,M)}function Kv(a,u,p,x,M,I){var k=Be(a),B=Be(u),W=k?Y:ti(a),ie=B?Y:ti(u);W=W==se?it:W,ie=ie==se?it:ie;var ne=W==it,ue=ie==it,ge=W==ie;if(ge&&Br(a)){if(!Br(u))return!1;k=!0,ne=!1}if(ge&&!ne)return I||(I=new $i),k||Dn(a)?Mh(a,u,p,x,M,I):Ey(a,u,W,p,x,M,I);if(!(p&b)){var Me=ne&&ot.call(a,"__wrapped__"),Re=ue&&ot.call(u,"__wrapped__");if(Me||Re){var $e=Me?a.value():a,Ie=Re?u.value():u;return I||(I=new $i),M($e,Ie,p,x,I)}}return ge?(I||(I=new $i),Ty(a,u,p,x,M,I)):!1}function Qv(a){return Tt(a)&&ti(a)==Ne}function el(a,u,p,x){var M=p.length,I=M,k=!x;if(a==null)return!I;for(a=dt(a);M--;){var B=p[M];if(k&&B[2]?B[1]!==a[B[0]]:!(B[0]in a))return!1}for(;++M<I;){B=p[M];var W=B[0],ie=a[W],ne=B[1];if(k&&B[2]){if(ie===t&&!(W in a))return!1}else{var ue=new $i;if(x)var ge=x(ie,ne,W,a,u,ue);if(!(ge===t?os(ne,ie,b|S,x,ue):ge))return!1}}return!0}function Gc(a){if(!St(a)||Dy(a))return!1;var u=mr(a)?Qg:tn;return u.test(cn(a))}function ey(a){return Tt(a)&&ai(a)==kt}function ty(a){return Tt(a)&&ti(a)==Pt}function iy(a){return Tt(a)&&Ma(a.length)&&!!yt[ai(a)]}function qc(a){return typeof a=="function"?a:a==null?pi:typeof a=="object"?Be(a)?Jc(a[0],a[1]):Zc(a):md(a)}function tl(a){if(!cs(a))return sv(a);var u=[];for(var p in dt(a))ot.call(a,p)&&p!="constructor"&&u.push(p);return u}function ry(a){if(!St(a))return By(a);var u=cs(a),p=[];for(var x in a)x=="constructor"&&(u||!ot.call(a,x))||p.push(x);return p}function il(a,u){return a<u}function Xc(a,u){var p=-1,x=di(a)?K(a.length):[];return Dr(a,function(M,I,k){x[++p]=u(M,I,k)}),x}function Zc(a){var u=vl(a);return u.length==1&&u[0][2]?Ph(u[0][0],u[0][1]):function(p){return p===a||el(p,a,u)}}function Jc(a,u){return _l(a)&&Ch(u)?Ph(tr(a),u):function(p){var x=Pl(p,a);return x===t&&x===u?Rl(p,a):os(u,x,b|S)}}function la(a,u,p,x,M){a!==u&&Jo(u,function(I,k){if(M||(M=new $i),St(I))ny(a,u,k,p,la,x,M);else{var B=x?x(bl(a,k),I,k+"",a,u,M):t;B===t&&(B=I),Xo(a,k,B)}},fi)}function ny(a,u,p,x,M,I,k){var B=bl(a,p),W=bl(u,p),ie=k.get(W);if(ie){Xo(a,p,ie);return}var ne=I?I(B,W,p+"",a,u,k):t,ue=ne===t;if(ue){var ge=Be(W),Me=!ge&&Br(W),Re=!ge&&!Me&&Dn(W);ne=W,ge||Me||Re?Be(B)?ne=B:Lt(B)?ne=hi(B):Me?(ue=!1,ne=lh(W,!0)):Re?(ue=!1,ne=uh(W,!0)):ne=[]:ds(W)||hn(W)?(ne=B,hn(B)?ne=sd(B):(!St(B)||mr(B))&&(ne=Ah(W))):ue=!1}ue&&(k.set(W,ne),M(ne,W,x,I,k),k.delete(W)),Xo(a,p,ne)}function Yc(a,u){var p=a.length;if(p)return u+=u<0?p:0,pr(u,p)?a[u]:t}function Kc(a,u,p){u.length?u=xt(u,function(I){return Be(I)?function(k){return ln(k,I.length===1?I[0]:I)}:I}):u=[pi];var x=-1;u=xt(u,xi(Pe()));var M=Xc(a,function(I,k,B){var W=xt(u,function(ie){return ie(I)});return{criteria:W,index:++x,value:I}});return Ig(M,function(I,k){return vy(I,k,p)})}function sy(a,u){return Qc(a,u,function(p,x){return Rl(a,x)})}function Qc(a,u,p){for(var x=-1,M=u.length,I={};++x<M;){var k=u[x],B=ln(a,k);p(B,k)&&ls(I,Fr(k,a),B)}return I}function ay(a){return function(u){return ln(u,a)}}function rl(a,u,p,x){var M=x?Rg:En,I=-1,k=u.length,B=a;for(a===u&&(u=hi(u)),p&&(B=xt(a,xi(p)));++I<k;)for(var W=0,ie=u[I],ne=p?p(ie):ie;(W=M(B,ne,W,x))>-1;)B!==a&&Ks.call(B,W,1),Ks.call(a,W,1);return a}function eh(a,u){for(var p=a?u.length:0,x=p-1;p--;){var M=u[p];if(p==x||M!==I){var I=M;pr(M)?Ks.call(a,M,1):ol(a,M)}}return a}function nl(a,u){return a+ta(Nc()*(u-a+1))}function oy(a,u,p,x){for(var M=-1,I=Ut(ea((u-a)/(p||1)),0),k=K(I);I--;)k[x?I:++M]=a,a+=p;return k}function sl(a,u){var p="";if(!a||u<1||u>X)return p;do u%2&&(p+=a),u=ta(u/2),u&&(a+=a);while(u);return p}function We(a,u){return wl(Rh(a,u,pi),a+"")}function ly(a){return Fc(kn(a))}function uy(a,u){var p=kn(a);return ya(p,on(u,0,p.length))}function ls(a,u,p,x){if(!St(a))return a;u=Fr(u,a);for(var M=-1,I=u.length,k=I-1,B=a;B!=null&&++M<I;){var W=tr(u[M]),ie=p;if(W==="__proto__"||W==="constructor"||W==="prototype")return a;if(M!=k){var ne=B[W];ie=x?x(ne,W,B):t,ie===t&&(ie=St(ne)?ne:pr(u[M+1])?[]:{})}ns(B,W,ie),B=B[W]}return a}var th=ia?function(a,u){return ia.set(a,u),a}:pi,cy=Qs?function(a,u){return Qs(a,"toString",{configurable:!0,enumerable:!1,value:Ll(u),writable:!0})}:pi;function hy(a){return ya(kn(a))}function Ni(a,u,p){var x=-1,M=a.length;u<0&&(u=-u>M?0:M+u),p=p>M?M:p,p<0&&(p+=M),M=u>p?0:p-u>>>0,u>>>=0;for(var I=K(M);++x<M;)I[x]=a[x+u];return I}function dy(a,u){var p;return Dr(a,function(x,M,I){return p=u(x,M,I),!p}),!!p}function ua(a,u,p){var x=0,M=a==null?x:a.length;if(typeof u=="number"&&u===u&&M<=de){for(;x<M;){var I=x+M>>>1,k=a[I];k!==null&&!wi(k)&&(p?k<=u:k<u)?x=I+1:M=I}return M}return al(a,u,pi,p)}function al(a,u,p,x){var M=0,I=a==null?0:a.length;if(I===0)return 0;u=p(u);for(var k=u!==u,B=u===null,W=wi(u),ie=u===t;M<I;){var ne=ta((M+I)/2),ue=p(a[ne]),ge=ue!==t,Me=ue===null,Re=ue===ue,$e=wi(ue);if(k)var Ie=x||Re;else ie?Ie=Re&&(x||ge):B?Ie=Re&&ge&&(x||!Me):W?Ie=Re&&ge&&!Me&&(x||!$e):Me||$e?Ie=!1:Ie=x?ue<=u:ue<u;Ie?M=ne+1:I=ne}return ei(I,pe)}function ih(a,u){for(var p=-1,x=a.length,M=0,I=[];++p<x;){var k=a[p],B=u?u(k):k;if(!p||!Vi(B,W)){var W=B;I[M++]=k===0?0:k}}return I}function rh(a){return typeof a=="number"?a:wi(a)?ae:+a}function bi(a){if(typeof a=="string")return a;if(Be(a))return xt(a,bi)+"";if(wi(a))return Dc?Dc.call(a):"";var u=a+"";return u=="0"&&1/a==-H?"-0":u}function kr(a,u,p){var x=-1,M=$s,I=a.length,k=!0,B=[],W=B;if(p)k=!1,M=Do;else if(I>=n){var ie=u?null:Sy(a);if(ie)return Ws(ie);k=!1,M=Kn,W=new an}else W=u?[]:B;e:for(;++x<I;){var ne=a[x],ue=u?u(ne):ne;if(ne=p||ne!==0?ne:0,k&&ue===ue){for(var ge=W.length;ge--;)if(W[ge]===ue)continue e;u&&W.push(ue),B.push(ne)}else M(W,ue,p)||(W!==B&&W.push(ue),B.push(ne))}return B}function ol(a,u){return u=Fr(u,a),a=Ih(a,u),a==null||delete a[tr(Di(u))]}function nh(a,u,p,x){return ls(a,u,p(ln(a,u)),x)}function ca(a,u,p,x){for(var M=a.length,I=x?M:-1;(x?I--:++I<M)&&u(a[I],I,a););return p?Ni(a,x?0:I,x?I+1:M):Ni(a,x?I+1:0,x?M:I)}function sh(a,u){var p=a;return p instanceof Ye&&(p=p.value()),ko(u,function(x,M){return M.func.apply(M.thisArg,Lr([x],M.args))},p)}function ll(a,u,p){var x=a.length;if(x<2)return x?kr(a[0]):[];for(var M=-1,I=K(x);++M<x;)for(var k=a[M],B=-1;++B<x;)B!=M&&(I[M]=ss(I[M]||k,a[B],u,p));return kr(Zt(I,1),u,p)}function ah(a,u,p){for(var x=-1,M=a.length,I=u.length,k={};++x<M;){var B=x<I?u[x]:t;p(k,a[x],B)}return k}function ul(a){return Lt(a)?a:[]}function cl(a){return typeof a=="function"?a:pi}function Fr(a,u){return Be(a)?a:_l(a,u)?[a]:Dh(at(a))}var fy=We;function zr(a,u,p){var x=a.length;return p=p===t?x:p,!u&&p>=x?a:Ni(a,u,p)}var oh=ev||function(a){return Gt.clearTimeout(a)};function lh(a,u){if(u)return a.slice();var p=a.length,x=Pc?Pc(p):new a.constructor(p);return a.copy(x),x}function hl(a){var u=new a.constructor(a.byteLength);return new Js(u).set(new Js(a)),u}function py(a,u){var p=u?hl(a.buffer):a.buffer;return new a.constructor(p,a.byteOffset,a.byteLength)}function my(a){var u=new a.constructor(a.source,xr.exec(a));return u.lastIndex=a.lastIndex,u}function gy(a){return rs?dt(rs.call(a)):{}}function uh(a,u){var p=u?hl(a.buffer):a.buffer;return new a.constructor(p,a.byteOffset,a.length)}function ch(a,u){if(a!==u){var p=a!==t,x=a===null,M=a===a,I=wi(a),k=u!==t,B=u===null,W=u===u,ie=wi(u);if(!B&&!ie&&!I&&a>u||I&&k&&W&&!B&&!ie||x&&k&&W||!p&&W||!M)return 1;if(!x&&!I&&!ie&&a<u||ie&&p&&M&&!x&&!I||B&&p&&M||!k&&M||!W)return-1}return 0}function vy(a,u,p){for(var x=-1,M=a.criteria,I=u.criteria,k=M.length,B=p.length;++x<k;){var W=ch(M[x],I[x]);if(W){if(x>=B)return W;var ie=p[x];return W*(ie=="desc"?-1:1)}}return a.index-u.index}function hh(a,u,p,x){for(var M=-1,I=a.length,k=p.length,B=-1,W=u.length,ie=Ut(I-k,0),ne=K(W+ie),ue=!x;++B<W;)ne[B]=u[B];for(;++M<k;)(ue||M<I)&&(ne[p[M]]=a[M]);for(;ie--;)ne[B++]=a[M++];return ne}function dh(a,u,p,x){for(var M=-1,I=a.length,k=-1,B=p.length,W=-1,ie=u.length,ne=Ut(I-B,0),ue=K(ne+ie),ge=!x;++M<ne;)ue[M]=a[M];for(var Me=M;++W<ie;)ue[Me+W]=u[W];for(;++k<B;)(ge||M<I)&&(ue[Me+p[k]]=a[M++]);return ue}function hi(a,u){var p=-1,x=a.length;for(u||(u=K(x));++p<x;)u[p]=a[p];return u}function er(a,u,p,x){var M=!p;p||(p={});for(var I=-1,k=u.length;++I<k;){var B=u[I],W=x?x(p[B],a[B],B,p,a):t;W===t&&(W=a[B]),M?hr(p,B,W):ns(p,B,W)}return p}function yy(a,u){return er(a,yl(a),u)}function _y(a,u){return er(a,Eh(a),u)}function ha(a,u){return function(p,x){var M=Be(p)?Mg:Hv,I=u?u():{};return M(p,a,Pe(x,2),I)}}function Ln(a){return We(function(u,p){var x=-1,M=p.length,I=M>1?p[M-1]:t,k=M>2?p[2]:t;for(I=a.length>3&&typeof I=="function"?(M--,I):t,k&&oi(p[0],p[1],k)&&(I=M<3?t:I,M=1),u=dt(u);++x<M;){var B=p[x];B&&a(u,B,x,I)}return u})}function fh(a,u){return function(p,x){if(p==null)return p;if(!di(p))return a(p,x);for(var M=p.length,I=u?M:-1,k=dt(p);(u?I--:++I<M)&&x(k[I],I,k)!==!1;);return p}}function ph(a){return function(u,p,x){for(var M=-1,I=dt(u),k=x(u),B=k.length;B--;){var W=k[a?B:++M];if(p(I[W],W,I)===!1)break}return u}}function xy(a,u,p){var x=u&E,M=us(a);function I(){var k=this&&this!==Gt&&this instanceof I?M:a;return k.apply(x?p:this,arguments)}return I}function mh(a){return function(u){u=at(u);var p=Tn(u)?Hi(u):t,x=p?p[0]:u.charAt(0),M=p?zr(p,1).join(""):u.slice(1);return x[a]()+M}}function On(a){return function(u){return ko(fd(dd(u).replace(cg,"")),a,"")}}function us(a){return function(){var u=arguments;switch(u.length){case 0:return new a;case 1:return new a(u[0]);case 2:return new a(u[0],u[1]);case 3:return new a(u[0],u[1],u[2]);case 4:return new a(u[0],u[1],u[2],u[3]);case 5:return new a(u[0],u[1],u[2],u[3],u[4]);case 6:return new a(u[0],u[1],u[2],u[3],u[4],u[5]);case 7:return new a(u[0],u[1],u[2],u[3],u[4],u[5],u[6])}var p=In(a.prototype),x=a.apply(p,u);return St(x)?x:p}}function by(a,u,p){var x=us(a);function M(){for(var I=arguments.length,k=K(I),B=I,W=Nn(M);B--;)k[B]=arguments[B];var ie=I<3&&k[0]!==W&&k[I-1]!==W?[]:Or(k,W);if(I-=ie.length,I<p)return xh(a,u,da,M.placeholder,t,k,ie,t,t,p-I);var ne=this&&this!==Gt&&this instanceof M?x:a;return _i(ne,this,k)}return M}function gh(a){return function(u,p,x){var M=dt(u);if(!di(u)){var I=Pe(p,3);u=Wt(u),p=function(B){return I(M[B],B,M)}}var k=a(u,p,x);return k>-1?M[I?u[k]:k]:t}}function vh(a){return fr(function(u){var p=u.length,x=p,M=Li.prototype.thru;for(a&&u.reverse();x--;){var I=u[x];if(typeof I!="function")throw new Ii(c);if(M&&!k&&ga(I)=="wrapper")var k=new Li([],!0)}for(x=k?x:p;++x<p;){I=u[x];var B=ga(I),W=B=="wrapper"?gl(I):t;W&&xl(W[0])&&W[1]==(L|P|R|N)&&!W[4].length&&W[9]==1?k=k[ga(W[0])].apply(k,W[3]):k=I.length==1&&xl(I)?k[B]():k.thru(I)}return function(){var ie=arguments,ne=ie[0];if(k&&ie.length==1&&Be(ne))return k.plant(ne).value();for(var ue=0,ge=p?u[ue].apply(this,ie):ne;++ue<p;)ge=u[ue].call(this,ge);return ge}})}function da(a,u,p,x,M,I,k,B,W,ie){var ne=u&L,ue=u&E,ge=u&T,Me=u&(P|O),Re=u&U,$e=ge?t:us(a);function Ie(){for(var Xe=arguments.length,Ke=K(Xe),Si=Xe;Si--;)Ke[Si]=arguments[Si];if(Me)var li=Nn(Ie),Mi=Og(Ke,li);if(x&&(Ke=hh(Ke,x,M,Me)),I&&(Ke=dh(Ke,I,k,Me)),Xe-=Mi,Me&&Xe<ie){var Ot=Or(Ke,li);return xh(a,u,da,Ie.placeholder,p,Ke,Ot,B,W,ie-Xe)}var Wi=ue?p:this,vr=ge?Wi[a]:a;return Xe=Ke.length,B?Ke=Hy(Ke,B):Re&&Xe>1&&Ke.reverse(),ne&&W<Xe&&(Ke.length=W),this&&this!==Gt&&this instanceof Ie&&(vr=$e||us(vr)),vr.apply(Wi,Ke)}return Ie}function yh(a,u){return function(p,x){return Zv(p,a,u(x),{})}}function fa(a,u){return function(p,x){var M;if(p===t&&x===t)return u;if(p!==t&&(M=p),x!==t){if(M===t)return x;typeof p=="string"||typeof x=="string"?(p=bi(p),x=bi(x)):(p=rh(p),x=rh(x)),M=a(p,x)}return M}}function dl(a){return fr(function(u){return u=xt(u,xi(Pe())),We(function(p){var x=this;return a(u,function(M){return _i(M,x,p)})})})}function pa(a,u){u=u===t?" ":bi(u);var p=u.length;if(p<2)return p?sl(u,a):u;var x=sl(u,ea(a/An(u)));return Tn(u)?zr(Hi(x),0,a).join(""):x.slice(0,a)}function wy(a,u,p,x){var M=u&E,I=us(a);function k(){for(var B=-1,W=arguments.length,ie=-1,ne=x.length,ue=K(ne+W),ge=this&&this!==Gt&&this instanceof k?I:a;++ie<ne;)ue[ie]=x[ie];for(;W--;)ue[ie++]=arguments[++B];return _i(ge,M?p:this,ue)}return k}function _h(a){return function(u,p,x){return x&&typeof x!="number"&&oi(u,p,x)&&(p=x=t),u=gr(u),p===t?(p=u,u=0):p=gr(p),x=x===t?u<p?1:-1:gr(x),oy(u,p,x,a)}}function ma(a){return function(u,p){return typeof u=="string"&&typeof p=="string"||(u=ki(u),p=ki(p)),a(u,p)}}function xh(a,u,p,x,M,I,k,B,W,ie){var ne=u&P,ue=ne?k:t,ge=ne?t:k,Me=ne?I:t,Re=ne?t:I;u|=ne?R:D,u&=~(ne?D:R),u&A||(u&=~(E|T));var $e=[a,u,M,Me,ue,Re,ge,B,W,ie],Ie=p.apply(t,$e);return xl(a)&&Lh(Ie,$e),Ie.placeholder=x,Oh(Ie,a,u)}function fl(a){var u=Bt[a];return function(p,x){if(p=ki(p),x=x==null?0:ei(He(x),292),x&&Oc(p)){var M=(at(p)+"e").split("e"),I=u(M[0]+"e"+(+M[1]+x));return M=(at(I)+"e").split("e"),+(M[0]+"e"+(+M[1]-x))}return u(p)}}var Sy=Pn&&1/Ws(new Pn([,-0]))[1]==H?function(a){return new Pn(a)}:Dl;function bh(a){return function(u){var p=ti(u);return p==Ne?Vo(u):p==Pt?Ug(u):Lg(u,a(u))}}function dr(a,u,p,x,M,I,k,B){var W=u&T;if(!W&&typeof a!="function")throw new Ii(c);var ie=x?x.length:0;if(ie||(u&=~(R|D),x=M=t),k=k===t?k:Ut(He(k),0),B=B===t?B:He(B),ie-=M?M.length:0,u&D){var ne=x,ue=M;x=M=t}var ge=W?t:gl(a),Me=[a,u,p,x,M,ne,ue,I,k,B];if(ge&&zy(Me,ge),a=Me[0],u=Me[1],p=Me[2],x=Me[3],M=Me[4],B=Me[9]=Me[9]===t?W?0:a.length:Ut(Me[9]-ie,0),!B&&u&(P|O)&&(u&=~(P|O)),!u||u==E)var Re=xy(a,u,p);else u==P||u==O?Re=by(a,u,B):(u==R||u==(E|R))&&!M.length?Re=wy(a,u,p,x):Re=da.apply(t,Me);var $e=ge?th:Lh;return Oh($e(Re,Me),a,u)}function wh(a,u,p,x){return a===t||Vi(a,Cn[p])&&!ot.call(x,p)?u:a}function Sh(a,u,p,x,M,I){return St(a)&&St(u)&&(I.set(u,a),la(a,u,t,Sh,I),I.delete(u)),a}function My(a){return ds(a)?t:a}function Mh(a,u,p,x,M,I){var k=p&b,B=a.length,W=u.length;if(B!=W&&!(k&&W>B))return!1;var ie=I.get(a),ne=I.get(u);if(ie&&ne)return ie==u&&ne==a;var ue=-1,ge=!0,Me=p&S?new an:t;for(I.set(a,u),I.set(u,a);++ue<B;){var Re=a[ue],$e=u[ue];if(x)var Ie=k?x($e,Re,ue,u,a,I):x(Re,$e,ue,a,u,I);if(Ie!==t){if(Ie)continue;ge=!1;break}if(Me){if(!Fo(u,function(Xe,Ke){if(!Kn(Me,Ke)&&(Re===Xe||M(Re,Xe,p,x,I)))return Me.push(Ke)})){ge=!1;break}}else if(!(Re===$e||M(Re,$e,p,x,I))){ge=!1;break}}return I.delete(a),I.delete(u),ge}function Ey(a,u,p,x,M,I,k){switch(p){case xe:if(a.byteLength!=u.byteLength||a.byteOffset!=u.byteOffset)return!1;a=a.buffer,u=u.buffer;case gt:return!(a.byteLength!=u.byteLength||!I(new Js(a),new Js(u)));case me:case De:case Ge:return Vi(+a,+u);case Ce:return a.name==u.name&&a.message==u.message;case kt:case _e:return a==u+"";case Ne:var B=Vo;case Pt:var W=x&b;if(B||(B=Ws),a.size!=u.size&&!W)return!1;var ie=k.get(a);if(ie)return ie==u;x|=S,k.set(a,u);var ne=Mh(B(a),B(u),x,M,I,k);return k.delete(a),ne;case ce:if(rs)return rs.call(a)==rs.call(u)}return!1}function Ty(a,u,p,x,M,I){var k=p&b,B=pl(a),W=B.length,ie=pl(u),ne=ie.length;if(W!=ne&&!k)return!1;for(var ue=W;ue--;){var ge=B[ue];if(!(k?ge in u:ot.call(u,ge)))return!1}var Me=I.get(a),Re=I.get(u);if(Me&&Re)return Me==u&&Re==a;var $e=!0;I.set(a,u),I.set(u,a);for(var Ie=k;++ue<W;){ge=B[ue];var Xe=a[ge],Ke=u[ge];if(x)var Si=k?x(Ke,Xe,ge,u,a,I):x(Xe,Ke,ge,a,u,I);if(!(Si===t?Xe===Ke||M(Xe,Ke,p,x,I):Si)){$e=!1;break}Ie||(Ie=ge=="constructor")}if($e&&!Ie){var li=a.constructor,Mi=u.constructor;li!=Mi&&"constructor"in a&&"constructor"in u&&!(typeof li=="function"&&li instanceof li&&typeof Mi=="function"&&Mi instanceof Mi)&&($e=!1)}return I.delete(a),I.delete(u),$e}function fr(a){return wl(Rh(a,t,Bh),a+"")}function pl(a){return Wc(a,Wt,yl)}function ml(a){return Wc(a,fi,Eh)}var gl=ia?function(a){return ia.get(a)}:Dl;function ga(a){for(var u=a.name+"",p=Rn[u],x=ot.call(Rn,u)?p.length:0;x--;){var M=p[x],I=M.func;if(I==null||I==a)return M.name}return u}function Nn(a){var u=ot.call(C,"placeholder")?C:a;return u.placeholder}function Pe(){var a=C.iteratee||Ol;return a=a===Ol?qc:a,arguments.length?a(arguments[0],arguments[1]):a}function va(a,u){var p=a.__data__;return Ny(u)?p[typeof u=="string"?"string":"hash"]:p.map}function vl(a){for(var u=Wt(a),p=u.length;p--;){var x=u[p],M=a[x];u[p]=[x,M,Ch(M)]}return u}function un(a,u){var p=Fg(a,u);return Gc(p)?p:t}function Ay(a){var u=ot.call(a,nn),p=a[nn];try{a[nn]=t;var x=!0}catch{}var M=Xs.call(a);return x&&(u?a[nn]=p:delete a[nn]),M}var yl=jo?function(a){return a==null?[]:(a=dt(a),Ir(jo(a),function(u){return Ic.call(a,u)}))}:kl,Eh=jo?function(a){for(var u=[];a;)Lr(u,yl(a)),a=Ys(a);return u}:kl,ti=ai;(Go&&ti(new Go(new ArrayBuffer(1)))!=xe||es&&ti(new es)!=Ne||qo&&ti(qo.resolve())!=bt||Pn&&ti(new Pn)!=Pt||ts&&ti(new ts)!=et)&&(ti=function(a){var u=ai(a),p=u==it?a.constructor:t,x=p?cn(p):"";if(x)switch(x){case uv:return xe;case cv:return Ne;case hv:return bt;case dv:return Pt;case fv:return et}return u});function Cy(a,u,p){for(var x=-1,M=p.length;++x<M;){var I=p[x],k=I.size;switch(I.type){case"drop":a+=k;break;case"dropRight":u-=k;break;case"take":u=ei(u,a+k);break;case"takeRight":a=Ut(a,u-k);break}}return{start:a,end:u}}function Py(a){var u=a.match(qe);return u?u[1].split(st):[]}function Th(a,u,p){u=Fr(u,a);for(var x=-1,M=u.length,I=!1;++x<M;){var k=tr(u[x]);if(!(I=a!=null&&p(a,k)))break;a=a[k]}return I||++x!=M?I:(M=a==null?0:a.length,!!M&&Ma(M)&&pr(k,M)&&(Be(a)||hn(a)))}function Ry(a){var u=a.length,p=new a.constructor(u);return u&&typeof a[0]=="string"&&ot.call(a,"index")&&(p.index=a.index,p.input=a.input),p}function Ah(a){return typeof a.constructor=="function"&&!cs(a)?In(Ys(a)):{}}function Iy(a,u,p){var x=a.constructor;switch(u){case gt:return hl(a);case me:case De:return new x(+a);case xe:return py(a,p);case we:case Ve:case ut:case lt:case Ee:case _t:case wt:case Xt:case Ft:return uh(a,p);case Ne:return new x;case Ge:case _e:return new x(a);case kt:return my(a);case Pt:return new x;case ce:return gy(a)}}function Ly(a,u){var p=u.length;if(!p)return a;var x=p-1;return u[x]=(p>1?"& ":"")+u[x],u=u.join(p>2?", ":" "),a.replace(tt,`{
/* [wrapped with `+u+`] */
`)}function Oy(a){return Be(a)||hn(a)||!!(Lc&&a&&a[Lc])}function pr(a,u){var p=typeof a;return u=u??X,!!u&&(p=="number"||p!="symbol"&&co.test(a))&&a>-1&&a%1==0&&a<u}function oi(a,u,p){if(!St(p))return!1;var x=typeof u;return(x=="number"?di(p)&&pr(u,p.length):x=="string"&&u in p)?Vi(p[u],a):!1}function _l(a,u){if(Be(a))return!1;var p=typeof a;return p=="number"||p=="symbol"||p=="boolean"||a==null||wi(a)?!0:vu.test(a)||!uo.test(a)||u!=null&&a in dt(u)}function Ny(a){var u=typeof a;return u=="string"||u=="number"||u=="symbol"||u=="boolean"?a!=="__proto__":a===null}function xl(a){var u=ga(a),p=C[u];if(typeof p!="function"||!(u in Ye.prototype))return!1;if(a===p)return!0;var x=gl(p);return!!x&&a===x[0]}function Dy(a){return!!Cc&&Cc in a}var ky=Gs?mr:Fl;function cs(a){var u=a&&a.constructor,p=typeof u=="function"&&u.prototype||Cn;return a===p}function Ch(a){return a===a&&!St(a)}function Ph(a,u){return function(p){return p==null?!1:p[a]===u&&(u!==t||a in dt(p))}}function Fy(a){var u=wa(a,function(x){return p.size===f&&p.clear(),x}),p=u.cache;return u}function zy(a,u){var p=a[1],x=u[1],M=p|x,I=M<(E|T|L),k=x==L&&p==P||x==L&&p==N&&a[7].length<=u[8]||x==(L|N)&&u[7].length<=u[8]&&p==P;if(!(I||k))return a;x&E&&(a[2]=u[2],M|=p&E?0:A);var B=u[3];if(B){var W=a[3];a[3]=W?hh(W,B,u[4]):B,a[4]=W?Or(a[3],m):u[4]}return B=u[5],B&&(W=a[5],a[5]=W?dh(W,B,u[6]):B,a[6]=W?Or(a[5],m):u[6]),B=u[7],B&&(a[7]=B),x&L&&(a[8]=a[8]==null?u[8]:ei(a[8],u[8])),a[9]==null&&(a[9]=u[9]),a[0]=u[0],a[1]=M,a}function By(a){var u=[];if(a!=null)for(var p in dt(a))u.push(p);return u}function Uy(a){return Xs.call(a)}function Rh(a,u,p){return u=Ut(u===t?a.length-1:u,0),function(){for(var x=arguments,M=-1,I=Ut(x.length-u,0),k=K(I);++M<I;)k[M]=x[u+M];M=-1;for(var B=K(u+1);++M<u;)B[M]=x[M];return B[u]=p(k),_i(a,this,B)}}function Ih(a,u){return u.length<2?a:ln(a,Ni(u,0,-1))}function Hy(a,u){for(var p=a.length,x=ei(u.length,p),M=hi(a);x--;){var I=u[x];a[x]=pr(I,p)?M[I]:t}return a}function bl(a,u){if(!(u==="constructor"&&typeof a[u]=="function")&&u!="__proto__")return a[u]}var Lh=Nh(th),hs=iv||function(a,u){return Gt.setTimeout(a,u)},wl=Nh(cy);function Oh(a,u,p){var x=u+"";return wl(a,Ly(x,$y(Py(x),p)))}function Nh(a){var u=0,p=0;return function(){var x=av(),M=J-(x-p);if(p=x,M>0){if(++u>=G)return arguments[0]}else u=0;return a.apply(t,arguments)}}function ya(a,u){var p=-1,x=a.length,M=x-1;for(u=u===t?x:u;++p<u;){var I=nl(p,M),k=a[I];a[I]=a[p],a[p]=k}return a.length=u,a}var Dh=Fy(function(a){var u=[];return a.charCodeAt(0)===46&&u.push(""),a.replace(yu,function(p,x,M,I){u.push(M?I.replace(yi,"$1"):x||p)}),u});function tr(a){if(typeof a=="string"||wi(a))return a;var u=a+"";return u=="0"&&1/a==-H?"-0":u}function cn(a){if(a!=null){try{return qs.call(a)}catch{}try{return a+""}catch{}}return""}function $y(a,u){return Ri(ee,function(p){var x="_."+p[0];u&p[1]&&!$s(a,x)&&a.push(x)}),a.sort()}function kh(a){if(a instanceof Ye)return a.clone();var u=new Li(a.__wrapped__,a.__chain__);return u.__actions__=hi(a.__actions__),u.__index__=a.__index__,u.__values__=a.__values__,u}function Vy(a,u,p){(p?oi(a,u,p):u===t)?u=1:u=Ut(He(u),0);var x=a==null?0:a.length;if(!x||u<1)return[];for(var M=0,I=0,k=K(ea(x/u));M<x;)k[I++]=Ni(a,M,M+=u);return k}function Wy(a){for(var u=-1,p=a==null?0:a.length,x=0,M=[];++u<p;){var I=a[u];I&&(M[x++]=I)}return M}function jy(){var a=arguments.length;if(!a)return[];for(var u=K(a-1),p=arguments[0],x=a;x--;)u[x-1]=arguments[x];return Lr(Be(p)?hi(p):[p],Zt(u,1))}var Gy=We(function(a,u){return Lt(a)?ss(a,Zt(u,1,Lt,!0)):[]}),qy=We(function(a,u){var p=Di(u);return Lt(p)&&(p=t),Lt(a)?ss(a,Zt(u,1,Lt,!0),Pe(p,2)):[]}),Xy=We(function(a,u){var p=Di(u);return Lt(p)&&(p=t),Lt(a)?ss(a,Zt(u,1,Lt,!0),t,p):[]});function Zy(a,u,p){var x=a==null?0:a.length;return x?(u=p||u===t?1:He(u),Ni(a,u<0?0:u,x)):[]}function Jy(a,u,p){var x=a==null?0:a.length;return x?(u=p||u===t?1:He(u),u=x-u,Ni(a,0,u<0?0:u)):[]}function Yy(a,u){return a&&a.length?ca(a,Pe(u,3),!0,!0):[]}function Ky(a,u){return a&&a.length?ca(a,Pe(u,3),!0):[]}function Qy(a,u,p,x){var M=a==null?0:a.length;return M?(p&&typeof p!="number"&&oi(a,u,p)&&(p=0,x=M),jv(a,u,p,x)):[]}function Fh(a,u,p){var x=a==null?0:a.length;if(!x)return-1;var M=p==null?0:He(p);return M<0&&(M=Ut(x+M,0)),Vs(a,Pe(u,3),M)}function zh(a,u,p){var x=a==null?0:a.length;if(!x)return-1;var M=x-1;return p!==t&&(M=He(p),M=p<0?Ut(x+M,0):ei(M,x-1)),Vs(a,Pe(u,3),M,!0)}function Bh(a){var u=a==null?0:a.length;return u?Zt(a,1):[]}function e0(a){var u=a==null?0:a.length;return u?Zt(a,H):[]}function t0(a,u){var p=a==null?0:a.length;return p?(u=u===t?1:He(u),Zt(a,u)):[]}function i0(a){for(var u=-1,p=a==null?0:a.length,x={};++u<p;){var M=a[u];x[M[0]]=M[1]}return x}function Uh(a){return a&&a.length?a[0]:t}function r0(a,u,p){var x=a==null?0:a.length;if(!x)return-1;var M=p==null?0:He(p);return M<0&&(M=Ut(x+M,0)),En(a,u,M)}function n0(a){var u=a==null?0:a.length;return u?Ni(a,0,-1):[]}var s0=We(function(a){var u=xt(a,ul);return u.length&&u[0]===a[0]?Qo(u):[]}),a0=We(function(a){var u=Di(a),p=xt(a,ul);return u===Di(p)?u=t:p.pop(),p.length&&p[0]===a[0]?Qo(p,Pe(u,2)):[]}),o0=We(function(a){var u=Di(a),p=xt(a,ul);return u=typeof u=="function"?u:t,u&&p.pop(),p.length&&p[0]===a[0]?Qo(p,t,u):[]});function l0(a,u){return a==null?"":nv.call(a,u)}function Di(a){var u=a==null?0:a.length;return u?a[u-1]:t}function u0(a,u,p){var x=a==null?0:a.length;if(!x)return-1;var M=x;return p!==t&&(M=He(p),M=M<0?Ut(x+M,0):ei(M,x-1)),u===u?$g(a,u,M):Vs(a,xc,M,!0)}function c0(a,u){return a&&a.length?Yc(a,He(u)):t}var h0=We(Hh);function Hh(a,u){return a&&a.length&&u&&u.length?rl(a,u):a}function d0(a,u,p){return a&&a.length&&u&&u.length?rl(a,u,Pe(p,2)):a}function f0(a,u,p){return a&&a.length&&u&&u.length?rl(a,u,t,p):a}var p0=fr(function(a,u){var p=a==null?0:a.length,x=Zo(a,u);return eh(a,xt(u,function(M){return pr(M,p)?+M:M}).sort(ch)),x});function m0(a,u){var p=[];if(!(a&&a.length))return p;var x=-1,M=[],I=a.length;for(u=Pe(u,3);++x<I;){var k=a[x];u(k,x,a)&&(p.push(k),M.push(x))}return eh(a,M),p}function Sl(a){return a==null?a:lv.call(a)}function g0(a,u,p){var x=a==null?0:a.length;return x?(p&&typeof p!="number"&&oi(a,u,p)?(u=0,p=x):(u=u==null?0:He(u),p=p===t?x:He(p)),Ni(a,u,p)):[]}function v0(a,u){return ua(a,u)}function y0(a,u,p){return al(a,u,Pe(p,2))}function _0(a,u){var p=a==null?0:a.length;if(p){var x=ua(a,u);if(x<p&&Vi(a[x],u))return x}return-1}function x0(a,u){return ua(a,u,!0)}function b0(a,u,p){return al(a,u,Pe(p,2),!0)}function w0(a,u){var p=a==null?0:a.length;if(p){var x=ua(a,u,!0)-1;if(Vi(a[x],u))return x}return-1}function S0(a){return a&&a.length?ih(a):[]}function M0(a,u){return a&&a.length?ih(a,Pe(u,2)):[]}function E0(a){var u=a==null?0:a.length;return u?Ni(a,1,u):[]}function T0(a,u,p){return a&&a.length?(u=p||u===t?1:He(u),Ni(a,0,u<0?0:u)):[]}function A0(a,u,p){var x=a==null?0:a.length;return x?(u=p||u===t?1:He(u),u=x-u,Ni(a,u<0?0:u,x)):[]}function C0(a,u){return a&&a.length?ca(a,Pe(u,3),!1,!0):[]}function P0(a,u){return a&&a.length?ca(a,Pe(u,3)):[]}var R0=We(function(a){return kr(Zt(a,1,Lt,!0))}),I0=We(function(a){var u=Di(a);return Lt(u)&&(u=t),kr(Zt(a,1,Lt,!0),Pe(u,2))}),L0=We(function(a){var u=Di(a);return u=typeof u=="function"?u:t,kr(Zt(a,1,Lt,!0),t,u)});function O0(a){return a&&a.length?kr(a):[]}function N0(a,u){return a&&a.length?kr(a,Pe(u,2)):[]}function D0(a,u){return u=typeof u=="function"?u:t,a&&a.length?kr(a,t,u):[]}function Ml(a){if(!(a&&a.length))return[];var u=0;return a=Ir(a,function(p){if(Lt(p))return u=Ut(p.length,u),!0}),Ho(u,function(p){return xt(a,zo(p))})}function $h(a,u){if(!(a&&a.length))return[];var p=Ml(a);return u==null?p:xt(p,function(x){return _i(u,t,x)})}var k0=We(function(a,u){return Lt(a)?ss(a,u):[]}),F0=We(function(a){return ll(Ir(a,Lt))}),z0=We(function(a){var u=Di(a);return Lt(u)&&(u=t),ll(Ir(a,Lt),Pe(u,2))}),B0=We(function(a){var u=Di(a);return u=typeof u=="function"?u:t,ll(Ir(a,Lt),t,u)}),U0=We(Ml);function H0(a,u){return ah(a||[],u||[],ns)}function $0(a,u){return ah(a||[],u||[],ls)}var V0=We(function(a){var u=a.length,p=u>1?a[u-1]:t;return p=typeof p=="function"?(a.pop(),p):t,$h(a,p)});function Vh(a){var u=C(a);return u.__chain__=!0,u}function W0(a,u){return u(a),a}function _a(a,u){return u(a)}var j0=fr(function(a){var u=a.length,p=u?a[0]:0,x=this.__wrapped__,M=function(I){return Zo(I,a)};return u>1||this.__actions__.length||!(x instanceof Ye)||!pr(p)?this.thru(M):(x=x.slice(p,+p+(u?1:0)),x.__actions__.push({func:_a,args:[M],thisArg:t}),new Li(x,this.__chain__).thru(function(I){return u&&!I.length&&I.push(t),I}))});function G0(){return Vh(this)}function q0(){return new Li(this.value(),this.__chain__)}function X0(){this.__values__===t&&(this.__values__=rd(this.value()));var a=this.__index__>=this.__values__.length,u=a?t:this.__values__[this.__index__++];return{done:a,value:u}}function Z0(){return this}function J0(a){for(var u,p=this;p instanceof na;){var x=kh(p);x.__index__=0,x.__values__=t,u?M.__wrapped__=x:u=x;var M=x;p=p.__wrapped__}return M.__wrapped__=a,u}function Y0(){var a=this.__wrapped__;if(a instanceof Ye){var u=a;return this.__actions__.length&&(u=new Ye(this)),u=u.reverse(),u.__actions__.push({func:_a,args:[Sl],thisArg:t}),new Li(u,this.__chain__)}return this.thru(Sl)}function K0(){return sh(this.__wrapped__,this.__actions__)}var Q0=ha(function(a,u,p){ot.call(a,p)?++a[p]:hr(a,p,1)});function e_(a,u,p){var x=Be(a)?yc:Wv;return p&&oi(a,u,p)&&(u=t),x(a,Pe(u,3))}function t_(a,u){var p=Be(a)?Ir:$c;return p(a,Pe(u,3))}var i_=gh(Fh),r_=gh(zh);function n_(a,u){return Zt(xa(a,u),1)}function s_(a,u){return Zt(xa(a,u),H)}function a_(a,u,p){return p=p===t?1:He(p),Zt(xa(a,u),p)}function Wh(a,u){var p=Be(a)?Ri:Dr;return p(a,Pe(u,3))}function jh(a,u){var p=Be(a)?Eg:Hc;return p(a,Pe(u,3))}var o_=ha(function(a,u,p){ot.call(a,p)?a[p].push(u):hr(a,p,[u])});function l_(a,u,p,x){a=di(a)?a:kn(a),p=p&&!x?He(p):0;var M=a.length;return p<0&&(p=Ut(M+p,0)),Ea(a)?p<=M&&a.indexOf(u,p)>-1:!!M&&En(a,u,p)>-1}var u_=We(function(a,u,p){var x=-1,M=typeof u=="function",I=di(a)?K(a.length):[];return Dr(a,function(k){I[++x]=M?_i(u,k,p):as(k,u,p)}),I}),c_=ha(function(a,u,p){hr(a,p,u)});function xa(a,u){var p=Be(a)?xt:Xc;return p(a,Pe(u,3))}function h_(a,u,p,x){return a==null?[]:(Be(u)||(u=u==null?[]:[u]),p=x?t:p,Be(p)||(p=p==null?[]:[p]),Kc(a,u,p))}var d_=ha(function(a,u,p){a[p?0:1].push(u)},function(){return[[],[]]});function f_(a,u,p){var x=Be(a)?ko:wc,M=arguments.length<3;return x(a,Pe(u,4),p,M,Dr)}function p_(a,u,p){var x=Be(a)?Tg:wc,M=arguments.length<3;return x(a,Pe(u,4),p,M,Hc)}function m_(a,u){var p=Be(a)?Ir:$c;return p(a,Sa(Pe(u,3)))}function g_(a){var u=Be(a)?Fc:ly;return u(a)}function v_(a,u,p){(p?oi(a,u,p):u===t)?u=1:u=He(u);var x=Be(a)?Bv:uy;return x(a,u)}function y_(a){var u=Be(a)?Uv:hy;return u(a)}function __(a){if(a==null)return 0;if(di(a))return Ea(a)?An(a):a.length;var u=ti(a);return u==Ne||u==Pt?a.size:tl(a).length}function x_(a,u,p){var x=Be(a)?Fo:dy;return p&&oi(a,u,p)&&(u=t),x(a,Pe(u,3))}var b_=We(function(a,u){if(a==null)return[];var p=u.length;return p>1&&oi(a,u[0],u[1])?u=[]:p>2&&oi(u[0],u[1],u[2])&&(u=[u[0]]),Kc(a,Zt(u,1),[])}),ba=tv||function(){return Gt.Date.now()};function w_(a,u){if(typeof u!="function")throw new Ii(c);return a=He(a),function(){if(--a<1)return u.apply(this,arguments)}}function Gh(a,u,p){return u=p?t:u,u=a&&u==null?a.length:u,dr(a,L,t,t,t,t,u)}function qh(a,u){var p;if(typeof u!="function")throw new Ii(c);return a=He(a),function(){return--a>0&&(p=u.apply(this,arguments)),a<=1&&(u=t),p}}var El=We(function(a,u,p){var x=E;if(p.length){var M=Or(p,Nn(El));x|=R}return dr(a,x,u,p,M)}),Xh=We(function(a,u,p){var x=E|T;if(p.length){var M=Or(p,Nn(Xh));x|=R}return dr(u,x,a,p,M)});function Zh(a,u,p){u=p?t:u;var x=dr(a,P,t,t,t,t,t,u);return x.placeholder=Zh.placeholder,x}function Jh(a,u,p){u=p?t:u;var x=dr(a,O,t,t,t,t,t,u);return x.placeholder=Jh.placeholder,x}function Yh(a,u,p){var x,M,I,k,B,W,ie=0,ne=!1,ue=!1,ge=!0;if(typeof a!="function")throw new Ii(c);u=ki(u)||0,St(p)&&(ne=!!p.leading,ue="maxWait"in p,I=ue?Ut(ki(p.maxWait)||0,u):I,ge="trailing"in p?!!p.trailing:ge);function Me(Ot){var Wi=x,vr=M;return x=M=t,ie=Ot,k=a.apply(vr,Wi),k}function Re(Ot){return ie=Ot,B=hs(Xe,u),ne?Me(Ot):k}function $e(Ot){var Wi=Ot-W,vr=Ot-ie,gd=u-Wi;return ue?ei(gd,I-vr):gd}function Ie(Ot){var Wi=Ot-W,vr=Ot-ie;return W===t||Wi>=u||Wi<0||ue&&vr>=I}function Xe(){var Ot=ba();if(Ie(Ot))return Ke(Ot);B=hs(Xe,$e(Ot))}function Ke(Ot){return B=t,ge&&x?Me(Ot):(x=M=t,k)}function Si(){B!==t&&oh(B),ie=0,x=W=M=B=t}function li(){return B===t?k:Ke(ba())}function Mi(){var Ot=ba(),Wi=Ie(Ot);if(x=arguments,M=this,W=Ot,Wi){if(B===t)return Re(W);if(ue)return oh(B),B=hs(Xe,u),Me(W)}return B===t&&(B=hs(Xe,u)),k}return Mi.cancel=Si,Mi.flush=li,Mi}var S_=We(function(a,u){return Uc(a,1,u)}),M_=We(function(a,u,p){return Uc(a,ki(u)||0,p)});function E_(a){return dr(a,U)}function wa(a,u){if(typeof a!="function"||u!=null&&typeof u!="function")throw new Ii(c);var p=function(){var x=arguments,M=u?u.apply(this,x):x[0],I=p.cache;if(I.has(M))return I.get(M);var k=a.apply(this,x);return p.cache=I.set(M,k)||I,k};return p.cache=new(wa.Cache||cr),p}wa.Cache=cr;function Sa(a){if(typeof a!="function")throw new Ii(c);return function(){var u=arguments;switch(u.length){case 0:return!a.call(this);case 1:return!a.call(this,u[0]);case 2:return!a.call(this,u[0],u[1]);case 3:return!a.call(this,u[0],u[1],u[2])}return!a.apply(this,u)}}function T_(a){return qh(2,a)}var A_=fy(function(a,u){u=u.length==1&&Be(u[0])?xt(u[0],xi(Pe())):xt(Zt(u,1),xi(Pe()));var p=u.length;return We(function(x){for(var M=-1,I=ei(x.length,p);++M<I;)x[M]=u[M].call(this,x[M]);return _i(a,this,x)})}),Tl=We(function(a,u){var p=Or(u,Nn(Tl));return dr(a,R,t,u,p)}),Kh=We(function(a,u){var p=Or(u,Nn(Kh));return dr(a,D,t,u,p)}),C_=fr(function(a,u){return dr(a,N,t,t,t,u)});function P_(a,u){if(typeof a!="function")throw new Ii(c);return u=u===t?u:He(u),We(a,u)}function R_(a,u){if(typeof a!="function")throw new Ii(c);return u=u==null?0:Ut(He(u),0),We(function(p){var x=p[u],M=zr(p,0,u);return x&&Lr(M,x),_i(a,this,M)})}function I_(a,u,p){var x=!0,M=!0;if(typeof a!="function")throw new Ii(c);return St(p)&&(x="leading"in p?!!p.leading:x,M="trailing"in p?!!p.trailing:M),Yh(a,u,{leading:x,maxWait:u,trailing:M})}function L_(a){return Gh(a,1)}function O_(a,u){return Tl(cl(u),a)}function N_(){if(!arguments.length)return[];var a=arguments[0];return Be(a)?a:[a]}function D_(a){return Oi(a,_)}function k_(a,u){return u=typeof u=="function"?u:t,Oi(a,_,u)}function F_(a){return Oi(a,g|_)}function z_(a,u){return u=typeof u=="function"?u:t,Oi(a,g|_,u)}function B_(a,u){return u==null||Bc(a,u,Wt(u))}function Vi(a,u){return a===u||a!==a&&u!==u}var U_=ma(Ko),H_=ma(function(a,u){return a>=u}),hn=jc(function(){return arguments}())?jc:function(a){return Tt(a)&&ot.call(a,"callee")&&!Ic.call(a,"callee")},Be=K.isArray,$_=dc?xi(dc):Jv;function di(a){return a!=null&&Ma(a.length)&&!mr(a)}function Lt(a){return Tt(a)&&di(a)}function V_(a){return a===!0||a===!1||Tt(a)&&ai(a)==me}var Br=rv||Fl,W_=fc?xi(fc):Yv;function j_(a){return Tt(a)&&a.nodeType===1&&!ds(a)}function G_(a){if(a==null)return!0;if(di(a)&&(Be(a)||typeof a=="string"||typeof a.splice=="function"||Br(a)||Dn(a)||hn(a)))return!a.length;var u=ti(a);if(u==Ne||u==Pt)return!a.size;if(cs(a))return!tl(a).length;for(var p in a)if(ot.call(a,p))return!1;return!0}function q_(a,u){return os(a,u)}function X_(a,u,p){p=typeof p=="function"?p:t;var x=p?p(a,u):t;return x===t?os(a,u,t,p):!!x}function Al(a){if(!Tt(a))return!1;var u=ai(a);return u==Ce||u==Le||typeof a.message=="string"&&typeof a.name=="string"&&!ds(a)}function Z_(a){return typeof a=="number"&&Oc(a)}function mr(a){if(!St(a))return!1;var u=ai(a);return u==Ae||u==Ue||u==fe||u==Kt}function Qh(a){return typeof a=="number"&&a==He(a)}function Ma(a){return typeof a=="number"&&a>-1&&a%1==0&&a<=X}function St(a){var u=typeof a;return a!=null&&(u=="object"||u=="function")}function Tt(a){return a!=null&&typeof a=="object"}var ed=pc?xi(pc):Qv;function J_(a,u){return a===u||el(a,u,vl(u))}function Y_(a,u,p){return p=typeof p=="function"?p:t,el(a,u,vl(u),p)}function K_(a){return td(a)&&a!=+a}function Q_(a){if(ky(a))throw new ze(l);return Gc(a)}function ex(a){return a===null}function tx(a){return a==null}function td(a){return typeof a=="number"||Tt(a)&&ai(a)==Ge}function ds(a){if(!Tt(a)||ai(a)!=it)return!1;var u=Ys(a);if(u===null)return!0;var p=ot.call(u,"constructor")&&u.constructor;return typeof p=="function"&&p instanceof p&&qs.call(p)==Yg}var Cl=mc?xi(mc):ey;function ix(a){return Qh(a)&&a>=-X&&a<=X}var id=gc?xi(gc):ty;function Ea(a){return typeof a=="string"||!Be(a)&&Tt(a)&&ai(a)==_e}function wi(a){return typeof a=="symbol"||Tt(a)&&ai(a)==ce}var Dn=vc?xi(vc):iy;function rx(a){return a===t}function nx(a){return Tt(a)&&ti(a)==et}function sx(a){return Tt(a)&&ai(a)==Dt}var ax=ma(il),ox=ma(function(a,u){return a<=u});function rd(a){if(!a)return[];if(di(a))return Ea(a)?Hi(a):hi(a);if(Qn&&a[Qn])return Bg(a[Qn]());var u=ti(a),p=u==Ne?Vo:u==Pt?Ws:kn;return p(a)}function gr(a){if(!a)return a===0?a:0;if(a=ki(a),a===H||a===-H){var u=a<0?-1:1;return u*re}return a===a?a:0}function He(a){var u=gr(a),p=u%1;return u===u?p?u-p:u:0}function nd(a){return a?on(He(a),0,he):0}function ki(a){if(typeof a=="number")return a;if(wi(a))return ae;if(St(a)){var u=typeof a.valueOf=="function"?a.valueOf():a;a=St(u)?u+"":u}if(typeof a!="string")return a===0?a:+a;a=Sc(a);var p=Ki.test(a);return p||Us.test(a)?wg(a.slice(2),p?2:8):Yi.test(a)?ae:+a}function sd(a){return er(a,fi(a))}function lx(a){return a?on(He(a),-X,X):a===0?a:0}function at(a){return a==null?"":bi(a)}var ux=Ln(function(a,u){if(cs(u)||di(u)){er(u,Wt(u),a);return}for(var p in u)ot.call(u,p)&&ns(a,p,u[p])}),ad=Ln(function(a,u){er(u,fi(u),a)}),Ta=Ln(function(a,u,p,x){er(u,fi(u),a,x)}),cx=Ln(function(a,u,p,x){er(u,Wt(u),a,x)}),hx=fr(Zo);function dx(a,u){var p=In(a);return u==null?p:zc(p,u)}var fx=We(function(a,u){a=dt(a);var p=-1,x=u.length,M=x>2?u[2]:t;for(M&&oi(u[0],u[1],M)&&(x=1);++p<x;)for(var I=u[p],k=fi(I),B=-1,W=k.length;++B<W;){var ie=k[B],ne=a[ie];(ne===t||Vi(ne,Cn[ie])&&!ot.call(a,ie))&&(a[ie]=I[ie])}return a}),px=We(function(a){return a.push(t,Sh),_i(od,t,a)});function mx(a,u){return _c(a,Pe(u,3),Qi)}function gx(a,u){return _c(a,Pe(u,3),Yo)}function vx(a,u){return a==null?a:Jo(a,Pe(u,3),fi)}function yx(a,u){return a==null?a:Vc(a,Pe(u,3),fi)}function _x(a,u){return a&&Qi(a,Pe(u,3))}function xx(a,u){return a&&Yo(a,Pe(u,3))}function bx(a){return a==null?[]:oa(a,Wt(a))}function wx(a){return a==null?[]:oa(a,fi(a))}function Pl(a,u,p){var x=a==null?t:ln(a,u);return x===t?p:x}function Sx(a,u){return a!=null&&Th(a,u,Gv)}function Rl(a,u){return a!=null&&Th(a,u,qv)}var Mx=yh(function(a,u,p){u!=null&&typeof u.toString!="function"&&(u=Xs.call(u)),a[u]=p},Ll(pi)),Ex=yh(function(a,u,p){u!=null&&typeof u.toString!="function"&&(u=Xs.call(u)),ot.call(a,u)?a[u].push(p):a[u]=[p]},Pe),Tx=We(as);function Wt(a){return di(a)?kc(a):tl(a)}function fi(a){return di(a)?kc(a,!0):ry(a)}function Ax(a,u){var p={};return u=Pe(u,3),Qi(a,function(x,M,I){hr(p,u(x,M,I),x)}),p}function Cx(a,u){var p={};return u=Pe(u,3),Qi(a,function(x,M,I){hr(p,M,u(x,M,I))}),p}var Px=Ln(function(a,u,p){la(a,u,p)}),od=Ln(function(a,u,p,x){la(a,u,p,x)}),Rx=fr(function(a,u){var p={};if(a==null)return p;var x=!1;u=xt(u,function(I){return I=Fr(I,a),x||(x=I.length>1),I}),er(a,ml(a),p),x&&(p=Oi(p,g|y|_,My));for(var M=u.length;M--;)ol(p,u[M]);return p});function Ix(a,u){return ld(a,Sa(Pe(u)))}var Lx=fr(function(a,u){return a==null?{}:sy(a,u)});function ld(a,u){if(a==null)return{};var p=xt(ml(a),function(x){return[x]});return u=Pe(u),Qc(a,p,function(x,M){return u(x,M[0])})}function Ox(a,u,p){u=Fr(u,a);var x=-1,M=u.length;for(M||(M=1,a=t);++x<M;){var I=a==null?t:a[tr(u[x])];I===t&&(x=M,I=p),a=mr(I)?I.call(a):I}return a}function Nx(a,u,p){return a==null?a:ls(a,u,p)}function Dx(a,u,p,x){return x=typeof x=="function"?x:t,a==null?a:ls(a,u,p,x)}var ud=bh(Wt),cd=bh(fi);function kx(a,u,p){var x=Be(a),M=x||Br(a)||Dn(a);if(u=Pe(u,4),p==null){var I=a&&a.constructor;M?p=x?new I:[]:St(a)?p=mr(I)?In(Ys(a)):{}:p={}}return(M?Ri:Qi)(a,function(k,B,W){return u(p,k,B,W)}),p}function Fx(a,u){return a==null?!0:ol(a,u)}function zx(a,u,p){return a==null?a:nh(a,u,cl(p))}function Bx(a,u,p,x){return x=typeof x=="function"?x:t,a==null?a:nh(a,u,cl(p),x)}function kn(a){return a==null?[]:$o(a,Wt(a))}function Ux(a){return a==null?[]:$o(a,fi(a))}function Hx(a,u,p){return p===t&&(p=u,u=t),p!==t&&(p=ki(p),p=p===p?p:0),u!==t&&(u=ki(u),u=u===u?u:0),on(ki(a),u,p)}function $x(a,u,p){return u=gr(u),p===t?(p=u,u=0):p=gr(p),a=ki(a),Xv(a,u,p)}function Vx(a,u,p){if(p&&typeof p!="boolean"&&oi(a,u,p)&&(u=p=t),p===t&&(typeof u=="boolean"?(p=u,u=t):typeof a=="boolean"&&(p=a,a=t)),a===t&&u===t?(a=0,u=1):(a=gr(a),u===t?(u=a,a=0):u=gr(u)),a>u){var x=a;a=u,u=x}if(p||a%1||u%1){var M=Nc();return ei(a+M*(u-a+bg("1e-"+((M+"").length-1))),u)}return nl(a,u)}var Wx=On(function(a,u,p){return u=u.toLowerCase(),a+(p?hd(u):u)});function hd(a){return Il(at(a).toLowerCase())}function dd(a){return a=at(a),a&&a.replace(Po,Ng).replace(hg,"")}function jx(a,u,p){a=at(a),u=bi(u);var x=a.length;p=p===t?x:on(He(p),0,x);var M=p;return p-=u.length,p>=0&&a.slice(p,M)==u}function Gx(a){return a=at(a),a&&Jn.test(a)?a.replace(Ji,Dg):a}function qx(a){return a=at(a),a&&_u.test(a)?a.replace(Ls,"\\$&"):a}var Xx=On(function(a,u,p){return a+(p?"-":"")+u.toLowerCase()}),Zx=On(function(a,u,p){return a+(p?" ":"")+u.toLowerCase()}),Jx=mh("toLowerCase");function Yx(a,u,p){a=at(a),u=He(u);var x=u?An(a):0;if(!u||x>=u)return a;var M=(u-x)/2;return pa(ta(M),p)+a+pa(ea(M),p)}function Kx(a,u,p){a=at(a),u=He(u);var x=u?An(a):0;return u&&x<u?a+pa(u-x,p):a}function Qx(a,u,p){a=at(a),u=He(u);var x=u?An(a):0;return u&&x<u?pa(u-x,p)+a:a}function eb(a,u,p){return p||u==null?u=0:u&&(u=+u),ov(at(a).replace(ye,""),u||0)}function tb(a,u,p){return(p?oi(a,u,p):u===t)?u=1:u=He(u),sl(at(a),u)}function ib(){var a=arguments,u=at(a[0]);return a.length<3?u:u.replace(a[1],a[2])}var rb=On(function(a,u,p){return a+(p?"_":"")+u.toLowerCase()});function nb(a,u,p){return p&&typeof p!="number"&&oi(a,u,p)&&(u=p=t),p=p===t?he:p>>>0,p?(a=at(a),a&&(typeof u=="string"||u!=null&&!Cl(u))&&(u=bi(u),!u&&Tn(a))?zr(Hi(a),0,p):a.split(u,p)):[]}var sb=On(function(a,u,p){return a+(p?" ":"")+Il(u)});function ab(a,u,p){return a=at(a),p=p==null?0:on(He(p),0,a.length),u=bi(u),a.slice(p,p+u.length)==u}function ob(a,u,p){var x=C.templateSettings;p&&oi(a,u,p)&&(u=t),a=at(a),u=Ta({},u,x,wh);var M=Ta({},u.imports,x.imports,wh),I=Wt(M),k=$o(M,I),B,W,ie=0,ne=u.interpolate||Q,ue="__p += '",ge=Wo((u.escape||Q).source+"|"+ne.source+"|"+(ne===lo?Xi:Q).source+"|"+(u.evaluate||Q).source+"|$","g"),Me="//# sourceURL="+(ot.call(u,"sourceURL")?(u.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++gg+"]")+`
`;a.replace(ge,function(Ie,Xe,Ke,Si,li,Mi){return Ke||(Ke=Si),ue+=a.slice(ie,Mi).replace(le,kg),Xe&&(B=!0,ue+=`' +
__e(`+Xe+`) +
'`),li&&(W=!0,ue+=`';
`+li+`;
__p += '`),Ke&&(ue+=`' +
((__t = (`+Ke+`)) == null ? '' : __t) +
'`),ie=Mi+Ie.length,Ie}),ue+=`';
`;var Re=ot.call(u,"variable")&&u.variable;if(!Re)ue=`with (obj) {
`+ue+`
}
`;else if(Ci.test(Re))throw new ze(h);ue=(W?ue.replace(gi,""):ue).replace(Rt,"$1").replace(ci,"$1;"),ue="function("+(Re||"obj")+`) {
`+(Re?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(B?", __e = _.escape":"")+(W?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ue+`return __p
}`;var $e=pd(function(){return rt(I,Me+"return "+ue).apply(t,k)});if($e.source=ue,Al($e))throw $e;return $e}function lb(a){return at(a).toLowerCase()}function ub(a){return at(a).toUpperCase()}function cb(a,u,p){if(a=at(a),a&&(p||u===t))return Sc(a);if(!a||!(u=bi(u)))return a;var x=Hi(a),M=Hi(u),I=Mc(x,M),k=Ec(x,M)+1;return zr(x,I,k).join("")}function hb(a,u,p){if(a=at(a),a&&(p||u===t))return a.slice(0,Ac(a)+1);if(!a||!(u=bi(u)))return a;var x=Hi(a),M=Ec(x,Hi(u))+1;return zr(x,0,M).join("")}function db(a,u,p){if(a=at(a),a&&(p||u===t))return a.replace(ye,"");if(!a||!(u=bi(u)))return a;var x=Hi(a),M=Mc(x,Hi(u));return zr(x,M).join("")}function fb(a,u){var p=F,x=z;if(St(u)){var M="separator"in u?u.separator:M;p="length"in u?He(u.length):p,x="omission"in u?bi(u.omission):x}a=at(a);var I=a.length;if(Tn(a)){var k=Hi(a);I=k.length}if(p>=I)return a;var B=p-An(x);if(B<1)return x;var W=k?zr(k,0,B).join(""):a.slice(0,B);if(M===t)return W+x;if(k&&(B+=W.length-B),Cl(M)){if(a.slice(B).search(M)){var ie,ne=W;for(M.global||(M=Wo(M.source,at(xr.exec(M))+"g")),M.lastIndex=0;ie=M.exec(ne);)var ue=ie.index;W=W.slice(0,ue===t?B:ue)}}else if(a.indexOf(bi(M),B)!=B){var ge=W.lastIndexOf(M);ge>-1&&(W=W.slice(0,ge))}return W+x}function pb(a){return a=at(a),a&&ws.test(a)?a.replace(ji,Vg):a}var mb=On(function(a,u,p){return a+(p?" ":"")+u.toUpperCase()}),Il=mh("toUpperCase");function fd(a,u,p){return a=at(a),u=p?t:u,u===t?zg(a)?Gg(a):Pg(a):a.match(u)||[]}var pd=We(function(a,u){try{return _i(a,t,u)}catch(p){return Al(p)?p:new ze(p)}}),gb=fr(function(a,u){return Ri(u,function(p){p=tr(p),hr(a,p,El(a[p],a))}),a});function vb(a){var u=a==null?0:a.length,p=Pe();return a=u?xt(a,function(x){if(typeof x[1]!="function")throw new Ii(c);return[p(x[0]),x[1]]}):[],We(function(x){for(var M=-1;++M<u;){var I=a[M];if(_i(I[0],this,x))return _i(I[1],this,x)}})}function yb(a){return Vv(Oi(a,g))}function Ll(a){return function(){return a}}function _b(a,u){return a==null||a!==a?u:a}var xb=vh(),bb=vh(!0);function pi(a){return a}function Ol(a){return qc(typeof a=="function"?a:Oi(a,g))}function wb(a){return Zc(Oi(a,g))}function Sb(a,u){return Jc(a,Oi(u,g))}var Mb=We(function(a,u){return function(p){return as(p,a,u)}}),Eb=We(function(a,u){return function(p){return as(a,p,u)}});function Nl(a,u,p){var x=Wt(u),M=oa(u,x);p==null&&!(St(u)&&(M.length||!x.length))&&(p=u,u=a,a=this,M=oa(u,Wt(u)));var I=!(St(p)&&"chain"in p)||!!p.chain,k=mr(a);return Ri(M,function(B){var W=u[B];a[B]=W,k&&(a.prototype[B]=function(){var ie=this.__chain__;if(I||ie){var ne=a(this.__wrapped__),ue=ne.__actions__=hi(this.__actions__);return ue.push({func:W,args:arguments,thisArg:a}),ne.__chain__=ie,ne}return W.apply(a,Lr([this.value()],arguments))})}),a}function Tb(){return Gt._===this&&(Gt._=Kg),this}function Dl(){}function Ab(a){return a=He(a),We(function(u){return Yc(u,a)})}var Cb=dl(xt),Pb=dl(yc),Rb=dl(Fo);function md(a){return _l(a)?zo(tr(a)):ay(a)}function Ib(a){return function(u){return a==null?t:ln(a,u)}}var Lb=_h(),Ob=_h(!0);function kl(){return[]}function Fl(){return!1}function Nb(){return{}}function Db(){return""}function kb(){return!0}function Fb(a,u){if(a=He(a),a<1||a>X)return[];var p=he,x=ei(a,he);u=Pe(u),a-=he;for(var M=Ho(x,u);++p<a;)u(p);return M}function zb(a){return Be(a)?xt(a,tr):wi(a)?[a]:hi(Dh(at(a)))}function Bb(a){var u=++Jg;return at(a)+u}var Ub=fa(function(a,u){return a+u},0),Hb=fl("ceil"),$b=fa(function(a,u){return a/u},1),Vb=fl("floor");function Wb(a){return a&&a.length?aa(a,pi,Ko):t}function jb(a,u){return a&&a.length?aa(a,Pe(u,2),Ko):t}function Gb(a){return bc(a,pi)}function qb(a,u){return bc(a,Pe(u,2))}function Xb(a){return a&&a.length?aa(a,pi,il):t}function Zb(a,u){return a&&a.length?aa(a,Pe(u,2),il):t}var Jb=fa(function(a,u){return a*u},1),Yb=fl("round"),Kb=fa(function(a,u){return a-u},0);function Qb(a){return a&&a.length?Uo(a,pi):0}function e1(a,u){return a&&a.length?Uo(a,Pe(u,2)):0}return C.after=w_,C.ary=Gh,C.assign=ux,C.assignIn=ad,C.assignInWith=Ta,C.assignWith=cx,C.at=hx,C.before=qh,C.bind=El,C.bindAll=gb,C.bindKey=Xh,C.castArray=N_,C.chain=Vh,C.chunk=Vy,C.compact=Wy,C.concat=jy,C.cond=vb,C.conforms=yb,C.constant=Ll,C.countBy=Q0,C.create=dx,C.curry=Zh,C.curryRight=Jh,C.debounce=Yh,C.defaults=fx,C.defaultsDeep=px,C.defer=S_,C.delay=M_,C.difference=Gy,C.differenceBy=qy,C.differenceWith=Xy,C.drop=Zy,C.dropRight=Jy,C.dropRightWhile=Yy,C.dropWhile=Ky,C.fill=Qy,C.filter=t_,C.flatMap=n_,C.flatMapDeep=s_,C.flatMapDepth=a_,C.flatten=Bh,C.flattenDeep=e0,C.flattenDepth=t0,C.flip=E_,C.flow=xb,C.flowRight=bb,C.fromPairs=i0,C.functions=bx,C.functionsIn=wx,C.groupBy=o_,C.initial=n0,C.intersection=s0,C.intersectionBy=a0,C.intersectionWith=o0,C.invert=Mx,C.invertBy=Ex,C.invokeMap=u_,C.iteratee=Ol,C.keyBy=c_,C.keys=Wt,C.keysIn=fi,C.map=xa,C.mapKeys=Ax,C.mapValues=Cx,C.matches=wb,C.matchesProperty=Sb,C.memoize=wa,C.merge=Px,C.mergeWith=od,C.method=Mb,C.methodOf=Eb,C.mixin=Nl,C.negate=Sa,C.nthArg=Ab,C.omit=Rx,C.omitBy=Ix,C.once=T_,C.orderBy=h_,C.over=Cb,C.overArgs=A_,C.overEvery=Pb,C.overSome=Rb,C.partial=Tl,C.partialRight=Kh,C.partition=d_,C.pick=Lx,C.pickBy=ld,C.property=md,C.propertyOf=Ib,C.pull=h0,C.pullAll=Hh,C.pullAllBy=d0,C.pullAllWith=f0,C.pullAt=p0,C.range=Lb,C.rangeRight=Ob,C.rearg=C_,C.reject=m_,C.remove=m0,C.rest=P_,C.reverse=Sl,C.sampleSize=v_,C.set=Nx,C.setWith=Dx,C.shuffle=y_,C.slice=g0,C.sortBy=b_,C.sortedUniq=S0,C.sortedUniqBy=M0,C.split=nb,C.spread=R_,C.tail=E0,C.take=T0,C.takeRight=A0,C.takeRightWhile=C0,C.takeWhile=P0,C.tap=W0,C.throttle=I_,C.thru=_a,C.toArray=rd,C.toPairs=ud,C.toPairsIn=cd,C.toPath=zb,C.toPlainObject=sd,C.transform=kx,C.unary=L_,C.union=R0,C.unionBy=I0,C.unionWith=L0,C.uniq=O0,C.uniqBy=N0,C.uniqWith=D0,C.unset=Fx,C.unzip=Ml,C.unzipWith=$h,C.update=zx,C.updateWith=Bx,C.values=kn,C.valuesIn=Ux,C.without=k0,C.words=fd,C.wrap=O_,C.xor=F0,C.xorBy=z0,C.xorWith=B0,C.zip=U0,C.zipObject=H0,C.zipObjectDeep=$0,C.zipWith=V0,C.entries=ud,C.entriesIn=cd,C.extend=ad,C.extendWith=Ta,Nl(C,C),C.add=Ub,C.attempt=pd,C.camelCase=Wx,C.capitalize=hd,C.ceil=Hb,C.clamp=Hx,C.clone=D_,C.cloneDeep=F_,C.cloneDeepWith=z_,C.cloneWith=k_,C.conformsTo=B_,C.deburr=dd,C.defaultTo=_b,C.divide=$b,C.endsWith=jx,C.eq=Vi,C.escape=Gx,C.escapeRegExp=qx,C.every=e_,C.find=i_,C.findIndex=Fh,C.findKey=mx,C.findLast=r_,C.findLastIndex=zh,C.findLastKey=gx,C.floor=Vb,C.forEach=Wh,C.forEachRight=jh,C.forIn=vx,C.forInRight=yx,C.forOwn=_x,C.forOwnRight=xx,C.get=Pl,C.gt=U_,C.gte=H_,C.has=Sx,C.hasIn=Rl,C.head=Uh,C.identity=pi,C.includes=l_,C.indexOf=r0,C.inRange=$x,C.invoke=Tx,C.isArguments=hn,C.isArray=Be,C.isArrayBuffer=$_,C.isArrayLike=di,C.isArrayLikeObject=Lt,C.isBoolean=V_,C.isBuffer=Br,C.isDate=W_,C.isElement=j_,C.isEmpty=G_,C.isEqual=q_,C.isEqualWith=X_,C.isError=Al,C.isFinite=Z_,C.isFunction=mr,C.isInteger=Qh,C.isLength=Ma,C.isMap=ed,C.isMatch=J_,C.isMatchWith=Y_,C.isNaN=K_,C.isNative=Q_,C.isNil=tx,C.isNull=ex,C.isNumber=td,C.isObject=St,C.isObjectLike=Tt,C.isPlainObject=ds,C.isRegExp=Cl,C.isSafeInteger=ix,C.isSet=id,C.isString=Ea,C.isSymbol=wi,C.isTypedArray=Dn,C.isUndefined=rx,C.isWeakMap=nx,C.isWeakSet=sx,C.join=l0,C.kebabCase=Xx,C.last=Di,C.lastIndexOf=u0,C.lowerCase=Zx,C.lowerFirst=Jx,C.lt=ax,C.lte=ox,C.max=Wb,C.maxBy=jb,C.mean=Gb,C.meanBy=qb,C.min=Xb,C.minBy=Zb,C.stubArray=kl,C.stubFalse=Fl,C.stubObject=Nb,C.stubString=Db,C.stubTrue=kb,C.multiply=Jb,C.nth=c0,C.noConflict=Tb,C.noop=Dl,C.now=ba,C.pad=Yx,C.padEnd=Kx,C.padStart=Qx,C.parseInt=eb,C.random=Vx,C.reduce=f_,C.reduceRight=p_,C.repeat=tb,C.replace=ib,C.result=Ox,C.round=Yb,C.runInContext=V,C.sample=g_,C.size=__,C.snakeCase=rb,C.some=x_,C.sortedIndex=v0,C.sortedIndexBy=y0,C.sortedIndexOf=_0,C.sortedLastIndex=x0,C.sortedLastIndexBy=b0,C.sortedLastIndexOf=w0,C.startCase=sb,C.startsWith=ab,C.subtract=Kb,C.sum=Qb,C.sumBy=e1,C.template=ob,C.times=Fb,C.toFinite=gr,C.toInteger=He,C.toLength=nd,C.toLower=lb,C.toNumber=ki,C.toSafeInteger=lx,C.toString=at,C.toUpper=ub,C.trim=cb,C.trimEnd=hb,C.trimStart=db,C.truncate=fb,C.unescape=pb,C.uniqueId=Bb,C.upperCase=mb,C.upperFirst=Il,C.each=Wh,C.eachRight=jh,C.first=Uh,Nl(C,function(){var a={};return Qi(C,function(u,p){ot.call(C.prototype,p)||(a[p]=u)}),a}(),{chain:!1}),C.VERSION=r,Ri(["bind","bindKey","curry","curryRight","partial","partialRight"],function(a){C[a].placeholder=C}),Ri(["drop","take"],function(a,u){Ye.prototype[a]=function(p){p=p===t?1:Ut(He(p),0);var x=this.__filtered__&&!u?new Ye(this):this.clone();return x.__filtered__?x.__takeCount__=ei(p,x.__takeCount__):x.__views__.push({size:ei(p,he),type:a+(x.__dir__<0?"Right":"")}),x},Ye.prototype[a+"Right"]=function(p){return this.reverse()[a](p).reverse()}}),Ri(["filter","map","takeWhile"],function(a,u){var p=u+1,x=p==Z||p==$;Ye.prototype[a]=function(M){var I=this.clone();return I.__iteratees__.push({iteratee:Pe(M,3),type:p}),I.__filtered__=I.__filtered__||x,I}}),Ri(["head","last"],function(a,u){var p="take"+(u?"Right":"");Ye.prototype[a]=function(){return this[p](1).value()[0]}}),Ri(["initial","tail"],function(a,u){var p="drop"+(u?"":"Right");Ye.prototype[a]=function(){return this.__filtered__?new Ye(this):this[p](1)}}),Ye.prototype.compact=function(){return this.filter(pi)},Ye.prototype.find=function(a){return this.filter(a).head()},Ye.prototype.findLast=function(a){return this.reverse().find(a)},Ye.prototype.invokeMap=We(function(a,u){return typeof a=="function"?new Ye(this):this.map(function(p){return as(p,a,u)})}),Ye.prototype.reject=function(a){return this.filter(Sa(Pe(a)))},Ye.prototype.slice=function(a,u){a=He(a);var p=this;return p.__filtered__&&(a>0||u<0)?new Ye(p):(a<0?p=p.takeRight(-a):a&&(p=p.drop(a)),u!==t&&(u=He(u),p=u<0?p.dropRight(-u):p.take(u-a)),p)},Ye.prototype.takeRightWhile=function(a){return this.reverse().takeWhile(a).reverse()},Ye.prototype.toArray=function(){return this.take(he)},Qi(Ye.prototype,function(a,u){var p=/^(?:filter|find|map|reject)|While$/.test(u),x=/^(?:head|last)$/.test(u),M=C[x?"take"+(u=="last"?"Right":""):u],I=x||/^find/.test(u);!M||(C.prototype[u]=function(){var k=this.__wrapped__,B=x?[1]:arguments,W=k instanceof Ye,ie=B[0],ne=W||Be(k),ue=function(Xe){var Ke=M.apply(C,Lr([Xe],B));return x&&ge?Ke[0]:Ke};ne&&p&&typeof ie=="function"&&ie.length!=1&&(W=ne=!1);var ge=this.__chain__,Me=!!this.__actions__.length,Re=I&&!ge,$e=W&&!Me;if(!I&&ne){k=$e?k:new Ye(this);var Ie=a.apply(k,B);return Ie.__actions__.push({func:_a,args:[ue],thisArg:t}),new Li(Ie,ge)}return Re&&$e?a.apply(this,B):(Ie=this.thru(ue),Re?x?Ie.value()[0]:Ie.value():Ie)})}),Ri(["pop","push","shift","sort","splice","unshift"],function(a){var u=js[a],p=/^(?:push|sort|unshift)$/.test(a)?"tap":"thru",x=/^(?:pop|shift)$/.test(a);C.prototype[a]=function(){var M=arguments;if(x&&!this.__chain__){var I=this.value();return u.apply(Be(I)?I:[],M)}return this[p](function(k){return u.apply(Be(k)?k:[],M)})}}),Qi(Ye.prototype,function(a,u){var p=C[u];if(p){var x=p.name+"";ot.call(Rn,x)||(Rn[x]=[]),Rn[x].push({name:u,func:p})}}),Rn[da(t,T).name]=[{name:"wrapper",func:t}],Ye.prototype.clone=pv,Ye.prototype.reverse=mv,Ye.prototype.value=gv,C.prototype.at=j0,C.prototype.chain=G0,C.prototype.commit=q0,C.prototype.next=X0,C.prototype.plant=J0,C.prototype.reverse=Y0,C.prototype.toJSON=C.prototype.valueOf=C.prototype.value=K0,C.prototype.first=C.prototype.head,Qn&&(C.prototype[Qn]=Z0),C},qr=qg();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(Gt._=qr,define(function(){return qr})):rn?((rn.exports=qr)._=qr,Oo._=qr):Gt._=qr}).call(i)}),aSe=Ua((i,e)=>{var t=1e3,r=t*60,n=r*60,l=n*24,c=l*7,h=l*365.25;e.exports=function(y,_){_=_||{};var b=typeof y;if(b==="string"&&y.length>0)return d(y);if(b==="number"&&isFinite(y))return _.long?m(y):f(y);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(y))};function d(y){if(y=String(y),!(y.length>100)){var _=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(y);if(_){var b=parseFloat(_[1]),S=(_[2]||"ms").toLowerCase();switch(S){case"years":case"year":case"yrs":case"yr":case"y":return b*h;case"weeks":case"week":case"w":return b*c;case"days":case"day":case"d":return b*l;case"hours":case"hour":case"hrs":case"hr":case"h":return b*n;case"minutes":case"minute":case"mins":case"min":case"m":return b*r;case"seconds":case"second":case"secs":case"sec":case"s":return b*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return b;default:return}}}}function f(y){var _=Math.abs(y);return _>=l?Math.round(y/l)+"d":_>=n?Math.round(y/n)+"h":_>=r?Math.round(y/r)+"m":_>=t?Math.round(y/t)+"s":y+"ms"}function m(y){var _=Math.abs(y);return _>=l?g(y,_,l,"day"):_>=n?g(y,_,n,"hour"):_>=r?g(y,_,r,"minute"):_>=t?g(y,_,t,"second"):y+" ms"}function g(y,_,b,S){var E=_>=b*1.5;return Math.round(y/b)+" "+S+(E?"s":"")}}),oSe=Ua((i,e)=>{function t(r){l.debug=l,l.default=l,l.coerce=g,l.disable=d,l.enable=h,l.enabled=f,l.humanize=aSe(),l.destroy=y,Object.keys(r).forEach(_=>{l[_]=r[_]}),l.names=[],l.skips=[],l.formatters={};function n(_){let b=0;for(let S=0;S<_.length;S++)b=(b<<5)-b+_.charCodeAt(S),b|=0;return l.colors[Math.abs(b)%l.colors.length]}l.selectColor=n;function l(_){let b,S=null,E,T;function A(...P){if(!A.enabled)return;let O=A,R=Number(new Date),D=R-(b||R);O.diff=D,O.prev=b,O.curr=R,b=R,P[0]=l.coerce(P[0]),typeof P[0]!="string"&&P.unshift("%O");let L=0;P[0]=P[0].replace(/%([a-zA-Z%])/g,(N,U)=>{if(N==="%%")return"%";L++;let F=l.formatters[U];if(typeof F=="function"){let z=P[L];N=F.call(O,z),P.splice(L,1),L--}return N}),l.formatArgs.call(O,P),(O.log||l.log).apply(O,P)}return A.namespace=_,A.useColors=l.useColors(),A.color=l.selectColor(_),A.extend=c,A.destroy=l.destroy,Object.defineProperty(A,"enabled",{enumerable:!0,configurable:!1,get:()=>S!==null?S:(E!==l.namespaces&&(E=l.namespaces,T=l.enabled(_)),T),set:P=>{S=P}}),typeof l.init=="function"&&l.init(A),A}function c(_,b){let S=l(this.namespace+(typeof b>"u"?":":b)+_);return S.log=this.log,S}function h(_){l.save(_),l.namespaces=_,l.names=[],l.skips=[];let b,S=(typeof _=="string"?_:"").split(/[\s,]+/),E=S.length;for(b=0;b<E;b++)!S[b]||(_=S[b].replace(/\*/g,".*?"),_[0]==="-"?l.skips.push(new RegExp("^"+_.slice(1)+"$")):l.names.push(new RegExp("^"+_+"$")))}function d(){let _=[...l.names.map(m),...l.skips.map(m).map(b=>"-"+b)].join(",");return l.enable(""),_}function f(_){if(_[_.length-1]==="*")return!0;let b,S;for(b=0,S=l.skips.length;b<S;b++)if(l.skips[b].test(_))return!1;for(b=0,S=l.names.length;b<S;b++)if(l.names[b].test(_))return!0;return!1}function m(_){return _.toString().substring(2,_.toString().length-2).replace(/\.\*\?$/,"*")}function g(_){return _ instanceof Error?_.stack||_.message:_}function y(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return l.enable(l.load()),l}e.exports=t}),lSe=Ua((i,e)=>{i.formatArgs=r,i.save=n,i.load=l,i.useColors=t,i.storage=c(),i.destroy=(()=>{let d=!1;return()=>{d||(d=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),i.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function t(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(d){if(d[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+d[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;let f="color: "+this.color;d.splice(1,0,f,"color: inherit");let m=0,g=0;d[0].replace(/%[a-zA-Z%]/g,y=>{y!=="%%"&&(m++,y==="%c"&&(g=m))}),d.splice(g,0,f)}i.log=console.debug||console.log||(()=>{});function n(d){try{d?i.storage.setItem("debug",d):i.storage.removeItem("debug")}catch{}}function l(){let d;try{d=i.storage.getItem("debug")}catch{}return!d&&typeof process<"u"&&"env"in process&&(d=Zwe.DEBUG),d}function c(){try{return localStorage}catch{}}e.exports=oSe()(i);var{formatters:h}=e.exports;h.j=function(d){try{return JSON.stringify(d)}catch(f){return"[UnexpectedJSONParseError]: "+f.message}}}),eU=Ua((i,e)=>{function t(r){var n=typeof r;return r!=null&&(n=="object"||n=="function")}e.exports=t}),uSe=Ua((i,e)=>{var t=typeof global=="object"&&global&&global.Object===Object&&global;e.exports=t}),eY=Ua((i,e)=>{var t=uSe(),r=typeof self=="object"&&self&&self.Object===Object&&self,n=t||r||Function("return this")();e.exports=n}),cSe=Ua((i,e)=>{var t=eY(),r=function(){return t.Date.now()};e.exports=r}),hSe=Ua((i,e)=>{var t=/\s/;function r(n){for(var l=n.length;l--&&t.test(n.charAt(l)););return l}e.exports=r}),dSe=Ua((i,e)=>{var t=hSe(),r=/^\s+/;function n(l){return l&&l.slice(0,t(l)+1).replace(r,"")}e.exports=n}),tY=Ua((i,e)=>{var t=eY(),r=t.Symbol;e.exports=r}),fSe=Ua((i,e)=>{var t=tY(),r=Object.prototype,n=r.hasOwnProperty,l=r.toString,c=t?t.toStringTag:void 0;function h(d){var f=n.call(d,c),m=d[c];try{d[c]=void 0;var g=!0}catch{}var y=l.call(d);return g&&(f?d[c]=m:delete d[c]),y}e.exports=h}),pSe=Ua((i,e)=>{var t=Object.prototype,r=t.toString;function n(l){return r.call(l)}e.exports=n}),mSe=Ua((i,e)=>{var t=tY(),r=fSe(),n=pSe(),l="[object Null]",c="[object Undefined]",h=t?t.toStringTag:void 0;function d(f){return f==null?f===void 0?c:l:h&&h in Object(f)?r(f):n(f)}e.exports=d}),gSe=Ua((i,e)=>{function t(r){return r!=null&&typeof r=="object"}e.exports=t}),vSe=Ua((i,e)=>{var t=mSe(),r=gSe(),n="[object Symbol]";function l(c){return typeof c=="symbol"||r(c)&&t(c)==n}e.exports=l}),ySe=Ua((i,e)=>{var t=dSe(),r=eU(),n=vSe(),l=NaN,c=/^[-+]0x[0-9a-f]+$/i,h=/^0b[01]+$/i,d=/^0o[0-7]+$/i,f=parseInt;function m(g){if(typeof g=="number")return g;if(n(g))return l;if(r(g)){var y=typeof g.valueOf=="function"?g.valueOf():g;g=r(y)?y+"":y}if(typeof g!="string")return g===0?g:+g;g=t(g);var _=h.test(g);return _||d.test(g)?f(g.slice(2),_?2:8):c.test(g)?l:+g}e.exports=m}),_Se=Ua((i,e)=>{var t=eU(),r=cSe(),n=ySe(),l="Expected a function",c=Math.max,h=Math.min;function d(f,m,g){var y,_,b,S,E,T,A=0,P=!1,O=!1,R=!0;if(typeof f!="function")throw new TypeError(l);m=n(m)||0,t(g)&&(P=!!g.leading,O="maxWait"in g,b=O?c(n(g.maxWait)||0,m):b,R="trailing"in g?!!g.trailing:R);function D(q){var $=y,H=_;return y=_=void 0,A=q,S=f.apply(H,$),S}function L(q){return A=q,E=setTimeout(F,m),P?D(q):S}function N(q){var $=q-T,H=q-A,X=m-$;return O?h(X,b-H):X}function U(q){var $=q-T,H=q-A;return T===void 0||$>=m||$<0||O&&H>=b}function F(){var q=r();if(U(q))return z(q);E=setTimeout(F,N(q))}function z(q){return E=void 0,R&&y?D(q):(y=_=void 0,S)}function G(){E!==void 0&&clearTimeout(E),A=0,y=T=_=E=void 0}function J(){return E===void 0?S:z(r())}function Z(){var q=r(),$=U(q);if(y=arguments,_=this,T=q,$){if(E===void 0)return L(T);if(O)return clearTimeout(E),E=setTimeout(F,m),D(T)}return E===void 0&&(E=setTimeout(F,m)),S}return Z.cancel=G,Z.flush=J,Z}e.exports=d}),xSe=Ua((i,e)=>{var t=_Se(),r=eU(),n="Expected a function";function l(c,h,d){var f=!0,m=!0;if(typeof c!="function")throw new TypeError(n);return r(d)&&(f="leading"in d?!!d.leading:f,m="trailing"in d?!!d.trailing:m),t(c,h,{leading:f,maxWait:h,trailing:m})}e.exports=l}),cS=QB(sSe()),iY="157",JM=0,rY=1,tU=2,gW=1,bSe=2,wSe=100,SSe=204,MSe=205,ESe=3,TSe=0,nY=300,ASe=301,iC=1e3,z1=1001,i4=1002,dw=1003,CSe=1004,PSe=1005,xL=1006,RSe=1007,iU=1008,ISe=1009,sY=1015,aY=1023,LSe=2200,OSe=2201,NSe=2202,rC=2300,YM=2301,nD=2302,iM=2400,rM=2401,lI=2402,rU=2500,DSe=2501,kSe=0,oY=1,r4=2,FSe=3e3,sD=3001,zSe=0,rR="",bo="srgb",Kd="srgb-linear",BSe="display-p3",lY="display-p3-linear",n4="linear",vW="srgb",yW="rec709",_W="p3",aD=7680,USe=519,s4=35044,B1=2e3,a4=2001,FC=class{addEventListener(i,e){this._listeners===void 0&&(this._listeners={});let t=this._listeners;t[i]===void 0&&(t[i]=[]),t[i].indexOf(e)===-1&&t[i].push(e)}hasEventListener(i,e){if(this._listeners===void 0)return!1;let t=this._listeners;return t[i]!==void 0&&t[i].indexOf(e)!==-1}removeEventListener(i,e){if(this._listeners===void 0)return;let t=this._listeners[i];if(t!==void 0){let r=t.indexOf(e);r!==-1&&t.splice(r,1)}}dispatchEvent(i){if(this._listeners===void 0)return;let e=this._listeners[i.type];if(e!==void 0){i.target=this;let t=e.slice(0);for(let r=0,n=t.length;r<n;r++)t[r].call(this,i);i.target=null}}},go=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],xW=1234567,iA=Math.PI/180,nC=180/Math.PI;function Gd(){let i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(go[i&255]+go[i>>8&255]+go[i>>16&255]+go[i>>24&255]+"-"+go[e&255]+go[e>>8&255]+"-"+go[e>>16&15|64]+go[e>>24&255]+"-"+go[t&63|128]+go[t>>8&255]+"-"+go[t>>16&255]+go[t>>24&255]+go[r&255]+go[r>>8&255]+go[r>>16&255]+go[r>>24&255]).toLowerCase()}function La(i,e,t){return Math.max(e,Math.min(t,i))}function nU(i,e){return(i%e+e)%e}function HSe(i,e,t,r,n){return r+(i-e)*(n-r)/(t-e)}function $Se(i,e,t){return i!==e?(t-i)/(e-i):0}function rA(i,e,t){return(1-t)*i+t*e}function VSe(i,e,t,r){return rA(i,e,1-Math.exp(-t*r))}function WSe(i,e=1){return e-Math.abs(nU(i,e*2)-e)}function jSe(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*(3-2*i))}function GSe(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*i*(i*(i*6-15)+10))}function qSe(i,e){return i+Math.floor(Math.random()*(e-i+1))}function XSe(i,e){return i+Math.random()*(e-i)}function ZSe(i){return i*(.5-Math.random())}function JSe(i){i!==void 0&&(xW=i);let e=xW+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function YSe(i){return i*iA}function KSe(i){return i*nC}function QSe(i){return(i&i-1)===0&&i!==0}function uY(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function eMe(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function tMe(i,e,t,r,n){let l=Math.cos,c=Math.sin,h=l(t/2),d=c(t/2),f=l((e+r)/2),m=c((e+r)/2),g=l((e-r)/2),y=c((e-r)/2),_=l((r-e)/2),b=c((r-e)/2);switch(n){case"XYX":i.set(h*m,d*g,d*y,h*f);break;case"YZY":i.set(d*y,h*m,d*g,h*f);break;case"ZXZ":i.set(d*g,d*y,h*m,h*f);break;case"XZX":i.set(h*m,d*b,d*_,h*f);break;case"YXY":i.set(d*_,h*m,d*b,h*f);break;case"ZYZ":i.set(d*b,d*_,h*m,h*f);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}function pf(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function yn(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}var iMe={DEG2RAD:iA,RAD2DEG:nC,generateUUID:Gd,clamp:La,euclideanModulo:nU,mapLinear:HSe,inverseLerp:$Se,lerp:rA,damp:VSe,pingpong:WSe,smoothstep:jSe,smootherstep:GSe,randInt:qSe,randFloat:XSe,randFloatSpread:ZSe,seededRandom:JSe,degToRad:YSe,radToDeg:KSe,isPowerOfTwo:QSe,ceilPowerOfTwo:uY,floorPowerOfTwo:eMe,setQuaternionFromProperEuler:tMe,normalize:yn,denormalize:pf},mi=class{constructor(e=0,t=0){mi.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,r=this.y,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6],this.y=n[1]*t+n[4]*r+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let r=this.dot(e)/t;return Math.acos(La(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let r=Math.cos(t),n=Math.sin(t),l=this.x-e.x,c=this.y-e.y;return this.x=l*r-c*n+e.x,this.y=l*n+c*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},Er=class{constructor(i,e,t,r,n,l,c,h,d){Er.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],i!==void 0&&this.set(i,e,t,r,n,l,c,h,d)}set(i,e,t,r,n,l,c,h,d){let f=this.elements;return f[0]=i,f[1]=r,f[2]=c,f[3]=e,f[4]=n,f[5]=h,f[6]=t,f[7]=l,f[8]=d,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(i){let e=this.elements,t=i.elements;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this}extractBasis(i,e,t){return i.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),t.setFromMatrix3Column(this,2),this}setFromMatrix4(i){let e=i.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(i){return this.multiplyMatrices(this,i)}premultiply(i){return this.multiplyMatrices(i,this)}multiplyMatrices(i,e){let t=i.elements,r=e.elements,n=this.elements,l=t[0],c=t[3],h=t[6],d=t[1],f=t[4],m=t[7],g=t[2],y=t[5],_=t[8],b=r[0],S=r[3],E=r[6],T=r[1],A=r[4],P=r[7],O=r[2],R=r[5],D=r[8];return n[0]=l*b+c*T+h*O,n[3]=l*S+c*A+h*R,n[6]=l*E+c*P+h*D,n[1]=d*b+f*T+m*O,n[4]=d*S+f*A+m*R,n[7]=d*E+f*P+m*D,n[2]=g*b+y*T+_*O,n[5]=g*S+y*A+_*R,n[8]=g*E+y*P+_*D,this}multiplyScalar(i){let e=this.elements;return e[0]*=i,e[3]*=i,e[6]*=i,e[1]*=i,e[4]*=i,e[7]*=i,e[2]*=i,e[5]*=i,e[8]*=i,this}determinant(){let i=this.elements,e=i[0],t=i[1],r=i[2],n=i[3],l=i[4],c=i[5],h=i[6],d=i[7],f=i[8];return e*l*f-e*c*d-t*n*f+t*c*h+r*n*d-r*l*h}invert(){let i=this.elements,e=i[0],t=i[1],r=i[2],n=i[3],l=i[4],c=i[5],h=i[6],d=i[7],f=i[8],m=f*l-c*d,g=c*h-f*n,y=d*n-l*h,_=e*m+t*g+r*y;if(_===0)return this.set(0,0,0,0,0,0,0,0,0);let b=1/_;return i[0]=m*b,i[1]=(r*d-f*t)*b,i[2]=(c*t-r*l)*b,i[3]=g*b,i[4]=(f*e-r*h)*b,i[5]=(r*n-c*e)*b,i[6]=y*b,i[7]=(t*h-d*e)*b,i[8]=(l*e-t*n)*b,this}transpose(){let i,e=this.elements;return i=e[1],e[1]=e[3],e[3]=i,i=e[2],e[2]=e[6],e[6]=i,i=e[5],e[5]=e[7],e[7]=i,this}getNormalMatrix(i){return this.setFromMatrix4(i).invert().transpose()}transposeIntoArray(i){let e=this.elements;return i[0]=e[0],i[1]=e[3],i[2]=e[6],i[3]=e[1],i[4]=e[4],i[5]=e[7],i[6]=e[2],i[7]=e[5],i[8]=e[8],this}setUvTransform(i,e,t,r,n,l,c){let h=Math.cos(n),d=Math.sin(n);return this.set(t*h,t*d,-t*(h*l+d*c)+l+i,-r*d,r*h,-r*(-d*l+h*c)+c+e,0,0,1),this}scale(i,e){return this.premultiply(oD.makeScale(i,e)),this}rotate(i){return this.premultiply(oD.makeRotation(-i)),this}translate(i,e){return this.premultiply(oD.makeTranslation(i,e)),this}makeTranslation(i,e){return i.isVector2?this.set(1,0,i.x,0,1,i.y,0,0,1):this.set(1,0,i,0,1,e,0,0,1),this}makeRotation(i){let e=Math.cos(i),t=Math.sin(i);return this.set(e,-t,0,t,e,0,0,0,1),this}makeScale(i,e){return this.set(i,0,0,0,e,0,0,0,1),this}equals(i){let e=this.elements,t=i.elements;for(let r=0;r<9;r++)if(e[r]!==t[r])return!1;return!0}fromArray(i,e=0){for(let t=0;t<9;t++)this.elements[t]=i[t+e];return this}toArray(i=[],e=0){let t=this.elements;return i[e]=t[0],i[e+1]=t[1],i[e+2]=t[2],i[e+3]=t[3],i[e+4]=t[4],i[e+5]=t[5],i[e+6]=t[6],i[e+7]=t[7],i[e+8]=t[8],i}clone(){return new this.constructor().fromArray(this.elements)}},oD=new Er;function rMe(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}function o4(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}var bW={};function lD(i){i in bW||(bW[i]=!0,console.warn(i))}var wW=new Er().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),SW=new Er().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),j3={[Kd]:{transfer:n4,primaries:yW,toReference:i=>i,fromReference:i=>i},[bo]:{transfer:vW,primaries:yW,toReference:i=>i.convertSRGBToLinear(),fromReference:i=>i.convertLinearToSRGB()},[lY]:{transfer:n4,primaries:_W,toReference:i=>i.applyMatrix3(SW),fromReference:i=>i.applyMatrix3(wW)},[BSe]:{transfer:vW,primaries:_W,toReference:i=>i.convertSRGBToLinear().applyMatrix3(SW),fromReference:i=>i.applyMatrix3(wW).convertLinearToSRGB()}},nMe=new Set([Kd,lY]),Cu={enabled:!0,_workingColorSpace:Kd,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(i){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!i},get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(i){if(!nMe.has(i))throw new Error(`Unsupported working color space, "${i}".`);this._workingColorSpace=i},convert:function(i,e,t){if(this.enabled===!1||e===t||!e||!t)return i;let r=j3[e].toReference,n=j3[t].fromReference;return n(r(i))},fromWorkingColorSpace:function(i,e){return this.convert(i,this._workingColorSpace,e)},toWorkingColorSpace:function(i,e){return this.convert(i,e,this._workingColorSpace)},getPrimaries:function(i){return j3[i].primaries},getTransfer:function(i){return i===rR?n4:j3[i].transfer}};function xM(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function uD(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}var hS,sMe=class{static getDataURL(i){if(/^data:/i.test(i.src)||typeof HTMLCanvasElement>"u")return i.src;let e;if(i instanceof HTMLCanvasElement)e=i;else{hS===void 0&&(hS=o4("canvas")),hS.width=i.width,hS.height=i.height;let t=hS.getContext("2d");i instanceof ImageData?t.putImageData(i,0,0):t.drawImage(i,0,0,i.width,i.height),e=hS}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",i),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(i){if(typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap){let e=o4("canvas");e.width=i.width,e.height=i.height;let t=e.getContext("2d");t.drawImage(i,0,0,i.width,i.height);let r=t.getImageData(0,0,i.width,i.height),n=r.data;for(let l=0;l<n.length;l++)n[l]=xM(n[l]/255)*255;return t.putImageData(r,0,0),e}else if(i.data){let e=i.data.slice(0);for(let t=0;t<e.length;t++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[t]=Math.floor(xM(e[t]/255)*255):e[t]=xM(e[t]);return{data:e,width:i.width,height:i.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),i}},aMe=0,oMe=class{constructor(i=null){this.isSource=!0,Object.defineProperty(this,"id",{value:aMe++}),this.uuid=Gd(),this.data=i,this.version=0}set needsUpdate(i){i===!0&&this.version++}toJSON(i){let e=i===void 0||typeof i=="string";if(!e&&i.images[this.uuid]!==void 0)return i.images[this.uuid];let t={uuid:this.uuid,url:""},r=this.data;if(r!==null){let n;if(Array.isArray(r)){n=[];for(let l=0,c=r.length;l<c;l++)r[l].isDataTexture?n.push(cD(r[l].image)):n.push(cD(r[l]))}else n=cD(r);t.url=n}return e||(i.images[this.uuid]=t),t}};function cD(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?sMe.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var lMe=0,Eo=class extends FC{constructor(i=Eo.DEFAULT_IMAGE,e=Eo.DEFAULT_MAPPING,t=z1,r=z1,n=xL,l=iU,c=aY,h=ISe,d=Eo.DEFAULT_ANISOTROPY,f=rR){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:lMe++}),this.uuid=Gd(),this.name="",this.source=new oMe(i),this.mipmaps=[],this.mapping=e,this.channel=0,this.wrapS=t,this.wrapT=r,this.magFilter=n,this.minFilter=l,this.anisotropy=d,this.format=c,this.internalFormat=null,this.type=h,this.offset=new mi(0,0),this.repeat=new mi(1,1),this.center=new mi(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Er,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof f=="string"?this.colorSpace=f:(lD("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=f===sD?bo:rR),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(i=null){this.source.data=i}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(i){return this.name=i.name,this.source=i.source,this.mipmaps=i.mipmaps.slice(0),this.mapping=i.mapping,this.channel=i.channel,this.wrapS=i.wrapS,this.wrapT=i.wrapT,this.magFilter=i.magFilter,this.minFilter=i.minFilter,this.anisotropy=i.anisotropy,this.format=i.format,this.internalFormat=i.internalFormat,this.type=i.type,this.offset.copy(i.offset),this.repeat.copy(i.repeat),this.center.copy(i.center),this.rotation=i.rotation,this.matrixAutoUpdate=i.matrixAutoUpdate,this.matrix.copy(i.matrix),this.generateMipmaps=i.generateMipmaps,this.premultiplyAlpha=i.premultiplyAlpha,this.flipY=i.flipY,this.unpackAlignment=i.unpackAlignment,this.colorSpace=i.colorSpace,this.userData=JSON.parse(JSON.stringify(i.userData)),this.needsUpdate=!0,this}toJSON(i){let e=i===void 0||typeof i=="string";if(!e&&i.textures[this.uuid]!==void 0)return i.textures[this.uuid];let t={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(i).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(t.userData=this.userData),e||(i.textures[this.uuid]=t),t}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(i){if(this.mapping!==nY)return i;if(i.applyMatrix3(this.matrix),i.x<0||i.x>1)switch(this.wrapS){case iC:i.x=i.x-Math.floor(i.x);break;case z1:i.x=i.x<0?0:1;break;case i4:Math.abs(Math.floor(i.x)%2)===1?i.x=Math.ceil(i.x)-i.x:i.x=i.x-Math.floor(i.x);break}if(i.y<0||i.y>1)switch(this.wrapT){case iC:i.y=i.y-Math.floor(i.y);break;case z1:i.y=i.y<0?0:1;break;case i4:Math.abs(Math.floor(i.y)%2)===1?i.y=Math.ceil(i.y)-i.y:i.y=i.y-Math.floor(i.y);break}return this.flipY&&(i.y=1-i.y),i}set needsUpdate(i){i===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return lD("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===bo?sD:FSe}set encoding(i){lD("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=i===sD?bo:rR}};Eo.DEFAULT_IMAGE=null;Eo.DEFAULT_MAPPING=nY;Eo.DEFAULT_ANISOTROPY=1;var Fd=class{constructor(i=0,e=0,t=0,r=1){Fd.prototype.isVector4=!0,this.x=i,this.y=e,this.z=t,this.w=r}get width(){return this.z}set width(i){this.z=i}get height(){return this.w}set height(i){this.w=i}set(i,e,t,r){return this.x=i,this.y=e,this.z=t,this.w=r,this}setScalar(i){return this.x=i,this.y=i,this.z=i,this.w=i,this}setX(i){return this.x=i,this}setY(i){return this.y=i,this}setZ(i){return this.z=i,this}setW(i){return this.w=i,this}setComponent(i,e){switch(i){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+i)}return this}getComponent(i){switch(i){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+i)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(i){return this.x=i.x,this.y=i.y,this.z=i.z,this.w=i.w!==void 0?i.w:1,this}add(i){return this.x+=i.x,this.y+=i.y,this.z+=i.z,this.w+=i.w,this}addScalar(i){return this.x+=i,this.y+=i,this.z+=i,this.w+=i,this}addVectors(i,e){return this.x=i.x+e.x,this.y=i.y+e.y,this.z=i.z+e.z,this.w=i.w+e.w,this}addScaledVector(i,e){return this.x+=i.x*e,this.y+=i.y*e,this.z+=i.z*e,this.w+=i.w*e,this}sub(i){return this.x-=i.x,this.y-=i.y,this.z-=i.z,this.w-=i.w,this}subScalar(i){return this.x-=i,this.y-=i,this.z-=i,this.w-=i,this}subVectors(i,e){return this.x=i.x-e.x,this.y=i.y-e.y,this.z=i.z-e.z,this.w=i.w-e.w,this}multiply(i){return this.x*=i.x,this.y*=i.y,this.z*=i.z,this.w*=i.w,this}multiplyScalar(i){return this.x*=i,this.y*=i,this.z*=i,this.w*=i,this}applyMatrix4(i){let e=this.x,t=this.y,r=this.z,n=this.w,l=i.elements;return this.x=l[0]*e+l[4]*t+l[8]*r+l[12]*n,this.y=l[1]*e+l[5]*t+l[9]*r+l[13]*n,this.z=l[2]*e+l[6]*t+l[10]*r+l[14]*n,this.w=l[3]*e+l[7]*t+l[11]*r+l[15]*n,this}divideScalar(i){return this.multiplyScalar(1/i)}setAxisAngleFromQuaternion(i){this.w=2*Math.acos(i.w);let e=Math.sqrt(1-i.w*i.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=i.x/e,this.y=i.y/e,this.z=i.z/e),this}setAxisAngleFromRotationMatrix(i){let e,t,r,n,l=i.elements,c=l[0],h=l[4],d=l[8],f=l[1],m=l[5],g=l[9],y=l[2],_=l[6],b=l[10];if(Math.abs(h-f)<.01&&Math.abs(d-y)<.01&&Math.abs(g-_)<.01){if(Math.abs(h+f)<.1&&Math.abs(d+y)<.1&&Math.abs(g+_)<.1&&Math.abs(c+m+b-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;let E=(c+1)/2,T=(m+1)/2,A=(b+1)/2,P=(h+f)/4,O=(d+y)/4,R=(g+_)/4;return E>T&&E>A?E<.01?(t=0,r=.707106781,n=.707106781):(t=Math.sqrt(E),r=P/t,n=O/t):T>A?T<.01?(t=.707106781,r=0,n=.707106781):(r=Math.sqrt(T),t=P/r,n=R/r):A<.01?(t=.707106781,r=.707106781,n=0):(n=Math.sqrt(A),t=O/n,r=R/n),this.set(t,r,n,e),this}let S=Math.sqrt((_-g)*(_-g)+(d-y)*(d-y)+(f-h)*(f-h));return Math.abs(S)<.001&&(S=1),this.x=(_-g)/S,this.y=(d-y)/S,this.z=(f-h)/S,this.w=Math.acos((c+m+b-1)/2),this}min(i){return this.x=Math.min(this.x,i.x),this.y=Math.min(this.y,i.y),this.z=Math.min(this.z,i.z),this.w=Math.min(this.w,i.w),this}max(i){return this.x=Math.max(this.x,i.x),this.y=Math.max(this.y,i.y),this.z=Math.max(this.z,i.z),this.w=Math.max(this.w,i.w),this}clamp(i,e){return this.x=Math.max(i.x,Math.min(e.x,this.x)),this.y=Math.max(i.y,Math.min(e.y,this.y)),this.z=Math.max(i.z,Math.min(e.z,this.z)),this.w=Math.max(i.w,Math.min(e.w,this.w)),this}clampScalar(i,e){return this.x=Math.max(i,Math.min(e,this.x)),this.y=Math.max(i,Math.min(e,this.y)),this.z=Math.max(i,Math.min(e,this.z)),this.w=Math.max(i,Math.min(e,this.w)),this}clampLength(i,e){let t=this.length();return this.divideScalar(t||1).multiplyScalar(Math.max(i,Math.min(e,t)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(i){return this.x*i.x+this.y*i.y+this.z*i.z+this.w*i.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(i){return this.normalize().multiplyScalar(i)}lerp(i,e){return this.x+=(i.x-this.x)*e,this.y+=(i.y-this.y)*e,this.z+=(i.z-this.z)*e,this.w+=(i.w-this.w)*e,this}lerpVectors(i,e,t){return this.x=i.x+(e.x-i.x)*t,this.y=i.y+(e.y-i.y)*t,this.z=i.z+(e.z-i.z)*t,this.w=i.w+(e.w-i.w)*t,this}equals(i){return i.x===this.x&&i.y===this.y&&i.z===this.z&&i.w===this.w}fromArray(i,e=0){return this.x=i[e],this.y=i[e+1],this.z=i[e+2],this.w=i[e+3],this}toArray(i=[],e=0){return i[e]=this.x,i[e+1]=this.y,i[e+2]=this.z,i[e+3]=this.w,i}fromBufferAttribute(i,e){return this.x=i.getX(e),this.y=i.getY(e),this.z=i.getZ(e),this.w=i.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},uMe=class extends Eo{constructor(i=null,e=1,t=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:i,width:e,height:t,depth:r},this.magFilter=dw,this.minFilter=dw,this.wrapR=z1,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},cMe=class extends Eo{constructor(i=null,e=1,t=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:i,width:e,height:t,depth:r},this.magFilter=dw,this.minFilter=dw,this.wrapR=z1,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},pu=class{constructor(i=0,e=0,t=0,r=1){this.isQuaternion=!0,this._x=i,this._y=e,this._z=t,this._w=r}static slerpFlat(i,e,t,r,n,l,c){let h=t[r+0],d=t[r+1],f=t[r+2],m=t[r+3],g=n[l+0],y=n[l+1],_=n[l+2],b=n[l+3];if(c===0){i[e+0]=h,i[e+1]=d,i[e+2]=f,i[e+3]=m;return}if(c===1){i[e+0]=g,i[e+1]=y,i[e+2]=_,i[e+3]=b;return}if(m!==b||h!==g||d!==y||f!==_){let S=1-c,E=h*g+d*y+f*_+m*b,T=E>=0?1:-1,A=1-E*E;if(A>Number.EPSILON){let O=Math.sqrt(A),R=Math.atan2(O,E*T);S=Math.sin(S*R)/O,c=Math.sin(c*R)/O}let P=c*T;if(h=h*S+g*P,d=d*S+y*P,f=f*S+_*P,m=m*S+b*P,S===1-c){let O=1/Math.sqrt(h*h+d*d+f*f+m*m);h*=O,d*=O,f*=O,m*=O}}i[e]=h,i[e+1]=d,i[e+2]=f,i[e+3]=m}static multiplyQuaternionsFlat(i,e,t,r,n,l){let c=t[r],h=t[r+1],d=t[r+2],f=t[r+3],m=n[l],g=n[l+1],y=n[l+2],_=n[l+3];return i[e]=c*_+f*m+h*y-d*g,i[e+1]=h*_+f*g+d*m-c*y,i[e+2]=d*_+f*y+c*g-h*m,i[e+3]=f*_-c*m-h*g-d*y,i}get x(){return this._x}set x(i){this._x=i,this._onChangeCallback()}get y(){return this._y}set y(i){this._y=i,this._onChangeCallback()}get z(){return this._z}set z(i){this._z=i,this._onChangeCallback()}get w(){return this._w}set w(i){this._w=i,this._onChangeCallback()}set(i,e,t,r){return this._x=i,this._y=e,this._z=t,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(i){return this._x=i.x,this._y=i.y,this._z=i.z,this._w=i.w,this._onChangeCallback(),this}setFromEuler(i,e){let t=i._x,r=i._y,n=i._z,l=i._order,c=Math.cos,h=Math.sin,d=c(t/2),f=c(r/2),m=c(n/2),g=h(t/2),y=h(r/2),_=h(n/2);switch(l){case"XYZ":this._x=g*f*m+d*y*_,this._y=d*y*m-g*f*_,this._z=d*f*_+g*y*m,this._w=d*f*m-g*y*_;break;case"YXZ":this._x=g*f*m+d*y*_,this._y=d*y*m-g*f*_,this._z=d*f*_-g*y*m,this._w=d*f*m+g*y*_;break;case"ZXY":this._x=g*f*m-d*y*_,this._y=d*y*m+g*f*_,this._z=d*f*_+g*y*m,this._w=d*f*m-g*y*_;break;case"ZYX":this._x=g*f*m-d*y*_,this._y=d*y*m+g*f*_,this._z=d*f*_-g*y*m,this._w=d*f*m+g*y*_;break;case"YZX":this._x=g*f*m+d*y*_,this._y=d*y*m+g*f*_,this._z=d*f*_-g*y*m,this._w=d*f*m-g*y*_;break;case"XZY":this._x=g*f*m-d*y*_,this._y=d*y*m-g*f*_,this._z=d*f*_+g*y*m,this._w=d*f*m+g*y*_;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+l)}return e!==!1&&this._onChangeCallback(),this}setFromAxisAngle(i,e){let t=e/2,r=Math.sin(t);return this._x=i.x*r,this._y=i.y*r,this._z=i.z*r,this._w=Math.cos(t),this._onChangeCallback(),this}setFromRotationMatrix(i){let e=i.elements,t=e[0],r=e[4],n=e[8],l=e[1],c=e[5],h=e[9],d=e[2],f=e[6],m=e[10],g=t+c+m;if(g>0){let y=.5/Math.sqrt(g+1);this._w=.25/y,this._x=(f-h)*y,this._y=(n-d)*y,this._z=(l-r)*y}else if(t>c&&t>m){let y=2*Math.sqrt(1+t-c-m);this._w=(f-h)/y,this._x=.25*y,this._y=(r+l)/y,this._z=(n+d)/y}else if(c>m){let y=2*Math.sqrt(1+c-t-m);this._w=(n-d)/y,this._x=(r+l)/y,this._y=.25*y,this._z=(h+f)/y}else{let y=2*Math.sqrt(1+m-t-c);this._w=(l-r)/y,this._x=(n+d)/y,this._y=(h+f)/y,this._z=.25*y}return this._onChangeCallback(),this}setFromUnitVectors(i,e){let t=i.dot(e)+1;return t<Number.EPSILON?(t=0,Math.abs(i.x)>Math.abs(i.z)?(this._x=-i.y,this._y=i.x,this._z=0,this._w=t):(this._x=0,this._y=-i.z,this._z=i.y,this._w=t)):(this._x=i.y*e.z-i.z*e.y,this._y=i.z*e.x-i.x*e.z,this._z=i.x*e.y-i.y*e.x,this._w=t),this.normalize()}angleTo(i){return 2*Math.acos(Math.abs(La(this.dot(i),-1,1)))}rotateTowards(i,e){let t=this.angleTo(i);if(t===0)return this;let r=Math.min(1,e/t);return this.slerp(i,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(i){return this._x*i._x+this._y*i._y+this._z*i._z+this._w*i._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let i=this.length();return i===0?(this._x=0,this._y=0,this._z=0,this._w=1):(i=1/i,this._x=this._x*i,this._y=this._y*i,this._z=this._z*i,this._w=this._w*i),this._onChangeCallback(),this}multiply(i){return this.multiplyQuaternions(this,i)}premultiply(i){return this.multiplyQuaternions(i,this)}multiplyQuaternions(i,e){let t=i._x,r=i._y,n=i._z,l=i._w,c=e._x,h=e._y,d=e._z,f=e._w;return this._x=t*f+l*c+r*d-n*h,this._y=r*f+l*h+n*c-t*d,this._z=n*f+l*d+t*h-r*c,this._w=l*f-t*c-r*h-n*d,this._onChangeCallback(),this}slerp(i,e){if(e===0)return this;if(e===1)return this.copy(i);let t=this._x,r=this._y,n=this._z,l=this._w,c=l*i._w+t*i._x+r*i._y+n*i._z;if(c<0?(this._w=-i._w,this._x=-i._x,this._y=-i._y,this._z=-i._z,c=-c):this.copy(i),c>=1)return this._w=l,this._x=t,this._y=r,this._z=n,this;let h=1-c*c;if(h<=Number.EPSILON){let y=1-e;return this._w=y*l+e*this._w,this._x=y*t+e*this._x,this._y=y*r+e*this._y,this._z=y*n+e*this._z,this.normalize(),this._onChangeCallback(),this}let d=Math.sqrt(h),f=Math.atan2(d,c),m=Math.sin((1-e)*f)/d,g=Math.sin(e*f)/d;return this._w=l*m+this._w*g,this._x=t*m+this._x*g,this._y=r*m+this._y*g,this._z=n*m+this._z*g,this._onChangeCallback(),this}slerpQuaternions(i,e,t){return this.copy(i).slerp(e,t)}random(){let i=Math.random(),e=Math.sqrt(1-i),t=Math.sqrt(i),r=2*Math.PI*Math.random(),n=2*Math.PI*Math.random();return this.set(e*Math.cos(r),t*Math.sin(n),t*Math.cos(n),e*Math.sin(r))}equals(i){return i._x===this._x&&i._y===this._y&&i._z===this._z&&i._w===this._w}fromArray(i,e=0){return this._x=i[e],this._y=i[e+1],this._z=i[e+2],this._w=i[e+3],this._onChangeCallback(),this}toArray(i=[],e=0){return i[e]=this._x,i[e+1]=this._y,i[e+2]=this._z,i[e+3]=this._w,i}fromBufferAttribute(i,e){return this._x=i.getX(e),this._y=i.getY(e),this._z=i.getZ(e),this._w=i.getW(e),this}toJSON(){return this.toArray()}_onChange(i){return this._onChangeCallback=i,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},Se=class{constructor(e=0,t=0,r=0){Se.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(MW.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(MW.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,r=this.y,n=this.z,l=e.elements;return this.x=l[0]*t+l[3]*r+l[6]*n,this.y=l[1]*t+l[4]*r+l[7]*n,this.z=l[2]*t+l[5]*r+l[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,r=this.y,n=this.z,l=e.elements,c=1/(l[3]*t+l[7]*r+l[11]*n+l[15]);return this.x=(l[0]*t+l[4]*r+l[8]*n+l[12])*c,this.y=(l[1]*t+l[5]*r+l[9]*n+l[13])*c,this.z=(l[2]*t+l[6]*r+l[10]*n+l[14])*c,this}applyQuaternion(e){let t=this.x,r=this.y,n=this.z,l=e.x,c=e.y,h=e.z,d=e.w,f=d*t+c*n-h*r,m=d*r+h*t-l*n,g=d*n+l*r-c*t,y=-l*t-c*r-h*n;return this.x=f*d+y*-l+m*-h-g*-c,this.y=m*d+y*-c+g*-l-f*-h,this.z=g*d+y*-h+f*-c-m*-l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,r=this.y,n=this.z,l=e.elements;return this.x=l[0]*t+l[4]*r+l[8]*n,this.y=l[1]*t+l[5]*r+l[9]*n,this.z=l[2]*t+l[6]*r+l[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let r=e.x,n=e.y,l=e.z,c=t.x,h=t.y,d=t.z;return this.x=n*d-l*h,this.y=l*c-r*d,this.z=r*h-n*c,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return hD.copy(this).projectOnVector(e),this.sub(hD)}reflect(e){return this.sub(hD.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let r=this.dot(e)/t;return Math.acos(La(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){let n=Math.sin(t)*e;return this.x=n*Math.sin(r),this.y=Math.cos(t)*e,this.z=n*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=n,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,r=Math.sqrt(1-QJ(e,2));return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},hD=new Se,MW=new pu,Co=class{constructor(e=new Se(1/0,1/0,1/0),t=new Se(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t+=3)this.expandByPoint(Kf.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,r=e.count;t<r;t++)this.expandByPoint(Kf.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=Kf.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){if(e.updateWorldMatrix(!1,!1),e.boundingBox!==void 0)e.boundingBox===null&&e.computeBoundingBox(),dS.copy(e.boundingBox),dS.applyMatrix4(e.matrixWorld),this.union(dS);else{let n=e.geometry;if(n!==void 0)if(t&&n.attributes!==void 0&&n.attributes.position!==void 0){let l=n.attributes.position;for(let c=0,h=l.count;c<h;c++)Kf.fromBufferAttribute(l,c).applyMatrix4(e.matrixWorld),this.expandByPoint(Kf)}else n.boundingBox===null&&n.computeBoundingBox(),dS.copy(n.boundingBox),dS.applyMatrix4(e.matrixWorld),this.union(dS)}let r=e.children;for(let n=0,l=r.length;n<l;n++)this.expandByObject(r[n],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Kf),Kf.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(dT),G3.subVectors(this.max,dT),fS.subVectors(e.a,dT),pS.subVectors(e.b,dT),mS.subVectors(e.c,dT),um.subVectors(pS,fS),cm.subVectors(mS,pS),p1.subVectors(fS,mS);let t=[0,-um.z,um.y,0,-cm.z,cm.y,0,-p1.z,p1.y,um.z,0,-um.x,cm.z,0,-cm.x,p1.z,0,-p1.x,-um.y,um.x,0,-cm.y,cm.x,0,-p1.y,p1.x,0];return!dD(t,fS,pS,mS,G3)||(t=[1,0,0,0,1,0,0,0,1],!dD(t,fS,pS,mS,G3))?!1:(q3.crossVectors(um,cm),t=[q3.x,q3.y,q3.z],dD(t,fS,pS,mS,G3))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Kf).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Kf).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Yf[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Yf[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Yf[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Yf[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Yf[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Yf[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Yf[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Yf[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Yf),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},Yf=[new Se,new Se,new Se,new Se,new Se,new Se,new Se,new Se],Kf=new Se,dS=new Co,fS=new Se,pS=new Se,mS=new Se,um=new Se,cm=new Se,p1=new Se,dT=new Se,G3=new Se,q3=new Se,m1=new Se;function dD(i,e,t,r,n){for(let l=0,c=i.length-3;l<=c;l+=3){m1.fromArray(i,l);let h=n.x*Math.abs(m1.x)+n.y*Math.abs(m1.y)+n.z*Math.abs(m1.z),d=e.dot(m1),f=t.dot(m1),m=r.dot(m1);if(Math.max(-Math.max(d,f,m),Math.min(d,f,m))>h)return!1}return!0}var hMe=new Co,fT=new Se,fD=new Se,tf=class{constructor(i=new Se,e=-1){this.center=i,this.radius=e}set(i,e){return this.center.copy(i),this.radius=e,this}setFromPoints(i,e){let t=this.center;e!==void 0?t.copy(e):hMe.setFromPoints(i).getCenter(t);let r=0;for(let n=0,l=i.length;n<l;n++)r=Math.max(r,t.distanceToSquared(i[n]));return this.radius=Math.sqrt(r),this}copy(i){return this.center.copy(i.center),this.radius=i.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(i){return i.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(i){return i.distanceTo(this.center)-this.radius}intersectsSphere(i){let e=this.radius+i.radius;return i.center.distanceToSquared(this.center)<=e*e}intersectsBox(i){return i.intersectsSphere(this)}intersectsPlane(i){return Math.abs(i.distanceToPoint(this.center))<=this.radius}clampPoint(i,e){let t=this.center.distanceToSquared(i);return e.copy(i),t>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(i){return this.isEmpty()?(i.makeEmpty(),i):(i.set(this.center,this.center),i.expandByScalar(this.radius),i)}applyMatrix4(i){return this.center.applyMatrix4(i),this.radius=this.radius*i.getMaxScaleOnAxis(),this}translate(i){return this.center.add(i),this}expandByPoint(i){if(this.isEmpty())return this.center.copy(i),this.radius=0,this;fT.subVectors(i,this.center);let e=fT.lengthSq();if(e>this.radius*this.radius){let t=Math.sqrt(e),r=(t-this.radius)*.5;this.center.addScaledVector(fT,r/t),this.radius+=r}return this}union(i){return i.isEmpty()?this:this.isEmpty()?(this.copy(i),this):(this.center.equals(i.center)===!0?this.radius=Math.max(this.radius,i.radius):(fD.subVectors(i.center,this.center).setLength(i.radius),this.expandByPoint(fT.copy(i.center).add(fD)),this.expandByPoint(fT.copy(i.center).sub(fD))),this)}equals(i){return i.center.equals(this.center)&&i.radius===this.radius}clone(){return new this.constructor().copy(this)}},Qf=new Se,pD=new Se,X3=new Se,hm=new Se,mD=new Se,Z3=new Se,gD=new Se,AE=class{constructor(i=new Se,e=new Se(0,0,-1)){this.origin=i,this.direction=e}set(i,e){return this.origin.copy(i),this.direction.copy(e),this}copy(i){return this.origin.copy(i.origin),this.direction.copy(i.direction),this}at(i,e){return e.copy(this.origin).addScaledVector(this.direction,i)}lookAt(i){return this.direction.copy(i).sub(this.origin).normalize(),this}recast(i){return this.origin.copy(this.at(i,Qf)),this}closestPointToPoint(i,e){e.subVectors(i,this.origin);let t=e.dot(this.direction);return t<0?e.copy(this.origin):e.copy(this.origin).addScaledVector(this.direction,t)}distanceToPoint(i){return Math.sqrt(this.distanceSqToPoint(i))}distanceSqToPoint(i){let e=Qf.subVectors(i,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(i):(Qf.copy(this.origin).addScaledVector(this.direction,e),Qf.distanceToSquared(i))}distanceSqToSegment(i,e,t,r){pD.copy(i).add(e).multiplyScalar(.5),X3.copy(e).sub(i).normalize(),hm.copy(this.origin).sub(pD);let n=i.distanceTo(e)*.5,l=-this.direction.dot(X3),c=hm.dot(this.direction),h=-hm.dot(X3),d=hm.lengthSq(),f=Math.abs(1-l*l),m,g,y,_;if(f>0)if(m=l*h-c,g=l*c-h,_=n*f,m>=0)if(g>=-_)if(g<=_){let b=1/f;m*=b,g*=b,y=m*(m+l*g+2*c)+g*(l*m+g+2*h)+d}else g=n,m=Math.max(0,-(l*g+c)),y=-m*m+g*(g+2*h)+d;else g=-n,m=Math.max(0,-(l*g+c)),y=-m*m+g*(g+2*h)+d;else g<=-_?(m=Math.max(0,-(-l*n+c)),g=m>0?-n:Math.min(Math.max(-n,-h),n),y=-m*m+g*(g+2*h)+d):g<=_?(m=0,g=Math.min(Math.max(-n,-h),n),y=g*(g+2*h)+d):(m=Math.max(0,-(l*n+c)),g=m>0?n:Math.min(Math.max(-n,-h),n),y=-m*m+g*(g+2*h)+d);else g=l>0?-n:n,m=Math.max(0,-(l*g+c)),y=-m*m+g*(g+2*h)+d;return t&&t.copy(this.origin).addScaledVector(this.direction,m),r&&r.copy(pD).addScaledVector(X3,g),y}intersectSphere(i,e){Qf.subVectors(i.center,this.origin);let t=Qf.dot(this.direction),r=Qf.dot(Qf)-t*t,n=i.radius*i.radius;if(r>n)return null;let l=Math.sqrt(n-r),c=t-l,h=t+l;return h<0?null:c<0?this.at(h,e):this.at(c,e)}intersectsSphere(i){return this.distanceSqToPoint(i.center)<=i.radius*i.radius}distanceToPlane(i){let e=i.normal.dot(this.direction);if(e===0)return i.distanceToPoint(this.origin)===0?0:null;let t=-(this.origin.dot(i.normal)+i.constant)/e;return t>=0?t:null}intersectPlane(i,e){let t=this.distanceToPlane(i);return t===null?null:this.at(t,e)}intersectsPlane(i){let e=i.distanceToPoint(this.origin);return e===0||i.normal.dot(this.direction)*e<0}intersectBox(i,e){let t,r,n,l,c,h,d=1/this.direction.x,f=1/this.direction.y,m=1/this.direction.z,g=this.origin;return d>=0?(t=(i.min.x-g.x)*d,r=(i.max.x-g.x)*d):(t=(i.max.x-g.x)*d,r=(i.min.x-g.x)*d),f>=0?(n=(i.min.y-g.y)*f,l=(i.max.y-g.y)*f):(n=(i.max.y-g.y)*f,l=(i.min.y-g.y)*f),t>l||n>r||((n>t||isNaN(t))&&(t=n),(l<r||isNaN(r))&&(r=l),m>=0?(c=(i.min.z-g.z)*m,h=(i.max.z-g.z)*m):(c=(i.max.z-g.z)*m,h=(i.min.z-g.z)*m),t>h||c>r)||((c>t||t!==t)&&(t=c),(h<r||r!==r)&&(r=h),r<0)?null:this.at(t>=0?t:r,e)}intersectsBox(i){return this.intersectBox(i,Qf)!==null}intersectTriangle(i,e,t,r,n){mD.subVectors(e,i),Z3.subVectors(t,i),gD.crossVectors(mD,Z3);let l=this.direction.dot(gD),c;if(l>0){if(r)return null;c=1}else if(l<0)c=-1,l=-l;else return null;hm.subVectors(this.origin,i);let h=c*this.direction.dot(Z3.crossVectors(hm,Z3));if(h<0)return null;let d=c*this.direction.dot(mD.cross(hm));if(d<0||h+d>l)return null;let f=-c*hm.dot(gD);return f<0?null:this.at(f/l,n)}applyMatrix4(i){return this.origin.applyMatrix4(i),this.direction.transformDirection(i),this}equals(i){return i.origin.equals(this.origin)&&i.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},ar=class{constructor(e,t,r,n,l,c,h,d,f,m,g,y,_,b,S,E){ar.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,r,n,l,c,h,d,f,m,g,y,_,b,S,E)}set(e,t,r,n,l,c,h,d,f,m,g,y,_,b,S,E){let T=this.elements;return T[0]=e,T[4]=t,T[8]=r,T[12]=n,T[1]=l,T[5]=c,T[9]=h,T[13]=d,T[2]=f,T[6]=m,T[10]=g,T[14]=y,T[3]=_,T[7]=b,T[11]=S,T[15]=E,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new ar().fromArray(this.elements)}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){let t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,r=e.elements,n=1/gS.setFromMatrixColumn(e,0).length(),l=1/gS.setFromMatrixColumn(e,1).length(),c=1/gS.setFromMatrixColumn(e,2).length();return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=0,t[4]=r[4]*l,t[5]=r[5]*l,t[6]=r[6]*l,t[7]=0,t[8]=r[8]*c,t[9]=r[9]*c,t[10]=r[10]*c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,r=e.x,n=e.y,l=e.z,c=Math.cos(r),h=Math.sin(r),d=Math.cos(n),f=Math.sin(n),m=Math.cos(l),g=Math.sin(l);if(e.order==="XYZ"){let y=c*m,_=c*g,b=h*m,S=h*g;t[0]=d*m,t[4]=-d*g,t[8]=f,t[1]=_+b*f,t[5]=y-S*f,t[9]=-h*d,t[2]=S-y*f,t[6]=b+_*f,t[10]=c*d}else if(e.order==="YXZ"){let y=d*m,_=d*g,b=f*m,S=f*g;t[0]=y+S*h,t[4]=b*h-_,t[8]=c*f,t[1]=c*g,t[5]=c*m,t[9]=-h,t[2]=_*h-b,t[6]=S+y*h,t[10]=c*d}else if(e.order==="ZXY"){let y=d*m,_=d*g,b=f*m,S=f*g;t[0]=y-S*h,t[4]=-c*g,t[8]=b+_*h,t[1]=_+b*h,t[5]=c*m,t[9]=S-y*h,t[2]=-c*f,t[6]=h,t[10]=c*d}else if(e.order==="ZYX"){let y=c*m,_=c*g,b=h*m,S=h*g;t[0]=d*m,t[4]=b*f-_,t[8]=y*f+S,t[1]=d*g,t[5]=S*f+y,t[9]=_*f-b,t[2]=-f,t[6]=h*d,t[10]=c*d}else if(e.order==="YZX"){let y=c*d,_=c*f,b=h*d,S=h*f;t[0]=d*m,t[4]=S-y*g,t[8]=b*g+_,t[1]=g,t[5]=c*m,t[9]=-h*m,t[2]=-f*m,t[6]=_*g+b,t[10]=y-S*g}else if(e.order==="XZY"){let y=c*d,_=c*f,b=h*d,S=h*f;t[0]=d*m,t[4]=-g,t[8]=f*m,t[1]=y*g+S,t[5]=c*m,t[9]=_*g-b,t[2]=b*g-_,t[6]=h*m,t[10]=S*g+y}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(dMe,e,fMe)}lookAt(e,t,r){let n=this.elements;return Tu.subVectors(e,t),Tu.lengthSq()===0&&(Tu.z=1),Tu.normalize(),dm.crossVectors(r,Tu),dm.lengthSq()===0&&(Math.abs(r.z)===1?Tu.x+=1e-4:Tu.z+=1e-4,Tu.normalize(),dm.crossVectors(r,Tu)),dm.normalize(),J3.crossVectors(Tu,dm),n[0]=dm.x,n[4]=J3.x,n[8]=Tu.x,n[1]=dm.y,n[5]=J3.y,n[9]=Tu.y,n[2]=dm.z,n[6]=J3.z,n[10]=Tu.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,n=t.elements,l=this.elements,c=r[0],h=r[4],d=r[8],f=r[12],m=r[1],g=r[5],y=r[9],_=r[13],b=r[2],S=r[6],E=r[10],T=r[14],A=r[3],P=r[7],O=r[11],R=r[15],D=n[0],L=n[4],N=n[8],U=n[12],F=n[1],z=n[5],G=n[9],J=n[13],Z=n[2],q=n[6],$=n[10],H=n[14],X=n[3],re=n[7],ae=n[11],he=n[15];return l[0]=c*D+h*F+d*Z+f*X,l[4]=c*L+h*z+d*q+f*re,l[8]=c*N+h*G+d*$+f*ae,l[12]=c*U+h*J+d*H+f*he,l[1]=m*D+g*F+y*Z+_*X,l[5]=m*L+g*z+y*q+_*re,l[9]=m*N+g*G+y*$+_*ae,l[13]=m*U+g*J+y*H+_*he,l[2]=b*D+S*F+E*Z+T*X,l[6]=b*L+S*z+E*q+T*re,l[10]=b*N+S*G+E*$+T*ae,l[14]=b*U+S*J+E*H+T*he,l[3]=A*D+P*F+O*Z+R*X,l[7]=A*L+P*z+O*q+R*re,l[11]=A*N+P*G+O*$+R*ae,l[15]=A*U+P*J+O*H+R*he,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[4],n=e[8],l=e[12],c=e[1],h=e[5],d=e[9],f=e[13],m=e[2],g=e[6],y=e[10],_=e[14],b=e[3],S=e[7],E=e[11],T=e[15];return b*(+l*d*g-n*f*g-l*h*y+r*f*y+n*h*_-r*d*_)+S*(+t*d*_-t*f*y+l*c*y-n*c*_+n*f*m-l*d*m)+E*(+t*f*g-t*h*_-l*c*g+r*c*_+l*h*m-r*f*m)+T*(-n*h*m-t*d*g+t*h*y+n*c*g-r*c*y+r*d*m)}transpose(){let e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){let n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=r),this}invert(){let e=this.elements,t=e[0],r=e[1],n=e[2],l=e[3],c=e[4],h=e[5],d=e[6],f=e[7],m=e[8],g=e[9],y=e[10],_=e[11],b=e[12],S=e[13],E=e[14],T=e[15],A=g*E*f-S*y*f+S*d*_-h*E*_-g*d*T+h*y*T,P=b*y*f-m*E*f-b*d*_+c*E*_+m*d*T-c*y*T,O=m*S*f-b*g*f+b*h*_-c*S*_-m*h*T+c*g*T,R=b*g*d-m*S*d-b*h*y+c*S*y+m*h*E-c*g*E,D=t*A+r*P+n*O+l*R;if(D===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let L=1/D;return e[0]=A*L,e[1]=(S*y*l-g*E*l-S*n*_+r*E*_+g*n*T-r*y*T)*L,e[2]=(h*E*l-S*d*l+S*n*f-r*E*f-h*n*T+r*d*T)*L,e[3]=(g*d*l-h*y*l-g*n*f+r*y*f+h*n*_-r*d*_)*L,e[4]=P*L,e[5]=(m*E*l-b*y*l+b*n*_-t*E*_-m*n*T+t*y*T)*L,e[6]=(b*d*l-c*E*l-b*n*f+t*E*f+c*n*T-t*d*T)*L,e[7]=(c*y*l-m*d*l+m*n*f-t*y*f-c*n*_+t*d*_)*L,e[8]=O*L,e[9]=(b*g*l-m*S*l-b*r*_+t*S*_+m*r*T-t*g*T)*L,e[10]=(c*S*l-b*h*l+b*r*f-t*S*f-c*r*T+t*h*T)*L,e[11]=(m*h*l-c*g*l-m*r*f+t*g*f+c*r*_-t*h*_)*L,e[12]=R*L,e[13]=(m*S*n-b*g*n+b*r*y-t*S*y-m*r*E+t*g*E)*L,e[14]=(b*h*n-c*S*n-b*r*d+t*S*d+c*r*E-t*h*E)*L,e[15]=(c*g*n-m*h*n+m*r*d-t*g*d-c*r*y+t*h*y)*L,this}scale(e){let t=this.elements,r=e.x,n=e.y,l=e.z;return t[0]*=r,t[4]*=n,t[8]*=l,t[1]*=r,t[5]*=n,t[9]*=l,t[2]*=r,t[6]*=n,t[10]*=l,t[3]*=r,t[7]*=n,t[11]*=l,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,n))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let r=Math.cos(t),n=Math.sin(t),l=1-r,c=e.x,h=e.y,d=e.z,f=l*c,m=l*h;return this.set(f*c+r,f*h-n*d,f*d+n*h,0,f*h+n*d,m*h+r,m*d-n*c,0,f*d-n*h,m*d+n*c,l*d*d+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,n,l,c){return this.set(1,r,l,0,e,1,c,0,t,n,1,0,0,0,0,1),this}compose(e,t,r){let n=this.elements,l=t._x,c=t._y,h=t._z,d=t._w,f=l+l,m=c+c,g=h+h,y=l*f,_=l*m,b=l*g,S=c*m,E=c*g,T=h*g,A=d*f,P=d*m,O=d*g,R=r.x,D=r.y,L=r.z;return n[0]=(1-(S+T))*R,n[1]=(_+O)*R,n[2]=(b-P)*R,n[3]=0,n[4]=(_-O)*D,n[5]=(1-(y+T))*D,n[6]=(E+A)*D,n[7]=0,n[8]=(b+P)*L,n[9]=(E-A)*L,n[10]=(1-(y+S))*L,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,t,r){let n=this.elements,l=gS.set(n[0],n[1],n[2]).length(),c=gS.set(n[4],n[5],n[6]).length(),h=gS.set(n[8],n[9],n[10]).length();this.determinant()<0&&(l=-l),e.x=n[12],e.y=n[13],e.z=n[14],Id.copy(this);let d=1/l,f=1/c,m=1/h;return Id.elements[0]*=d,Id.elements[1]*=d,Id.elements[2]*=d,Id.elements[4]*=f,Id.elements[5]*=f,Id.elements[6]*=f,Id.elements[8]*=m,Id.elements[9]*=m,Id.elements[10]*=m,t.setFromRotationMatrix(Id),r.x=l,r.y=c,r.z=h,this}makePerspective(e,t,r,n,l,c,h=B1){let d=this.elements,f=2*l/(t-e),m=2*l/(r-n),g=(t+e)/(t-e),y=(r+n)/(r-n),_,b;if(h===B1)_=-(c+l)/(c-l),b=-2*c*l/(c-l);else if(h===a4)_=-c/(c-l),b=-c*l/(c-l);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+h);return d[0]=f,d[4]=0,d[8]=g,d[12]=0,d[1]=0,d[5]=m,d[9]=y,d[13]=0,d[2]=0,d[6]=0,d[10]=_,d[14]=b,d[3]=0,d[7]=0,d[11]=-1,d[15]=0,this}makeOrthographic(e,t,r,n,l,c,h=B1){let d=this.elements,f=1/(t-e),m=1/(r-n),g=1/(c-l),y=(t+e)*f,_=(r+n)*m,b,S;if(h===B1)b=(c+l)*g,S=-2*g;else if(h===a4)b=l*g,S=-1*g;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+h);return d[0]=2*f,d[4]=0,d[8]=0,d[12]=-y,d[1]=0,d[5]=2*m,d[9]=0,d[13]=-_,d[2]=0,d[6]=0,d[10]=S,d[14]=-b,d[3]=0,d[7]=0,d[11]=0,d[15]=1,this}equals(e){let t=this.elements,r=e.elements;for(let n=0;n<16;n++)if(t[n]!==r[n])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){let r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}},gS=new Se,Id=new ar,dMe=new Se(0,0,0),fMe=new Se(1,1,1),dm=new Se,J3=new Se,Tu=new Se,EW=new ar,TW=new pu,sU=class{constructor(i=0,e=0,t=0,r=sU.DEFAULT_ORDER){this.isEuler=!0,this._x=i,this._y=e,this._z=t,this._order=r}get x(){return this._x}set x(i){this._x=i,this._onChangeCallback()}get y(){return this._y}set y(i){this._y=i,this._onChangeCallback()}get z(){return this._z}set z(i){this._z=i,this._onChangeCallback()}get order(){return this._order}set order(i){this._order=i,this._onChangeCallback()}set(i,e,t,r=this._order){return this._x=i,this._y=e,this._z=t,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(i){return this._x=i._x,this._y=i._y,this._z=i._z,this._order=i._order,this._onChangeCallback(),this}setFromRotationMatrix(i,e=this._order,t=!0){let r=i.elements,n=r[0],l=r[4],c=r[8],h=r[1],d=r[5],f=r[9],m=r[2],g=r[6],y=r[10];switch(e){case"XYZ":this._y=Math.asin(La(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-f,y),this._z=Math.atan2(-l,n)):(this._x=Math.atan2(g,d),this._z=0);break;case"YXZ":this._x=Math.asin(-La(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(c,y),this._z=Math.atan2(h,d)):(this._y=Math.atan2(-m,n),this._z=0);break;case"ZXY":this._x=Math.asin(La(g,-1,1)),Math.abs(g)<.9999999?(this._y=Math.atan2(-m,y),this._z=Math.atan2(-l,d)):(this._y=0,this._z=Math.atan2(h,n));break;case"ZYX":this._y=Math.asin(-La(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(g,y),this._z=Math.atan2(h,n)):(this._x=0,this._z=Math.atan2(-l,d));break;case"YZX":this._z=Math.asin(La(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-f,d),this._y=Math.atan2(-m,n)):(this._x=0,this._y=Math.atan2(c,y));break;case"XZY":this._z=Math.asin(-La(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(g,d),this._y=Math.atan2(c,n)):(this._x=Math.atan2(-f,y),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,t===!0&&this._onChangeCallback(),this}setFromQuaternion(i,e,t){return EW.makeRotationFromQuaternion(i),this.setFromRotationMatrix(EW,e,t)}setFromVector3(i,e=this._order){return this.set(i.x,i.y,i.z,e)}reorder(i){return TW.setFromEuler(this),this.setFromQuaternion(TW,i)}equals(i){return i._x===this._x&&i._y===this._y&&i._z===this._z&&i._order===this._order}fromArray(i){return this._x=i[0],this._y=i[1],this._z=i[2],i[3]!==void 0&&(this._order=i[3]),this._onChangeCallback(),this}toArray(i=[],e=0){return i[e]=this._x,i[e+1]=this._y,i[e+2]=this._z,i[e+3]=this._order,i}_onChange(i){return this._onChangeCallback=i,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};sU.DEFAULT_ORDER="XYZ";var cY=class{constructor(){this.mask=1}set(i){this.mask=(1<<i|0)>>>0}enable(i){this.mask|=1<<i|0}enableAll(){this.mask=-1}toggle(i){this.mask^=1<<i|0}disable(i){this.mask&=~(1<<i|0)}disableAll(){this.mask=0}test(i){return(this.mask&i.mask)!==0}isEnabled(i){return(this.mask&(1<<i|0))!==0}},pMe=0,AW=new Se,vS=new pu,ep=new ar,Y3=new Se,pT=new Se,mMe=new Se,gMe=new pu,CW=new Se(1,0,0),PW=new Se(0,1,0),RW=new Se(0,0,1),vMe={type:"added"},yMe={type:"removed"},Wn=class extends FC{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:pMe++}),this.uuid=Gd(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Wn.DEFAULT_UP.clone();let i=new Se,e=new sU,t=new pu,r=new Se(1,1,1);function n(){t.setFromEuler(e,!1)}function l(){e.setFromQuaternion(t,void 0,!1)}e._onChange(n),t._onChange(l),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:i},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:t},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new ar},normalMatrix:{value:new Er}}),this.matrix=new ar,this.matrixWorld=new ar,this.matrixAutoUpdate=Wn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Wn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new cY,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(i){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(i),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(i){return this.quaternion.premultiply(i),this}setRotationFromAxisAngle(i,e){this.quaternion.setFromAxisAngle(i,e)}setRotationFromEuler(i){this.quaternion.setFromEuler(i,!0)}setRotationFromMatrix(i){this.quaternion.setFromRotationMatrix(i)}setRotationFromQuaternion(i){this.quaternion.copy(i)}rotateOnAxis(i,e){return vS.setFromAxisAngle(i,e),this.quaternion.multiply(vS),this}rotateOnWorldAxis(i,e){return vS.setFromAxisAngle(i,e),this.quaternion.premultiply(vS),this}rotateX(i){return this.rotateOnAxis(CW,i)}rotateY(i){return this.rotateOnAxis(PW,i)}rotateZ(i){return this.rotateOnAxis(RW,i)}translateOnAxis(i,e){return AW.copy(i).applyQuaternion(this.quaternion),this.position.add(AW.multiplyScalar(e)),this}translateX(i){return this.translateOnAxis(CW,i)}translateY(i){return this.translateOnAxis(PW,i)}translateZ(i){return this.translateOnAxis(RW,i)}localToWorld(i){return this.updateWorldMatrix(!0,!1),i.applyMatrix4(this.matrixWorld)}worldToLocal(i){return this.updateWorldMatrix(!0,!1),i.applyMatrix4(ep.copy(this.matrixWorld).invert())}lookAt(i,e,t){i.isVector3?Y3.copy(i):Y3.set(i,e,t);let r=this.parent;this.updateWorldMatrix(!0,!1),pT.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ep.lookAt(pT,Y3,this.up):ep.lookAt(Y3,pT,this.up),this.quaternion.setFromRotationMatrix(ep),r&&(ep.extractRotation(r.matrixWorld),vS.setFromRotationMatrix(ep),this.quaternion.premultiply(vS.invert()))}add(i){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return i===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",i),this):(i&&i.isObject3D?(i.parent!==null&&i.parent.remove(i),i.parent=this,this.children.push(i),i.dispatchEvent(vMe)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",i),this)}remove(i){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}let e=this.children.indexOf(i);return e!==-1&&(i.parent=null,this.children.splice(e,1),i.dispatchEvent(yMe)),this}removeFromParent(){let i=this.parent;return i!==null&&i.remove(this),this}clear(){return this.remove(...this.children)}attach(i){return this.updateWorldMatrix(!0,!1),ep.copy(this.matrixWorld).invert(),i.parent!==null&&(i.parent.updateWorldMatrix(!0,!1),ep.multiply(i.parent.matrixWorld)),i.applyMatrix4(ep),this.add(i),i.updateWorldMatrix(!1,!0),this}getObjectById(i){return this.getObjectByProperty("id",i)}getObjectByName(i){return this.getObjectByProperty("name",i)}getObjectByProperty(i,e){if(this[i]===e)return this;for(let t=0,r=this.children.length;t<r;t++){let n=this.children[t].getObjectByProperty(i,e);if(n!==void 0)return n}}getObjectsByProperty(i,e){let t=[];this[i]===e&&t.push(this);for(let r=0,n=this.children.length;r<n;r++){let l=this.children[r].getObjectsByProperty(i,e);l.length>0&&(t=t.concat(l))}return t}getWorldPosition(i){return this.updateWorldMatrix(!0,!1),i.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(i){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(pT,i,mMe),i}getWorldScale(i){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(pT,gMe,i),i}getWorldDirection(i){this.updateWorldMatrix(!0,!1);let e=this.matrixWorld.elements;return i.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(i){i(this);let e=this.children;for(let t=0,r=e.length;t<r;t++)e[t].traverse(i)}traverseVisible(i){if(this.visible===!1)return;i(this);let e=this.children;for(let t=0,r=e.length;t<r;t++)e[t].traverseVisible(i)}traverseAncestors(i){let e=this.parent;e!==null&&(i(e),e.traverseAncestors(i))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(i){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||i)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,i=!0);let e=this.children;for(let t=0,r=e.length;t<r;t++){let n=e[t];(n.matrixWorldAutoUpdate===!0||i===!0)&&n.updateMatrixWorld(i)}}updateWorldMatrix(i,e){let t=this.parent;if(i===!0&&t!==null&&t.matrixWorldAutoUpdate===!0&&t.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),e===!0){let r=this.children;for(let n=0,l=r.length;n<l;n++){let c=r[n];c.matrixWorldAutoUpdate===!0&&c.updateWorldMatrix(!1,!0)}}}toJSON(i){let e=i===void 0||typeof i=="string",t={};e&&(i={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},t.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});let r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON()));function n(c,h){return c[h.uuid]===void 0&&(c[h.uuid]=h.toJSON(i)),h.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(i).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(i).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=n(i.geometries,this.geometry);let c=this.geometry.parameters;if(c!==void 0&&c.shapes!==void 0){let h=c.shapes;if(Array.isArray(h))for(let d=0,f=h.length;d<f;d++){let m=h[d];n(i.shapes,m)}else n(i.shapes,h)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(n(i.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let c=[];for(let h=0,d=this.material.length;h<d;h++)c.push(n(i.materials,this.material[h]));r.material=c}else r.material=n(i.materials,this.material);if(this.children.length>0){r.children=[];for(let c=0;c<this.children.length;c++)r.children.push(this.children[c].toJSON(i).object)}if(this.animations.length>0){r.animations=[];for(let c=0;c<this.animations.length;c++){let h=this.animations[c];r.animations.push(n(i.animations,h))}}if(e){let c=l(i.geometries),h=l(i.materials),d=l(i.textures),f=l(i.images),m=l(i.shapes),g=l(i.skeletons),y=l(i.animations),_=l(i.nodes);c.length>0&&(t.geometries=c),h.length>0&&(t.materials=h),d.length>0&&(t.textures=d),f.length>0&&(t.images=f),m.length>0&&(t.shapes=m),g.length>0&&(t.skeletons=g),y.length>0&&(t.animations=y),_.length>0&&(t.nodes=_)}return t.object=r,t;function l(c){let h=[];for(let d in c){let f=c[d];delete f.metadata,h.push(f)}return h}}clone(i){return new this.constructor().copy(this,i)}copy(i,e=!0){if(this.name=i.name,this.up.copy(i.up),this.position.copy(i.position),this.rotation.order=i.rotation.order,this.quaternion.copy(i.quaternion),this.scale.copy(i.scale),this.matrix.copy(i.matrix),this.matrixWorld.copy(i.matrixWorld),this.matrixAutoUpdate=i.matrixAutoUpdate,this.matrixWorldNeedsUpdate=i.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=i.matrixWorldAutoUpdate,this.layers.mask=i.layers.mask,this.visible=i.visible,this.castShadow=i.castShadow,this.receiveShadow=i.receiveShadow,this.frustumCulled=i.frustumCulled,this.renderOrder=i.renderOrder,this.animations=i.animations.slice(),this.userData=JSON.parse(JSON.stringify(i.userData)),e===!0)for(let t=0;t<i.children.length;t++){let r=i.children[t];this.add(r.clone())}return this}};Wn.DEFAULT_UP=new Se(0,1,0);Wn.DEFAULT_MATRIX_AUTO_UPDATE=!0;Wn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var Ld=new Se,tp=new Se,vD=new Se,ip=new Se,yS=new Se,_S=new Se,IW=new Se,yD=new Se,_D=new Se,xD=new Se,K3=!1,ou=class{constructor(i=new Se,e=new Se,t=new Se){this.a=i,this.b=e,this.c=t}static getNormal(i,e,t,r){r.subVectors(t,e),Ld.subVectors(i,e),r.cross(Ld);let n=r.lengthSq();return n>0?r.multiplyScalar(1/Math.sqrt(n)):r.set(0,0,0)}static getBarycoord(i,e,t,r,n){Ld.subVectors(r,e),tp.subVectors(t,e),vD.subVectors(i,e);let l=Ld.dot(Ld),c=Ld.dot(tp),h=Ld.dot(vD),d=tp.dot(tp),f=tp.dot(vD),m=l*d-c*c;if(m===0)return n.set(-2,-1,-1);let g=1/m,y=(d*h-c*f)*g,_=(l*f-c*h)*g;return n.set(1-y-_,_,y)}static containsPoint(i,e,t,r){return this.getBarycoord(i,e,t,r,ip),ip.x>=0&&ip.y>=0&&ip.x+ip.y<=1}static getUV(i,e,t,r,n,l,c,h){return K3===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),K3=!0),this.getInterpolation(i,e,t,r,n,l,c,h)}static getInterpolation(i,e,t,r,n,l,c,h){return this.getBarycoord(i,e,t,r,ip),h.setScalar(0),h.addScaledVector(n,ip.x),h.addScaledVector(l,ip.y),h.addScaledVector(c,ip.z),h}static isFrontFacing(i,e,t,r){return Ld.subVectors(t,e),tp.subVectors(i,e),Ld.cross(tp).dot(r)<0}set(i,e,t){return this.a.copy(i),this.b.copy(e),this.c.copy(t),this}setFromPointsAndIndices(i,e,t,r){return this.a.copy(i[e]),this.b.copy(i[t]),this.c.copy(i[r]),this}setFromAttributeAndIndices(i,e,t,r){return this.a.fromBufferAttribute(i,e),this.b.fromBufferAttribute(i,t),this.c.fromBufferAttribute(i,r),this}clone(){return new this.constructor().copy(this)}copy(i){return this.a.copy(i.a),this.b.copy(i.b),this.c.copy(i.c),this}getArea(){return Ld.subVectors(this.c,this.b),tp.subVectors(this.a,this.b),Ld.cross(tp).length()*.5}getMidpoint(i){return i.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(i){return ou.getNormal(this.a,this.b,this.c,i)}getPlane(i){return i.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(i,e){return ou.getBarycoord(i,this.a,this.b,this.c,e)}getUV(i,e,t,r,n){return K3===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),K3=!0),ou.getInterpolation(i,this.a,this.b,this.c,e,t,r,n)}getInterpolation(i,e,t,r,n){return ou.getInterpolation(i,this.a,this.b,this.c,e,t,r,n)}containsPoint(i){return ou.containsPoint(i,this.a,this.b,this.c)}isFrontFacing(i){return ou.isFrontFacing(this.a,this.b,this.c,i)}intersectsBox(i){return i.intersectsTriangle(this)}closestPointToPoint(i,e){let t=this.a,r=this.b,n=this.c,l,c;yS.subVectors(r,t),_S.subVectors(n,t),yD.subVectors(i,t);let h=yS.dot(yD),d=_S.dot(yD);if(h<=0&&d<=0)return e.copy(t);_D.subVectors(i,r);let f=yS.dot(_D),m=_S.dot(_D);if(f>=0&&m<=f)return e.copy(r);let g=h*m-f*d;if(g<=0&&h>=0&&f<=0)return l=h/(h-f),e.copy(t).addScaledVector(yS,l);xD.subVectors(i,n);let y=yS.dot(xD),_=_S.dot(xD);if(_>=0&&y<=_)return e.copy(n);let b=y*d-h*_;if(b<=0&&d>=0&&_<=0)return c=d/(d-_),e.copy(t).addScaledVector(_S,c);let S=f*_-y*m;if(S<=0&&m-f>=0&&y-_>=0)return IW.subVectors(n,r),c=(m-f)/(m-f+(y-_)),e.copy(r).addScaledVector(IW,c);let E=1/(S+b+g);return l=b*E,c=g*E,e.copy(t).addScaledVector(yS,l).addScaledVector(_S,c)}equals(i){return i.a.equals(this.a)&&i.b.equals(this.b)&&i.c.equals(this.c)}},_Me=0,Wm=class extends FC{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:_Me++}),this.uuid=Gd(),this.name="",this.type="Material",this.blending=gW,this.side=JM,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=SSe,this.blendDst=MSe,this.blendEquation=wSe,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=ESe,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=USe,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=aD,this.stencilZFail=aD,this.stencilZPass=aD,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(i){this._alphaTest>0!=i>0&&this.version++,this._alphaTest=i}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(i){if(i!==void 0)for(let e in i){let t=i[e];if(t===void 0){console.warn(`THREE.Material: parameter '${e}' has value of undefined.`);continue}let r=this[e];if(r===void 0){console.warn(`THREE.Material: '${e}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(t):r&&r.isVector3&&t&&t.isVector3?r.copy(t):this[e]=t}}toJSON(i){let e=i===void 0||typeof i=="string";e&&(i={textures:{},images:{}});let t={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),this.color&&this.color.isColor&&(t.color=this.color.getHex()),this.roughness!==void 0&&(t.roughness=this.roughness),this.metalness!==void 0&&(t.metalness=this.metalness),this.sheen!==void 0&&(t.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(t.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(t.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(t.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(t.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(t.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(t.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(t.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(t.shininess=this.shininess),this.clearcoat!==void 0&&(t.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(t.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(t.clearcoatMap=this.clearcoatMap.toJSON(i).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(t.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(i).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(t.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(i).uuid,t.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(t.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(t.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(t.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(t.iridescenceMap=this.iridescenceMap.toJSON(i).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(t.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(i).uuid),this.anisotropy!==void 0&&(t.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(t.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(t.anisotropyMap=this.anisotropyMap.toJSON(i).uuid),this.map&&this.map.isTexture&&(t.map=this.map.toJSON(i).uuid),this.matcap&&this.matcap.isTexture&&(t.matcap=this.matcap.toJSON(i).uuid),this.alphaMap&&this.alphaMap.isTexture&&(t.alphaMap=this.alphaMap.toJSON(i).uuid),this.lightMap&&this.lightMap.isTexture&&(t.lightMap=this.lightMap.toJSON(i).uuid,t.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(t.aoMap=this.aoMap.toJSON(i).uuid,t.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(t.bumpMap=this.bumpMap.toJSON(i).uuid,t.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(t.normalMap=this.normalMap.toJSON(i).uuid,t.normalMapType=this.normalMapType,t.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(t.displacementMap=this.displacementMap.toJSON(i).uuid,t.displacementScale=this.displacementScale,t.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(t.roughnessMap=this.roughnessMap.toJSON(i).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(t.metalnessMap=this.metalnessMap.toJSON(i).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(t.emissiveMap=this.emissiveMap.toJSON(i).uuid),this.specularMap&&this.specularMap.isTexture&&(t.specularMap=this.specularMap.toJSON(i).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(t.specularIntensityMap=this.specularIntensityMap.toJSON(i).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(t.specularColorMap=this.specularColorMap.toJSON(i).uuid),this.envMap&&this.envMap.isTexture&&(t.envMap=this.envMap.toJSON(i).uuid,this.combine!==void 0&&(t.combine=this.combine)),this.envMapIntensity!==void 0&&(t.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(t.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(t.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(t.gradientMap=this.gradientMap.toJSON(i).uuid),this.transmission!==void 0&&(t.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(t.transmissionMap=this.transmissionMap.toJSON(i).uuid),this.thickness!==void 0&&(t.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(t.thicknessMap=this.thicknessMap.toJSON(i).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(t.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(t.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(t.size=this.size),this.shadowSide!==null&&(t.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(t.sizeAttenuation=this.sizeAttenuation),this.blending!==gW&&(t.blending=this.blending),this.side!==JM&&(t.side=this.side),this.vertexColors===!0&&(t.vertexColors=!0),this.opacity<1&&(t.opacity=this.opacity),this.transparent===!0&&(t.transparent=!0),t.depthFunc=this.depthFunc,t.depthTest=this.depthTest,t.depthWrite=this.depthWrite,t.colorWrite=this.colorWrite,t.stencilWrite=this.stencilWrite,t.stencilWriteMask=this.stencilWriteMask,t.stencilFunc=this.stencilFunc,t.stencilRef=this.stencilRef,t.stencilFuncMask=this.stencilFuncMask,t.stencilFail=this.stencilFail,t.stencilZFail=this.stencilZFail,t.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(t.rotation=this.rotation),this.polygonOffset===!0&&(t.polygonOffset=!0),this.polygonOffsetFactor!==0&&(t.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(t.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(t.linewidth=this.linewidth),this.dashSize!==void 0&&(t.dashSize=this.dashSize),this.gapSize!==void 0&&(t.gapSize=this.gapSize),this.scale!==void 0&&(t.scale=this.scale),this.dithering===!0&&(t.dithering=!0),this.alphaTest>0&&(t.alphaTest=this.alphaTest),this.alphaHash===!0&&(t.alphaHash=!0),this.alphaToCoverage===!0&&(t.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(t.premultipliedAlpha=!0),this.forceSinglePass===!0&&(t.forceSinglePass=!0),this.wireframe===!0&&(t.wireframe=!0),this.wireframeLinewidth>1&&(t.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(t.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(t.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(t.flatShading=!0),this.visible===!1&&(t.visible=!1),this.toneMapped===!1&&(t.toneMapped=!1),this.fog===!1&&(t.fog=!1),Object.keys(this.userData).length>0&&(t.userData=this.userData);function r(n){let l=[];for(let c in n){let h=n[c];delete h.metadata,l.push(h)}return l}if(e){let n=r(i.textures),l=r(i.images);n.length>0&&(t.textures=n),l.length>0&&(t.images=l)}return t}clone(){return new this.constructor().copy(this)}copy(i){this.name=i.name,this.blending=i.blending,this.side=i.side,this.vertexColors=i.vertexColors,this.opacity=i.opacity,this.transparent=i.transparent,this.blendSrc=i.blendSrc,this.blendDst=i.blendDst,this.blendEquation=i.blendEquation,this.blendSrcAlpha=i.blendSrcAlpha,this.blendDstAlpha=i.blendDstAlpha,this.blendEquationAlpha=i.blendEquationAlpha,this.depthFunc=i.depthFunc,this.depthTest=i.depthTest,this.depthWrite=i.depthWrite,this.stencilWriteMask=i.stencilWriteMask,this.stencilFunc=i.stencilFunc,this.stencilRef=i.stencilRef,this.stencilFuncMask=i.stencilFuncMask,this.stencilFail=i.stencilFail,this.stencilZFail=i.stencilZFail,this.stencilZPass=i.stencilZPass,this.stencilWrite=i.stencilWrite;let e=i.clippingPlanes,t=null;if(e!==null){let r=e.length;t=new Array(r);for(let n=0;n!==r;++n)t[n]=e[n].clone()}return this.clippingPlanes=t,this.clipIntersection=i.clipIntersection,this.clipShadows=i.clipShadows,this.shadowSide=i.shadowSide,this.colorWrite=i.colorWrite,this.precision=i.precision,this.polygonOffset=i.polygonOffset,this.polygonOffsetFactor=i.polygonOffsetFactor,this.polygonOffsetUnits=i.polygonOffsetUnits,this.dithering=i.dithering,this.alphaTest=i.alphaTest,this.alphaHash=i.alphaHash,this.alphaToCoverage=i.alphaToCoverage,this.premultipliedAlpha=i.premultipliedAlpha,this.forceSinglePass=i.forceSinglePass,this.visible=i.visible,this.toneMapped=i.toneMapped,this.userData=JSON.parse(JSON.stringify(i.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(i){i===!0&&this.version++}},hY={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},fm={h:0,s:0,l:0},Q3={h:0,s:0,l:0};function bD(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}var Tr=class{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,r)}set(e,t,r){if(t===void 0&&r===void 0){let n=e;n&&n.isColor?this.copy(n):typeof n=="number"?this.setHex(n):typeof n=="string"&&this.setStyle(n)}else this.setRGB(e,t,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=bo){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Cu.toWorkingColorSpace(this,t),this}setRGB(e,t,r,n=Cu.workingColorSpace){return this.r=e,this.g=t,this.b=r,Cu.toWorkingColorSpace(this,n),this}setHSL(e,t,r,n=Cu.workingColorSpace){if(e=nU(e,1),t=La(t,0,1),r=La(r,0,1),t===0)this.r=this.g=this.b=r;else{let l=r<=.5?r*(1+t):r+t-r*t,c=2*r-l;this.r=bD(c,l,e+1/3),this.g=bD(c,l,e),this.b=bD(c,l,e-1/3)}return Cu.toWorkingColorSpace(this,n),this}setStyle(e,t=bo){function r(l){l!==void 0&&parseFloat(l)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let n;if(n=/^(\w+)\(([^\)]*)\)/.exec(e)){let l,c=n[1],h=n[2];switch(c){case"rgb":case"rgba":if(l=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return r(l[4]),this.setRGB(Math.min(255,parseInt(l[1],10))/255,Math.min(255,parseInt(l[2],10))/255,Math.min(255,parseInt(l[3],10))/255,t);if(l=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return r(l[4]),this.setRGB(Math.min(100,parseInt(l[1],10))/100,Math.min(100,parseInt(l[2],10))/100,Math.min(100,parseInt(l[3],10))/100,t);break;case"hsl":case"hsla":if(l=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return r(l[4]),this.setHSL(parseFloat(l[1])/360,parseFloat(l[2])/100,parseFloat(l[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){let l=n[1],c=l.length;if(c===3)return this.setRGB(parseInt(l.charAt(0),16)/15,parseInt(l.charAt(1),16)/15,parseInt(l.charAt(2),16)/15,t);if(c===6)return this.setHex(parseInt(l,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=bo){let r=hY[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=xM(e.r),this.g=xM(e.g),this.b=xM(e.b),this}copyLinearToSRGB(e){return this.r=uD(e.r),this.g=uD(e.g),this.b=uD(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=bo){return Cu.fromWorkingColorSpace(vo.copy(this),e),Math.round(La(vo.r*255,0,255))*65536+Math.round(La(vo.g*255,0,255))*256+Math.round(La(vo.b*255,0,255))}getHexString(e=bo){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Cu.workingColorSpace){Cu.fromWorkingColorSpace(vo.copy(this),t);let r=vo.r,n=vo.g,l=vo.b,c=Math.max(r,n,l),h=Math.min(r,n,l),d,f,m=(h+c)/2;if(h===c)d=0,f=0;else{let g=c-h;switch(f=m<=.5?g/(c+h):g/(2-c-h),c){case r:d=(n-l)/g+(n<l?6:0);break;case n:d=(l-r)/g+2;break;case l:d=(r-n)/g+4;break}d/=6}return e.h=d,e.s=f,e.l=m,e}getRGB(e,t=Cu.workingColorSpace){return Cu.fromWorkingColorSpace(vo.copy(this),t),e.r=vo.r,e.g=vo.g,e.b=vo.b,e}getStyle(e=bo){Cu.fromWorkingColorSpace(vo.copy(this),e);let t=vo.r,r=vo.g,n=vo.b;return e!==bo?`color(${e} ${t.toFixed(3)} ${r.toFixed(3)} ${n.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(r*255)},${Math.round(n*255)})`}offsetHSL(e,t,r){return this.getHSL(fm),this.setHSL(fm.h+e,fm.s+t,fm.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(fm),e.getHSL(Q3);let r=rA(fm.h,Q3.h,t),n=rA(fm.s,Q3.s,t),l=rA(fm.l,Q3.l,t);return this.setHSL(r,n,l),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){let t=this.r,r=this.g,n=this.b,l=e.elements;return this.r=l[0]*t+l[3]*r+l[6]*n,this.g=l[1]*t+l[4]*r+l[7]*n,this.b=l[2]*t+l[5]*r+l[8]*n,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}},vo=new Tr;Tr.NAMES=hY;var U1=class extends Wm{constructor(i){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Tr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=TSe,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(i)}copy(i){return super.copy(i),this.color.copy(i.color),this.map=i.map,this.lightMap=i.lightMap,this.lightMapIntensity=i.lightMapIntensity,this.aoMap=i.aoMap,this.aoMapIntensity=i.aoMapIntensity,this.specularMap=i.specularMap,this.alphaMap=i.alphaMap,this.envMap=i.envMap,this.combine=i.combine,this.reflectivity=i.reflectivity,this.refractionRatio=i.refractionRatio,this.wireframe=i.wireframe,this.wireframeLinewidth=i.wireframeLinewidth,this.wireframeLinecap=i.wireframeLinecap,this.wireframeLinejoin=i.wireframeLinejoin,this.fog=i.fog,this}},ks=new Se,eP=new mi,zu=class{constructor(i,e,t=!1){if(Array.isArray(i))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=i,this.itemSize=e,this.count=i!==void 0?i.length/e:0,this.normalized=t,this.usage=s4,this.updateRange={offset:0,count:-1},this.gpuType=sY,this.version=0}onUploadCallback(){}set needsUpdate(i){i===!0&&this.version++}setUsage(i){return this.usage=i,this}copy(i){return this.name=i.name,this.array=new i.array.constructor(i.array),this.itemSize=i.itemSize,this.count=i.count,this.normalized=i.normalized,this.usage=i.usage,this.gpuType=i.gpuType,this}copyAt(i,e,t){i*=this.itemSize,t*=e.itemSize;for(let r=0,n=this.itemSize;r<n;r++)this.array[i+r]=e.array[t+r];return this}copyArray(i){return this.array.set(i),this}applyMatrix3(i){if(this.itemSize===2)for(let e=0,t=this.count;e<t;e++)eP.fromBufferAttribute(this,e),eP.applyMatrix3(i),this.setXY(e,eP.x,eP.y);else if(this.itemSize===3)for(let e=0,t=this.count;e<t;e++)ks.fromBufferAttribute(this,e),ks.applyMatrix3(i),this.setXYZ(e,ks.x,ks.y,ks.z);return this}applyMatrix4(i){for(let e=0,t=this.count;e<t;e++)ks.fromBufferAttribute(this,e),ks.applyMatrix4(i),this.setXYZ(e,ks.x,ks.y,ks.z);return this}applyNormalMatrix(i){for(let e=0,t=this.count;e<t;e++)ks.fromBufferAttribute(this,e),ks.applyNormalMatrix(i),this.setXYZ(e,ks.x,ks.y,ks.z);return this}transformDirection(i){for(let e=0,t=this.count;e<t;e++)ks.fromBufferAttribute(this,e),ks.transformDirection(i),this.setXYZ(e,ks.x,ks.y,ks.z);return this}set(i,e=0){return this.array.set(i,e),this}getComponent(i,e){let t=this.array[i*this.itemSize+e];return this.normalized&&(t=pf(t,this.array)),t}setComponent(i,e,t){return this.normalized&&(t=yn(t,this.array)),this.array[i*this.itemSize+e]=t,this}getX(i){let e=this.array[i*this.itemSize];return this.normalized&&(e=pf(e,this.array)),e}setX(i,e){return this.normalized&&(e=yn(e,this.array)),this.array[i*this.itemSize]=e,this}getY(i){let e=this.array[i*this.itemSize+1];return this.normalized&&(e=pf(e,this.array)),e}setY(i,e){return this.normalized&&(e=yn(e,this.array)),this.array[i*this.itemSize+1]=e,this}getZ(i){let e=this.array[i*this.itemSize+2];return this.normalized&&(e=pf(e,this.array)),e}setZ(i,e){return this.normalized&&(e=yn(e,this.array)),this.array[i*this.itemSize+2]=e,this}getW(i){let e=this.array[i*this.itemSize+3];return this.normalized&&(e=pf(e,this.array)),e}setW(i,e){return this.normalized&&(e=yn(e,this.array)),this.array[i*this.itemSize+3]=e,this}setXY(i,e,t){return i*=this.itemSize,this.normalized&&(e=yn(e,this.array),t=yn(t,this.array)),this.array[i+0]=e,this.array[i+1]=t,this}setXYZ(i,e,t,r){return i*=this.itemSize,this.normalized&&(e=yn(e,this.array),t=yn(t,this.array),r=yn(r,this.array)),this.array[i+0]=e,this.array[i+1]=t,this.array[i+2]=r,this}setXYZW(i,e,t,r,n){return i*=this.itemSize,this.normalized&&(e=yn(e,this.array),t=yn(t,this.array),r=yn(r,this.array),n=yn(n,this.array)),this.array[i+0]=e,this.array[i+1]=t,this.array[i+2]=r,this.array[i+3]=n,this}onUpload(i){return this.onUploadCallback=i,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let i={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(i.name=this.name),this.usage!==s4&&(i.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(i.updateRange=this.updateRange),i}},xMe=class extends zu{constructor(i,e,t){super(new Uint16Array(i),e,t)}},bMe=class extends zu{constructor(i,e,t){super(new Uint32Array(i),e,t)}},bM=class extends zu{constructor(i,e,t){super(new Float32Array(i),e,t)}},wMe=0,Gu=new ar,wD=new Wn,xS=new Se,Au=new Co,mT=new Co,Va=new Se,Op=class extends FC{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:wMe++}),this.uuid=Gd(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(rMe(e)?bMe:xMe)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);let r=this.attributes.normal;if(r!==void 0){let l=new Er().getNormalMatrix(e);r.applyNormalMatrix(l),r.needsUpdate=!0}let n=this.attributes.tangent;return n!==void 0&&(n.transformDirection(e),n.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Gu.makeRotationFromQuaternion(e),this.applyMatrix4(Gu),this}rotateX(e){return Gu.makeRotationX(e),this.applyMatrix4(Gu),this}rotateY(e){return Gu.makeRotationY(e),this.applyMatrix4(Gu),this}rotateZ(e){return Gu.makeRotationZ(e),this.applyMatrix4(Gu),this}translate(e,t,r){return Gu.makeTranslation(e,t,r),this.applyMatrix4(Gu),this}scale(e,t,r){return Gu.makeScale(e,t,r),this.applyMatrix4(Gu),this}lookAt(e){return wD.lookAt(e),wD.updateMatrix(),this.applyMatrix4(wD.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(xS).negate(),this.translate(xS.x,xS.y,xS.z),this}setFromPoints(e){let t=[];for(let r=0,n=e.length;r<n;r++){let l=e[r];t.push(l.x,l.y,l.z||0)}return this.setAttribute("position",new bM(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Co);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Se(-1/0,-1/0,-1/0),new Se(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,n=t.length;r<n;r++){let l=t[r];Au.setFromBufferAttribute(l),this.morphTargetsRelative?(Va.addVectors(this.boundingBox.min,Au.min),this.boundingBox.expandByPoint(Va),Va.addVectors(this.boundingBox.max,Au.max),this.boundingBox.expandByPoint(Va)):(this.boundingBox.expandByPoint(Au.min),this.boundingBox.expandByPoint(Au.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new tf);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Se,1/0);return}if(e){let r=this.boundingSphere.center;if(Au.setFromBufferAttribute(e),t)for(let l=0,c=t.length;l<c;l++){let h=t[l];mT.setFromBufferAttribute(h),this.morphTargetsRelative?(Va.addVectors(Au.min,mT.min),Au.expandByPoint(Va),Va.addVectors(Au.max,mT.max),Au.expandByPoint(Va)):(Au.expandByPoint(mT.min),Au.expandByPoint(mT.max))}Au.getCenter(r);let n=0;for(let l=0,c=e.count;l<c;l++)Va.fromBufferAttribute(e,l),n=Math.max(n,r.distanceToSquared(Va));if(t)for(let l=0,c=t.length;l<c;l++){let h=t[l],d=this.morphTargetsRelative;for(let f=0,m=h.count;f<m;f++)Va.fromBufferAttribute(h,f),d&&(xS.fromBufferAttribute(e,f),Va.add(xS)),n=Math.max(n,r.distanceToSquared(Va))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let r=e.array,n=t.position.array,l=t.normal.array,c=t.uv.array,h=n.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new zu(new Float32Array(4*h),4));let d=this.getAttribute("tangent").array,f=[],m=[];for(let F=0;F<h;F++)f[F]=new Se,m[F]=new Se;let g=new Se,y=new Se,_=new Se,b=new mi,S=new mi,E=new mi,T=new Se,A=new Se;function P(F,z,G){g.fromArray(n,F*3),y.fromArray(n,z*3),_.fromArray(n,G*3),b.fromArray(c,F*2),S.fromArray(c,z*2),E.fromArray(c,G*2),y.sub(g),_.sub(g),S.sub(b),E.sub(b);let J=1/(S.x*E.y-E.x*S.y);!isFinite(J)||(T.copy(y).multiplyScalar(E.y).addScaledVector(_,-S.y).multiplyScalar(J),A.copy(_).multiplyScalar(S.x).addScaledVector(y,-E.x).multiplyScalar(J),f[F].add(T),f[z].add(T),f[G].add(T),m[F].add(A),m[z].add(A),m[G].add(A))}let O=this.groups;O.length===0&&(O=[{start:0,count:r.length}]);for(let F=0,z=O.length;F<z;++F){let G=O[F],J=G.start,Z=G.count;for(let q=J,$=J+Z;q<$;q+=3)P(r[q+0],r[q+1],r[q+2])}let R=new Se,D=new Se,L=new Se,N=new Se;function U(F){L.fromArray(l,F*3),N.copy(L);let z=f[F];R.copy(z),R.sub(L.multiplyScalar(L.dot(z))).normalize(),D.crossVectors(N,z);let G=D.dot(m[F])<0?-1:1;d[F*4]=R.x,d[F*4+1]=R.y,d[F*4+2]=R.z,d[F*4+3]=G}for(let F=0,z=O.length;F<z;++F){let G=O[F],J=G.start,Z=G.count;for(let q=J,$=J+Z;q<$;q+=3)U(r[q+0]),U(r[q+1]),U(r[q+2])}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new zu(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let y=0,_=r.count;y<_;y++)r.setXYZ(y,0,0,0);let n=new Se,l=new Se,c=new Se,h=new Se,d=new Se,f=new Se,m=new Se,g=new Se;if(e)for(let y=0,_=e.count;y<_;y+=3){let b=e.getX(y+0),S=e.getX(y+1),E=e.getX(y+2);n.fromBufferAttribute(t,b),l.fromBufferAttribute(t,S),c.fromBufferAttribute(t,E),m.subVectors(c,l),g.subVectors(n,l),m.cross(g),h.fromBufferAttribute(r,b),d.fromBufferAttribute(r,S),f.fromBufferAttribute(r,E),h.add(m),d.add(m),f.add(m),r.setXYZ(b,h.x,h.y,h.z),r.setXYZ(S,d.x,d.y,d.z),r.setXYZ(E,f.x,f.y,f.z)}else for(let y=0,_=t.count;y<_;y+=3)n.fromBufferAttribute(t,y+0),l.fromBufferAttribute(t,y+1),c.fromBufferAttribute(t,y+2),m.subVectors(c,l),g.subVectors(n,l),m.cross(g),r.setXYZ(y+0,m.x,m.y,m.z),r.setXYZ(y+1,m.x,m.y,m.z),r.setXYZ(y+2,m.x,m.y,m.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){let e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)Va.fromBufferAttribute(e,t),Va.normalize(),e.setXYZ(t,Va.x,Va.y,Va.z)}toNonIndexed(){function e(h,d){let f=h.array,m=h.itemSize,g=h.normalized,y=new f.constructor(d.length*m),_=0,b=0;for(let S=0,E=d.length;S<E;S++){h.isInterleavedBufferAttribute?_=d[S]*h.data.stride+h.offset:_=d[S]*m;for(let T=0;T<m;T++)y[b++]=f[_++]}return new zu(y,m,g)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new Op,r=this.index.array,n=this.attributes;for(let h in n){let d=n[h],f=e(d,r);t.setAttribute(h,f)}let l=this.morphAttributes;for(let h in l){let d=[],f=l[h];for(let m=0,g=f.length;m<g;m++){let y=f[m],_=e(y,r);d.push(_)}t.morphAttributes[h]=d}t.morphTargetsRelative=this.morphTargetsRelative;let c=this.groups;for(let h=0,d=c.length;h<d;h++){let f=c[h];t.addGroup(f.start,f.count,f.materialIndex)}return t}toJSON(){let e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let d=this.parameters;for(let f in d)d[f]!==void 0&&(e[f]=d[f]);return e}e.data={attributes:{}};let t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let r=this.attributes;for(let d in r){let f=r[d];e.data.attributes[d]=f.toJSON(e.data)}let n={},l=!1;for(let d in this.morphAttributes){let f=this.morphAttributes[d],m=[];for(let g=0,y=f.length;g<y;g++){let _=f[g];m.push(_.toJSON(e.data))}m.length>0&&(n[d]=m,l=!0)}l&&(e.data.morphAttributes=n,e.data.morphTargetsRelative=this.morphTargetsRelative);let c=this.groups;c.length>0&&(e.data.groups=JSON.parse(JSON.stringify(c)));let h=this.boundingSphere;return h!==null&&(e.data.boundingSphere={center:h.center.toArray(),radius:h.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let r=e.index;r!==null&&this.setIndex(r.clone(t));let n=e.attributes;for(let f in n){let m=n[f];this.setAttribute(f,m.clone(t))}let l=e.morphAttributes;for(let f in l){let m=[],g=l[f];for(let y=0,_=g.length;y<_;y++)m.push(g[y].clone(t));this.morphAttributes[f]=m}this.morphTargetsRelative=e.morphTargetsRelative;let c=e.groups;for(let f=0,m=c.length;f<m;f++){let g=c[f];this.addGroup(g.start,g.count,g.materialIndex)}let h=e.boundingBox;h!==null&&(this.boundingBox=h.clone());let d=e.boundingSphere;return d!==null&&(this.boundingSphere=d.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}},LW=new ar,g1=new AE,tP=new tf,OW=new Se,bS=new Se,wS=new Se,SS=new Se,SD=new Se,iP=new Se,rP=new mi,nP=new mi,sP=new mi,NW=new Se,DW=new Se,kW=new Se,aP=new Se,oP=new Se,Sw=class extends Wn{constructor(i=new Op,e=new U1){super(),this.isMesh=!0,this.type="Mesh",this.geometry=i,this.material=e,this.updateMorphTargets()}copy(i,e){return super.copy(i,e),i.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=i.morphTargetInfluences.slice()),i.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},i.morphTargetDictionary)),this.material=Array.isArray(i.material)?i.material.slice():i.material,this.geometry=i.geometry,this}updateMorphTargets(){let i=this.geometry.morphAttributes,e=Object.keys(i);if(e.length>0){let t=i[e[0]];if(t!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,n=t.length;r<n;r++){let l=t[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=r}}}}getVertexPosition(i,e){let t=this.geometry,r=t.attributes.position,n=t.morphAttributes.position,l=t.morphTargetsRelative;e.fromBufferAttribute(r,i);let c=this.morphTargetInfluences;if(n&&c){iP.set(0,0,0);for(let h=0,d=n.length;h<d;h++){let f=c[h],m=n[h];f!==0&&(SD.fromBufferAttribute(m,i),l?iP.addScaledVector(SD,f):iP.addScaledVector(SD.sub(e),f))}e.add(iP)}return e}raycast(i,e){let t=this.geometry,r=this.material,n=this.matrixWorld;r!==void 0&&(t.boundingSphere===null&&t.computeBoundingSphere(),tP.copy(t.boundingSphere),tP.applyMatrix4(n),g1.copy(i.ray).recast(i.near),!(tP.containsPoint(g1.origin)===!1&&(g1.intersectSphere(tP,OW)===null||g1.origin.distanceToSquared(OW)>QJ(i.far-i.near,2)))&&(LW.copy(n).invert(),g1.copy(i.ray).applyMatrix4(LW),!(t.boundingBox!==null&&g1.intersectsBox(t.boundingBox)===!1)&&this._computeIntersections(i,e,g1)))}_computeIntersections(i,e,t){let r,n=this.geometry,l=this.material,c=n.index,h=n.attributes.position,d=n.attributes.uv,f=n.attributes.uv1,m=n.attributes.normal,g=n.groups,y=n.drawRange;if(c!==null)if(Array.isArray(l))for(let _=0,b=g.length;_<b;_++){let S=g[_],E=l[S.materialIndex],T=Math.max(S.start,y.start),A=Math.min(c.count,Math.min(S.start+S.count,y.start+y.count));for(let P=T,O=A;P<O;P+=3){let R=c.getX(P),D=c.getX(P+1),L=c.getX(P+2);r=lP(this,E,i,t,d,f,m,R,D,L),r&&(r.faceIndex=Math.floor(P/3),r.face.materialIndex=S.materialIndex,e.push(r))}}else{let _=Math.max(0,y.start),b=Math.min(c.count,y.start+y.count);for(let S=_,E=b;S<E;S+=3){let T=c.getX(S),A=c.getX(S+1),P=c.getX(S+2);r=lP(this,l,i,t,d,f,m,T,A,P),r&&(r.faceIndex=Math.floor(S/3),e.push(r))}}else if(h!==void 0)if(Array.isArray(l))for(let _=0,b=g.length;_<b;_++){let S=g[_],E=l[S.materialIndex],T=Math.max(S.start,y.start),A=Math.min(h.count,Math.min(S.start+S.count,y.start+y.count));for(let P=T,O=A;P<O;P+=3){let R=P,D=P+1,L=P+2;r=lP(this,E,i,t,d,f,m,R,D,L),r&&(r.faceIndex=Math.floor(P/3),r.face.materialIndex=S.materialIndex,e.push(r))}}else{let _=Math.max(0,y.start),b=Math.min(h.count,y.start+y.count);for(let S=_,E=b;S<E;S+=3){let T=S,A=S+1,P=S+2;r=lP(this,l,i,t,d,f,m,T,A,P),r&&(r.faceIndex=Math.floor(S/3),e.push(r))}}}};function SMe(i,e,t,r,n,l,c,h){let d;if(e.side===rY?d=r.intersectTriangle(c,l,n,!0,h):d=r.intersectTriangle(n,l,c,e.side===JM,h),d===null)return null;oP.copy(h),oP.applyMatrix4(i.matrixWorld);let f=t.ray.origin.distanceTo(oP);return f<t.near||f>t.far?null:{distance:f,point:oP.clone(),object:i}}function lP(i,e,t,r,n,l,c,h,d,f){i.getVertexPosition(h,bS),i.getVertexPosition(d,wS),i.getVertexPosition(f,SS);let m=SMe(i,e,t,r,bS,wS,SS,aP);if(m){n&&(rP.fromBufferAttribute(n,h),nP.fromBufferAttribute(n,d),sP.fromBufferAttribute(n,f),m.uv=ou.getInterpolation(aP,bS,wS,SS,rP,nP,sP,new mi)),l&&(rP.fromBufferAttribute(l,h),nP.fromBufferAttribute(l,d),sP.fromBufferAttribute(l,f),m.uv1=ou.getInterpolation(aP,bS,wS,SS,rP,nP,sP,new mi),m.uv2=m.uv1),c&&(NW.fromBufferAttribute(c,h),DW.fromBufferAttribute(c,d),kW.fromBufferAttribute(c,f),m.normal=ou.getInterpolation(aP,bS,wS,SS,NW,DW,kW,new Se),m.normal.dot(r.direction)>0&&m.normal.multiplyScalar(-1));let g={a:h,b:d,c:f,normal:new Se,materialIndex:0};ou.getNormal(bS,wS,SS,g.normal),m.face=g}return m}function MMe(i){let e={};for(let t in i){e[t]={};for(let r in i[t]){let n=i[t][r];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?n.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][r]=null):e[t][r]=n.clone():Array.isArray(n)?e[t][r]=n.slice():e[t][r]=n}}return e}function iu(i){let e={};for(let t=0;t<i.length;t++){let r=MMe(i[t]);for(let n in r)e[n]=r[n]}return e}var dY=class extends Wn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new ar,this.projectionMatrix=new ar,this.projectionMatrixInverse=new ar,this.coordinateSystem=B1}copy(i,e){return super.copy(i,e),this.matrixWorldInverse.copy(i.matrixWorldInverse),this.projectionMatrix.copy(i.projectionMatrix),this.projectionMatrixInverse.copy(i.projectionMatrixInverse),this.coordinateSystem=i.coordinateSystem,this}getWorldDirection(i){return super.getWorldDirection(i).negate()}updateMatrixWorld(i){super.updateMatrixWorld(i),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(i,e){super.updateWorldMatrix(i,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},aU=class extends dY{constructor(i=50,e=1,t=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=i,this.zoom=1,this.near=t,this.far=r,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(i,e){return super.copy(i,e),this.fov=i.fov,this.zoom=i.zoom,this.near=i.near,this.far=i.far,this.focus=i.focus,this.aspect=i.aspect,this.view=i.view===null?null:Object.assign({},i.view),this.filmGauge=i.filmGauge,this.filmOffset=i.filmOffset,this}setFocalLength(i){let e=.5*this.getFilmHeight()/i;this.fov=nC*2*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){let i=Math.tan(iA*.5*this.fov);return .5*this.getFilmHeight()/i}getEffectiveFOV(){return nC*2*Math.atan(Math.tan(iA*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(i,e,t,r,n,l){this.aspect=i/e,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=i,this.view.fullHeight=e,this.view.offsetX=t,this.view.offsetY=r,this.view.width=n,this.view.height=l,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let i=this.near,e=i*Math.tan(iA*.5*this.fov)/this.zoom,t=2*e,r=this.aspect*t,n=-.5*r,l=this.view;if(this.view!==null&&this.view.enabled){let h=l.fullWidth,d=l.fullHeight;n+=l.offsetX*r/h,e-=l.offsetY*t/d,r*=l.width/h,t*=l.height/d}let c=this.filmOffset;c!==0&&(n+=i*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(n,n+r,e,e-t,i,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(i){let e=super.toJSON(i);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,this.view!==null&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}},EMe=class extends Eo{constructor(i,e,t,r,n,l,c,h,d,f){i=i!==void 0?i:[],e=e!==void 0?e:ASe,super(i,e,t,r,n,l,c,h,d,f),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(i){this.image=i}},MD=new Se,TMe=new Se,AMe=new Er,bm=class{constructor(i=new Se(1,0,0),e=0){this.isPlane=!0,this.normal=i,this.constant=e}set(i,e){return this.normal.copy(i),this.constant=e,this}setComponents(i,e,t,r){return this.normal.set(i,e,t),this.constant=r,this}setFromNormalAndCoplanarPoint(i,e){return this.normal.copy(i),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(i,e,t){let r=MD.subVectors(t,e).cross(TMe.subVectors(i,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,i),this}copy(i){return this.normal.copy(i.normal),this.constant=i.constant,this}normalize(){let i=1/this.normal.length();return this.normal.multiplyScalar(i),this.constant*=i,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(i){return this.normal.dot(i)+this.constant}distanceToSphere(i){return this.distanceToPoint(i.center)-i.radius}projectPoint(i,e){return e.copy(i).addScaledVector(this.normal,-this.distanceToPoint(i))}intersectLine(i,e){let t=i.delta(MD),r=this.normal.dot(t);if(r===0)return this.distanceToPoint(i.start)===0?e.copy(i.start):null;let n=-(i.start.dot(this.normal)+this.constant)/r;return n<0||n>1?null:e.copy(i.start).addScaledVector(t,n)}intersectsLine(i){let e=this.distanceToPoint(i.start),t=this.distanceToPoint(i.end);return e<0&&t>0||t<0&&e>0}intersectsBox(i){return i.intersectsPlane(this)}intersectsSphere(i){return i.intersectsPlane(this)}coplanarPoint(i){return i.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(i,e){let t=e||AMe.getNormalMatrix(i),r=this.coplanarPoint(MD).applyMatrix4(i),n=this.normal.applyMatrix3(t).normalize();return this.constant=-r.dot(n),this}translate(i){return this.constant-=i.dot(this.normal),this}equals(i){return i.normal.equals(this.normal)&&i.constant===this.constant}clone(){return new this.constructor().copy(this)}},v1=new tf,uP=new Se,CMe=class{constructor(i=new bm,e=new bm,t=new bm,r=new bm,n=new bm,l=new bm){this.planes=[i,e,t,r,n,l]}set(i,e,t,r,n,l){let c=this.planes;return c[0].copy(i),c[1].copy(e),c[2].copy(t),c[3].copy(r),c[4].copy(n),c[5].copy(l),this}copy(i){let e=this.planes;for(let t=0;t<6;t++)e[t].copy(i.planes[t]);return this}setFromProjectionMatrix(i,e=B1){let t=this.planes,r=i.elements,n=r[0],l=r[1],c=r[2],h=r[3],d=r[4],f=r[5],m=r[6],g=r[7],y=r[8],_=r[9],b=r[10],S=r[11],E=r[12],T=r[13],A=r[14],P=r[15];if(t[0].setComponents(h-n,g-d,S-y,P-E).normalize(),t[1].setComponents(h+n,g+d,S+y,P+E).normalize(),t[2].setComponents(h+l,g+f,S+_,P+T).normalize(),t[3].setComponents(h-l,g-f,S-_,P-T).normalize(),t[4].setComponents(h-c,g-m,S-b,P-A).normalize(),e===B1)t[5].setComponents(h+c,g+m,S+b,P+A).normalize();else if(e===a4)t[5].setComponents(c,m,b,A).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+e);return this}intersectsObject(i){if(i.boundingSphere!==void 0)i.boundingSphere===null&&i.computeBoundingSphere(),v1.copy(i.boundingSphere).applyMatrix4(i.matrixWorld);else{let e=i.geometry;e.boundingSphere===null&&e.computeBoundingSphere(),v1.copy(e.boundingSphere).applyMatrix4(i.matrixWorld)}return this.intersectsSphere(v1)}intersectsSprite(i){return v1.center.set(0,0,0),v1.radius=.7071067811865476,v1.applyMatrix4(i.matrixWorld),this.intersectsSphere(v1)}intersectsSphere(i){let e=this.planes,t=i.center,r=-i.radius;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<r)return!1;return!0}intersectsBox(i){let e=this.planes;for(let t=0;t<6;t++){let r=e[t];if(uP.x=r.normal.x>0?i.max.x:i.min.x,uP.y=r.normal.y>0?i.max.y:i.min.y,uP.z=r.normal.z>0?i.max.z:i.min.z,r.distanceToPoint(uP)<0)return!1}return!0}containsPoint(i){let e=this.planes;for(let t=0;t<6;t++)if(e[t].distanceToPoint(i)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}},PMe=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,RMe=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,IMe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,LMe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,OMe=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,NMe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,DMe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,kMe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,FMe=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,zMe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,BMe=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,UMe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,HMe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,$Me=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,VMe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,WMe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,jMe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,GMe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,qMe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,XMe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,ZMe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,JMe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,YMe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,KMe=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,QMe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,eEe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,tEe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,iEe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,rEe="gl_FragColor = linearToOutputTexel( gl_FragColor );",nEe=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,sEe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,aEe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,oEe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,lEe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,uEe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,cEe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,hEe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,dEe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fEe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,pEe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,mEe=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,gEe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,vEe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,yEe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,_Ee=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,xEe=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,bEe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,wEe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,SEe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,MEe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,EEe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	anisotropyV /= material.anisotropy;
	material.anisotropy = saturate( material.anisotropy );
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;
#endif`,TEe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,AEe=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal;
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,CEe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,PEe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,REe=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,IEe=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,LEe=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,OEe=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,NEe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,DEe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,kEe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,FEe=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,zEe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,BEe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,UEe=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,HEe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,$Ee=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,VEe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,WEe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,jEe=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,GEe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,qEe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,XEe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,ZEe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,JEe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,YEe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,KEe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,QEe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,eTe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,tTe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,iTe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,rTe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,nTe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,sTe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,aTe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,oTe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,lTe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,uTe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,cTe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,hTe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,dTe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,fTe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,pTe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,mTe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,gTe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,vTe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,yTe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,_Te=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,xTe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,bTe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,wTe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,STe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,MTe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,ETe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,TTe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,ATe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,CTe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,PTe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,RTe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,ITe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,LTe=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,OTe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,NTe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,DTe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,kTe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,FTe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,zTe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,BTe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,UTe=`#include <common>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,HTe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,$Te=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,VTe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,WTe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,jTe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,GTe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,qTe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,XTe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,ZTe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,JTe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,YTe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,KTe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,QTe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,eAe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,tAe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,iAe=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,rAe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,nAe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,sAe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Mr={alphahash_fragment:PMe,alphahash_pars_fragment:RMe,alphamap_fragment:IMe,alphamap_pars_fragment:LMe,alphatest_fragment:OMe,alphatest_pars_fragment:NMe,aomap_fragment:DMe,aomap_pars_fragment:kMe,begin_vertex:FMe,beginnormal_vertex:zMe,bsdfs:BMe,iridescence_fragment:UMe,bumpmap_pars_fragment:HMe,clipping_planes_fragment:$Me,clipping_planes_pars_fragment:VMe,clipping_planes_pars_vertex:WMe,clipping_planes_vertex:jMe,color_fragment:GMe,color_pars_fragment:qMe,color_pars_vertex:XMe,color_vertex:ZMe,common:JMe,cube_uv_reflection_fragment:YMe,defaultnormal_vertex:KMe,displacementmap_pars_vertex:QMe,displacementmap_vertex:eEe,emissivemap_fragment:tEe,emissivemap_pars_fragment:iEe,colorspace_fragment:rEe,colorspace_pars_fragment:nEe,envmap_fragment:sEe,envmap_common_pars_fragment:aEe,envmap_pars_fragment:oEe,envmap_pars_vertex:lEe,envmap_physical_pars_fragment:xEe,envmap_vertex:uEe,fog_vertex:cEe,fog_pars_vertex:hEe,fog_fragment:dEe,fog_pars_fragment:fEe,gradientmap_pars_fragment:pEe,lightmap_fragment:mEe,lightmap_pars_fragment:gEe,lights_lambert_fragment:vEe,lights_lambert_pars_fragment:yEe,lights_pars_begin:_Ee,lights_toon_fragment:bEe,lights_toon_pars_fragment:wEe,lights_phong_fragment:SEe,lights_phong_pars_fragment:MEe,lights_physical_fragment:EEe,lights_physical_pars_fragment:TEe,lights_fragment_begin:AEe,lights_fragment_maps:CEe,lights_fragment_end:PEe,logdepthbuf_fragment:REe,logdepthbuf_pars_fragment:IEe,logdepthbuf_pars_vertex:LEe,logdepthbuf_vertex:OEe,map_fragment:NEe,map_pars_fragment:DEe,map_particle_fragment:kEe,map_particle_pars_fragment:FEe,metalnessmap_fragment:zEe,metalnessmap_pars_fragment:BEe,morphcolor_vertex:UEe,morphnormal_vertex:HEe,morphtarget_pars_vertex:$Ee,morphtarget_vertex:VEe,normal_fragment_begin:WEe,normal_fragment_maps:jEe,normal_pars_fragment:GEe,normal_pars_vertex:qEe,normal_vertex:XEe,normalmap_pars_fragment:ZEe,clearcoat_normal_fragment_begin:JEe,clearcoat_normal_fragment_maps:YEe,clearcoat_pars_fragment:KEe,iridescence_pars_fragment:QEe,opaque_fragment:eTe,packing:tTe,premultiplied_alpha_fragment:iTe,project_vertex:rTe,dithering_fragment:nTe,dithering_pars_fragment:sTe,roughnessmap_fragment:aTe,roughnessmap_pars_fragment:oTe,shadowmap_pars_fragment:lTe,shadowmap_pars_vertex:uTe,shadowmap_vertex:cTe,shadowmask_pars_fragment:hTe,skinbase_vertex:dTe,skinning_pars_vertex:fTe,skinning_vertex:pTe,skinnormal_vertex:mTe,specularmap_fragment:gTe,specularmap_pars_fragment:vTe,tonemapping_fragment:yTe,tonemapping_pars_fragment:_Te,transmission_fragment:xTe,transmission_pars_fragment:bTe,uv_pars_fragment:wTe,uv_pars_vertex:STe,uv_vertex:MTe,worldpos_vertex:ETe,background_vert:TTe,background_frag:ATe,backgroundCube_vert:CTe,backgroundCube_frag:PTe,cube_vert:RTe,cube_frag:ITe,depth_vert:LTe,depth_frag:OTe,distanceRGBA_vert:NTe,distanceRGBA_frag:DTe,equirect_vert:kTe,equirect_frag:FTe,linedashed_vert:zTe,linedashed_frag:BTe,meshbasic_vert:UTe,meshbasic_frag:HTe,meshlambert_vert:$Te,meshlambert_frag:VTe,meshmatcap_vert:WTe,meshmatcap_frag:jTe,meshnormal_vert:GTe,meshnormal_frag:qTe,meshphong_vert:XTe,meshphong_frag:ZTe,meshphysical_vert:JTe,meshphysical_frag:YTe,meshtoon_vert:KTe,meshtoon_frag:QTe,points_vert:eAe,points_frag:tAe,shadow_vert:iAe,shadow_frag:rAe,sprite_vert:nAe,sprite_frag:sAe},Yt={common:{diffuse:{value:new Tr(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Er},alphaMap:{value:null},alphaMapTransform:{value:new Er},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Er}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Er}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Er}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Er},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Er},normalScale:{value:new mi(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Er},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Er}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Er}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Er}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Tr(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Tr(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Er},alphaTest:{value:0},uvTransform:{value:new Er}},sprite:{diffuse:{value:new Tr(16777215)},opacity:{value:1},center:{value:new mi(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Er},alphaMap:{value:null},alphaMapTransform:{value:new Er},alphaTest:{value:0}}},FW={basic:{uniforms:iu([Yt.common,Yt.specularmap,Yt.envmap,Yt.aomap,Yt.lightmap,Yt.fog]),vertexShader:Mr.meshbasic_vert,fragmentShader:Mr.meshbasic_frag},lambert:{uniforms:iu([Yt.common,Yt.specularmap,Yt.envmap,Yt.aomap,Yt.lightmap,Yt.emissivemap,Yt.bumpmap,Yt.normalmap,Yt.displacementmap,Yt.fog,Yt.lights,{emissive:{value:new Tr(0)}}]),vertexShader:Mr.meshlambert_vert,fragmentShader:Mr.meshlambert_frag},phong:{uniforms:iu([Yt.common,Yt.specularmap,Yt.envmap,Yt.aomap,Yt.lightmap,Yt.emissivemap,Yt.bumpmap,Yt.normalmap,Yt.displacementmap,Yt.fog,Yt.lights,{emissive:{value:new Tr(0)},specular:{value:new Tr(1118481)},shininess:{value:30}}]),vertexShader:Mr.meshphong_vert,fragmentShader:Mr.meshphong_frag},standard:{uniforms:iu([Yt.common,Yt.envmap,Yt.aomap,Yt.lightmap,Yt.emissivemap,Yt.bumpmap,Yt.normalmap,Yt.displacementmap,Yt.roughnessmap,Yt.metalnessmap,Yt.fog,Yt.lights,{emissive:{value:new Tr(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Mr.meshphysical_vert,fragmentShader:Mr.meshphysical_frag},toon:{uniforms:iu([Yt.common,Yt.aomap,Yt.lightmap,Yt.emissivemap,Yt.bumpmap,Yt.normalmap,Yt.displacementmap,Yt.gradientmap,Yt.fog,Yt.lights,{emissive:{value:new Tr(0)}}]),vertexShader:Mr.meshtoon_vert,fragmentShader:Mr.meshtoon_frag},matcap:{uniforms:iu([Yt.common,Yt.bumpmap,Yt.normalmap,Yt.displacementmap,Yt.fog,{matcap:{value:null}}]),vertexShader:Mr.meshmatcap_vert,fragmentShader:Mr.meshmatcap_frag},points:{uniforms:iu([Yt.points,Yt.fog]),vertexShader:Mr.points_vert,fragmentShader:Mr.points_frag},dashed:{uniforms:iu([Yt.common,Yt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Mr.linedashed_vert,fragmentShader:Mr.linedashed_frag},depth:{uniforms:iu([Yt.common,Yt.displacementmap]),vertexShader:Mr.depth_vert,fragmentShader:Mr.depth_frag},normal:{uniforms:iu([Yt.common,Yt.bumpmap,Yt.normalmap,Yt.displacementmap,{opacity:{value:1}}]),vertexShader:Mr.meshnormal_vert,fragmentShader:Mr.meshnormal_frag},sprite:{uniforms:iu([Yt.sprite,Yt.fog]),vertexShader:Mr.sprite_vert,fragmentShader:Mr.sprite_frag},background:{uniforms:{uvTransform:{value:new Er},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Mr.background_vert,fragmentShader:Mr.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Mr.backgroundCube_vert,fragmentShader:Mr.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Mr.cube_vert,fragmentShader:Mr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Mr.equirect_vert,fragmentShader:Mr.equirect_frag},distanceRGBA:{uniforms:iu([Yt.common,Yt.displacementmap,{referencePosition:{value:new Se},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Mr.distanceRGBA_vert,fragmentShader:Mr.distanceRGBA_frag},shadow:{uniforms:iu([Yt.lights,Yt.fog,{color:{value:new Tr(0)},opacity:{value:1}}]),vertexShader:Mr.shadow_vert,fragmentShader:Mr.shadow_frag}};FW.physical={uniforms:iu([FW.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Er},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Er},clearcoatNormalScale:{value:new mi(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Er},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Er},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Er},sheen:{value:0},sheenColor:{value:new Tr(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Er},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Er},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Er},transmissionSamplerSize:{value:new mi},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Er},attenuationDistance:{value:0},attenuationColor:{value:new Tr(0)},specularColor:{value:new Tr(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Er},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Er},anisotropyVector:{value:new mi},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Er}}]),vertexShader:Mr.meshphysical_vert,fragmentShader:Mr.meshphysical_frag};var oU=class extends dY{constructor(i=-1,e=1,t=1,r=-1,n=.1,l=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=i,this.right=e,this.top=t,this.bottom=r,this.near=n,this.far=l,this.updateProjectionMatrix()}copy(i,e){return super.copy(i,e),this.left=i.left,this.right=i.right,this.top=i.top,this.bottom=i.bottom,this.near=i.near,this.far=i.far,this.zoom=i.zoom,this.view=i.view===null?null:Object.assign({},i.view),this}setViewOffset(i,e,t,r,n,l){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=i,this.view.fullHeight=e,this.view.offsetX=t,this.view.offsetY=r,this.view.width=n,this.view.height=l,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let i=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),t=(this.right+this.left)/2,r=(this.top+this.bottom)/2,n=t-i,l=t+i,c=r+e,h=r-e;if(this.view!==null&&this.view.enabled){let d=(this.right-this.left)/this.view.fullWidth/this.zoom,f=(this.top-this.bottom)/this.view.fullHeight/this.zoom;n+=d*this.view.offsetX,l=n+d*this.view.width,c-=f*this.view.offsetY,h=c-f*this.view.height}this.projectionMatrix.makeOrthographic(n,l,c,h,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(i){let e=super.toJSON(i);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,this.view!==null&&(e.object.view=Object.assign({},this.view)),e}};new oU;new Tr;var E1=(1+Math.sqrt(5))/2,MS=1/E1;new Se(1,1,1),new Se(-1,1,1),new Se(1,1,-1),new Se(-1,1,-1),new Se(0,E1,MS),new Se(0,E1,-MS),new Se(MS,0,E1),new Se(-MS,0,E1),new Se(E1,MS,0),new Se(-E1,MS,0);new Eo;new uMe;new cMe;new EMe;var ED=class extends Wn{constructor(){super(),this.isGroup=!0,this.type="Group"}},fY=class{constructor(i,e){this.isInterleavedBuffer=!0,this.array=i,this.stride=e,this.count=i!==void 0?i.length/e:0,this.usage=s4,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Gd()}onUploadCallback(){}set needsUpdate(i){i===!0&&this.version++}setUsage(i){return this.usage=i,this}copy(i){return this.array=new i.array.constructor(i.array),this.count=i.count,this.stride=i.stride,this.usage=i.usage,this}copyAt(i,e,t){i*=this.stride,t*=e.stride;for(let r=0,n=this.stride;r<n;r++)this.array[i+r]=e.array[t+r];return this}set(i,e=0){return this.array.set(i,e),this}clone(i){i.arrayBuffers===void 0&&(i.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Gd()),i.arrayBuffers[this.array.buffer._uuid]===void 0&&(i.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let e=new this.array.constructor(i.arrayBuffers[this.array.buffer._uuid]),t=new this.constructor(e,this.stride);return t.setUsage(this.usage),t}onUpload(i){return this.onUploadCallback=i,this}toJSON(i){return i.arrayBuffers===void 0&&(i.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Gd()),i.arrayBuffers[this.array.buffer._uuid]===void 0&&(i.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},Ul=new Se,uI=class{constructor(e,t,r,n=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=n}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)Ul.fromBufferAttribute(this,t),Ul.applyMatrix4(e),this.setXYZ(t,Ul.x,Ul.y,Ul.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Ul.fromBufferAttribute(this,t),Ul.applyNormalMatrix(e),this.setXYZ(t,Ul.x,Ul.y,Ul.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Ul.fromBufferAttribute(this,t),Ul.transformDirection(e),this.setXYZ(t,Ul.x,Ul.y,Ul.z);return this}setX(e,t){return this.normalized&&(t=yn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=yn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=yn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=yn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=pf(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=pf(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=pf(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=pf(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=yn(t,this.array),r=yn(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=yn(t,this.array),r=yn(r,this.array),n=yn(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this}setXYZW(e,t,r,n,l){return e=e*this.data.stride+this.offset,this.normalized&&(t=yn(t,this.array),r=yn(r,this.array),n=yn(n,this.array),l=yn(l,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this.data.array[e+3]=l,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let n=r*this.data.stride+this.offset;for(let l=0;l<this.itemSize;l++)t.push(this.data.array[n+l])}return new zu(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new uI(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let n=r*this.data.stride+this.offset;for(let l=0;l<this.itemSize;l++)t.push(this.data.array[n+l])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},lU=class extends Wm{constructor(i){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Tr(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(i)}copy(i){return super.copy(i),this.color.copy(i.color),this.map=i.map,this.alphaMap=i.alphaMap,this.rotation=i.rotation,this.sizeAttenuation=i.sizeAttenuation,this.fog=i.fog,this}},ES,gT=new Se,TS=new Se,AS=new Se,CS=new mi,vT=new mi,pY=new ar,cP=new Se,yT=new Se,hP=new Se,zW=new mi,TD=new mi,BW=new mi,mY=class extends Wn{constructor(i=new lU){if(super(),this.isSprite=!0,this.type="Sprite",ES===void 0){ES=new Op;let e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),t=new fY(e,5);ES.setIndex([0,1,2,0,2,3]),ES.setAttribute("position",new uI(t,3,0,!1)),ES.setAttribute("uv",new uI(t,2,3,!1))}this.geometry=ES,this.material=i,this.center=new mi(.5,.5)}raycast(i,e){i.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),TS.setFromMatrixScale(this.matrixWorld),pY.copy(i.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(i.camera.matrixWorldInverse,this.matrixWorld),AS.setFromMatrixPosition(this.modelViewMatrix),i.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&TS.multiplyScalar(-AS.z);let t=this.material.rotation,r,n;t!==0&&(n=Math.cos(t),r=Math.sin(t));let l=this.center;dP(cP.set(-.5,-.5,0),AS,l,TS,r,n),dP(yT.set(.5,-.5,0),AS,l,TS,r,n),dP(hP.set(.5,.5,0),AS,l,TS,r,n),zW.set(0,0),TD.set(1,0),BW.set(1,1);let c=i.ray.intersectTriangle(cP,yT,hP,!1,gT);if(c===null&&(dP(yT.set(-.5,.5,0),AS,l,TS,r,n),TD.set(0,1),c=i.ray.intersectTriangle(cP,hP,yT,!1,gT),c===null))return;let h=i.ray.origin.distanceTo(gT);h<i.near||h>i.far||e.push({distance:h,point:gT.clone(),uv:ou.getInterpolation(gT,cP,yT,hP,zW,TD,BW,new mi),face:null,object:this})}copy(i,e){return super.copy(i,e),i.center!==void 0&&this.center.copy(i.center),this.material=i.material,this}};function dP(i,e,t,r,n,l){CS.subVectors(i,t).addScalar(.5).multiply(r),n!==void 0?(vT.x=l*CS.x-n*CS.y,vT.y=n*CS.x+l*CS.y):vT.copy(CS),i.copy(e),i.x+=vT.x,i.y+=vT.y,i.applyMatrix4(pY)}var UW=new Se,HW=new Fd,$W=new Fd,aAe=new Se,VW=new ar,PS=new Se,AD=new tf,WW=new ar,CD=new AE,oAe=class extends Sw{constructor(i,e){super(i,e),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new ar,this.bindMatrixInverse=new ar,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){let i=this.geometry;this.boundingBox===null&&(this.boundingBox=new Co),this.boundingBox.makeEmpty();let e=i.getAttribute("position");for(let t=0;t<e.count;t++)PS.fromBufferAttribute(e,t),this.applyBoneTransform(t,PS),this.boundingBox.expandByPoint(PS)}computeBoundingSphere(){let i=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new tf),this.boundingSphere.makeEmpty();let e=i.getAttribute("position");for(let t=0;t<e.count;t++)PS.fromBufferAttribute(e,t),this.applyBoneTransform(t,PS),this.boundingSphere.expandByPoint(PS)}copy(i,e){return super.copy(i,e),this.bindMode=i.bindMode,this.bindMatrix.copy(i.bindMatrix),this.bindMatrixInverse.copy(i.bindMatrixInverse),this.skeleton=i.skeleton,i.boundingBox!==null&&(this.boundingBox=i.boundingBox.clone()),i.boundingSphere!==null&&(this.boundingSphere=i.boundingSphere.clone()),this}raycast(i,e){let t=this.material,r=this.matrixWorld;t!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),AD.copy(this.boundingSphere),AD.applyMatrix4(r),i.ray.intersectsSphere(AD)!==!1&&(WW.copy(r).invert(),CD.copy(i.ray).applyMatrix4(WW),!(this.boundingBox!==null&&CD.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(i,e,CD)))}getVertexPosition(i,e){return super.getVertexPosition(i,e),this.applyBoneTransform(i,e),e}bind(i,e){this.skeleton=i,e===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let i=new Fd,e=this.geometry.attributes.skinWeight;for(let t=0,r=e.count;t<r;t++){i.fromBufferAttribute(e,t);let n=1/i.manhattanLength();n!==1/0?i.multiplyScalar(n):i.set(1,0,0,0),e.setXYZW(t,i.x,i.y,i.z,i.w)}}updateMatrixWorld(i){super.updateMatrixWorld(i),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(i,e){let t=this.skeleton,r=this.geometry;HW.fromBufferAttribute(r.attributes.skinIndex,i),$W.fromBufferAttribute(r.attributes.skinWeight,i),UW.copy(e).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let n=0;n<4;n++){let l=$W.getComponent(n);if(l!==0){let c=HW.getComponent(n);VW.multiplyMatrices(t.bones[c].matrixWorld,t.boneInverses[c]),e.addScaledVector(aAe.copy(UW).applyMatrix4(VW),l)}}return e.applyMatrix4(this.bindMatrixInverse)}boneTransform(i,e){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(i,e)}},gY=class extends Wn{constructor(){super(),this.isBone=!0,this.type="Bone"}},lAe=class extends Eo{constructor(i=null,e=1,t=1,r,n,l,c,h,d=dw,f=dw,m,g){super(null,l,c,h,d,f,r,n,m,g),this.isDataTexture=!0,this.image={data:i,width:e,height:t},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},jW=new ar,uAe=new ar,vY=class{constructor(i=[],e=[]){this.uuid=Gd(),this.bones=i.slice(0),this.boneInverses=e,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.init()}init(){let i=this.bones,e=this.boneInverses;if(this.boneMatrices=new Float32Array(i.length*16),e.length===0)this.calculateInverses();else if(i.length!==e.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let t=0,r=this.bones.length;t<r;t++)this.boneInverses.push(new ar)}}calculateInverses(){this.boneInverses.length=0;for(let i=0,e=this.bones.length;i<e;i++){let t=new ar;this.bones[i]&&t.copy(this.bones[i].matrixWorld).invert(),this.boneInverses.push(t)}}pose(){for(let i=0,e=this.bones.length;i<e;i++){let t=this.bones[i];t&&t.matrixWorld.copy(this.boneInverses[i]).invert()}for(let i=0,e=this.bones.length;i<e;i++){let t=this.bones[i];t&&(t.parent&&t.parent.isBone?(t.matrix.copy(t.parent.matrixWorld).invert(),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}}update(){let i=this.bones,e=this.boneInverses,t=this.boneMatrices,r=this.boneTexture;for(let n=0,l=i.length;n<l;n++){let c=i[n]?i[n].matrixWorld:uAe;jW.multiplyMatrices(c,e[n]),jW.toArray(t,n*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new vY(this.bones,this.boneInverses)}computeBoneTexture(){let i=Math.sqrt(this.bones.length*4);i=uY(i),i=Math.max(i,4);let e=new Float32Array(i*i*4);e.set(this.boneMatrices);let t=new lAe(e,i,i,aY,sY);return t.needsUpdate=!0,this.boneMatrices=e,this.boneTexture=t,this.boneTextureSize=i,this}getBoneByName(i){for(let e=0,t=this.bones.length;e<t;e++){let r=this.bones[e];if(r.name===i)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(i,e){this.uuid=i.uuid;for(let t=0,r=i.bones.length;t<r;t++){let n=i.bones[t],l=e[n];l===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",n),l=new gY),this.bones.push(l),this.boneInverses.push(new ar().fromArray(i.boneInverses[t]))}return this.init(),this}toJSON(){let i={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};i.uuid=this.uuid;let e=this.bones,t=this.boneInverses;for(let r=0,n=e.length;r<n;r++){let l=e[r];i.bones.push(l.uuid);let c=t[r];i.boneInverses.push(c.toArray())}return i}},GW=class extends zu{constructor(i,e,t,r=1){super(i,e,t),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(i){return super.copy(i),this.meshPerAttribute=i.meshPerAttribute,this}toJSON(){let i=super.toJSON();return i.meshPerAttribute=this.meshPerAttribute,i.isInstancedBufferAttribute=!0,i}},RS=new ar,qW=new ar,fP=[],XW=new Co,cAe=new ar,_T=new Sw,xT=new tf,hAe=class extends Sw{constructor(i,e,t){super(i,e),this.isInstancedMesh=!0,this.instanceMatrix=new GW(new Float32Array(t*16),16),this.instanceColor=null,this.count=t,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<t;r++)this.setMatrixAt(r,cAe)}computeBoundingBox(){let i=this.geometry,e=this.count;this.boundingBox===null&&(this.boundingBox=new Co),i.boundingBox===null&&i.computeBoundingBox(),this.boundingBox.makeEmpty();for(let t=0;t<e;t++)this.getMatrixAt(t,RS),XW.copy(i.boundingBox).applyMatrix4(RS),this.boundingBox.union(XW)}computeBoundingSphere(){let i=this.geometry,e=this.count;this.boundingSphere===null&&(this.boundingSphere=new tf),i.boundingSphere===null&&i.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let t=0;t<e;t++)this.getMatrixAt(t,RS),xT.copy(i.boundingSphere).applyMatrix4(RS),this.boundingSphere.union(xT)}copy(i,e){return super.copy(i,e),this.instanceMatrix.copy(i.instanceMatrix),i.instanceColor!==null&&(this.instanceColor=i.instanceColor.clone()),this.count=i.count,i.boundingBox!==null&&(this.boundingBox=i.boundingBox.clone()),i.boundingSphere!==null&&(this.boundingSphere=i.boundingSphere.clone()),this}getColorAt(i,e){e.fromArray(this.instanceColor.array,i*3)}getMatrixAt(i,e){e.fromArray(this.instanceMatrix.array,i*16)}raycast(i,e){let t=this.matrixWorld,r=this.count;if(_T.geometry=this.geometry,_T.material=this.material,_T.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),xT.copy(this.boundingSphere),xT.applyMatrix4(t),i.ray.intersectsSphere(xT)!==!1))for(let n=0;n<r;n++){this.getMatrixAt(n,RS),qW.multiplyMatrices(t,RS),_T.matrixWorld=qW,_T.raycast(i,fP);for(let l=0,c=fP.length;l<c;l++){let h=fP[l];h.instanceId=n,h.object=this,e.push(h)}fP.length=0}}setColorAt(i,e){this.instanceColor===null&&(this.instanceColor=new GW(new Float32Array(this.instanceMatrix.count*3),3)),e.toArray(this.instanceColor.array,i*3)}setMatrixAt(i,e){e.toArray(this.instanceMatrix.array,i*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}},yY=class extends Wm{constructor(i){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Tr(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(i)}copy(i){return super.copy(i),this.color.copy(i.color),this.map=i.map,this.linewidth=i.linewidth,this.linecap=i.linecap,this.linejoin=i.linejoin,this.fog=i.fog,this}},ZW=new Se,JW=new Se,YW=new ar,PD=new AE,pP=new tf,uU=class extends Wn{constructor(i=new Op,e=new yY){super(),this.isLine=!0,this.type="Line",this.geometry=i,this.material=e,this.updateMorphTargets()}copy(i,e){return super.copy(i,e),this.material=Array.isArray(i.material)?i.material.slice():i.material,this.geometry=i.geometry,this}computeLineDistances(){let i=this.geometry;if(i.index===null){let e=i.attributes.position,t=[0];for(let r=1,n=e.count;r<n;r++)ZW.fromBufferAttribute(e,r-1),JW.fromBufferAttribute(e,r),t[r]=t[r-1],t[r]+=ZW.distanceTo(JW);i.setAttribute("lineDistance",new bM(t,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(i,e){let t=this.geometry,r=this.matrixWorld,n=i.params.Line.threshold,l=t.drawRange;if(t.boundingSphere===null&&t.computeBoundingSphere(),pP.copy(t.boundingSphere),pP.applyMatrix4(r),pP.radius+=n,i.ray.intersectsSphere(pP)===!1)return;YW.copy(r).invert(),PD.copy(i.ray).applyMatrix4(YW);let c=n/((this.scale.x+this.scale.y+this.scale.z)/3),h=c*c,d=new Se,f=new Se,m=new Se,g=new Se,y=this.isLineSegments?2:1,_=t.index,b=t.attributes.position;if(_!==null){let S=Math.max(0,l.start),E=Math.min(_.count,l.start+l.count);for(let T=S,A=E-1;T<A;T+=y){let P=_.getX(T),O=_.getX(T+1);if(d.fromBufferAttribute(b,P),f.fromBufferAttribute(b,O),PD.distanceSqToSegment(d,f,g,m)>h)continue;g.applyMatrix4(this.matrixWorld);let R=i.ray.origin.distanceTo(g);R<i.near||R>i.far||e.push({distance:R,point:m.clone().applyMatrix4(this.matrixWorld),index:T,face:null,faceIndex:null,object:this})}}else{let S=Math.max(0,l.start),E=Math.min(b.count,l.start+l.count);for(let T=S,A=E-1;T<A;T+=y){if(d.fromBufferAttribute(b,T),f.fromBufferAttribute(b,T+1),PD.distanceSqToSegment(d,f,g,m)>h)continue;g.applyMatrix4(this.matrixWorld);let P=i.ray.origin.distanceTo(g);P<i.near||P>i.far||e.push({distance:P,point:m.clone().applyMatrix4(this.matrixWorld),index:T,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let i=this.geometry.morphAttributes,e=Object.keys(i);if(e.length>0){let t=i[e[0]];if(t!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,n=t.length;r<n;r++){let l=t[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=r}}}}},KW=new Se,QW=new Se,dAe=class extends uU{constructor(i,e){super(i,e),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let i=this.geometry;if(i.index===null){let e=i.attributes.position,t=[];for(let r=0,n=e.count;r<n;r+=2)KW.fromBufferAttribute(e,r),QW.fromBufferAttribute(e,r+1),t[r]=r===0?0:t[r-1],t[r+1]=t[r]+KW.distanceTo(QW);i.setAttribute("lineDistance",new bM(t,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},fAe=class extends uU{constructor(i,e){super(i,e),this.isLineLoop=!0,this.type="LineLoop"}},_Y=class extends Wm{constructor(i){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Tr(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(i)}copy(i){return super.copy(i),this.color.copy(i.color),this.map=i.map,this.alphaMap=i.alphaMap,this.size=i.size,this.sizeAttenuation=i.sizeAttenuation,this.fog=i.fog,this}},ej=new ar,l4=new AE,mP=new tf,gP=new Se,pAe=class extends Wn{constructor(i=new Op,e=new _Y){super(),this.isPoints=!0,this.type="Points",this.geometry=i,this.material=e,this.updateMorphTargets()}copy(i,e){return super.copy(i,e),this.material=Array.isArray(i.material)?i.material.slice():i.material,this.geometry=i.geometry,this}raycast(i,e){let t=this.geometry,r=this.matrixWorld,n=i.params.Points.threshold,l=t.drawRange;if(t.boundingSphere===null&&t.computeBoundingSphere(),mP.copy(t.boundingSphere),mP.applyMatrix4(r),mP.radius+=n,i.ray.intersectsSphere(mP)===!1)return;ej.copy(r).invert(),l4.copy(i.ray).applyMatrix4(ej);let c=n/((this.scale.x+this.scale.y+this.scale.z)/3),h=c*c,d=t.index,f=t.attributes.position;if(d!==null){let m=Math.max(0,l.start),g=Math.min(d.count,l.start+l.count);for(let y=m,_=g;y<_;y++){let b=d.getX(y);gP.fromBufferAttribute(f,b),tj(gP,b,h,r,i,e,this)}}else{let m=Math.max(0,l.start),g=Math.min(f.count,l.start+l.count);for(let y=m,_=g;y<_;y++)gP.fromBufferAttribute(f,y),tj(gP,y,h,r,i,e,this)}}updateMorphTargets(){let i=this.geometry.morphAttributes,e=Object.keys(i);if(e.length>0){let t=i[e[0]];if(t!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,n=t.length;r<n;r++){let l=t[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=r}}}}};function tj(i,e,t,r,n,l,c){let h=l4.distanceSqToPoint(i);if(h<t){let d=new Se;l4.closestPointToPoint(i,d),d.applyMatrix4(r);let f=n.ray.origin.distanceTo(d);if(f<n.near||f>n.far)return;l.push({distance:f,distanceToRay:Math.sqrt(h),point:d,index:e,face:null,object:c})}}var Bp=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(i,e){let t=this.getUtoTmapping(i);return this.getPoint(t,e)}getPoints(i=5){let e=[];for(let t=0;t<=i;t++)e.push(this.getPoint(t/i));return e}getSpacedPoints(i=5){let e=[];for(let t=0;t<=i;t++)e.push(this.getPointAt(t/i));return e}getLength(){let i=this.getLengths();return i[i.length-1]}getLengths(i=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===i+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let e=[],t,r=this.getPoint(0),n=0;e.push(0);for(let l=1;l<=i;l++)t=this.getPoint(l/i),n+=t.distanceTo(r),e.push(n),r=t;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(i,e){let t=this.getLengths(),r=0,n=t.length,l;e?l=e:l=i*t[n-1];let c=0,h=n-1,d;for(;c<=h;)if(r=Math.floor(c+(h-c)/2),d=t[r]-l,d<0)c=r+1;else if(d>0)h=r-1;else{h=r;break}if(r=h,t[r]===l)return r/(n-1);let f=t[r],m=t[r+1]-f,g=(l-f)/m;return(r+g)/(n-1)}getTangent(i,e){let t=i-1e-4,r=i+1e-4;t<0&&(t=0),r>1&&(r=1);let n=this.getPoint(t),l=this.getPoint(r),c=e||(n.isVector2?new mi:new Se);return c.copy(l).sub(n).normalize(),c}getTangentAt(i,e){let t=this.getUtoTmapping(i);return this.getTangent(t,e)}computeFrenetFrames(i,e){let t=new Se,r=[],n=[],l=[],c=new Se,h=new ar;for(let y=0;y<=i;y++){let _=y/i;r[y]=this.getTangentAt(_,new Se)}n[0]=new Se,l[0]=new Se;let d=Number.MAX_VALUE,f=Math.abs(r[0].x),m=Math.abs(r[0].y),g=Math.abs(r[0].z);f<=d&&(d=f,t.set(1,0,0)),m<=d&&(d=m,t.set(0,1,0)),g<=d&&t.set(0,0,1),c.crossVectors(r[0],t).normalize(),n[0].crossVectors(r[0],c),l[0].crossVectors(r[0],n[0]);for(let y=1;y<=i;y++){if(n[y]=n[y-1].clone(),l[y]=l[y-1].clone(),c.crossVectors(r[y-1],r[y]),c.length()>Number.EPSILON){c.normalize();let _=Math.acos(La(r[y-1].dot(r[y]),-1,1));n[y].applyMatrix4(h.makeRotationAxis(c,_))}l[y].crossVectors(r[y],n[y])}if(e===!0){let y=Math.acos(La(n[0].dot(n[i]),-1,1));y/=i,r[0].dot(c.crossVectors(n[0],n[i]))>0&&(y=-y);for(let _=1;_<=i;_++)n[_].applyMatrix4(h.makeRotationAxis(r[_],y*_)),l[_].crossVectors(r[_],n[_])}return{tangents:r,normals:n,binormals:l}}clone(){return new this.constructor().copy(this)}copy(i){return this.arcLengthDivisions=i.arcLengthDivisions,this}toJSON(){let i={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return i.arcLengthDivisions=this.arcLengthDivisions,i.type=this.type,i}fromJSON(i){return this.arcLengthDivisions=i.arcLengthDivisions,this}},xY=class extends Bp{constructor(i=0,e=0,t=1,r=1,n=0,l=Math.PI*2,c=!1,h=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=i,this.aY=e,this.xRadius=t,this.yRadius=r,this.aStartAngle=n,this.aEndAngle=l,this.aClockwise=c,this.aRotation=h}getPoint(i,e){let t=e||new mi,r=Math.PI*2,n=this.aEndAngle-this.aStartAngle,l=Math.abs(n)<Number.EPSILON;for(;n<0;)n+=r;for(;n>r;)n-=r;n<Number.EPSILON&&(l?n=0:n=r),this.aClockwise===!0&&!l&&(n===r?n=-r:n=n-r);let c=this.aStartAngle+i*n,h=this.aX+this.xRadius*Math.cos(c),d=this.aY+this.yRadius*Math.sin(c);if(this.aRotation!==0){let f=Math.cos(this.aRotation),m=Math.sin(this.aRotation),g=h-this.aX,y=d-this.aY;h=g*f-y*m+this.aX,d=g*m+y*f+this.aY}return t.set(h,d)}copy(i){return super.copy(i),this.aX=i.aX,this.aY=i.aY,this.xRadius=i.xRadius,this.yRadius=i.yRadius,this.aStartAngle=i.aStartAngle,this.aEndAngle=i.aEndAngle,this.aClockwise=i.aClockwise,this.aRotation=i.aRotation,this}toJSON(){let i=super.toJSON();return i.aX=this.aX,i.aY=this.aY,i.xRadius=this.xRadius,i.yRadius=this.yRadius,i.aStartAngle=this.aStartAngle,i.aEndAngle=this.aEndAngle,i.aClockwise=this.aClockwise,i.aRotation=this.aRotation,i}fromJSON(i){return super.fromJSON(i),this.aX=i.aX,this.aY=i.aY,this.xRadius=i.xRadius,this.yRadius=i.yRadius,this.aStartAngle=i.aStartAngle,this.aEndAngle=i.aEndAngle,this.aClockwise=i.aClockwise,this.aRotation=i.aRotation,this}},mAe=class extends xY{constructor(i,e,t,r,n,l){super(i,e,t,t,r,n,l),this.isArcCurve=!0,this.type="ArcCurve"}};function cU(){let i=0,e=0,t=0,r=0;function n(l,c,h,d){i=l,e=h,t=-3*l+3*c-2*h-d,r=2*l-2*c+h+d}return{initCatmullRom:function(l,c,h,d,f){n(c,h,f*(h-l),f*(d-c))},initNonuniformCatmullRom:function(l,c,h,d,f,m,g){let y=(c-l)/f-(h-l)/(f+m)+(h-c)/m,_=(h-c)/m-(d-c)/(m+g)+(d-h)/g;y*=m,_*=m,n(c,h,y,_)},calc:function(l){let c=l*l,h=c*l;return i+e*l+t*c+r*h}}}var vP=new Se,RD=new cU,ID=new cU,LD=new cU,gAe=class extends Bp{constructor(i=[],e=!1,t="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=i,this.closed=e,this.curveType=t,this.tension=r}getPoint(i,e=new Se){let t=e,r=this.points,n=r.length,l=(n-(this.closed?0:1))*i,c=Math.floor(l),h=l-c;this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/n)+1)*n:h===0&&c===n-1&&(c=n-2,h=1);let d,f;this.closed||c>0?d=r[(c-1)%n]:(vP.subVectors(r[0],r[1]).add(r[0]),d=vP);let m=r[c%n],g=r[(c+1)%n];if(this.closed||c+2<n?f=r[(c+2)%n]:(vP.subVectors(r[n-1],r[n-2]).add(r[n-1]),f=vP),this.curveType==="centripetal"||this.curveType==="chordal"){let y=this.curveType==="chordal"?.5:.25,_=Math.pow(d.distanceToSquared(m),y),b=Math.pow(m.distanceToSquared(g),y),S=Math.pow(g.distanceToSquared(f),y);b<1e-4&&(b=1),_<1e-4&&(_=b),S<1e-4&&(S=b),RD.initNonuniformCatmullRom(d.x,m.x,g.x,f.x,_,b,S),ID.initNonuniformCatmullRom(d.y,m.y,g.y,f.y,_,b,S),LD.initNonuniformCatmullRom(d.z,m.z,g.z,f.z,_,b,S)}else this.curveType==="catmullrom"&&(RD.initCatmullRom(d.x,m.x,g.x,f.x,this.tension),ID.initCatmullRom(d.y,m.y,g.y,f.y,this.tension),LD.initCatmullRom(d.z,m.z,g.z,f.z,this.tension));return t.set(RD.calc(h),ID.calc(h),LD.calc(h)),t}copy(i){super.copy(i),this.points=[];for(let e=0,t=i.points.length;e<t;e++){let r=i.points[e];this.points.push(r.clone())}return this.closed=i.closed,this.curveType=i.curveType,this.tension=i.tension,this}toJSON(){let i=super.toJSON();i.points=[];for(let e=0,t=this.points.length;e<t;e++){let r=this.points[e];i.points.push(r.toArray())}return i.closed=this.closed,i.curveType=this.curveType,i.tension=this.tension,i}fromJSON(i){super.fromJSON(i),this.points=[];for(let e=0,t=i.points.length;e<t;e++){let r=i.points[e];this.points.push(new Se().fromArray(r))}return this.closed=i.closed,this.curveType=i.curveType,this.tension=i.tension,this}};function ij(i,e,t,r,n){let l=(r-e)*.5,c=(n-t)*.5,h=i*i,d=i*h;return(2*t-2*r+l+c)*d+(-3*t+3*r-2*l-c)*h+l*i+t}function vAe(i,e){let t=1-i;return t*t*e}function yAe(i,e){return 2*(1-i)*i*e}function _Ae(i,e){return i*i*e}function nA(i,e,t,r){return vAe(i,e)+yAe(i,t)+_Ae(i,r)}function xAe(i,e){let t=1-i;return t*t*t*e}function bAe(i,e){let t=1-i;return 3*t*t*i*e}function wAe(i,e){return 3*(1-i)*i*i*e}function SAe(i,e){return i*i*i*e}function sA(i,e,t,r,n){return xAe(i,e)+bAe(i,t)+wAe(i,r)+SAe(i,n)}var MAe=class extends Bp{constructor(i=new mi,e=new mi,t=new mi,r=new mi){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=i,this.v1=e,this.v2=t,this.v3=r}getPoint(i,e=new mi){let t=e,r=this.v0,n=this.v1,l=this.v2,c=this.v3;return t.set(sA(i,r.x,n.x,l.x,c.x),sA(i,r.y,n.y,l.y,c.y)),t}copy(i){return super.copy(i),this.v0.copy(i.v0),this.v1.copy(i.v1),this.v2.copy(i.v2),this.v3.copy(i.v3),this}toJSON(){let i=super.toJSON();return i.v0=this.v0.toArray(),i.v1=this.v1.toArray(),i.v2=this.v2.toArray(),i.v3=this.v3.toArray(),i}fromJSON(i){return super.fromJSON(i),this.v0.fromArray(i.v0),this.v1.fromArray(i.v1),this.v2.fromArray(i.v2),this.v3.fromArray(i.v3),this}},EAe=class extends Bp{constructor(i=new Se,e=new Se,t=new Se,r=new Se){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=i,this.v1=e,this.v2=t,this.v3=r}getPoint(i,e=new Se){let t=e,r=this.v0,n=this.v1,l=this.v2,c=this.v3;return t.set(sA(i,r.x,n.x,l.x,c.x),sA(i,r.y,n.y,l.y,c.y),sA(i,r.z,n.z,l.z,c.z)),t}copy(i){return super.copy(i),this.v0.copy(i.v0),this.v1.copy(i.v1),this.v2.copy(i.v2),this.v3.copy(i.v3),this}toJSON(){let i=super.toJSON();return i.v0=this.v0.toArray(),i.v1=this.v1.toArray(),i.v2=this.v2.toArray(),i.v3=this.v3.toArray(),i}fromJSON(i){return super.fromJSON(i),this.v0.fromArray(i.v0),this.v1.fromArray(i.v1),this.v2.fromArray(i.v2),this.v3.fromArray(i.v3),this}},TAe=class extends Bp{constructor(i=new mi,e=new mi){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=i,this.v2=e}getPoint(i,e=new mi){let t=e;return i===1?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(i).add(this.v1)),t}getPointAt(i,e){return this.getPoint(i,e)}getTangent(i,e=new mi){return e.subVectors(this.v2,this.v1).normalize()}getTangentAt(i,e){return this.getTangent(i,e)}copy(i){return super.copy(i),this.v1.copy(i.v1),this.v2.copy(i.v2),this}toJSON(){let i=super.toJSON();return i.v1=this.v1.toArray(),i.v2=this.v2.toArray(),i}fromJSON(i){return super.fromJSON(i),this.v1.fromArray(i.v1),this.v2.fromArray(i.v2),this}},bY=class extends Bp{constructor(i=new Se,e=new Se){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=i,this.v2=e}getPoint(i,e=new Se){let t=e;return i===1?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(i).add(this.v1)),t}getPointAt(i,e){return this.getPoint(i,e)}getTangent(i,e=new Se){return e.subVectors(this.v2,this.v1).normalize()}getTangentAt(i,e){return this.getTangent(i,e)}copy(i){return super.copy(i),this.v1.copy(i.v1),this.v2.copy(i.v2),this}toJSON(){let i=super.toJSON();return i.v1=this.v1.toArray(),i.v2=this.v2.toArray(),i}fromJSON(i){return super.fromJSON(i),this.v1.fromArray(i.v1),this.v2.fromArray(i.v2),this}},AAe=class extends Bp{constructor(i=new mi,e=new mi,t=new mi){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=i,this.v1=e,this.v2=t}getPoint(i,e=new mi){let t=e,r=this.v0,n=this.v1,l=this.v2;return t.set(nA(i,r.x,n.x,l.x),nA(i,r.y,n.y,l.y)),t}copy(i){return super.copy(i),this.v0.copy(i.v0),this.v1.copy(i.v1),this.v2.copy(i.v2),this}toJSON(){let i=super.toJSON();return i.v0=this.v0.toArray(),i.v1=this.v1.toArray(),i.v2=this.v2.toArray(),i}fromJSON(i){return super.fromJSON(i),this.v0.fromArray(i.v0),this.v1.fromArray(i.v1),this.v2.fromArray(i.v2),this}},wY=class extends Bp{constructor(i=new Se,e=new Se,t=new Se){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=i,this.v1=e,this.v2=t}getPoint(i,e=new Se){let t=e,r=this.v0,n=this.v1,l=this.v2;return t.set(nA(i,r.x,n.x,l.x),nA(i,r.y,n.y,l.y),nA(i,r.z,n.z,l.z)),t}copy(i){return super.copy(i),this.v0.copy(i.v0),this.v1.copy(i.v1),this.v2.copy(i.v2),this}toJSON(){let i=super.toJSON();return i.v0=this.v0.toArray(),i.v1=this.v1.toArray(),i.v2=this.v2.toArray(),i}fromJSON(i){return super.fromJSON(i),this.v0.fromArray(i.v0),this.v1.fromArray(i.v1),this.v2.fromArray(i.v2),this}},CAe=class extends Bp{constructor(i=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=i}getPoint(i,e=new mi){let t=e,r=this.points,n=(r.length-1)*i,l=Math.floor(n),c=n-l,h=r[l===0?l:l-1],d=r[l],f=r[l>r.length-2?r.length-1:l+1],m=r[l>r.length-3?r.length-1:l+2];return t.set(ij(c,h.x,d.x,f.x,m.x),ij(c,h.y,d.y,f.y,m.y)),t}copy(i){super.copy(i),this.points=[];for(let e=0,t=i.points.length;e<t;e++){let r=i.points[e];this.points.push(r.clone())}return this}toJSON(){let i=super.toJSON();i.points=[];for(let e=0,t=this.points.length;e<t;e++){let r=this.points[e];i.points.push(r.toArray())}return i}fromJSON(i){super.fromJSON(i),this.points=[];for(let e=0,t=i.points.length;e<t;e++){let r=i.points[e];this.points.push(new mi().fromArray(r))}return this}},PAe=Object.freeze({__proto__:null,ArcCurve:mAe,CatmullRomCurve3:gAe,CubicBezierCurve:MAe,CubicBezierCurve3:EAe,EllipseCurve:xY,LineCurve:TAe,LineCurve3:bY,QuadraticBezierCurve:AAe,QuadraticBezierCurve3:wY,SplineCurve:CAe}),SY=class extends Op{constructor(i=new wY(new Se(-1,-1,0),new Se(-1,1,0),new Se(1,1,0)),e=64,t=1,r=8,n=!1){super(),this.type="TubeGeometry",this.parameters={path:i,tubularSegments:e,radius:t,radialSegments:r,closed:n};let l=i.computeFrenetFrames(e,n);this.tangents=l.tangents,this.normals=l.normals,this.binormals=l.binormals;let c=new Se,h=new Se,d=new mi,f=new Se,m=[],g=[],y=[],_=[];b(),this.setIndex(_),this.setAttribute("position",new bM(m,3)),this.setAttribute("normal",new bM(g,3)),this.setAttribute("uv",new bM(y,2));function b(){for(let A=0;A<e;A++)S(A);S(n===!1?e:0),T(),E()}function S(A){f=i.getPointAt(A/e,f);let P=l.normals[A],O=l.binormals[A];for(let R=0;R<=r;R++){let D=R/r*Math.PI*2,L=Math.sin(D),N=-Math.cos(D);h.x=N*P.x+L*O.x,h.y=N*P.y+L*O.y,h.z=N*P.z+L*O.z,h.normalize(),g.push(h.x,h.y,h.z),c.x=f.x+t*h.x,c.y=f.y+t*h.y,c.z=f.z+t*h.z,m.push(c.x,c.y,c.z)}}function E(){for(let A=1;A<=e;A++)for(let P=1;P<=r;P++){let O=(r+1)*(A-1)+(P-1),R=(r+1)*A+(P-1),D=(r+1)*A+P,L=(r+1)*(A-1)+P;_.push(O,R,L),_.push(R,D,L)}}function T(){for(let A=0;A<=e;A++)for(let P=0;P<=r;P++)d.x=A/e,d.y=P/r,y.push(d.x,d.y)}}copy(i){return super.copy(i),this.parameters=Object.assign({},i.parameters),this}toJSON(){let i=super.toJSON();return i.path=this.parameters.path.toJSON(),i}static fromJSON(i){return new SY(new PAe[i.path.type]().fromJSON(i.path),i.tubularSegments,i.radius,i.radialSegments,i.closed)}},hU=class extends Wm{constructor(i){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Tr(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Tr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=zSe,this.normalScale=new mi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(i)}copy(i){return super.copy(i),this.defines={STANDARD:""},this.color.copy(i.color),this.roughness=i.roughness,this.metalness=i.metalness,this.map=i.map,this.lightMap=i.lightMap,this.lightMapIntensity=i.lightMapIntensity,this.aoMap=i.aoMap,this.aoMapIntensity=i.aoMapIntensity,this.emissive.copy(i.emissive),this.emissiveMap=i.emissiveMap,this.emissiveIntensity=i.emissiveIntensity,this.bumpMap=i.bumpMap,this.bumpScale=i.bumpScale,this.normalMap=i.normalMap,this.normalMapType=i.normalMapType,this.normalScale.copy(i.normalScale),this.displacementMap=i.displacementMap,this.displacementScale=i.displacementScale,this.displacementBias=i.displacementBias,this.roughnessMap=i.roughnessMap,this.metalnessMap=i.metalnessMap,this.alphaMap=i.alphaMap,this.envMap=i.envMap,this.envMapIntensity=i.envMapIntensity,this.wireframe=i.wireframe,this.wireframeLinewidth=i.wireframeLinewidth,this.wireframeLinecap=i.wireframeLinecap,this.wireframeLinejoin=i.wireframeLinejoin,this.flatShading=i.flatShading,this.fog=i.fog,this}},ag=class extends hU{constructor(i){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new mi(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return La(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Tr(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Tr(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Tr(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(i)}get anisotropy(){return this._anisotropy}set anisotropy(i){this._anisotropy>0!=i>0&&this.version++,this._anisotropy=i}get clearcoat(){return this._clearcoat}set clearcoat(i){this._clearcoat>0!=i>0&&this.version++,this._clearcoat=i}get iridescence(){return this._iridescence}set iridescence(i){this._iridescence>0!=i>0&&this.version++,this._iridescence=i}get sheen(){return this._sheen}set sheen(i){this._sheen>0!=i>0&&this.version++,this._sheen=i}get transmission(){return this._transmission}set transmission(i){this._transmission>0!=i>0&&this.version++,this._transmission=i}copy(i){return super.copy(i),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=i.anisotropy,this.anisotropyRotation=i.anisotropyRotation,this.anisotropyMap=i.anisotropyMap,this.clearcoat=i.clearcoat,this.clearcoatMap=i.clearcoatMap,this.clearcoatRoughness=i.clearcoatRoughness,this.clearcoatRoughnessMap=i.clearcoatRoughnessMap,this.clearcoatNormalMap=i.clearcoatNormalMap,this.clearcoatNormalScale.copy(i.clearcoatNormalScale),this.ior=i.ior,this.iridescence=i.iridescence,this.iridescenceMap=i.iridescenceMap,this.iridescenceIOR=i.iridescenceIOR,this.iridescenceThicknessRange=[...i.iridescenceThicknessRange],this.iridescenceThicknessMap=i.iridescenceThicknessMap,this.sheen=i.sheen,this.sheenColor.copy(i.sheenColor),this.sheenColorMap=i.sheenColorMap,this.sheenRoughness=i.sheenRoughness,this.sheenRoughnessMap=i.sheenRoughnessMap,this.transmission=i.transmission,this.transmissionMap=i.transmissionMap,this.thickness=i.thickness,this.thicknessMap=i.thicknessMap,this.attenuationDistance=i.attenuationDistance,this.attenuationColor.copy(i.attenuationColor),this.specularIntensity=i.specularIntensity,this.specularIntensityMap=i.specularIntensityMap,this.specularColor.copy(i.specularColor),this.specularColorMap=i.specularColorMap,this}};function yP(i,e,t){return!i||!t&&i.constructor===e?i:typeof e.BYTES_PER_ELEMENT=="number"?new e(i):Array.prototype.slice.call(i)}function RAe(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function IAe(i){function e(n,l){return i[n]-i[l]}let t=i.length,r=new Array(t);for(let n=0;n!==t;++n)r[n]=n;return r.sort(e),r}function rj(i,e,t){let r=i.length,n=new i.constructor(r);for(let l=0,c=0;c!==r;++l){let h=t[l]*e;for(let d=0;d!==e;++d)n[c++]=i[h+d]}return n}function MY(i,e,t,r){let n=1,l=i[0];for(;l!==void 0&&l[r]===void 0;)l=i[n++];if(l===void 0)return;let c=l[r];if(c!==void 0)if(Array.isArray(c))do c=l[r],c!==void 0&&(e.push(l.time),t.push.apply(t,c)),l=i[n++];while(l!==void 0);else if(c.toArray!==void 0)do c=l[r],c!==void 0&&(e.push(l.time),c.toArray(t,t.length)),l=i[n++];while(l!==void 0);else do c=l[r],c!==void 0&&(e.push(l.time),t.push(c)),l=i[n++];while(l!==void 0)}var zC=class{constructor(i,e,t,r){this.parameterPositions=i,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new e.constructor(t),this.sampleValues=e,this.valueSize=t,this.settings=null,this.DefaultSettings_={}}evaluate(i){let e=this.parameterPositions,t=this._cachedIndex,r=e[t],n=e[t-1];e:{t:{let l;i:{r:if(!(i<r)){for(let c=t+2;;){if(r===void 0){if(i<n)break r;return t=e.length,this._cachedIndex=t,this.copySampleValue_(t-1)}if(t===c)break;if(n=r,r=e[++t],i<r)break t}l=e.length;break i}if(!(i>=n)){let c=e[1];i<c&&(t=2,n=c);for(let h=t-2;;){if(n===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(t===h)break;if(r=n,n=e[--t-1],i>=n)break t}l=t,t=0;break i}break e}for(;t<l;){let c=t+l>>>1;i<e[c]?l=c:t=c+1}if(r=e[t],n=e[t-1],n===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return t=e.length,this._cachedIndex=t,this.copySampleValue_(t-1)}this._cachedIndex=t,this.intervalChanged_(t,n,r)}return this.interpolate_(t,n,i,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(i){let e=this.resultBuffer,t=this.sampleValues,r=this.valueSize,n=i*r;for(let l=0;l!==r;++l)e[l]=t[n+l];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},LAe=class extends zC{constructor(i,e,t,r){super(i,e,t,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:iM,endingEnd:iM}}intervalChanged_(i,e,t){let r=this.parameterPositions,n=i-2,l=i+1,c=r[n],h=r[l];if(c===void 0)switch(this.getSettings_().endingStart){case rM:n=i,c=2*e-t;break;case lI:n=r.length-2,c=e+r[n]-r[n+1];break;default:n=i,c=t}if(h===void 0)switch(this.getSettings_().endingEnd){case rM:l=i,h=2*t-e;break;case lI:l=1,h=t+r[1]-r[0];break;default:l=i-1,h=e}let d=(t-e)*.5,f=this.valueSize;this._weightPrev=d/(e-c),this._weightNext=d/(h-t),this._offsetPrev=n*f,this._offsetNext=l*f}interpolate_(i,e,t,r){let n=this.resultBuffer,l=this.sampleValues,c=this.valueSize,h=i*c,d=h-c,f=this._offsetPrev,m=this._offsetNext,g=this._weightPrev,y=this._weightNext,_=(t-e)/(r-e),b=_*_,S=b*_,E=-g*S+2*g*b-g*_,T=(1+g)*S+(-1.5-2*g)*b+(-.5+g)*_+1,A=(-1-y)*S+(1.5+y)*b+.5*_,P=y*S-y*b;for(let O=0;O!==c;++O)n[O]=E*l[f+O]+T*l[d+O]+A*l[h+O]+P*l[m+O];return n}},EY=class extends zC{constructor(i,e,t,r){super(i,e,t,r)}interpolate_(i,e,t,r){let n=this.resultBuffer,l=this.sampleValues,c=this.valueSize,h=i*c,d=h-c,f=(t-e)/(r-e),m=1-f;for(let g=0;g!==c;++g)n[g]=l[d+g]*m+l[h+g]*f;return n}},OAe=class extends zC{constructor(i,e,t,r){super(i,e,t,r)}interpolate_(i){return this.copySampleValue_(i-1)}},Rf=class{constructor(i,e,t,r){if(i===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(e===void 0||e.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+i);this.name=i,this.times=yP(e,this.TimeBufferType),this.values=yP(t,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(i){let e=i.constructor,t;if(e.toJSON!==this.toJSON)t=e.toJSON(i);else{t={name:i.name,times:yP(i.times,Array),values:yP(i.values,Array)};let r=i.getInterpolation();r!==i.DefaultInterpolation&&(t.interpolation=r)}return t.type=i.ValueTypeName,t}InterpolantFactoryMethodDiscrete(i){return new OAe(this.times,this.values,this.getValueSize(),i)}InterpolantFactoryMethodLinear(i){return new EY(this.times,this.values,this.getValueSize(),i)}InterpolantFactoryMethodSmooth(i){return new LAe(this.times,this.values,this.getValueSize(),i)}setInterpolation(i){let e;switch(i){case rC:e=this.InterpolantFactoryMethodDiscrete;break;case YM:e=this.InterpolantFactoryMethodLinear;break;case nD:e=this.InterpolantFactoryMethodSmooth;break}if(e===void 0){let t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(i!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(t);return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return rC;case this.InterpolantFactoryMethodLinear:return YM;case this.InterpolantFactoryMethodSmooth:return nD}}getValueSize(){return this.values.length/this.times.length}shift(i){if(i!==0){let e=this.times;for(let t=0,r=e.length;t!==r;++t)e[t]+=i}return this}scale(i){if(i!==1){let e=this.times;for(let t=0,r=e.length;t!==r;++t)e[t]*=i}return this}trim(i,e){let t=this.times,r=t.length,n=0,l=r-1;for(;n!==r&&t[n]<i;)++n;for(;l!==-1&&t[l]>e;)--l;if(++l,n!==0||l!==r){n>=l&&(l=Math.max(l,1),n=l-1);let c=this.getValueSize();this.times=t.slice(n,l),this.values=this.values.slice(n*c,l*c)}return this}validate(){let i=!0,e=this.getValueSize();e-Math.floor(e)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),i=!1);let t=this.times,r=this.values,n=t.length;n===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),i=!1);let l=null;for(let c=0;c!==n;c++){let h=t[c];if(typeof h=="number"&&isNaN(h)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,c,h),i=!1;break}if(l!==null&&l>h){console.error("THREE.KeyframeTrack: Out of order keys.",this,c,h,l),i=!1;break}l=h}if(r!==void 0&&RAe(r))for(let c=0,h=r.length;c!==h;++c){let d=r[c];if(isNaN(d)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,c,d),i=!1;break}}return i}optimize(){let i=this.times.slice(),e=this.values.slice(),t=this.getValueSize(),r=this.getInterpolation()===nD,n=i.length-1,l=1;for(let c=1;c<n;++c){let h=!1,d=i[c],f=i[c+1];if(d!==f&&(c!==1||d!==i[0]))if(r)h=!0;else{let m=c*t,g=m-t,y=m+t;for(let _=0;_!==t;++_){let b=e[m+_];if(b!==e[g+_]||b!==e[y+_]){h=!0;break}}}if(h){if(c!==l){i[l]=i[c];let m=c*t,g=l*t;for(let y=0;y!==t;++y)e[g+y]=e[m+y]}++l}}if(n>0){i[l]=i[n];for(let c=n*t,h=l*t,d=0;d!==t;++d)e[h+d]=e[c+d];++l}return l!==i.length?(this.times=i.slice(0,l),this.values=e.slice(0,l*t)):(this.times=i,this.values=e),this}clone(){let i=this.times.slice(),e=this.values.slice(),t=this.constructor,r=new t(this.name,i,e);return r.createInterpolant=this.createInterpolant,r}};Rf.prototype.TimeBufferType=Float32Array;Rf.prototype.ValueBufferType=Float32Array;Rf.prototype.DefaultInterpolation=YM;var CE=class extends Rf{};CE.prototype.ValueTypeName="bool";CE.prototype.ValueBufferType=Array;CE.prototype.DefaultInterpolation=rC;CE.prototype.InterpolantFactoryMethodLinear=void 0;CE.prototype.InterpolantFactoryMethodSmooth=void 0;var TY=class extends Rf{};TY.prototype.ValueTypeName="color";var KM=class extends Rf{};KM.prototype.ValueTypeName="number";var NAe=class extends zC{constructor(i,e,t,r){super(i,e,t,r)}interpolate_(i,e,t,r){let n=this.resultBuffer,l=this.sampleValues,c=this.valueSize,h=(t-e)/(r-e),d=i*c;for(let f=d+c;d!==f;d+=4)pu.slerpFlat(n,0,l,d-c,l,d,h);return n}},fw=class extends Rf{InterpolantFactoryMethodLinear(i){return new NAe(this.times,this.values,this.getValueSize(),i)}};fw.prototype.ValueTypeName="quaternion";fw.prototype.DefaultInterpolation=YM;fw.prototype.InterpolantFactoryMethodSmooth=void 0;var PE=class extends Rf{};PE.prototype.ValueTypeName="string";PE.prototype.ValueBufferType=Array;PE.prototype.DefaultInterpolation=rC;PE.prototype.InterpolantFactoryMethodLinear=void 0;PE.prototype.InterpolantFactoryMethodSmooth=void 0;var QM=class extends Rf{};QM.prototype.ValueTypeName="vector";var u4=class{constructor(i,e=-1,t,r=rU){this.name=i,this.tracks=t,this.duration=e,this.blendMode=r,this.uuid=Gd(),this.duration<0&&this.resetDuration()}static parse(i){let e=[],t=i.tracks,r=1/(i.fps||1);for(let l=0,c=t.length;l!==c;++l)e.push(kAe(t[l]).scale(r));let n=new this(i.name,i.duration,e,i.blendMode);return n.uuid=i.uuid,n}static toJSON(i){let e=[],t=i.tracks,r={name:i.name,duration:i.duration,tracks:e,uuid:i.uuid,blendMode:i.blendMode};for(let n=0,l=t.length;n!==l;++n)e.push(Rf.toJSON(t[n]));return r}static CreateFromMorphTargetSequence(i,e,t,r){let n=e.length,l=[];for(let c=0;c<n;c++){let h=[],d=[];h.push((c+n-1)%n,c,(c+1)%n),d.push(0,1,0);let f=IAe(h);h=rj(h,1,f),d=rj(d,1,f),!r&&h[0]===0&&(h.push(n),d.push(d[0])),l.push(new KM(".morphTargetInfluences["+e[c].name+"]",h,d).scale(1/t))}return new this(i,-1,l)}static findByName(i,e){let t=i;if(!Array.isArray(i)){let r=i;t=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<t.length;r++)if(t[r].name===e)return t[r];return null}static CreateClipsFromMorphTargetSequences(i,e,t){let r={},n=/^([\w-]*?)([\d]+)$/;for(let c=0,h=i.length;c<h;c++){let d=i[c],f=d.name.match(n);if(f&&f.length>1){let m=f[1],g=r[m];g||(r[m]=g=[]),g.push(d)}}let l=[];for(let c in r)l.push(this.CreateFromMorphTargetSequence(c,r[c],e,t));return l}static parseAnimation(i,e){if(!i)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let t=function(f,m,g,y,_){if(g.length!==0){let b=[],S=[];MY(g,b,S,y),b.length!==0&&_.push(new f(m,b,S))}},r=[],n=i.name||"default",l=i.fps||30,c=i.blendMode,h=i.length||-1,d=i.hierarchy||[];for(let f=0;f<d.length;f++){let m=d[f].keys;if(!(!m||m.length===0))if(m[0].morphTargets){let g={},y;for(y=0;y<m.length;y++)if(m[y].morphTargets)for(let _=0;_<m[y].morphTargets.length;_++)g[m[y].morphTargets[_]]=-1;for(let _ in g){let b=[],S=[];for(let E=0;E!==m[y].morphTargets.length;++E){let T=m[y];b.push(T.time),S.push(T.morphTarget===_?1:0)}r.push(new KM(".morphTargetInfluence["+_+"]",b,S))}h=g.length*l}else{let g=".bones["+e[f].name+"]";t(QM,g+".position",m,"pos",r),t(fw,g+".quaternion",m,"rot",r),t(QM,g+".scale",m,"scl",r)}}return r.length===0?null:new this(n,h,r,c)}resetDuration(){let i=this.tracks,e=0;for(let t=0,r=i.length;t!==r;++t){let n=this.tracks[t];e=Math.max(e,n.times[n.times.length-1])}return this.duration=e,this}trim(){for(let i=0;i<this.tracks.length;i++)this.tracks[i].trim(0,this.duration);return this}validate(){let i=!0;for(let e=0;e<this.tracks.length;e++)i=i&&this.tracks[e].validate();return i}optimize(){for(let i=0;i<this.tracks.length;i++)this.tracks[i].optimize();return this}clone(){let i=[];for(let e=0;e<this.tracks.length;e++)i.push(this.tracks[e].clone());return new this.constructor(this.name,this.duration,i,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function DAe(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return KM;case"vector":case"vector2":case"vector3":case"vector4":return QM;case"color":return TY;case"quaternion":return fw;case"bool":case"boolean":return CE;case"string":return PE}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}function kAe(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let e=DAe(i.type);if(i.times===void 0){let t=[],r=[];MY(i.keys,t,r,"value"),i.times=t,i.values=r}return e.parse!==void 0?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}var eE={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(this.files[i]=e)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}},FAe=class{constructor(i,e,t){let r=this,n=!1,l=0,c=0,h,d=[];this.onStart=void 0,this.onLoad=i,this.onProgress=e,this.onError=t,this.itemStart=function(f){c++,n===!1&&r.onStart!==void 0&&r.onStart(f,l,c),n=!0},this.itemEnd=function(f){l++,r.onProgress!==void 0&&r.onProgress(f,l,c),l===c&&(n=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(f){r.onError!==void 0&&r.onError(f)},this.resolveURL=function(f){return h?h(f):f},this.setURLModifier=function(f){return h=f,this},this.addHandler=function(f,m){return d.push(f,m),this},this.removeHandler=function(f){let m=d.indexOf(f);return m!==-1&&d.splice(m,2),this},this.getHandler=function(f){for(let m=0,g=d.length;m<g;m+=2){let y=d[m],_=d[m+1];if(y.global&&(y.lastIndex=0),y.test(f))return _}return null}}},zAe=new FAe,RE=class{constructor(i){this.manager=i!==void 0?i:zAe,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(i,e){let t=this;return new Promise(function(r,n){t.load(i,r,e,n)})}parse(){}setCrossOrigin(i){return this.crossOrigin=i,this}setWithCredentials(i){return this.withCredentials=i,this}setPath(i){return this.path=i,this}setResourcePath(i){return this.resourcePath=i,this}setRequestHeader(i){return this.requestHeader=i,this}};RE.DEFAULT_MATERIAL_NAME="__DEFAULT";var rp={},BAe=class extends Error{constructor(i,e){super(i),this.response=e}},AY=class extends RE{constructor(i){super(i)}load(i,e,t,r){i===void 0&&(i=""),this.path!==void 0&&(i=this.path+i),i=this.manager.resolveURL(i);let n=eE.get(i);if(n!==void 0)return this.manager.itemStart(i),setTimeout(()=>{e&&e(n),this.manager.itemEnd(i)},0),n;if(rp[i]!==void 0){rp[i].push({onLoad:e,onProgress:t,onError:r});return}rp[i]=[],rp[i].push({onLoad:e,onProgress:t,onError:r});let l=new Request(i,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),c=this.mimeType,h=this.responseType;fetch(l).then(d=>{if(d.status===200||d.status===0){if(d.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||d.body===void 0||d.body.getReader===void 0)return d;let f=rp[i],m=d.body.getReader(),g=d.headers.get("Content-Length")||d.headers.get("X-File-Size"),y=g?parseInt(g):0,_=y!==0,b=0,S=new ReadableStream({start(E){T();function T(){m.read().then(({done:A,value:P})=>{if(A)E.close();else{b+=P.byteLength;let O=new ProgressEvent("progress",{lengthComputable:_,loaded:b,total:y});for(let R=0,D=f.length;R<D;R++){let L=f[R];L.onProgress&&L.onProgress(O)}E.enqueue(P),T()}})}}});return new Response(S)}else throw new BAe(`fetch for "${d.url}" responded with ${d.status}: ${d.statusText}`,d)}).then(d=>{switch(h){case"arraybuffer":return d.arrayBuffer();case"blob":return d.blob();case"document":return d.text().then(f=>new DOMParser().parseFromString(f,c));case"json":return d.json();default:if(c===void 0)return d.text();{let f=/charset="?([^;"\s]*)"?/i.exec(c),m=f&&f[1]?f[1].toLowerCase():void 0,g=new TextDecoder(m);return d.arrayBuffer().then(y=>g.decode(y))}}}).then(d=>{eE.add(i,d);let f=rp[i];delete rp[i];for(let m=0,g=f.length;m<g;m++){let y=f[m];y.onLoad&&y.onLoad(d)}}).catch(d=>{let f=rp[i];if(f===void 0)throw this.manager.itemError(i),d;delete rp[i];for(let m=0,g=f.length;m<g;m++){let y=f[m];y.onError&&y.onError(d)}this.manager.itemError(i)}).finally(()=>{this.manager.itemEnd(i)}),this.manager.itemStart(i)}setResponseType(i){return this.responseType=i,this}setMimeType(i){return this.mimeType=i,this}},UAe=class extends RE{constructor(i){super(i)}load(i,e,t,r){this.path!==void 0&&(i=this.path+i),i=this.manager.resolveURL(i);let n=this,l=eE.get(i);if(l!==void 0)return n.manager.itemStart(i),setTimeout(function(){e&&e(l),n.manager.itemEnd(i)},0),l;let c=o4("img");function h(){f(),eE.add(i,this),e&&e(this),n.manager.itemEnd(i)}function d(m){f(),r&&r(m),n.manager.itemError(i),n.manager.itemEnd(i)}function f(){c.removeEventListener("load",h,!1),c.removeEventListener("error",d,!1)}return c.addEventListener("load",h,!1),c.addEventListener("error",d,!1),i.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(c.crossOrigin=this.crossOrigin),n.manager.itemStart(i),c.src=i,c}},CY=class extends RE{constructor(i){super(i)}load(i,e,t,r){let n=new Eo,l=new UAe(this.manager);return l.setCrossOrigin(this.crossOrigin),l.setPath(this.path),l.load(i,function(c){n.image=c,n.needsUpdate=!0,e!==void 0&&e(n)},t,r),n}},dU=class extends Wn{constructor(i,e=1){super(),this.isLight=!0,this.type="Light",this.color=new Tr(i),this.intensity=e}dispose(){}copy(i,e){return super.copy(i,e),this.color.copy(i.color),this.intensity=i.intensity,this}toJSON(i){let e=super.toJSON(i);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,this.groundColor!==void 0&&(e.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(e.object.distance=this.distance),this.angle!==void 0&&(e.object.angle=this.angle),this.decay!==void 0&&(e.object.decay=this.decay),this.penumbra!==void 0&&(e.object.penumbra=this.penumbra),this.shadow!==void 0&&(e.object.shadow=this.shadow.toJSON()),e}},OD=new ar,nj=new Se,sj=new Se,fU=class{constructor(i){this.camera=i,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new mi(512,512),this.map=null,this.mapPass=null,this.matrix=new ar,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new CMe,this._frameExtents=new mi(1,1),this._viewportCount=1,this._viewports=[new Fd(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(i){let e=this.camera,t=this.matrix;nj.setFromMatrixPosition(i.matrixWorld),e.position.copy(nj),sj.setFromMatrixPosition(i.target.matrixWorld),e.lookAt(sj),e.updateMatrixWorld(),OD.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(OD),t.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),t.multiply(OD)}getViewport(i){return this._viewports[i]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(i){return this.camera=i.camera.clone(),this.bias=i.bias,this.radius=i.radius,this.mapSize.copy(i.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let i={};return this.bias!==0&&(i.bias=this.bias),this.normalBias!==0&&(i.normalBias=this.normalBias),this.radius!==1&&(i.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(i.mapSize=this.mapSize.toArray()),i.camera=this.camera.toJSON(!1).object,delete i.camera.matrix,i}},HAe=class extends fU{constructor(){super(new aU(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(i){let e=this.camera,t=nC*2*i.angle*this.focus,r=this.mapSize.width/this.mapSize.height,n=i.distance||e.far;(t!==e.fov||r!==e.aspect||n!==e.far)&&(e.fov=t,e.aspect=r,e.far=n,e.updateProjectionMatrix()),super.updateMatrices(i)}copy(i){return super.copy(i),this.focus=i.focus,this}},$Ae=class extends dU{constructor(i,e,t=0,r=Math.PI/3,n=0,l=2){super(i,e),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Wn.DEFAULT_UP),this.updateMatrix(),this.target=new Wn,this.distance=t,this.angle=r,this.penumbra=n,this.decay=l,this.map=null,this.shadow=new HAe}get power(){return this.intensity*Math.PI}set power(i){this.intensity=i/Math.PI}dispose(){this.shadow.dispose()}copy(i,e){return super.copy(i,e),this.distance=i.distance,this.angle=i.angle,this.penumbra=i.penumbra,this.decay=i.decay,this.target=i.target.clone(),this.shadow=i.shadow.clone(),this}},aj=new ar,bT=new Se,ND=new Se,VAe=class extends fU{constructor(){super(new aU(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new mi(4,2),this._viewportCount=6,this._viewports=[new Fd(2,1,1,1),new Fd(0,1,1,1),new Fd(3,1,1,1),new Fd(1,1,1,1),new Fd(3,0,1,1),new Fd(1,0,1,1)],this._cubeDirections=[new Se(1,0,0),new Se(-1,0,0),new Se(0,0,1),new Se(0,0,-1),new Se(0,1,0),new Se(0,-1,0)],this._cubeUps=[new Se(0,1,0),new Se(0,1,0),new Se(0,1,0),new Se(0,1,0),new Se(0,0,1),new Se(0,0,-1)]}updateMatrices(i,e=0){let t=this.camera,r=this.matrix,n=i.distance||t.far;n!==t.far&&(t.far=n,t.updateProjectionMatrix()),bT.setFromMatrixPosition(i.matrixWorld),t.position.copy(bT),ND.copy(t.position),ND.add(this._cubeDirections[e]),t.up.copy(this._cubeUps[e]),t.lookAt(ND),t.updateMatrixWorld(),r.makeTranslation(-bT.x,-bT.y,-bT.z),aj.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(aj)}},WAe=class extends dU{constructor(i,e,t=0,r=2){super(i,e),this.isPointLight=!0,this.type="PointLight",this.distance=t,this.decay=r,this.shadow=new VAe}get power(){return this.intensity*4*Math.PI}set power(i){this.intensity=i/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(i,e){return super.copy(i,e),this.distance=i.distance,this.decay=i.decay,this.shadow=i.shadow.clone(),this}},jAe=class extends fU{constructor(){super(new oU(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},GAe=class extends dU{constructor(i,e){super(i,e),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Wn.DEFAULT_UP),this.updateMatrix(),this.target=new Wn,this.shadow=new jAe}dispose(){this.shadow.dispose()}copy(i){return super.copy(i),this.target=i.target.clone(),this.shadow=i.shadow.clone(),this}},c4=class{static decodeText(i){if(typeof TextDecoder<"u")return new TextDecoder().decode(i);let e="";for(let t=0,r=i.length;t<r;t++)e+=String.fromCharCode(i[t]);try{return decodeURIComponent(escape(e))}catch{return e}}static extractUrlBase(i){let e=i.lastIndexOf("/");return e===-1?"./":i.slice(0,e+1)}static resolveURL(i,e){return typeof i!="string"||i===""?"":(/^https?:\/\//i.test(e)&&/^\//.test(i)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(i)||/^data:.*,.*$/i.test(i)||/^blob:.*$/i.test(i)?i:e+i)}},qAe=class extends RE{constructor(i){super(i),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(i){return this.options=i,this}load(i,e,t,r){i===void 0&&(i=""),this.path!==void 0&&(i=this.path+i),i=this.manager.resolveURL(i);let n=this,l=eE.get(i);if(l!==void 0)return n.manager.itemStart(i),setTimeout(function(){e&&e(l),n.manager.itemEnd(i)},0),l;let c={};c.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",c.headers=this.requestHeader,fetch(i,c).then(function(h){return h.blob()}).then(function(h){return createImageBitmap(h,Object.assign(n.options,{colorSpaceConversion:"none"}))}).then(function(h){eE.add(i,h),e&&e(h),n.manager.itemEnd(i)}).catch(function(h){r&&r(h),n.manager.itemError(i),n.manager.itemEnd(i)}),n.manager.itemStart(i)}},pU=class{constructor(i=!0){this.autoStart=i,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=oj(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let i=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let e=oj();i=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=i}return i}};function oj(){return(typeof performance>"u"?Date:performance).now()}var XAe=class{constructor(i,e,t){this.binding=i,this.valueSize=t;let r,n,l;switch(e){case"quaternion":r=this._slerp,n=this._slerpAdditive,l=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(t*6),this._workIndex=5;break;case"string":case"bool":r=this._select,n=this._select,l=this._setAdditiveIdentityOther,this.buffer=new Array(t*5);break;default:r=this._lerp,n=this._lerpAdditive,l=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(t*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=n,this._setIdentity=l,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(i,e){let t=this.buffer,r=this.valueSize,n=i*r+r,l=this.cumulativeWeight;if(l===0){for(let c=0;c!==r;++c)t[n+c]=t[c];l=e}else{l+=e;let c=e/l;this._mixBufferRegion(t,n,0,c,r)}this.cumulativeWeight=l}accumulateAdditive(i){let e=this.buffer,t=this.valueSize,r=t*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(e,r,0,i,t),this.cumulativeWeightAdditive+=i}apply(i){let e=this.valueSize,t=this.buffer,r=i*e+e,n=this.cumulativeWeight,l=this.cumulativeWeightAdditive,c=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,n<1){let h=e*this._origIndex;this._mixBufferRegion(t,r,h,1-n,e)}l>0&&this._mixBufferRegionAdditive(t,r,this._addIndex*e,1,e);for(let h=e,d=e+e;h!==d;++h)if(t[h]!==t[h+e]){c.setValue(t,r);break}}saveOriginalState(){let i=this.binding,e=this.buffer,t=this.valueSize,r=t*this._origIndex;i.getValue(e,r);for(let n=t,l=r;n!==l;++n)e[n]=e[r+n%t];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let i=this.valueSize*3;this.binding.setValue(this.buffer,i)}_setAdditiveIdentityNumeric(){let i=this._addIndex*this.valueSize,e=i+this.valueSize;for(let t=i;t<e;t++)this.buffer[t]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let i=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let t=0;t<this.valueSize;t++)this.buffer[e+t]=this.buffer[i+t]}_select(i,e,t,r,n){if(r>=.5)for(let l=0;l!==n;++l)i[e+l]=i[t+l]}_slerp(i,e,t,r){pu.slerpFlat(i,e,i,e,i,t,r)}_slerpAdditive(i,e,t,r,n){let l=this._workIndex*n;pu.multiplyQuaternionsFlat(i,l,i,e,i,t),pu.slerpFlat(i,e,i,e,i,l,r)}_lerp(i,e,t,r,n){let l=1-r;for(let c=0;c!==n;++c){let h=e+c;i[h]=i[h]*l+i[t+c]*r}}_lerpAdditive(i,e,t,r,n){for(let l=0;l!==n;++l){let c=e+l;i[c]=i[c]+i[t+l]*r}}},mU="\\[\\]\\.:\\/",ZAe=new RegExp("["+mU+"]","g"),gU="[^"+mU+"]",JAe="[^"+mU.replace("\\.","")+"]",YAe=/((?:WC+[\/:])*)/.source.replace("WC",gU),KAe=/(WCOD+)?/.source.replace("WCOD",JAe),QAe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",gU),eCe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",gU),tCe=new RegExp("^"+YAe+KAe+QAe+eCe+"$"),iCe=["material","materials","bones","map"],rCe=class{constructor(i,e,t){let r=t||mn.parseTrackName(e);this._targetGroup=i,this._bindings=i.subscribe_(e,r)}getValue(i,e){this.bind();let t=this._targetGroup.nCachedObjects_,r=this._bindings[t];r!==void 0&&r.getValue(i,e)}setValue(i,e){let t=this._bindings;for(let r=this._targetGroup.nCachedObjects_,n=t.length;r!==n;++r)t[r].setValue(i,e)}bind(){let i=this._bindings;for(let e=this._targetGroup.nCachedObjects_,t=i.length;e!==t;++e)i[e].bind()}unbind(){let i=this._bindings;for(let e=this._targetGroup.nCachedObjects_,t=i.length;e!==t;++e)i[e].unbind()}},mn=class{constructor(i,e,t){this.path=e,this.parsedPath=t||mn.parseTrackName(e),this.node=mn.findNode(i,this.parsedPath.nodeName),this.rootNode=i,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(i,e,t){return i&&i.isAnimationObjectGroup?new mn.Composite(i,e,t):new mn(i,e,t)}static sanitizeNodeName(i){return i.replace(/\s/g,"_").replace(ZAe,"")}static parseTrackName(i){let e=tCe.exec(i);if(e===null)throw new Error("PropertyBinding: Cannot parse trackName: "+i);let t={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=t.nodeName&&t.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){let n=t.nodeName.substring(r+1);iCe.indexOf(n)!==-1&&(t.nodeName=t.nodeName.substring(0,r),t.objectName=n)}if(t.propertyName===null||t.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+i);return t}static findNode(i,e){if(e===void 0||e===""||e==="."||e===-1||e===i.name||e===i.uuid)return i;if(i.skeleton){let t=i.skeleton.getBoneByName(e);if(t!==void 0)return t}if(i.children){let t=function(n){for(let l=0;l<n.length;l++){let c=n[l];if(c.name===e||c.uuid===e)return c;let h=t(c.children);if(h)return h}return null},r=t(i.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(i,e){i[e]=this.targetObject[this.propertyName]}_getValue_array(i,e){let t=this.resolvedProperty;for(let r=0,n=t.length;r!==n;++r)i[e++]=t[r]}_getValue_arrayElement(i,e){i[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(i,e){this.resolvedProperty.toArray(i,e)}_setValue_direct(i,e){this.targetObject[this.propertyName]=i[e]}_setValue_direct_setNeedsUpdate(i,e){this.targetObject[this.propertyName]=i[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(i,e){this.targetObject[this.propertyName]=i[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(i,e){let t=this.resolvedProperty;for(let r=0,n=t.length;r!==n;++r)t[r]=i[e++]}_setValue_array_setNeedsUpdate(i,e){let t=this.resolvedProperty;for(let r=0,n=t.length;r!==n;++r)t[r]=i[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(i,e){let t=this.resolvedProperty;for(let r=0,n=t.length;r!==n;++r)t[r]=i[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(i,e){this.resolvedProperty[this.propertyIndex]=i[e]}_setValue_arrayElement_setNeedsUpdate(i,e){this.resolvedProperty[this.propertyIndex]=i[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(i,e){this.resolvedProperty[this.propertyIndex]=i[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(i,e){this.resolvedProperty.fromArray(i,e)}_setValue_fromArray_setNeedsUpdate(i,e){this.resolvedProperty.fromArray(i,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(i,e){this.resolvedProperty.fromArray(i,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(i,e){this.bind(),this.getValue(i,e)}_setValue_unbound(i,e){this.bind(),this.setValue(i,e)}bind(){let i=this.node,e=this.parsedPath,t=e.objectName,r=e.propertyName,n=e.propertyIndex;if(i||(i=mn.findNode(this.rootNode,e.nodeName),this.node=i),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!i){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(t){let d=e.objectIndex;switch(t){case"materials":if(!i.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!i.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}i=i.material.materials;break;case"bones":if(!i.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}i=i.skeleton.bones;for(let f=0;f<i.length;f++)if(i[f].name===d){d=f;break}break;case"map":if("map"in i){i=i.map;break}if(!i.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!i.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}i=i.material.map;break;default:if(i[t]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}i=i[t]}if(d!==void 0){if(i[d]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,i);return}i=i[d]}}let l=i[r];if(l===void 0){let d=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+d+"."+r+" but it wasn't found.",i);return}let c=this.Versioning.None;this.targetObject=i,i.needsUpdate!==void 0?c=this.Versioning.NeedsUpdate:i.matrixWorldNeedsUpdate!==void 0&&(c=this.Versioning.MatrixWorldNeedsUpdate);let h=this.BindingType.Direct;if(n!==void 0){if(r==="morphTargetInfluences"){if(!i.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!i.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}i.morphTargetDictionary[n]!==void 0&&(n=i.morphTargetDictionary[n])}h=this.BindingType.ArrayElement,this.resolvedProperty=l,this.propertyIndex=n}else l.fromArray!==void 0&&l.toArray!==void 0?(h=this.BindingType.HasFromToArray,this.resolvedProperty=l):Array.isArray(l)?(h=this.BindingType.EntireArray,this.resolvedProperty=l):this.propertyName=r;this.getValue=this.GetterByBindingType[h],this.setValue=this.SetterByBindingTypeAndVersioning[h][c]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};mn.Composite=rCe;mn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};mn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};mn.prototype.GetterByBindingType=[mn.prototype._getValue_direct,mn.prototype._getValue_array,mn.prototype._getValue_arrayElement,mn.prototype._getValue_toArray];mn.prototype.SetterByBindingTypeAndVersioning=[[mn.prototype._setValue_direct,mn.prototype._setValue_direct_setNeedsUpdate,mn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[mn.prototype._setValue_array,mn.prototype._setValue_array_setNeedsUpdate,mn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[mn.prototype._setValue_arrayElement,mn.prototype._setValue_arrayElement_setNeedsUpdate,mn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[mn.prototype._setValue_fromArray,mn.prototype._setValue_fromArray_setNeedsUpdate,mn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var nCe=class{constructor(i,e,t=null,r=e.blendMode){this._mixer=i,this._clip=e,this._localRoot=t,this.blendMode=r;let n=e.tracks,l=n.length,c=new Array(l),h={endingStart:iM,endingEnd:iM};for(let d=0;d!==l;++d){let f=n[d].createInterpolant(null);c[d]=f,f.settings=h}this._interpolantSettings=h,this._interpolants=c,this._propertyBindings=new Array(l),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=OSe,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(i){return this._startTime=i,this}setLoop(i,e){return this.loop=i,this.repetitions=e,this}setEffectiveWeight(i){return this.weight=i,this._effectiveWeight=this.enabled?i:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(i){return this._scheduleFading(i,0,1)}fadeOut(i){return this._scheduleFading(i,1,0)}crossFadeFrom(i,e,t){if(i.fadeOut(e),this.fadeIn(e),t){let r=this._clip.duration,n=i._clip.duration,l=n/r,c=r/n;i.warp(1,l,e),this.warp(c,1,e)}return this}crossFadeTo(i,e,t){return i.crossFadeFrom(this,e,t)}stopFading(){let i=this._weightInterpolant;return i!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(i)),this}setEffectiveTimeScale(i){return this.timeScale=i,this._effectiveTimeScale=this.paused?0:i,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(i){return this.timeScale=this._clip.duration/i,this.stopWarping()}syncWith(i){return this.time=i.time,this.timeScale=i.timeScale,this.stopWarping()}halt(i){return this.warp(this._effectiveTimeScale,0,i)}warp(i,e,t){let r=this._mixer,n=r.time,l=this.timeScale,c=this._timeScaleInterpolant;c===null&&(c=r._lendControlInterpolant(),this._timeScaleInterpolant=c);let h=c.parameterPositions,d=c.sampleValues;return h[0]=n,h[1]=n+t,d[0]=i/l,d[1]=e/l,this}stopWarping(){let i=this._timeScaleInterpolant;return i!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(i)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(i,e,t,r){if(!this.enabled){this._updateWeight(i);return}let n=this._startTime;if(n!==null){let h=(i-n)*t;h<0||t===0?e=0:(this._startTime=null,e=t*h)}e*=this._updateTimeScale(i);let l=this._updateTime(e),c=this._updateWeight(i);if(c>0){let h=this._interpolants,d=this._propertyBindings;switch(this.blendMode){case DSe:for(let f=0,m=h.length;f!==m;++f)h[f].evaluate(l),d[f].accumulateAdditive(c);break;case rU:default:for(let f=0,m=h.length;f!==m;++f)h[f].evaluate(l),d[f].accumulate(r,c)}}}_updateWeight(i){let e=0;if(this.enabled){e=this.weight;let t=this._weightInterpolant;if(t!==null){let r=t.evaluate(i)[0];e*=r,i>t.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(i){let e=0;if(!this.paused){e=this.timeScale;let t=this._timeScaleInterpolant;t!==null&&(e*=t.evaluate(i)[0],i>t.parameterPositions[1]&&(this.stopWarping(),e===0?this.paused=!0:this.timeScale=e))}return this._effectiveTimeScale=e,e}_updateTime(i){let e=this._clip.duration,t=this.loop,r=this.time+i,n=this._loopCount,l=t===NSe;if(i===0)return n===-1?r:l&&(n&1)===1?e-r:r;if(t===LSe){n===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=e)r=e;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:i<0?-1:1})}}else{if(n===-1&&(i>=0?(n=0,this._setEndings(!0,this.repetitions===0,l)):this._setEndings(this.repetitions===0,!0,l)),r>=e||r<0){let c=Math.floor(r/e);r-=e*c,n+=Math.abs(c);let h=this.repetitions-n;if(h<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=i>0?e:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:i>0?1:-1});else{if(h===1){let d=i<0;this._setEndings(d,!d,l)}else this._setEndings(!1,!1,l);this._loopCount=n,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:c})}}else this.time=r;if(l&&(n&1)===1)return e-r}return r}_setEndings(i,e,t){let r=this._interpolantSettings;t?(r.endingStart=rM,r.endingEnd=rM):(i?r.endingStart=this.zeroSlopeAtStart?rM:iM:r.endingStart=lI,e?r.endingEnd=this.zeroSlopeAtEnd?rM:iM:r.endingEnd=lI)}_scheduleFading(i,e,t){let r=this._mixer,n=r.time,l=this._weightInterpolant;l===null&&(l=r._lendControlInterpolant(),this._weightInterpolant=l);let c=l.parameterPositions,h=l.sampleValues;return c[0]=n,h[0]=e,c[1]=n+i,h[1]=t,this}},sCe=new Float32Array(1),aCe=class extends FC{constructor(i){super(),this._root=i,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(i,e){let t=i._localRoot||this._root,r=i._clip.tracks,n=r.length,l=i._propertyBindings,c=i._interpolants,h=t.uuid,d=this._bindingsByRootAndName,f=d[h];f===void 0&&(f={},d[h]=f);for(let m=0;m!==n;++m){let g=r[m],y=g.name,_=f[y];if(_!==void 0)++_.referenceCount,l[m]=_;else{if(_=l[m],_!==void 0){_._cacheIndex===null&&(++_.referenceCount,this._addInactiveBinding(_,h,y));continue}let b=e&&e._propertyBindings[m].binding.parsedPath;_=new XAe(mn.create(t,y,b),g.ValueTypeName,g.getValueSize()),++_.referenceCount,this._addInactiveBinding(_,h,y),l[m]=_}c[m].resultBuffer=_.buffer}}_activateAction(i){if(!this._isActiveAction(i)){if(i._cacheIndex===null){let t=(i._localRoot||this._root).uuid,r=i._clip.uuid,n=this._actionsByClip[r];this._bindAction(i,n&&n.knownActions[0]),this._addInactiveAction(i,r,t)}let e=i._propertyBindings;for(let t=0,r=e.length;t!==r;++t){let n=e[t];n.useCount++===0&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(i)}}_deactivateAction(i){if(this._isActiveAction(i)){let e=i._propertyBindings;for(let t=0,r=e.length;t!==r;++t){let n=e[t];--n.useCount===0&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(i)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let i=this;this.stats={actions:{get total(){return i._actions.length},get inUse(){return i._nActiveActions}},bindings:{get total(){return i._bindings.length},get inUse(){return i._nActiveBindings}},controlInterpolants:{get total(){return i._controlInterpolants.length},get inUse(){return i._nActiveControlInterpolants}}}}_isActiveAction(i){let e=i._cacheIndex;return e!==null&&e<this._nActiveActions}_addInactiveAction(i,e,t){let r=this._actions,n=this._actionsByClip,l=n[e];if(l===void 0)l={knownActions:[i],actionByRoot:{}},i._byClipCacheIndex=0,n[e]=l;else{let c=l.knownActions;i._byClipCacheIndex=c.length,c.push(i)}i._cacheIndex=r.length,r.push(i),l.actionByRoot[t]=i}_removeInactiveAction(i){let e=this._actions,t=e[e.length-1],r=i._cacheIndex;t._cacheIndex=r,e[r]=t,e.pop(),i._cacheIndex=null;let n=i._clip.uuid,l=this._actionsByClip,c=l[n],h=c.knownActions,d=h[h.length-1],f=i._byClipCacheIndex;d._byClipCacheIndex=f,h[f]=d,h.pop(),i._byClipCacheIndex=null;let m=c.actionByRoot,g=(i._localRoot||this._root).uuid;delete m[g],h.length===0&&delete l[n],this._removeInactiveBindingsForAction(i)}_removeInactiveBindingsForAction(i){let e=i._propertyBindings;for(let t=0,r=e.length;t!==r;++t){let n=e[t];--n.referenceCount===0&&this._removeInactiveBinding(n)}}_lendAction(i){let e=this._actions,t=i._cacheIndex,r=this._nActiveActions++,n=e[r];i._cacheIndex=r,e[r]=i,n._cacheIndex=t,e[t]=n}_takeBackAction(i){let e=this._actions,t=i._cacheIndex,r=--this._nActiveActions,n=e[r];i._cacheIndex=r,e[r]=i,n._cacheIndex=t,e[t]=n}_addInactiveBinding(i,e,t){let r=this._bindingsByRootAndName,n=this._bindings,l=r[e];l===void 0&&(l={},r[e]=l),l[t]=i,i._cacheIndex=n.length,n.push(i)}_removeInactiveBinding(i){let e=this._bindings,t=i.binding,r=t.rootNode.uuid,n=t.path,l=this._bindingsByRootAndName,c=l[r],h=e[e.length-1],d=i._cacheIndex;h._cacheIndex=d,e[d]=h,e.pop(),delete c[n],Object.keys(c).length===0&&delete l[r]}_lendBinding(i){let e=this._bindings,t=i._cacheIndex,r=this._nActiveBindings++,n=e[r];i._cacheIndex=r,e[r]=i,n._cacheIndex=t,e[t]=n}_takeBackBinding(i){let e=this._bindings,t=i._cacheIndex,r=--this._nActiveBindings,n=e[r];i._cacheIndex=r,e[r]=i,n._cacheIndex=t,e[t]=n}_lendControlInterpolant(){let i=this._controlInterpolants,e=this._nActiveControlInterpolants++,t=i[e];return t===void 0&&(t=new EY(new Float32Array(2),new Float32Array(2),1,sCe),t.__cacheIndex=e,i[e]=t),t}_takeBackControlInterpolant(i){let e=this._controlInterpolants,t=i.__cacheIndex,r=--this._nActiveControlInterpolants,n=e[r];i.__cacheIndex=r,e[r]=i,n.__cacheIndex=t,e[t]=n}clipAction(i,e,t){let r=e||this._root,n=r.uuid,l=typeof i=="string"?u4.findByName(r,i):i,c=l!==null?l.uuid:i,h=this._actionsByClip[c],d=null;if(t===void 0&&(l!==null?t=l.blendMode:t=rU),h!==void 0){let m=h.actionByRoot[n];if(m!==void 0&&m.blendMode===t)return m;d=h.knownActions[0],l===null&&(l=d._clip)}if(l===null)return null;let f=new nCe(this,l,e,t);return this._bindAction(f,d),this._addInactiveAction(f,c,n),f}existingAction(i,e){let t=e||this._root,r=t.uuid,n=typeof i=="string"?u4.findByName(t,i):i,l=n?n.uuid:i,c=this._actionsByClip[l];return c!==void 0&&c.actionByRoot[r]||null}stopAllAction(){let i=this._actions,e=this._nActiveActions;for(let t=e-1;t>=0;--t)i[t].stop();return this}update(i){i*=this.timeScale;let e=this._actions,t=this._nActiveActions,r=this.time+=i,n=Math.sign(i),l=this._accuIndex^=1;for(let d=0;d!==t;++d)e[d]._update(r,i,n,l);let c=this._bindings,h=this._nActiveBindings;for(let d=0;d!==h;++d)c[d].apply(l);return this}setTime(i){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(i)}getRoot(){return this._root}uncacheClip(i){let e=this._actions,t=i.uuid,r=this._actionsByClip,n=r[t];if(n!==void 0){let l=n.knownActions;for(let c=0,h=l.length;c!==h;++c){let d=l[c];this._deactivateAction(d);let f=d._cacheIndex,m=e[e.length-1];d._cacheIndex=null,d._byClipCacheIndex=null,m._cacheIndex=f,e[f]=m,e.pop(),this._removeInactiveBindingsForAction(d)}delete r[t]}}uncacheRoot(i){let e=i.uuid,t=this._actionsByClip;for(let l in t){let c=t[l].actionByRoot,h=c[e];h!==void 0&&(this._deactivateAction(h),this._removeInactiveAction(h))}let r=this._bindingsByRootAndName,n=r[e];if(n!==void 0)for(let l in n){let c=n[l];c.restoreOriginalState(),this._removeInactiveBinding(c)}}uncacheAction(i,e){let t=this.existingAction(i,e);t!==null&&(this._deactivateAction(t),this._removeInactiveAction(t))}},cI=class{constructor(i,e,t=0,r=1/0){this.ray=new AE(i,e),this.near=t,this.far=r,this.camera=null,this.layers=new cY,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(i,e){this.ray.set(i,e)}setFromCamera(i,e){e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(i.x,i.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e.isOrthographicCamera?(this.ray.origin.set(i.x,i.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type: "+e.type)}intersectObject(i,e=!0,t=[]){return h4(i,this,t,e),t.sort(lj),t}intersectObjects(i,e=!0,t=[]){for(let r=0,n=i.length;r<n;r++)h4(i[r],this,t,e);return t.sort(lj),t}};function lj(i,e){return i.distance-e.distance}function h4(i,e,t,r){if(i.layers.test(e.layers)&&i.raycast(e,t),r===!0){let n=i.children;for(let l=0,c=n.length;l<c;l++)h4(n[l],e,t,!0)}}var uj=new Se,_P=new Se,bp=class{constructor(i=new Se,e=new Se){this.start=i,this.end=e}set(i,e){return this.start.copy(i),this.end.copy(e),this}copy(i){return this.start.copy(i.start),this.end.copy(i.end),this}getCenter(i){return i.addVectors(this.start,this.end).multiplyScalar(.5)}delta(i){return i.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(i,e){return this.delta(e).multiplyScalar(i).add(this.start)}closestPointToPointParameter(i,e){uj.subVectors(i,this.start),_P.subVectors(this.end,this.start);let t=_P.dot(_P),r=_P.dot(uj)/t;return e&&(r=La(r,0,1)),r}closestPointToPoint(i,e,t){let r=this.closestPointToPointParameter(i,e);return this.delta(t).multiplyScalar(r).add(this.start)}applyMatrix4(i){return this.start.applyMatrix4(i),this.end.applyMatrix4(i),this}equals(i){return i.start.equals(this.start)&&i.end.equals(this.end)}clone(){return new this.constructor().copy(this)}};typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:iY}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=iY);var oCe=Math.pow(2,-24),xP=class{constructor(){}};function mf(i,e,t){return t.min.x=e[i],t.min.y=e[i+1],t.min.z=e[i+2],t.max.x=e[i+3],t.max.y=e[i+4],t.max.z=e[i+5],t}function cj(i){let e=-1,t=-1/0;for(let r=0;r<3;r++){let n=i[r+3]-i[r];n>t&&(t=n,e=r)}return e}function hj(i,e){e.set(i)}function dj(i,e,t){let r,n;for(let l=0;l<3;l++){let c=l+3;r=i[l],n=e[l],t[l]=r<n?r:n,r=i[c],n=e[c],t[c]=r>n?r:n}}function bP(i,e,t){for(let r=0;r<3;r++){let n=e[i+2*r],l=e[i+2*r+1],c=n-l,h=n+l;c<t[r]&&(t[r]=c),h>t[r+3]&&(t[r+3]=h)}}function wT(i){let e=i[3]-i[0],t=i[4]-i[1],r=i[5]-i[2];return 2*(e*t+t*r+r*e)}function lCe(i,e){if(!i.index){let t=i.attributes.position.count,r=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,n;t>65535?n=new Uint32Array(new r(4*t)):n=new Uint16Array(new r(2*t)),i.setIndex(new zu(n,1));for(let l=0;l<t;l++)n[l]=l}}function uCe(i){if(!i.groups||!i.groups.length)return[{offset:0,count:i.index.count/3}];let e=[],t=new Set;for(let n of i.groups)t.add(n.start),t.add(n.start+n.count);let r=Array.from(t.values()).sort((n,l)=>n-l);for(let n=0;n<r.length-1;n++){let l=r[n],c=r[n+1];e.push({offset:l/3,count:(c-l)/3})}return e}function DD(i,e,t,r,n=null){let l=1/0,c=1/0,h=1/0,d=-1/0,f=-1/0,m=-1/0,g=1/0,y=1/0,_=1/0,b=-1/0,S=-1/0,E=-1/0,T=n!==null;for(let A=e*6,P=(e+t)*6;A<P;A+=6){let O=i[A+0],R=i[A+1],D=O-R,L=O+R;D<l&&(l=D),L>d&&(d=L),T&&O<g&&(g=O),T&&O>b&&(b=O);let N=i[A+2],U=i[A+3],F=N-U,z=N+U;F<c&&(c=F),z>f&&(f=z),T&&N<y&&(y=N),T&&N>S&&(S=N);let G=i[A+4],J=i[A+5],Z=G-J,q=G+J;Z<h&&(h=Z),q>m&&(m=q),T&&G<_&&(_=G),T&&G>E&&(E=G)}r[0]=l,r[1]=c,r[2]=h,r[3]=d,r[4]=f,r[5]=m,T&&(n[0]=g,n[1]=y,n[2]=_,n[3]=b,n[4]=S,n[5]=E)}function cCe(i,e,t,r){let n=1/0,l=1/0,c=1/0,h=-1/0,d=-1/0,f=-1/0;for(let m=e*6,g=(e+t)*6;m<g;m+=6){let y=i[m+0];y<n&&(n=y),y>h&&(h=y);let _=i[m+2];_<l&&(l=_),_>d&&(d=_);let b=i[m+4];b<c&&(c=b),b>f&&(f=b)}r[0]=n,r[1]=l,r[2]=c,r[3]=h,r[4]=d,r[5]=f}function hCe(i,e,t,r,n){let l=t,c=t+r-1,h=n.pos,d=n.axis*2;for(;;){for(;l<=c&&e[l*6+d]<h;)l++;for(;l<=c&&e[c*6+d]>=h;)c--;if(l<c){for(let f=0;f<3;f++){let m=i[l*3+f];i[l*3+f]=i[c*3+f],i[c*3+f]=m;let g=e[l*6+f*2+0];e[l*6+f*2+0]=e[c*6+f*2+0],e[c*6+f*2+0]=g;let y=e[l*6+f*2+1];e[l*6+f*2+1]=e[c*6+f*2+1],e[c*6+f*2+1]=y}l++,c--}else return l}}var np=32,dCe=(i,e)=>i.candidate-e.candidate,pm=new Array(np).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),wP=new Float32Array(6);function fCe(i,e,t,r,n,l){let c=-1,h=0;if(l===0)c=cj(e),c!==-1&&(h=(e[c]+e[c+3])/2);else if(l===1)c=cj(i),c!==-1&&(h=pCe(t,r,n,c));else if(l===2){let d=wT(i),f=1.25*n,m=r*6,g=(r+n)*6;for(let y=0;y<3;y++){let _=e[y],b=(e[y+3]-_)/np;if(n<np/4){let S=[...pm];S.length=n;let E=0;for(let A=m;A<g;A+=6,E++){let P=S[E];P.candidate=t[A+2*y],P.count=0;let{bounds:O,leftCacheBounds:R,rightCacheBounds:D}=P;for(let L=0;L<3;L++)D[L]=1/0,D[L+3]=-1/0,R[L]=1/0,R[L+3]=-1/0,O[L]=1/0,O[L+3]=-1/0;bP(A,t,O)}S.sort(dCe);let T=n;for(let A=0;A<T;A++){let P=S[A];for(;A+1<T&&S[A+1].candidate===P.candidate;)S.splice(A+1,1),T--}for(let A=m;A<g;A+=6){let P=t[A+2*y];for(let O=0;O<T;O++){let R=S[O];P>=R.candidate?bP(A,t,R.rightCacheBounds):(bP(A,t,R.leftCacheBounds),R.count++)}}for(let A=0;A<T;A++){let P=S[A],O=P.count,R=n-P.count,D=P.leftCacheBounds,L=P.rightCacheBounds,N=0;O!==0&&(N=wT(D)/d);let U=0;R!==0&&(U=wT(L)/d);let F=1+1.25*(N*O+U*R);F<f&&(c=y,f=F,h=P.candidate)}}else{for(let T=0;T<np;T++){let A=pm[T];A.count=0,A.candidate=_+b+T*b;let P=A.bounds;for(let O=0;O<3;O++)P[O]=1/0,P[O+3]=-1/0}for(let T=m;T<g;T+=6){let A=~~((t[T+2*y]-_)/b);A>=np&&(A=np-1);let P=pm[A];P.count++,bP(T,t,P.bounds)}let S=pm[np-1];hj(S.bounds,S.rightCacheBounds);for(let T=np-2;T>=0;T--){let A=pm[T],P=pm[T+1];dj(A.bounds,P.rightCacheBounds,A.rightCacheBounds)}let E=0;for(let T=0;T<np-1;T++){let A=pm[T],P=A.count,O=A.bounds,R=pm[T+1].rightCacheBounds;P!==0&&(E===0?hj(O,wP):dj(O,wP,wP)),E+=P;let D=0,L=0;E!==0&&(D=wT(wP)/d);let N=n-E;N!==0&&(L=wT(R)/d);let U=1+1.25*(D*E+L*N);U<f&&(c=y,f=U,h=A.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${l} used.`);return{axis:c,pos:h}}function pCe(i,e,t,r){let n=0;for(let l=e,c=e+t;l<c;l++)n+=i[l*6+r*2];return n/t}function mCe(i,e){let t=i.attributes.position,r=i.index.array,n=r.length/3,l=new Float32Array(n*6),c=t.normalized,h=t.array,d=t.offset||0,f=3;t.isInterleavedBufferAttribute&&(f=t.data.stride);let m=["getX","getY","getZ"];for(let g=0;g<n;g++){let y=g*3,_=g*6,b,S,E;c?(b=r[y+0],S=r[y+1],E=r[y+2]):(b=r[y+0]*f+d,S=r[y+1]*f+d,E=r[y+2]*f+d);for(let T=0;T<3;T++){let A,P,O;c?(A=t[m[T]](b),P=t[m[T]](S),O=t[m[T]](E)):(A=h[b+T],P=h[S+T],O=h[E+T]);let R=A;P<R&&(R=P),O<R&&(R=O);let D=A;P>D&&(D=P),O>D&&(D=O);let L=(D-R)/2,N=T*2;l[_+N+0]=R+L,l[_+N+1]=L+(Math.abs(R)+L)*oCe,R<e[T]&&(e[T]=R),D>e[T+3]&&(e[T+3]=D)}}return l}function gCe(i,e){function t(T){y&&y(T/_)}function r(T,A,P,O=null,R=0){if(!b&&R>=d&&(b=!0,f&&(console.warn(`MeshBVH: Max depth of ${d} reached when generating BVH. Consider increasing maxDepth.`),console.warn(i))),P<=m||R>=d)return t(A+P),T.offset=A,T.count=P,T;let D=fCe(T.boundingData,O,c,A,P,g);if(D.axis===-1)return t(A+P),T.offset=A,T.count=P,T;let L=hCe(h,c,A,P,D);if(L===A||L===A+P)t(A+P),T.offset=A,T.count=P;else{T.splitAxis=D.axis;let N=new xP,U=A,F=L-A;T.left=N,N.boundingData=new Float32Array(6),DD(c,U,F,N.boundingData,l),r(N,U,F,l,R+1);let z=new xP,G=L,J=P-F;T.right=z,z.boundingData=new Float32Array(6),DD(c,G,J,z.boundingData,l),r(z,G,J,l,R+1)}return T}lCe(i,e);let n=new Float32Array(6),l=new Float32Array(6),c=mCe(i,n),h=i.index.array,d=e.maxDepth,f=e.verbose,m=e.maxLeafTris,g=e.strategy,y=e.onProgress,_=i.index.count/3,b=!1,S=[],E=uCe(i);if(E.length===1){let T=E[0],A=new xP;A.boundingData=n,cCe(c,T.offset,T.count,l),r(A,T.offset,T.count,l),S.push(A)}else for(let T of E){let A=new xP;A.boundingData=new Float32Array(6),DD(c,T.offset,T.count,A.boundingData,l),r(A,T.offset,T.count,l),S.push(A)}return S}function vCe(i,e){let t=gCe(i,e),r,n,l,c=[],h=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let m=0;m<t.length;m++){let g=t[m],y=d(g),_=new h(32*y);r=new Float32Array(_),n=new Uint32Array(_),l=new Uint16Array(_),f(0,g),c.push(_)}return c;function d(m){return m.count?1:1+d(m.left)+d(m.right)}function f(m,g){let y=m/4,_=m/2,b=!!g.count,S=g.boundingData;for(let E=0;E<6;E++)r[y+E]=S[E];if(b){let E=g.offset,T=g.count;return n[y+6]=E,l[_+14]=T,l[_+15]=65535,m+32}else{let E=g.left,T=g.right,A=g.splitAxis,P;if(P=f(m+32,E),P/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return n[y+6]=P/4,P=f(P,T),n[y+7]=A,P}}}var Np=class{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(i,e){let t=1/0,r=-1/0;for(let n=0,l=i.length;n<l;n++){let c=i[n][e];t=c<t?c:t,r=c>r?c:r}this.min=t,this.max=r}setFromPoints(i,e){let t=1/0,r=-1/0;for(let n=0,l=e.length;n<l;n++){let c=e[n],h=i.dot(c);t=h<t?h:t,r=h>r?h:r}this.min=t,this.max=r}isSeparated(i){return this.min>i.max||i.min>this.max}};Np.prototype.setFromBox=function(){let i=new Se;return function(e,t){let r=t.min,n=t.max,l=1/0,c=-1/0;for(let h=0;h<=1;h++)for(let d=0;d<=1;d++)for(let f=0;f<=1;f++){i.x=r.x*h+n.x*(1-h),i.y=r.y*d+n.y*(1-d),i.z=r.z*f+n.z*(1-f);let m=e.dot(i);l=Math.min(m,l),c=Math.max(m,c)}this.min=l,this.max=c}}();var yCe=function(){let i=new Se,e=new Se,t=new Se;return function(r,n,l){let c=r.start,h=i,d=n.start,f=e;t.subVectors(c,d),i.subVectors(r.end,r.start),e.subVectors(n.end,n.start);let m=t.dot(f),g=f.dot(h),y=f.dot(f),_=t.dot(h),b=h.dot(h)*y-g*g,S,E;b!==0?S=(m*g-_*y)/b:S=0,E=(m+S*g)/y,l.x=S,l.y=E}}(),vU=function(){let i=new mi,e=new Se,t=new Se;return function(r,n,l,c){yCe(r,n,i);let h=i.x,d=i.y;if(h>=0&&h<=1&&d>=0&&d<=1){r.at(h,l),n.at(d,c);return}else if(h>=0&&h<=1){d<0?n.at(0,c):n.at(1,c),r.closestPointToPoint(c,!0,l);return}else if(d>=0&&d<=1){h<0?r.at(0,l):r.at(1,l),n.closestPointToPoint(l,!0,c);return}else{let f;h<0?f=r.start:f=r.end;let m;d<0?m=n.start:m=n.end;let g=e,y=t;if(r.closestPointToPoint(m,!0,e),n.closestPointToPoint(f,!0,t),g.distanceToSquared(m)<=y.distanceToSquared(f)){l.copy(g),c.copy(m);return}else{l.copy(f),c.copy(y);return}}}}(),_Ce=function(){let i=new Se,e=new Se,t=new bm,r=new bp;return function(n,l){let{radius:c,center:h}=n,{a:d,b:f,c:m}=l;if(r.start=d,r.end=f,r.closestPointToPoint(h,!0,i).distanceTo(h)<=c||(r.start=d,r.end=m,r.closestPointToPoint(h,!0,i).distanceTo(h)<=c)||(r.start=f,r.end=m,r.closestPointToPoint(h,!0,i).distanceTo(h)<=c))return!0;let g=l.getPlane(t);if(Math.abs(g.distanceToPoint(h))<=c){let y=g.projectPoint(h,e);if(l.containsPoint(y))return!0}return!1}}(),xCe=1e-15;function IS(i){return Math.abs(i)<xCe}var Dp=class extends ou{constructor(...i){super(...i),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new Se),this.satBounds=new Array(4).fill().map(()=>new Np),this.points=[this.a,this.b,this.c],this.sphere=new tf,this.plane=new bm,this.needsUpdate=!0}intersectsSphere(i){return _Ce(i,this)}update(){let i=this.a,e=this.b,t=this.c,r=this.points,n=this.satAxes,l=this.satBounds,c=n[0],h=l[0];this.getNormal(c),h.setFromPoints(c,r);let d=n[1],f=l[1];d.subVectors(i,e),f.setFromPoints(d,r);let m=n[2],g=l[2];m.subVectors(e,t),g.setFromPoints(m,r);let y=n[3],_=l[3];y.subVectors(t,i),_.setFromPoints(y,r),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(c,i),this.needsUpdate=!1}};Dp.prototype.closestPointToSegment=function(){let i=new Se,e=new Se,t=new bp;return function(r,n=null,l=null){let{start:c,end:h}=r,d=this.points,f,m=1/0;for(let g=0;g<3;g++){let y=(g+1)%3;t.start.copy(d[g]),t.end.copy(d[y]),vU(t,r,i,e),f=i.distanceToSquared(e),f<m&&(m=f,n&&n.copy(i),l&&l.copy(e))}return this.closestPointToPoint(c,i),f=c.distanceToSquared(i),f<m&&(m=f,n&&n.copy(i),l&&l.copy(c)),this.closestPointToPoint(h,i),f=h.distanceToSquared(i),f<m&&(m=f,n&&n.copy(i),l&&l.copy(h)),Math.sqrt(m)}}();Dp.prototype.intersectsTriangle=function(){let i=new Dp,e=new Array(3),t=new Array(3),r=new Np,n=new Np,l=new Se,c=new Se,h=new Se,d=new Se,f=new bp,m=new bp,g=new bp;return function(y,_=null,b=!1){this.needsUpdate&&this.update(),y.isExtendedTriangle?y.needsUpdate&&y.update():(i.copy(y),i.update(),y=i);let S=this.plane,E=y.plane;if(Math.abs(S.normal.dot(E.normal))>1-1e-10){let T=this.satBounds,A=this.satAxes;t[0]=y.a,t[1]=y.b,t[2]=y.c;for(let R=0;R<4;R++){let D=T[R],L=A[R];if(r.setFromPoints(L,t),D.isSeparated(r))return!1}let P=y.satBounds,O=y.satAxes;e[0]=this.a,e[1]=this.b,e[2]=this.c;for(let R=0;R<4;R++){let D=P[R],L=O[R];if(r.setFromPoints(L,e),D.isSeparated(r))return!1}for(let R=0;R<4;R++){let D=A[R];for(let L=0;L<4;L++){let N=O[L];if(l.crossVectors(D,N),r.setFromPoints(l,e),n.setFromPoints(l,t),r.isSeparated(n))return!1}}return _&&(b||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),_.start.set(0,0,0),_.end.set(0,0,0)),!0}else{let T=this.points,A=!1,P=0;for(let J=0;J<3;J++){let Z=T[J],q=T[(J+1)%3];f.start.copy(Z),f.end.copy(q),f.delta(c);let $=A?m.start:m.end,H=IS(E.distanceToPoint(Z));if(IS(E.normal.dot(c))&&H){m.copy(f),P=2;break}if((E.intersectLine(f,$)||H)&&!IS($.distanceTo(q))){if(P++,A)break;A=!0}}if(P===1&&y.containsPoint(m.end))return _&&(_.start.copy(m.end),_.end.copy(m.end)),!0;if(P!==2)return!1;let O=y.points,R=!1,D=0;for(let J=0;J<3;J++){let Z=O[J],q=O[(J+1)%3];f.start.copy(Z),f.end.copy(q),f.delta(h);let $=R?g.start:g.end,H=IS(S.distanceToPoint(Z));if(IS(S.normal.dot(h))&&H){g.copy(f),D=2;break}if((S.intersectLine(f,$)||H)&&!IS($.distanceTo(q))){if(D++,R)break;R=!0}}if(D===1&&this.containsPoint(g.end))return _&&(_.start.copy(g.end),_.end.copy(g.end)),!0;if(D!==2)return!1;if(m.delta(c),g.delta(h),c.dot(h)<0){let J=g.start;g.start=g.end,g.end=J}let L=m.start.dot(c),N=m.end.dot(c),U=g.start.dot(c),F=g.end.dot(c),z=N<U,G=L<F;return L!==F&&U!==N&&z===G?!1:(_&&(d.subVectors(m.start,g.start),d.dot(c)>0?_.start.copy(m.start):_.start.copy(g.start),d.subVectors(m.end,g.end),d.dot(c)<0?_.end.copy(m.end):_.end.copy(g.end)),!0)}}}();Dp.prototype.distanceToPoint=function(){let i=new Se;return function(e){return this.closestPointToPoint(e,i),e.distanceTo(i)}}();Dp.prototype.distanceToTriangle=function(){let i=new Se,e=new Se,t=["a","b","c"],r=new bp,n=new bp;return function(l,c=null,h=null){let d=c||h?r:null;if(this.intersectsTriangle(l,d))return(c||h)&&(c&&d.getCenter(c),h&&d.getCenter(h)),0;let f=1/0;for(let m=0;m<3;m++){let g,y=t[m],_=l[y];this.closestPointToPoint(_,i),g=_.distanceToSquared(i),g<f&&(f=g,c&&c.copy(i),h&&h.copy(_));let b=this[y];l.closestPointToPoint(b,i),g=b.distanceToSquared(i),g<f&&(f=g,c&&c.copy(b),h&&h.copy(i))}for(let m=0;m<3;m++){let g=t[m],y=t[(m+1)%3];r.set(this[g],this[y]);for(let _=0;_<3;_++){let b=t[_],S=t[(_+1)%3];n.set(l[b],l[S]),vU(r,n,i,e);let E=i.distanceToSquared(e);E<f&&(f=E,c&&c.copy(i),h&&h.copy(e))}}return Math.sqrt(f)}}();var Tf=class{constructor(i,e,t){this.isOrientedBox=!0,this.min=new Se,this.max=new Se,this.matrix=new ar,this.invMatrix=new ar,this.points=new Array(8).fill().map(()=>new Se),this.satAxes=new Array(3).fill().map(()=>new Se),this.satBounds=new Array(3).fill().map(()=>new Np),this.alignedSatBounds=new Array(3).fill().map(()=>new Np),this.needsUpdate=!1,i&&this.min.copy(i),e&&this.max.copy(e),t&&this.matrix.copy(t)}set(i,e,t){this.min.copy(i),this.max.copy(e),this.matrix.copy(t),this.needsUpdate=!0}copy(i){this.min.copy(i.min),this.max.copy(i.max),this.matrix.copy(i.matrix),this.needsUpdate=!0}};Tf.prototype.update=function(){return function(){let i=this.matrix,e=this.min,t=this.max,r=this.points;for(let d=0;d<=1;d++)for(let f=0;f<=1;f++)for(let m=0;m<=1;m++){let g=1*d|2*f|4*m,y=r[g];y.x=d?t.x:e.x,y.y=f?t.y:e.y,y.z=m?t.z:e.z,y.applyMatrix4(i)}let n=this.satBounds,l=this.satAxes,c=r[0];for(let d=0;d<3;d++){let f=l[d],m=n[d],g=1<<d,y=r[g];f.subVectors(c,y),m.setFromPoints(f,r)}let h=this.alignedSatBounds;h[0].setFromPointsField(r,"x"),h[1].setFromPointsField(r,"y"),h[2].setFromPointsField(r,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();Tf.prototype.intersectsBox=function(){let i=new Np;return function(e){this.needsUpdate&&this.update();let t=e.min,r=e.max,n=this.satBounds,l=this.satAxes,c=this.alignedSatBounds;if(i.min=t.x,i.max=r.x,c[0].isSeparated(i)||(i.min=t.y,i.max=r.y,c[1].isSeparated(i))||(i.min=t.z,i.max=r.z,c[2].isSeparated(i)))return!1;for(let h=0;h<3;h++){let d=l[h],f=n[h];if(i.setFromBox(d,e),f.isSeparated(i))return!1}return!0}}();Tf.prototype.intersectsTriangle=function(){let i=new Dp,e=new Array(3),t=new Np,r=new Np,n=new Se;return function(l){this.needsUpdate&&this.update(),l.isExtendedTriangle?l.needsUpdate&&l.update():(i.copy(l),i.update(),l=i);let c=this.satBounds,h=this.satAxes;e[0]=l.a,e[1]=l.b,e[2]=l.c;for(let g=0;g<3;g++){let y=c[g],_=h[g];if(t.setFromPoints(_,e),y.isSeparated(t))return!1}let d=l.satBounds,f=l.satAxes,m=this.points;for(let g=0;g<3;g++){let y=d[g],_=f[g];if(t.setFromPoints(_,m),y.isSeparated(t))return!1}for(let g=0;g<3;g++){let y=h[g];for(let _=0;_<4;_++){let b=f[_];if(n.crossVectors(y,b),t.setFromPoints(n,e),r.setFromPoints(n,m),t.isSeparated(r))return!1}}return!0}}();Tf.prototype.closestPointToPoint=function(){return function(i,e){return this.needsUpdate&&this.update(),e.copy(i).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),e}}();Tf.prototype.distanceToPoint=function(){let i=new Se;return function(e){return this.closestPointToPoint(e,i),e.distanceTo(i)}}();Tf.prototype.distanceToBox=function(){let i=["x","y","z"],e=new Array(12).fill().map(()=>new bp),t=new Array(12).fill().map(()=>new bp),r=new Se,n=new Se;return function(l,c=0,h=null,d=null){if(this.needsUpdate&&this.update(),this.intersectsBox(l))return(h||d)&&(l.getCenter(n),this.closestPointToPoint(n,r),l.closestPointToPoint(r,n),h&&h.copy(r),d&&d.copy(n)),0;let f=c*c,m=l.min,g=l.max,y=this.points,_=1/0;for(let S=0;S<8;S++){let E=y[S];n.copy(E).clamp(m,g);let T=E.distanceToSquared(n);if(T<_&&(_=T,h&&h.copy(E),d&&d.copy(n),T<f))return Math.sqrt(T)}let b=0;for(let S=0;S<3;S++)for(let E=0;E<=1;E++)for(let T=0;T<=1;T++){let A=(S+1)%3,P=(S+2)%3,O=E<<A|T<<P,R=1<<S|E<<A|T<<P,D=y[O],L=y[R];e[b].set(D,L);let N=i[S],U=i[A],F=i[P],z=t[b],G=z.start,J=z.end;G[N]=m[N],G[U]=E?m[U]:g[U],G[F]=T?m[F]:g[U],J[N]=g[N],J[U]=E?m[U]:g[U],J[F]=T?m[F]:g[U],b++}for(let S=0;S<=1;S++)for(let E=0;E<=1;E++)for(let T=0;T<=1;T++){n.x=S?g.x:m.x,n.y=E?g.y:m.y,n.z=T?g.z:m.z,this.closestPointToPoint(n,r);let A=n.distanceToSquared(r);if(A<_&&(_=A,h&&h.copy(r),d&&d.copy(n),A<f))return Math.sqrt(A)}for(let S=0;S<12;S++){let E=e[S];for(let T=0;T<12;T++){let A=t[T];vU(E,A,r,n);let P=r.distanceToSquared(n);if(P<_&&(_=P,h&&h.copy(r),d&&d.copy(n),P<f))return Math.sqrt(P)}}return Math.sqrt(_)}}();var SP=new Se,MP=new Se,EP=new Se,fj=new mi,pj=new mi,mj=new mi,gj=new Se;function bCe(i,e,t,r,n,l){let c;return l===rY?c=i.intersectTriangle(r,t,e,!0,n):c=i.intersectTriangle(e,t,r,l!==tU,n),c===null?null:{distance:i.origin.distanceTo(n),point:n.clone()}}function wCe(i,e,t,r,n,l,c){SP.fromBufferAttribute(e,r),MP.fromBufferAttribute(e,n),EP.fromBufferAttribute(e,l);let h=bCe(i,SP,MP,EP,gj,c);if(h){t&&(fj.fromBufferAttribute(t,r),pj.fromBufferAttribute(t,n),mj.fromBufferAttribute(t,l),h.uv=ou.getUV(gj,SP,MP,EP,fj,pj,mj,new mi));let d={a:r,b:n,c:l,normal:new Se,materialIndex:0};ou.getNormal(SP,MP,EP,d.normal),h.face=d,h.faceIndex=r}return h}function PY(i,e,t,r,n){let l=r*3,c=i.index.getX(l),h=i.index.getX(l+1),d=i.index.getX(l+2),f=wCe(t,i.attributes.position,i.attributes.uv,c,h,d,e);return f?(f.faceIndex=r,n&&n.push(f),f):null}function SCe(i,e,t,r,n,l){for(let c=r,h=r+n;c<h;c++)PY(i,e,t,c,l)}function MCe(i,e,t,r,n){let l=1/0,c=null;for(let h=r,d=r+n;h<d;h++){let f=PY(i,e,t,h);f&&f.distance<l&&(c=f,l=f.distance)}return c}function vj(i,e,t){return i===null||(i.point.applyMatrix4(e.matrixWorld),i.distance=i.point.distanceTo(t.ray.origin),i.object=e,i.distance<t.near||i.distance>t.far)?null:i}function df(i,e,t,r){let n=i.a,l=i.b,c=i.c,h=e,d=e+1,f=e+2;t&&(h=t.getX(e),d=t.getX(e+1),f=t.getX(e+2)),n.x=r.getX(h),n.y=r.getY(h),n.z=r.getZ(h),l.x=r.getX(d),l.y=r.getY(d),l.z=r.getZ(d),c.x=r.getX(f),c.y=r.getY(f),c.z=r.getZ(f)}function yj(i,e,t,r,n,l,c){let h=t.index,d=t.attributes.position;for(let f=i,m=e+i;f<m;f++)if(df(c,f*3,h,d),c.needsUpdate=!0,r(c,f,n,l))return!0;return!1}var RY=class{constructor(i){this._getNewPrimitive=i,this._primitives=[]}getPrimitive(){let i=this._primitives;return i.length===0?this._getNewPrimitive():i.pop()}releasePrimitive(i){this._primitives.push(i)}};function Cm(i,e){return e[i+15]===65535}function wM(i,e){return e[i+6]}function sC(i,e){return e[i+14]}function aC(i){return i+8}function oC(i,e){return e[i+6]}function ECe(i,e){return e[i+7]}var nM=new Co,hI=new Se,TCe=["x","y","z"];function d4(i,e,t,r,n){let l=i*2,c=IE,h=jm,d=Gm;if(Cm(l,h)){let f=wM(i,d),m=sC(l,h);SCe(e,t,r,f,m,n)}else{let f=aC(i);dI(f,c,r,hI)&&d4(f,e,t,r,n);let m=oC(i,d);dI(m,c,r,hI)&&d4(m,e,t,r,n)}}function f4(i,e,t,r){let n=i*2,l=IE,c=jm,h=Gm;if(Cm(n,c)){let d=wM(i,h),f=sC(n,c);return MCe(e,t,r,d,f)}else{let d=ECe(i,h),f=TCe[d],m=r.direction[f]>=0,g,y;m?(g=aC(i),y=oC(i,h)):(g=oC(i,h),y=aC(i));let _=dI(g,l,r,hI)?f4(g,e,t,r):null;if(_){let S=_.point[f];if(m?S<=l[y+d]:S>=l[y+d+3])return _}let b=dI(y,l,r,hI)?f4(y,e,t,r):null;return _&&b?_.distance<=b.distance?_:b:_||b||null}}var ACe=function(){let i,e,t=[],r=new RY(()=>new Co);return function(...l){i=r.getPrimitive(),e=r.getPrimitive(),t.push(i,e);let c=n(...l);r.releasePrimitive(i),r.releasePrimitive(e),t.pop(),t.pop();let h=t.length;return h>0&&(e=t[h-1],i=t[h-2]),c};function n(l,c,h,d,f=null,m=0,g=0){function y(A){let P=A*2,O=jm,R=Gm;for(;!Cm(P,O);)A=aC(A),P=A*2;return wM(A,R)}function _(A){let P=A*2,O=jm,R=Gm;for(;!Cm(P,O);)A=oC(A,R),P=A*2;return wM(A,R)+sC(P,O)}let b=l*2,S=IE,E=jm,T=Gm;if(Cm(b,E)){let A=wM(l,T),P=sC(b,E);return mf(l,S,i),d(A,P,!1,g,m+l,i)}else{let A=aC(l),P=oC(l,T),O=A,R=P,D,L,N,U;if(f&&(N=i,U=e,mf(O,S,N),mf(R,S,U),D=f(N),L=f(U),L<D)){O=P,R=A;let $=D;D=L,L=$,N=U}N||(N=i,mf(O,S,N));let F=Cm(O*2,E),z=h(N,F,D,g+1,m+O),G;if(z===2){let $=y(O),H=_(O)-$;G=d($,H,!0,g+1,m+O,N)}else G=z&&n(O,c,h,d,f,m,g+1);if(G)return!0;U=e,mf(R,S,U);let J=Cm(R*2,E),Z=h(U,J,L,g+1,m+R),q;if(Z===2){let $=y(R),H=_(R)-$;q=d($,H,!0,g+1,m+R,U)}else q=Z&&n(R,c,h,d,f,m,g+1);return!!q}}}(),CCe=function(){let i=new Dp,e=new Dp,t=new ar,r=new Tf,n=new Tf;return function l(c,h,d,f,m=null){let g=c*2,y=IE,_=jm,b=Gm;if(m===null&&(d.boundingBox||d.computeBoundingBox(),r.set(d.boundingBox.min,d.boundingBox.max,f),m=r),Cm(g,_)){let S=h,E=S.index,T=S.attributes.position,A=d.index,P=d.attributes.position,O=wM(c,b),R=sC(g,_);if(t.copy(f).invert(),d.boundsTree)return mf(c,y,n),n.matrix.copy(t),n.needsUpdate=!0,d.boundsTree.shapecast({intersectsBounds:D=>n.intersectsBox(D),intersectsTriangle:D=>{D.a.applyMatrix4(f),D.b.applyMatrix4(f),D.c.applyMatrix4(f),D.needsUpdate=!0;for(let L=O*3,N=(R+O)*3;L<N;L+=3)if(df(e,L,E,T),e.needsUpdate=!0,D.intersectsTriangle(e))return!0;return!1}});for(let D=O*3,L=R+O*3;D<L;D+=3){df(i,D,E,T),i.a.applyMatrix4(t),i.b.applyMatrix4(t),i.c.applyMatrix4(t),i.needsUpdate=!0;for(let N=0,U=A.count;N<U;N+=3)if(df(e,N,A,P),e.needsUpdate=!0,i.intersectsTriangle(e))return!0}}else{let S=c+8,E=b[c+6];return mf(S,y,nM),!!(m.intersectsBox(nM)&&l(S,h,d,f,m)||(mf(E,y,nM),m.intersectsBox(nM)&&l(E,h,d,f,m)))}}}();function dI(i,e,t,r){return mf(i,e,nM),t.intersectBox(nM,r)}var p4=[],nR,IE,jm,Gm;function zT(i){nR&&p4.push(nR),nR=i,IE=new Float32Array(i),jm=new Uint16Array(i),Gm=new Uint32Array(i)}function TP(){nR=null,IE=null,jm=null,Gm=null,p4.length&&zT(p4.pop())}var kD=Symbol("skip tree generation"),FD=new Co,zD=new Co,LS=new ar,y1=new Tf,ST=new Tf,MT=new Se,AP=new Se,PCe=new Se,RCe=new Se,ICe=new Se,_j=new Co,of=new RY(()=>new Dp),sR=class{static serialize(i,e={}){if(e.isBufferGeometry)return console.warn("MeshBVH.serialize: The arguments for the function have changed. See documentation for new signature."),sR.serialize(arguments[0],{cloneBuffers:arguments[2]===void 0?!0:arguments[2]});e=iR({cloneBuffers:!0},e);let t=i.geometry,r=i._roots,n=t.getIndex(),l;return e.cloneBuffers?l={roots:r.map(c=>c.slice()),index:n.array.slice()}:l={roots:r,index:n.array},l}static deserialize(i,e,t={}){if(typeof t=="boolean")return console.warn("MeshBVH.deserialize: The arguments for the function have changed. See documentation for new signature."),sR.deserialize(arguments[0],arguments[1],{setIndex:arguments[2]===void 0?!0:arguments[2]});t=iR({setIndex:!0},t);let{index:r,roots:n}=i,l=new sR(e,rSe(iR({},t),{[kD]:!0}));if(l._roots=n,t.setIndex){let c=e.getIndex();if(c===null){let h=new zu(i.index,1,!1);e.setIndex(h)}else c.array!==r&&(c.array.set(r),c.needsUpdate=!0)}return l}constructor(i,e={}){if(i.isBufferGeometry){if(i.index&&i.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(e=Object.assign({strategy:0,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,[kD]:!1},e),e.useSharedArrayBuffer&&typeof SharedArrayBuffer>"u")throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,e[kD]||(this._roots=vCe(i,e),!i.boundingBox&&e.setBoundingBox&&(i.boundingBox=this.getBoundingBox(new Co))),this.geometry=i}refit(i=null){i&&Array.isArray(i)&&(i=new Set(i));let e=this.geometry,t=e.index.array,r=e.attributes.position,n,l,c,h,d=0,f=this._roots;for(let g=0,y=f.length;g<y;g++)n=f[g],l=new Uint32Array(n),c=new Uint16Array(n),h=new Float32Array(n),m(0,d),d+=n.byteLength;function m(g,y,_=!1){let b=g*2;if(c[b+15]===65535){let S=l[g+6],E=c[b+14],T=1/0,A=1/0,P=1/0,O=-1/0,R=-1/0,D=-1/0;for(let L=3*S,N=3*(S+E);L<N;L++){let U=t[L],F=r.getX(U),z=r.getY(U),G=r.getZ(U);F<T&&(T=F),F>O&&(O=F),z<A&&(A=z),z>R&&(R=z),G<P&&(P=G),G>D&&(D=G)}return h[g+0]!==T||h[g+1]!==A||h[g+2]!==P||h[g+3]!==O||h[g+4]!==R||h[g+5]!==D?(h[g+0]=T,h[g+1]=A,h[g+2]=P,h[g+3]=O,h[g+4]=R,h[g+5]=D,!0):!1}else{let S=g+8,E=l[g+6],T=S+y,A=E+y,P=_,O=!1,R=!1;i?P||(O=i.has(T),R=i.has(A),P=!O&&!R):(O=!0,R=!0);let D=P||O,L=P||R,N=!1;D&&(N=m(S,y,P));let U=!1;L&&(U=m(E,y,P));let F=N||U;if(F)for(let z=0;z<3;z++){let G=S+z,J=E+z,Z=h[G],q=h[G+3],$=h[J],H=h[J+3];h[g+z]=Z<$?Z:$,h[g+z+3]=q>H?q:H}return F}}}traverse(i,e=0){let t=this._roots[e],r=new Uint32Array(t),n=new Uint16Array(t);l(0);function l(c,h=0){let d=c*2,f=n[d+15]===65535;if(f){let m=r[c+6],g=n[d+14];i(h,f,new Float32Array(t,c*4,6),m,g)}else{let m=c+8,g=r[c+6],y=r[c+7];i(h,f,new Float32Array(t,c*4,6),y)||(l(m,h+1),l(g,h+1))}}}raycast(i,e=JM){let t=this._roots,r=this.geometry,n=[],l=e.isMaterial,c=Array.isArray(e),h=r.groups,d=l?e.side:e;for(let f=0,m=t.length;f<m;f++){let g=c?e[h[f].materialIndex].side:d,y=n.length;if(zT(t[f]),d4(0,r,g,i,n),TP(),c){let _=h[f].materialIndex;for(let b=y,S=n.length;b<S;b++)n[b].face.materialIndex=_}}return n}raycastFirst(i,e=JM){let t=this._roots,r=this.geometry,n=e.isMaterial,l=Array.isArray(e),c=null,h=r.groups,d=n?e.side:e;for(let f=0,m=t.length;f<m;f++){let g=l?e[h[f].materialIndex].side:d;zT(t[f]);let y=f4(0,r,g,i);TP(),y!=null&&(c==null||y.distance<c.distance)&&(c=y,l&&(y.face.materialIndex=h[f].materialIndex))}return c}intersectsGeometry(i,e){let t=this.geometry,r=!1;for(let n of this._roots)if(zT(n),r=CCe(0,t,i,e),TP(),r)break;return r}shapecast(i,e,t){let r=this.geometry;if(i instanceof Function){if(e){let g=e;e=(y,_,b,S)=>{let E=_*3;return g(y,E,E+1,E+2,b,S)}}i={boundsTraverseOrder:t,intersectsBounds:i,intersectsTriangle:e,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}let n=of.getPrimitive(),{boundsTraverseOrder:l,intersectsBounds:c,intersectsRange:h,intersectsTriangle:d}=i;if(h&&d){let g=h;h=(y,_,b,S,E)=>g(y,_,b,S,E)?!0:yj(y,_,r,d,b,S,n)}else h||(d?h=(g,y,_,b)=>yj(g,y,r,d,_,b,n):h=(g,y,_)=>_);let f=!1,m=0;for(let g of this._roots){if(zT(g),f=ACe(0,r,c,h,l,m),TP(),f)break;m+=g.byteLength}return of.releasePrimitive(n),f}bvhcast(i,e,t){let{intersectsRanges:r,intersectsTriangles:n}=t,l=this.geometry.index,c=this.geometry.attributes.position,h=i.geometry.index,d=i.geometry.attributes.position;LS.copy(e).invert();let f=of.getPrimitive(),m=of.getPrimitive();if(n){let y=function(_,b,S,E,T,A,P,O){for(let R=S,D=S+E;R<D;R++){df(m,R*3,h,d),m.a.applyMatrix4(e),m.b.applyMatrix4(e),m.c.applyMatrix4(e),m.needsUpdate=!0;for(let L=_,N=_+b;L<N;L++)if(df(f,L*3,l,c),f.needsUpdate=!0,n(f,m,L,R,T,A,P,O))return!0}return!1};if(r){let _=r;r=function(b,S,E,T,A,P,O,R){return _(b,S,E,T,A,P,O,R)?!0:y(b,S,E,T,A,P,O,R)}}else r=y}i.getBoundingBox(zD),zD.applyMatrix4(e);let g=this.shapecast({intersectsBounds:y=>zD.intersectsBox(y),intersectsRange:(y,_,b,S,E,T)=>(FD.copy(T),FD.applyMatrix4(LS),i.shapecast({intersectsBounds:A=>FD.intersectsBox(A),intersectsRange:(A,P,O,R,D)=>r(y,_,A,P,S,E,R,D)}))});return of.releasePrimitive(f),of.releasePrimitive(m),g}intersectsBox(i,e){return y1.set(i.min,i.max,e),y1.needsUpdate=!0,this.shapecast({intersectsBounds:t=>y1.intersectsBox(t),intersectsTriangle:t=>y1.intersectsTriangle(t)})}intersectsSphere(i){return this.shapecast({intersectsBounds:e=>i.intersectsBox(e),intersectsTriangle:e=>e.intersectsSphere(i)})}closestPointToGeometry(i,e,t={},r={},n=0,l=1/0){i.boundingBox||i.computeBoundingBox(),y1.set(i.boundingBox.min,i.boundingBox.max,e),y1.needsUpdate=!0;let c=this.geometry,h=c.attributes.position,d=c.index,f=i.attributes.position,m=i.index,g=of.getPrimitive(),y=of.getPrimitive(),_=AP,b=PCe,S=null,E=null;r&&(S=RCe,E=ICe);let T=1/0,A=null,P=null;return LS.copy(e).invert(),ST.matrix.copy(LS),this.shapecast({boundsTraverseOrder:O=>y1.distanceToBox(O),intersectsBounds:(O,R,D)=>D<T&&D<l?(R&&(ST.min.copy(O.min),ST.max.copy(O.max),ST.needsUpdate=!0),!0):!1,intersectsRange:(O,R)=>{if(i.boundsTree)return i.boundsTree.shapecast({boundsTraverseOrder:D=>ST.distanceToBox(D),intersectsBounds:(D,L,N)=>N<T&&N<l,intersectsRange:(D,L)=>{for(let N=D*3,U=(D+L)*3;N<U;N+=3){df(y,N,m,f),y.a.applyMatrix4(e),y.b.applyMatrix4(e),y.c.applyMatrix4(e),y.needsUpdate=!0;for(let F=O*3,z=(O+R)*3;F<z;F+=3){df(g,F,d,h),g.needsUpdate=!0;let G=g.distanceToTriangle(y,_,S);if(G<T&&(b.copy(_),E&&E.copy(S),T=G,A=F/3,P=N/3),G<n)return!0}}}});{let D=m?m.count:f.count;for(let L=0,N=D;L<N;L+=3){df(y,L,m,f),y.a.applyMatrix4(e),y.b.applyMatrix4(e),y.c.applyMatrix4(e),y.needsUpdate=!0;for(let U=O*3,F=(O+R)*3;U<F;U+=3){df(g,U,d,h),g.needsUpdate=!0;let z=g.distanceToTriangle(y,_,S);if(z<T&&(b.copy(_),E&&E.copy(S),T=z,A=U/3,P=L/3),z<n)return!0}}}}}),of.releasePrimitive(g),of.releasePrimitive(y),T===1/0?null:(t.point?t.point.copy(b):t.point=b.clone(),t.distance=T,t.faceIndex=A,r&&(r.point?r.point.copy(E):r.point=E.clone(),r.point.applyMatrix4(LS),b.applyMatrix4(LS),r.distance=b.sub(r.point).length(),r.faceIndex=P),t)}closestPointToPoint(i,e={},t=0,r=1/0){let n=t*t,l=r*r,c=1/0,h=null;if(this.shapecast({boundsTraverseOrder:f=>(MT.copy(i).clamp(f.min,f.max),MT.distanceToSquared(i)),intersectsBounds:(f,m,g)=>g<c&&g<l,intersectsTriangle:(f,m)=>{f.closestPointToPoint(i,MT);let g=i.distanceToSquared(MT);return g<c&&(AP.copy(MT),c=g,h=m),g<n}}),c===1/0)return null;let d=Math.sqrt(c);return e.point?e.point.copy(AP):e.point=AP.clone(),e.distance=d,e.faceIndex=h,e}getBoundingBox(i){return i.makeEmpty(),this._roots.forEach(e=>{mf(0,new Float32Array(e),_j),i.union(_j)}),i}},BD=new AE,xj=new ar,LCe=Sw.prototype.raycast;function OCe(i,e){if(this.geometry.boundsTree){if(this.material===void 0)return;xj.copy(this.matrixWorld).invert(),BD.copy(i.ray).applyMatrix4(xj);let t=this.geometry.boundsTree;if(i.firstHitOnly===!0){let r=vj(t.raycastFirst(BD,this.material),this,i);r&&e.push(r)}else{let r=t.raycast(BD,this.material);for(let n=0,l=r.length;n<l;n++){let c=vj(r[n],this,i);c&&e.push(c)}}}else LCe.call(this,i,e)}function NCe(i){return this.boundsTree=new sR(this,i),this.boundsTree}function DCe(){this.boundsTree=null}var kp=(i=>(i[i["#31E0B0"]=0]="#31E0B0",i[i["#FF5E10"]=1]="#FF5E10",i[i["#00ABF7"]=2]="#00ABF7",i[i["#FF00BB"]=3]="#FF00BB",i[i["#9C29FF"]=4]="#9C29FF",i[i["#6FDD00"]=5]="#6FDD00",i[i["#E30000"]=6]="#E30000",i[i["#304AFF"]=7]="#304AFF",i[i["#FF89C4"]=8]="#FF89C4",i[i["#D597FF"]=9]="#D597FF",i[i["#C6EC5C"]=10]="#C6EC5C",i[i["#FFA115"]=11]="#FFA115",i[i["#75DEFE"]=12]="#75DEFE",i[i["#FAA291"]=13]="#FAA291",i[i["#BB813F"]=14]="#BB813F",i[i["#F4CE00"]=15]="#F4CE00",i[i["#878291"]=16]="#878291",i))(kp||{}),fI=["#000000","#FFFFFF","#000000","#FFFFFF","#FFFFFF","#000000","#FFFFFF","#FFFFFF","#000000","#000000","#000000","#000000","#000000","#000000","#FFFFFF","#000000","#FFFFFF"],kCe=QB(lSe()),yU=class{constructor(i){this.debug=(0,kCe.default)(i)}log(i,...e){this.debug(i,...e)}};function bj(i,e){if(e===kSe)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),i;if(e===r4||e===oY){let t=i.getIndex();if(t===null){let c=[],h=i.getAttribute("position");if(h!==void 0){for(let d=0;d<h.count;d++)c.push(d);i.setIndex(c),t=i.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i}let r=t.count-2,n=[];if(e===r4)for(let c=1;c<=r;c++)n.push(t.getX(0)),n.push(t.getX(c)),n.push(t.getX(c+1));else for(let c=0;c<r;c++)c%2===0?(n.push(t.getX(c)),n.push(t.getX(c+1)),n.push(t.getX(c+2))):(n.push(t.getX(c+2)),n.push(t.getX(c+1)),n.push(t.getX(c)));n.length/3!==r&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let l=i.clone();return l.setIndex(n),l.clearGroups(),l}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),i}var FCe=class extends RE{constructor(i){super(i),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(e){return new $Ce(e)}),this.register(function(e){return new JCe(e)}),this.register(function(e){return new YCe(e)}),this.register(function(e){return new KCe(e)}),this.register(function(e){return new WCe(e)}),this.register(function(e){return new jCe(e)}),this.register(function(e){return new GCe(e)}),this.register(function(e){return new qCe(e)}),this.register(function(e){return new HCe(e)}),this.register(function(e){return new XCe(e)}),this.register(function(e){return new VCe(e)}),this.register(function(e){return new ZCe(e)}),this.register(function(e){return new BCe(e)}),this.register(function(e){return new QCe(e)}),this.register(function(e){return new e2e(e)})}load(i,e,t,r){let n=this,l;this.resourcePath!==""?l=this.resourcePath:this.path!==""?l=this.path:l=c4.extractUrlBase(i),this.manager.itemStart(i);let c=function(d){r?r(d):console.error(d),n.manager.itemError(i),n.manager.itemEnd(i)},h=new AY(this.manager);h.setPath(this.path),h.setResponseType("arraybuffer"),h.setRequestHeader(this.requestHeader),h.setWithCredentials(this.withCredentials),h.load(i,function(d){try{n.parse(d,l,function(f){e(f),n.manager.itemEnd(i)},c)}catch(f){c(f)}},t,c)}setDRACOLoader(i){return this.dracoLoader=i,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(i){return this.ktx2Loader=i,this}setMeshoptDecoder(i){return this.meshoptDecoder=i,this}register(i){return this.pluginCallbacks.indexOf(i)===-1&&this.pluginCallbacks.push(i),this}unregister(i){return this.pluginCallbacks.indexOf(i)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(i),1),this}parse(i,e,t,r){let n,l={},c={},h=new TextDecoder;if(typeof i=="string")n=JSON.parse(i);else if(i instanceof ArrayBuffer)if(h.decode(new Uint8Array(i,0,4))===IY){try{l[$r.KHR_BINARY_GLTF]=new t2e(i)}catch(f){r&&r(f);return}n=JSON.parse(l[$r.KHR_BINARY_GLTF].content)}else n=JSON.parse(h.decode(i));else n=i;if(n.asset===void 0||n.asset.version[0]<2){r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}let d=new p2e(n,{path:e||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});d.fileLoader.setRequestHeader(this.requestHeader);for(let f=0;f<this.pluginCallbacks.length;f++){let m=this.pluginCallbacks[f](d);c[m.name]=m,l[m.name]=!0}if(n.extensionsUsed)for(let f=0;f<n.extensionsUsed.length;++f){let m=n.extensionsUsed[f],g=n.extensionsRequired||[];switch(m){case $r.KHR_MATERIALS_UNLIT:l[m]=new UCe;break;case $r.KHR_DRACO_MESH_COMPRESSION:l[m]=new i2e(n,this.dracoLoader);break;case $r.KHR_TEXTURE_TRANSFORM:l[m]=new r2e;break;case $r.KHR_MESH_QUANTIZATION:l[m]=new n2e;break;default:g.indexOf(m)>=0&&c[m]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+m+'".')}}d.setExtensions(l),d.setPlugins(c),d.parse(t,r)}parseAsync(i,e){let t=this;return new Promise(function(r,n){t.parse(i,e,r,n)})}};function zCe(){let i={};return{get:function(e){return i[e]},add:function(e,t){i[e]=t},remove:function(e){delete i[e]},removeAll:function(){i={}}}}var $r={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"},BCe=class{constructor(i){this.parser=i,this.name=$r.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){let i=this.parser,e=this.parser.json.nodes||[];for(let t=0,r=e.length;t<r;t++){let n=e[t];n.extensions&&n.extensions[this.name]&&n.extensions[this.name].light!==void 0&&i._addNodeRef(this.cache,n.extensions[this.name].light)}}_loadLight(i){let e=this.parser,t="light:"+i,r=e.cache.get(t);if(r)return r;let n=e.json,l=((n.extensions&&n.extensions[this.name]||{}).lights||[])[i],c,h=new Tr(16777215);l.color!==void 0&&h.setRGB(l.color[0],l.color[1],l.color[2],Kd);let d=l.range!==void 0?l.range:0;switch(l.type){case"directional":c=new GAe(h),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new WAe(h),c.distance=d;break;case"spot":c=new $Ae(h),c.distance=d,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,wm(c,l),l.intensity!==void 0&&(c.intensity=l.intensity),c.name=e.createUniqueName(l.name||"light_"+i),r=Promise.resolve(c),e.cache.add(t,r),r}getDependency(i,e){if(i==="light")return this._loadLight(e)}createNodeAttachment(i){let e=this,t=this.parser,r=t.json.nodes[i],n=(r.extensions&&r.extensions[this.name]||{}).light;return n===void 0?null:this._loadLight(n).then(function(l){return t._getNodeRef(e.cache,n,l)})}},UCe=class{constructor(){this.name=$r.KHR_MATERIALS_UNLIT}getMaterialType(){return U1}extendParams(i,e,t){let r=[];i.color=new Tr(1,1,1),i.opacity=1;let n=e.pbrMetallicRoughness;if(n){if(Array.isArray(n.baseColorFactor)){let l=n.baseColorFactor;i.color.setRGB(l[0],l[1],l[2],Kd),i.opacity=l[3]}n.baseColorTexture!==void 0&&r.push(t.assignTexture(i,"map",n.baseColorTexture,bo))}return Promise.all(r)}},HCe=class{constructor(i){this.parser=i,this.name=$r.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(i,e){let t=this.parser.json.materials[i];if(!t.extensions||!t.extensions[this.name])return Promise.resolve();let r=t.extensions[this.name].emissiveStrength;return r!==void 0&&(e.emissiveIntensity=r),Promise.resolve()}},$Ce=class{constructor(i){this.parser=i,this.name=$r.KHR_MATERIALS_CLEARCOAT}getMaterialType(i){let e=this.parser.json.materials[i];return!e.extensions||!e.extensions[this.name]?null:ag}extendMaterialParams(i,e){let t=this.parser,r=t.json.materials[i];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let n=[],l=r.extensions[this.name];if(l.clearcoatFactor!==void 0&&(e.clearcoat=l.clearcoatFactor),l.clearcoatTexture!==void 0&&n.push(t.assignTexture(e,"clearcoatMap",l.clearcoatTexture)),l.clearcoatRoughnessFactor!==void 0&&(e.clearcoatRoughness=l.clearcoatRoughnessFactor),l.clearcoatRoughnessTexture!==void 0&&n.push(t.assignTexture(e,"clearcoatRoughnessMap",l.clearcoatRoughnessTexture)),l.clearcoatNormalTexture!==void 0&&(n.push(t.assignTexture(e,"clearcoatNormalMap",l.clearcoatNormalTexture)),l.clearcoatNormalTexture.scale!==void 0)){let c=l.clearcoatNormalTexture.scale;e.clearcoatNormalScale=new mi(c,c)}return Promise.all(n)}},VCe=class{constructor(i){this.parser=i,this.name=$r.KHR_MATERIALS_IRIDESCENCE}getMaterialType(i){let e=this.parser.json.materials[i];return!e.extensions||!e.extensions[this.name]?null:ag}extendMaterialParams(i,e){let t=this.parser,r=t.json.materials[i];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let n=[],l=r.extensions[this.name];return l.iridescenceFactor!==void 0&&(e.iridescence=l.iridescenceFactor),l.iridescenceTexture!==void 0&&n.push(t.assignTexture(e,"iridescenceMap",l.iridescenceTexture)),l.iridescenceIor!==void 0&&(e.iridescenceIOR=l.iridescenceIor),e.iridescenceThicknessRange===void 0&&(e.iridescenceThicknessRange=[100,400]),l.iridescenceThicknessMinimum!==void 0&&(e.iridescenceThicknessRange[0]=l.iridescenceThicknessMinimum),l.iridescenceThicknessMaximum!==void 0&&(e.iridescenceThicknessRange[1]=l.iridescenceThicknessMaximum),l.iridescenceThicknessTexture!==void 0&&n.push(t.assignTexture(e,"iridescenceThicknessMap",l.iridescenceThicknessTexture)),Promise.all(n)}},WCe=class{constructor(i){this.parser=i,this.name=$r.KHR_MATERIALS_SHEEN}getMaterialType(i){let e=this.parser.json.materials[i];return!e.extensions||!e.extensions[this.name]?null:ag}extendMaterialParams(i,e){let t=this.parser,r=t.json.materials[i];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let n=[];e.sheenColor=new Tr(0,0,0),e.sheenRoughness=0,e.sheen=1;let l=r.extensions[this.name];if(l.sheenColorFactor!==void 0){let c=l.sheenColorFactor;e.sheenColor.setRGB(c[0],c[1],c[2],Kd)}return l.sheenRoughnessFactor!==void 0&&(e.sheenRoughness=l.sheenRoughnessFactor),l.sheenColorTexture!==void 0&&n.push(t.assignTexture(e,"sheenColorMap",l.sheenColorTexture,bo)),l.sheenRoughnessTexture!==void 0&&n.push(t.assignTexture(e,"sheenRoughnessMap",l.sheenRoughnessTexture)),Promise.all(n)}},jCe=class{constructor(i){this.parser=i,this.name=$r.KHR_MATERIALS_TRANSMISSION}getMaterialType(i){let e=this.parser.json.materials[i];return!e.extensions||!e.extensions[this.name]?null:ag}extendMaterialParams(i,e){let t=this.parser,r=t.json.materials[i];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let n=[],l=r.extensions[this.name];return l.transmissionFactor!==void 0&&(e.transmission=l.transmissionFactor),l.transmissionTexture!==void 0&&n.push(t.assignTexture(e,"transmissionMap",l.transmissionTexture)),Promise.all(n)}},GCe=class{constructor(i){this.parser=i,this.name=$r.KHR_MATERIALS_VOLUME}getMaterialType(i){let e=this.parser.json.materials[i];return!e.extensions||!e.extensions[this.name]?null:ag}extendMaterialParams(i,e){let t=this.parser,r=t.json.materials[i];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let n=[],l=r.extensions[this.name];e.thickness=l.thicknessFactor!==void 0?l.thicknessFactor:0,l.thicknessTexture!==void 0&&n.push(t.assignTexture(e,"thicknessMap",l.thicknessTexture)),e.attenuationDistance=l.attenuationDistance||1/0;let c=l.attenuationColor||[1,1,1];return e.attenuationColor=new Tr().setRGB(c[0],c[1],c[2],Kd),Promise.all(n)}},qCe=class{constructor(i){this.parser=i,this.name=$r.KHR_MATERIALS_IOR}getMaterialType(i){let e=this.parser.json.materials[i];return!e.extensions||!e.extensions[this.name]?null:ag}extendMaterialParams(i,e){let t=this.parser.json.materials[i];if(!t.extensions||!t.extensions[this.name])return Promise.resolve();let r=t.extensions[this.name];return e.ior=r.ior!==void 0?r.ior:1.5,Promise.resolve()}},XCe=class{constructor(i){this.parser=i,this.name=$r.KHR_MATERIALS_SPECULAR}getMaterialType(i){let e=this.parser.json.materials[i];return!e.extensions||!e.extensions[this.name]?null:ag}extendMaterialParams(i,e){let t=this.parser,r=t.json.materials[i];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let n=[],l=r.extensions[this.name];e.specularIntensity=l.specularFactor!==void 0?l.specularFactor:1,l.specularTexture!==void 0&&n.push(t.assignTexture(e,"specularIntensityMap",l.specularTexture));let c=l.specularColorFactor||[1,1,1];return e.specularColor=new Tr().setRGB(c[0],c[1],c[2],Kd),l.specularColorTexture!==void 0&&n.push(t.assignTexture(e,"specularColorMap",l.specularColorTexture,bo)),Promise.all(n)}},ZCe=class{constructor(i){this.parser=i,this.name=$r.KHR_MATERIALS_ANISOTROPY}getMaterialType(i){let e=this.parser.json.materials[i];return!e.extensions||!e.extensions[this.name]?null:ag}extendMaterialParams(i,e){let t=this.parser,r=t.json.materials[i];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let n=[],l=r.extensions[this.name];return l.anisotropyStrength!==void 0&&(e.anisotropy=l.anisotropyStrength),l.anisotropyRotation!==void 0&&(e.anisotropyRotation=l.anisotropyRotation),l.anisotropyTexture!==void 0&&n.push(t.assignTexture(e,"anisotropyMap",l.anisotropyTexture)),Promise.all(n)}},JCe=class{constructor(i){this.parser=i,this.name=$r.KHR_TEXTURE_BASISU}loadTexture(i){let e=this.parser,t=e.json,r=t.textures[i];if(!r.extensions||!r.extensions[this.name])return null;let n=r.extensions[this.name],l=e.options.ktx2Loader;if(!l){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return e.loadTextureImage(i,n.source,l)}},YCe=class{constructor(i){this.parser=i,this.name=$r.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(i){let e=this.name,t=this.parser,r=t.json,n=r.textures[i];if(!n.extensions||!n.extensions[e])return null;let l=n.extensions[e],c=r.images[l.source],h=t.textureLoader;if(c.uri){let d=t.options.manager.getHandler(c.uri);d!==null&&(h=d)}return this.detectSupport().then(function(d){if(d)return t.loadTextureImage(i,l.source,h);if(r.extensionsRequired&&r.extensionsRequired.indexOf(e)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return t.loadTexture(i)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(i){let e=new Image;e.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",e.onload=e.onerror=function(){i(e.height===1)}})),this.isSupported}},KCe=class{constructor(i){this.parser=i,this.name=$r.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(i){let e=this.name,t=this.parser,r=t.json,n=r.textures[i];if(!n.extensions||!n.extensions[e])return null;let l=n.extensions[e],c=r.images[l.source],h=t.textureLoader;if(c.uri){let d=t.options.manager.getHandler(c.uri);d!==null&&(h=d)}return this.detectSupport().then(function(d){if(d)return t.loadTextureImage(i,l.source,h);if(r.extensionsRequired&&r.extensionsRequired.indexOf(e)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return t.loadTexture(i)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(i){let e=new Image;e.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",e.onload=e.onerror=function(){i(e.height===1)}})),this.isSupported}},QCe=class{constructor(i){this.name=$r.EXT_MESHOPT_COMPRESSION,this.parser=i}loadBufferView(i){let e=this.parser.json,t=e.bufferViews[i];if(t.extensions&&t.extensions[this.name]){let r=t.extensions[this.name],n=this.parser.getDependency("buffer",r.buffer),l=this.parser.options.meshoptDecoder;if(!l||!l.supported){if(e.extensionsRequired&&e.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return n.then(function(c){let h=r.byteOffset||0,d=r.byteLength||0,f=r.count,m=r.byteStride,g=new Uint8Array(c,h,d);return l.decodeGltfBufferAsync?l.decodeGltfBufferAsync(f,m,g,r.mode,r.filter).then(function(y){return y.buffer}):l.ready.then(function(){let y=new ArrayBuffer(f*m);return l.decodeGltfBuffer(new Uint8Array(y),f,m,g,r.mode,r.filter),y})})}else return null}},e2e=class{constructor(i){this.name=$r.EXT_MESH_GPU_INSTANCING,this.parser=i}createNodeMesh(i){let e=this.parser.json,t=e.nodes[i];if(!t.extensions||!t.extensions[this.name]||t.mesh===void 0)return null;let r=e.meshes[t.mesh];for(let h of r.primitives)if(h.mode!==Zu.TRIANGLES&&h.mode!==Zu.TRIANGLE_STRIP&&h.mode!==Zu.TRIANGLE_FAN&&h.mode!==void 0)return null;let n=t.extensions[this.name].attributes,l=[],c={};for(let h in n)l.push(this.parser.getDependency("accessor",n[h]).then(d=>(c[h]=d,c[h])));return l.length<1?null:(l.push(this.parser.createNodeMesh(i)),Promise.all(l).then(h=>{let d=h.pop(),f=d.isGroup?d.children:[d],m=h[0].count,g=[];for(let y of f){let _=new ar,b=new Se,S=new pu,E=new Se(1,1,1),T=new hAe(y.geometry,y.material,m);for(let A=0;A<m;A++)c.TRANSLATION&&b.fromBufferAttribute(c.TRANSLATION,A),c.ROTATION&&S.fromBufferAttribute(c.ROTATION,A),c.SCALE&&E.fromBufferAttribute(c.SCALE,A),T.setMatrixAt(A,_.compose(b,S,E));for(let A in c)A!=="TRANSLATION"&&A!=="ROTATION"&&A!=="SCALE"&&y.geometry.setAttribute(A,c[A]);Wn.prototype.copy.call(T,y),this.parser.assignFinalMaterial(T),g.push(T)}return d.isGroup?(d.clear(),d.add(...g),d):g[0]}))}},IY="glTF",ET=12,wj={JSON:1313821514,BIN:5130562},t2e=class{constructor(i){this.name=$r.KHR_BINARY_GLTF,this.content=null,this.body=null;let e=new DataView(i,0,ET),t=new TextDecoder;if(this.header={magic:t.decode(new Uint8Array(i.slice(0,4))),version:e.getUint32(4,!0),length:e.getUint32(8,!0)},this.header.magic!==IY)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");let r=this.header.length-ET,n=new DataView(i,ET),l=0;for(;l<r;){let c=n.getUint32(l,!0);l+=4;let h=n.getUint32(l,!0);if(l+=4,h===wj.JSON){let d=new Uint8Array(i,ET+l,c);this.content=t.decode(d)}else if(h===wj.BIN){let d=ET+l;this.body=i.slice(d,d+c)}l+=c}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}},i2e=class{constructor(i,e){if(!e)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=$r.KHR_DRACO_MESH_COMPRESSION,this.json=i,this.dracoLoader=e,this.dracoLoader.preload()}decodePrimitive(i,e){let t=this.json,r=this.dracoLoader,n=i.extensions[this.name].bufferView,l=i.extensions[this.name].attributes,c={},h={},d={};for(let f in l){let m=m4[f]||f.toLowerCase();c[m]=l[f]}for(let f in i.attributes){let m=m4[f]||f.toLowerCase();if(l[f]!==void 0){let g=t.accessors[i.attributes[f]],y=SM[g.componentType];d[m]=y.name,h[m]=g.normalized===!0}}return e.getDependency("bufferView",n).then(function(f){return new Promise(function(m){r.decodeDracoFile(f,function(g){for(let y in g.attributes){let _=g.attributes[y],b=h[y];b!==void 0&&(_.normalized=b)}m(g)},c,d)})})}},r2e=class{constructor(){this.name=$r.KHR_TEXTURE_TRANSFORM}extendTexture(i,e){return(e.texCoord===void 0||e.texCoord===i.channel)&&e.offset===void 0&&e.rotation===void 0&&e.scale===void 0||(i=i.clone(),e.texCoord!==void 0&&(i.channel=e.texCoord),e.offset!==void 0&&i.offset.fromArray(e.offset),e.rotation!==void 0&&(i.rotation=e.rotation),e.scale!==void 0&&i.repeat.fromArray(e.scale),i.needsUpdate=!0),i}},n2e=class{constructor(){this.name=$r.KHR_MESH_QUANTIZATION}},LY=class extends zC{constructor(i,e,t,r){super(i,e,t,r)}copySampleValue_(i){let e=this.resultBuffer,t=this.sampleValues,r=this.valueSize,n=i*r*3+r;for(let l=0;l!==r;l++)e[l]=t[n+l];return e}interpolate_(i,e,t,r){let n=this.resultBuffer,l=this.sampleValues,c=this.valueSize,h=c*2,d=c*3,f=r-e,m=(t-e)/f,g=m*m,y=g*m,_=i*d,b=_-d,S=-2*y+3*g,E=y-g,T=1-S,A=E-g+m;for(let P=0;P!==c;P++){let O=l[b+P+c],R=l[b+P+h]*f,D=l[_+P+c],L=l[_+P]*f;n[P]=T*O+A*R+S*D+E*L}return n}},s2e=new pu,a2e=class extends LY{interpolate_(i,e,t,r){let n=super.interpolate_(i,e,t,r);return s2e.fromArray(n).normalize().toArray(n),n}},Zu={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},SM={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Sj={9728:dw,9729:xL,9984:CSe,9985:RSe,9986:PSe,9987:iU},Mj={33071:z1,33648:i4,10497:iC},UD={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},m4={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},mm={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},o2e={CUBICSPLINE:void 0,LINEAR:YM,STEP:rC},HD={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function l2e(i){return i.DefaultMaterial===void 0&&(i.DefaultMaterial=new hU({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:JM})),i.DefaultMaterial}function _1(i,e,t){for(let r in t.extensions)i[r]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[r]=t.extensions[r])}function wm(i,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(i.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function u2e(i,e,t){let r=!1,n=!1,l=!1;for(let f=0,m=e.length;f<m;f++){let g=e[f];if(g.POSITION!==void 0&&(r=!0),g.NORMAL!==void 0&&(n=!0),g.COLOR_0!==void 0&&(l=!0),r&&n&&l)break}if(!r&&!n&&!l)return Promise.resolve(i);let c=[],h=[],d=[];for(let f=0,m=e.length;f<m;f++){let g=e[f];if(r){let y=g.POSITION!==void 0?t.getDependency("accessor",g.POSITION):i.attributes.position;c.push(y)}if(n){let y=g.NORMAL!==void 0?t.getDependency("accessor",g.NORMAL):i.attributes.normal;h.push(y)}if(l){let y=g.COLOR_0!==void 0?t.getDependency("accessor",g.COLOR_0):i.attributes.color;d.push(y)}}return Promise.all([Promise.all(c),Promise.all(h),Promise.all(d)]).then(function(f){let m=f[0],g=f[1],y=f[2];return r&&(i.morphAttributes.position=m),n&&(i.morphAttributes.normal=g),l&&(i.morphAttributes.color=y),i.morphTargetsRelative=!0,i})}function c2e(i,e){if(i.updateMorphTargets(),e.weights!==void 0)for(let t=0,r=e.weights.length;t<r;t++)i.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){let t=e.extras.targetNames;if(i.morphTargetInfluences.length===t.length){i.morphTargetDictionary={};for(let r=0,n=t.length;r<n;r++)i.morphTargetDictionary[t[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function h2e(i){let e,t=i.extensions&&i.extensions[$r.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+$D(t.attributes):e=i.indices+":"+$D(i.attributes)+":"+i.mode,i.targets!==void 0)for(let r=0,n=i.targets.length;r<n;r++)e+=":"+$D(i.targets[r]);return e}function $D(i){let e="",t=Object.keys(i).sort();for(let r=0,n=t.length;r<n;r++)e+=t[r]+":"+i[t[r]]+";";return e}function g4(i){switch(i){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function d2e(i){return i.search(/\.jpe?g($|\?)/i)>0||i.search(/^data\:image\/jpeg/)===0?"image/jpeg":i.search(/\.webp($|\?)/i)>0||i.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}var f2e=new ar,p2e=class{constructor(i={},e={}){this.json=i,this.extensions={},this.plugins={},this.options=e,this.cache=new zCe,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let t=!1,r=!1,n=-1;typeof navigator<"u"&&(t=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,r=navigator.userAgent.indexOf("Firefox")>-1,n=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||t||r&&n<98?this.textureLoader=new CY(this.options.manager):this.textureLoader=new qAe(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new AY(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(i){this.extensions=i}setPlugins(i){this.plugins=i}parse(i,e){let t=this,r=this.json,n=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(l){return l._markDefs&&l._markDefs()}),Promise.all(this._invokeAll(function(l){return l.beforeRoot&&l.beforeRoot()})).then(function(){return Promise.all([t.getDependencies("scene"),t.getDependencies("animation"),t.getDependencies("camera")])}).then(function(l){let c={scene:l[0][r.scene||0],scenes:l[0],animations:l[1],cameras:l[2],asset:r.asset,parser:t,userData:{}};return _1(n,c,r),wm(c,r),Promise.all(t._invokeAll(function(h){return h.afterRoot&&h.afterRoot(c)})).then(function(){i(c)})}).catch(e)}_markDefs(){let i=this.json.nodes||[],e=this.json.skins||[],t=this.json.meshes||[];for(let r=0,n=e.length;r<n;r++){let l=e[r].joints;for(let c=0,h=l.length;c<h;c++)i[l[c]].isBone=!0}for(let r=0,n=i.length;r<n;r++){let l=i[r];l.mesh!==void 0&&(this._addNodeRef(this.meshCache,l.mesh),l.skin!==void 0&&(t[l.mesh].isSkinnedMesh=!0)),l.camera!==void 0&&this._addNodeRef(this.cameraCache,l.camera)}}_addNodeRef(i,e){e!==void 0&&(i.refs[e]===void 0&&(i.refs[e]=i.uses[e]=0),i.refs[e]++)}_getNodeRef(i,e,t){if(i.refs[e]<=1)return t;let r=t.clone(),n=(l,c)=>{let h=this.associations.get(l);h!=null&&this.associations.set(c,h);for(let[d,f]of l.children.entries())n(f,c.children[d])};return n(t,r),r.name+="_instance_"+i.uses[e]++,r}_invokeOne(i){let e=Object.values(this.plugins);e.push(this);for(let t=0;t<e.length;t++){let r=i(e[t]);if(r)return r}return null}_invokeAll(i){let e=Object.values(this.plugins);e.unshift(this);let t=[];for(let r=0;r<e.length;r++){let n=i(e[r]);n&&t.push(n)}return t}getDependency(i,e){let t=i+":"+e,r=this.cache.get(t);if(!r){switch(i){case"scene":r=this.loadScene(e);break;case"node":r=this._invokeOne(function(n){return n.loadNode&&n.loadNode(e)});break;case"mesh":r=this._invokeOne(function(n){return n.loadMesh&&n.loadMesh(e)});break;case"accessor":r=this.loadAccessor(e);break;case"bufferView":r=this._invokeOne(function(n){return n.loadBufferView&&n.loadBufferView(e)});break;case"buffer":r=this.loadBuffer(e);break;case"material":r=this._invokeOne(function(n){return n.loadMaterial&&n.loadMaterial(e)});break;case"texture":r=this._invokeOne(function(n){return n.loadTexture&&n.loadTexture(e)});break;case"skin":r=this.loadSkin(e);break;case"animation":r=this._invokeOne(function(n){return n.loadAnimation&&n.loadAnimation(e)});break;case"camera":r=this.loadCamera(e);break;default:if(r=this._invokeOne(function(n){return n!=this&&n.getDependency&&n.getDependency(i,e)}),!r)throw new Error("Unknown type: "+i);break}this.cache.add(t,r)}return r}getDependencies(i){let e=this.cache.get(i);if(!e){let t=this,r=this.json[i+(i==="mesh"?"es":"s")]||[];e=Promise.all(r.map(function(n,l){return t.getDependency(i,l)})),this.cache.add(i,e)}return e}loadBuffer(i){let e=this.json.buffers[i],t=this.fileLoader;if(e.type&&e.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+e.type+" buffer type is not supported.");if(e.uri===void 0&&i===0)return Promise.resolve(this.extensions[$r.KHR_BINARY_GLTF].body);let r=this.options;return new Promise(function(n,l){t.load(c4.resolveURL(e.uri,r.path),n,void 0,function(){l(new Error('THREE.GLTFLoader: Failed to load buffer "'+e.uri+'".'))})})}loadBufferView(i){let e=this.json.bufferViews[i];return this.getDependency("buffer",e.buffer).then(function(t){let r=e.byteLength||0,n=e.byteOffset||0;return t.slice(n,n+r)})}loadAccessor(i){let e=this,t=this.json,r=this.json.accessors[i];if(r.bufferView===void 0&&r.sparse===void 0){let l=UD[r.type],c=SM[r.componentType],h=r.normalized===!0,d=new c(r.count*l);return Promise.resolve(new zu(d,l,h))}let n=[];return r.bufferView!==void 0?n.push(this.getDependency("bufferView",r.bufferView)):n.push(null),r.sparse!==void 0&&(n.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),n.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(n).then(function(l){let c=l[0],h=UD[r.type],d=SM[r.componentType],f=d.BYTES_PER_ELEMENT,m=f*h,g=r.byteOffset||0,y=r.bufferView!==void 0?t.bufferViews[r.bufferView].byteStride:void 0,_=r.normalized===!0,b,S;if(y&&y!==m){let E=Math.floor(g/y),T="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+E+":"+r.count,A=e.cache.get(T);A||(b=new d(c,E*y,r.count*y/f),A=new fY(b,y/f),e.cache.add(T,A)),S=new uI(A,h,g%y/f,_)}else c===null?b=new d(r.count*h):b=new d(c,g,r.count*h),S=new zu(b,h,_);if(r.sparse!==void 0){let E=UD.SCALAR,T=SM[r.sparse.indices.componentType],A=r.sparse.indices.byteOffset||0,P=r.sparse.values.byteOffset||0,O=new T(l[1],A,r.sparse.count*E),R=new d(l[2],P,r.sparse.count*h);c!==null&&(S=new zu(S.array.slice(),S.itemSize,S.normalized));for(let D=0,L=O.length;D<L;D++){let N=O[D];if(S.setX(N,R[D*h]),h>=2&&S.setY(N,R[D*h+1]),h>=3&&S.setZ(N,R[D*h+2]),h>=4&&S.setW(N,R[D*h+3]),h>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return S})}loadTexture(i){let e=this.json,t=this.options,r=e.textures[i].source,n=e.images[r],l=this.textureLoader;if(n.uri){let c=t.manager.getHandler(n.uri);c!==null&&(l=c)}return this.loadTextureImage(i,r,l)}loadTextureImage(i,e,t){let r=this,n=this.json,l=n.textures[i],c=n.images[e],h=(c.uri||c.bufferView)+":"+l.sampler;if(this.textureCache[h])return this.textureCache[h];let d=this.loadImageSource(e,t).then(function(f){f.flipY=!1,f.name=l.name||c.name||"",f.name===""&&typeof c.uri=="string"&&c.uri.startsWith("data:image/")===!1&&(f.name=c.uri);let m=(n.samplers||{})[l.sampler]||{};return f.magFilter=Sj[m.magFilter]||xL,f.minFilter=Sj[m.minFilter]||iU,f.wrapS=Mj[m.wrapS]||iC,f.wrapT=Mj[m.wrapT]||iC,r.associations.set(f,{textures:i}),f}).catch(function(){return null});return this.textureCache[h]=d,d}loadImageSource(i,e){let t=this,r=this.json,n=this.options;if(this.sourceCache[i]!==void 0)return this.sourceCache[i].then(m=>m.clone());let l=r.images[i],c=self.URL||self.webkitURL,h=l.uri||"",d=!1;if(l.bufferView!==void 0)h=t.getDependency("bufferView",l.bufferView).then(function(m){d=!0;let g=new Blob([m],{type:l.mimeType});return h=c.createObjectURL(g),h});else if(l.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+i+" is missing URI and bufferView");let f=Promise.resolve(h).then(function(m){return new Promise(function(g,y){let _=g;e.isImageBitmapLoader===!0&&(_=function(b){let S=new Eo(b);S.needsUpdate=!0,g(S)}),e.load(c4.resolveURL(m,n.path),_,void 0,y)})}).then(function(m){return d===!0&&c.revokeObjectURL(h),m.userData.mimeType=l.mimeType||d2e(l.uri),m}).catch(function(m){throw console.error("THREE.GLTFLoader: Couldn't load texture",h),m});return this.sourceCache[i]=f,f}assignTexture(i,e,t,r){let n=this;return this.getDependency("texture",t.index).then(function(l){if(!l)return null;if(t.texCoord!==void 0&&t.texCoord>0&&(l=l.clone(),l.channel=t.texCoord),n.extensions[$r.KHR_TEXTURE_TRANSFORM]){let c=t.extensions!==void 0?t.extensions[$r.KHR_TEXTURE_TRANSFORM]:void 0;if(c){let h=n.associations.get(l);l=n.extensions[$r.KHR_TEXTURE_TRANSFORM].extendTexture(l,c),n.associations.set(l,h)}}return r!==void 0&&(l.colorSpace=r),i[e]=l,l})}assignFinalMaterial(i){let e=i.geometry,t=i.material,r=e.attributes.tangent===void 0,n=e.attributes.color!==void 0,l=e.attributes.normal===void 0;if(i.isPoints){let c="PointsMaterial:"+t.uuid,h=this.cache.get(c);h||(h=new _Y,Wm.prototype.copy.call(h,t),h.color.copy(t.color),h.map=t.map,h.sizeAttenuation=!1,this.cache.add(c,h)),t=h}else if(i.isLine){let c="LineBasicMaterial:"+t.uuid,h=this.cache.get(c);h||(h=new yY,Wm.prototype.copy.call(h,t),h.color.copy(t.color),h.map=t.map,this.cache.add(c,h)),t=h}if(r||n||l){let c="ClonedMaterial:"+t.uuid+":";r&&(c+="derivative-tangents:"),n&&(c+="vertex-colors:"),l&&(c+="flat-shading:");let h=this.cache.get(c);h||(h=t.clone(),n&&(h.vertexColors=!0),l&&(h.flatShading=!0),r&&(h.normalScale&&(h.normalScale.y*=-1),h.clearcoatNormalScale&&(h.clearcoatNormalScale.y*=-1)),this.cache.add(c,h),this.associations.set(h,this.associations.get(t))),t=h}i.material=t}getMaterialType(){return hU}loadMaterial(i){let e=this,t=this.json,r=this.extensions,n=t.materials[i],l,c={},h=n.extensions||{},d=[];if(h[$r.KHR_MATERIALS_UNLIT]){let m=r[$r.KHR_MATERIALS_UNLIT];l=m.getMaterialType(),d.push(m.extendParams(c,n,e))}else{let m=n.pbrMetallicRoughness||{};if(c.color=new Tr(1,1,1),c.opacity=1,Array.isArray(m.baseColorFactor)){let g=m.baseColorFactor;c.color.setRGB(g[0],g[1],g[2],Kd),c.opacity=g[3]}m.baseColorTexture!==void 0&&d.push(e.assignTexture(c,"map",m.baseColorTexture,bo)),c.metalness=m.metallicFactor!==void 0?m.metallicFactor:1,c.roughness=m.roughnessFactor!==void 0?m.roughnessFactor:1,m.metallicRoughnessTexture!==void 0&&(d.push(e.assignTexture(c,"metalnessMap",m.metallicRoughnessTexture)),d.push(e.assignTexture(c,"roughnessMap",m.metallicRoughnessTexture))),l=this._invokeOne(function(g){return g.getMaterialType&&g.getMaterialType(i)}),d.push(Promise.all(this._invokeAll(function(g){return g.extendMaterialParams&&g.extendMaterialParams(i,c)})))}n.doubleSided===!0&&(c.side=tU);let f=n.alphaMode||HD.OPAQUE;if(f===HD.BLEND?(c.transparent=!0,c.depthWrite=!1):(c.transparent=!1,f===HD.MASK&&(c.alphaTest=n.alphaCutoff!==void 0?n.alphaCutoff:.5)),n.normalTexture!==void 0&&l!==U1&&(d.push(e.assignTexture(c,"normalMap",n.normalTexture)),c.normalScale=new mi(1,1),n.normalTexture.scale!==void 0)){let m=n.normalTexture.scale;c.normalScale.set(m,m)}if(n.occlusionTexture!==void 0&&l!==U1&&(d.push(e.assignTexture(c,"aoMap",n.occlusionTexture)),n.occlusionTexture.strength!==void 0&&(c.aoMapIntensity=n.occlusionTexture.strength)),n.emissiveFactor!==void 0&&l!==U1){let m=n.emissiveFactor;c.emissive=new Tr().setRGB(m[0],m[1],m[2],Kd)}return n.emissiveTexture!==void 0&&l!==U1&&d.push(e.assignTexture(c,"emissiveMap",n.emissiveTexture,bo)),Promise.all(d).then(function(){let m=new l(c);return n.name&&(m.name=n.name),wm(m,n),e.associations.set(m,{materials:i}),n.extensions&&_1(r,m,n),m})}createUniqueName(i){let e=mn.sanitizeNodeName(i||"");return e in this.nodeNamesUsed?e+"_"+ ++this.nodeNamesUsed[e]:(this.nodeNamesUsed[e]=0,e)}loadGeometries(i){let e=this,t=this.extensions,r=this.primitiveCache;function n(c){return t[$r.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(c,e).then(function(h){return Ej(h,c,e)})}let l=[];for(let c=0,h=i.length;c<h;c++){let d=i[c],f=h2e(d),m=r[f];if(m)l.push(m.promise);else{let g;d.extensions&&d.extensions[$r.KHR_DRACO_MESH_COMPRESSION]?g=n(d):g=Ej(new Op,d,e),r[f]={primitive:d,promise:g},l.push(g)}}return Promise.all(l)}loadMesh(i){let e=this,t=this.json,r=this.extensions,n=t.meshes[i],l=n.primitives,c=[];for(let h=0,d=l.length;h<d;h++){let f=l[h].material===void 0?l2e(this.cache):this.getDependency("material",l[h].material);c.push(f)}return c.push(e.loadGeometries(l)),Promise.all(c).then(function(h){let d=h.slice(0,h.length-1),f=h[h.length-1],m=[];for(let y=0,_=f.length;y<_;y++){let b=f[y],S=l[y],E,T=d[y];if(S.mode===Zu.TRIANGLES||S.mode===Zu.TRIANGLE_STRIP||S.mode===Zu.TRIANGLE_FAN||S.mode===void 0)E=n.isSkinnedMesh===!0?new oAe(b,T):new Sw(b,T),E.isSkinnedMesh===!0&&E.normalizeSkinWeights(),S.mode===Zu.TRIANGLE_STRIP?E.geometry=bj(E.geometry,oY):S.mode===Zu.TRIANGLE_FAN&&(E.geometry=bj(E.geometry,r4));else if(S.mode===Zu.LINES)E=new dAe(b,T);else if(S.mode===Zu.LINE_STRIP)E=new uU(b,T);else if(S.mode===Zu.LINE_LOOP)E=new fAe(b,T);else if(S.mode===Zu.POINTS)E=new pAe(b,T);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+S.mode);Object.keys(E.geometry.morphAttributes).length>0&&c2e(E,n),E.name=e.createUniqueName(n.name||"mesh_"+i),wm(E,n),S.extensions&&_1(r,E,S),e.assignFinalMaterial(E),m.push(E)}for(let y=0,_=m.length;y<_;y++)e.associations.set(m[y],{meshes:i,primitives:y});if(m.length===1)return n.extensions&&_1(r,m[0],n),m[0];let g=new ED;n.extensions&&_1(r,g,n),e.associations.set(g,{meshes:i});for(let y=0,_=m.length;y<_;y++)g.add(m[y]);return g})}loadCamera(i){let e,t=this.json.cameras[i],r=t[t.type];if(!r){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return t.type==="perspective"?e=new aU(iMe.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):t.type==="orthographic"&&(e=new oU(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),t.name&&(e.name=this.createUniqueName(t.name)),wm(e,t),Promise.resolve(e)}loadSkin(i){let e=this.json.skins[i],t=[];for(let r=0,n=e.joints.length;r<n;r++)t.push(this._loadNodeShallow(e.joints[r]));return e.inverseBindMatrices!==void 0?t.push(this.getDependency("accessor",e.inverseBindMatrices)):t.push(null),Promise.all(t).then(function(r){let n=r.pop(),l=r,c=[],h=[];for(let d=0,f=l.length;d<f;d++){let m=l[d];if(m){c.push(m);let g=new ar;n!==null&&g.fromArray(n.array,d*16),h.push(g)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',e.joints[d])}return new vY(c,h)})}loadAnimation(i){let e=this.json,t=this,r=e.animations[i],n=r.name?r.name:"animation_"+i,l=[],c=[],h=[],d=[],f=[];for(let m=0,g=r.channels.length;m<g;m++){let y=r.channels[m],_=r.samplers[y.sampler],b=y.target,S=b.node,E=r.parameters!==void 0?r.parameters[_.input]:_.input,T=r.parameters!==void 0?r.parameters[_.output]:_.output;b.node!==void 0&&(l.push(this.getDependency("node",S)),c.push(this.getDependency("accessor",E)),h.push(this.getDependency("accessor",T)),d.push(_),f.push(b))}return Promise.all([Promise.all(l),Promise.all(c),Promise.all(h),Promise.all(d),Promise.all(f)]).then(function(m){let g=m[0],y=m[1],_=m[2],b=m[3],S=m[4],E=[];for(let T=0,A=g.length;T<A;T++){let P=g[T],O=y[T],R=_[T],D=b[T],L=S[T];if(P===void 0)continue;P.updateMatrix&&P.updateMatrix();let N=t._createAnimationTracks(P,O,R,D,L);if(N)for(let U=0;U<N.length;U++)E.push(N[U])}return new u4(n,void 0,E)})}createNodeMesh(i){let e=this.json,t=this,r=e.nodes[i];return r.mesh===void 0?null:t.getDependency("mesh",r.mesh).then(function(n){let l=t._getNodeRef(t.meshCache,r.mesh,n);return r.weights!==void 0&&l.traverse(function(c){if(c.isMesh)for(let h=0,d=r.weights.length;h<d;h++)c.morphTargetInfluences[h]=r.weights[h]}),l})}loadNode(i){let e=this.json,t=this,r=e.nodes[i],n=t._loadNodeShallow(i),l=[],c=r.children||[];for(let d=0,f=c.length;d<f;d++)l.push(t.getDependency("node",c[d]));let h=r.skin===void 0?Promise.resolve(null):t.getDependency("skin",r.skin);return Promise.all([n,Promise.all(l),h]).then(function(d){let f=d[0],m=d[1],g=d[2];g!==null&&f.traverse(function(y){!y.isSkinnedMesh||y.bind(g,f2e)});for(let y=0,_=m.length;y<_;y++)f.add(m[y]);return f})}_loadNodeShallow(i){let e=this.json,t=this.extensions,r=this;if(this.nodeCache[i]!==void 0)return this.nodeCache[i];let n=e.nodes[i],l=n.name?r.createUniqueName(n.name):"",c=[],h=r._invokeOne(function(d){return d.createNodeMesh&&d.createNodeMesh(i)});return h&&c.push(h),n.camera!==void 0&&c.push(r.getDependency("camera",n.camera).then(function(d){return r._getNodeRef(r.cameraCache,n.camera,d)})),r._invokeAll(function(d){return d.createNodeAttachment&&d.createNodeAttachment(i)}).forEach(function(d){c.push(d)}),this.nodeCache[i]=Promise.all(c).then(function(d){let f;if(n.isBone===!0?f=new gY:d.length>1?f=new ED:d.length===1?f=d[0]:f=new Wn,f!==d[0])for(let m=0,g=d.length;m<g;m++)f.add(d[m]);if(n.name&&(f.userData.name=n.name,f.name=l),wm(f,n),n.extensions&&_1(t,f,n),n.matrix!==void 0){let m=new ar;m.fromArray(n.matrix),f.applyMatrix4(m)}else n.translation!==void 0&&f.position.fromArray(n.translation),n.rotation!==void 0&&f.quaternion.fromArray(n.rotation),n.scale!==void 0&&f.scale.fromArray(n.scale);return r.associations.has(f)||r.associations.set(f,{}),r.associations.get(f).nodes=i,f}),this.nodeCache[i]}loadScene(i){let e=this.extensions,t=this.json.scenes[i],r=this,n=new ED;t.name&&(n.name=r.createUniqueName(t.name)),wm(n,t),t.extensions&&_1(e,n,t);let l=t.nodes||[],c=[];for(let h=0,d=l.length;h<d;h++)c.push(r.getDependency("node",l[h]));return Promise.all(c).then(function(h){for(let f=0,m=h.length;f<m;f++)n.add(h[f]);let d=f=>{let m=new Map;for(let[g,y]of r.associations)(g instanceof Wm||g instanceof Eo)&&m.set(g,y);return f.traverse(g=>{let y=r.associations.get(g);y!=null&&m.set(g,y)}),m};return r.associations=d(n),n})}_createAnimationTracks(i,e,t,r,n){let l=[],c=i.name?i.name:i.uuid,h=[];mm[n.path]===mm.weights?i.traverse(function(g){g.morphTargetInfluences&&h.push(g.name?g.name:g.uuid)}):h.push(c);let d;switch(mm[n.path]){case mm.weights:d=KM;break;case mm.rotation:d=fw;break;case mm.position:case mm.scale:d=QM;break;default:switch(t.itemSize){case 1:d=KM;break;case 2:case 3:default:d=QM;break}break}let f=r.interpolation!==void 0?o2e[r.interpolation]:YM,m=this._getArrayFromAccessor(t);for(let g=0,y=h.length;g<y;g++){let _=new d(h[g]+"."+mm[n.path],e.array,m,f);r.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(_),l.push(_)}return l}_getArrayFromAccessor(i){let e=i.array;if(i.normalized){let t=g4(e.constructor),r=new Float32Array(e.length);for(let n=0,l=e.length;n<l;n++)r[n]=e[n]*t;e=r}return e}_createCubicSplineTrackInterpolant(i){i.createInterpolant=function(e){let t=this instanceof fw?a2e:LY;return new t(this.times,this.values,this.getValueSize()/3,e)},i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}};function m2e(i,e,t){let r=e.attributes,n=new Co;if(r.POSITION!==void 0){let h=t.json.accessors[r.POSITION],d=h.min,f=h.max;if(d!==void 0&&f!==void 0){if(n.set(new Se(d[0],d[1],d[2]),new Se(f[0],f[1],f[2])),h.normalized){let m=g4(SM[h.componentType]);n.min.multiplyScalar(m),n.max.multiplyScalar(m)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;let l=e.targets;if(l!==void 0){let h=new Se,d=new Se;for(let f=0,m=l.length;f<m;f++){let g=l[f];if(g.POSITION!==void 0){let y=t.json.accessors[g.POSITION],_=y.min,b=y.max;if(_!==void 0&&b!==void 0){if(d.setX(Math.max(Math.abs(_[0]),Math.abs(b[0]))),d.setY(Math.max(Math.abs(_[1]),Math.abs(b[1]))),d.setZ(Math.max(Math.abs(_[2]),Math.abs(b[2]))),y.normalized){let S=g4(SM[y.componentType]);d.multiplyScalar(S)}h.max(d)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}n.expandByVector(h)}i.boundingBox=n;let c=new tf;n.getCenter(c.center),c.radius=n.min.distanceTo(n.max)/2,i.boundingSphere=c}function Ej(i,e,t){let r=e.attributes,n=[];function l(c,h){return t.getDependency("accessor",c).then(function(d){i.setAttribute(h,d)})}for(let c in r){let h=m4[c]||c.toLowerCase();h in i.attributes||n.push(l(r[c],h))}if(e.indices!==void 0&&!i.index){let c=t.getDependency("accessor",e.indices).then(function(h){i.setIndex(h)});n.push(c)}return Cu.workingColorSpace!==Kd&&"COLOR_0"in r&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${Cu.workingColorSpace}" not supported.`),wm(i,e),m2e(i,e,t),Promise.all(n).then(function(){return e.targets!==void 0?u2e(i,e.targets,t):i})}var g2e=class{constructor(i,e,t,r){this.animations={},this.position=new Se(0,0,0),this.lastPosition=new Se(0,0,0),this.quaternion=null,this.isOwnAvatar=!1,this.currentAnimation=null,this.lastWorldModelPos=new Se(0,0,0),this.worldPosition=new Se(0,0,0),this.load=function(){return Wa(this,null,function*(){let n=new FCe;return new Promise((l,c)=>{n.load(this.url,h=>Wa(this,null,function*(){this.mixer=new aCe(h.scene),h.animations.forEach(f=>{let m=this.mixer.clipAction(f);this.animations[f.name]=m,this.animations[f.name].paused=!0}),h.scene.scale.set(this.scale,this.scale,this.scale),h.scene.rotation.set(0,3.14,0),h.scene.position.set(0,this.height,0);let d=new Wn;d.add(h.scene),this.model=h.scene,this.root=d,l(this.root)}),h=>{console.log(`${h.loaded/h.total*100} % loaded`)},h=>{console.error("An error happened loading the avatar",h),c(h)})})})},this.url=i,this.scale=e,this.height=t,this.clock=new pU,this.mixer=null,this.isOwnAvatar=r,this.animations={},this.isMoving=!1,this.isMovingCounter=0,this.lerpAnimationFrame=requestAnimationFrame(this.animate.bind(this))}setPosition(i){this.position.set(i.x,i.y,i.z)}setQuaternion(i){this.quaternion=new pu(i.x,i.y,i.z,i.w)}destroy(){cancelAnimationFrame(this.lerpAnimationFrame),this.root.parent.remove(this.root)}animate(){if(requestAnimationFrame(this.animate.bind(this)),!this.position||!this.quaternion)return;this.lastPosition.set(this.position.x,this.position.y,this.position.z);let i=this.clock.getDelta(),e=this.isOwnAvatar?6:2,t=this.root.position.clone();t.lerp(this.position,e*i),this.root.position.set(t.x,t.y,t.z);let r=this.root.quaternion.clone();r.slerp(this.quaternion,e*i),this.root.quaternion.set(r.x,r.y,r.z,r.w),this.mixer.update(i),this.model.getWorldPosition(this.worldPosition);let n=this.isOwnAvatar?.001:.004,l=this.isOwnAvatar?10:30;this.lastWorldModelPos.distanceTo(this.worldPosition)<n?(this.isMovingCounter++,this.isMovingCounter>l&&(this.isMoving=!1,this.isMovingCounter=0)):this.isMoving=!0,this.model.getWorldPosition(this.lastWorldModelPos)}playAnimation(i){if(!this.animations[i])return;let e=this.animations[i];if(e&&this.currentAnimation!==i){if(e.paused=!1,e.enabled=!0,e.play(),this.currentAnimation&&this.animations[this.currentAnimation]){let t=this.isOwnAvatar?.3:.7;this.animations[this.currentAnimation].crossFadeTo(e,t,!0)}this.currentAnimation=i}}stopAnimation(i){this.animations[i]&&(this.animations[i].paused=!0)}stopAllAnimations(){Object.values(this.animations).forEach(i=>{let e=i;e.paused=!0})}};function v2e(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var r,n,l,c,h=[],d=!0,f=!1;try{if(l=(t=t.call(i)).next,e===0){if(Object(t)!==t)return;d=!1}else for(;!(d=(r=l.call(t)).done)&&(h.push(r.value),h.length!==e);d=!0);}catch(m){f=!0,n=m}finally{try{if(!d&&t.return!=null&&(c=t.return(),Object(c)!==c))return}finally{if(f)throw n}}return h}}function y2e(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function Tj(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,I2e(r.key),r)}}function _2e(i,e,t){return e&&Tj(i.prototype,e),t&&Tj(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}function x2e(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&v4(i,e)}function pI(i){return pI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},pI(i)}function v4(i,e){return v4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},v4(i,e)}function b2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function w2e(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function S2e(i,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return w2e(i)}function M2e(i){var e=b2e();return function(){var t=pI(i),r;if(e){var n=pI(this).constructor;r=Reflect.construct(t,arguments,n)}else r=t.apply(this,arguments);return S2e(this,r)}}function Aj(i,e){return T2e(i)||v2e(i,e)||OY(i,e)||P2e()}function CP(i){return E2e(i)||A2e(i)||OY(i)||C2e()}function E2e(i){if(Array.isArray(i))return y4(i)}function T2e(i){if(Array.isArray(i))return i}function A2e(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function OY(i,e){if(i){if(typeof i=="string")return y4(i,e);var t=Object.prototype.toString.call(i).slice(8,-1);if(t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set")return Array.from(i);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return y4(i,e)}}function y4(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=i[t];return r}function C2e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function P2e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function R2e(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function I2e(i){var e=R2e(i,"string");return typeof e=="symbol"?e:String(e)}var TT=typeof window<"u"&&window.THREE?window.THREE:{LinearFilter:xL,Sprite:mY,SpriteMaterial:lU,Texture:Eo},NY=function(i){x2e(t,i);var e=M2e(t);function t(){var r,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:10,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"rgba(255, 255, 255, 1)";return y2e(this,t),r=e.call(this,new TT.SpriteMaterial),r._text="".concat(n),r._textHeight=l,r._color=c,r._backgroundColor=!1,r._padding=0,r._borderWidth=0,r._borderRadius=0,r._borderColor="white",r._strokeWidth=0,r._strokeColor="white",r._fontFace="Arial",r._fontSize=90,r._fontWeight="normal",r._canvas=document.createElement("canvas"),r._genCanvas(),r}return _2e(t,[{key:"text",get:function(){return this._text},set:function(r){this._text=r,this._genCanvas()}},{key:"textHeight",get:function(){return this._textHeight},set:function(r){this._textHeight=r,this._genCanvas()}},{key:"color",get:function(){return this._color},set:function(r){this._color=r,this._genCanvas()}},{key:"backgroundColor",get:function(){return this._backgroundColor},set:function(r){this._backgroundColor=r,this._genCanvas()}},{key:"padding",get:function(){return this._padding},set:function(r){this._padding=r,this._genCanvas()}},{key:"borderWidth",get:function(){return this._borderWidth},set:function(r){this._borderWidth=r,this._genCanvas()}},{key:"borderRadius",get:function(){return this._borderRadius},set:function(r){this._borderRadius=r,this._genCanvas()}},{key:"borderColor",get:function(){return this._borderColor},set:function(r){this._borderColor=r,this._genCanvas()}},{key:"fontFace",get:function(){return this._fontFace},set:function(r){this._fontFace=r,this._genCanvas()}},{key:"fontSize",get:function(){return this._fontSize},set:function(r){this._fontSize=r,this._genCanvas()}},{key:"fontWeight",get:function(){return this._fontWeight},set:function(r){this._fontWeight=r,this._genCanvas()}},{key:"strokeWidth",get:function(){return this._strokeWidth},set:function(r){this._strokeWidth=r,this._genCanvas()}},{key:"strokeColor",get:function(){return this._strokeColor},set:function(r){this._strokeColor=r,this._genCanvas()}},{key:"_genCanvas",value:function(){var r=this,n=this._canvas,l=n.getContext("2d"),c=Array.isArray(this.borderWidth)?this.borderWidth:[this.borderWidth,this.borderWidth],h=c.map(function(L){return L*r.fontSize*.1}),d=Array.isArray(this.borderRadius)?this.borderRadius:[this.borderRadius,this.borderRadius,this.borderRadius,this.borderRadius],f=d.map(function(L){return L*r.fontSize*.1}),m=Array.isArray(this.padding)?this.padding:[this.padding,this.padding],g=m.map(function(L){return L*r.fontSize*.1}),y=this.text.split(`
`),_="".concat(this.fontWeight," ").concat(this.fontSize,"px ").concat(this.fontFace);l.font=_;var b=Math.max.apply(Math,CP(y.map(function(L){return l.measureText(L).width}))),S=this.fontSize*y.length;if(n.width=b+h[0]*2+g[0]*2,n.height=S+h[1]*2+g[1]*2,this.borderWidth){if(l.strokeStyle=this.borderColor,h[0]){var E=h[0]/2;l.lineWidth=h[0],l.beginPath(),l.moveTo(E,f[0]),l.lineTo(E,n.height-f[3]),l.moveTo(n.width-E,f[1]),l.lineTo(n.width-E,n.height-f[2]),l.stroke()}if(h[1]){var T=h[1]/2;l.lineWidth=h[1],l.beginPath(),l.moveTo(Math.max(h[0],f[0]),T),l.lineTo(n.width-Math.max(h[0],f[1]),T),l.moveTo(Math.max(h[0],f[3]),n.height-T),l.lineTo(n.width-Math.max(h[0],f[2]),n.height-T),l.stroke()}if(this.borderRadius){var A=Math.max.apply(Math,CP(h)),P=A/2;l.lineWidth=A,l.beginPath(),[!!f[0]&&[f[0],P,P,f[0]],!!f[1]&&[n.width-f[1],n.width-P,P,f[1]],!!f[2]&&[n.width-f[2],n.width-P,n.height-P,n.height-f[2]],!!f[3]&&[f[3],P,n.height-P,n.height-f[3]]].filter(function(L){return L}).forEach(function(L){var N=Aj(L,4),U=N[0],F=N[1],z=N[2],G=N[3];l.moveTo(U,z),l.quadraticCurveTo(F,z,F,G)}),l.stroke()}}this.backgroundColor&&(l.fillStyle=this.backgroundColor,this.borderRadius?(l.beginPath(),l.moveTo(h[0],f[0]),[[h[0],f[0],n.width-f[1],h[1],h[1],h[1]],[n.width-h[0],n.width-h[0],n.width-h[0],h[1],f[1],n.height-f[2]],[n.width-h[0],n.width-f[2],f[3],n.height-h[1],n.height-h[1],n.height-h[1]],[h[0],h[0],h[0],n.height-h[1],n.height-f[3],f[0]]].forEach(function(L){var N=Aj(L,6),U=N[0],F=N[1],z=N[2],G=N[3],J=N[4],Z=N[5];l.quadraticCurveTo(U,G,F,J),l.lineTo(z,Z)}),l.closePath(),l.fill()):l.fillRect(h[0],h[1],n.width-h[0]*2,n.height-h[1]*2)),l.translate.apply(l,CP(h)),l.translate.apply(l,CP(g)),l.font=_,l.fillStyle=this.color,l.textBaseline="bottom";var O=this.strokeWidth>0;O&&(l.lineWidth=this.strokeWidth*this.fontSize/10,l.strokeStyle=this.strokeColor),y.forEach(function(L,N){var U=(b-l.measureText(L).width)/2,F=(N+1)*r.fontSize;O&&l.strokeText(L,U,F),l.fillText(L,U,F)}),this.material.map&&this.material.map.dispose();var R=this.material.map=new TT.Texture(n);R.minFilter=TT.LinearFilter,R.needsUpdate=!0;var D=this.textHeight*y.length+c[1]*2+m[1]*2;this.scale.set(D*n.width/n.height,D,0)}},{key:"clone",value:function(){return new this.constructor(this.text,this.textHeight,this.color).copy(this)}},{key:"copy",value:function(r){return TT.Sprite.prototype.copy.call(this,r),this.color=r.color,this.backgroundColor=r.backgroundColor,this.padding=r.padding,this.borderWidth=r.borderWidth,this.borderColor=r.borderColor,this.fontFace=r.fontFace,this.fontSize=r.fontSize,this.fontWeight=r.fontWeight,this.strokeWidth=r.strokeWidth,this.strokeColor=r.strokeColor,this}}]),t}(TT.Sprite),L2e=class{constructor(i,e,t,r){if(this.load=()=>Wa(this,null,function*(){let n=this.height,l=new FontFace("OpenSans-SemiBold","url(https://superviz2homologmediaserver.s3.amazonaws.com/static/fonts/OpenSans-SemiBold.woff)");yield l.load(),document.fonts.add(l);let c=this.createTextGeometry(this.name,this.color);this.text=c;let h=new Wn;return h.add(c),c.position.set(0,n,0),this.model=h,this.model}),this.createTextGeometry=(n,l)=>{let{scale:c}=this,h=fI[this.slot],d=l,f=new NY(n,.1);return f.color=h,f.padding=2.7,f.backgroundColor=d,f.fontFace="OpenSans-SemiBold",f.fontSize=100,f.material.sizeAttenuation=!0,f.borderRadius=8,f.scale.set(f.scale.x*c,f.scale.y*c,f.scale.z*c),f},this.name=i,this.scale=r,e)this.color=kp[e];else{let n=kp[0];this.color=n}this.height=t,this.slot=e}},O2e=class{constructor(i,e,t){this.destPos=new Se(0,0,0),this.curPos=new Se(0,0,0),this.startPos=new Se(0,0,0),this.counter=0,this.colorIndex=0,this.lastColorIndex=0,this.lastDestPos=new Se(1e3,1e3,1e3),this.lastStartPos=new Se(1e3,1e3,1e3),this.createdMaterial=!1,this.tempStartVec=new Se(0,0,0),this.update=(function(r,n,l,c=0){this.colorIndex=c,this.destPos.x=n.x,this.destPos.y=n.y,this.destPos.z=n.z,this.tempStartVec.copy(this.origin),this.tempStartVec.applyQuaternion(l),this.startPos.copy(r),this.startPos.add(this.tempStartVec),this.counter=0}).bind(this),this.clock=new pU,this.origin=t,this.lerpAnimationFrame=requestAnimationFrame(this.animate.bind(this))}load(){this.createMaterial(),this.root=new Wn,this.origin.x===0&&this.origin.y===0&&this.origin.z===0&&this.origin.set(0,-.1,0)}animate(){if(this.lerpAnimationFrame=requestAnimationFrame(this.animate.bind(this)),!this.createdMaterial)return;let i=this.clock.getDelta(),e=1e4;if(!(this.counter>2&&this.lastDestPos.equals(this.destPos)&&this.lastStartPos.distanceTo(this.startPos)<.2)){if(this.counter++,this.lastColorIndex!==this.colorIndex){let t=kp[this.colorIndex];this.material&&(this.material.color.set(t),this.lastColorIndex=this.colorIndex)}this.curPos.lerp(this.destPos,i/1e3*e),this.lastDestPos.x=this.destPos.x,this.lastDestPos.y=this.destPos.y,this.lastDestPos.z=this.destPos.z,this.lastStartPos.x=this.startPos.x,this.lastStartPos.y=this.startPos.y,this.lastStartPos.z=this.startPos.z,this.updateMesh(this.startPos,this.curPos)}}destroy(){this.material&&this.material.dispose(),cancelAnimationFrame(this.lerpAnimationFrame),this.root.parent&&this.root.parent.remove(this.root)}createMaterial(){let i=this.createTextureCanvas(),e=new Eo(i);e.needsUpdate=!0;let t=kp[this.colorIndex];this.material=new U1({map:e,blending:bSe,color:t,side:tU,depthWrite:!0,transparent:!0}),this.createdMaterial=!0}updateMesh(i,e){let t=new bY(i,e);this.mesh&&this.mesh.geometry&&(this.mesh.geometry.dispose(),this.root.remove(this.mesh));let r=new SY(t,1,.003,4,!1);this.material&&(this.mesh=new Sw(r,this.material),this.root.add(this.mesh))}createTextureCanvas(){let i=document.createElement("canvas"),e=i.getContext("2d");i.width=1,i.height=64;let t=e.createLinearGradient(0,0,i.width,i.height);return t.addColorStop(0,"rgba(  0,  0,  0,0.1)"),t.addColorStop(.1,"rgba(160,160,160,0.3)"),t.addColorStop(.5,"rgba(255,255,255,0.5)"),t.addColorStop(.9,"rgba(160,160,160,0.3)"),t.addColorStop(1,"rgba(  0,  0,  0,0.1)"),e.fillStyle=t,e.fillRect(0,0,i.width,i.height),i}},N2e=class{constructor(i){this.destPos=new Se(0,0,0),this.curPos=new Se(0,0,0),this.counter=0,this.colorIndex=0,this.lastColorIndex=0,this.lastDestPos=new Se(1e3,1e3,1e3),this.update=(function(e,t=0){!e||t===void 0||(this.colorIndex=t,this.destPos.x=e.x,this.destPos.y=e.y,this.destPos.z=e.z,this.counter=0)}).bind(this),this.createTextGeometry=(e,t)=>{let r=fI[this.colorIndex],n=t,l=new NY(e,.1);return l.color=r,l.padding=2.7,l.borderRadius=8,l.backgroundColor=n,l.fontFace="OpenSans-SemiBold",l.fontSize=120,l.scale.set(l.scale.x*.005,l.scale.y*.005,l.scale.z*.005),l.material.sizeAttenuation=!1,l.material.depthTest=!1,l.center.set(-.15,1),l},this.createArrowGeometry=e=>Wa(this,null,function*(){if(e!==void 0)return new Promise(t=>{let r=`https://production.cdn.superviz.com/static/pointers-v2/${e}.svg`,n=new CY,l;n.load(r,c=>{l=c;let h=new lU({map:l,color:16777215,fog:!1,sizeAttenuation:!1}),d=new mY(h);d.scale.set(.02,.02,.02),d.center.set(.2,.23),t(d)})})}),this.clock=new pU,this.scene=i,this.lerpAnimationFrame=requestAnimationFrame(this.animate.bind(this))}load(i,e){return Wa(this,null,function*(){if(this.root=new Wn,this.colorIndex=e,i.trim().length){let t=new FontFace("OpenSans-SemiBold","url(https://superviz2homologmediaserver.s3.amazonaws.com/static/fonts/OpenSans-SemiBold.woff)");yield t.load(),document.fonts.add(t),this.textMesh=this.createTextGeometry(i,kp[e]),this.textMesh.position.set(0,0,0),this.root.add(this.textMesh)}return this.arrowMesh=yield this.createArrowGeometry(e),this.root.add(this.arrowMesh),this.scene.add(this.root),this.root})}animate(){return Wa(this,null,function*(){this.lerpAnimationFrame=requestAnimationFrame(this.animate.bind(this));let i=this.clock.getDelta(),e=1e4;if(!(this.counter>30&&this.lastDestPos.equals(this.destPos))){if(this.counter++,this.colorIndex!==void 0&&this.lastColorIndex!==this.colorIndex&&this.backgroundMaterial){let t=new Tr(kp[this.colorIndex]);this.backgroundMaterial.color.set(t),this.lastColorIndex=this.colorIndex,this.root.remove(this.arrowMesh),this.arrowMesh=yield this.createArrowGeometry(this.colorIndex),this.root.add(this.arrowMesh)}this.curPos.lerp(this.destPos,i/1e3*e),this.lastDestPos.x=this.destPos.x,this.lastDestPos.y=this.destPos.y,this.lastDestPos.z=this.destPos.z,this.root.position.copy(this.curPos)}})}destroy(){this.backgroundMaterial&&this.backgroundMaterial.dispose(),cancelAnimationFrame(this.lerpAnimationFrame),this.root.parent&&this.root.parent.remove(this.root)}},D2e=QB(xSe()),k2e=class{constructor(i={}){this.subscribe=r=>{this.callbacks.push(r)},this.unsubscribe=r=>{this.callbacks=this.callbacks.filter(n=>n!==r)},this.publish=(...r)=>{!this.callbacks||this.callbacks.forEach(n=>{this.callListener(n,r).catch(l=>{this.logger.log("superviz-sdk:observer-helper:publish:error",`
            Failed to execute callback on publish value.
            Callback: ${n}
            Event: ${JSON.stringify(r)}
            Error: ${l}
          `)})})},this.reset=()=>{this.callbacks=[]},this.destroy=()=>{delete this.logger,delete this.callbacks},this.callListener=(r,n)=>new Promise((l,c)=>{try{let h=r(...n);l(h)}catch(h){c(h)}});let{logger:e,throttleTime:t}=i;this.logger=e??new yU("@superviz/sdk/observer-helper"),this.throttle=t,this.callbacks=[],this.throttle&&(this.publish=(0,D2e.default)(this.publish,this.throttle))}},F2e=class{constructor(i,e,t,r,n){this.isPinsVisible=!0,this.commentsSide="left",this.localParticipant={},this.hideTemporaryPin=l=>{var c;let h=l.target;this.showcaseDiv.contains(h)||(c=this.pins.get("temporary-pin"))!=null&&c.contains(h)||this.removeAnnotationPin("temporary-pin")},this.setPointerDownCoordinates=({x:l,y:c})=>{this.pointerDownCoordinates={x:l,y:c}},this.setCommentsMetadata=l=>{this.commentsSide=l},this.annotationSelected=({detail:l})=>{var c,h;let{uuid:d,haltGoToPin:f,newPin:m}=l;if(!d)return;m&&this.pins.get(d).setAttribute("newPin","");let g=JSON.parse((h=(c=this.selectedPin)==null?void 0:c.getAttribute("annotation"))!=null?h:"{}");if(this.resetPins(),(g==null?void 0:g.uuid)===d)return;document.body.dispatchEvent(new CustomEvent("close-temporary-annotation"));let y=this.pins.get(d);if(!y)return;y.setAttribute("active",""),this.selectedPin=y;let _=JSON.parse(this.annotations.find(b=>b.uuid===d).position);_&&!f&&this.onClickedPin(_)},this.resetPins=l=>{l&&(l==null?void 0:l.key)!=="Escape"||(this.resetSelectedPin(),this.removeAnnotationPin("temporary-pin"),this.temporaryPinCoordinates=null)},this.onClick=l=>{if(!this.isActive)return;{let y=this.showcaseDiv.getBoundingClientRect(),{x:_,y:b}=this.pointerDownCoordinates,S=_-y.x,E=b-y.y,T=l.clientX-y.left,A=l.clientY-y.top;if(Math.hypot(T-S,A-E)>10)return}let c=new cI,h=new mi;this.camera.updateMatrixWorld();let d=this.showcaseDiv.getBoundingClientRect(),f=l.clientX-d.left,m=l.clientY-d.top;h.x=f/this.showcaseDiv.clientWidth*2-1,h.y=m/this.showcaseDiv.clientHeight*-2+1,c.setFromCamera(h,this.camera);let g=c.intersectObjects(this.scene.children,!0);if(g.length>0){let y=g.filter(_=>!_.object.isLine)[0];if(y){let _={x:y.point.x,y:y.point.y,z:y.point.z,type:"threejs"},b={position:_,camera:this.camera.position};this.resetSelectedPin(),this.onPinFixedObserver.publish(b),this.createTemporaryPin(_)}}},this.renderDivWrapper=()=>{let l=this.showcaseDiv.getBoundingClientRect(),c=this.divWrapper;c||(c=document.createElement("div"),c.id="superviz-autodesk-pins-wrapper"),c.style.position="absolute",c.style.top=`${this.showcaseDiv.offsetTop}px`,c.style.left=`${this.showcaseDiv.offsetLeft}px`,c.style.width=`${l.width}px`,c.style.height=`${l.height}px`,c.style.pointerEvents="none",c.style.overflow="hidden",c.style.zIndex="1",this.showcaseDiv.parentElement.style.position==="static"&&(this.showcaseDiv.parentElement.style.position="relative"),document.getElementById("superviz-autodesk-pins-wrapper")||this.showcaseDiv.parentElement.appendChild(c),this.divWrapper=c},this.distanceBetween=(l,c)=>{let h=l.x-c.x,d=l.y-c.y,f=l.z-c.z;return Math.sqrt(h*h+d*d+f*f)},this.onMouseMove=l=>{let{x:c,y:h}=l;this.mouseElement||(this.mouseElement=this.createMouseElement());let d=h-this.pinHeight;this.mouseElement.setAttribute("position",JSON.stringify({x:c,y:d}))},this.onMouseLeave=()=>{this.mouseElement&&(this.mouseElement.remove(),this.mouseElement=null),this.showcaseDiv.style.cursor="default"},this.onMouseEnter=()=>{this.mouseElement||(this.mouseElement=this.createMouseElement())},this.onToggleAnnotationSidebar=({detail:l})=>{let{open:c}=l;c||(this.pins.forEach(h=>{h.removeAttribute("active")}),this.pins.has("temporary-pin")&&this.removeAnnotationPin("temporary-pin"))},this.scene=i,this.camera=t,this.showcaseDiv=e.domElement,this.controls=n,this.player?this.player=r:this.player=t,this.logger=new yU("@superviz/sdk/comments-component/three-js-adapter"),this.isActive=!1,this.pins=new Map,this.pinHeight=40,this.onClickBinded=this.onClick.bind(this),this.animateBinded=this.animate.bind(this),document.body.style.position="relative",this.onPinFixedObserver=new k2e,this.annotations=[],document.body.addEventListener("select-annotation",this.annotationSelected),document.body.addEventListener("toggle-annotation-sidebar",this.onToggleAnnotationSidebar),this.renderAnnotationsPins(),this.animFrame=requestAnimationFrame(this.animateBinded),this.showcaseSides=this.showcaseDiv.getBoundingClientRect()}destroy(){document.body.removeEventListener("select-annotation",this.annotationSelected),document.body.removeEventListener("toggle-annotation-sidebar",this.onToggleAnnotationSidebar),cancelAnimationFrame(this.animFrame),this.removeAnnotationsPins(),this.removeListeners(),this.mouseElement=null}setActive(i){if(this.isActive=i,this.isActive){this.addListeners();return}this.removeListeners()}setPinsVisibility(i){if(this.isPinsVisible=i,this.isPinsVisible){this.renderAnnotationsPins();return}this.removeAnnotationsPins()}updateAnnotations(i){this.logger.log("updateAnnotations",i),this.annotations=i,!(!this.isActive&&!this.isPinsVisible)&&(this.removeAnnotationsPins(),this.renderAnnotationsPins())}removeAnnotationPin(i){let e=this.pins.get(i);!e||(e.remove(),this.pins.delete(i),this.annotations=this.annotations.filter(t=>t.uuid!==i))}createTemporaryPin(i){var e,t;let r=document.getElementById("superviz-temporary-pin");this.temporaryPinCoordinates=i,!r&&(r=document.createElement("superviz-comments-annotation-pin"),r.id="superviz-temporary-pin",r.setAttribute("type","add"),r.setAttribute("showInput",""),r.setAttribute("containerSides",JSON.stringify(this.showcaseSides)),r.setAttribute("commentsSide",this.commentsSide),r.setAttribute("position",JSON.stringify(this.temporaryPinCoordinates)),r.setAttribute("localAvatar",(e=this.localParticipant.avatar)!=null?e:""),r.setAttribute("participantsList",JSON.stringify(this.participants)),r.setAttribute("localName",(t=this.localParticipant.name)!=null?t:""),r.setAttribute("annotation",JSON.stringify({})),r.setAttributeNode(document.createAttribute("active")),r.style.pointerEvents="auto");let n=this.position3DToScreen(i,0,this.pinHeight),l={x:n.left,y:n.top,type:i.type};r.setAttribute("position",JSON.stringify(l)),this.divWrapper.appendChild(r),this.pins.set("temporary-pin",r),this.renderAnnotationsPins()}addListeners(){document.body.addEventListener("select-annotation",this.annotationSelected),this.showcaseDiv.addEventListener("pointerdown",this.setPointerDownCoordinates),this.showcaseDiv.addEventListener("click",this.onClickBinded),this.showcaseDiv.addEventListener("mousemove",this.onMouseMove),this.showcaseDiv.addEventListener("mouseout",this.onMouseLeave),this.showcaseDiv.addEventListener("mouseenter",this.onMouseEnter),document.body.addEventListener("keyup",this.resetPins),document.body.addEventListener("click",this.hideTemporaryPin)}removeListeners(){document.body.removeEventListener("select-annotation",this.annotationSelected),this.showcaseDiv.removeEventListener("pointerdown",this.setPointerDownCoordinates),this.showcaseDiv.removeEventListener("click",this.onClick),this.showcaseDiv.removeEventListener("mousemove",this.onMouseMove),this.showcaseDiv.removeEventListener("mouseout",this.onMouseLeave),this.showcaseDiv.removeEventListener("mouseenter",this.onMouseEnter),document.body.removeEventListener("keyup",this.resetPins),document.body.removeEventListener("click",this.hideTemporaryPin)}animate(){(this.isActive||this.isPinsVisible)&&this.renderAnnotationsPins(),this.renderDivWrapper(),this.animFrame=requestAnimationFrame(this.animateBinded)}renderAnnotationsPins(){return Wa(this,null,function*(){if(this.annotations.forEach(i=>Wa(this,null,function*(){if(!i.position)return;let e=JSON.parse(i.position),t=e==null?void 0:e.position;if((t==null?void 0:t.type)!=="threejs"||i.resolved)return;if(!this.pins.has(i.uuid)){this.createPin(i,t);return}let r=this.position3DToScreen(t,0,this.pinHeight),n=yield this.checkIsVisible(r,t),l=this.pins.get(i.uuid);n?(l.setAttribute("style","opacity: 1"),this.pins.get(i.uuid).setAttribute("position",JSON.stringify({x:r.left,y:r.top}))):l.setAttribute("style","opacity: 0")})),this.pins.get("temporary-pin")){let i=this.position3DToScreen(this.temporaryPinCoordinates,0,this.pinHeight),e=yield this.checkIsVisible(i,this.temporaryPinCoordinates),t=this.pins.get("temporary-pin");e?(t.setAttribute("style","opacity: 1"),t.setAttribute("position",JSON.stringify({x:i.left,y:i.top}))):t.setAttribute("style","opacity: 0")}})}createPin(i,e){let t=this.position3DToScreen(e,0,this.pinHeight),r=document.createElement("superviz-comments-annotation-pin");this.divWrapper.appendChild(r),r.setAttribute("type","show"),r.setAttribute("annotation",JSON.stringify(i)),r.setAttribute("position",JSON.stringify({x:t.left,y:t.top})),r.setAttribute("participantsList",JSON.stringify(this.participants)),r.style.pointerEvents="auto",this.pins.set(i.uuid,r)}removeAnnotationsPins(){this.pins.forEach(i=>{i.remove()}),this.pins.clear()}set participantsList(i){this.participants=i}resetSelectedPin(){!this.selectedPin||(this.selectedPin.removeAttribute("active"),this.selectedPin=null)}onClickedPin(i){let e=new Se(i.position.x,i.position.y,i.position.z),t=new Se(i.camera.x,i.camera.y,i.camera.z),r;t.distanceTo(e)>3?r=t.lerp(e,.8):r=t,this.controls&&(this.controls.target=e);let n=setInterval(()=>{let l=this.player.position.clone();l.lerp(r,.02),this.player.position.set(l.x,l.y,l.z),this.player.lookAt(e)},1);setTimeout(()=>{this.player.lookAt(e),clearInterval(n)},1e3)}position3DToScreen(i,e,t){let r=new Se(0,0,0);r.set(i.x,i.y,i.z),this.camera.updateMatrixWorld(),r.project(this.camera),this.showcaseDiv.getBoundingClientRect();let n=this.showcaseDiv.clientWidth/2,l=this.showcaseDiv.clientHeight/2;return r.x=r.x*n+n,r.y=-(r.y*l)+l,r.z=0,{top:r.y-t,left:r.x-e}}checkIsVisible(i,e){return Wa(this,null,function*(){let t=!1,r=new cI,n=new mi,l=i.left,c=i.top+this.pinHeight;n.x=l/this.showcaseDiv.clientWidth*2-1,n.y=c/this.showcaseDiv.clientHeight*-2+1,r.setFromCamera(n,this.camera);let h=r.intersectObjects(this.scene.children,!0);if(h.length>0){let d=h.filter(f=>!f.object.isLine)[0];if(d){let f=d.point,m=this.distanceBetween(f,e);Math.abs(m)<.2&&(t=!0)}}return t})}createMouseElement(){let i=document.createElement("superviz-comments-annotation-pin");return i.setAttribute("type","add"),i.setAttribute("annotation",JSON.stringify({})),i.setAttribute("position",JSON.stringify({x:0,y:0})),document.body.appendChild(i),this.showcaseDiv.style.cursor="none",i}},VD={model3DUrl:"https://production.storage.superviz.com/readyplayerme/1.glb",imageUrl:"https://production.cdn.superviz.com/static/default-avatars/1.png"},z2e=class{constructor(i,e,t,r){this.participants=[],this.isAttached=!1,this.currentLocalPointerDest=new Se(0,0,0),this.avatars={},this.lasers={},this.mouses={},this.names={},this.positionInfos={},this.laserUpdateIntervals={},this.syncInterval=null,this.tempQuat=new pu(0,0,0,0),this.mouse=new mi(0,0),this.mouse3D=new Se(0,0,0),this.worldPosition=new Se(0,0,0),this.worldQuat=new pu(0,0,0,0),this.unsubscribeFrom=[],this.attach=f=>{if(Object.values(f).includes(null)||Object.values(f).includes(void 0)){let b=`${this.name} @ attach - params are required`;throw this.logger.log(b),new Error(b)}let{realtime:m,eventBus:g,useStore:y}=f,{localParticipant:_}=y.call(this,"global-store");_.subscribe(),this.realtime=m,this.isAttached=!0,this.eventBus=g,this.logger.log("attached"),this.start()},this.detach=()=>{if(!this.isAttached){this.logger.log(`${this.name} @ detach - component is not attached}`);return}this.logger.log("detached"),this.destroy(),this.unsubscribeFrom.forEach(f=>f(this)),this.realtime=void 0,this.localParticipant=void 0,this.isAttached=!1},this.destroy=()=>{this.unsubscribeToRealtimeEvents(),this.unsubscribeToEventBusEvents(),this.realtime.leavePresence3DChannel(),this.participants.forEach(f=>{this.removeParticipant(f,!0)}),Object.keys(this.laserUpdateIntervals).forEach(f=>{clearInterval(this.laserUpdateIntervals[f])}),window.removeEventListener("pointermove",this.onPointerMove),clearInterval(this.syncInterval),this.laserUpdateIntervals={},this.avatars={},this.lasers={},this.positionInfos={},this.realtime=void 0},this.start=f=>{if(f||this.realtime.enterPresence3DChannel(this.localParticipant),!this.realtime.isJoinedRoom||!this.realtime.isJoinedPresence3D){this.logger.log("three js component @ start - not joined yet"),setTimeout(()=>{this.logger.log("three js component @ start - retrying"),this.start(!0)},1e3);return}this.subscribeToRealtimeEvents(),this.subscribeToEventBusEvents()},this.subscribeToRealtimeEvents=()=>{this.logger.log("three js component @ subscribeToRealtimeEvents"),this.realtime.presence3dObserver.subscribe(this.onParticipantsUpdated),this.realtime.presence3dJoinedObserver.subscribe(this.onParticipantJoined),this.realtime.presence3dLeaveObserver.subscribe(this.onParticipantLeave),this.realtime.roomInfoUpdatedObserver.subscribe(this.onRoomInfoUpdate)},this.unsubscribeToRealtimeEvents=()=>{this.logger.log("three js component @ unsubscribeToRealtimeEvents"),this.realtime.presence3dJoinedObserver.unsubscribe(this.onParticipantJoined),this.realtime.presence3dLeaveObserver.unsubscribe(this.onParticipantLeave),this.realtime.presence3dObserver.unsubscribe(this.onParticipantsUpdated),this.realtime.roomInfoUpdatedObserver.unsubscribe(this.onRoomInfoUpdate)},this.subscribeToEventBusEvents=()=>{this.logger.log("three js component @ subscribeToEventBusEvents"),this.eventBus.subscribe("realtime.go-to-participant",this.goTo),this.eventBus.subscribe("realtime.local-follow-participant",this.localFollow),this.eventBus.subscribe("realtime.follow",this.follow),this.eventBus.subscribe("realtime.private-mode",this.setPrivate)},this.unsubscribeToEventBusEvents=()=>{this.logger.log("three js component @ unsubscribeToEventBusEvents"),this.eventBus.unsubscribe("realtime.go-to-participant",this.goTo),this.eventBus.unsubscribe("realtime.local-follow-participant",this.localFollow),this.eventBus.unsubscribe("realtime.follow",this.follow),this.eventBus.unsubscribe("realtime.private-mode",this.setPrivate)},this.onParticipantJoined=f=>{if(!f.data)return;this.logger.log("three js component @ onParticipantJoined",f);let{id:m,name:g,avatar:y,avatarConfig:_,type:b}=f.data;m===this.localParticipantId&&this.onParticipantLocalJoined(f),this.addParticipant({id:m,name:g,avatar:y,avatarConfig:_,type:b})},this.onParticipantLocalJoined=f=>{var m,g,y,_;this.createParticipantList(),this.config.avatarConfig&&this.realtime.setParticipantData({avatarConfig:this.config.avatarConfig}),(m=f==null?void 0:f.avatar)!=null&&m.model3DUrl&&this.realtime.setParticipantData({avatar:{model3DUrl:f==null?void 0:f.avatar.model3DUrl,imageUrl:(g=f==null?void 0:f.avatar)==null?void 0:g.imageUrl}}),(y=f==null?void 0:f.avatar)!=null&&y.model3DUrl||this.realtime.setParticipantData({avatar:{model3DUrl:VD.model3DUrl,imageUrl:(_=f==null?void 0:f.avatar)==null?void 0:_.imageUrl}})},this.onParticipantLeave=f=>{this.logger.log("three js component @ onParticipantLeave",f);let m=this.participants.find(g=>g.id===f.clientId);!m||this.removeParticipant(m,!0)},this.onParticipantUpdated=f=>{var m,g;this.logger.log("three js component @ onParticipantUpdated",f);let{id:y,name:_,avatar:b,avatarConfig:S,position:E,rotation:T,type:A}=(m=f.data)!=null?m:f,P=(g=this.followParticipantId)!=null?g:this.localFollowParticipantId;P&&P===y&&this.moveToAnotherParticipant(P),this.updateParticipant({position:E,rotation:T,id:y,name:_,avatar:b,avatarConfig:S,type:A})},this.updateParticipant=f=>Wa(this,null,function*(){var m,g;if(!this.participants||this.participants.length===0||!f||!f.id)return;let y=this.participants.find(_=>_.id===f.id);if(!y){this.addParticipant(f);return}if(((m=y.avatar)==null?void 0:m.model3DUrl)!==((g=f.avatar)==null?void 0:g.model3DUrl)||!(0,cS.isEqual)((0,cS.pickBy)(y.avatarConfig,cS.identity),(0,cS.pickBy)(f.avatarConfig,cS.identity))||y.name!==f.name){this.removeParticipant(f,!1);let _=this.createParticipantOn3D(f);this.participants.push(_),(y.id!==this.localParticipantId||this.config.renderLocalAvatar)&&this.create3dPresence(_)}else{let _=this.participants.findIndex(b=>b.id===f.id);_!==-1&&(this.participants[_]=f)}this.logger.log("three js component @ updateParticipant",{participant:f,participants:this.participants})}),this.onRoomInfoUpdate=f=>{this.logger.log("three js component @ onRoomInfoUpdate",f);let{gather:m,hostClientId:g,followParticipantId:y}=f;this.followParticipantId=y,m&&this.moveToAnotherParticipant(g),this.realtime.hostClientId===this.localParticipant.id&&m&&this.realtime.setGather(!1)},this.createParticipantList=()=>{let f=this.realtime.getParticipants;Object.values(f).forEach(m=>{let{data:g}=m;this.addParticipant(g)}),this.logger.log("three js component @ createParticipantList",this.participants)},this.createParticipantOn3D=({id:f,name:m,avatar:g,avatarConfig:y,type:_})=>{let b={id:f,name:m,avatar:g,isAudience:_==="audience",avatarConfig:f===this.localParticipantId?this.config.avatarConfig:y,position:{x:0,y:0,z:0},rotation:{x:0,y:0}};return this.logger.log("three js component @ createParticipantOn3D",b),b},this.removeParticipant=(f,m)=>{this.logger.log("three js component @ removeParticipant",{participant:f,unsubscribe:m}),this.participants=this.participants.filter(g=>g.id!==f.id),this.destroyAvatar(f),this.destroyLaser(f),this.destroyMouse(f),m&&this.realtime.unsubscribeFromParticipant3DUpdate(f.id,this.onParticipantUpdated)},this.addParticipant=f=>Wa(this,null,function*(){if(!f||!f.id||f.type==="audience")return;let m=this.createParticipantOn3D(f);if(this.participants.find(g=>g.id===m.id)){this.logger.log("three js component @ addParticipant - participant already exists"),this.onParticipantUpdated(f);return}this.participants.push(m),this.logger.log("three js component @ addParticipant",{participant:f,participantOn3D:m,participants:this.participants}),this.realtime.subscribeToParticipant3DUpdate(m.id,this.onParticipantUpdated),!(f.id===this.localParticipantId&&!this.config.renderLocalAvatar)&&this.create3dPresence(m)}),this.goTo=f=>{this.logger.log("three js component @ goTo",f),this.moveToAnotherParticipant(f)},this.setPrivate=f=>{this.logger.log("three js component @ private mode"),this.realtime.updatePresence3D({id:this.localParticipantId,isPrivate:f})},this.localFollow=f=>{this.localFollowParticipantId=f},this.onParticipantsUpdated=f=>{!this.isAttached||Object.values(f).forEach(m=>{if(m.clientId===this.localParticipantId)return;if(!this.participants.find(P=>P.id===m.clientId)){this.addParticipant(m.data);return}let g=m.clientId,{position:y,quaternion:_,pointer:b,isPrivate:S}=m.data,E=this.realtime.getParticipantSlot(g);this.positionInfos[g]={position:y,quaternion:_,pointer:b},S&&this.avatars[g]&&this.removeParticipant(m.data,!0),!S&&!this.avatars[g]&&this.addParticipant(m.data);let T=this.avatars[g];T&&(y&&_&&this.updateAvatar(T,y,_),T.root.getWorldQuaternion(this.tempQuat),this.names[g]&&E!==void 0&&this.names[g].slot!==E&&(this.names[g].slot=E,this.names[g].text.material.color=new Tr(fI[E]),this.names[g].text.backgroundColor=kp[E]));let A=this.lasers[g];A&&(this.laserUpdateIntervals[g]&&clearInterval(this.laserUpdateIntervals[g]),this.laserUpdateIntervals[g]=setInterval(()=>{this.updateLaser(A,y,b,this.tempQuat,E)},30)),this.mouses[g]&&this.mouses[g].update(b,E)})};var n,l,c,h,d;this.name="presence3dThreejs",this.logger=new yU("@superviz/sdk/three-js-component"),this.logger.log("three js component @ constructor",{scene:i,camera:e,player:t,options:r}),this.config={isAvatarsEnabled:(n=r==null?void 0:r.isAvatarsEnabled)!=null?n:!0,isLaserEnabled:(l=r==null?void 0:r.isLaserEnabled)!=null?l:!0,isNameEnabled:(c=r==null?void 0:r.isNameEnabled)!=null?c:!0,isMouseEnabled:(h=r==null?void 0:r.isMouseEnabled)!=null?h:!0,renderLocalAvatar:(d=r==null?void 0:r.renderLocalAvatar)!=null?d:!1,avatarConfig:r==null?void 0:r.avatarConfig},this.logger.log("three js component @ constructor - config",this.config),Op.prototype.computeBoundsTree=NCe,Op.prototype.disposeBoundsTree=DCe,Sw.prototype.raycast=OCe,this.createdPointerMoveEvent=!1,this.scene=i,this.camera=e,this.player=t,this.syncInterval=window.setInterval(this.checkPlayerChanges.bind(this),30)}get localParticipantId(){return this.localParticipant.id}create3dPresence(i){return Wa(this,null,function*(){if(this.config.isAvatarsEnabled){let e=yield this.createAvatar(i);this.config.isNameEnabled&&this.createName(i,e)}this.config.isMouseEnabled&&this.createMouse(i),this.config.isLaserEnabled&&this.createLaser(i)})}gather(){this.logger.log("three js component @ gather"),this.realtime.setGather(!0)}follow(i){this.logger.log("three js component @ follow"),this.realtime.setFollowParticipant(i)}destroyAvatar(i){return Wa(this,null,function*(){this.avatars[i.id]&&(this.mouses[i.id]&&this.mouses[i.id].destroy(),this.avatars[i.id].destroy(),delete this.avatars[i.id],this.avatars[i.id]=null,this.mouses[i.id]=null)})}destroyLaser(i){return Wa(this,null,function*(){this.lasers[i.id]&&(this.lasers[i.id].destroy(),delete this.lasers[i.id],this.lasers[i.id]=null)})}destroyMouse(i){return Wa(this,null,function*(){this.mouses[i.id]&&(this.mouses[i.id].destroy(),delete this.mouses[i.id],this.mouses[i.id]=null)})}moveToAnotherParticipant(i){if(i===this.localParticipantId||!this.positionInfos[i])return;let e=this.positionInfos[i].position,t=this.positionInfos[i].quaternion,r=setInterval(()=>{let n=this.player.position.clone();n.lerp(e,.1),this.player.position.set(n.x,n.y,n.z);let l=this.player.quaternion.clone();l.slerp(t,.1),this.player.quaternion.set(l.x,l.y,l.z,l.w)},1);setTimeout(()=>{clearInterval(r)},1e3)}createAvatar(i){return Wa(this,null,function*(){var e,t,r,n;if(!this.isAttached)return;this.avatars[i.id]&&this.avatars[i.id].destroy();let l=i.id===this.localParticipantId;if(l&&!this.config.renderLocalAvatar)return;let c=((e=i.avatarConfig)==null?void 0:e.scale)||1,h=((t=i.avatarConfig)==null?void 0:t.height)||0,d=(n=(r=i.avatar)==null?void 0:r.model3DUrl)!=null?n:VD.model3DUrl,f=new g2e(d,c,h,l),m=yield f.load();return this.avatars[i.id]&&this.avatars[i.id].root.parent.remove(this.avatars[i.id].root),this.scene.add(m),this.avatars[i.id]=f,this.lasers[i.id]&&this.scene.add(this.lasers[i.id].root),l&&(this.myAvatar=f),m})}createName(i,e){return Wa(this,null,function*(){var t,r;if(!this.isAttached||!i.name.trim().length)return;e.traverse(_=>{_.geometry&&_.geometry.computeBoundingBox()});let n=((r=(t=i.avatar)==null?void 0:t.model3DUrl)!=null?r:VD.model3DUrl).includes("readyplayerme"),l=new Co().setFromObject(e),c=new Se(0,0,0);l.getSize(c);let h=this.realtime.getParticipantSlot(i.id),d=c.y*1.2;n&&(d=c.y*2.8);let f=20,m=l.max.y/f,g=new L2e(i.name,h,d,m),y=yield g.load();e.add(y),this.names[i.id]=g})}createLaser(i){return Wa(this,null,function*(){var e;if(this.logger.log("three js component @ createLaser",i),!this.isAttached||!i.avatarConfig||i.id===this.localParticipantId&&!this.config.renderLocalAvatar)return;this.lasers[i.id]&&this.lasers[i.id].destroy();let t=new Se(0,0,0);(e=i.avatarConfig)!=null&&e.laserOrigin&&(t=new Se(i.avatarConfig.laserOrigin.x,i.avatarConfig.laserOrigin.y,i.avatarConfig.laserOrigin.z));let r=new O2e(this.camera,this.scene,t);this.lasers[i.id]=r,r.load(),this.createdPointerMoveEvent||(this.createdPointerMoveEvent=!0,window.addEventListener("pointermove",this.onPointerMove.bind(this)))})}createMouse(i){if(!this.isAttached||i.id===this.localParticipantId&&!this.config.renderLocalAvatar)return;this.mouses[i.id]&&this.mouses[i.id].destroy();let e=new N2e(this.scene);this.mouses[i.id]=e;let t=this.realtime.getParticipantSlot(i.id);e.load(i.name,t),this.raycaster=new cI,this.createdPointerMoveEvent||(this.createdPointerMoveEvent=!0,window.addEventListener("pointermove",this.onPointerMove.bind(this)))}onPointerMove(i){this.mouse.x=i.clientX/window.innerWidth*2-1,this.mouse.y=-(i.clientY/window.innerHeight)*2+1,this.raycaster===void 0&&(this.raycaster=new cI),this.raycaster.setFromCamera(this.mouse,this.camera);let e=this.raycaster.intersectObjects(this.scene.children,!0);if(e.length>0){let{point:t}=e[0];this.camera.getWorldPosition(this.mouse3D),t.lerp(this.mouse3D,.005),this.currentLocalPointerDest=t}}checkPlayerChanges(){var i;if(this.realtime){this.player.getWorldPosition(this.worldPosition),this.player.getWorldQuaternion(this.worldQuat);let e={position:{x:this.worldPosition.x,y:this.worldPosition.y,z:this.worldPosition.z},quaternion:{x:this.worldQuat.x,y:this.worldQuat.y,z:this.worldQuat.z,w:this.worldQuat.w},pointer:{x:this.currentLocalPointerDest.x,y:this.currentLocalPointerDest.y,z:this.currentLocalPointerDest.z}},t=(i=this.realtime.participantsOn3d)==null?void 0:i[this.localParticipantId],r={position:t==null?void 0:t.data.position,quaternion:t==null?void 0:t.data.quaternion,pointer:t==null?void 0:t.data.pointer};(0,cS.isEqual)(e,r)||this.realtime.updatePresence3D(iR({id:this.localParticipantId},e));let n=this.avatars[this.localParticipantId],l=this.realtime.getParticipantSlot(this.localParticipantId);n&&(this.updateAvatar(n,this.worldPosition,this.worldQuat),n.model.getWorldPosition(this.worldPosition),n.model.getWorldQuaternion(this.tempQuat),this.names[this.localParticipantId]&&l!==void 0&&this.names[this.localParticipantId].slot!==l&&this.names[this.localParticipantId].text&&(this.names[this.localParticipantId].slot=l,this.names[this.localParticipantId].text.material.color=new Tr(fI[l]),this.names[this.localParticipantId].text.backgroundColor=kp[l])),this.lasers[this.localParticipantId]&&this.updateLaser(this.lasers[this.localParticipantId],this.worldPosition,this.currentLocalPointerDest,this.tempQuat,l),this.mouses[this.localParticipantId]&&this.mouses[this.localParticipantId].update(this.currentLocalPointerDest,l)}}updateAvatar(i,e,t){!this.isAttached||!i||!e||!t||(i.setPosition(e),i.setQuaternion(t))}updateLaser(i,e,t,r,n){!e||!t||!r||n===void 0||i.update(e,t,r,n)}};window&&(window.Presence3D=z2e,window.ThreeJsPin=F2e);/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 *//**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var DY={exports:{}},AT={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cj;function B2e(){if(Cj)return AT;Cj=1;var i=vi,e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,n=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(h,d,f){var m,g={},y=null,_=null;f!==void 0&&(y=""+f),d.key!==void 0&&(y=""+d.key),d.ref!==void 0&&(_=d.ref);for(m in d)r.call(d,m)&&!l.hasOwnProperty(m)&&(g[m]=d[m]);if(h&&h.defaultProps)for(m in d=h.defaultProps,d)g[m]===void 0&&(g[m]=d[m]);return{$$typeof:e,type:h,key:y,ref:_,props:g,_owner:n.current}}return AT.Fragment=t,AT.jsx=c,AT.jsxs=c,AT}DY.exports=B2e();var pw=DY.exports;const Pj=i=>({[Ru.JOINED]:i.onParticipantJoined,[Ru.LEFT]:i.onParticipantLeft,[Ru.LIST_UPDATED]:i.onParticipantListUpdated,[Ru.LOCAL_JOINED]:i.onParticipantLocalJoined,[Ru.LOCAL_LEFT]:i.onParticipantLocalLeft,[Ru.LOCAL_UPDATED]:i.onParticipantLocalUpdated}),kY=Ze.createContext({hasProvider:!1,room:null});function BC(i){const{hasProvider:e,...t}=Ze.useContext(kY);return Ze.useEffect(()=>{e||console.error("[SuperViz] You need to wrap your component with SuperVizRoomProvider")},[e]),i?{...t,component:t.activeComponents[i]}:t}function U2e(i){const{roomId:e,group:t,debug:r,children:n,environment:l,participant:c,developerKey:h,customColors:d,onParticipantJoined:f,onParticipantLeft:m,onParticipantListUpdated:g,onParticipantLocalJoined:y,onParticipantLocalLeft:_,onParticipantLocalUpdated:b}=i,[S,E]=Ze.useState(!1),[T,A]=Ze.useState(null),[P,O]=Ze.useState(null),R=Ze.useRef({}),D=Ze.useRef(!1);Ze.useEffect(()=>{if(!(!N||S))return D.current||N(),()=>{!U||!S||U()}},[]),Ze.useEffect(()=>{const $=Pj(i);!T||Pp.isEqual(P,$)||L(T,i)},[f,m,g,y,_,b,T]),Ze.useEffect(()=>{S&&(T==null||T.unsubscribe(Ru.LOCAL_UPDATED),T==null||T.subscribe(Ru.LOCAL_UPDATED,G))},[T,R]);function L($,H){const X=Pj(H);Object.entries(X).forEach(([re,ae])=>{const he=H[re];(!ae&&he||ae!==he)&&$.unsubscribe(re),ae&&$.subscribe(re,ae)}),O(X)}async function N(){if(S||T){console.log("[SuperViz] Room already started");return}try{D.current=!0;const $=await nxe(h,{participant:c,roomId:e,group:t,environment:l,debug:r,customColors:d});L($,i),A($),$.subscribe(Ru.LOCAL_UPDATED,G),$.subscribe(Ru.LOCAL_JOINED,J),$.subscribe(Ru.LOCAL_LEFT,Z)}catch($){D.current=!1,console.error("[SuperViz] Error starting room",$)}D.current=!1}function U(){if(!T){console.error("[SuperViz] Room not started yet, you need to start the room before stopping it");return}T.destroy(),R.current={},A(null),E(!1)}function F($){T&&(R.current[$.name]||T==null||T.addComponent($),R.current[$.name]=$)}function z($){T&&(R.current[$.name]&&(T==null||T.removeComponent($)),delete R.current[$.name])}function G($){b&&b($),$!=null&&$.activeComponents&&Object.keys(R).forEach(H=>{var X;(X=$.activeComponents)!=null&&X.includes(H)||delete R.current[H]})}function J(){E(!0)}function Z(){E(!1)}const q=Ze.useMemo(()=>({hasProvider:!0,hasJoinedRoom:S,room:T,addComponent:F,removeComponent:z,activeComponents:R.current}),[T,h,c,e,t,R,S]);return pw.jsx(kY.Provider,{value:q,children:n})}function H2e({pin:i,children:e,onPinActive:t,onPinInactive:r,onMount:n,onUnmount:l,...c}){const{room:h,component:d,addComponent:f}=BC("comments"),[m,g]=Ze.useState(null),y={"pin-mode.active":t,"pin-mode.inactive":r,mount:n,unmount:l};return Ze.useEffect(()=>{d&&Object.entries(y).forEach(([_,b])=>{d.unsubscribe(_,b),b&&d.subscribe(_,b)})},[d,h,t,r,n,l]),Ze.useEffect(()=>{if(!h||m||!i)return;const _=new aJ(i,{...c});f(_),g(Date.now())},[h,i]),Ze.useEffect(()=>{!d&&m&&g(null)},[d]),e??pw.jsx(pw.Fragment,{})}function $2e({children:i,elementId:e,onMount:t,onUnmount:r,transform:n,...l}){const[c,h]=Ze.useState(null),{room:d,component:f,addComponent:m}=BC("presence"),g={mount:t,unmount:r};return Ze.useEffect(()=>{f&&Object.entries(g).forEach(([y,_])=>{f.unsubscribe(y,_),_&&f.subscribe(y,_)})},[f,d,t,r]),Ze.useEffect(()=>{n&&(f==null||f.transform(n))},[n]),Ze.useEffect(()=>{var y;if(!d||c||!document.getElementById(e))return;const _=(y=l.callbacks)==null?void 0:y.onGoToPresence,b=new hJ(e,{callbacks:{onGoToPresence:_}});m(b),h(Date.now())},[d,e]),Ze.useEffect(()=>{!f&&c&&h(null)},[f]),i??pw.jsx(pw.Fragment,{})}function V2e({position:i,styles:e,onMount:t,onUnmount:r,...n}){const{room:l,component:c,addComponent:h}=BC("whoIsOnline"),[d,f]=Ze.useState(null),m={mount:t,unmount:r};return Ze.useEffect(()=>{c&&Object.entries(m).forEach(([g,y])=>{c.unsubscribe(g,y),y&&c.subscribe(g,y)})},[c,l,t,r]),Ze.useEffect(()=>{if(!l||d)return;const g=new mJ({position:i,styles:e,...n});h(g),f(Date.now())},[l]),Ze.useEffect(()=>{!c&&d&&f(null)},[c]),pw.jsx(pw.Fragment,{})}function W2e({canvasId:i,onGoToPin:e}){const{room:t}=BC(),r=Ze.useRef(!1),n=Ze.useRef(null);function l(c){e&&e(c)}if(Ze.useEffect(()=>{var c;!t&&r.current&&(r.current=!1,(c=n.current)==null||c.destroy(),n.current=null)},[t]),!i||!document.getElementById(i))return{pin:null,destroy:()=>{}};if(!r.current){r.current=!0;const c=new oJ(i,{onGoToPin:l});n.current=c}return{pin:n.current,destroy:()=>{var c;(c=n.current)==null||c.destroy(),n.current=null}}}function j2e(){const{component:i,...e}=BC("comments");return Ze.useMemo(()=>i?{isReady:!0,openThreads:()=>{i.openThreads()},closeThreads:()=>{i.closeThreads()},enable:()=>{i.enable()},disable:()=>{i.disable()}}:{isReady:!1,openThreads:()=>{},closeThreads:()=>{},enable:()=>{},disable:()=>{}},[i,e.room,e.activeComponents])}const Rj=[{selector:"#online",content:`
      <h3>This is your avatar!</h3> 
      Click on John's avatar (you) for controls as 'everyone follows me' and 'gather all”
    `,position:"bottom",style:{left:-85,top:18}},{selector:"#online",content:`
      <h3>Others user's avatars</h3> 
      See the avatars of who is online inside the same room.
    `,position:"bottom",style:{left:-41,top:15}},{selector:"#comments-button",content:`
      <h3>Contextual Comments</h3>
      Click the comments button to add a new comment or view all comments with  sidebar.
    `,position:"bottom",style:{left:3,top:15}}],G2e=[{name:"Anna",color:"#304AFF"},{name:"Matt",color:"#FF89C4"}],q2e=`
  .bottom-side {
    top: calc(100% + 9px);
  }
`,X2e=`
  .container {
    top: 55px;
  } 
`,Z2e=[{userId:"Matt",position:JSON.stringify({x:836,y:501,type:"canvas"}),comments:[{userId:"Matt",text:"You can also mention someone, reply to this comment, or even mark it as resolved."}]},{userId:"Anna",position:JSON.stringify({x:365,y:361,type:"canvas"}),comments:[{userId:"Anna",text:"Welcome @John! Try adding a comment by clicking anywhere on the whiteboard.",mention:"John"}]}],FY=[{id:"Matt",src:"./assets/elements/cursors/matt.svg",steps:[{x:750,y:450},{x:1050,y:600},{x:1050,y:950},{x:1400,y:1100},{x:800,y:1100}],x:200,y:250},{id:"Anna",src:"./assets/elements/cursors/anna.svg",steps:[{x:800,y:250},{x:500,y:550},{x:200,y:250}],x:800,y:250}],J2e=FY.map(i=>{const e=new Image;return e.src=i.src,{...i,image:e}}),Y2e=FY.map(i=>({id:i.id,atualStep:0,x:i.steps[0].x,y:i.steps[0].y})),K2e=[{content:"Add collaboration",x:113,y:155,fontSize:30,fontFamily:"Roboto",fontWeight:"700"},{content:"to your whiteboard",x:113,y:190,fontSize:30,fontFamily:"Roboto",fontWeight:"700"},{content:"with SuperViz",x:113,y:225,fontSize:30,fontFamily:"Roboto",fontWeight:"700"},{content:"try",x:755,y:97,fontSize:14,fontFamily:"Permanent Marker",fontWeight:"400"},{content:"comments",x:733,y:121,fontSize:14,fontFamily:"Permanent Marker",fontWeight:"400"},{content:"see who",x:842,y:111,fontSize:14,fontFamily:"Permanent Marker",fontWeight:"400"},{content:"is online",x:838,y:135,fontSize:14,fontFamily:"Permanent Marker",fontWeight:"400"}],Q2e=[{src:"./assets/elements/shapes/circle.svg",x:678,y:41},{src:"./assets/elements/steps.svg",x:122,y:378},{src:"./assets/elements/shapes/yellow-rect.svg",x:178,y:205},{src:"./assets/elements/purpleStickyNotes/04.svg",x:660,y:138},{src:"./assets/elements/purpleStickyNotes/01.svg",x:1181,y:1075},{src:"./assets/elements/purpleStickyNotes/02.svg",x:1283,y:1075},{src:"./assets/elements/purpleStickyNotes/03.svg",x:1385,y:1075},{src:"./assets/elements/greenStickyNotes/01.svg",x:1186,y:883},{src:"./assets/elements/greenStickyNotes/02.svg",x:1290,y:883},{src:"./assets/elements/greenStickyNotes/03.svg",x:1390,y:883},{src:"./assets/elements/yellowStickyNotes/01.svg",x:791,y:882},{src:"./assets/elements/yellowStickyNotes/02.svg",x:893,y:882},{src:"./assets/elements/yellowStickyNotes/03.svg",x:996,y:882},{src:"./assets/elements/blueStickyNotes/01.svg",x:791,y:1076},{src:"./assets/elements/blueStickyNotes/02.svg",x:893,y:1076},{src:"./assets/elements/blueStickyNotes/03.svg",x:995,y:1075},{src:"./assets/elements/shapes/line-horizontal.svg",x:775,y:1027},{src:"./assets/elements/shapes/line-vertical.svg",x:1136,y:859},{src:"./assets/elements/shapes/vector-curved.svg",x:758,y:12},{src:"./assets/elements/shapes/vector-straigth.svg",x:859,y:20}],e3e=Q2e.map(i=>{const e=new Image;return e.src=i.src,{...i,image:e}}),t3e=async(i,e,t,r)=>{const n=document.querySelector("superviz-who-is-online");if(!n)return;const l=n.shadowRoot;for(const c of G2e){const h=zY(l,c.name);h&&(r(!0),i3e(c,h,i,l),r3e(c.name,h,t,e))}},zY=(i,e)=>{const t=i==null?void 0:i.querySelector(`[name="${e}"]`);return t==null?void 0:t.shadowRoot},i3e=(i,e,t,r)=>{var c;const n=e==null?void 0:e.querySelectorAll(".text-bold")[1],l=(c=r==null?void 0:r.querySelector("superviz-who-is-online-messages"))==null?void 0:c.shadowRoot;n==null||n.addEventListener("click",()=>{t.current=i.name;const h=l==null?void 0:l.querySelector(".who-is-online__following-message");h==null||h.setAttribute("style",`border-color: ${i.color}`);const d=h==null?void 0:h.querySelector(".who-is-online__presence-control-message__cancel-action-button");d==null||d.addEventListener("click",()=>{t.current=null})})},r3e=(i,e,t,r)=>{const n=e==null?void 0:e.querySelectorAll(".text-bold")[0];n==null||n.addEventListener("click",()=>{const l=t.current.find(c=>c.id===i);l&&(r.current={x:-(l==null?void 0:l.x)+window.innerWidth/2,y:-(l==null?void 0:l.y)+window.innerHeight/2})})},n3e=(i,e,t,r)=>{const n=document.querySelector("superviz-who-is-online");if(!n)return;const l=n.shadowRoot,c=zY(l,"John (you)");c&&(i(!0),s3e(c,e,r),a3e(c,l,t))},s3e=(i,e,t)=>{const r=i.querySelectorAll(".text-bold")[0];r==null||r.addEventListener("click",()=>{for(const n of e.current)n.x=-t.current.x+window.innerWidth/2,n.y=-t.current.y+window.innerHeight/2,n.atualStep=0})},a3e=(i,e,t)=>{var l;const r=i.querySelectorAll(".text-bold")[1],n=(l=e==null?void 0:e.querySelector("superviz-who-is-online-messages"))==null?void 0:l.shadowRoot;r==null||r.addEventListener("click",()=>{t.current=!0;const c=n==null?void 0:n.querySelector(".who-is-online__presence-control-message__cancel-action-button");c==null||c.addEventListener("click",()=>{t.current=!1})})},o3e=()=>{const i=Ze.useRef(!1),e=Ze.useRef({x:0,y:0}),t=Ze.useRef(1),r=Ze.useRef(),n=Ze.useRef({x:0,y:0}),l=Ze.useRef(1),c=Ze.useRef(Y2e),h=Ze.useRef(null),d=Ze.useRef(!1),f=Ze.useRef({}),[m,g]=Ze.useState(!1),[y,_]=Ze.useState(!1),{openThreads:b}=j2e(),S=G=>{n.current.x=G.x,n.current.y=G.y},{pin:E}=W2e({canvasId:"canvas-whiteboard",onGoToPin:S}),T=()=>{const J=r.current.getContext("2d");K2e.forEach(Z=>{J.font=`${Z.fontWeight} ${Z.fontSize}px ${Z.fontFamily}`,J.fillText(Z.content,Z.x,Z.y)})},A=(G,J)=>{if(!f.current[J.src]){const Z=new Image;Z.src=J.src,f.current[J.src]=Z}G.drawImage(f.current[J.src],J.x,J.y)},P=()=>{const J=r.current.getContext("2d");e3e.forEach(Z=>{A(J,Z)})},O=()=>{const J=r.current.getContext("2d"),Z=2;if(J2e.forEach((q,$)=>{const H=c.current[$];d.current&&(H.x=-n.current.x+window.innerWidth/2+$*100,H.y=-n.current.y+window.innerHeight/2);const X=q.steps[H.atualStep===q.steps.length-1?0:H.atualStep+1];X.x>H.x&&(H.x+=Z),X.x<H.x&&(H.x-=Z),X.y>H.y&&(H.y+=Z),X.y<H.y&&(H.y-=Z),H.x===X.x&&H.y===X.y&&(H.atualStep===q.steps.length-1?H.atualStep=0:H.atualStep+=1),A(J,{src:q.src,x:H.x,y:H.y})}),h.current!==null){const q=c.current.find($=>$.id===h.current);n.current.x=-q.x+window.innerWidth/2,n.current.y=-q.y+window.innerHeight/2}},R=(G,J,Z)=>{G.save(),G.strokeStyle=Z,G.lineWidth=l.current/2;const q={x:n.current.x%J-J,y:n.current.y%J-J};for(let $=q.x;$<G.canvas.width;$+=J)G.beginPath(),G.moveTo($,0),G.lineTo($,G.canvas.height),G.stroke();for(let $=q.y;$<G.canvas.height;$+=J)G.beginPath(),G.moveTo(0,$),G.lineTo(G.canvas.width,$),G.stroke();G.restore()},D=Ze.useCallback(async()=>{const G=r.current,J=G.getContext("2d");G.width=window.innerWidth,G.height=window.innerHeight,R(J,l.current*20,"#ddd"),J.translate(window.innerWidth/2,window.innerHeight/2),J.scale(l.current,l.current),J.translate(-window.innerWidth/2+n.current.x,-window.innerHeight/2+n.current.y),P(),T(),O(),J.save(),requestAnimationFrame(D)},[l,n]),L=G=>G.touches&&G.touches.length==1?{x:G.touches[0].clientX,y:G.touches[0].clientY}:G.clientX&&G.clientY?{x:G.clientX,y:G.clientY}:{y:0,x:0},N=G=>{i.current=!0,e.current.x=L(G).x/l.current-n.current.x,e.current.y=L(G).y/l.current-n.current.y},U=()=>{i.current=!1,t.current=l.current},F=G=>{i.current&&(n.current.x=L(G).x/l.current-e.current.x,n.current.y=L(G).y/l.current-e.current.y)},z=G=>{if(G.deltaY<0)l.current=l.current+.1;else{if(l.current<=.6)return;l.current=l.current-.1}};return Ze.useEffect(()=>{const G=r.current;return G.addEventListener("mousedown",N),G.addEventListener("mouseup",U),G.addEventListener("mousemove",F),G.addEventListener("wheel",z),()=>{G.removeEventListener("mousedown",N),G.removeEventListener("mouseup",U),G.removeEventListener("mousemove",F),G.removeEventListener("wheel",z)}},[]),Ze.useEffect(()=>{D()},[]),Ze.useEffect(()=>{(async()=>m||(await new Promise(G=>setTimeout(G,2e3)),t3e(h,n,c,g)))()},[m]),Ze.useEffect(()=>{(async()=>y||(await new Promise(G=>setTimeout(G,2e3)),n3e(_,c,d,n)))()},[y]),$t.jsxs("div",{className:"canvas-whiteboard",children:[$t.jsx(H2e,{styles:X2e,onPinActive:b,pin:E,buttonLocation:"comments-button",position:"right",children:$t.jsx("canvas",{id:"canvas-whiteboard",ref:r,width:innerWidth,height:innerHeight})}),$t.jsx($2e,{elementId:"hidden-canvas",children:$t.jsx("canvas",{id:"hidden-canvas",style:{display:"none"}})}),$t.jsx(yIe,{placement:"left"})]})};var Ij="focus-outline-hidden";function BY(){var i=this;document.addEventListener("keydown",function(e){i.focusByKeyboard=!0},!0),document.addEventListener("mousedown",function(e){i.focusByKeyboard=!1},!0),document.addEventListener("focus",function(e){i.updateVisibility()},!0),document.addEventListener("focusout",function(e){window.setTimeout(function(){document.hasFocus()||(i.focusByKeyboard=!0,i.updateVisibility())},0)}),this.updateVisibility()}BY.prototype={focusByKeyboard:!0,updateVisibility:function(){this.hidden=!this.focusByKeyboard},set hidden(i){document.documentElement.classList.toggle(Ij,i)},get hidden(){return document.documentElement.classList.contains(Ij)}};new BY;var UY={exports:{}};/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(i){(function(){var e={}.hasOwnProperty;function t(){for(var r=[],n=0;n<arguments.length;n++){var l=arguments[n];if(l){var c=typeof l;if(c==="string"||c==="number")r.push(l);else if(Array.isArray(l)){if(l.length){var h=t.apply(null,l);h&&r.push(h)}}else if(c==="object")if(l.toString===Object.prototype.toString)for(var d in l)e.call(l,d)&&l[d]&&r.push(d);else r.push(l.toString())}}return r.join(" ")}i.exports?(t.default=t,i.exports=t):window.classNames=t})()})(UY);var l3e=UY.exports;const Lj=Qd(l3e);var _4={exports:{}},x4={exports:{}},Mw={};Object.defineProperty(Mw,"__esModule",{value:!0});var u3e=Mw.easeFunctions={linear:function(e){return e},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return e*(2-e)},easeInOutQuad:function(e){return e<.5?2*e*e:-1+(4-2*e)*e},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return--e*e*e+1},easeInOutCubic:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return 1- --e*e*e*e},easeInOutQuart:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return 1+--e*e*e*e*e},easeInOutQuint:function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e}},c3e=Mw.isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)};Mw.setPosition=function(e,t,r,n){var l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"easeInOutCubic";return r>n?t:e+(t-e)*u3e[l](r/n)};Mw.calcEndPoint=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(c3e(e))return parseInt(e)+r;var n=t===window||t===document.documentElement?window.pageYOffset:t.scrollTop-t.getBoundingClientRect().top,l=e.nodeName.toLowerCase()==="html"?-n:e.getBoundingClientRect().top+n;return l+r};(function(i,e){Object.defineProperty(e,"__esModule",{value:!0});var t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},r=Mw;e.default=function(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c=l.duration,h=c===void 0?500:c,d=l.context,f=d===void 0?window:d,m=l.offset,g=m===void 0?0:m,y=l.ease,_=y===void 0?"easeInOutCubic":y,b=l.callback;if((typeof window>"u"?"undefined":t(window))==="object"){var S=f.scrollTop!==null&&f.scrollTop!==void 0?f.scrollTop:window.pageYOffset,E=(0,r.calcEndPoint)(n,f,g),T=performance.now(),A=window.requestAnimationFrame,P=function O(){var R=performance.now()-T,D=(0,r.setPosition)(S,E,R,h,_);f!==window?f.scrollTop=D:window.scroll(0,D),R>h?typeof b=="function"&&b(n):A(O)};P()}},i.exports=e.default})(x4,x4.exports);var HY=x4.exports,b4={exports:{}};(function(i,e){Object.defineProperty(e,"__esModule",{value:!0});var t=Object.assign||function(c){for(var h=1;h<arguments.length;h++){var d=arguments[h];for(var f in d)Object.prototype.hasOwnProperty.call(d,f)&&(c[f]=d[f])}return c},r=HY,n=l(r);function l(c){return c&&c.__esModule?c:{default:c}}e.default=function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},h=c.query,d=h===void 0?'[href^="#"]:not([href="#"]':h,f=c.match,m=f===void 0?function(E){return document.getElementById(E.hash.substring(1))}:f,g=c.hashChange,y=g===void 0?!0:g,_=c.scrollSmoothConfig,b=document.querySelectorAll(d),S=function(T){T.preventDefault();var A=m(T.target);A&&(y&&history.replaceState(null,null,"#"+A.id),(0,n.default)(A,t({},_)))};Array.from(b).map(function(E){E.addEventListener("click",S,!1)})},i.exports=e.default})(b4,b4.exports);var h3e=b4.exports,w4={exports:{}};(function(i,e){Object.defineProperty(e,"__esModule",{value:!0});function t(r){if(Array.isArray(r)){for(var n=0,l=Array(r.length);n<r.length;n++)l[n]=r[n];return l}else return Array.from(r)}e.default=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.activeClass,l=n===void 0?"active":n,c=r.query,h=c===void 0?'[href^="#"]:not([href="#"]):not([href="#0"])':c,d=r.threshold,f=d===void 0?[.25,.5,.75]:d,m=r.detectType,g=m===void 0?"max":m,y={threshold:f},_=function(D){return D.classList.remove(l)},b=function(D){return D.classList.add(l)},S=function(){document.querySelectorAll("."+l).forEach(_)},E=function(D){S(),b(document.querySelector('a[href="#'+D.id+'"]'))},T=function(D){D.forEach(function(L){L.intersectionRatio>=Math[g].apply(Math,t(f))&&E(L.target)})},A=document.querySelectorAll(h),P=new IntersectionObserver(T,y),O=function(D){var L=document.querySelector("#"+D.hash.slice(1));P.observe(L)};A.forEach(O)},i.exports=e.default})(w4,w4.exports);var d3e=w4.exports;(function(i,e){Object.defineProperty(e,"__esModule",{value:!0});var t=HY,r=f(t),n=Mw,l=h3e,c=f(l),h=d3e,d=f(h);function f(m){return m&&m.__esModule?m:{default:m}}e.default={to:r.default,calcEndPoint:n.calcEndPoint,anchorScroll:c.default,observe:d.default},i.exports=e.default})(_4,_4.exports);var f3e=_4.exports;const p3e=Qd(f3e);var $Y={exports:{}};(function(i){(function(e,t){i.exports?i.exports=t():e.Scrollparent=t()})(lu,function(){var e=/(auto|scroll)/,t=function(h,d){return h.parentNode===null?d:t(h.parentNode,d.concat([h]))},r=function(h,d){return getComputedStyle(h,null).getPropertyValue(d)},n=function(h){return r(h,"overflow")+r(h,"overflow-y")+r(h,"overflow-x")},l=function(h){return e.test(n(h))},c=function(h){if(h instanceof HTMLElement||h instanceof SVGElement){for(var d=t(h.parentNode,[]),f=0;f<d.length;f+=1)if(l(d[f]))return d[f];return document.scrollingElement||document.documentElement}};return c})})($Y);var m3e=$Y.exports;const g3e=Qd(m3e);var v3e="Expected a function",Oj=NaN,y3e="[object Symbol]",_3e=/^\s+|\s+$/g,x3e=/^[-+]0x[0-9a-f]+$/i,b3e=/^0b[01]+$/i,w3e=/^0o[0-7]+$/i,S3e=parseInt,M3e=typeof lu=="object"&&lu&&lu.Object===Object&&lu,E3e=typeof self=="object"&&self&&self.Object===Object&&self,T3e=M3e||E3e||Function("return this")(),A3e=Object.prototype,C3e=A3e.toString,P3e=Math.max,R3e=Math.min,WD=function(){return T3e.Date.now()};function I3e(i,e,t){var r,n,l,c,h,d,f=0,m=!1,g=!1,y=!0;if(typeof i!="function")throw new TypeError(v3e);e=Nj(e)||0,S4(t)&&(m=!!t.leading,g="maxWait"in t,l=g?P3e(Nj(t.maxWait)||0,e):l,y="trailing"in t?!!t.trailing:y);function _(D){var L=r,N=n;return r=n=void 0,f=D,c=i.apply(N,L),c}function b(D){return f=D,h=setTimeout(T,e),m?_(D):c}function S(D){var L=D-d,N=D-f,U=e-L;return g?R3e(U,l-N):U}function E(D){var L=D-d,N=D-f;return d===void 0||L>=e||L<0||g&&N>=l}function T(){var D=WD();if(E(D))return A(D);h=setTimeout(T,S(D))}function A(D){return h=void 0,y&&r?_(D):(r=n=void 0,c)}function P(){h!==void 0&&clearTimeout(h),f=0,r=d=n=h=void 0}function O(){return h===void 0?c:A(WD())}function R(){var D=WD(),L=E(D);if(r=arguments,n=this,d=D,L){if(h===void 0)return b(d);if(g)return h=setTimeout(T,e),_(d)}return h===void 0&&(h=setTimeout(T,e)),c}return R.cancel=P,R.flush=O,R}function S4(i){var e=typeof i;return!!i&&(e=="object"||e=="function")}function L3e(i){return!!i&&typeof i=="object"}function O3e(i){return typeof i=="symbol"||L3e(i)&&C3e.call(i)==y3e}function Nj(i){if(typeof i=="number")return i;if(O3e(i))return Oj;if(S4(i)){var e=typeof i.valueOf=="function"?i.valueOf():i;i=S4(e)?e+"":e}if(typeof i!="string")return i===0?i:+i;i=i.replace(_3e,"");var t=b3e.test(i);return t||w3e.test(i)?S3e(i.slice(2),t?2:8):x3e.test(i)?Oj:+i}var N3e=I3e;const D3e=Qd(N3e);function k3e(i,e){if(i==null)return{};var t={},r=Object.keys(i),n,l;for(l=0;l<r.length;l++)n=r[l],!(e.indexOf(n)>=0)&&(t[n]=i[n]);return t}function lC(){return lC=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},lC.apply(this,arguments)}var M4="data-focus-lock",VY="data-focus-lock-disabled",F3e="data-no-focus-lock",z3e="data-autofocus-inside";function jD(i,e){return typeof i=="function"?i(e):i&&(i.current=e),i}function B3e(i,e){var t=Ze.useState(function(){return{value:i,callback:e,facade:{get current(){return t.value},set current(r){var n=t.value;n!==r&&(t.value=r,t.callback(r,n))}}}})[0];return t.callback=e,t.facade}var Dj=new WeakMap;function U3e(i,e){var t=B3e(e||null,function(r){return i.forEach(function(n){return jD(n,r)})});return Ze.useLayoutEffect(function(){var r=Dj.get(t);if(r){var n=new Set(r),l=new Set(i),c=t.current;n.forEach(function(h){l.has(h)||jD(h,null)}),l.forEach(function(h){n.has(h)||jD(h,c)})}Dj.set(t,i)},[i]),t}var GD={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"};function WY(i){return i}function jY(i,e){e===void 0&&(e=WY);var t=[],r=!1,n={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:i},useMedium:function(l){var c=e(l,r);return t.push(c),function(){t=t.filter(function(h){return h!==c})}},assignSyncMedium:function(l){for(r=!0;t.length;){var c=t;t=[],c.forEach(l)}t={push:function(h){return l(h)},filter:function(){return t}}},assignMedium:function(l){r=!0;var c=[];if(t.length){var h=t;t=[],h.forEach(l),c=t}var d=function(){var m=c;c=[],m.forEach(l)},f=function(){return Promise.resolve().then(d)};f(),t={push:function(m){c.push(m),f()},filter:function(m){return c=c.filter(m),t}}}};return n}function _U(i,e){return e===void 0&&(e=WY),jY(i,e)}function H3e(i){i===void 0&&(i={});var e=jY(null);return e.options=EF({async:!0,ssr:!1},i),e}var GY=_U({},function(i){var e=i.target,t=i.currentTarget;return{target:e,currentTarget:t}}),qY=_U(),$3e=_U(),V3e=H3e({async:!0}),W3e=[],xU=Ze.forwardRef(function(e,t){var r,n=Ze.useState(),l=n[0],c=n[1],h=Ze.useRef(),d=Ze.useRef(!1),f=Ze.useRef(null),m=e.children,g=e.disabled,y=e.noFocusGuards,_=e.persistentFocus,b=e.crossFrame,S=e.autoFocus;e.allowTextSelection;var E=e.group,T=e.className,A=e.whiteList,P=e.shards,O=P===void 0?W3e:P,R=e.as,D=R===void 0?"div":R,L=e.lockProps,N=L===void 0?{}:L,U=e.sideCar,F=e.returnFocus,z=e.onActivation,G=e.onDeactivation,J=Ze.useState({}),Z=J[0],q=Ze.useCallback(function(){f.current=f.current||document&&document.activeElement,h.current&&z&&z(h.current),d.current=!0},[z]),$=Ze.useCallback(function(){d.current=!1,G&&G(h.current)},[G]),H=Ze.useCallback(function(se){var Y=f.current;if(F&&Y&&Y.focus){var fe=typeof F=="object"?F:void 0;f.current=null,se?Promise.resolve().then(function(){return Y.focus(fe)}):Y.focus(fe)}},[F]),X=Ze.useCallback(function(se){d.current&&GY.useMedium(se)},[]),re=qY.useMedium,ae=Ze.useCallback(function(se){h.current!==se&&(h.current=se,c(se))},[]),he=lC((r={},r[VY]=g&&"disabled",r[M4]=E,r),N),pe=y!==!0,de=pe&&y!=="tail",ee=U3e([t,ae]);return Ze.createElement(Ze.Fragment,null,pe&&[Ze.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:g?-1:0,style:GD}),Ze.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:g?-1:1,style:GD})],!g&&Ze.createElement(U,{id:Z,sideCar:V3e,observed:l,disabled:g,persistentFocus:_,crossFrame:b,autoFocus:S,whiteList:A,shards:O,onActivation:q,onDeactivation:$,returnFocus:H}),Ze.createElement(D,lC({ref:ee},he,{className:T,onBlur:re,onFocus:X}),m),de&&Ze.createElement("div",{"data-focus-guard":!0,tabIndex:g?-1:0,style:GD}))});xU.propTypes={};xU.defaultProps={children:void 0,disabled:!1,returnFocus:!1,noFocusGuards:!1,autoFocus:!0,persistentFocus:!1,crossFrame:!0,allowTextSelection:void 0,group:void 0,className:void 0,whiteList:void 0,shards:void 0,as:"div",lockProps:{},onActivation:void 0,onDeactivation:void 0};const XY=xU;function E4(i,e){return E4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},E4(i,e)}function j3e(i,e){i.prototype=Object.create(e.prototype),i.prototype.constructor=i,E4(i,e)}function uC(i){"@babel/helpers - typeof";return uC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uC(i)}function G3e(i,e){if(uC(i)!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(uC(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function q3e(i){var e=G3e(i,"string");return uC(e)=="symbol"?e:String(e)}function X3e(i,e,t){return e=q3e(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Z3e(i,e){function t(r){return r.displayName||r.name||"Component"}return function(n){var l=[],c;function h(){c=i(l.map(function(f){return f.props})),e(c)}var d=function(f){j3e(m,f);function m(){return f.apply(this,arguments)||this}m.peek=function(){return c};var g=m.prototype;return g.componentDidMount=function(){l.push(this),h()},g.componentDidUpdate=function(){h()},g.componentWillUnmount=function(){var _=l.indexOf(this);l.splice(_,1),h()},g.render=function(){return vi.createElement(n,this.props)},m}(Ze.PureComponent);return X3e(d,"displayName","SideEffect("+t(n)+")"),d}}var tg=function(i){for(var e=Array(i.length),t=0;t<i.length;++t)e[t]=i[t];return e},T4=function(i){return Array.isArray(i)?i:[i]},J3e=function(i){for(var e=new Set,t=i.length,r=0;r<t;r+=1)for(var n=r+1;n<t;n+=1){var l=i[r].compareDocumentPosition(i[n]);(l&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&e.add(n),(l&Node.DOCUMENT_POSITION_CONTAINS)>0&&e.add(r)}return i.filter(function(c,h){return!e.has(h)})},ZY=function(i){return i.parentNode?ZY(i.parentNode):i},bU=function(i){var e=T4(i);return e.filter(Boolean).reduce(function(t,r){var n=r.getAttribute(M4);return t.push.apply(t,n?J3e(tg(ZY(r).querySelectorAll("["+M4+'="'+n+'"]:not(['+VY+'="disabled"])'))):[r]),t},[])},Y3e=function(i){if(i.nodeType!==Node.ELEMENT_NODE)return!1;var e=window.getComputedStyle(i,null);return!e||!e.getPropertyValue?!1:e.getPropertyValue("display")==="none"||e.getPropertyValue("visibility")==="hidden"},K3e=function(i,e){return!i||i===document||i&&i.nodeType===Node.DOCUMENT_NODE||!Y3e(i)&&e(i.parentNode&&i.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i.parentNode.host:i.parentNode)},JY=function(i,e){var t=i.get(e);if(t!==void 0)return t;var r=K3e(e,JY.bind(void 0,i));return i.set(e,r),r},Q3e=function(i){return!((i.tagName==="INPUT"||i.tagName==="BUTTON")&&(i.type==="hidden"||i.disabled))},wU=function(i){return!!(i&&i.dataset&&i.dataset.focusGuard)},mI=function(i){return!wU(i)},ePe=function(i){return!!i},tPe=function(i,e){var t=i.tabIndex-e.tabIndex,r=i.index-e.index;if(t){if(!i.tabIndex)return 1;if(!e.tabIndex)return-1}return t||r},YY=function(i,e,t){return tg(i).map(function(r,n){return{node:r,index:n,tabIndex:t&&r.tabIndex===-1?(r.dataset||{}).focusGuard?0:-1:r.tabIndex}}).filter(function(r){return!e||r.tabIndex>=0}).sort(tPe)},iPe=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],A4=iPe.join(","),rPe=A4+", [data-focus-guard]",SU=function(i,e){return i.reduce(function(t,r){return t.concat(tg(r.querySelectorAll(e?rPe:A4)),r.parentNode?tg(r.parentNode.querySelectorAll(A4)).filter(function(n){return n===r}):[])},[])},nPe=function(i){var e=i.querySelectorAll("["+z3e+"]");return tg(e).map(function(t){return SU([t])}).reduce(function(t,r){return t.concat(r)},[])},MU=function(i,e){return tg(i).filter(function(t){return JY(e,t)}).filter(function(t){return Q3e(t)})},C4=function(i,e,t){return YY(MU(SU(i,t),e),!0,t)},kj=function(i,e){return YY(MU(SU(i),e),!1)},sPe=function(i,e){return MU(nPe(i),e)},P4=function(i,e){return e===void 0&&(e=[]),e.push(i),i.parentNode&&P4(i.parentNode,e),e},qD=function(i,e){for(var t=P4(i),r=P4(e),n=0;n<t.length;n+=1){var l=t[n];if(r.indexOf(l)>=0)return l}return!1},KY=function(i,e,t){var r=T4(i),n=T4(e),l=r[0],c=!1;return n.filter(Boolean).forEach(function(h){c=qD(c||h,h)||c,t.filter(Boolean).forEach(function(d){var f=qD(l,d);f&&(!c||f.contains(c)?c=f:c=qD(f,c))})}),c},aPe=function(i,e){return i.reduce(function(t,r){return t.concat(sPe(r,e))},[])},oPe=function(i){var e=bU(i).filter(mI),t=KY(i,i,e),r=new Map,n=C4([t],r,!0),l=C4(e,r).filter(function(c){var h=c.node;return mI(h)}).map(function(c){var h=c.node;return h});return n.map(function(c){var h=c.node,d=c.index;return{node:h,index:d,lockItem:l.indexOf(h)>=0,guard:wU(h)}})},lPe=function(i){return i===document.activeElement},uPe=function(i){return!!tg(i.querySelectorAll("iframe")).some(function(e){return lPe(e)})},QY=function(i){var e=document&&document.activeElement;return!e||e.dataset&&e.dataset.focusGuard?!1:bU(i).reduce(function(t,r){return t||r.contains(e)||uPe(r)},!1)},cPe=function(){return document&&tg(document.querySelectorAll("["+F3e+"]")).some(function(i){return i.contains(document.activeElement)})},eK=function(i){return i.tagName==="INPUT"&&i.type==="radio"},hPe=function(i,e){return e.filter(eK).filter(function(t){return t.name===i.name}).filter(function(t){return t.checked})[0]||i},EU=function(i,e){return eK(i)&&i.name?hPe(i,e):i},dPe=function(i){var e=new Set;return i.forEach(function(t){return e.add(EU(t,i))}),i.filter(function(t){return e.has(t)})},Fj=function(i){return i[0]&&i.length>1?EU(i[0],i):i[0]},zj=function(i,e){return i.length>1?i.indexOf(EU(i[e],i)):e},tK="NEW_FOCUS",fPe=function(i,e,t,r){var n=i.length,l=i[0],c=i[n-1],h=wU(t);if(!(i.indexOf(t)>=0)){var d=e.indexOf(t),f=r?e.indexOf(r):d,m=r?i.indexOf(r):-1,g=d-f,y=e.indexOf(l),_=e.indexOf(c),b=dPe(e),S=b.indexOf(t)-(r?b.indexOf(r):d),E=zj(i,0),T=zj(i,n-1);if(d===-1||m===-1)return tK;if(!g&&m>=0)return m;if(d<=y&&h&&Math.abs(g)>1)return T;if(d>=_&&h&&Math.abs(g)>1)return E;if(g&&Math.abs(S)>1)return m;if(d<=y)return T;if(d>_)return E;if(g)return Math.abs(g)>1?m:(n+m+g)%n}},pPe=function(i){return function(e){return e.autofocus||e.dataset&&!!e.dataset.autofocus||i.indexOf(e)>=0}},mPe=function(i,e){var t=new Map;return e.forEach(function(r){return t.set(r.node,r)}),i.map(function(r){return t.get(r)}).filter(ePe)},gPe=function(i,e){var t=document&&document.activeElement,r=bU(i).filter(mI),n=KY(t||i,i,r),l=new Map,c=kj(r,l),h=C4(r,l).filter(function(_){var b=_.node;return mI(b)});if(!(!h[0]&&(h=c,!h[0]))){var d=kj([n],l).map(function(_){var b=_.node;return b}),f=mPe(d,h),m=f.map(function(_){var b=_.node;return b}),g=fPe(m,d,t,e);if(g===tK){var y=c.map(function(_){var b=_.node;return b}).filter(pPe(aPe(r,l)));return{node:y&&y.length?Fj(y):Fj(m)}}return g===void 0?g:f[g]}},vPe=function(i){i.focus(),"contentWindow"in i&&i.contentWindow&&i.contentWindow.focus()},XD=0,ZD=!1,iK=function(i,e){var t=gPe(i,e);if(!ZD&&t){if(XD>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),ZD=!0,setTimeout(function(){ZD=!1},1);return}XD++,vPe(t.node),XD--}};function rK(i){var e=window,t=e.setImmediate;typeof t<"u"?t(i):setTimeout(i,1)}var yPe=function(){return document&&document.activeElement===document.body},_Pe=function(){return yPe()||cPe()},MM=null,sM=null,EM=null,cC=!1,xPe=function(){return!0},bPe=function(e){return(MM.whiteList||xPe)(e)},wPe=function(e,t){EM={observerNode:e,portaledElement:t}},SPe=function(e){return EM&&EM.portaledElement===e};function Bj(i,e,t,r){var n=null,l=i;do{var c=r[l];if(c.guard)c.node.dataset.focusAutoGuard&&(n=c);else if(c.lockItem){if(l!==i)return;n=null}else break}while((l+=t)!==e);n&&(n.node.tabIndex=0)}var MPe=function(e){return e&&"current"in e?e.current:e},EPe=function(e){return e?!!cC:cC==="meanwhile"},gI=function(){var e=!1;if(MM){var t=MM,r=t.observed,n=t.persistentFocus,l=t.autoFocus,c=t.shards,h=t.crossFrame,d=r||EM&&EM.portaledElement,f=document&&document.activeElement;if(d){var m=[d].concat(c.map(MPe).filter(Boolean));if((!f||bPe(f))&&(n||EPe(h)||!_Pe()||!sM&&l)&&(d&&!(QY(m)||SPe(f))&&(document&&!sM&&f&&!l?(f.blur&&f.blur(),document.body.focus()):(e=iK(m,sM),EM={})),cC=!1,sM=document&&document.activeElement),document){var g=document&&document.activeElement,y=oPe(m),_=y.map(function(b){var S=b.node;return S}).indexOf(g);_>-1&&(y.filter(function(b){var S=b.guard,E=b.node;return S&&E.dataset.focusAutoGuard}).forEach(function(b){var S=b.node;return S.removeAttribute("tabIndex")}),Bj(_,y.length,1,y),Bj(_,-1,-1,y))}}}return e},nK=function(e){gI()&&e&&(e.stopPropagation(),e.preventDefault())},TU=function(){return rK(gI)},TPe=function(e){var t=e.target,r=e.currentTarget;r.contains(t)||wPe(r,t)},APe=function(){return null},sK=function(){cC="just",setTimeout(function(){cC="meanwhile"},0)},CPe=function(){document.addEventListener("focusin",nK,!0),document.addEventListener("focusout",TU),window.addEventListener("blur",sK)},PPe=function(){document.removeEventListener("focusin",nK,!0),document.removeEventListener("focusout",TU),window.removeEventListener("blur",sK)};function RPe(i){return i.filter(function(e){var t=e.disabled;return!t})}function IPe(i){var e=i.slice(-1)[0];e&&!MM&&CPe();var t=MM,r=t&&e&&e.id===t.id;MM=e,t&&!r&&(t.onDeactivation(),i.filter(function(n){var l=n.id;return l===t.id}).length||t.returnFocus(!e)),e?(sM=null,(!r||t.observed!==e.observed)&&e.onActivation(),gI(),rK(gI)):(PPe(),sM=null)}GY.assignSyncMedium(TPe);qY.assignMedium(TU);$3e.assignMedium(function(i){return i({moveFocusInside:iK,focusInside:QY})});const LPe=Z3e(RPe,IPe)(APe);var aK=Ze.forwardRef(function(e,t){return Ze.createElement(XY,lC({sideCar:LPe,ref:t},e))}),oK=XY.propTypes||{};oK.sideCar;k3e(oK,["sideCar"]);aK.propTypes={};const OPe=aK;var lK={exports:{}},vn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ya=typeof Symbol=="function"&&Symbol.for,AU=Ya?Symbol.for("react.element"):60103,CU=Ya?Symbol.for("react.portal"):60106,bL=Ya?Symbol.for("react.fragment"):60107,wL=Ya?Symbol.for("react.strict_mode"):60108,SL=Ya?Symbol.for("react.profiler"):60114,ML=Ya?Symbol.for("react.provider"):60109,EL=Ya?Symbol.for("react.context"):60110,PU=Ya?Symbol.for("react.async_mode"):60111,TL=Ya?Symbol.for("react.concurrent_mode"):60111,AL=Ya?Symbol.for("react.forward_ref"):60112,CL=Ya?Symbol.for("react.suspense"):60113,NPe=Ya?Symbol.for("react.suspense_list"):60120,PL=Ya?Symbol.for("react.memo"):60115,RL=Ya?Symbol.for("react.lazy"):60116,DPe=Ya?Symbol.for("react.block"):60121,kPe=Ya?Symbol.for("react.fundamental"):60117,FPe=Ya?Symbol.for("react.responder"):60118,zPe=Ya?Symbol.for("react.scope"):60119;function $u(i){if(typeof i=="object"&&i!==null){var e=i.$$typeof;switch(e){case AU:switch(i=i.type,i){case PU:case TL:case bL:case SL:case wL:case CL:return i;default:switch(i=i&&i.$$typeof,i){case EL:case AL:case RL:case PL:case ML:return i;default:return e}}case CU:return e}}}function uK(i){return $u(i)===TL}vn.AsyncMode=PU;vn.ConcurrentMode=TL;vn.ContextConsumer=EL;vn.ContextProvider=ML;vn.Element=AU;vn.ForwardRef=AL;vn.Fragment=bL;vn.Lazy=RL;vn.Memo=PL;vn.Portal=CU;vn.Profiler=SL;vn.StrictMode=wL;vn.Suspense=CL;vn.isAsyncMode=function(i){return uK(i)||$u(i)===PU};vn.isConcurrentMode=uK;vn.isContextConsumer=function(i){return $u(i)===EL};vn.isContextProvider=function(i){return $u(i)===ML};vn.isElement=function(i){return typeof i=="object"&&i!==null&&i.$$typeof===AU};vn.isForwardRef=function(i){return $u(i)===AL};vn.isFragment=function(i){return $u(i)===bL};vn.isLazy=function(i){return $u(i)===RL};vn.isMemo=function(i){return $u(i)===PL};vn.isPortal=function(i){return $u(i)===CU};vn.isProfiler=function(i){return $u(i)===SL};vn.isStrictMode=function(i){return $u(i)===wL};vn.isSuspense=function(i){return $u(i)===CL};vn.isValidElementType=function(i){return typeof i=="string"||typeof i=="function"||i===bL||i===TL||i===SL||i===wL||i===CL||i===NPe||typeof i=="object"&&i!==null&&(i.$$typeof===RL||i.$$typeof===PL||i.$$typeof===ML||i.$$typeof===EL||i.$$typeof===AL||i.$$typeof===kPe||i.$$typeof===FPe||i.$$typeof===zPe||i.$$typeof===DPe)};vn.typeOf=$u;lK.exports=vn;var RU=lK.exports;function BPe(i){function e(pe,de,ee,se,Y){for(var fe=0,me=0,De=0,Le=0,Ce,Ae,Ue=0,Ne=0,Ge,Ct=Ge=Ce=0,it=0,bt=0,Kt=0,kt=0,Pt=ee.length,_e=Pt-1,ce,Fe="",et="",Dt="",gt="",xe;it<Pt;){if(Ae=ee.charCodeAt(it),it===_e&&me+Le+De+fe!==0&&(me!==0&&(Ae=me===47?10:47),Le=De=fe=0,Pt++,_e++),me+Le+De+fe===0){if(it===_e&&(0<bt&&(Fe=Fe.replace(y,"")),0<Fe.trim().length)){switch(Ae){case 32:case 9:case 59:case 13:case 10:break;default:Fe+=ee.charAt(it)}Ae=59}switch(Ae){case 123:for(Fe=Fe.trim(),Ce=Fe.charCodeAt(0),Ge=1,kt=++it;it<Pt;){switch(Ae=ee.charCodeAt(it)){case 123:Ge++;break;case 125:Ge--;break;case 47:switch(Ae=ee.charCodeAt(it+1)){case 42:case 47:e:{for(Ct=it+1;Ct<_e;++Ct)switch(ee.charCodeAt(Ct)){case 47:if(Ae===42&&ee.charCodeAt(Ct-1)===42&&it+2!==Ct){it=Ct+1;break e}break;case 10:if(Ae===47){it=Ct+1;break e}}it=Ct}}break;case 91:Ae++;case 40:Ae++;case 34:case 39:for(;it++<_e&&ee.charCodeAt(it)!==Ae;);}if(Ge===0)break;it++}switch(Ge=ee.substring(kt,it),Ce===0&&(Ce=(Fe=Fe.replace(g,"").trim()).charCodeAt(0)),Ce){case 64:switch(0<bt&&(Fe=Fe.replace(y,"")),Ae=Fe.charCodeAt(1),Ae){case 100:case 109:case 115:case 45:bt=de;break;default:bt=$}if(Ge=e(de,bt,Ge,Ae,Y+1),kt=Ge.length,0<X&&(bt=t($,Fe,Kt),xe=h(3,Ge,bt,de,J,G,kt,Ae,Y,se),Fe=bt.join(""),xe!==void 0&&(kt=(Ge=xe.trim()).length)===0&&(Ae=0,Ge="")),0<kt)switch(Ae){case 115:Fe=Fe.replace(D,c);case 100:case 109:case 45:Ge=Fe+"{"+Ge+"}";break;case 107:Fe=Fe.replace(A,"$1 $2"),Ge=Fe+"{"+Ge+"}",Ge=q===1||q===2&&l("@"+Ge,3)?"@-webkit-"+Ge+"@"+Ge:"@"+Ge;break;default:Ge=Fe+Ge,se===112&&(Ge=(et+=Ge,""))}else Ge="";break;default:Ge=e(de,t(de,Fe,Kt),Ge,se,Y+1)}Dt+=Ge,Ge=Kt=bt=Ct=Ce=0,Fe="",Ae=ee.charCodeAt(++it);break;case 125:case 59:if(Fe=(0<bt?Fe.replace(y,""):Fe).trim(),1<(kt=Fe.length))switch(Ct===0&&(Ce=Fe.charCodeAt(0),Ce===45||96<Ce&&123>Ce)&&(kt=(Fe=Fe.replace(" ",":")).length),0<X&&(xe=h(1,Fe,de,pe,J,G,et.length,se,Y,se))!==void 0&&(kt=(Fe=xe.trim()).length)===0&&(Fe="\0\0"),Ce=Fe.charCodeAt(0),Ae=Fe.charCodeAt(1),Ce){case 0:break;case 64:if(Ae===105||Ae===99){gt+=Fe+ee.charAt(it);break}default:Fe.charCodeAt(kt-1)!==58&&(et+=n(Fe,Ce,Ae,Fe.charCodeAt(2)))}Kt=bt=Ct=Ce=0,Fe="",Ae=ee.charCodeAt(++it)}}switch(Ae){case 13:case 10:me===47?me=0:1+Ce===0&&se!==107&&0<Fe.length&&(bt=1,Fe+="\0"),0<X*ae&&h(0,Fe,de,pe,J,G,et.length,se,Y,se),G=1,J++;break;case 59:case 125:if(me+Le+De+fe===0){G++;break}default:switch(G++,ce=ee.charAt(it),Ae){case 9:case 32:if(Le+fe+me===0)switch(Ue){case 44:case 58:case 9:case 32:ce="";break;default:Ae!==32&&(ce=" ")}break;case 0:ce="\\0";break;case 12:ce="\\f";break;case 11:ce="\\v";break;case 38:Le+me+fe===0&&(bt=Kt=1,ce="\f"+ce);break;case 108:if(Le+me+fe+Z===0&&0<Ct)switch(it-Ct){case 2:Ue===112&&ee.charCodeAt(it-3)===58&&(Z=Ue);case 8:Ne===111&&(Z=Ne)}break;case 58:Le+me+fe===0&&(Ct=it);break;case 44:me+De+Le+fe===0&&(bt=1,ce+="\r");break;case 34:case 39:me===0&&(Le=Le===Ae?0:Le===0?Ae:Le);break;case 91:Le+me+De===0&&fe++;break;case 93:Le+me+De===0&&fe--;break;case 41:Le+me+fe===0&&De--;break;case 40:if(Le+me+fe===0){if(Ce===0)switch(2*Ue+3*Ne){case 533:break;default:Ce=1}De++}break;case 64:me+De+Le+fe+Ct+Ge===0&&(Ge=1);break;case 42:case 47:if(!(0<Le+fe+De))switch(me){case 0:switch(2*Ae+3*ee.charCodeAt(it+1)){case 235:me=47;break;case 220:kt=it,me=42}break;case 42:Ae===47&&Ue===42&&kt+2!==it&&(ee.charCodeAt(kt+2)===33&&(et+=ee.substring(kt,it+1)),ce="",me=0)}}me===0&&(Fe+=ce)}Ne=Ue,Ue=Ae,it++}if(kt=et.length,0<kt){if(bt=de,0<X&&(xe=h(2,et,bt,pe,J,G,kt,se,Y,se),xe!==void 0&&(et=xe).length===0))return gt+et+Dt;if(et=bt.join(",")+"{"+et+"}",q*Z!==0){switch(q!==2||l(et,2)||(Z=0),Z){case 111:et=et.replace(O,":-moz-$1")+et;break;case 112:et=et.replace(P,"::-webkit-input-$1")+et.replace(P,"::-moz-$1")+et.replace(P,":-ms-input-$1")+et}Z=0}}return gt+et+Dt}function t(pe,de,ee){var se=de.trim().split(E);de=se;var Y=se.length,fe=pe.length;switch(fe){case 0:case 1:var me=0;for(pe=fe===0?"":pe[0]+" ";me<Y;++me)de[me]=r(pe,de[me],ee).trim();break;default:var De=me=0;for(de=[];me<Y;++me)for(var Le=0;Le<fe;++Le)de[De++]=r(pe[Le]+" ",se[me],ee).trim()}return de}function r(pe,de,ee){var se=de.charCodeAt(0);switch(33>se&&(se=(de=de.trim()).charCodeAt(0)),se){case 38:return de.replace(T,"$1"+pe.trim());case 58:return pe.trim()+de.replace(T,"$1"+pe.trim());default:if(0<1*ee&&0<de.indexOf("\f"))return de.replace(T,(pe.charCodeAt(0)===58?"":"$1")+pe.trim())}return pe+de}function n(pe,de,ee,se){var Y=pe+";",fe=2*de+3*ee+4*se;if(fe===944){pe=Y.indexOf(":",9)+1;var me=Y.substring(pe,Y.length-1).trim();return me=Y.substring(0,pe).trim()+me+";",q===1||q===2&&l(me,1)?"-webkit-"+me+me:me}if(q===0||q===2&&!l(Y,1))return Y;switch(fe){case 1015:return Y.charCodeAt(10)===97?"-webkit-"+Y+Y:Y;case 951:return Y.charCodeAt(3)===116?"-webkit-"+Y+Y:Y;case 963:return Y.charCodeAt(5)===110?"-webkit-"+Y+Y:Y;case 1009:if(Y.charCodeAt(4)!==100)break;case 969:case 942:return"-webkit-"+Y+Y;case 978:return"-webkit-"+Y+"-moz-"+Y+Y;case 1019:case 983:return"-webkit-"+Y+"-moz-"+Y+"-ms-"+Y+Y;case 883:if(Y.charCodeAt(8)===45)return"-webkit-"+Y+Y;if(0<Y.indexOf("image-set(",11))return Y.replace(z,"$1-webkit-$2")+Y;break;case 932:if(Y.charCodeAt(4)===45)switch(Y.charCodeAt(5)){case 103:return"-webkit-box-"+Y.replace("-grow","")+"-webkit-"+Y+"-ms-"+Y.replace("grow","positive")+Y;case 115:return"-webkit-"+Y+"-ms-"+Y.replace("shrink","negative")+Y;case 98:return"-webkit-"+Y+"-ms-"+Y.replace("basis","preferred-size")+Y}return"-webkit-"+Y+"-ms-"+Y+Y;case 964:return"-webkit-"+Y+"-ms-flex-"+Y+Y;case 1023:if(Y.charCodeAt(8)!==99)break;return me=Y.substring(Y.indexOf(":",15)).replace("flex-","").replace("space-between","justify"),"-webkit-box-pack"+me+"-webkit-"+Y+"-ms-flex-pack"+me+Y;case 1005:return b.test(Y)?Y.replace(_,":-webkit-")+Y.replace(_,":-moz-")+Y:Y;case 1e3:switch(me=Y.substring(13).trim(),de=me.indexOf("-")+1,me.charCodeAt(0)+me.charCodeAt(de)){case 226:me=Y.replace(R,"tb");break;case 232:me=Y.replace(R,"tb-rl");break;case 220:me=Y.replace(R,"lr");break;default:return Y}return"-webkit-"+Y+"-ms-"+me+Y;case 1017:if(Y.indexOf("sticky",9)===-1)break;case 975:switch(de=(Y=pe).length-10,me=(Y.charCodeAt(de)===33?Y.substring(0,de):Y).substring(pe.indexOf(":",7)+1).trim(),fe=me.charCodeAt(0)+(me.charCodeAt(7)|0)){case 203:if(111>me.charCodeAt(8))break;case 115:Y=Y.replace(me,"-webkit-"+me)+";"+Y;break;case 207:case 102:Y=Y.replace(me,"-webkit-"+(102<fe?"inline-":"")+"box")+";"+Y.replace(me,"-webkit-"+me)+";"+Y.replace(me,"-ms-"+me+"box")+";"+Y}return Y+";";case 938:if(Y.charCodeAt(5)===45)switch(Y.charCodeAt(6)){case 105:return me=Y.replace("-items",""),"-webkit-"+Y+"-webkit-box-"+me+"-ms-flex-"+me+Y;case 115:return"-webkit-"+Y+"-ms-flex-item-"+Y.replace(N,"")+Y;default:return"-webkit-"+Y+"-ms-flex-line-pack"+Y.replace("align-content","").replace(N,"")+Y}break;case 973:case 989:if(Y.charCodeAt(3)!==45||Y.charCodeAt(4)===122)break;case 931:case 953:if(F.test(pe)===!0)return(me=pe.substring(pe.indexOf(":")+1)).charCodeAt(0)===115?n(pe.replace("stretch","fill-available"),de,ee,se).replace(":fill-available",":stretch"):Y.replace(me,"-webkit-"+me)+Y.replace(me,"-moz-"+me.replace("fill-",""))+Y;break;case 962:if(Y="-webkit-"+Y+(Y.charCodeAt(5)===102?"-ms-"+Y:"")+Y,ee+se===211&&Y.charCodeAt(13)===105&&0<Y.indexOf("transform",10))return Y.substring(0,Y.indexOf(";",27)+1).replace(S,"$1-webkit-$2")+Y}return Y}function l(pe,de){var ee=pe.indexOf(de===1?":":"{"),se=pe.substring(0,de!==3?ee:10);return ee=pe.substring(ee+1,pe.length-1),re(de!==2?se:se.replace(U,"$1"),ee,de)}function c(pe,de){var ee=n(de,de.charCodeAt(0),de.charCodeAt(1),de.charCodeAt(2));return ee!==de+";"?ee.replace(L," or ($1)").substring(4):"("+de+")"}function h(pe,de,ee,se,Y,fe,me,De,Le,Ce){for(var Ae=0,Ue=de,Ne;Ae<X;++Ae)switch(Ne=H[Ae].call(m,pe,Ue,ee,se,Y,fe,me,De,Le,Ce)){case void 0:case!1:case!0:case null:break;default:Ue=Ne}if(Ue!==de)return Ue}function d(pe){switch(pe){case void 0:case null:X=H.length=0;break;default:if(typeof pe=="function")H[X++]=pe;else if(typeof pe=="object")for(var de=0,ee=pe.length;de<ee;++de)d(pe[de]);else ae=!!pe|0}return d}function f(pe){return pe=pe.prefix,pe!==void 0&&(re=null,pe?typeof pe!="function"?q=1:(q=2,re=pe):q=0),f}function m(pe,de){var ee=pe;if(33>ee.charCodeAt(0)&&(ee=ee.trim()),he=ee,ee=[he],0<X){var se=h(-1,de,ee,ee,J,G,0,0,0,0);se!==void 0&&typeof se=="string"&&(de=se)}var Y=e($,ee,de,0,0);return 0<X&&(se=h(-2,Y,ee,ee,J,G,Y.length,0,0,0),se!==void 0&&(Y=se)),he="",Z=0,G=J=1,Y}var g=/^\0+/g,y=/[\0\r\f]/g,_=/: */g,b=/zoo|gra/,S=/([,: ])(transform)/g,E=/,\r+?/g,T=/([\t\r\n ])*\f?&/g,A=/@(k\w+)\s*(\S*)\s*/,P=/::(place)/g,O=/:(read-only)/g,R=/[svh]\w+-[tblr]{2}/,D=/\(\s*(.*)\s*\)/g,L=/([\s\S]*?);/g,N=/-self|flex-/g,U=/[^]*?(:[rp][el]a[\w-]+)[^]*/,F=/stretch|:\s*\w+\-(?:conte|avail)/,z=/([^-])(image-set\()/,G=1,J=1,Z=0,q=1,$=[],H=[],X=0,re=null,ae=0,he="";return m.use=d,m.set=f,i!==void 0&&f(i),m}var UPe={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function HPe(i){var e=Object.create(null);return function(t){return e[t]===void 0&&(e[t]=i(t)),e[t]}}var $Pe=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,Uj=HPe(function(i){return $Pe.test(i)||i.charCodeAt(0)===111&&i.charCodeAt(1)===110&&i.charCodeAt(2)<91}),IU=RU,VPe={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},WPe={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},jPe={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},cK={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},LU={};LU[IU.ForwardRef]=jPe;LU[IU.Memo]=cK;function Hj(i){return IU.isMemo(i)?cK:LU[i.$$typeof]||VPe}var GPe=Object.defineProperty,qPe=Object.getOwnPropertyNames,$j=Object.getOwnPropertySymbols,XPe=Object.getOwnPropertyDescriptor,ZPe=Object.getPrototypeOf,Vj=Object.prototype;function hK(i,e,t){if(typeof e!="string"){if(Vj){var r=ZPe(e);r&&r!==Vj&&hK(i,r,t)}var n=qPe(e);$j&&(n=n.concat($j(e)));for(var l=Hj(i),c=Hj(e),h=0;h<n.length;++h){var d=n[h];if(!WPe[d]&&!(t&&t[d])&&!(c&&c[d])&&!(l&&l[d])){var f=XPe(e,d);try{GPe(i,d,f)}catch{}}}}return i}var JPe=hK;const YPe=Qd(JPe);var Ju={};function vf(){return(vf=Object.assign||function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i}).apply(this,arguments)}var Wj=function(i,e){for(var t=[i[0]],r=0,n=e.length;r<n;r+=1)t.push(e[r],i[r+1]);return t},R4=function(i){return i!==null&&typeof i=="object"&&(i.toString?i.toString():Object.prototype.toString.call(i))==="[object Object]"&&!RU.typeOf(i)},vI=Object.freeze([]),qm=Object.freeze({});function hC(i){return typeof i=="function"}function jj(i){return i.displayName||i.name||"Component"}function OU(i){return i&&typeof i.styledComponentId=="string"}var tE=typeof process<"u"&&Ju!==void 0&&(Ju.REACT_APP_SC_ATTR||Ju.SC_ATTR)||"data-styled",NU=typeof window<"u"&&"HTMLElement"in window,KPe=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&Ju!==void 0&&(Ju.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&Ju.REACT_APP_SC_DISABLE_SPEEDY!==""?Ju.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&Ju.REACT_APP_SC_DISABLE_SPEEDY:Ju.SC_DISABLE_SPEEDY!==void 0&&Ju.SC_DISABLE_SPEEDY!==""&&Ju.SC_DISABLE_SPEEDY!=="false"&&Ju.SC_DISABLE_SPEEDY)),QPe={};function UC(i){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];throw new Error("An error occurred. See https://git.io/JUIaE#"+i+" for more information."+(t.length>0?" Args: "+t.join(", "):""))}var eRe=function(){function i(t){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=t}var e=i.prototype;return e.indexOfGroup=function(t){for(var r=0,n=0;n<t;n++)r+=this.groupSizes[n];return r},e.insertRules=function(t,r){if(t>=this.groupSizes.length){for(var n=this.groupSizes,l=n.length,c=l;t>=c;)(c<<=1)<0&&UC(16,""+t);this.groupSizes=new Uint32Array(c),this.groupSizes.set(n),this.length=c;for(var h=l;h<c;h++)this.groupSizes[h]=0}for(var d=this.indexOfGroup(t+1),f=0,m=r.length;f<m;f++)this.tag.insertRule(d,r[f])&&(this.groupSizes[t]++,d++)},e.clearGroup=function(t){if(t<this.length){var r=this.groupSizes[t],n=this.indexOfGroup(t),l=n+r;this.groupSizes[t]=0;for(var c=n;c<l;c++)this.tag.deleteRule(n)}},e.getGroup=function(t){var r="";if(t>=this.length||this.groupSizes[t]===0)return r;for(var n=this.groupSizes[t],l=this.indexOfGroup(t),c=l+n,h=l;h<c;h++)r+=this.tag.getRule(h)+`/*!sc*/
`;return r},i}(),aR=new Map,yI=new Map,aA=1,PP=function(i){if(aR.has(i))return aR.get(i);for(;yI.has(aA);)aA++;var e=aA++;return aR.set(i,e),yI.set(e,i),e},tRe=function(i){return yI.get(i)},iRe=function(i,e){e>=aA&&(aA=e+1),aR.set(i,e),yI.set(e,i)},rRe="style["+tE+'][data-styled-version="5.3.11"]',nRe=new RegExp("^"+tE+'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)'),sRe=function(i,e,t){for(var r,n=t.split(","),l=0,c=n.length;l<c;l++)(r=n[l])&&i.registerName(e,r)},aRe=function(i,e){for(var t=(e.textContent||"").split(`/*!sc*/
`),r=[],n=0,l=t.length;n<l;n++){var c=t[n].trim();if(c){var h=c.match(nRe);if(h){var d=0|parseInt(h[1],10),f=h[2];d!==0&&(iRe(f,d),sRe(i,f,h[3]),i.getTag().insertRules(d,r)),r.length=0}else r.push(c)}}},oRe=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null},dK=function(i){var e=document.head,t=i||e,r=document.createElement("style"),n=function(h){for(var d=h.childNodes,f=d.length;f>=0;f--){var m=d[f];if(m&&m.nodeType===1&&m.hasAttribute(tE))return m}}(t),l=n!==void 0?n.nextSibling:null;r.setAttribute(tE,"active"),r.setAttribute("data-styled-version","5.3.11");var c=oRe();return c&&r.setAttribute("nonce",c),t.insertBefore(r,l),r},lRe=function(){function i(t){var r=this.element=dK(t);r.appendChild(document.createTextNode("")),this.sheet=function(n){if(n.sheet)return n.sheet;for(var l=document.styleSheets,c=0,h=l.length;c<h;c++){var d=l[c];if(d.ownerNode===n)return d}UC(17)}(r),this.length=0}var e=i.prototype;return e.insertRule=function(t,r){try{return this.sheet.insertRule(r,t),this.length++,!0}catch{return!1}},e.deleteRule=function(t){this.sheet.deleteRule(t),this.length--},e.getRule=function(t){var r=this.sheet.cssRules[t];return r!==void 0&&typeof r.cssText=="string"?r.cssText:""},i}(),uRe=function(){function i(t){var r=this.element=dK(t);this.nodes=r.childNodes,this.length=0}var e=i.prototype;return e.insertRule=function(t,r){if(t<=this.length&&t>=0){var n=document.createTextNode(r),l=this.nodes[t];return this.element.insertBefore(n,l||null),this.length++,!0}return!1},e.deleteRule=function(t){this.element.removeChild(this.nodes[t]),this.length--},e.getRule=function(t){return t<this.length?this.nodes[t].textContent:""},i}(),cRe=function(){function i(t){this.rules=[],this.length=0}var e=i.prototype;return e.insertRule=function(t,r){return t<=this.length&&(this.rules.splice(t,0,r),this.length++,!0)},e.deleteRule=function(t){this.rules.splice(t,1),this.length--},e.getRule=function(t){return t<this.length?this.rules[t]:""},i}(),Gj=NU,hRe={isServer:!NU,useCSSOMInjection:!KPe},_I=function(){function i(t,r,n){t===void 0&&(t=qm),r===void 0&&(r={}),this.options=vf({},hRe,{},t),this.gs=r,this.names=new Map(n),this.server=!!t.isServer,!this.server&&NU&&Gj&&(Gj=!1,function(l){for(var c=document.querySelectorAll(rRe),h=0,d=c.length;h<d;h++){var f=c[h];f&&f.getAttribute(tE)!=="active"&&(aRe(l,f),f.parentNode&&f.parentNode.removeChild(f))}}(this))}i.registerId=function(t){return PP(t)};var e=i.prototype;return e.reconstructWithOptions=function(t,r){return r===void 0&&(r=!0),new i(vf({},this.options,{},t),this.gs,r&&this.names||void 0)},e.allocateGSInstance=function(t){return this.gs[t]=(this.gs[t]||0)+1},e.getTag=function(){return this.tag||(this.tag=(n=(r=this.options).isServer,l=r.useCSSOMInjection,c=r.target,t=n?new cRe(c):l?new lRe(c):new uRe(c),new eRe(t)));var t,r,n,l,c},e.hasNameForId=function(t,r){return this.names.has(t)&&this.names.get(t).has(r)},e.registerName=function(t,r){if(PP(t),this.names.has(t))this.names.get(t).add(r);else{var n=new Set;n.add(r),this.names.set(t,n)}},e.insertRules=function(t,r,n){this.registerName(t,r),this.getTag().insertRules(PP(t),n)},e.clearNames=function(t){this.names.has(t)&&this.names.get(t).clear()},e.clearRules=function(t){this.getTag().clearGroup(PP(t)),this.clearNames(t)},e.clearTag=function(){this.tag=void 0},e.toString=function(){return function(t){for(var r=t.getTag(),n=r.length,l="",c=0;c<n;c++){var h=tRe(c);if(h!==void 0){var d=t.names.get(h),f=r.getGroup(c);if(d&&f&&d.size){var m=tE+".g"+c+'[id="'+h+'"]',g="";d!==void 0&&d.forEach(function(y){y.length>0&&(g+=y+",")}),l+=""+f+m+'{content:"'+g+`"}/*!sc*/
`}}}return l}(this)},i}(),dRe=/(a)(d)/gi,qj=function(i){return String.fromCharCode(i+(i>25?39:97))};function I4(i){var e,t="";for(e=Math.abs(i);e>52;e=e/52|0)t=qj(e%52)+t;return(qj(e%52)+t).replace(dRe,"$1-$2")}var aM=function(i,e){for(var t=e.length;t;)i=33*i^e.charCodeAt(--t);return i},fK=function(i){return aM(5381,i)};function pK(i){for(var e=0;e<i.length;e+=1){var t=i[e];if(hC(t)&&!OU(t))return!1}return!0}var fRe=fK("5.3.11"),pRe=function(){function i(e,t,r){this.rules=e,this.staticRulesId="",this.isStatic=(r===void 0||r.isStatic)&&pK(e),this.componentId=t,this.baseHash=aM(fRe,t),this.baseStyle=r,_I.registerId(t)}return i.prototype.generateAndInjectStyles=function(e,t,r){var n=this.componentId,l=[];if(this.baseStyle&&l.push(this.baseStyle.generateAndInjectStyles(e,t,r)),this.isStatic&&!r.hash)if(this.staticRulesId&&t.hasNameForId(n,this.staticRulesId))l.push(this.staticRulesId);else{var c=mw(this.rules,e,t,r).join(""),h=I4(aM(this.baseHash,c)>>>0);if(!t.hasNameForId(n,h)){var d=r(c,"."+h,void 0,n);t.insertRules(n,h,d)}l.push(h),this.staticRulesId=h}else{for(var f=this.rules.length,m=aM(this.baseHash,r.hash),g="",y=0;y<f;y++){var _=this.rules[y];if(typeof _=="string")g+=_;else if(_){var b=mw(_,e,t,r),S=Array.isArray(b)?b.join(""):b;m=aM(m,S+y),g+=S}}if(g){var E=I4(m>>>0);if(!t.hasNameForId(n,E)){var T=r(g,"."+E,void 0,n);t.insertRules(n,E,T)}l.push(E)}}return l.join(" ")},i}(),mRe=/^\s*\/\/.*$/gm,gRe=[":","[",".","#"];function vRe(i){var e,t,r,n,l=i===void 0?qm:i,c=l.options,h=c===void 0?qm:c,d=l.plugins,f=d===void 0?vI:d,m=new BPe(h),g=[],y=function(S){function E(T){if(T)try{S(T+"}")}catch{}}return function(T,A,P,O,R,D,L,N,U,F){switch(T){case 1:if(U===0&&A.charCodeAt(0)===64)return S(A+";"),"";break;case 2:if(N===0)return A+"/*|*/";break;case 3:switch(N){case 102:case 112:return S(P[0]+A),"";default:return A+(F===0?"/*|*/":"")}case-2:A.split("/*|*/}").forEach(E)}}}(function(S){g.push(S)}),_=function(S,E,T){return E===0&&gRe.indexOf(T[t.length])!==-1||T.match(n)?S:"."+e};function b(S,E,T,A){A===void 0&&(A="&");var P=S.replace(mRe,""),O=E&&T?T+" "+E+" { "+P+" }":P;return e=A,t=E,r=new RegExp("\\"+t+"\\b","g"),n=new RegExp("(\\"+t+"\\b){2,}"),m(T||!E?"":E,O)}return m.use([].concat(f,[function(S,E,T){S===2&&T.length&&T[0].lastIndexOf(t)>0&&(T[0]=T[0].replace(r,_))},y,function(S){if(S===-2){var E=g;return g=[],E}}])),b.hash=f.length?f.reduce(function(S,E){return E.name||UC(15),aM(S,E.name)},5381).toString():"",b}var mK=vi.createContext();mK.Consumer;var gK=vi.createContext(),yRe=(gK.Consumer,new _I),L4=vRe();function vK(){return Ze.useContext(mK)||yRe}function yK(){return Ze.useContext(gK)||L4}var _Re=function(){function i(e,t){var r=this;this.inject=function(n,l){l===void 0&&(l=L4);var c=r.name+l.hash;n.hasNameForId(r.id,c)||n.insertRules(r.id,c,l(r.rules,c,"@keyframes"))},this.toString=function(){return UC(12,String(r.name))},this.name=e,this.id="sc-keyframes-"+e,this.rules=t}return i.prototype.getName=function(e){return e===void 0&&(e=L4),this.name+e.hash},i}(),xRe=/([A-Z])/,bRe=/([A-Z])/g,wRe=/^ms-/,SRe=function(i){return"-"+i.toLowerCase()};function Xj(i){return xRe.test(i)?i.replace(bRe,SRe).replace(wRe,"-ms-"):i}var Zj=function(i){return i==null||i===!1||i===""};function mw(i,e,t,r){if(Array.isArray(i)){for(var n,l=[],c=0,h=i.length;c<h;c+=1)(n=mw(i[c],e,t,r))!==""&&(Array.isArray(n)?l.push.apply(l,n):l.push(n));return l}if(Zj(i))return"";if(OU(i))return"."+i.styledComponentId;if(hC(i)){if(typeof(f=i)!="function"||f.prototype&&f.prototype.isReactComponent||!e)return i;var d=i(e);return mw(d,e,t,r)}var f;return i instanceof _Re?t?(i.inject(t,r),i.getName(r)):i:R4(i)?function m(g,y){var _,b,S=[];for(var E in g)g.hasOwnProperty(E)&&!Zj(g[E])&&(Array.isArray(g[E])&&g[E].isCss||hC(g[E])?S.push(Xj(E)+":",g[E],";"):R4(g[E])?S.push.apply(S,m(g[E],E)):S.push(Xj(E)+": "+(_=E,(b=g[E])==null||typeof b=="boolean"||b===""?"":typeof b!="number"||b===0||_ in UPe||_.startsWith("--")?String(b).trim():b+"px")+";"));return y?[y+" {"].concat(S,["}"]):S}(i):i.toString()}var Jj=function(i){return Array.isArray(i)&&(i.isCss=!0),i};function _K(i){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return hC(i)||R4(i)?Jj(mw(Wj(vI,[i].concat(t)))):t.length===0&&i.length===1&&typeof i[0]=="string"?i:Jj(mw(Wj(i,t)))}var xK=function(i,e,t){return t===void 0&&(t=qm),i.theme!==t.theme&&i.theme||e||t.theme},MRe=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,ERe=/(^-|-$)/g;function JD(i){return i.replace(MRe,"-").replace(ERe,"")}var bK=function(i){return I4(fK(i)>>>0)};function RP(i){return typeof i=="string"&&!0}var O4=function(i){return typeof i=="function"||typeof i=="object"&&i!==null&&!Array.isArray(i)},TRe=function(i){return i!=="__proto__"&&i!=="constructor"&&i!=="prototype"};function ARe(i,e,t){var r=i[t];O4(e)&&O4(r)?wK(r,e):i[t]=e}function wK(i){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];for(var n=0,l=t;n<l.length;n++){var c=l[n];if(O4(c))for(var h in c)TRe(h)&&ARe(i,c[h],h)}return i}var DU=vi.createContext();DU.Consumer;var YD={};function SK(i,e,t){var r=OU(i),n=!RP(i),l=e.attrs,c=l===void 0?vI:l,h=e.componentId,d=h===void 0?function(A,P){var O=typeof A!="string"?"sc":JD(A);YD[O]=(YD[O]||0)+1;var R=O+"-"+bK("5.3.11"+O+YD[O]);return P?P+"-"+R:R}(e.displayName,e.parentComponentId):h,f=e.displayName,m=f===void 0?function(A){return RP(A)?"styled."+A:"Styled("+jj(A)+")"}(i):f,g=e.displayName&&e.componentId?JD(e.displayName)+"-"+e.componentId:e.componentId||d,y=r&&i.attrs?Array.prototype.concat(i.attrs,c).filter(Boolean):c,_=e.shouldForwardProp;r&&i.shouldForwardProp&&(_=e.shouldForwardProp?function(A,P,O){return i.shouldForwardProp(A,P,O)&&e.shouldForwardProp(A,P,O)}:i.shouldForwardProp);var b,S=new pRe(t,g,r?i.componentStyle:void 0),E=S.isStatic&&c.length===0,T=function(A,P){return function(O,R,D,L){var N=O.attrs,U=O.componentStyle,F=O.defaultProps,z=O.foldedComponentIds,G=O.shouldForwardProp,J=O.styledComponentId,Z=O.target,q=function(se,Y,fe){se===void 0&&(se=qm);var me=vf({},Y,{theme:se}),De={};return fe.forEach(function(Le){var Ce,Ae,Ue,Ne=Le;for(Ce in hC(Ne)&&(Ne=Ne(me)),Ne)me[Ce]=De[Ce]=Ce==="className"?(Ae=De[Ce],Ue=Ne[Ce],Ae&&Ue?Ae+" "+Ue:Ae||Ue):Ne[Ce]}),[me,De]}(xK(R,Ze.useContext(DU),F)||qm,R,N),$=q[0],H=q[1],X=function(se,Y,fe,me){var De=vK(),Le=yK(),Ce=Y?se.generateAndInjectStyles(qm,De,Le):se.generateAndInjectStyles(fe,De,Le);return Ce}(U,L,$),re=D,ae=H.$as||R.$as||H.as||R.as||Z,he=RP(ae),pe=H!==R?vf({},R,{},H):R,de={};for(var ee in pe)ee[0]!=="$"&&ee!=="as"&&(ee==="forwardedAs"?de.as=pe[ee]:(G?G(ee,Uj,ae):!he||Uj(ee))&&(de[ee]=pe[ee]));return R.style&&H.style!==R.style&&(de.style=vf({},R.style,{},H.style)),de.className=Array.prototype.concat(z,J,X!==J?X:null,R.className,H.className).filter(Boolean).join(" "),de.ref=re,Ze.createElement(ae,de)}(b,A,P,E)};return T.displayName=m,(b=vi.forwardRef(T)).attrs=y,b.componentStyle=S,b.displayName=m,b.shouldForwardProp=_,b.foldedComponentIds=r?Array.prototype.concat(i.foldedComponentIds,i.styledComponentId):vI,b.styledComponentId=g,b.target=r?i.target:i,b.withComponent=function(A){var P=e.componentId,O=function(D,L){if(D==null)return{};var N,U,F={},z=Object.keys(D);for(U=0;U<z.length;U++)N=z[U],L.indexOf(N)>=0||(F[N]=D[N]);return F}(e,["componentId"]),R=P&&P+"-"+(RP(A)?A:JD(jj(A)));return SK(A,vf({},O,{attrs:y,componentId:R}),t)},Object.defineProperty(b,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(A){this._foldedDefaultProps=r?wK({},i.defaultProps,A):A}}),Object.defineProperty(b,"toString",{value:function(){return"."+b.styledComponentId}}),n&&YPe(b,i,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0,withComponent:!0}),b}var N4=function(i){return function e(t,r,n){if(n===void 0&&(n=qm),!RU.isValidElementType(r))return UC(1,String(r));var l=function(){return t(r,n,_K.apply(void 0,arguments))};return l.withConfig=function(c){return e(t,r,vf({},n,{},c))},l.attrs=function(c){return e(t,r,vf({},n,{attrs:Array.prototype.concat(n.attrs,c).filter(Boolean)}))},l}(SK,i)};["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","textPath","tspan"].forEach(function(i){N4[i]=N4(i)});var CRe=function(){function i(t,r){this.rules=t,this.componentId=r,this.isStatic=pK(t),_I.registerId(this.componentId+1)}var e=i.prototype;return e.createStyles=function(t,r,n,l){var c=l(mw(this.rules,r,n,l).join(""),""),h=this.componentId+t;n.insertRules(h,h,c)},e.removeStyles=function(t,r){r.clearRules(this.componentId+t)},e.renderStyles=function(t,r,n,l){t>2&&_I.registerId(this.componentId+t),this.removeStyles(t,n),this.createStyles(t,r,n,l)},i}();function PRe(i){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];var n=_K.apply(void 0,[i].concat(t)),l="sc-global-"+bK(JSON.stringify(n)),c=new CRe(n,l);function h(f){var m=vK(),g=yK(),y=Ze.useContext(DU),_=Ze.useRef(m.allocateGSInstance(l)).current;return m.server&&d(_,f,m,y,g),Ze.useLayoutEffect(function(){if(!m.server)return d(_,f,m,y,g),function(){return c.removeStyles(_,m)}},[_,f,m,y,g]),null}function d(f,m,g,y,_){if(c.isStatic)c.renderStyles(f,QPe,g,_);else{var b=vf({},m,{theme:xK(m,y,h.defaultProps)});c.renderStyles(f,b,g,_)}}return vi.memo(h)}const If=N4;var MK={exports:{}},RRe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",IRe=RRe,LRe=IRe;function EK(){}function TK(){}TK.resetWarningCache=EK;var ORe=function(){function i(r,n,l,c,h,d){if(d!==LRe){var f=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw f.name="Invariant Violation",f}}i.isRequired=i;function e(){return i}var t={array:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:e,element:i,elementType:i,instanceOf:e,node:i,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:TK,resetWarningCache:EK};return t.PropTypes=t,t};MK.exports=ORe();var NRe=MK.exports;const zt=Qd(NRe);function Yj(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(i,n).enumerable})),t.push.apply(t,r)}return t}function xI(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Yj(Object(t),!0).forEach(function(r){qu(i,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):Yj(Object(t)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(t,r))})}return i}function DRe(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function Kj(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,r.key,r)}}function kRe(i,e,t){return e&&Kj(i.prototype,e),t&&Kj(i,t),i}function qu(i,e,t){return e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function FRe(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),e&&D4(i,e)}function bI(i){return bI=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},bI(i)}function D4(i,e){return D4=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},D4(i,e)}function zRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function uf(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function BRe(i,e){return e&&(typeof e=="object"||typeof e=="function")?e:uf(i)}function URe(i){var e=zRe();return function(){var r=bI(i),n;if(e){var l=bI(this).constructor;n=Reflect.construct(r,arguments,l)}else n=r.apply(this,arguments);return BRe(this,n)}}function rf(i,e){return e||(e=i.slice(0)),Object.freeze(Object.defineProperties(i,{raw:{value:Object.freeze(e)}}))}function HRe(i,e){return $Re(i)||VRe(i,e)||AK(i,e)||WRe()}function $Re(i){if(Array.isArray(i))return i}function VRe(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var r=[],n=!0,l=!1,c,h;try{for(t=t.call(i);!(n=(c=t.next()).done)&&(r.push(c.value),!(e&&r.length===e));n=!0);}catch(d){l=!0,h=d}finally{try{!n&&t.return!=null&&t.return()}finally{if(l)throw h}}return r}}function AK(i,e){if(i){if(typeof i=="string")return Qj(i,e);var t=Object.prototype.toString.call(i).slice(8,-1);if(t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set")return Array.from(i);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Qj(i,e)}}function Qj(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=i[t];return r}function WRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TM(i,e){var t=typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(!t){if(Array.isArray(i)||(t=AK(i))||e&&i&&typeof i.length=="number"){t&&(i=t);var r=0,n=function(){};return{s:n,n:function(){return r>=i.length?{done:!0}:{done:!1,value:i[r++]}},e:function(d){throw d},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var l=!0,c=!1,h;return{s:function(){t=t.call(i)},n:function(){var d=t.next();return l=d.done,d},e:function(d){c=!0,h=d},f:function(){try{!l&&t.return!=null&&t.return()}finally{if(c)throw h}}}}var eG,jRe=PRe(eG||(eG=rf([`
  .focus-outline-hidden :focus {
      outline: none;
  }
`]))),tG,CK=If.button(tG||(tG=rf([`
  display: block;
  padding: 0;
  border: 0;
  background: none;
  font-size: 0;
  cursor: `,`;
`])),function(i){return i.disabled?"not-allowed":"pointer"}),iG,rG,GRe=If.span(iG||(iG=rf([`
  font-size: 12px;
  line-height: 1;
`])));function PK(i){var e=i.className,t=i.onClick,r=i.inverted,n=i.label,l=i.disabled;return vi.createElement(CK,{className:e,onClick:t,"data-tour-elem":"".concat(r?"right":"left","-arrow"),disabled:l},n?vi.createElement(GRe,null,n):vi.createElement("svg",{viewBox:"0 0 18.4 14.4"},vi.createElement("path",{d:r?"M17 7.2H1M10.8 1L17 7.2l-6.2 6.2":"M1.4 7.2h16M7.6 1L1.4 7.2l6.2 6.2",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeMiterlimit:"10"})))}PK.propTypes={className:zt.string.isRequired,onClick:zt.func.isRequired,inverted:zt.bool,label:zt.node,disabled:zt.bool};var nG=If(PK)(rG||(rG=rf([`
  color: `,`;

  `,`;
  `,`;

  &:hover {
    color: `,`;
  }
`])),function(i){return i.disabled?"#caccce":"#646464"},function(i){return i.inverted?"margin-left: 24px;":"margin-right: 24px;"},function(i){return!i.label&&`
    width: 16px;
    height: 12px;
    flex: 0 0 16px;
  `},function(i){return i.disabled?"#caccce":"#000"}),sG;function RK(i){var e=i.className,t=i.onClick,r=i.ariaLabel;return vi.createElement(CK,{className:e,onClick:t,"aria-label":r},vi.createElement("svg",{viewBox:"0 0 9.1 9.1","aria-hidden":!0,role:"presentation"},vi.createElement("path",{fill:"currentColor",d:"M5.9 4.5l2.8-2.8c.4-.4.4-1 0-1.4-.4-.4-1-.4-1.4 0L4.5 3.1 1.7.3C1.3-.1.7-.1.3.3c-.4.4-.4 1 0 1.4l2.8 2.8L.3 7.4c-.4.4-.4 1 0 1.4.2.2.4.3.7.3s.5-.1.7-.3L4.5 6l2.8 2.8c.3.2.5.3.8.3s.5-.1.7-.3c.4-.4.4-1 0-1.4L5.9 4.5z"})))}RK.propTypes={className:zt.string.isRequired,onClick:zt.func.isRequired,ariaLabel:zt.string};var qRe=If(RK)(sG||(sG=rf([`
  position: absolute;
  top: 22px;
  right: 22px;
  width: 9px;
  height: 9px;
  color: #5e5e5e;
  &:hover {
    color: #000;
  }
`])));function oR(i){var e=i.getBoundingClientRect(),t=e.top,r=e.right,n=e.bottom,l=e.left,c=e.width,h=e.height;return{top:t,right:r,bottom:n,left:l,width:c,height:h}}function IK(i,e){if(!e.highlightedSelectors)return oR(i);var t=oR(i),r=TM(e.highlightedSelectors),n;try{for(r.s();!(n=r.n()).done;){var l=n.value,c=document.querySelector(l);if(!(!c||c.style.display==="none"||c.style.visibility==="hidden")){var h=oR(c);h.top<t.top&&(t.top=h.top),h.right>t.right&&(t.right=h.right),h.bottom>t.bottom&&(t.bottom=h.bottom),h.left<t.left&&(t.left=h.left)}}}catch(d){r.e(d)}finally{r.f()}return t.width=t.right-t.left,t.height=t.bottom-t.top,t}function XRe(i){var e=i.top,t=i.right,r=i.bottom,n=i.left,l=i.w,c=i.h,h=i.threshold,d=h===void 0?0:h;return e>=0+d&&n>=0+d&&r<=c-d&&t<=l-d}function ZRe(i){return i===document.querySelector("body")||i===document.querySelector("html")}var JRe=function(e){return/(left|right)/.test(e)},KD=function(e,t){return e>t},QD=function(e,t){return e>t},lf=function(e){return e<0?0:e};function YRe(i){return Object.keys(i).map(function(e){return{position:e,value:i[e]}}).sort(function(e,t){return t.value-e.value}).map(function(e){return e.position})}var aG,KRe=If.div(aG||(aG=rf([`
  --reactour-accent: `,`;
  `,`
  position: fixed;
  transition: transform 0.3s;
  top: 0;
  left: 0;
  z-index: 1000000;

  transform: `,`;
`])),function(i){return i.accentColor},function(i){return i.defaultStyles?`
  max-width: 331px;
  min-width: 150px;
  padding-right: 40px;
  border-radius: `.concat(i.rounded,`px;
  background-color: #fff;
  padding: 24px 30px;
  box-shadow: 0 0.5em 3em rgba(0, 0, 0, 0.3);
  color: inherit;
  `):""},function(i){var e=i.targetTop,t=i.targetRight,r=i.targetBottom,n=i.targetLeft,l=i.windowWidth,c=i.windowHeight,h=i.helperWidth,d=i.helperHeight,f=i.helperPosition,m=i.padding,g={left:n,right:l-t,top:e,bottom:c-r},y=function(T){return g[T]>(JRe(T)?h+m*2:d+m*2)},_=function(T){for(var A=YRe(g),P=0;P<A.length;P++)if(y(A[P]))return T[A[P]];return T.center},b=function(T){if(Array.isArray(T)){var A=KD(T[0],l),P=QD(T[1],c),O=function(z,G){console.warn("".concat(z,":").concat(G," is outside window, falling back to center"))};return A&&O("x",T[0]),P&&O("y",T[1]),[A?l/2-h/2:T[0],P?c/2-d/2:T[1]]}var R=KD(n+h,l)?KD(t+m,l)?t-h:t-h+m:n-m,D=R>m?R:m,L=QD(e+d,c)?QD(r+m,c)?r-d:r-d+m:e-m,N=L>m?L:m,U={top:[D,e-d-m*2],right:[t+m*2,N],bottom:[D,r+m*2],left:[n-h-m*2,N],center:[l/2-h/2,c/2-d/2]};return T==="center"||y(T)?U[T]:_(U)},S=b(f);return"translate(".concat(Math.round(S[0]),"px, ").concat(Math.round(S[1]),"px)")}),oG,QRe=If.span(oG||(oG=rf([`
  position: absolute;
  font-family: monospace;
  background: var(--reactour-accent);
  background: `,`;
  height: 1.875em;
  line-height: 2;
  padding-left: 0.8125em;
  padding-right: 0.8125em;
  font-size: 1em;
  border-radius: 1.625em;
  color: white;
  text-align: center;
  box-shadow: 0 0.25em 0.5em rgba(0, 0, 0, 0.3);
  top: -0.8125em;
  left: -0.8125em;
`])),function(i){return i.accentColor}),lG,eIe=If.div(lG||(lG=rf([`
  display: flex;
  margin-top: 24px;
  align-items: center;
  justify-content: center;
`]))),uG,tIe=If.nav(uG||(uG=rf([`
  counter-reset: dot;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-wrap: wrap;
`]))),cG,iIe=If.button(cG||(cG=rf([`
  counter-increment: dot;
  width: 8px;
  height: 8px;
  border: `,`;

  border-radius: 100%;
  padding: 0;
  display: block;
  margin: 4px;
  transition: opacity 0.3s, transform 0.3s;
  cursor: `,`;
  transform: scale(`,`);

  color: `,`;
  background: `,`;

  color: `,`;
  background: `,`;

  &:before {
    content: counter(dot);
    position: absolute;
    bottom: calc(100% + 0.25em);
    left: 50%;
    opacity: 0;
    transform: translate(-50%, 1em);
    transition: 0.3s;
    display: `,`;
  }

  &:hover {
    background-color: currentColor;

    &:before {
      opacity: 0.5;
      transform: translate(-50%, -2px);
    }
  }
`])),function(i){return i.current===i.index?"0":"1px solid #caccce"},function(i){return i.disabled?"not-allowed":"pointer"},function(i){return i.current===i.index?1.25:1},function(i){return i.current===i.index?"var(--reactour-accent)":"#caccce"},function(i){return i.current===i.index?"var(--reactour-accent)":"none"},function(i){return i.current===i.index?i.accentColor:"#caccce"},function(i){return i.current===i.index?i.accentColor:"none"},function(i){return i.showNumber?"block":"none"}),hG,rIe=If.div(hG||(hG=rf([`
  opacity: `,`;
  color: `,`;
  width: 100%;
  left: 0;
  top: 0;
  height: 100%;
  position: fixed;
  z-index: 99999;
  pointer-events: none;
`])),function(i){return!i.maskClassName&&.7},function(i){return!i.maskClassName&&"#000"});function LK(i){var e=i.windowWidth,t=i.windowHeight,r=i.targetWidth,n=i.targetHeight,l=i.targetTop,c=i.targetLeft,h=i.padding,d=i.rounded,f=i.roundedStep,m=i.disableInteraction,g=i.disableInteractionClassName,y=i.className,_=i.onClick,b=i.highlightedBorder,S=lf(r+h*2),E=lf(n+h*2),T=lf(l-h),A=lf(c-h),P=f?Math.min(S/2,E/2):d;return vi.createElement(rIe,{onClick:_,maskClassName:y},vi.createElement("svg",{width:e,height:t,xmlns:"http://www.w3.org/2000/svg",className:y},vi.createElement("defs",null,vi.createElement("mask",{id:"mask-main"},vi.createElement("rect",{x:0,y:0,width:e,height:t,fill:"white"}),vi.createElement("rect",{x:A,y:T,width:S,height:E,fill:"black"}),vi.createElement("rect",{x:A-1,y:T-1,width:P,height:P,fill:"white"}),vi.createElement("circle",{cx:A+P,cy:T+P,r:P,fill:"black"}),vi.createElement("rect",{x:A+S-P+1,y:T-1,width:P,height:P,fill:"white"}),vi.createElement("circle",{cx:A+S-P,cy:T+P,r:P,fill:"black"}),vi.createElement("rect",{x:A-1,y:T+E-P+1,width:P,height:P,fill:"white"}),vi.createElement("circle",{cx:A+P,cy:T+E-P,r:P,fill:"black"}),vi.createElement("rect",{x:A+S-P+1,y:T+E-P+1,width:P,height:P,fill:"white"}),vi.createElement("circle",{cx:A+S-P,cy:T+E-P,r:P,fill:"black "})),vi.createElement("clipPath",{id:"clip-path"},vi.createElement("rect",{x:0,y:0,width:e,height:T}),vi.createElement("rect",{x:0,y:T,width:A,height:E}),vi.createElement("rect",{x:c+r+h,y:T,width:lf(e-r-A),height:E}),vi.createElement("rect",{x:0,y:l+n+h,width:e,height:lf(t-n-T)}))),vi.createElement("rect",{x:0,y:0,width:e,height:t,fill:"currentColor",mask:"url(#mask-main)"}),vi.createElement("rect",{x:0,y:0,width:e,height:t,fill:"currentColor",clipPath:"url(#clip-path)",pointerEvents:"auto"}),vi.createElement("rect",{x:A,y:T,width:S,height:E,pointerEvents:"auto",fill:"transparent",display:m?"block":"none",className:g}),b&&vi.createElement("rect",{x:lf(A+b.width/2),y:lf(T+b.width/2),width:lf(S-b.width),height:lf(E-b.width),pointerEvents:"auto",fill:"none",strokeWidth:b.width,stroke:b.color,rx:P-2})))}LK.propTypes={windowWidth:zt.number.isRequired,windowHeight:zt.number.isRequired,targetWidth:zt.number.isRequired,targetHeight:zt.number.isRequired,targetTop:zt.number.isRequired,targetLeft:zt.number.isRequired,padding:zt.number.isRequired,rounded:zt.number.isRequired,roundedStep:zt.bool,disableInteraction:zt.bool.isRequired,disableInteractionClassName:zt.string.isRequired,highlightedBorder:zt.shape({color:zt.string.isRequired,width:zt.number.isRequired})};var nIe=function(i){var e=i.step,t=i.refresh,r=Ze.useState(0),n=HRe(r,2),l=n[0],c=n[1];return Ze.useEffect(function(){if(e.resizeObservables){var h=function(y){var _=TM(y),b;try{var S=function(){var A=b.value;if(!A.attributes)return"continue";var P=e.resizeObservables.find(function(O){return A.matches(O)||A.querySelector(O)!=null});P&&c(l+1)};for(_.s();!(b=_.n()).done;)var E=S()}catch(T){_.e(T)}finally{_.f()}},d=new MutationObserver(function(g){var y=TM(g),_;try{for(y.s();!(_=y.n()).done;){var b=_.value;b.addedNodes.length!==0&&h(b.addedNodes),b.removedNodes.length!==0&&h(b.removedNodes)}}catch(S){y.e(S)}finally{y.f()}}),f=document.documentElement||document.body,m={childList:!0,subtree:!0};return d.observe(f,m),function(){d.disconnect()}}},[e,l]),Ze.useEffect(function(){if(e.resizeObservables){var h=new ResizeObserver(function(y){t()}),d=TM(e.resizeObservables),f;try{for(d.s();!(f=d.n()).done;){var m=f.value,g=document.querySelector(m);g&&h.observe(g)}}catch(y){d.e(y)}finally{d.f()}return function(){h.disconnect()}}},[e,l]),null},sIe=function(i){var e=i.step,t=i.refresh;return Ze.useEffect(function(){if(e.mutationObservables){var r=function(d){var f=TM(d),m;try{var g=function(){var b=m.value;if(!b.attributes)return"continue";var S=e.mutationObservables.find(function(E){return b.matches(E)||b.querySelector(E)!=null});S&&t()};for(f.s();!(m=f.n()).done;)var y=g()}catch(_){f.e(_)}finally{f.f()}},n=new MutationObserver(function(h){var d=TM(h),f;try{for(d.s();!(f=d.n()).done;){var m=f.value;m.addedNodes.length!==0&&r(m.addedNodes),m.removedNodes.length!==0&&r(m.removedNodes)}}catch(g){d.e(g)}finally{d.f()}}),l=document.documentElement||document.body,c={childList:!0,subtree:!0};return n.observe(l,c),function(){n.disconnect()}}},[e]),null};function aIe(i){var e=i.children,t=Ze.useRef(null);return t.current===null&&(t.current=document.createElement("div"),t.current.setAttribute("id","___reactour")),Ze.useEffect(function(){return document.body.appendChild(t.current),function(){document.body.removeChild(t.current)}},[t]),T8.createPortal(e,t.current)}var oIe={disableFocusLock:zt.bool,badgeContent:zt.func,highlightedMaskClassName:zt.string,children:zt.oneOfType([zt.node,zt.element]),className:zt.string,closeButtonAriaLabel:zt.string,closeWithMask:zt.bool,inViewThreshold:zt.number,isOpen:zt.bool.isRequired,lastStepNextButton:zt.node,maskClassName:zt.string,maskSpace:zt.number,nextButton:zt.node,onAfterOpen:zt.func,onBeforeClose:zt.func,onRequestClose:zt.func,prevButton:zt.node,scrollDuration:zt.number,scrollOffset:zt.number,showButtons:zt.bool,showCloseButton:zt.bool,showNavigation:zt.bool,showNavigationNumber:zt.bool,showNumber:zt.bool,startAt:zt.number,goToStep:zt.number,getCurrentStep:zt.func,nextStep:zt.func,prevStep:zt.func,steps:zt.arrayOf(zt.shape({selector:zt.string,content:zt.oneOfType([zt.node,zt.element,zt.func]).isRequired,position:zt.oneOfType([zt.arrayOf(zt.number),zt.oneOf(["top","right","bottom","left","center"])]),action:zt.func,style:zt.object,stepInteraction:zt.bool,navDotAriaLabel:zt.string,roundedStep:zt.bool})),update:zt.string,updateDelay:zt.number,disableInteraction:zt.bool,disableDotsNavigation:zt.bool,disableKeyboardNavigation:zt.oneOfType([zt.arrayOf(zt.oneOf(["esc","right","left"])),zt.bool]),rounded:zt.number,accentColor:zt.string,highlightedBorder:zt.shape({color:zt.string.isRequired,width:zt.number.isRequired})},lIe={disableFocusLock:!1,showNavigation:!0,showNavigationNumber:!0,showButtons:!0,showCloseButton:!0,closeButtonAriaLabel:"Close",showNumber:!0,scrollDuration:1,maskSpace:10,updateDelay:1,disableInteraction:!1,rounded:0,accentColor:"#007aff",closeWithMask:!0},OS={mask:{base:"reactour__mask",isOpen:"reactour__mask--is-open",disableInteraction:"reactour__mask--disable-interaction"},helper:{base:"reactour__helper",isOpen:"reactour__helper--is-open"},dot:{base:"reactour__dot",active:"reactour__dot--is-active"}},kU=function(i){FRe(t,i);var e=URe(t);function t(){var r;return DRe(this,t),r=e.call(this),qu(uf(r),"unlockFocus",function(n){r.setState({focusUnlocked:!0},n())}),qu(uf(r),"showStep",function(){if(!(!r.helper||!r.helper.current)){var n=r.props.steps,l=r.state,c=l.current,h=l.focusUnlocked;h&&r.setState({focusUnlocked:!1});var d=n[c],f=d.selector?document.querySelector(d.selector):null,m=function(S){d.action&&typeof d.action=="function"&&r.unlockFocus(function(){return d.action(S)})};if(d.observe){var g=document.querySelector(d.observe),y={attributes:!0,childList:!0,characterData:!0};r.setState(function(b){return b.observer&&setTimeout(function(){b.observer.disconnect()},0),{observer:new MutationObserver(function(S){S.forEach(function(E){if(E.type==="childList"&&E.addedNodes.length>0){var T=function(){return m(E.addedNodes[0])};setTimeout(function(){return r.calculateNode(E.addedNodes[0],d,T)},100)}else if(E.type==="childList"&&E.removedNodes.length>0){var A=function(){return m(f)};r.calculateNode(f,d,A)}})})}},function(){return r.state.observer.observe(g,y)})}else r.state.observer&&(r.state.observer.disconnect(),r.setState({observer:null}));if(f){var _=function(){return m(f)};r.calculateNode(f,d,_)}else r.setState(ek(null,d,r.helper.current),m),d.selector&&console.warn("Doesn't find a DOM node '".concat(d.selector,"'. Please check the 'steps' Tour prop Array at position ").concat(c,"."))}}),qu(uf(r),"calculateNode",function(n,l,c){var h=r.props,d=h.scrollDuration,f=h.inViewThreshold,m=h.scrollOffset,g=IK(n,l),y=Math.max(document.documentElement.clientWidth,window.innerWidth||0),_=Math.max(document.documentElement.clientHeight,window.innerHeight||0);if(XRe(xI(xI({},g),{},{w:y,h:_,threshold:f})))r.setState(ek(n,l,r.helper.current),c);else{var b=g3e(n),S=m||(g.height>_?-25:-(_/2)+g.height/2);p3e.to(n,{context:ZRe(b)?window:b,duration:d,offset:S,callback:function(T){r.setState(ek(T,l,r.helper.current),c)}})}}),qu(uf(r),"recalculateNode",function(n){var l=document.querySelector(n.selector),c=function(d){n.action&&typeof n.action=="function"&&r.unlockFocus(function(){return n.action(d)})};r.calculateNode(l,n,function(){return c(l)})}),qu(uf(r),"maskClickHandler",function(n){var l=r.props,c=l.closeWithMask,h=l.onRequestClose;c&&!n.target.classList.contains(OS.mask.disableInteraction)&&h(n)}),qu(uf(r),"nextStep",function(){var n=r.props,l=n.steps,c=n.getCurrentStep;r.setState(function(h){var d=h.current<l.length-1?h.current+1:h.current;return typeof c=="function"&&c(d),{current:d}},r.showStep)}),qu(uf(r),"prevStep",function(){var n=r.props.getCurrentStep;r.setState(function(l){var c=l.current>0?l.current-1:l.current;return typeof n=="function"&&n(c),{current:c}},r.showStep)}),qu(uf(r),"gotoStep",function(n){var l=r.props,c=l.steps,h=l.getCurrentStep;r.setState(function(d){var f=c[n]?n:d.current;return typeof h=="function"&&h(f),{current:f}},r.showStep)}),qu(uf(r),"keyDownHandler",function(n){var l=r.props,c=l.onRequestClose,h=l.nextStep,d=l.prevStep,f=l.disableKeyboardNavigation;if(n.stopPropagation(),f!==!0){var m,g,y;f&&(m=f.includes("esc"),g=f.includes("right"),y=f.includes("left")),n.keyCode===27&&!m&&(n.preventDefault(),c()),n.keyCode===39&&!g&&(n.preventDefault(),typeof h=="function"?h():r.nextStep()),n.keyCode===37&&!y&&(n.preventDefault(),typeof d=="function"?d():r.prevStep())}}),r.state={isOpen:!1,current:0,top:0,right:0,bottom:0,left:0,width:0,height:0,w:0,h:0,inDOM:!1,observer:null,focusUnlocked:!1},r.helper=Ze.createRef(),r.helperElement=null,r.debouncedShowStep=D3e(r.showStep,70),r}return kRe(t,[{key:"componentDidMount",value:function(){var n=this.props,l=n.isOpen,c=n.startAt;l&&this.open(c)}},{key:"UNSAFE_componentWillReceiveProps",value:function(n){var l=this.props,c=l.isOpen,h=l.update,d=l.updateDelay;!c&&n.isOpen?this.open(n.startAt):c&&!n.isOpen&&this.close(),c&&h!==n.update&&(n.steps[this.state.current]?setTimeout(this.showStep,d):this.props.onRequestClose()),c&&n.isOpen&&this.state.current!==n.goToStep&&this.gotoStep(n.goToStep)}},{key:"componentWillUnmount",value:function(){var n=this.props.isOpen;n&&this.close(),this.state.observer&&this.state.observer.disconnect()}},{key:"open",value:function(n){var l=this,c=this.props.onAfterOpen;this.setState(function(h){return{isOpen:!0,current:n!==void 0?n:h.current}},function(){setTimeout(l.showStep,1),l.helperElement=l.helper.current,l.props.disableFocusLock||l.helper.current.focus(),c&&c(l.helperElement)}),window.addEventListener("resize",this.debouncedShowStep,!1),window.addEventListener("keydown",this.keyDownHandler,!1)}},{key:"close",value:function(){this.setState(function(n){return n.observer&&n.observer.disconnect(),{isOpen:!1,observer:null}},this.onBeforeClose),window.removeEventListener("resize",this.debouncedShowStep),window.removeEventListener("keydown",this.keyDownHandler)}},{key:"onBeforeClose",value:function(){var n=this.props.onBeforeClose;n&&n(this.helperElement)}},{key:"render",value:function(){var n=this,l=this.props,c=l.className,h=l.steps,d=l.maskClassName,f=l.showButtons,m=l.showCloseButton,g=l.closeButtonAriaLabel,y=l.showNavigation,_=l.showNavigationNumber,b=l.showNumber,S=l.onRequestClose,E=l.maskSpace,T=l.lastStepNextButton,A=l.nextButton,P=l.prevButton,O=l.badgeContent,R=l.highlightedMaskClassName,D=l.disableInteraction,L=l.disableDotsNavigation,N=l.nextStep,U=l.prevStep,F=l.rounded,z=l.accentColor,G=l.CustomHelper,J=l.disableFocusLock,Z=l.highlightedBorder,q=this.state,$=q.isOpen,H=q.current,X=q.inDOM,re=q.top,ae=q.right,he=q.bottom,pe=q.left,de=q.width,ee=q.height,se=q.w,Y=q.h,fe=q.helperWidth,me=q.helperHeight,De=q.helperPosition;return $?vi.createElement(aIe,null,vi.createElement(jRe,null),vi.createElement(nIe,{step:h[H],refresh:function(){return n.recalculateNode(h[H])}}),vi.createElement(sIe,{step:h[H],refresh:function(){return n.recalculateNode(h[H])}}),vi.createElement(LK,{onClick:this.maskClickHandler,forwardRef:function(Ce){return n.mask=Ce},windowWidth:se,windowHeight:Y,targetWidth:de,targetHeight:ee,targetTop:re,targetLeft:pe,padding:E,rounded:F,roundedStep:h[H].roundedStep,className:d,disableInteraction:h[H].stepInteraction===!1||D?!h[H].stepInteraction:D,disableInteractionClassName:"".concat(OS.mask.disableInteraction," ").concat(R),highlightedBorder:Z}),vi.createElement(OPe,{disabled:J,autoFocus:!1},vi.createElement(KRe,{ref:this.helper,targetHeight:ee,targetWidth:de,targetTop:re,targetRight:ae,targetBottom:he,targetLeft:pe,windowWidth:se,windowHeight:Y,helperWidth:fe,helperHeight:me,helperPosition:De,padding:E,tabIndex:-1,current:H,style:h[H].style?h[H].style:{},rounded:F,className:Lj(OS.helper.base,c,qu({},OS.helper.isOpen,$)),accentColor:z,defaultStyles:!G,role:"dialog"},G?vi.createElement(G,{current:H,totalSteps:h.length,gotoStep:this.gotoStep,close:S,content:h[H]&&(typeof h[H].content=="function"?h[H].content({close:S,goTo:this.gotoStep,inDOM:X,step:H+1}):h[H].content)},this.props.children):vi.createElement(vi.Fragment,null,this.props.children,h[H]&&(typeof h[H].content=="function"?h[H].content({close:S,goTo:this.gotoStep,inDOM:X,step:H+1}):h[H].content),b&&vi.createElement(QRe,{"data-tour-elem":"badge",accentColor:z},typeof O=="function"?O(H+1,h.length):H+1),(f||y)&&vi.createElement(eIe,{"data-tour-elem":"controls"},f&&vi.createElement(nG,{onClick:typeof U=="function"?U:this.prevStep,disabled:H===0,label:P||null}),y&&vi.createElement(tIe,{"data-tour-elem":"navigation"},h.map(function(Le,Ce){return vi.createElement(iIe,{key:"".concat(Le.selector?Le.selector:"undef","_").concat(Ce),onClick:function(){return n.gotoStep(Ce)},current:H,index:Ce,accentColor:z,disabled:H===Ce||L,showNumber:_,"data-tour-elem":"dot",className:Lj(OS.dot.base,qu({},OS.dot.active,H===Ce)),"aria-label":Le.navDotAriaLabel})})),f&&vi.createElement(nG,{onClick:H===h.length-1?T?S:function(){}:typeof N=="function"?N:this.nextStep,disabled:!T&&H===h.length-1,inverted:!0,label:T&&H===h.length-1?T:A||null})),m&&vi.createElement(qRe,{onClick:S,className:"reactour__close",ariaLabel:g}))))):null}}]),t}(Ze.Component),ek=function(e,t,r){if(r){var n=Math.max(document.documentElement.clientWidth,window.innerWidth||0),l=Math.max(document.documentElement.clientHeight,window.innerHeight||0),c=oR(r),h=c.width,d=c.height,f={top:l+10,right:n/2+9,bottom:l/2+9,left:n/2-h/2,width:0,height:0,w:n,h:l,helperPosition:"center"};return e&&(f=IK(e,t)),function(){return xI(xI({w:n,h:l,helperWidth:h,helperHeight:d,helperPosition:t.position},f),{},{inDOM:!!e})}}};kU.propTypes=oIe;kU.defaultProps=lIe;const uIe=({content:i,gotoStep:e,current:t,close:r,steps:n,hiddenArrowSteps:l,arrowAlignments:c,handleStepChange:h,isAbsolute:d})=>{var b;const f=()=>{if(h==null||h(t),t===n.length-1){r();return}else e(t+1)},m=t===n.length-1?"GOT IT":"NEXT",g=!(l!=null&&l.includes(t)),y=c==null?void 0:c[t],_=()=>y!=null&&y.startsWith("left")?"row":y!=null&&y.startsWith("right")?"row-reverse":y!=null&&y.startsWith("top")?"column":y!=null&&y.startsWith("bottom")?"column-reverse":"column";return $t.jsxs("div",{className:d?"tour-tooltip-absolute":"",style:{display:"flex",flexDirection:_()},children:[g&&$t.jsx(cIe,{alignment:y||"top",direction:((b=c==null?void 0:c[t])==null?void 0:b.split("-")[0])||(c==null?void 0:c[t])||"top"}),$t.jsxs("div",{className:"tour-tooltip",children:[$t.jsx("div",{className:"tour-tooltip-content",dangerouslySetInnerHTML:{__html:(i==null?void 0:i.toString())||""}}),$t.jsx("button",{onClick:f,className:"next-button",children:m})]})]})},cIe=({direction:i,alignment:e})=>{const t=()=>{switch(i){case"left":return $t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",children:$t.jsx("path",{d:"M 20 0 l -10 10l10 10",fill:"#fff",stroke:"white",strokeWidth:"2"})});case"right":return $t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",children:$t.jsx("path",{d:"M 0 0 l 10 10l-10 10",fill:"#fff",stroke:"white",strokeWidth:"2"})});case"top":return $t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",children:$t.jsx("path",{d:"M 0 20 l 10 -10l10 10",fill:"#fff",stroke:"white",strokeWidth:"2"})});case"bottom":return $t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",children:$t.jsx("path",{d:"M 0 0 l 10 10l10 -10",fill:"#fff",stroke:"white",strokeWidth:"2"})});default:return $t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",children:$t.jsx("path",{d:"M 0 0 l 10 10l10 -10",fill:"#fff",stroke:"white",strokeWidth:"2"})})}},r=()=>{if(e!=null&&e.startsWith("left"))return"12px";if(e!=null&&e.startsWith("right"))return"8px";if(e!=null&&e.endsWith("start"))return"25px";if(e!=null&&e.endsWith("end"))return"0px";switch(e){case"top":return"12px";case"bottom":return"12px";default:return"0px"}},n=()=>{if(e!=null&&e.startsWith("top"))return"5px";if(e!=null&&e.startsWith("bottom"))return"-2px";if(e!=null&&e.endsWith("start"))return"16px";if(e!=null&&e.endsWith("end"))return"-16px"},l=()=>e==null?void 0:e.split("-")[1];return $t.jsx("div",{style:{position:"relative",zIndex:10,left:r(),top:n(),alignSelf:l()||"center"},children:t()})},hIe=({steps:i,isOpen:e,onRequestClose:t,maskClassName:r="tour-mask",hiddenArrowSteps:n,arrowAlignments:l,isAbsolute:c,handleStepChange:h,extraOverlay:d,...f})=>$t.jsxs($t.Fragment,{children:[d&&e&&$t.jsx("div",{className:`extra-overlay extra-overlay-${d.position} set-opacity-${d.opacity}`}),$t.jsx(kU,{steps:i,isOpen:e,onRequestClose:t,CustomHelper:({...m})=>$t.jsx(uIe,{...m,hiddenArrowSteps:n,steps:i,arrowAlignments:l,handleStepChange:h,isAbsolute:c}),startAt:0,maskClassName:r,maskSpace:-12,disableInteraction:!0,closeWithMask:!1,...f})]}),dIe=({isOpen:i,onClose:e,children:t,overlayOpacity:r=.85,closabe:n=!0,okText:l="NEXT",onOk:c,onBoarding:h=!0})=>{if(!i)return null;const d=()=>{n&&e()},f=()=>{c&&c()};return $t.jsxs("div",{className:"modal-wrapper",children:[$t.jsx("div",{className:"modal-overlay",onClick:d,style:{opacity:r}}),$t.jsxs("div",{className:`modal-content ${h&&"modal-onboarding"}`,children:[t,$t.jsx("button",{onClick:f,className:"modal-ok-button",children:l})]})]})},fIe=()=>$t.jsx("div",{className:"overlay",children:$t.jsx("svg",{className:"loader-svg",width:"100",height:"100",viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:$t.jsxs("g",{children:[$t.jsx("circle",{className:"inner-circle",cx:"50",cy:"50",r:"37.5"}),$t.jsx("circle",{className:"outer-circle",cx:"50",cy:"50",r:"46.5",fill:"transparent",stroke:"#6210CC",strokeWidth:"7"}),$t.jsx("mask",{id:"mask-id",children:$t.jsx("path",{d:"M 65.541 28.263 H 46.4141 C 46.4141 28.263 46.3402 28.263 46.3033 28.263 C 44.3295 28.263 42.4077 28.64 40.5819 29.3866 C 38.719 30.1479 37.0558 31.2493 35.6291 32.6612 C 34.2026 34.0731 33.0938 35.7363 32.3175 37.5917 C 31.5488 39.4471 31.1571 41.4059 31.1571 43.4165 C 31.1571 45.4272 31.5488 47.3861 32.3175 49.2414 C 33.0863 51.0968 34.2026 52.7526 35.6291 54.1719 C 37.0558 55.5912 38.719 56.6926 40.5819 57.4466 C 42.4445 58.2079 44.4183 58.5701 46.4068 58.5701 H 57.8125 C 58.3669 58.5701 58.9139 58.7919 59.3057 59.1911 C 59.7049 59.5902 59.9266 60.1225 59.9266 60.6843 C 59.9266 61.2461 59.7049 61.7783 59.3057 62.1774 C 58.9139 62.5692 58.3669 62.7984 57.8125 62.7984 H 48.7869 C 47.6486 62.7984 46.7246 63.7224 46.7246 64.8607 V 69.6581 C 46.7246 70.7965 47.6486 71.7205 48.7869 71.7205 H 57.5538 C 59.387 71.7205 61.0576 71.3657 62.5138 70.6709 C 66.4243 68.8081 68.8488 64.979 68.8488 60.6769 C 68.8488 56.3747 66.4243 52.5457 62.5138 50.6829 C 61.0576 49.988 59.3944 49.6332 57.5538 49.6332 H 46.392 C 45.5936 49.6332 44.7583 49.4928 43.9896 49.1749 C 43.2208 48.8645 42.5333 48.4135 41.9493 47.8296 C 41.358 47.2456 40.8997 46.5655 40.5819 45.8042 C 40.264 45.0428 40.1013 44.2371 40.1013 43.4092 C 40.1013 42.5813 40.264 41.7755 40.5819 41.0141 C 40.8997 40.2528 41.358 39.5727 41.9493 38.9888 C 42.5406 38.4048 43.2281 37.9539 43.9896 37.6434 C 44.7583 37.333 45.5787 37.1851 46.392 37.1851 H 65.5263 C 66.6646 37.1851 67.5887 36.2611 67.5887 35.1227 V 30.3253 C 67.5887 29.187 66.6646 28.263 65.5263 28.263 H 65.541 Z"})}),$t.jsxs("g",{mask:"url(#mask-id)",children:[$t.jsx("path",{d:"M 65.541 28.263 H 46.4141 C 46.4141 28.263 46.3402 28.263 46.3033 28.263 C 44.3295 28.263 42.4077 28.64 40.5819 29.3866 C 38.719 30.1479 37.0558 31.2493 35.6291 32.6612 C 34.2026 34.0731 33.0938 35.7363 32.3175 37.5917 C 31.5488 39.4471 31.1571 41.4059 31.1571 43.4165 C 31.1571 45.4272 31.5488 47.3861 32.3175 49.2414 C 33.0863 51.0968 34.2026 52.7526 35.6291 54.1719 C 37.0558 55.5912 38.719 56.6926 40.5819 57.4466 C 42.4445 58.2079 44.4183 58.5701 46.4068 58.5701 H 57.8125 C 58.3669 58.5701 58.9139 58.7919 59.3057 59.1911 C 59.7049 59.5902 59.9266 60.1225 59.9266 60.6843 C 59.9266 61.2461 59.7049 61.7783 59.3057 62.1774 C 58.9139 62.5692 58.3669 62.7984 57.8125 62.7984 H 48.7869 C 47.6486 62.7984 46.7246 63.7224 46.7246 64.8607 V 69.6581 C 46.7246 70.7965 47.6486 71.7205 48.7869 71.7205 H 57.5538 C 59.387 71.7205 61.0576 71.3657 62.5138 70.6709 C 66.4243 68.8081 68.8488 64.979 68.8488 60.6769 C 68.8488 56.3747 66.4243 52.5457 62.5138 50.6829 C 61.0576 49.988 59.3944 49.6332 57.5538 49.6332 H 46.392 C 45.5936 49.6332 44.7583 49.4928 43.9896 49.1749 C 43.2208 48.8645 42.5333 48.4135 41.9493 47.8296 C 41.358 47.2456 40.8997 46.5655 40.5819 45.8042 C 40.264 45.0428 40.1013 44.2371 40.1013 43.4092 C 40.1013 42.5813 40.264 41.7755 40.5819 41.0141 C 40.8997 40.2528 41.358 39.5727 41.9493 38.9888 C 42.5406 38.4048 43.2281 37.9539 43.9896 37.6434 C 44.7583 37.333 45.5787 37.1851 46.392 37.1851 H 65.5263 C 66.6646 37.1851 67.5887 36.2611 67.5887 35.1227 V 30.3253 C 67.5887 29.187 66.6646 28.263 65.5263 28.263 H 65.541 Z"}),$t.jsx("path",{id:"path",className:"over-path",d:"M 46.6 67 c 0 0 4.4 0.1 8 0 c 4.4 -0.3 5 -1 6.6 -1.8949 c 1.448 -1.1051 2.448 -2.1051 2.602 -2.3 c 1.846 -4.8051 -1.154 -7.8051 -7.602 -9.4 c -1.552 -0.4051 -3.552 -0.6 -4.8543 -0.7597 h -7.3942 c -0.9581 0 -1.9604 -0.1685 -2.6438 -0.8 c -0.9226 -0.3725 -2.1 -2 -2.5 -2.4 c -0.8746 -1.3 -0.8746 -1.4454 -2 -3.2 c -0.3814 -0.9137 -1.0523 -1.2454 -1 -3.7 c 0 -0.9934 0.1953 -1.9604 0.5767 -3.7 c 0.3814 -0.9136 0.9314 -1.7297 1.6409 -2.7 c 1.1254 -1.6954 2.1254 -2.1454 2.4483 -2.3 c 2.6771 -0.8454 -0.3229 0 3.3 -0.9 h 24.37"})]})]})})}),pIe={John:"https://demos.superviz.com/images/john-davis.png",Anna:"https://demos.superviz.com/images/anna-wing.png",Matt:"https://demos.superviz.com/images/matt-smith.png"},mIe="https://demos.superviz.com",gIe=()=>{const[i,e]=Ze.useState(!0),[t,r]=Ze.useState(!1),n=()=>r(!1),l=()=>{e(!1),r(!0)};return $t.jsxs($t.Fragment,{children:[$t.jsx(dIe,{isOpen:i,closabe:!1,onClose:()=>e(!1),onOk:l,children:$t.jsxs("div",{className:"tour-modal",children:[$t.jsx("img",{src:mIe+"/images/thumbs/whiteboard-thumb.png"}),$t.jsx("h3",{children:"Collaborative whiteboard"}),$t.jsx("p",{children:"Discover features like real-time presence and contextual comments in collaborative"}),$t.jsx("p",{children:"whiteboards."})]})}),$t.jsx(hIe,{steps:Rj,isOpen:t,onRequestClose:n,arrowAlignments:Rj.map(()=>"top-end"),maskClassName:"tour-mask tour-overlay"})]})},vIe=["./assets/icons/send-on_sm.svg","./assets/icons/plus_sm.svg","./assets/icons/group_5625.svg","./assets/icons/group_5624.svg","./assets/icons/group_5623.svg","./assets/icons/group_5626.svg","./assets/icons/drawing_md.svg","./assets/icons/group_5627.svg","./assets/icons/group_5628.svg"],yIe=({placement:i,onClick:e})=>$t.jsx("div",{className:`action-bar action-bar-${i}`,children:vIe.map((t,r)=>$t.jsx("button",{onClick:e,className:"action-button",children:$t.jsx("img",{src:t})},r))}),_Ie=()=>$t.jsxs("div",{className:"screen-container",children:[$t.jsx(xIe,{}),$t.jsx(o3e,{})]}),xIe=()=>$t.jsxs("div",{className:"header",children:[$t.jsxs("div",{children:[$t.jsx(gIe,{}),$t.jsx("span",{className:"title",children:"cnvs tool"})]}),$t.jsxs("div",{className:"header-features",children:[$t.jsx("div",{id:"comments-button"}),$t.jsx("div",{id:"online"})]})]}),bIe=i=>{const e=Math.floor(Math.random()*100)+1;return`${i}-${e.toString().padStart(3,"0")}`},wIe=i=>`${window.location.origin}/${i}/`,SIe=async(i,e,t)=>{const r="y9ijipkxce9vn31y6ufu63qjb5935y",n="https://dev.nodeapi.superviz.com/annotations/create/schema",l={method:"POST",headers:{apiKey:r,"Content-Type":"application/json"},body:JSON.stringify({name:i,url:wIe(e),annotations:t})};try{await fetch(n,l)}catch(c){console.error(c)}},MIe=()=>{const i=Ze.useRef(bIe("whiteboard")),[e]=eie(),t=Ze.useRef(!1),r="y9ijipkxce9vn31y6ufu63qjb5935y",n=e.get("username"),l=e.get("roomId"),[c,h]=vi.useState(0),d=Ze.useRef(!1);return Ze.useEffect(()=>{t.current||n||(t.current=!0,SIe(i.current,"whiteboard",Z2e))},[]),Ze.useEffect(()=>{window.addEventListener("message",f=>{if(f.data==="whiteboardLoaded"&&h(y=>y+1),typeof f.data!="string"||d.current)return;const[m,g]=f.data.split(";;");if(m==="pointers-colors"){d.current=!0;const y=document.createElement("style");y.innerHTML=g,y.setAttribute("type","text/css"),document.head.appendChild(y)}})},[]),n&&l?$t.jsxs(U2e,{developerKey:r,group:{id:"demos-whiteboard-group",name:"Demos: Whiteboard"},participant:{id:n.toLowerCase(),name:n,avatar:{imageUrl:pIe[n]}},onParticipantListUpdated:f=>{if(f.length<3||n!=="John")return;const m=f.reduce((g,y)=>{var _,b;return console.log(y),!((_=y.slot)!=null&&_.color)||!((b=y.slot)!=null&&b.textColor)||!y.id?"":y.name==="John"?g:`
							${g} 
							.${y.id}-cursor .bg-color { 
								fill: ${y.slot.color} !important; 
							} 
							
							.${y.id}-cursor .text-color { 
								fill: ${y.slot.textColor} !important; 
							}`},"").trimStart();!m||m.includes("undefined")||window.parent.postMessage(`pointers-colors;;${m}`,"*")},environment:"dev",roomId:l,onParticipantLocalJoined:()=>window.parent.postMessage("whiteboardLoaded","*"),children:[$t.jsx(V2e,{position:"online",styles:q2e}),$t.jsx(_Ie,{})]}):$t.jsxs("div",{className:"screen-container",children:[c<3&&$t.jsx(fIe,{}),$t.jsx("iframe",{src:`/whiteboard/?username=John&roomId=${i.current}`,className:"whiteboard-demo"}),$t.jsx("iframe",{src:`/whiteboard/?username=Anna&roomId=${i.current}`,style:{display:"none"}}),$t.jsx("iframe",{src:`/whiteboard/?username=Matt&roomId=${i.current}`,style:{display:"none"}})]})},EIe=()=>$t.jsx(Qte,{children:$t.jsx(Zte,{children:$t.jsx(F8,{path:"/whiteboard/",element:$t.jsx(MIe,{})})})});tk.createRoot(document.getElementById("root")).render($t.jsx(EIe,{}));
